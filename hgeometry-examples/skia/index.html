<!DOCTYPE html>
<html class="has-navbar-fixed-top has-navbar-fixed-bottom">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://unpkg.com/bulmaswatch/sandstone/bulmaswatch.min.css">
    <script type="text/javascript" src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"
            defer></script>
    <script type="text/javascript" src="jsaddle.js"></script>
    <script type="text/javascript"
            src="https://unpkg.com/canvaskit-wasm@0.39.1/bin/canvaskit.js"></script>
    <title>Skia</title>
  </head>
  <body>
    <script type="text/javascript">
     /* function fitToContainer(canvas){
      *   canvas.width  = canvas.offsetWidth;
      *   canvas.height = canvas.offsetHeight;
      *   return (canvas.offsetWidth, canvas.offsetHeight)
      * } */

     /* initializeSkiaCanvas('mainCanvas'); */

     function initializeSkiaCanvas(theCanvasId) {
       /* const canvasSize = fitToContainer(document.getElementById(theCanvasId));
        * console.log(canvasSize); */
       const ckLoaded = CanvasKitInit({
         locateFile: (file) => 'https://unpkg.com/canvaskit-wasm@0.39.1/bin/'+file});
       ckLoaded.then((CanvasKit) => {

         const surface = CanvasKit.MakeCanvasSurface(theCanvasId);

         let withPaint = (f) => {
           const paint = new CanvasKit.Paint();
           f(paint);
           paint.delete();
         }
         let withPath = (f) => {
           const path = new CanvasKit.Path();
           f(path);
           path.delete();
         }
         let withAntiAliassedPaint = (f) => {
           withPaint((paint) => {
             paint.setAntiAlias(true);
             f(paint);
           });
         }

         function draw(canvas) {
           canvas.clear(CanvasKit.WHITE);

           const rr = CanvasKit.RRectXY(CanvasKit.LTRBRect(10, 60, 210, 260), 0, 0);

           withAntiAliassedPaint( (paint) => {
             paint.setColor(CanvasKit.Color4f(0.9, 0.5, 0, 0.2));
             paint.setStyle(CanvasKit.PaintStyle.Fill);

             withAntiAliassedPaint( (paint2) => {
               paint2.setColor(CanvasKit.Color4f(0.9, 0.0, 0.5, 1.0));
               paint2.setStyle(CanvasKit.PaintStyle.Stroke);

               canvas.drawRRect(rr, paint);
               canvas.drawRRect(rr, paint2);

               withPath((path) => {
                 path.moveTo(200, 50);
                 path.lineTo(300, 200);
                 path.lineTo(400, 100);
                 path.lineTo(500, 200);
                 path.lineTo(600, 0);
                 path.lineTo(200, 50);

                 canvas.drawPath(path, paint2);
               });
             });
           });
         }
         surface.drawOnce(draw);

       });
     }

    </script>
  </body>
</html>
