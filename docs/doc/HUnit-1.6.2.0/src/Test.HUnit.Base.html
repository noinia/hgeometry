<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 704
</span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span class="hs-cpp">
#define HasCallStack_ HasCallStack =&gt;
</span><span class="hs-cpp">#else
</span><span class="hs-cpp">#define HasCallStack_
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- | Basic definitions for the HUnit library.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">--   This module contains what you need to create assertions and test cases and</span><span>
</span><span id="line-14"></span><span class="hs-comment">--   combine them into test suites.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">--   This module also provides infrastructure for</span><span>
</span><span id="line-17"></span><span class="hs-comment">--   implementing test controllers (which are used to execute tests).</span><span>
</span><span id="line-18"></span><span class="hs-comment">--   See &quot;Test.HUnit.Text&quot; for a great example of how to implement a test</span><span>
</span><span id="line-19"></span><span class="hs-comment">--   controller.</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.HUnit.Base</span><span>
</span><span id="line-22"></span><span class="hs-special">(</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Declaring tests</span></span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier">Test</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#~%3D%3F"><span class="hs-operator">(~=?)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#~%3F%3D"><span class="hs-operator">(~?=)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#~%3A"><span class="hs-operator">(~:)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#~%3F"><span class="hs-operator">(~?)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Making assertions</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Test.HUnit.Lang.html#assertFailure"><span class="hs-identifier">assertFailure</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">{- from Test.HUnit.Lang: -}</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#assertBool"><span class="hs-identifier">assertBool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Lang.html#assertEqual"><span class="hs-identifier">assertEqual</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#assertString"><span class="hs-identifier">assertString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Test.HUnit.Lang.html#Assertion"><span class="hs-identifier">Assertion</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">{- from Test.HUnit.Lang: -}</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#%40%3D%3F"><span class="hs-operator">(@=?)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#%40%3F%3D"><span class="hs-operator">(@?=)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#%40%3F"><span class="hs-operator">(@?)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Extending the assertion functionality</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#Assertable"><span class="hs-identifier">Assertable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#ListAssertable"><span class="hs-identifier">ListAssertable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#AssertionPredicate"><span class="hs-identifier">AssertionPredicate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#AssertionPredicable"><span class="hs-identifier">AssertionPredicable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#Testable"><span class="hs-identifier">Testable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Test execution</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><span class="hs-comment">-- $testExecutionNote</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#State"><span class="hs-identifier">State</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Counts"><span class="hs-identifier">Counts</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#Path"><span class="hs-identifier">Path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Node"><span class="hs-identifier">Node</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#testCasePaths"><span class="hs-identifier">testCasePaths</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#testCaseCount"><span class="hs-identifier">testCaseCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#ReportStart"><span class="hs-identifier">ReportStart</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#ReportProblem"><span class="hs-identifier">ReportProblem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="Test.HUnit.Base.html#performTest"><span class="hs-identifier">performTest</span></a></span><span>
</span><span id="line-46"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.CallStack</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- Assertion Definition</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- ====================</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.HUnit.Lang.html"><span class="hs-identifier">Test.HUnit.Lang</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- Conditional Assertion Functions</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- -------------------------------</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Asserts that the specified condition holds.</span><span>
</span><span id="line-62"></span><span class="annot"><a href="Test.HUnit.Base.html#assertBool"><span class="hs-identifier hs-type">assertBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span>
</span><span id="line-63"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>    </span><span class="hs-comment">-- ^ The message that is displayed if the assertion fails</span><span>
</span><span id="line-64"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>      </span><span class="hs-comment">-- ^ The condition</span><span>
</span><span id="line-65"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Lang.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a></span><span>
</span><span id="line-66"></span><span id="assertBool"><span class="annot"><span class="annottext">assertBool :: HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
</span><a href="Test.HUnit.Base.html#assertBool"><span class="hs-identifier hs-var hs-var">assertBool</span></a></span></span><span> </span><span id="local-6989586621679034732"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034732"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679034731"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679034731"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679034731"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; IO a
</span><a href="Test.HUnit.Lang.html#assertFailure"><span class="hs-identifier hs-var">assertFailure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034732"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Signals an assertion failure if a non-empty message (i.e., a message</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- other than @\&quot;\&quot;@) is passed.</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Test.HUnit.Base.html#assertString"><span class="hs-identifier hs-type">assertString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span>
</span><span id="line-71"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>    </span><span class="hs-comment">-- ^ The message that is displayed with the assertion failure</span><span>
</span><span id="line-72"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Lang.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a></span><span>
</span><span id="line-73"></span><span id="assertString"><span class="annot"><span class="annottext">assertString :: HasCallStack =&gt; String -&gt; Assertion
</span><a href="Test.HUnit.Base.html#assertString"><span class="hs-identifier hs-var hs-var">assertString</span></a></span></span><span> </span><span id="local-6989586621679034725"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034725"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034725"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; IO a
</span><a href="Test.HUnit.Lang.html#assertFailure"><span class="hs-identifier hs-var">assertFailure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034725"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Overloaded `assert` Function</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- ----------------------------</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Allows the extension of the assertion mechanism.</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- Since an 'Assertion' can be a sequence of @Assertion@s and @IO@ actions,</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- there is a fair amount of flexibility of what can be achieved.  As a rule,</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- the resulting @Assertion@ should be the body of a 'TestCase' or part of</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- a @TestCase@; it should not be used to assert multiple, independent</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- conditions.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- If more complex arrangements of assertions are needed, 'Test's and</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- 'Testable' should be used.</span><span>
</span><span id="line-88"></span><span class="hs-keyword">class</span><span> </span><span id="Assertable"><span class="annot"><a href="Test.HUnit.Base.html#Assertable"><span class="hs-identifier hs-var">Assertable</span></a></span></span><span> </span><span id="local-6989586621679034855"><span class="annot"><a href="#local-6989586621679034855"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-89"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="assert"><span class="annot"><a href="Test.HUnit.Base.html#assert"><span class="hs-identifier hs-type">assert</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Assertion</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Assertable"><span class="hs-identifier hs-type">Assertable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034716"><span class="annot"><span class="annottext">assert :: HasCallStack =&gt; () -&gt; Assertion
</span><a href="#local-6989586621679034716"><span class="hs-identifier hs-var hs-var hs-var hs-var">assert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Assertable"><span class="hs-identifier hs-type">Assertable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-95"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034710"><span class="annot"><span class="annottext">assert :: HasCallStack =&gt; Bool -&gt; Assertion
</span><a href="#local-6989586621679034710"><span class="hs-identifier hs-var hs-var hs-var hs-var">assert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
</span><a href="Test.HUnit.Base.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679034849"><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#ListAssertable"><span class="hs-identifier hs-type">ListAssertable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679034849"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Assertable"><span class="hs-identifier hs-type">Assertable</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679034849"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-98"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034702"><span class="annot"><span class="annottext">assert :: HasCallStack =&gt; [t] -&gt; Assertion
</span><a href="#local-6989586621679034702"><span class="hs-identifier hs-var hs-var hs-var hs-var">assert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. (ListAssertable t, HasCallStack) =&gt; [t] -&gt; Assertion
</span><a href="Test.HUnit.Base.html#listAssert"><span class="hs-identifier hs-var">listAssert</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679034847"><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#Assertable"><span class="hs-identifier hs-type">Assertable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679034847"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Assertable"><span class="hs-identifier hs-type">Assertable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679034847"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-101"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034692"><span class="annot"><span class="annottext">assert :: HasCallStack =&gt; IO t -&gt; Assertion
</span><a href="#local-6989586621679034692"><span class="hs-identifier hs-var hs-var hs-var hs-var">assert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Assertable t, HasCallStack) =&gt; t -&gt; Assertion
</span><a href="Test.HUnit.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | A specialized form of 'Assertable' to handle lists.</span><span>
</span><span id="line-104"></span><span class="hs-keyword">class</span><span> </span><span id="ListAssertable"><span class="annot"><a href="Test.HUnit.Base.html#ListAssertable"><span class="hs-identifier hs-var">ListAssertable</span></a></span></span><span> </span><span id="local-6989586621679034844"><span class="annot"><a href="#local-6989586621679034844"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-105"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="listAssert"><span class="annot"><a href="Test.HUnit.Base.html#listAssert"><span class="hs-identifier hs-type">listAssert</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Assertion</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#ListAssertable"><span class="hs-identifier hs-type">ListAssertable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-108"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034685"><span class="annot"><span class="annottext">listAssert :: HasCallStack =&gt; String -&gt; Assertion
</span><a href="#local-6989586621679034685"><span class="hs-identifier hs-var hs-var hs-var hs-var">listAssert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Assertion
</span><a href="Test.HUnit.Base.html#assertString"><span class="hs-identifier hs-var">assertString</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- Overloaded `assertionPredicate` Function</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- ----------------------------------------</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | The result of an assertion that hasn't been evaluated yet.</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- Most test cases follow the following steps:</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- 1. Do some processing or an action.</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- 2. Assert certain conditions.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- However, this flow is not always suitable.  @AssertionPredicate@ allows for</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- additional steps to be inserted without the initial action to be affected</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- by side effects.  Additionally, clean-up can be done before the test case</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- has a chance to end.  A potential work flow is:</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- 1. Write data to a file.</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- 2. Read data from a file, evaluate conditions.</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- 3. Clean up the file.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- 4. Assert that the side effects of the read operation meet certain conditions.</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- 5. Assert that the conditions evaluated in step 2 are met.</span><span>
</span><span id="line-136"></span><span class="hs-keyword">type</span><span> </span><span id="AssertionPredicate"><span class="annot"><a href="Test.HUnit.Base.html#AssertionPredicate"><span class="hs-identifier hs-var">AssertionPredicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Used to signify that a data type can be converted to an assertion</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- predicate.</span><span>
</span><span id="line-140"></span><span class="hs-keyword">class</span><span> </span><span id="AssertionPredicable"><span class="annot"><a href="Test.HUnit.Base.html#AssertionPredicable"><span class="hs-identifier hs-var">AssertionPredicable</span></a></span></span><span> </span><span id="local-6989586621679034842"><span class="annot"><a href="#local-6989586621679034842"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-141"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="assertionPredicate"><span class="annot"><a href="Test.HUnit.Base.html#assertionPredicate"><span class="hs-identifier hs-type">assertionPredicate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679034842"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#AssertionPredicate"><span class="hs-identifier hs-type">AssertionPredicate</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#AssertionPredicable"><span class="hs-identifier hs-type">AssertionPredicable</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-144"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034679"><span class="annot"><span class="annottext">assertionPredicate :: Bool -&gt; AssertionPredicate
</span><a href="#local-6989586621679034679"><span class="hs-identifier hs-var hs-var hs-var hs-var">assertionPredicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679034839"><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#AssertionPredicable"><span class="hs-identifier hs-type">AssertionPredicable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679034839"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#AssertionPredicable"><span class="hs-identifier hs-type">AssertionPredicable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679034839"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-147"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034673"><span class="annot"><span class="annottext">assertionPredicate :: IO t -&gt; AssertionPredicate
</span><a href="#local-6989586621679034673"><span class="hs-identifier hs-var hs-var hs-var hs-var">assertionPredicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall t. AssertionPredicable t =&gt; t -&gt; AssertionPredicate
</span><a href="Test.HUnit.Base.html#assertionPredicate"><span class="hs-identifier hs-var">assertionPredicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- Assertion Construction Operators</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- --------------------------------</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">infix</span><span>  </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#%40%3F"><span class="hs-operator hs-type">@?</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#%40%3D%3F"><span class="hs-operator hs-type">@=?</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#%40%3F%3D"><span class="hs-operator hs-type">@?=</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Asserts that the condition obtained from the specified</span><span>
</span><span id="line-156"></span><span class="hs-comment">--   'AssertionPredicable' holds.</span><span>
</span><span id="line-157"></span><span id="local-6989586621679034838"><span class="annot"><a href="Test.HUnit.Base.html#%40%3F"><span class="hs-operator hs-type">(@?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-identifier">AssertionPredicable</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-158"></span><span>                                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">t</span><span>          </span><span class="hs-comment">-- ^ A value of which the asserted condition is predicated</span><span>
</span><span id="line-159"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span>     </span><span class="hs-comment">-- ^ A message that is displayed if the assertion fails</span><span>
</span><span id="line-160"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Assertion</span></span><span>
</span><span id="line-161"></span><span id="local-6989586621679034666"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679034666"><span class="hs-identifier hs-var">predi</span></a></span></span><span> </span><span id="%40%3F"><span class="annot"><span class="annottext">@? :: forall t.
(HasCallStack, AssertionPredicable t) =&gt;
t -&gt; String -&gt; Assertion
</span><a href="Test.HUnit.Base.html#%40%3F"><span class="hs-operator hs-var hs-var">@?</span></a></span></span><span> </span><span id="local-6989586621679034665"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034665"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t. AssertionPredicable t =&gt; t -&gt; AssertionPredicate
</span><a href="Test.HUnit.Base.html#assertionPredicate"><span class="hs-identifier hs-var">assertionPredicate</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679034666"><span class="hs-identifier hs-var">predi</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
</span><a href="Test.HUnit.Base.html#assertBool"><span class="hs-identifier hs-var">assertBool</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034665"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Asserts that the specified actual value is equal to the expected value</span><span>
</span><span id="line-164"></span><span class="hs-comment">--   (with the expected value on the left-hand side).</span><span>
</span><span id="line-165"></span><span id="local-6989586621679034836"><span class="annot"><a href="Test.HUnit.Base.html#%40%3D%3F"><span class="hs-operator hs-type">(@=?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-comment">-- ^ The expected value</span><span>
</span><span id="line-167"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-comment">-- ^ The actual value</span><span>
</span><span id="line-168"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Assertion</span></span><span>
</span><span id="line-169"></span><span id="local-6989586621679034657"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034657"><span class="hs-identifier hs-var">expected</span></a></span></span><span> </span><span id="%40%3D%3F"><span class="annot"><span class="annottext">@=? :: forall a. (HasCallStack, Eq a, Show a) =&gt; a -&gt; a -&gt; Assertion
</span><a href="Test.HUnit.Base.html#%40%3D%3F"><span class="hs-operator hs-var hs-var">@=?</span></a></span></span><span> </span><span id="local-6989586621679034656"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034656"><span class="hs-identifier hs-var">actual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(HasCallStack, Eq a, Show a) =&gt;
String -&gt; a -&gt; a -&gt; Assertion
</span><a href="Test.HUnit.Lang.html#assertEqual"><span class="hs-identifier hs-var">assertEqual</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034657"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034656"><span class="hs-identifier hs-var">actual</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Asserts that the specified actual value is equal to the expected value</span><span>
</span><span id="line-172"></span><span class="hs-comment">--   (with the actual value on the left-hand side).</span><span>
</span><span id="line-173"></span><span id="local-6989586621679034655"><span class="annot"><a href="Test.HUnit.Base.html#%40%3F%3D"><span class="hs-operator hs-type">(@?=)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-comment">-- ^ The actual value</span><span>
</span><span id="line-175"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-comment">-- ^ The expected value</span><span>
</span><span id="line-176"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Assertion</span></span><span>
</span><span id="line-177"></span><span id="local-6989586621679034647"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034647"><span class="hs-identifier hs-var">actual</span></a></span></span><span> </span><span id="%40%3F%3D"><span class="annot"><span class="annottext">@?= :: forall a. (HasCallStack, Eq a, Show a) =&gt; a -&gt; a -&gt; Assertion
</span><a href="Test.HUnit.Base.html#%40%3F%3D"><span class="hs-operator hs-var hs-var">@?=</span></a></span></span><span> </span><span id="local-6989586621679034646"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034646"><span class="hs-identifier hs-var">expected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(HasCallStack, Eq a, Show a) =&gt;
String -&gt; a -&gt; a -&gt; Assertion
</span><a href="Test.HUnit.Lang.html#assertEqual"><span class="hs-identifier hs-var">assertEqual</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034646"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034647"><span class="hs-identifier hs-var">actual</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- Test Definition</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- ===============</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | The basic structure used to create an annotated tree of test cases.</span><span>
</span><span id="line-185"></span><span class="hs-keyword">data</span><span> </span><span id="Test"><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier hs-var">Test</span></a></span></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-comment">-- | A single, independent test case composed.</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="TestCase"><span class="annot"><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-var">TestCase</span></a></span></span><span> </span><span class="annot"><a href="Test.HUnit.Lang.html#Assertion"><span class="hs-identifier hs-type">Assertion</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- | A set of @Test@s sharing the same level in the hierarchy.</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TestList"><span class="annot"><a href="Test.HUnit.Base.html#TestList"><span class="hs-identifier hs-var">TestList</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-comment">-- | A name or description for a subtree of the @Test@s.</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TestLabel"><span class="annot"><a href="Test.HUnit.Base.html#TestLabel"><span class="hs-identifier hs-var">TestLabel</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679034638"><span id="local-6989586621679034640"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier hs-type">Test</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679034634"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; Test -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">showsPrec</span></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-type">TestCase</span></a></span><span> </span><span class="annot"><span class="annottext">Assertion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TestCase _&quot;</span></span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestList"><span class="hs-identifier hs-type">TestList</span></a></span><span> </span><span id="local-6989586621679034631"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679034631"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TestList &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; [a] -&gt; ShowS
</span><span class="hs-identifier hs-var">showList</span></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679034631"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span id="local-6989586621679034628"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034628"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestLabel"><span class="hs-identifier hs-type">TestLabel</span></a></span><span> </span><span id="local-6989586621679034627"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034627"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679034626"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034626"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TestLabel &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034627"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-197"></span><span>                                </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034628"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034626"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- Overloaded `test` Function</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- --------------------------</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Provides a way to convert data into a @Test@ or set of @Test@.</span><span>
</span><span id="line-203"></span><span class="hs-keyword">class</span><span> </span><span id="Testable"><span class="annot"><a href="Test.HUnit.Base.html#Testable"><span class="hs-identifier hs-var">Testable</span></a></span></span><span> </span><span id="local-6989586621679034827"><span class="annot"><a href="#local-6989586621679034827"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-204"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="test"><span class="annot"><a href="Test.HUnit.Base.html#test"><span class="hs-identifier hs-type">test</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Test</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-207"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034619"><span class="annot"><span class="annottext">test :: HasCallStack =&gt; Test -&gt; Test
</span><a href="#local-6989586621679034619"><span class="hs-identifier hs-var hs-var hs-var hs-var">test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679034823"><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#Assertable"><span class="hs-identifier hs-type">Assertable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679034823"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679034823"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-210"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034610"><span class="annot"><span class="annottext">test :: HasCallStack =&gt; IO t -&gt; Test
</span><a href="#local-6989586621679034610"><span class="hs-identifier hs-var hs-var hs-var hs-var">test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; Test
</span><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-var">TestCase</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Assertable t, HasCallStack) =&gt; t -&gt; Assertion
</span><a href="Test.HUnit.Base.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679034821"><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679034821"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Testable"><span class="hs-identifier hs-type">Testable</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679034821"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-213"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034602"><span class="annot"><span class="annottext">test :: HasCallStack =&gt; [t] -&gt; Test
</span><a href="#local-6989586621679034602"><span class="hs-identifier hs-var hs-var hs-var hs-var">test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Test] -&gt; Test
</span><a href="Test.HUnit.Base.html#TestList"><span class="hs-identifier hs-var">TestList</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Testable t, HasCallStack) =&gt; t -&gt; Test
</span><a href="Test.HUnit.Base.html#test"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- Test Construction Operators</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- ---------------------------</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">infix</span><span>  </span><span class="hs-number">1</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#~%3F"><span class="hs-operator hs-type">~?</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#~%3D%3F"><span class="hs-operator hs-type">~=?</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#~%3F%3D"><span class="hs-operator hs-type">~?=</span></a></span><span>
</span><span id="line-220"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#~%3A"><span class="hs-operator hs-type">~:</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | Creates a test case resulting from asserting the condition obtained</span><span>
</span><span id="line-223"></span><span class="hs-comment">--   from the specified 'AssertionPredicable'.</span><span>
</span><span id="line-224"></span><span id="local-6989586621679034818"><span class="annot"><a href="Test.HUnit.Base.html#~%3F"><span class="hs-operator hs-type">(~?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-identifier">AssertionPredicable</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-225"></span><span>                                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">t</span><span>       </span><span class="hs-comment">-- ^ A value of which the asserted condition is predicated</span><span>
</span><span id="line-226"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span>  </span><span class="hs-comment">-- ^ A message that is displayed on test failure</span><span>
</span><span id="line-227"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Test</span></span><span>
</span><span id="line-228"></span><span id="local-6989586621679034596"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679034596"><span class="hs-identifier hs-var">predi</span></a></span></span><span> </span><span id="~%3F"><span class="annot"><span class="annottext">~? :: forall t.
(HasCallStack, AssertionPredicable t) =&gt;
t -&gt; String -&gt; Test
</span><a href="Test.HUnit.Base.html#~%3F"><span class="hs-operator hs-var hs-var">~?</span></a></span></span><span> </span><span id="local-6989586621679034595"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034595"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; Test
</span><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-var">TestCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679034596"><span class="hs-identifier hs-var">predi</span></a></span><span> </span><span class="annot"><span class="annottext">forall t.
(HasCallStack, AssertionPredicable t) =&gt;
t -&gt; String -&gt; Assertion
</span><a href="Test.HUnit.Base.html#%40%3F"><span class="hs-operator hs-var">@?</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034595"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Shorthand for a test case that asserts equality (with the expected</span><span>
</span><span id="line-231"></span><span class="hs-comment">--   value on the left-hand side, and the actual value on the right-hand</span><span>
</span><span id="line-232"></span><span class="hs-comment">--   side).</span><span>
</span><span id="line-233"></span><span id="local-6989586621679034816"><span class="annot"><a href="Test.HUnit.Base.html#~%3D%3F"><span class="hs-operator hs-type">(~=?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span>     </span><span class="hs-comment">-- ^ The expected value</span><span>
</span><span id="line-235"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>     </span><span class="hs-comment">-- ^ The actual value</span><span>
</span><span id="line-236"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Test</span></span><span>
</span><span id="line-237"></span><span id="local-6989586621679034587"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034587"><span class="hs-identifier hs-var">expected</span></a></span></span><span> </span><span id="~%3D%3F"><span class="annot"><span class="annottext">~=? :: forall a. (HasCallStack, Eq a, Show a) =&gt; a -&gt; a -&gt; Test
</span><a href="Test.HUnit.Base.html#~%3D%3F"><span class="hs-operator hs-var hs-var">~=?</span></a></span></span><span> </span><span id="local-6989586621679034586"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034586"><span class="hs-identifier hs-var">actual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; Test
</span><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-var">TestCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034587"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (HasCallStack, Eq a, Show a) =&gt; a -&gt; a -&gt; Assertion
</span><a href="Test.HUnit.Base.html#%40%3D%3F"><span class="hs-operator hs-var">@=?</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034586"><span class="hs-identifier hs-var">actual</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- | Shorthand for a test case that asserts equality (with the actual</span><span>
</span><span id="line-240"></span><span class="hs-comment">--   value on the left-hand side, and the expected value on the right-hand</span><span>
</span><span id="line-241"></span><span class="hs-comment">--   side).</span><span>
</span><span id="line-242"></span><span id="local-6989586621679034585"><span class="annot"><a href="Test.HUnit.Base.html#~%3F%3D"><span class="hs-operator hs-type">(~?=)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span>     </span><span class="hs-comment">-- ^ The actual value</span><span>
</span><span id="line-244"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>     </span><span class="hs-comment">-- ^ The expected value</span><span>
</span><span id="line-245"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Test</span></span><span>
</span><span id="line-246"></span><span id="local-6989586621679034577"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034577"><span class="hs-identifier hs-var">actual</span></a></span></span><span> </span><span id="~%3F%3D"><span class="annot"><span class="annottext">~?= :: forall a. (HasCallStack, Eq a, Show a) =&gt; a -&gt; a -&gt; Test
</span><a href="Test.HUnit.Base.html#~%3F%3D"><span class="hs-operator hs-var hs-var">~?=</span></a></span></span><span> </span><span id="local-6989586621679034576"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034576"><span class="hs-identifier hs-var">expected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; Test
</span><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-var">TestCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034577"><span class="hs-identifier hs-var">actual</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (HasCallStack, Eq a, Show a) =&gt; a -&gt; a -&gt; Assertion
</span><a href="Test.HUnit.Base.html#%40%3F%3D"><span class="hs-operator hs-var">@?=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679034576"><span class="hs-identifier hs-var">expected</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Creates a test from the specified 'Testable', with the specified</span><span>
</span><span id="line-249"></span><span class="hs-comment">--   label attached to it.</span><span>
</span><span id="line-250"></span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- Since 'Test' is @Testable@, this can be used as a shorthand way of attaching</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- a 'TestLabel' to one or more tests.</span><span>
</span><span id="line-253"></span><span id="local-6989586621679034813"><span class="annot"><a href="Test.HUnit.Base.html#~%3A"><span class="hs-operator hs-type">(~:)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">HasCallStack_</span><span> </span><span class="hs-identifier">Testable</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Test</span></span><span>
</span><span id="line-254"></span><span id="local-6989586621679034570"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034570"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="~%3A"><span class="annot"><span class="annottext">~: :: forall t. (HasCallStack, Testable t) =&gt; String -&gt; t -&gt; Test
</span><a href="Test.HUnit.Base.html#~%3A"><span class="hs-operator hs-var hs-var">~:</span></a></span></span><span> </span><span id="local-6989586621679034569"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679034569"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Test -&gt; Test
</span><a href="Test.HUnit.Base.html#TestLabel"><span class="hs-identifier hs-var">TestLabel</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034570"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall t. (Testable t, HasCallStack) =&gt; t -&gt; Test
</span><a href="Test.HUnit.Base.html#test"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679034569"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- Test Execution</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- ==============</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- $testExecutionNote</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- Note: the rest of the functionality in this module is intended for</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- implementors of test controllers. If you just want to run your tests cases,</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- simply use a test controller, such as the text-based controller in</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- &quot;Test.HUnit.Text&quot;.</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | A data structure that hold the results of tests that have been performed</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- up until this point.</span><span>
</span><span id="line-269"></span><span class="hs-keyword">data</span><span> </span><span id="Counts"><span class="annot"><a href="Test.HUnit.Base.html#Counts"><span class="hs-identifier hs-var">Counts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Counts"><span class="annot"><a href="Test.HUnit.Base.html#Counts"><span class="hs-identifier hs-var">Counts</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="cases"><span class="annot"><span class="annottext">Counts -&gt; Int
</span><a href="Test.HUnit.Base.html#cases"><span class="hs-identifier hs-var hs-var">cases</span></a></span></span><span class="hs-special">,</span><span> </span><span id="tried"><span class="annot"><span class="annottext">Counts -&gt; Int
</span><a href="Test.HUnit.Base.html#tried"><span class="hs-identifier hs-var hs-var">tried</span></a></span></span><span class="hs-special">,</span><span> </span><span id="errors"><span class="annot"><span class="annottext">Counts -&gt; Int
</span><a href="Test.HUnit.Base.html#errors"><span class="hs-identifier hs-var hs-var">errors</span></a></span></span><span class="hs-special">,</span><span> </span><span id="failures"><span class="annot"><span class="annottext">Counts -&gt; Int
</span><a href="Test.HUnit.Base.html#failures"><span class="hs-identifier hs-var hs-var">failures</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034555"><span id="local-6989586621679034562"><span class="annot"><span class="annottext">Counts -&gt; Counts -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Counts -&gt; Counts -&gt; Bool
$c/= :: Counts -&gt; Counts -&gt; Bool
== :: Counts -&gt; Counts -&gt; Bool
$c== :: Counts -&gt; Counts -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034541"><span id="local-6989586621679034543"><span id="local-6989586621679034552"><span class="annot"><span class="annottext">Int -&gt; Counts -&gt; ShowS
[Counts] -&gt; ShowS
Counts -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Counts] -&gt; ShowS
$cshowList :: [Counts] -&gt; ShowS
show :: Counts -&gt; String
$cshow :: Counts -&gt; String
showsPrec :: Int -&gt; Counts -&gt; ShowS
$cshowsPrec :: Int -&gt; Counts -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034515"><span id="local-6989586621679034534"><span id="local-6989586621679034537"><span id="local-6989586621679034539"><span class="annot"><span class="annottext">ReadPrec [Counts]
ReadPrec Counts
Int -&gt; ReadS Counts
ReadS [Counts]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Counts]
$creadListPrec :: ReadPrec [Counts]
readPrec :: ReadPrec Counts
$creadPrec :: ReadPrec Counts
readList :: ReadS [Counts]
$creadList :: ReadS [Counts]
readsPrec :: Int -&gt; ReadS Counts
$creadsPrec :: Int -&gt; ReadS Counts
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Keeps track of the remaining tests and the results of the performed tests.</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- As each test is performed, the path is removed and the counts are</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- updated as appropriate.</span><span>
</span><span id="line-275"></span><span class="hs-keyword">data</span><span> </span><span id="State"><span class="annot"><a href="Test.HUnit.Base.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="State"><span class="annot"><a href="Test.HUnit.Base.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="path"><span class="annot"><span class="annottext">State -&gt; Path
</span><a href="Test.HUnit.Base.html#path"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span class="hs-special">,</span><span> </span><span id="counts"><span class="annot"><span class="annottext">State -&gt; Counts
</span><a href="Test.HUnit.Base.html#counts"><span class="hs-identifier hs-var hs-var">counts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Counts"><span class="hs-identifier hs-type">Counts</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034502"><span id="local-6989586621679034508"><span class="annot"><span class="annottext">State -&gt; State -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: State -&gt; State -&gt; Bool
$c/= :: State -&gt; State -&gt; Bool
== :: State -&gt; State -&gt; Bool
$c== :: State -&gt; State -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034491"><span id="local-6989586621679034493"><span id="local-6989586621679034500"><span class="annot"><span class="annottext">Int -&gt; State -&gt; ShowS
[State] -&gt; ShowS
State -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [State] -&gt; ShowS
$cshowList :: [State] -&gt; ShowS
show :: State -&gt; String
$cshow :: State -&gt; String
showsPrec :: Int -&gt; State -&gt; ShowS
$cshowsPrec :: Int -&gt; State -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034471"><span id="local-6989586621679034484"><span id="local-6989586621679034487"><span id="local-6989586621679034489"><span class="annot"><span class="annottext">ReadPrec [State]
ReadPrec State
Int -&gt; ReadS State
ReadS [State]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [State]
$creadListPrec :: ReadPrec [State]
readPrec :: ReadPrec State
$creadPrec :: ReadPrec State
readList :: ReadS [State]
$creadList :: ReadS [State]
readsPrec :: Int -&gt; ReadS State
$creadsPrec :: Int -&gt; ReadS State
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Report generator for reporting the start of a test run.</span><span>
</span><span id="line-279"></span><span class="hs-keyword">type</span><span> </span><span id="ReportStart"><span class="annot"><a href="Test.HUnit.Base.html#ReportStart"><span class="hs-identifier hs-var">ReportStart</span></a></span></span><span> </span><span id="local-6989586621679034469"><span class="annot"><a href="#local-6989586621679034469"><span class="hs-identifier hs-type">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679034469"><span class="hs-identifier hs-type">us</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679034469"><span class="hs-identifier hs-type">us</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Report generator for reporting problems that have occurred during</span><span>
</span><span id="line-282"></span><span class="hs-comment">--   a test run. Problems may be errors or assertion failures.</span><span>
</span><span id="line-283"></span><span class="hs-keyword">type</span><span> </span><span id="ReportProblem"><span class="annot"><a href="Test.HUnit.Base.html#ReportProblem"><span class="hs-identifier hs-var">ReportProblem</span></a></span></span><span> </span><span id="local-6989586621679034468"><span class="annot"><a href="#local-6989586621679034468"><span class="hs-identifier hs-type">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SrcLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679034468"><span class="hs-identifier hs-type">us</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679034468"><span class="hs-identifier hs-type">us</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | Uniquely describes the location of a test within a test hierarchy.</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- Node order is from test case to root.</span><span>
</span><span id="line-287"></span><span class="hs-keyword">type</span><span> </span><span id="Path"><span class="annot"><a href="Test.HUnit.Base.html#Path"><span class="hs-identifier hs-var">Path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.HUnit.Base.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | Composed into 'Path's.</span><span>
</span><span id="line-290"></span><span class="hs-keyword">data</span><span> </span><span id="Node"><span class="annot"><a href="Test.HUnit.Base.html#Node"><span class="hs-identifier hs-var">Node</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ListItem"><span class="annot"><a href="Test.HUnit.Base.html#ListItem"><span class="hs-identifier hs-var">ListItem</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Label"><span class="annot"><a href="Test.HUnit.Base.html#Label"><span class="hs-identifier hs-var">Label</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034459"><span id="local-6989586621679034464"><span class="annot"><span class="annottext">Node -&gt; Node -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Node -&gt; Node -&gt; Bool
$c/= :: Node -&gt; Node -&gt; Bool
== :: Node -&gt; Node -&gt; Bool
$c== :: Node -&gt; Node -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034447"><span id="local-6989586621679034449"><span id="local-6989586621679034456"><span class="annot"><span class="annottext">Int -&gt; Node -&gt; ShowS
Path -&gt; ShowS
Node -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: Path -&gt; ShowS
$cshowList :: Path -&gt; ShowS
show :: Node -&gt; String
$cshow :: Node -&gt; String
showsPrec :: Int -&gt; Node -&gt; ShowS
$cshowsPrec :: Int -&gt; Node -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034428"><span id="local-6989586621679034439"><span id="local-6989586621679034442"><span id="local-6989586621679034444"><span class="annot"><span class="annottext">ReadPrec Path
ReadPrec Node
Int -&gt; ReadS Node
ReadS Path
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec Path
$creadListPrec :: ReadPrec Path
readPrec :: ReadPrec Node
$creadPrec :: ReadPrec Node
readList :: ReadS Path
$creadList :: ReadS Path
readsPrec :: Int -&gt; ReadS Node
$creadsPrec :: Int -&gt; ReadS Node
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Determines the paths for all 'TestCase's in a tree of @Test@s.</span><span>
</span><span id="line-294"></span><span class="annot"><a href="Test.HUnit.Base.html#testCasePaths"><span class="hs-identifier hs-type">testCasePaths</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.HUnit.Base.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span id="testCasePaths"><span class="annot"><span class="annottext">testCasePaths :: Test -&gt; [Path]
</span><a href="Test.HUnit.Base.html#testCasePaths"><span class="hs-identifier hs-var hs-var">testCasePaths</span></a></span></span><span> </span><span id="local-6989586621679034425"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034425"><span class="hs-identifier hs-var">t0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test -&gt; Path -&gt; [Path]
</span><a href="#local-6989586621679034424"><span class="hs-identifier hs-var">tcp</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034425"><span class="hs-identifier hs-var">t0</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034424"><span class="annot"><span class="annottext">tcp :: Test -&gt; Path -&gt; [Path]
</span><a href="#local-6989586621679034424"><span class="hs-identifier hs-var hs-var">tcp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-type">TestCase</span></a></span><span> </span><span class="annot"><span class="annottext">Assertion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679034419"><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679034419"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679034419"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>       </span><span class="annot"><a href="#local-6989586621679034424"><span class="hs-identifier hs-var">tcp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestList"><span class="hs-identifier hs-type">TestList</span></a></span><span> </span><span id="local-6989586621679034418"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679034418"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679034417"><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679034417"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-298"></span><span>         </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Test -&gt; Path -&gt; [Path]
</span><a href="#local-6989586621679034424"><span class="hs-identifier hs-var">tcp</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034415"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Node
</span><a href="Test.HUnit.Base.html#ListItem"><span class="hs-identifier hs-var">ListItem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034414"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679034417"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034415"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034415"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679034414"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034414"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679034418"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>       </span><span class="annot"><a href="#local-6989586621679034424"><span class="hs-identifier hs-var">tcp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestLabel"><span class="hs-identifier hs-type">TestLabel</span></a></span><span> </span><span id="local-6989586621679034413"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034413"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679034412"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034412"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679034411"><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679034411"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test -&gt; Path -&gt; [Path]
</span><a href="#local-6989586621679034424"><span class="hs-identifier hs-var">tcp</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034412"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Node
</span><a href="Test.HUnit.Base.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034413"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679034411"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-comment">-- | Counts the number of 'TestCase's in a tree of @Test@s.</span><span>
</span><span id="line-302"></span><span class="annot"><a href="Test.HUnit.Base.html#testCaseCount"><span class="hs-identifier hs-type">testCaseCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-303"></span><span id="testCaseCount"><span class="annot"><span class="annottext">testCaseCount :: Test -&gt; Int
</span><a href="Test.HUnit.Base.html#testCaseCount"><span class="hs-identifier hs-var hs-var">testCaseCount</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-type">TestCase</span></a></span><span> </span><span class="annot"><span class="annottext">Assertion
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Test.HUnit.Base.html#testCaseCount"><span class="hs-identifier hs-var">testCaseCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestList"><span class="hs-identifier hs-type">TestList</span></a></span><span> </span><span id="local-6989586621679034410"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679034410"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Test -&gt; Int
</span><a href="Test.HUnit.Base.html#testCaseCount"><span class="hs-identifier hs-var">testCaseCount</span></a></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679034410"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span class="annot"><a href="Test.HUnit.Base.html#testCaseCount"><span class="hs-identifier hs-var">testCaseCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestLabel"><span class="hs-identifier hs-type">TestLabel</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679034408"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034408"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test -&gt; Int
</span><a href="Test.HUnit.Base.html#testCaseCount"><span class="hs-identifier hs-var">testCaseCount</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034408"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Performs a test run with the specified report generators.</span><span>
</span><span id="line-308"></span><span class="hs-comment">--</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- This handles the actual running of the tests.  Most developers will want</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- to use @HUnit.Text.runTestTT@ instead.  A developer could use this function</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- to execute tests via another IO system, such as a GUI, or to output the</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- results in a different manner (e.g., upload XML-formatted results to a</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- webservice).</span><span>
</span><span id="line-314"></span><span class="hs-comment">--</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- Note that the counts in a start report do not include the test case</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- being started, whereas the counts in a problem report do include the</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- test case just finished.  The principle is that the counts are sampled</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- only between test case executions.  As a result, the number of test</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- case successes always equals the difference of test cases tried and</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- the sum of test case errors and failures.</span><span>
</span><span id="line-321"></span><span id="local-6989586621679034797"><span class="annot"><a href="Test.HUnit.Base.html#performTest"><span class="hs-identifier hs-type">performTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#ReportStart"><span class="hs-identifier hs-type">ReportStart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679034797"><span class="hs-identifier hs-type">us</span></a></span><span>   </span><span class="hs-comment">-- ^ report generator for the test run start</span><span>
</span><span id="line-322"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#ReportProblem"><span class="hs-identifier hs-type">ReportProblem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679034797"><span class="hs-identifier hs-type">us</span></a></span><span> </span><span class="hs-comment">-- ^ report generator for errors during the test run</span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#ReportProblem"><span class="hs-identifier hs-type">ReportProblem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679034797"><span class="hs-identifier hs-type">us</span></a></span><span> </span><span class="hs-comment">-- ^ report generator for assertion failures during the test run</span><span>
</span><span id="line-324"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679034797"><span class="hs-identifier hs-type">us</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>             </span><span class="hs-comment">-- ^ the test to be executed</span><span>
</span><span id="line-326"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#Counts"><span class="hs-identifier hs-type">Counts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679034797"><span class="hs-identifier hs-type">us</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-327"></span><span id="performTest"><span class="annot"><span class="annottext">performTest :: forall us.
ReportStart us
-&gt; ReportProblem us
-&gt; ReportProblem us
-&gt; us
-&gt; Test
-&gt; IO (Counts, us)
</span><a href="Test.HUnit.Base.html#performTest"><span class="hs-identifier hs-var hs-var">performTest</span></a></span></span><span> </span><span id="local-6989586621679034400"><span class="annot"><span class="annottext">ReportStart us
</span><a href="#local-6989586621679034400"><span class="hs-identifier hs-var">reportStart</span></a></span></span><span> </span><span id="local-6989586621679034399"><span class="annot"><span class="annottext">ReportProblem us
</span><a href="#local-6989586621679034399"><span class="hs-identifier hs-var">reportError</span></a></span></span><span> </span><span id="local-6989586621679034398"><span class="annot"><span class="annottext">ReportProblem us
</span><a href="#local-6989586621679034398"><span class="hs-identifier hs-var">reportFailure</span></a></span></span><span> </span><span id="local-6989586621679034397"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034397"><span class="hs-identifier hs-var">initialUs</span></a></span></span><span> </span><span id="local-6989586621679034396"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034396"><span class="hs-identifier hs-var">initialT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679034395"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034395"><span class="hs-identifier hs-var">ss'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034394"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034394"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; us -&gt; Test -&gt; IO (State, us)
</span><a href="#local-6989586621679034393"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034392"><span class="hs-identifier hs-var">initState</span></a></span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034397"><span class="hs-identifier hs-var">initialUs</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034396"><span class="hs-identifier hs-var">initialT</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Path
</span><a href="Test.HUnit.Base.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034395"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;performTest: Final path is nonnull&quot;</span></span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Counts
</span><a href="Test.HUnit.Base.html#counts"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034395"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034394"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621679034392"><span class="annot"><span class="annottext">initState :: State
</span><a href="#local-6989586621679034392"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#State"><span class="hs-identifier hs-type">State</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">path :: Path
</span><a href="Test.HUnit.Base.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">counts :: Counts
</span><a href="Test.HUnit.Base.html#counts"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Counts
</span><a href="#local-6989586621679034390"><span class="hs-identifier hs-var">initCounts</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679034390"><span class="annot"><span class="annottext">initCounts :: Counts
</span><a href="#local-6989586621679034390"><span class="hs-identifier hs-var hs-var">initCounts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.HUnit.Base.html#Counts"><span class="hs-identifier hs-type">Counts</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">cases :: Int
</span><a href="Test.HUnit.Base.html#cases"><span class="hs-identifier hs-var">cases</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test -&gt; Int
</span><a href="Test.HUnit.Base.html#testCaseCount"><span class="hs-identifier hs-var">testCaseCount</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034396"><span class="hs-identifier hs-var">initialT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tried :: Int
</span><a href="Test.HUnit.Base.html#tried"><span class="hs-identifier hs-var">tried</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span>
</span><span id="line-334"></span><span>                       </span><span class="annot"><span class="annottext">errors :: Int
</span><a href="Test.HUnit.Base.html#errors"><span class="hs-identifier hs-var">errors</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">failures :: Int
</span><a href="Test.HUnit.Base.html#failures"><span class="hs-identifier hs-var">failures</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679034393"><span class="annot"><span class="annottext">pt :: State -&gt; us -&gt; Test -&gt; IO (State, us)
</span><a href="#local-6989586621679034393"><span class="hs-identifier hs-var hs-var">pt</span></a></span></span><span> </span><span id="local-6989586621679034376"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034376"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621679034375"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034375"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestCase"><span class="hs-identifier hs-type">TestCase</span></a></span><span> </span><span id="local-6989586621679034374"><span class="annot"><span class="annottext">Assertion
</span><a href="#local-6989586621679034374"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679034373"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034373"><span class="hs-identifier hs-var">us'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReportStart us
</span><a href="#local-6989586621679034400"><span class="hs-identifier hs-var">reportStart</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034376"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034375"><span class="hs-identifier hs-var">us</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679034372"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679034372"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; IO Result
</span><a href="Test.HUnit.Lang.html#performTestCase"><span class="hs-identifier hs-var">performTestCase</span></a></span><span> </span><span class="annot"><span class="annottext">Assertion
</span><a href="#local-6989586621679034374"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679034372"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>      </span><span class="annot"><span class="annottext">Result
</span><a href="Test.HUnit.Lang.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034369"><span class="hs-identifier hs-var">ss'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034373"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><a href="Test.HUnit.Lang.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span id="local-6989586621679034367"><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679034367"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679034366"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034366"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>        </span><span id="local-6989586621679034365"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034365"><span class="hs-identifier hs-var">usF</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReportProblem us
</span><a href="#local-6989586621679034398"><span class="hs-identifier hs-var">reportFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679034367"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034366"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034364"><span class="hs-identifier hs-var">ssF</span></a></span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034373"><span class="hs-identifier hs-var">us'</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034364"><span class="hs-identifier hs-var">ssF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034365"><span class="hs-identifier hs-var">usF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><a href="Test.HUnit.Lang.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span id="local-6989586621679034362"><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679034362"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679034361"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034361"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>        </span><span id="local-6989586621679034360"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034360"><span class="hs-identifier hs-var">usE</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReportProblem us
</span><a href="#local-6989586621679034399"><span class="hs-identifier hs-var">reportError</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679034362"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034361"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034359"><span class="hs-identifier hs-var">ssE</span></a></span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034373"><span class="hs-identifier hs-var">us'</span></a></span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034359"><span class="hs-identifier hs-var">ssE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034360"><span class="hs-identifier hs-var">usE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034358"><span class="annot"><span class="annottext">c :: Counts
</span><a href="#local-6989586621679034358"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Test.HUnit.Base.html#Counts"><span class="hs-identifier hs-type">Counts</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tried :: Counts -&gt; Int
</span><a href="Test.HUnit.Base.html#tried"><span class="hs-identifier hs-var">tried</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679034357"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034357"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Counts
</span><a href="Test.HUnit.Base.html#counts"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034376"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-349"></span><span>         </span><span id="local-6989586621679034369"><span class="annot"><span class="annottext">ss' :: State
</span><a href="#local-6989586621679034369"><span class="hs-identifier hs-var hs-var">ss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034376"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">counts :: Counts
</span><a href="Test.HUnit.Base.html#counts"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Counts
</span><a href="#local-6989586621679034358"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tried :: Int
</span><a href="Test.HUnit.Base.html#tried"><span class="hs-identifier hs-var">tried</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034357"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-350"></span><span>         </span><span id="local-6989586621679034364"><span class="annot"><span class="annottext">ssF :: State
</span><a href="#local-6989586621679034364"><span class="hs-identifier hs-var hs-var">ssF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034376"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">counts :: Counts
</span><a href="Test.HUnit.Base.html#counts"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Counts
</span><a href="#local-6989586621679034358"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tried :: Int
</span><a href="Test.HUnit.Base.html#tried"><span class="hs-identifier hs-var">tried</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034357"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">failures :: Int
</span><a href="Test.HUnit.Base.html#failures"><span class="hs-identifier hs-var">failures</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Counts -&gt; Int
</span><a href="Test.HUnit.Base.html#failures"><span class="hs-identifier hs-var">failures</span></a></span><span> </span><span class="annot"><span class="annottext">Counts
</span><a href="#local-6989586621679034358"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-351"></span><span>         </span><span id="local-6989586621679034359"><span class="annot"><span class="annottext">ssE :: State
</span><a href="#local-6989586621679034359"><span class="hs-identifier hs-var hs-var">ssE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034376"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">counts :: Counts
</span><a href="Test.HUnit.Base.html#counts"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Counts
</span><a href="#local-6989586621679034358"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tried :: Int
</span><a href="Test.HUnit.Base.html#tried"><span class="hs-identifier hs-var">tried</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034357"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errors :: Int
</span><a href="Test.HUnit.Base.html#errors"><span class="hs-identifier hs-var">errors</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Counts -&gt; Int
</span><a href="Test.HUnit.Base.html#errors"><span class="hs-identifier hs-var">errors</span></a></span><span>   </span><span class="annot"><span class="annottext">Counts
</span><a href="#local-6989586621679034358"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>  </span><span class="annot"><a href="#local-6989586621679034393"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span id="local-6989586621679034345"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034345"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621679034344"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034344"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestList"><span class="hs-identifier hs-type">TestList</span></a></span><span> </span><span id="local-6989586621679034343"><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679034343"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">(State, us) -&gt; (Test, Int) -&gt; IO (State, us)
</span><a href="#local-6989586621679034342"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034345"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034344"><span class="hs-identifier hs-var">us</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Test]
</span><a href="#local-6989586621679034343"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034342"><span class="annot"><span class="annottext">f :: (State, us) -&gt; (Test, Int) -&gt; IO (State, us)
</span><a href="#local-6989586621679034342"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034341"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034341"><span class="hs-identifier hs-var">ss'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034340"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034340"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034339"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034339"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034338"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034338"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Node -&gt; State -&gt; us -&gt; Test -&gt; IO (State, us)
</span><a href="#local-6989586621679034337"><span class="hs-identifier hs-var">withNode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Node
</span><a href="Test.HUnit.Base.html#ListItem"><span class="hs-identifier hs-var">ListItem</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034338"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034341"><span class="hs-identifier hs-var">ss'</span></a></span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034340"><span class="hs-identifier hs-var">us'</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034339"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="#local-6989586621679034393"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span id="local-6989586621679034336"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034336"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621679034335"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034335"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.HUnit.Base.html#TestLabel"><span class="hs-identifier hs-type">TestLabel</span></a></span><span> </span><span id="local-6989586621679034334"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034334"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679034333"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034333"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Node -&gt; State -&gt; us -&gt; Test -&gt; IO (State, us)
</span><a href="#local-6989586621679034337"><span class="hs-identifier hs-var">withNode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Node
</span><a href="Test.HUnit.Base.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679034334"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034336"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034335"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034333"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>  </span><span id="local-6989586621679034337"><span class="annot"><span class="annottext">withNode :: Node -&gt; State -&gt; us -&gt; Test -&gt; IO (State, us)
</span><a href="#local-6989586621679034337"><span class="hs-identifier hs-var hs-var">withNode</span></a></span></span><span> </span><span id="local-6989586621679034332"><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679034332"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span id="local-6989586621679034331"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034331"><span class="hs-identifier hs-var">ss0</span></a></span></span><span> </span><span id="local-6989586621679034330"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034330"><span class="hs-identifier hs-var">us0</span></a></span></span><span> </span><span id="local-6989586621679034329"><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034329"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034328"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034328"><span class="hs-identifier hs-var">ss2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034327"><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034327"><span class="hs-identifier hs-var">us1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">State -&gt; us -&gt; Test -&gt; IO (State, us)
</span><a href="#local-6989586621679034393"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034326"><span class="hs-identifier hs-var">ss1</span></a></span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034330"><span class="hs-identifier hs-var">us0</span></a></span><span> </span><span class="annot"><span class="annottext">Test
</span><a href="#local-6989586621679034329"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-359"></span><span>                               </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034328"><span class="hs-identifier hs-var">ss2</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">path :: Path
</span><a href="Test.HUnit.Base.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679034325"><span class="hs-identifier hs-var">path0</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">us
</span><a href="#local-6989586621679034327"><span class="hs-identifier hs-var">us1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679034325"><span class="annot"><span class="annottext">path0 :: Path
</span><a href="#local-6989586621679034325"><span class="hs-identifier hs-var hs-var">path0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Path
</span><a href="Test.HUnit.Base.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034331"><span class="hs-identifier hs-var">ss0</span></a></span><span>
</span><span id="line-361"></span><span>         </span><span id="local-6989586621679034326"><span class="annot"><span class="annottext">ss1 :: State
</span><a href="#local-6989586621679034326"><span class="hs-identifier hs-var hs-var">ss1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679034331"><span class="hs-identifier hs-var">ss0</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">path :: Path
</span><a href="Test.HUnit.Base.html#path"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679034332"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Path
</span><a href="#local-6989586621679034325"><span class="hs-identifier hs-var">path0</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-362"></span></pre></body></html>