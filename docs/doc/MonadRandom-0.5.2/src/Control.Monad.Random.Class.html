<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP                    #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances      #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses  #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE Safe                   #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances   #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">{- |
Module       :  Control.Monad.Random.Class
Copyright    :  (c) Brent Yorgey 2016
License      :  BSD3 (see LICENSE)
Maintainer   :  byorgey@gmail.com

The 'MonadRandom', 'MonadSplit', and 'MonadInterleave' classes.

* 'MonadRandom' abstracts over monads with the capability of
  generating random values.

* 'MonadSplit' abstracts over random monads with the ability to get a
  split generator state.  It is not very useful but kept here for
  backwards compatibility.

* 'MonadInterleave' abstracts over random monads supporting an
  'interleave' operation, which allows sequencing computations which do
  not depend on each other's random generator state, by splitting the
  generator between them.

This module also defines convenience functions for sampling from a
given collection of values, either uniformly or according to given
weights.

-}</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Monad.Random.Class</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * MonadRandom</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier">MonadRandom</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * MonadSplit</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier">MonadSplit</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- * MonadInterleave</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier">MonadInterleave</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Sampling functions</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#fromList"><span class="hs-identifier">fromList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier">fromListMay</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#uniform"><span class="hs-identifier">uniform</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#uniformMay"><span class="hs-identifier">uniformMay</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#weighted"><span class="hs-identifier">weighted</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Control.Monad.Random.Class.html#weightedMay"><span class="hs-identifier">weightedMay</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Cont</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Error</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Identity</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.List</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Lazy</span></span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LazyRWS</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">StrictRWS</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Lazy</span></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LazyState</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">StrictState</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer.Lazy</span></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LazyWriter</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">StrictWriter</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Random</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span class="hs-cpp">

#if MIN_VERSION_base(4,8,0)
</span><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Monoid</span><span>                       </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-78"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- MonadRandom</span><span>
</span><span id="line-80"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | With a source of random number supply in hand, the 'MonadRandom' class</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- allows the programmer to extract random values of a variety of types.</span><span>
</span><span id="line-84"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679075469"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadRandom"><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-var">MonadRandom</span></a></span></span><span> </span><span id="local-6989586621679075469"><span class="annot"><a href="#local-6989586621679075469"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">-- | Takes a range /(lo,hi)/ and a random number generator</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-comment">-- /g/, and returns a computation that returns a random value uniformly</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">-- distributed in the closed interval /[lo,hi]/, together with a new</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">-- generator. It is unspecified what happens if /lo&gt;hi/. For continuous</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-comment">-- types there is no requirement that the values /lo/ and /hi/ are ever</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">-- produced, but they may be, depending on the implementation and the</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-comment">-- interval.</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- See 'System.Random.randomR' for details.</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621679075475"><span id="getRandomR"><span class="annot"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-type">getRandomR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Random.Random</span></span><span> </span><span class="annot"><a href="#local-6989586621679075475"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075475"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075475"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075475"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">-- | The same as 'getRandomR', but using a default range determined by the type:</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-comment">-- * For bounded types (instances of 'Bounded', such as 'Char'),</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">--   the range is normally the whole type.</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">-- * For fractional types, the range is normally the semi-closed interval</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- @[0,1)@.</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">-- * For 'Integer', the range is (arbitrarily) the range of 'Int'.</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-comment">-- See 'System.Random.random' for details.</span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679075473"><span id="getRandom"><span class="annot"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-type">getRandom</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Random.Random</span></span><span> </span><span class="annot"><a href="#local-6989586621679075473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075473"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-comment">-- | Plural variant of 'getRandomR', producing an infinite list of</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-comment">-- random values instead of returning a new generator.</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-comment">-- See 'System.Random.randomRs' for details.</span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621679075472"><span id="getRandomRs"><span class="annot"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-type">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Random.Random</span></span><span> </span><span class="annot"><a href="#local-6989586621679075472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679075472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">-- | Plural variant of 'getRandom', producing an infinite list of</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- random values instead of returning a new generator.</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- See 'System.Random.randoms' for details.</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679075471"><span id="getRandoms"><span class="annot"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-type">getRandoms</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Random.Random</span></span><span> </span><span class="annot"><a href="#local-6989586621679075471"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075469"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679075471"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679075128"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; IO a
</span><a href="#local-6989586621679075128"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; IO a
forall a. Random a =&gt; (a, a) -&gt; IO a
</span><span class="hs-identifier hs-var">Random.randomRIO</span></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679075126"><span class="annot"><span class="annottext">getRandom :: IO a
</span><a href="#local-6989586621679075126"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a
forall a. Random a =&gt; IO a
</span><span class="hs-identifier hs-var">Random.randomIO</span></span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679075124"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; IO [a]
</span><a href="#local-6989586621679075124"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span id="local-6989586621679075123"><span class="annot"><span class="annottext">lohi :: (a, a)
</span><a href="#local-6989586621679075123"><span class="hs-identifier hs-var">lohi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StdGen -&gt; [a]) -&gt; IO StdGen -&gt; IO [a]
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, a) -&gt; StdGen -&gt; [a]
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; [a]
</span><span class="hs-identifier hs-var">Random.randomRs</span></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679075123"><span class="hs-identifier hs-var">lohi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO StdGen
</span><span class="hs-identifier hs-var">Random.newStdGen</span></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679075119"><span class="annot"><span class="annottext">getRandoms :: IO [a]
</span><a href="#local-6989586621679075119"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StdGen -&gt; [a]) -&gt; IO StdGen -&gt; IO [a]
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; [a]
forall a g. (Random a, RandomGen g) =&gt; g -&gt; [a]
</span><span class="hs-identifier hs-var">Random.randoms</span></span><span> </span><span class="annot"><span class="annottext">IO StdGen
</span><span class="hs-identifier hs-var">Random.newStdGen</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621679075116"><span id="local-6989586621679075117"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075117"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ContT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075116"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075117"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621679075110"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; ContT r m a
</span><a href="#local-6989586621679075110"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ContT r m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; ContT r m a) -&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; ContT r m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679075107"><span class="annot"><span class="annottext">getRandom :: ContT r m a
</span><a href="#local-6989586621679075107"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ContT r m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679075106"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; ContT r m [a]
</span><a href="#local-6989586621679075106"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ContT r m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; ContT r m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; ContT r m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679075105"><span class="annot"><span class="annottext">getRandoms :: ContT r m [a]
</span><a href="#local-6989586621679075105"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ContT r m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621679075103"><span id="local-6989586621679075104"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679075104"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075103"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ErrorT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075104"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075103"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679075097"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; ErrorT e m a
</span><a href="#local-6989586621679075097"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ErrorT e m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; ErrorT e m a) -&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; ErrorT e m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679075096"><span class="annot"><span class="annottext">getRandom :: ErrorT e m a
</span><a href="#local-6989586621679075096"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ErrorT e m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679075095"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; ErrorT e m [a]
</span><a href="#local-6989586621679075095"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ErrorT e m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; ErrorT e m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; ErrorT e m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679075094"><span class="annot"><span class="annottext">getRandoms :: ErrorT e m [a]
</span><a href="#local-6989586621679075094"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ErrorT e m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span id="local-6989586621679075092"><span id="local-6989586621679075093"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075093"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075092"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075093"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621679075086"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; ExceptT e m a
</span><a href="#local-6989586621679075086"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ExceptT e m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; ExceptT e m a)
-&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; ExceptT e m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679075085"><span class="annot"><span class="annottext">getRandom :: ExceptT e m a
</span><a href="#local-6989586621679075085"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ExceptT e m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679075084"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; ExceptT e m [a]
</span><a href="#local-6989586621679075084"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ExceptT e m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; ExceptT e m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; ExceptT e m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679075083"><span class="annot"><span class="annottext">getRandoms :: ExceptT e m [a]
</span><a href="#local-6989586621679075083"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ExceptT e m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span id="local-6989586621679075082"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075082"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075082"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679075076"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; IdentityT m a
</span><a href="#local-6989586621679075076"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; IdentityT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; IdentityT m a)
-&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; IdentityT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679075075"><span class="annot"><span class="annottext">getRandom :: IdentityT m a
</span><a href="#local-6989586621679075075"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; IdentityT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679075074"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; IdentityT m [a]
</span><a href="#local-6989586621679075074"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; IdentityT m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; IdentityT m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; IdentityT m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679075073"><span class="annot"><span class="annottext">getRandoms :: IdentityT m [a]
</span><a href="#local-6989586621679075073"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; IdentityT m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span id="local-6989586621679075072"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075072"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075072"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621679075066"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; ListT m a
</span><a href="#local-6989586621679075066"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; ListT m a) -&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; ListT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679075065"><span class="annot"><span class="annottext">getRandom :: ListT m a
</span><a href="#local-6989586621679075065"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679075064"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; ListT m [a]
</span><a href="#local-6989586621679075064"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ListT m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; ListT m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; ListT m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679075063"><span class="annot"><span class="annottext">getRandoms :: ListT m [a]
</span><a href="#local-6989586621679075063"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ListT m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621679075062"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075062"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075062"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679075056"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; MaybeT m a
</span><a href="#local-6989586621679075056"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; MaybeT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; MaybeT m a) -&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; MaybeT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679075055"><span class="annot"><span class="annottext">getRandom :: MaybeT m a
</span><a href="#local-6989586621679075055"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; MaybeT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679075054"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; MaybeT m [a]
</span><a href="#local-6989586621679075054"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; MaybeT m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; MaybeT m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; MaybeT m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679075053"><span class="annot"><span class="annottext">getRandoms :: MaybeT m [a]
</span><a href="#local-6989586621679075053"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; MaybeT m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span id="local-6989586621679075049"><span id="local-6989586621679075050"><span id="local-6989586621679075051"><span id="local-6989586621679075052"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679075052"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075051"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyRWS.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679075050"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075052"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075049"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075051"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679075043"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; RWST r w s m a
</span><a href="#local-6989586621679075043"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; RWST r w s m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; RWST r w s m a)
-&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; RWST r w s m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679075042"><span class="annot"><span class="annottext">getRandom :: RWST r w s m a
</span><a href="#local-6989586621679075042"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; RWST r w s m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679075041"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; RWST r w s m [a]
</span><a href="#local-6989586621679075041"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; RWST r w s m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; RWST r w s m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; RWST r w s m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679075040"><span class="annot"><span class="annottext">getRandoms :: RWST r w s m [a]
</span><a href="#local-6989586621679075040"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; RWST r w s m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span></span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span id="local-6989586621679075036"><span id="local-6989586621679075037"><span id="local-6989586621679075038"><span id="local-6989586621679075039"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679075039"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075038"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictRWS.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679075037"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075039"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075036"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075038"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679075030"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; RWST r w s m a
</span><a href="#local-6989586621679075030"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; RWST r w s m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; RWST r w s m a)
-&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; RWST r w s m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679075029"><span class="annot"><span class="annottext">getRandom :: RWST r w s m a
</span><a href="#local-6989586621679075029"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; RWST r w s m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679075028"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; RWST r w s m [a]
</span><a href="#local-6989586621679075028"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; RWST r w s m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; RWST r w s m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; RWST r w s m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679075027"><span class="annot"><span class="annottext">getRandoms :: RWST r w s m [a]
</span><a href="#local-6989586621679075027"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; RWST r w s m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span></span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679075025"><span id="local-6989586621679075026"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075026"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075025"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075026"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679075019"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; ReaderT r m a
</span><a href="#local-6989586621679075019"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ReaderT r m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; ReaderT r m a)
-&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; ReaderT r m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679075018"><span class="annot"><span class="annottext">getRandom :: ReaderT r m a
</span><a href="#local-6989586621679075018"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ReaderT r m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679075017"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; ReaderT r m [a]
</span><a href="#local-6989586621679075017"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ReaderT r m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; ReaderT r m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; ReaderT r m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span id="local-6989586621679075016"><span class="annot"><span class="annottext">getRandoms :: ReaderT r m [a]
</span><a href="#local-6989586621679075016"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; ReaderT r m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span id="local-6989586621679075014"><span id="local-6989586621679075015"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075015"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyState.StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075014"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075015"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679075008"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; StateT s m a
</span><a href="#local-6989586621679075008"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; StateT s m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; StateT s m a) -&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; StateT s m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679075007"><span class="annot"><span class="annottext">getRandom :: StateT s m a
</span><a href="#local-6989586621679075007"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; StateT s m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679075006"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; StateT s m [a]
</span><a href="#local-6989586621679075006"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; StateT s m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; StateT s m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; StateT s m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679075005"><span class="annot"><span class="annottext">getRandoms :: StateT s m [a]
</span><a href="#local-6989586621679075005"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; StateT s m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="local-6989586621679075003"><span id="local-6989586621679075004"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075004"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictState.StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679075003"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075004"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679074997"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; StateT s m a
</span><a href="#local-6989586621679074997"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; StateT s m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; StateT s m a) -&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; StateT s m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679074996"><span class="annot"><span class="annottext">getRandom :: StateT s m a
</span><a href="#local-6989586621679074996"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; StateT s m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679074995"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; StateT s m [a]
</span><a href="#local-6989586621679074995"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; StateT s m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; StateT s m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; StateT s m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679074994"><span class="annot"><span class="annottext">getRandoms :: StateT s m [a]
</span><a href="#local-6989586621679074994"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; StateT s m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621679074992"><span id="local-6989586621679074993"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074993"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074992"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyWriter.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074992"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074993"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679074986"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; WriterT w m a
</span><a href="#local-6989586621679074986"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; WriterT w m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; WriterT w m a)
-&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; WriterT w m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679074985"><span class="annot"><span class="annottext">getRandom :: WriterT w m a
</span><a href="#local-6989586621679074985"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; WriterT w m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679074984"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; WriterT w m [a]
</span><a href="#local-6989586621679074984"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; WriterT w m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; WriterT w m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; WriterT w m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621679074983"><span class="annot"><span class="annottext">getRandoms :: WriterT w m [a]
</span><a href="#local-6989586621679074983"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; WriterT w m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span id="local-6989586621679074981"><span id="local-6989586621679074982"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074982"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074981"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictWriter.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074981"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074982"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>  </span><span id="local-6989586621679074975"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; WriterT w m a
</span><a href="#local-6989586621679074975"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomR</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; WriterT w m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; WriterT w m a)
-&gt; ((a, a) -&gt; m a) -&gt; (a, a) -&gt; WriterT w m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679074974"><span class="annot"><span class="annottext">getRandom :: WriterT w m a
</span><a href="#local-6989586621679074974"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; WriterT w m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m a
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679074973"><span class="annot"><span class="annottext">getRandomRs :: (a, a) -&gt; WriterT w m [a]
</span><a href="#local-6989586621679074973"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandomRs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; WriterT w m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; WriterT w m [a])
-&gt; ((a, a) -&gt; m [a]) -&gt; (a, a) -&gt; WriterT w m [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; m [a]
forall (m :: * -&gt; *) a.
(MonadRandom m, Random a) =&gt;
(a, a) -&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621679074972"><span class="annot"><span class="annottext">getRandoms :: WriterT w m [a]
</span><a href="#local-6989586621679074972"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRandoms</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; WriterT w m [a]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [a]
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; m [a]
</span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a></span></span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- MonadSplit</span><span>
</span><span id="line-207"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | The class 'MonadSplit' proivides a way to specify a random number</span><span>
</span><span id="line-210"></span><span class="hs-comment">--   generator that can be split into two new generators.</span><span>
</span><span id="line-211"></span><span class="hs-comment">--</span><span>
</span><span id="line-212"></span><span class="hs-comment">--   This class is not very useful in practice: typically, one cannot</span><span>
</span><span id="line-213"></span><span class="hs-comment">--   actually do anything with a generator.  It remains here to avoid</span><span>
</span><span id="line-214"></span><span class="hs-comment">--   breaking existing code unnecessarily.  For a more practically</span><span>
</span><span id="line-215"></span><span class="hs-comment">--   useful interface, see 'MonadInterleave'.</span><span>
</span><span id="line-216"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679075355"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadSplit"><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-var">MonadSplit</span></a></span></span><span> </span><span id="local-6989586621679075354"><span class="annot"><a href="#local-6989586621679075354"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679075355"><span class="annot"><a href="#local-6989586621679075355"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679075355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075354"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-comment">-- | The 'getSplit' operation allows one to obtain two distinct random number</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-comment">-- generators.</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-comment">-- See 'System.Random.split' for details.</span><span>
</span><span id="line-222"></span><span>  </span><span id="getSplit"><span class="annot"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-type">getSplit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679075355"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075354"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Random.StdGen</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679074967"><span class="annot"><span class="annottext">getSplit :: IO StdGen
</span><a href="#local-6989586621679074967"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO StdGen
</span><span class="hs-identifier hs-var">Random.newStdGen</span></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span id="local-6989586621679074964"><span id="local-6989586621679074965"><span id="local-6989586621679074966"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074966"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074965"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074966"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ContT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074964"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074965"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679074961"><span class="annot"><span class="annottext">getSplit :: ContT r m g
</span><a href="#local-6989586621679074961"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; ContT r m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span id="local-6989586621679074958"><span id="local-6989586621679074959"><span id="local-6989586621679074960"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679074960"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074959"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074958"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074959"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ErrorT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074960"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074958"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679074955"><span class="annot"><span class="annottext">getSplit :: ErrorT e m g
</span><a href="#local-6989586621679074955"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; ErrorT e m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span id="local-6989586621679074952"><span id="local-6989586621679074953"><span id="local-6989586621679074954"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074954"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074953"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074954"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074952"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074953"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679074949"><span class="annot"><span class="annottext">getSplit :: ExceptT e m g
</span><a href="#local-6989586621679074949"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; ExceptT e m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span id="local-6989586621679074947"><span id="local-6989586621679074948"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074948"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074947"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074948"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074947"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679074944"><span class="annot"><span class="annottext">getSplit :: IdentityT m g
</span><a href="#local-6989586621679074944"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; IdentityT m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621679074942"><span id="local-6989586621679074943"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074943"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074942"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074943"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074942"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679074939"><span class="annot"><span class="annottext">getSplit :: ListT m g
</span><a href="#local-6989586621679074939"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; ListT m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span id="local-6989586621679074937"><span id="local-6989586621679074938"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074938"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074937"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074938"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074937"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679074934"><span class="annot"><span class="annottext">getSplit :: MaybeT m g
</span><a href="#local-6989586621679074934"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; MaybeT m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="local-6989586621679074929"><span id="local-6989586621679074930"><span id="local-6989586621679074931"><span id="local-6989586621679074932"><span id="local-6989586621679074933"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074933"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074932"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074931"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074932"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyRWS.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679074930"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074933"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074929"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074931"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679074926"><span class="annot"><span class="annottext">getSplit :: RWST r w s m g
</span><a href="#local-6989586621679074926"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; RWST r w s m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span></span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span id="local-6989586621679074921"><span id="local-6989586621679074922"><span id="local-6989586621679074923"><span id="local-6989586621679074924"><span id="local-6989586621679074925"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074925"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074924"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074923"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074924"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictRWS.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679074922"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074925"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074921"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074923"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621679074918"><span class="annot"><span class="annottext">getSplit :: RWST r w s m g
</span><a href="#local-6989586621679074918"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; RWST r w s m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span></span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span id="local-6989586621679074915"><span id="local-6989586621679074916"><span id="local-6989586621679074917"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074917"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074917"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074915"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679074912"><span class="annot"><span class="annottext">getSplit :: ReaderT r m g
</span><a href="#local-6989586621679074912"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; ReaderT r m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621679074909"><span id="local-6989586621679074910"><span id="local-6989586621679074911"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074911"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074910"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074911"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyState.StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074909"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074910"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679074906"><span class="annot"><span class="annottext">getSplit :: StateT s m g
</span><a href="#local-6989586621679074906"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; StateT s m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span id="local-6989586621679074903"><span id="local-6989586621679074904"><span id="local-6989586621679074905"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074905"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074904"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074905"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictState.StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074903"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074904"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679074900"><span class="annot"><span class="annottext">getSplit :: StateT s m g
</span><a href="#local-6989586621679074900"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; StateT s m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621679074897"><span id="local-6989586621679074898"><span id="local-6989586621679074899"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074899"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074898"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074897"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074898"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyWriter.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074899"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074897"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679074894"><span class="annot"><span class="annottext">getSplit :: WriterT w m g
</span><a href="#local-6989586621679074894"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; WriterT w m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span id="local-6989586621679074891"><span id="local-6989586621679074892"><span id="local-6989586621679074893"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074893"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074892"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074891"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074892"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictWriter.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074893"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074891"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679074888"><span class="annot"><span class="annottext">getSplit :: WriterT w m g
</span><a href="#local-6989586621679074888"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m g -&gt; WriterT w m g
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m g
forall g (m :: * -&gt; *). MonadSplit g m =&gt; m g
</span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a></span></span></span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- MonadInterleave</span><span>
</span><span id="line-268"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | The class 'MonadInterleave' proivides a convenient interface atop</span><span>
</span><span id="line-271"></span><span class="hs-comment">--   a 'split' operation on a random generator.</span><span>
</span><span id="line-272"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075309"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadInterleave"><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-var">MonadInterleave</span></a></span></span><span> </span><span id="local-6989586621679075309"><span class="annot"><a href="#local-6989586621679075309"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-comment">-- | If @x :: m a@ is a computation in some random monad, then</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-comment">--   @interleave x@ works by splitting the generator, running @x@</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-comment">--   using one half, and using the other half as the final generator</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-comment">--   state of @interleave x@ (replacing whatever the final generator</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-comment">--   state otherwise would have been).  This means that computation</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-comment">--   needing random values which comes after @interleave x@ does not</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">--   necessarily depend on the computation of @x@.  For example:</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-comment">--   &gt; &gt;&gt;&gt; evalRandIO $ snd &lt;$&gt; ((,) &lt;$&gt; undefined &lt;*&gt; getRandom)</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-comment">--   &gt; *** Exception: Prelude.undefined</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-comment">--   &gt; &gt;&gt;&gt; evalRandIO $ snd &lt;$&gt; ((,) &lt;$&gt; interleave undefined &lt;*&gt; getRandom)</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">--   &gt; 6192322188769041625</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-comment">--   This can be used, for example, to allow random computations to</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-comment">--   run in parallel, or to create lazy infinite structures of</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-comment">--   random values.  In the example below, the infinite tree</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-comment">--   @randTree@ cannot be evaluated lazily: even though it is cut</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-comment">--   off at two levels deep by @hew 2@, the random value in the</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-comment">--   right subtree still depends on generation of all the random</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-comment">--   values in the (infinite) left subtree, even though they are</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-comment">--   ultimately unneeded.  Inserting a call to @interleave@, as in</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-comment">--   @randTreeI@, solves the problem: the generator splits at each</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-comment">--   @Node@, so random values in the left and right subtrees are</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-comment">--   generated independently.</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-comment">--   &gt; data Tree = Leaf | Node Int Tree Tree deriving Show</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-comment">--   &gt;</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-comment">--   &gt; hew :: Int -&gt; Tree -&gt; Tree</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-comment">--   &gt; hew 0 _    = Leaf</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-comment">--   &gt; hew _ Leaf = Leaf</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-comment">--   &gt; hew n (Node x l r) = Node x (hew (n-1) l) (hew (n-1) r)</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-comment">--   &gt;</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-comment">--   &gt; randTree :: Rand StdGen Tree</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-comment">--   &gt; randTree = Node &lt;$&gt; getRandom &lt;*&gt; randTree &lt;*&gt; randTree</span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-comment">--   &gt;</span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-comment">--   &gt; randTreeI :: Rand StdGen Tree</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-comment">--   &gt; randTreeI = interleave $ Node &lt;$&gt; getRandom &lt;*&gt; randTreeI &lt;*&gt; randTreeI</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-comment">--   &gt; &gt;&gt;&gt; hew 2 &lt;$&gt; evalRandIO randTree</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-comment">--   &gt; Node 2168685089479838995 (Node (-1040559818952481847) Leaf Leaf) (Node ^CInterrupted.</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-comment">--   &gt; &gt;&gt;&gt; hew 2 &lt;$&gt; evalRandIO randTreeI</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-comment">--   &gt; Node 8243316398511136358 (Node 4139784028141790719 Leaf Leaf) (Node 4473998613878251948 Leaf Leaf)</span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679075311"><span id="interleave"><span class="annot"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-type">interleave</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679075309"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075311"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075309"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075311"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span id="local-6989586621679074885"><span id="local-6989586621679074886"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074886"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ContT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074885"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074886"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679074881"><span class="annot"><span class="annottext">interleave :: ContT r m a -&gt; ContT r m a
</span><a href="#local-6989586621679074881"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m r -&gt; m r) -&gt; ContT r m a -&gt; ContT r m a
forall k (m :: k -&gt; *) (r :: k) a.
(m r -&gt; m r) -&gt; ContT r m a -&gt; ContT r m a
</span><span class="hs-identifier hs-var">mapContT</span></span><span> </span><span class="annot"><span class="annottext">m r -&gt; m r
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span id="local-6989586621679074878"><span id="local-6989586621679074879"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="#local-6989586621679074879"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074878"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ErrorT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074879"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074878"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679074875"><span class="annot"><span class="annottext">interleave :: ErrorT e m a -&gt; ErrorT e m a
</span><a href="#local-6989586621679074875"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (Either e a) -&gt; m (Either e a)) -&gt; ErrorT e m a -&gt; ErrorT e m a
forall (m :: * -&gt; *) e a (n :: * -&gt; *) e' b.
(m (Either e a) -&gt; n (Either e' b))
-&gt; ErrorT e m a -&gt; ErrorT e' n b
</span><span class="hs-identifier hs-var">mapErrorT</span></span><span> </span><span class="annot"><span class="annottext">m (Either e a) -&gt; m (Either e a)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span id="local-6989586621679074872"><span id="local-6989586621679074873"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074873"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074872"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074873"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679074869"><span class="annot"><span class="annottext">interleave :: ExceptT e m a -&gt; ExceptT e m a
</span><a href="#local-6989586621679074869"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (Either e a) -&gt; m (Either e a))
-&gt; ExceptT e m a -&gt; ExceptT e m a
forall (m :: * -&gt; *) e a (n :: * -&gt; *) e' b.
(m (Either e a) -&gt; n (Either e' b))
-&gt; ExceptT e m a -&gt; ExceptT e' n b
</span><span class="hs-identifier hs-var">mapExceptT</span></span><span> </span><span class="annot"><span class="annottext">m (Either e a) -&gt; m (Either e a)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span id="local-6989586621679074867"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074867"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074867"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679074864"><span class="annot"><span class="annottext">interleave :: IdentityT m a -&gt; IdentityT m a
</span><a href="#local-6989586621679074864"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; IdentityT m a -&gt; IdentityT m a
forall k1 k2 (m :: k1 -&gt; *) (a :: k1) (n :: k2 -&gt; *) (b :: k2).
(m a -&gt; n b) -&gt; IdentityT m a -&gt; IdentityT n b
</span><span class="hs-identifier hs-var">mapIdentityT</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; m a
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span id="local-6989586621679074862"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074862"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074862"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679074859"><span class="annot"><span class="annottext">interleave :: ListT m a -&gt; ListT m a
</span><a href="#local-6989586621679074859"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; m [a]) -&gt; ListT m a -&gt; ListT m a
forall (m :: * -&gt; *) a (n :: * -&gt; *) b.
(m [a] -&gt; n [b]) -&gt; ListT m a -&gt; ListT n b
</span><span class="hs-identifier hs-var">mapListT</span></span><span> </span><span class="annot"><span class="annottext">m [a] -&gt; m [a]
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span id="local-6989586621679074857"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074857"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074857"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679074854"><span class="annot"><span class="annottext">interleave :: MaybeT m a -&gt; MaybeT m a
</span><a href="#local-6989586621679074854"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (Maybe a) -&gt; m (Maybe a)) -&gt; MaybeT m a -&gt; MaybeT m a
forall (m :: * -&gt; *) a (n :: * -&gt; *) b.
(m (Maybe a) -&gt; n (Maybe b)) -&gt; MaybeT m a -&gt; MaybeT n b
</span><span class="hs-identifier hs-var">mapMaybeT</span></span><span> </span><span class="annot"><span class="annottext">m (Maybe a) -&gt; m (Maybe a)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span id="local-6989586621679074849"><span id="local-6989586621679074850"><span id="local-6989586621679074851"><span id="local-6989586621679074852"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074852"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074851"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyRWS.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679074850"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074852"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074849"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074851"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679074846"><span class="annot"><span class="annottext">interleave :: RWST r w s m a -&gt; RWST r w s m a
</span><a href="#local-6989586621679074846"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (a, s, w) -&gt; m (a, s, w)) -&gt; RWST r w s m a -&gt; RWST r w s m a
forall (m :: * -&gt; *) a s w (n :: * -&gt; *) b w' r.
(m (a, s, w) -&gt; n (b, s, w')) -&gt; RWST r w s m a -&gt; RWST r w' s n b
</span><span class="hs-identifier hs-var">LazyRWS.mapRWST</span></span><span> </span><span class="annot"><span class="annottext">m (a, s, w) -&gt; m (a, s, w)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span></span></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span id="local-6989586621679074841"><span id="local-6989586621679074842"><span id="local-6989586621679074843"><span id="local-6989586621679074844"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074844"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074843"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictRWS.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679074842"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074844"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074841"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074843"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679074838"><span class="annot"><span class="annottext">interleave :: RWST r w s m a -&gt; RWST r w s m a
</span><a href="#local-6989586621679074838"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (a, s, w) -&gt; m (a, s, w)) -&gt; RWST r w s m a -&gt; RWST r w s m a
forall (m :: * -&gt; *) a s w (n :: * -&gt; *) b w' r.
(m (a, s, w) -&gt; n (b, s, w')) -&gt; RWST r w s m a -&gt; RWST r w' s n b
</span><span class="hs-identifier hs-var">StrictRWS.mapRWST</span></span><span> </span><span class="annot"><span class="annottext">m (a, s, w) -&gt; m (a, s, w)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span></span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span id="local-6989586621679074835"><span id="local-6989586621679074836"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074836"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074835"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074836"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621679074832"><span class="annot"><span class="annottext">interleave :: ReaderT r m a -&gt; ReaderT r m a
</span><a href="#local-6989586621679074832"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m a -&gt; m a) -&gt; ReaderT r m a -&gt; ReaderT r m a
forall (m :: * -&gt; *) a (n :: * -&gt; *) b r.
(m a -&gt; n b) -&gt; ReaderT r m a -&gt; ReaderT r n b
</span><span class="hs-identifier hs-var">mapReaderT</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; m a
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span id="local-6989586621679074829"><span id="local-6989586621679074830"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074830"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyState.StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074829"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074830"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621679074826"><span class="annot"><span class="annottext">interleave :: StateT s m a -&gt; StateT s m a
</span><a href="#local-6989586621679074826"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (a, s) -&gt; m (a, s)) -&gt; StateT s m a -&gt; StateT s m a
forall (m :: * -&gt; *) a s (n :: * -&gt; *) b.
(m (a, s) -&gt; n (b, s)) -&gt; StateT s m a -&gt; StateT s n b
</span><span class="hs-identifier hs-var">LazyState.mapStateT</span></span><span> </span><span class="annot"><span class="annottext">m (a, s) -&gt; m (a, s)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span id="local-6989586621679074823"><span id="local-6989586621679074824"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictState.StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074823"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074824"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679074820"><span class="annot"><span class="annottext">interleave :: StateT s m a -&gt; StateT s m a
</span><a href="#local-6989586621679074820"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (a, s) -&gt; m (a, s)) -&gt; StateT s m a -&gt; StateT s m a
forall (m :: * -&gt; *) a s (n :: * -&gt; *) b.
(m (a, s) -&gt; n (b, s)) -&gt; StateT s m a -&gt; StateT s n b
</span><span class="hs-identifier hs-var">StrictState.mapStateT</span></span><span> </span><span class="annot"><span class="annottext">m (a, s) -&gt; m (a, s)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span id="local-6989586621679074817"><span id="local-6989586621679074818"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074818"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074817"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LazyWriter.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074818"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074817"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621679074814"><span class="annot"><span class="annottext">interleave :: WriterT w m a -&gt; WriterT w m a
</span><a href="#local-6989586621679074814"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (a, w) -&gt; m (a, w)) -&gt; WriterT w m a -&gt; WriterT w m a
forall (m :: * -&gt; *) a w (n :: * -&gt; *) b w'.
(m (a, w) -&gt; n (b, w')) -&gt; WriterT w m a -&gt; WriterT w' n b
</span><span class="hs-identifier hs-var">LazyWriter.mapWriterT</span></span><span> </span><span class="annot"><span class="annottext">m (a, w) -&gt; m (a, w)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span id="local-6989586621679074811"><span id="local-6989586621679074812"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679074812"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074811"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StrictWriter.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679074812"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074811"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679074808"><span class="annot"><span class="annottext">interleave :: WriterT w m a -&gt; WriterT w m a
</span><a href="#local-6989586621679074808"><span class="hs-identifier hs-var hs-var hs-var hs-var">interleave</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (a, w) -&gt; m (a, w)) -&gt; WriterT w m a -&gt; WriterT w m a
forall (m :: * -&gt; *) a w (n :: * -&gt; *) b w'.
(m (a, w) -&gt; n (b, w')) -&gt; WriterT w m a -&gt; WriterT w' n b
</span><span class="hs-identifier hs-var">StrictWriter.mapWriterT</span></span><span> </span><span class="annot"><span class="annottext">m (a, w) -&gt; m (a, w)
forall (m :: * -&gt; *) a. MonadInterleave m =&gt; m a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a></span></span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- Convenience samplers</span><span>
</span><span id="line-359"></span><span class="hs-comment">------------------------------------------------------------</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- | Sample a random value from a weighted nonempty collection of</span><span>
</span><span id="line-362"></span><span class="hs-comment">--   elements.  Crashes with a call to @error@ if the collection is</span><span>
</span><span id="line-363"></span><span class="hs-comment">--   empty or the total weight is zero.</span><span>
</span><span id="line-364"></span><span id="local-6989586621679074804"><span id="local-6989586621679074805"><span id="local-6989586621679074806"><span class="annot"><a href="Control.Monad.Random.Class.html#weighted"><span class="hs-identifier hs-type">weighted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">F.Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679074806"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074805"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074806"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074804"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074805"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074804"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-365"></span><span id="weighted"><span class="annot"><span class="annottext">weighted :: t (a, Rational) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#weighted"><span class="hs-identifier hs-var hs-var">weighted</span></a></span></span><span> </span><span id="local-6989586621679074803"><span class="annot"><span class="annottext">t :: t (a, Rational)
</span><a href="#local-6989586621679074803"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679074802"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679074802"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t (a, Rational) -&gt; m (Maybe a)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadRandom m) =&gt;
t (a, Rational) -&gt; m (Maybe a)
</span><a href="Control.Monad.Random.Class.html#weightedMay"><span class="hs-identifier hs-var">weightedMay</span></a></span><span> </span><span class="annot"><span class="annottext">t (a, Rational)
</span><a href="#local-6989586621679074803"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679074802"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Control.Monad.Random.Class.weighted: empty collection, or total weight &lt;= 0&quot;</span></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679074800"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679074800"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074800"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Sample a random value from a weighted collection of elements.</span><span>
</span><span id="line-372"></span><span class="hs-comment">--   Returns @Nothing@ if the collection is empty or the total weight is</span><span>
</span><span id="line-373"></span><span class="hs-comment">--   zero.</span><span>
</span><span id="line-374"></span><span id="local-6989586621679075192"><span id="local-6989586621679075193"><span id="local-6989586621679075194"><span class="annot"><a href="Control.Monad.Random.Class.html#weightedMay"><span class="hs-identifier hs-type">weightedMay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">F.Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679075194"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075193"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075194"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075192"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075193"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679075192"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-375"></span><span id="weightedMay"><span class="annot"><span class="annottext">weightedMay :: t (a, Rational) -&gt; m (Maybe a)
</span><a href="Control.Monad.Random.Class.html#weightedMay"><span class="hs-identifier hs-var hs-var">weightedMay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, Rational)] -&gt; m (Maybe a)
forall (m :: * -&gt; *) a.
MonadRandom m =&gt;
[(a, Rational)] -&gt; m (Maybe a)
</span><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-var">fromListMay</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, Rational)] -&gt; m (Maybe a))
-&gt; (t (a, Rational) -&gt; [(a, Rational)])
-&gt; t (a, Rational)
-&gt; m (Maybe a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t (a, Rational) -&gt; [(a, Rational)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- | Sample a random value from a weighted list.  The list must be</span><span>
</span><span id="line-378"></span><span class="hs-comment">--   non-empty and the total weight must be non-zero.</span><span>
</span><span id="line-379"></span><span id="local-6989586621679074797"><span id="local-6989586621679074798"><span class="annot"><a href="Control.Monad.Random.Class.html#fromList"><span class="hs-identifier hs-type">fromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074798"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679074797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074798"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074797"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-380"></span><span id="fromList"><span class="annot"><span class="annottext">fromList :: [(a, Rational)] -&gt; m a
</span><a href="Control.Monad.Random.Class.html#fromList"><span class="hs-identifier hs-var hs-var">fromList</span></a></span></span><span> </span><span id="local-6989586621679074796"><span class="annot"><span class="annottext">ws :: [(a, Rational)]
</span><a href="#local-6989586621679074796"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621679074795"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679074795"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(a, Rational)] -&gt; m (Maybe a)
forall (m :: * -&gt; *) a.
MonadRandom m =&gt;
[(a, Rational)] -&gt; m (Maybe a)
</span><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-var">fromListMay</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, Rational)]
</span><a href="#local-6989586621679074796"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679074795"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Control.Monad.Random.Class.fromList: empty list, or total weight = 0&quot;</span></span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679074794"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679074794"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074794"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Sample a random value from a weighted list.  Return @Nothing@ if</span><span>
</span><span id="line-387"></span><span class="hs-comment">--   the list is empty or the total weight is nonpositive.</span><span>
</span><span id="line-388"></span><span id="local-6989586621679075182"><span id="local-6989586621679075183"><span class="annot"><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-type">fromListMay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075183"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679075182"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075183"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679075182"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-389"></span><span id="fromListMay"><span class="annot"><span class="annottext">fromListMay :: [(a, Rational)] -&gt; m (Maybe a)
</span><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-var hs-var">fromListMay</span></a></span></span><span> </span><span id="local-6989586621679074793"><span class="annot"><span class="annottext">xs :: [(a, Rational)]
</span><a href="#local-6989586621679074793"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679074792"><span class="annot"><span class="annottext">s :: Double
</span><a href="#local-6989586621679074792"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rational] -&gt; Rational
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((a, Rational) -&gt; Rational) -&gt; [(a, Rational)] -&gt; [Rational]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(a, Rational) -&gt; Rational
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(a, Rational)]
</span><a href="#local-6989586621679074793"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-391"></span><span>      </span><span id="local-6989586621679074790"><span class="annot"><span class="annottext">cums :: [(a, Rational)]
</span><a href="#local-6989586621679074790"><span class="hs-identifier hs-var hs-var">cums</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, Rational) -&gt; (a, Rational) -&gt; (a, Rational))
-&gt; [(a, Rational)] -&gt; [(a, Rational)]
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">scanl1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span id="local-6989586621679074788"><span class="annot"><span class="annottext">q :: Rational
</span><a href="#local-6989586621679074788"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679074787"><span class="annot"><span class="annottext">y :: a
</span><a href="#local-6989586621679074787"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679074786"><span class="annot"><span class="annottext">s' :: Rational
</span><a href="#local-6989586621679074786"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074787"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679074786"><span class="hs-identifier hs-var">s'</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679074788"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, Rational)]
</span><a href="#local-6989586621679074793"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679074792"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-395"></span><span>      </span><span id="local-6989586621679074783"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679074783"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Rational) -&gt; m Double -&gt; m Rational
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">(m Double -&gt; m Rational) -&gt; m Double -&gt; m Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; m Double
forall (m :: * -&gt; *) a. (MonadRandom m, Random a) =&gt; (a, a) -&gt; m a
</span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679074792"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; m (Maybe a))
-&gt; ([(a, Rational)] -&gt; Maybe a) -&gt; [(a, Rational)] -&gt; m (Maybe a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a)
-&gt; ([(a, Rational)] -&gt; a) -&gt; [(a, Rational)] -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, Rational) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((a, Rational) -&gt; a)
-&gt; ([(a, Rational)] -&gt; (a, Rational)) -&gt; [(a, Rational)] -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(a, Rational)] -&gt; (a, Rational)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([(a, Rational)] -&gt; (a, Rational))
-&gt; ([(a, Rational)] -&gt; [(a, Rational)])
-&gt; [(a, Rational)]
-&gt; (a, Rational)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((a, Rational) -&gt; Bool) -&gt; [(a, Rational)] -&gt; [(a, Rational)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679074783"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Bool)
-&gt; ((a, Rational) -&gt; Rational) -&gt; (a, Rational) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, Rational) -&gt; Rational
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(a, Rational)] -&gt; m (Maybe a)) -&gt; [(a, Rational)] -&gt; m (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(a, Rational)]
</span><a href="#local-6989586621679074790"><span class="hs-identifier hs-var">cums</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | Sample a value uniformly from a nonempty collection of elements.</span><span>
</span><span id="line-399"></span><span id="local-6989586621679074777"><span id="local-6989586621679074778"><span id="local-6989586621679074779"><span class="annot"><a href="Control.Monad.Random.Class.html#uniform"><span class="hs-identifier hs-type">uniform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">F.Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679074779"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074778"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074779"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074777"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679074778"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679074777"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-400"></span><span id="uniform"><span class="annot"><span class="annottext">uniform :: t a -&gt; m a
</span><a href="Control.Monad.Random.Class.html#uniform"><span class="hs-identifier hs-var hs-var">uniform</span></a></span></span><span> </span><span id="local-6989586621679074776"><span class="annot"><span class="annottext">t :: t a
</span><a href="#local-6989586621679074776"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>  </span><span id="local-6989586621679074775"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679074775"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">t a -&gt; m (Maybe a)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadRandom m) =&gt;
t a -&gt; m (Maybe a)
</span><a href="Control.Monad.Random.Class.html#uniformMay"><span class="hs-identifier hs-var">uniformMay</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679074776"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679074775"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Control.Monad.Random.Class.uniform: empty collection&quot;</span></span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679074774"><span class="annot"><span class="annottext">a :: a
</span><a href="#local-6989586621679074774"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679074774"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- | Sample a value uniformly from a collection of elements.  Return</span><span>
</span><span id="line-407"></span><span class="hs-comment">--   @Nothing@ if the collection is empty.</span><span>
</span><span id="line-408"></span><span id="local-6989586621679075152"><span id="local-6989586621679075153"><span id="local-6989586621679075154"><span class="annot"><a href="Control.Monad.Random.Class.html#uniformMay"><span class="hs-identifier hs-type">uniformMay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">F.Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679075154"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075153"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075154"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679075152"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679075153"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679075152"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-409"></span><span id="uniformMay"><span class="annot"><span class="annottext">uniformMay :: t a -&gt; m (Maybe a)
</span><a href="Control.Monad.Random.Class.html#uniformMay"><span class="hs-identifier hs-var hs-var">uniformMay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, Rational)] -&gt; m (Maybe a)
forall (m :: * -&gt; *) a.
MonadRandom m =&gt;
[(a, Rational)] -&gt; m (Maybe a)
</span><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-var">fromListMay</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, Rational)] -&gt; m (Maybe a))
-&gt; (t a -&gt; [(a, Rational)]) -&gt; t a -&gt; m (Maybe a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, Rational)) -&gt; [a] -&gt; [(a, Rational)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Rational -&gt; (a, Rational)) -&gt; Rational -&gt; a -&gt; (a, Rational)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [(a, Rational)]) -&gt; (t a -&gt; [a]) -&gt; t a -&gt; [(a, Rational)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">t a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span>
</span><span id="line-410"></span></pre></body></html>