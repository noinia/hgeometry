<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  Data.Geometry.Arrangement.Internal</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Data type for representing an Arrangement of lines in \(\mathbb{R}^2\).</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Geometry.Arrangement.Internal</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Algorithms.BinarySearch</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.CircularSeq</span></span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CSeq</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Boundary.html"><span class="hs-identifier">Data.Geometry.Boundary</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Box.html"><span class="hs-identifier">Data.Geometry.Box</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Line.html"><span class="hs-identifier">Data.Geometry.Line</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.LineSegment.html"><span class="hs-identifier">Data.Geometry.LineSegment</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.html"><span class="hs-identifier">Data.Geometry.PlanarSubdivision</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Point.html"><span class="hs-identifier">Data.Geometry.Point</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Properties.html"><span class="hs-identifier">Data.Geometry.Properties</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Down</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vinyl.CoRec</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">type</span><span> </span><span id="ArrangementBoundary"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#ArrangementBoundary"><span class="hs-identifier hs-var">ArrangementBoundary</span></a></span></span><span> </span><span id="local-6989586621679988416"><span class="annot"><a href="#local-6989586621679988416"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679988415"><span class="annot"><a href="#local-6989586621679988415"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679988414"><span class="annot"><a href="#local-6989586621679988414"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988414"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679988416"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988414"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988415"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Data type representing a two dimensional planar arrangement</span><span>
</span><span id="line-38"></span><span class="hs-keyword">data</span><span> </span><span id="Arrangement"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-var">Arrangement</span></a></span></span><span> </span><span id="local-6989586621679988797"><span class="annot"><a href="#local-6989586621679988797"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679988798"><span class="annot"><a href="#local-6989586621679988798"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679988796"><span class="annot"><a href="#local-6989586621679988796"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679988795"><span class="annot"><a href="#local-6989586621679988795"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679988794"><span class="annot"><a href="#local-6989586621679988794"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679988799"><span class="annot"><a href="#local-6989586621679988799"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Arrangement"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-var">Arrangement</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-39"></span><span>    </span><span id="_inputLines"><span class="annot"><span class="annottext">Arrangement s l v e f r -&gt; Vector (Line 2 r :+ l)
</span><a href="Data.Geometry.Arrangement.Internal.html#_inputLines"><span class="hs-identifier hs-var hs-var">_inputLines</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988799"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988798"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_subdivision"><span class="annot"><span class="annottext">Arrangement s l v e f r -&gt; PlanarSubdivision s v e f r
</span><a href="Data.Geometry.Arrangement.Internal.html#_subdivision"><span class="hs-identifier hs-var hs-var">_subdivision</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988797"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988796"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988795"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988794"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988799"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_boundedArea"><span class="annot"><span class="annottext">Arrangement s l v e f r -&gt; Rectangle () r
</span><a href="Data.Geometry.Arrangement.Internal.html#_boundedArea"><span class="hs-identifier hs-var hs-var">_boundedArea</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988799"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_unboundedIntersections"><span class="annot"><span class="annottext">Arrangement s l v e f r -&gt; ArrangementBoundary s l r
</span><a href="Data.Geometry.Arrangement.Internal.html#_unboundedIntersections"><span class="hs-identifier hs-var hs-var">_unboundedIntersections</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#ArrangementBoundary"><span class="hs-identifier hs-type">ArrangementBoundary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988797"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988798"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988799"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988403"><span id="local-6989586621679988405"><span id="local-6989586621679988407"><span class="annot"><span class="annottext">Int -&gt; Arrangement s l v e f r -&gt; ShowS
[Arrangement s l v e f r] -&gt; ShowS
Arrangement s l v e f r -&gt; String
(Int -&gt; Arrangement s l v e f r -&gt; ShowS)
-&gt; (Arrangement s l v e f r -&gt; String)
-&gt; ([Arrangement s l v e f r] -&gt; ShowS)
-&gt; Show (Arrangement s l v e f r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (s :: k) l v e f r.
(Show r, Show l, Show v, Show e, Show f) =&gt;
Int -&gt; Arrangement s l v e f r -&gt; ShowS
forall k (s :: k) l v e f r.
(Show r, Show l, Show v, Show e, Show f) =&gt;
[Arrangement s l v e f r] -&gt; ShowS
forall k (s :: k) l v e f r.
(Show r, Show l, Show v, Show e, Show f) =&gt;
Arrangement s l v e f r -&gt; String
showList :: [Arrangement s l v e f r] -&gt; ShowS
$cshowList :: forall k (s :: k) l v e f r.
(Show r, Show l, Show v, Show e, Show f) =&gt;
[Arrangement s l v e f r] -&gt; ShowS
show :: Arrangement s l v e f r -&gt; String
$cshow :: forall k (s :: k) l v e f r.
(Show r, Show l, Show v, Show e, Show f) =&gt;
Arrangement s l v e f r -&gt; String
showsPrec :: Int -&gt; Arrangement s l v e f r -&gt; ShowS
$cshowsPrec :: forall k (s :: k) l v e f r.
(Show r, Show l, Show v, Show e, Show f) =&gt;
Int -&gt; Arrangement s l v e f r -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679988398"><span id="local-6989586621679988400"><span class="annot"><span class="annottext">Arrangement s l v e f r -&gt; Arrangement s l v e f r -&gt; Bool
(Arrangement s l v e f r -&gt; Arrangement s l v e f r -&gt; Bool)
-&gt; (Arrangement s l v e f r -&gt; Arrangement s l v e f r -&gt; Bool)
-&gt; Eq (Arrangement s l v e f r)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (s :: k) l v e f r.
(Fractional r, Eq r, Eq l, Eq v, Eq e, Eq f) =&gt;
Arrangement s l v e f r -&gt; Arrangement s l v e f r -&gt; Bool
/= :: Arrangement s l v e f r -&gt; Arrangement s l v e f r -&gt; Bool
$c/= :: forall k (s :: k) l v e f r.
(Fractional r, Eq r, Eq l, Eq v, Eq e, Eq f) =&gt;
Arrangement s l v e f r -&gt; Arrangement s l v e f r -&gt; Bool
== :: Arrangement s l v e f r -&gt; Arrangement s l v e f r -&gt; Bool
$c== :: forall k (s :: k) l v e f r.
(Fractional r, Eq r, Eq l, Eq v, Eq e, Eq f) =&gt;
Arrangement s l v e f r -&gt; Arrangement s l v e f r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-comment">-- unboundedIntersections also stores the corners of the box. They are not</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-comment">-- associated with any line</span><span>
</span><span id="line-46"></span><span id="unboundedIntersections"><span id="subdivision"><span id="inputLines"><span id="boundedArea"><span id="local-6989586621679988511"><span id="local-6989586621679988512"><span id="local-6989586621679988513"><span id="local-6989586621679988794"><span id="local-6989586621679988795"><span id="local-6989586621679988796"><span id="local-6989586621679988797"><span id="local-6989586621679988798"><span id="local-6989586621679988799"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Arrangement</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><a href="Data.Geometry.Properties.html#NumType"><span class="hs-identifier hs-var">NumType</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span id="local-6989586621679988392"><span class="annot"><a href="#local-6989586621679988392"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679988391"><span class="annot"><a href="#local-6989586621679988391"><span class="hs-identifier hs-type hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679988390"><span class="annot"><a href="#local-6989586621679988390"><span class="hs-identifier hs-type hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679988389"><span class="annot"><a href="#local-6989586621679988389"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679988388"><span class="annot"><a href="#local-6989586621679988388"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679988387"><span class="annot"><a href="#local-6989586621679988387"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679988387"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><a href="Data.Geometry.Properties.html#Dimension"><span class="hs-identifier hs-var">Dimension</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span id="local-6989586621679988386"><span class="annot"><a href="#local-6989586621679988386"><span class="hs-identifier hs-type hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679988385"><span class="annot"><a href="#local-6989586621679988385"><span class="hs-identifier hs-type hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679988384"><span class="annot"><a href="#local-6989586621679988384"><span class="hs-identifier hs-type hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679988383"><span class="annot"><a href="#local-6989586621679988383"><span class="hs-identifier hs-type hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679988382"><span class="annot"><a href="#local-6989586621679988382"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679988381"><span class="annot"><a href="#local-6989586621679988381"><span class="hs-identifier hs-type hs-type">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Builds an arrangement of \(n\) lines</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- running time: \(O(n^2\log n\)</span><span>
</span><span id="line-56"></span><span id="local-6989586621679988377"><span id="local-6989586621679988378"><span id="local-6989586621679988379"><span id="local-6989586621679988380"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#constructArrangement"><span class="hs-identifier hs-type">constructArrangement</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988380"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988380"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>                           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679988379"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988378"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-58"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988380"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988377"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988378"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988377"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679988377"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988380"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-60"></span><span id="constructArrangement"><span class="annot"><span class="annottext">constructArrangement :: proxy s -&gt; [Line 2 r :+ l] -&gt; Arrangement s l () (Maybe l) () r
</span><a href="Data.Geometry.Arrangement.Internal.html#constructArrangement"><span class="hs-identifier hs-var hs-var">constructArrangement</span></a></span></span><span> </span><span id="local-6989586621679988375"><span class="annot"><span class="annottext">px :: proxy s
</span><a href="#local-6989586621679988375"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span id="local-6989586621679988374"><span class="annot"><span class="annottext">ls :: [Line 2 r :+ l]
</span><a href="#local-6989586621679988374"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679988373"><span class="annot"><span class="annottext">b :: Rectangle () r
</span><a href="#local-6989586621679988373"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l] -&gt; Rectangle () r
forall r l.
(Ord r, Fractional r) =&gt;
[Line 2 r :+ l] -&gt; Rectangle () r
</span><a href="Data.Geometry.Arrangement.Internal.html#makeBoundingBox"><span class="hs-identifier hs-var">makeBoundingBox</span></a></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988374"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-61"></span><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">proxy s
-&gt; Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; Arrangement s l () (Maybe l) () r
forall k r (proxy :: k -&gt; *) (s :: k) l.
(Ord r, Fractional r) =&gt;
proxy s
-&gt; Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; Arrangement s l () (Maybe l) () r
</span><a href="Data.Geometry.Arrangement.Internal.html#constructArrangementInBox%27"><span class="hs-identifier hs-var">constructArrangementInBox'</span></a></span><span> </span><span class="annot"><span class="annottext">proxy s
</span><a href="#local-6989586621679988375"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988373"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988374"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Constructs the arrangemnet inside the box.  note that the resulting box</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- may be larger than the given box to make sure that all vertices of the</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- arrangement actually fit.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- running time: \(O(n^2\log n\)</span><span>
</span><span id="line-68"></span><span id="local-6989586621679988367"><span id="local-6989586621679988368"><span id="local-6989586621679988369"><span id="local-6989586621679988370"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#constructArrangementInBox"><span class="hs-identifier hs-type">constructArrangementInBox</span></a></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988370"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988370"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>                                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679988369"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988368"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-70"></span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988370"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-71"></span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988370"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988367"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988368"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988367"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679988367"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988370"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-73"></span><span id="constructArrangementInBox"><span class="annot"><span class="annottext">constructArrangementInBox :: proxy s
-&gt; Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; Arrangement s l () (Maybe l) () r
</span><a href="Data.Geometry.Arrangement.Internal.html#constructArrangementInBox"><span class="hs-identifier hs-var hs-var">constructArrangementInBox</span></a></span></span><span> </span><span id="local-6989586621679988365"><span class="annot"><span class="annottext">px :: proxy s
</span><a href="#local-6989586621679988365"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span id="local-6989586621679988364"><span class="annot"><span class="annottext">rect :: Rectangle () r
</span><a href="#local-6989586621679988364"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span id="local-6989586621679988363"><span class="annot"><span class="annottext">ls :: [Line 2 r :+ l]
</span><a href="#local-6989586621679988363"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679988362"><span class="annot"><span class="annottext">b :: Rectangle () r
</span><a href="#local-6989586621679988362"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l] -&gt; Rectangle () r
forall r l.
(Ord r, Fractional r) =&gt;
[Line 2 r :+ l] -&gt; Rectangle () r
</span><a href="Data.Geometry.Arrangement.Internal.html#makeBoundingBox"><span class="hs-identifier hs-var">makeBoundingBox</span></a></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988363"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-74"></span><span>                                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">proxy s
-&gt; Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; Arrangement s l () (Maybe l) () r
forall k r (proxy :: k -&gt; *) (s :: k) l.
(Ord r, Fractional r) =&gt;
proxy s
-&gt; Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; Arrangement s l () (Maybe l) () r
</span><a href="Data.Geometry.Arrangement.Internal.html#constructArrangementInBox%27"><span class="hs-identifier hs-var">constructArrangementInBox'</span></a></span><span> </span><span class="annot"><span class="annottext">proxy s
</span><a href="#local-6989586621679988365"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988362"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; Rectangle () r -&gt; Rectangle () r
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988364"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988363"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Constructs the arrangemnet inside the box. (for parts to be useful, it is</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- assumed this boxfits at least the boundingbox of the intersections in the</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- Arrangement)</span><span>
</span><span id="line-80"></span><span id="local-6989586621679988812"><span id="local-6989586621679988813"><span id="local-6989586621679988814"><span id="local-6989586621679988815"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#constructArrangementInBox%27"><span class="hs-identifier hs-type">constructArrangementInBox'</span></a></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988815"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988815"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>                                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679988814"><span class="hs-identifier hs-type">proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988813"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-82"></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988815"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-83"></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988815"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988812"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988813"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988812"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679988812"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988815"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-85"></span><span id="constructArrangementInBox%27"><span class="annot"><span class="annottext">constructArrangementInBox' :: proxy s
-&gt; Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; Arrangement s l () (Maybe l) () r
</span><a href="Data.Geometry.Arrangement.Internal.html#constructArrangementInBox%27"><span class="hs-identifier hs-var hs-var">constructArrangementInBox'</span></a></span></span><span> </span><span id="local-6989586621679988361"><span class="annot"><span class="annottext">px :: proxy s
</span><a href="#local-6989586621679988361"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span id="local-6989586621679988360"><span class="annot"><span class="annottext">rect :: Rectangle () r
</span><a href="#local-6989586621679988360"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span id="local-6989586621679988359"><span class="annot"><span class="annottext">ls :: [Line 2 r :+ l]
</span><a href="#local-6989586621679988359"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">Vector (Line 2 r :+ l)
-&gt; PlanarSubdivision s () (Maybe l) () r
-&gt; Rectangle () r
-&gt; ArrangementBoundary s l r
-&gt; Arrangement s l () (Maybe l) () r
forall k (s :: k) l v e f r.
Vector (Line 2 r :+ l)
-&gt; PlanarSubdivision s v e f r
-&gt; Rectangle () r
-&gt; ArrangementBoundary s l r
-&gt; Arrangement s l v e f r
</span><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-var">Arrangement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Line 2 r :+ l] -&gt; Vector (Line 2 r :+ l)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988359"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s () (Maybe l) () r
</span><a href="#local-6989586621679988357"><span class="hs-identifier hs-var">subdiv</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988360"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; PlanarSubdivision s () (Maybe l) () r
-&gt; ArrangementBoundary s l r
forall k r a (s :: k) v e f.
Eq r =&gt;
[(Point 2 r, a)]
-&gt; PlanarSubdivision s v (Maybe e) f r
-&gt; Vector (Point 2 r, VertexId' s, a)
</span><a href="Data.Geometry.Arrangement.Internal.html#link"><span class="hs-identifier hs-var">link</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988355"><span class="hs-identifier hs-var">parts'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s () (Maybe l) () r
</span><a href="#local-6989586621679988357"><span class="hs-identifier hs-var">subdiv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679988357"><span class="annot"><span class="annottext">subdiv :: PlanarSubdivision s () (Maybe l) () r
</span><a href="#local-6989586621679988357"><span class="hs-identifier hs-var hs-var">subdiv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">proxy s
-&gt; [LineSegment 2 () r :+ Maybe l]
-&gt; PlanarSubdivision s (NonEmpty ()) (Maybe l) () r
forall k (f :: * -&gt; *) r (proxy :: k -&gt; *) (s :: k) p e.
(Foldable f, Ord r, Fractional r) =&gt;
proxy s
-&gt; f (LineSegment 2 p r :+ e)
-&gt; PlanarSubdivision s (NonEmpty p) e () r
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#fromConnectedSegments"><span class="hs-identifier hs-var">fromConnectedSegments</span></a></span><span> </span><span class="annot"><span class="annottext">proxy s
</span><a href="#local-6989586621679988361"><span class="hs-identifier hs-var">px</span></a></span><span> </span><span class="annot"><span class="annottext">[LineSegment 2 () r :+ Maybe l]
</span><a href="#local-6989586621679988353"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-89"></span><span>                </span><span class="annot"><span class="annottext">PlanarSubdivision s (NonEmpty ()) (Maybe l) () r
-&gt; (PlanarSubdivision s (NonEmpty ()) (Maybe l) () r
    -&gt; PlanarSubdivision s () (Maybe l) () r)
-&gt; PlanarSubdivision s () (Maybe l) () r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Vector (Raw s (VertexId' (Wrap s)) (NonEmpty ()))
 -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) ())))
-&gt; PlanarSubdivision s (NonEmpty ()) (Maybe l) () r
-&gt; Identity (PlanarSubdivision s () (Maybe l) () r)
forall k (s :: k) v1 e f r v2.
Lens
  (PlanarSubdivision s v1 e f r)
  (PlanarSubdivision s v2 e f r)
  (Vector (Raw s (VertexId' (Wrap s)) v1))
  (Vector (Raw s (VertexId' (Wrap s)) v2))
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#rawVertexData"><span class="hs-identifier hs-var">rawVertexData</span></a></span><span class="annot"><span class="annottext">((Vector (Raw s (VertexId' (Wrap s)) (NonEmpty ()))
  -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) ())))
 -&gt; PlanarSubdivision s (NonEmpty ()) (Maybe l) () r
 -&gt; Identity (PlanarSubdivision s () (Maybe l) () r))
-&gt; ((NonEmpty () -&gt; Identity ())
    -&gt; Vector (Raw s (VertexId' (Wrap s)) (NonEmpty ()))
    -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) ())))
-&gt; (NonEmpty () -&gt; Identity ())
-&gt; PlanarSubdivision s (NonEmpty ()) (Maybe l) () r
-&gt; Identity (PlanarSubdivision s () (Maybe l) () r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Raw s (VertexId' (Wrap s)) (NonEmpty ())
 -&gt; Identity (Raw s (VertexId' (Wrap s)) ()))
-&gt; Vector (Raw s (VertexId' (Wrap s)) (NonEmpty ()))
-&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) ()))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((Raw s (VertexId' (Wrap s)) (NonEmpty ())
  -&gt; Identity (Raw s (VertexId' (Wrap s)) ()))
 -&gt; Vector (Raw s (VertexId' (Wrap s)) (NonEmpty ()))
 -&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) ())))
-&gt; ((NonEmpty () -&gt; Identity ())
    -&gt; Raw s (VertexId' (Wrap s)) (NonEmpty ())
    -&gt; Identity (Raw s (VertexId' (Wrap s)) ()))
-&gt; (NonEmpty () -&gt; Identity ())
-&gt; Vector (Raw s (VertexId' (Wrap s)) (NonEmpty ()))
-&gt; Identity (Vector (Raw s (VertexId' (Wrap s)) ()))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(NonEmpty () -&gt; Identity ())
-&gt; Raw s (VertexId' (Wrap s)) (NonEmpty ())
-&gt; Identity (Raw s (VertexId' (Wrap s)) ())
forall k (s :: k) ia a b. Lens (Raw s ia a) (Raw s ia b) a b
</span><a href="Data.Geometry.PlanarSubdivision.Raw.html#dataVal"><span class="hs-identifier hs-var">dataVal</span></a></span><span> </span><span class="annot"><span class="annottext">((NonEmpty () -&gt; Identity ())
 -&gt; PlanarSubdivision s (NonEmpty ()) (Maybe l) () r
 -&gt; Identity (PlanarSubdivision s () (Maybe l) () r))
-&gt; ()
-&gt; PlanarSubdivision s (NonEmpty ()) (Maybe l) () r
-&gt; PlanarSubdivision s () (Maybe l) () r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679988353"><span class="annot"><span class="annottext">segs :: [LineSegment 2 () r :+ Maybe l]
</span><a href="#local-6989586621679988353"><span class="hs-identifier hs-var">segs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679988355"><span class="annot"><span class="annottext">parts' :: [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988355"><span class="hs-identifier hs-var">parts'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; ([LineSegment 2 () r :+ Maybe l],
    [(Point 2 r, Maybe (Line 2 r :+ l))])
forall r l.
(Ord r, Fractional r) =&gt;
Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; ([LineSegment 2 () r :+ Maybe l],
    [(Point 2 r, Maybe (Line 2 r :+ l))])
</span><a href="Data.Geometry.Arrangement.Internal.html#computeSegsAndParts"><span class="hs-identifier hs-var">computeSegsAndParts</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988360"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988359"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#computeSegsAndParts"><span class="hs-identifier hs-type">computeSegsAndParts</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679988744"><span class="annot"><a href="#local-6989586621679988744"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679988743"><span class="annot"><a href="#local-6989586621679988743"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988744"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988744"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988744"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-94"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988744"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988743"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.LineSegment.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988744"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679988743"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-96"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988744"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988744"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988743"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span>                               </span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span id="computeSegsAndParts"><span class="annot"><span class="annottext">computeSegsAndParts :: Rectangle () r
-&gt; [Line 2 r :+ l]
-&gt; ([LineSegment 2 () r :+ Maybe l],
    [(Point 2 r, Maybe (Line 2 r :+ l))])
</span><a href="Data.Geometry.Arrangement.Internal.html#computeSegsAndParts"><span class="hs-identifier hs-var hs-var">computeSegsAndParts</span></a></span></span><span> </span><span id="local-6989586621679988345"><span class="annot"><span class="annottext">rect :: Rectangle () r
</span><a href="#local-6989586621679988345"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span id="local-6989586621679988344"><span class="annot"><span class="annottext">ls :: [Line 2 r :+ l]
</span><a href="#local-6989586621679988344"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[LineSegment 2 () r :+ Maybe l]
</span><a href="#local-6989586621679988343"><span class="hs-identifier hs-var">segs</span></a></span><span> </span><span class="annot"><span class="annottext">[LineSegment 2 () r :+ Maybe l]
-&gt; [LineSegment 2 () r :+ Maybe l]
-&gt; [LineSegment 2 () r :+ Maybe l]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[LineSegment 2 () r :+ Maybe l]
</span><a href="#local-6989586621679988342"><span class="hs-identifier hs-var">boundarySegs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988341"><span class="hs-identifier hs-var">parts'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679988343"><span class="annot"><span class="annottext">segs :: [LineSegment 2 () r :+ Maybe l]
</span><a href="#local-6989586621679988343"><span class="hs-identifier hs-var hs-var">segs</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((LineSegment 2 () r :+ l) -&gt; LineSegment 2 () r :+ Maybe l)
-&gt; [LineSegment 2 () r :+ l] -&gt; [LineSegment 2 () r :+ Maybe l]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LineSegment 2 () r :+ l)
-&gt; ((LineSegment 2 () r :+ l) -&gt; LineSegment 2 () r :+ Maybe l)
-&gt; LineSegment 2 () r :+ Maybe l
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(l -&gt; Identity (Maybe l))
-&gt; (LineSegment 2 () r :+ l)
-&gt; Identity (LineSegment 2 () r :+ Maybe l)
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span> </span><span class="annot"><span class="annottext">((l -&gt; Identity (Maybe l))
 -&gt; (LineSegment 2 () r :+ l)
 -&gt; Identity (LineSegment 2 () r :+ Maybe l))
-&gt; (l -&gt; Maybe l)
-&gt; (LineSegment 2 () r :+ l)
-&gt; LineSegment 2 () r :+ Maybe l
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">l -&gt; Maybe l
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>                 </span><span class="annot"><span class="annottext">([LineSegment 2 () r :+ l] -&gt; [LineSegment 2 () r :+ Maybe l])
-&gt; ([(Line 2 r :+ l, [Line 2 r :+ l])]
    -&gt; [LineSegment 2 () r :+ l])
-&gt; [(Line 2 r :+ l, [Line 2 r :+ l])]
-&gt; [LineSegment 2 () r :+ Maybe l]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Line 2 r :+ l, [Line 2 r :+ l]) -&gt; [LineSegment 2 () r :+ l])
-&gt; [(Line 2 r :+ l, [Line 2 r :+ l])] -&gt; [LineSegment 2 () r :+ l]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Line 2 r :+ l) -&gt; [Line 2 r :+ l] -&gt; [LineSegment 2 () r :+ l])
-&gt; (Line 2 r :+ l, [Line 2 r :+ l]) -&gt; [LineSegment 2 () r :+ l]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle () r
-&gt; (Line 2 r :+ l) -&gt; [Line 2 r :+ l] -&gt; [LineSegment 2 () r :+ l]
forall r l.
(Ord r, Fractional r) =&gt;
Rectangle () r
-&gt; (Line 2 r :+ l) -&gt; [Line 2 r :+ l] -&gt; [LineSegment 2 () r :+ l]
</span><a href="Data.Geometry.Arrangement.Internal.html#perLine"><span class="hs-identifier hs-var">perLine</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988345"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Line 2 r :+ l, [Line 2 r :+ l])]
 -&gt; [LineSegment 2 () r :+ Maybe l])
-&gt; [(Line 2 r :+ l, [Line 2 r :+ l])]
-&gt; [LineSegment 2 () r :+ Maybe l]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l] -&gt; [(Line 2 r :+ l, [Line 2 r :+ l])]
forall a. [a] -&gt; [(a, [a])]
</span><a href="Data.Geometry.Arrangement.Internal.html#makePairs"><span class="hs-identifier hs-var">makePairs</span></a></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988344"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679988342"><span class="annot"><span class="annottext">boundarySegs :: [LineSegment 2 () r :+ Maybe l]
</span><a href="#local-6989586621679988342"><span class="hs-identifier hs-var hs-var">boundarySegs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 () r -&gt; LineSegment 2 () r :+ Maybe l)
-&gt; [LineSegment 2 () r] -&gt; [LineSegment 2 () r :+ Maybe l]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineSegment 2 () r -&gt; Maybe l -&gt; LineSegment 2 () r :+ Maybe l
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Maybe l
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([LineSegment 2 () r] -&gt; [LineSegment 2 () r :+ Maybe l])
-&gt; ([Point 2 r] -&gt; [LineSegment 2 () r])
-&gt; [Point 2 r]
-&gt; [LineSegment 2 () r :+ Maybe l]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [LineSegment 2 () r]
forall r. Ord r =&gt; [Point 2 r] -&gt; [LineSegment 2 () r]
</span><a href="Data.Geometry.Arrangement.Internal.html#toSegments"><span class="hs-identifier hs-var">toSegments</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; [LineSegment 2 () r])
-&gt; ([Point 2 r] -&gt; [Point 2 r])
-&gt; [Point 2 r]
-&gt; [LineSegment 2 () r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r]
forall a. [a] -&gt; [a]
</span><a href="#local-6989586621679988332"><span class="hs-identifier hs-var">dupFirst</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; [LineSegment 2 () r :+ Maybe l])
-&gt; [Point 2 r] -&gt; [LineSegment 2 () r :+ Maybe l]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Maybe (Line 2 r :+ l)) -&gt; Point 2 r)
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))] -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r, Maybe (Line 2 r :+ l)) -&gt; Point 2 r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988341"><span class="hs-identifier hs-var">parts'</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679988332"><span class="annot"><span class="annottext">dupFirst :: [a] -&gt; [a]
</span><a href="#local-6989586621679988332"><span class="hs-identifier hs-var hs-var">dupFirst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>                     </span><span id="local-6989586621679988331"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679988331"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679988330"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679988330"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679988331"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988330"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679988341"><span class="annot"><span class="annottext">parts' :: [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988341"><span class="hs-identifier hs-var hs-var">parts'</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle () r
-&gt; [Line 2 r :+ l] -&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall r l.
(Ord r, Fractional r) =&gt;
Rectangle () r
-&gt; [Line 2 r :+ l] -&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="Data.Geometry.Arrangement.Internal.html#unBoundedParts"><span class="hs-identifier hs-var">unBoundedParts</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988345"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988344"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#perLine"><span class="hs-identifier hs-type">perLine</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679988724"><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679988723"><span class="annot"><a href="#local-6989586621679988723"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988723"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988723"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.LineSegment.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988723"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span id="perLine"><span class="annot"><span class="annottext">perLine :: Rectangle () r
-&gt; (Line 2 r :+ l) -&gt; [Line 2 r :+ l] -&gt; [LineSegment 2 () r :+ l]
</span><a href="Data.Geometry.Arrangement.Internal.html#perLine"><span class="hs-identifier hs-var hs-var">perLine</span></a></span></span><span> </span><span id="local-6989586621679988328"><span class="annot"><span class="annottext">b :: Rectangle () r
</span><a href="#local-6989586621679988328"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679988327"><span class="annot"><span class="annottext">m :: Line 2 r :+ l
</span><a href="#local-6989586621679988327"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679988326"><span class="annot"><span class="annottext">ls :: [Line 2 r :+ l]
</span><a href="#local-6989586621679988326"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 () r -&gt; LineSegment 2 () r :+ l)
-&gt; [LineSegment 2 () r] -&gt; [LineSegment 2 () r :+ l]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineSegment 2 () r -&gt; l -&gt; LineSegment 2 () r :+ l
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Line 2 r :+ l
</span><a href="#local-6989586621679988327"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">(Line 2 r :+ l) -&gt; Getting l (Line 2 r :+ l) l -&gt; l
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting l (Line 2 r :+ l) l
forall core extra extra'.
Lens (core :+ extra) (core :+ extra') extra extra'
</span><span class="hs-identifier hs-var">extra</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([LineSegment 2 () r] -&gt; [LineSegment 2 () r :+ l])
-&gt; ([Point 2 r] -&gt; [LineSegment 2 () r])
-&gt; [Point 2 r]
-&gt; [LineSegment 2 () r :+ l]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [LineSegment 2 () r]
forall r. Ord r =&gt; [Point 2 r] -&gt; [LineSegment 2 () r]
</span><a href="Data.Geometry.Arrangement.Internal.html#toSegments"><span class="hs-identifier hs-var">toSegments</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; [LineSegment 2 () r])
-&gt; ([Point 2 r] -&gt; [Point 2 r])
-&gt; [Point 2 r]
-&gt; [LineSegment 2 () r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r]
</span><a href="#local-6989586621679988324"><span class="hs-identifier hs-var">rmDuplicates</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; [Point 2 r])
-&gt; ([Point 2 r] -&gt; [Point 2 r]) -&gt; [Point 2 r] -&gt; [Point 2 r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sort</span></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; [LineSegment 2 () r :+ l])
-&gt; [Point 2 r] -&gt; [LineSegment 2 () r :+ l]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621679988322"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [Point 2 r] -&gt; [Point 2 r]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621679988321"><span class="hs-identifier hs-var">vs'</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span id="local-6989586621679988324"><span class="annot"><span class="annottext">rmDuplicates :: [Point 2 r] -&gt; [Point 2 r]
</span><a href="#local-6989586621679988324"><span class="hs-identifier hs-var hs-var">rmDuplicates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; Point 2 r) -&gt; [[Point 2 r]] -&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; Point 2 r
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([[Point 2 r]] -&gt; [Point 2 r])
-&gt; ([Point 2 r] -&gt; [[Point 2 r]]) -&gt; [Point 2 r] -&gt; [Point 2 r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; [[Point 2 r]]
forall a. Eq a =&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">List.group</span></span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679988322"><span class="annot"><span class="annottext">vs :: [Point 2 r]
</span><a href="#local-6989586621679988322"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Line 2 r :+ l) -&gt; Maybe (Point 2 r))
-&gt; [Line 2 r :+ l] -&gt; [Point 2 r]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Line 2 r :+ l
</span><a href="#local-6989586621679988327"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Line 2 r :+ l) -&gt; (Line 2 r :+ l) -&gt; Maybe (Point 2 r)
forall r l.
(Ord r, Fractional r) =&gt;
(Line 2 r :+ l) -&gt; (Line 2 r :+ l) -&gt; Maybe (Point 2 r)
</span><a href="Data.Geometry.Arrangement.Internal.html#intersectionPoint"><span class="hs-operator hs-var">`intersectionPoint`</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988326"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679988321"><span class="annot"><span class="annottext">vs' :: [Point 2 r]
</span><a href="#local-6989586621679988321"><span class="hs-identifier hs-var hs-var">vs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
-&gt; ((Point 2 r, Point 2 r) -&gt; [Point 2 r])
-&gt; Maybe (Point 2 r, Point 2 r)
-&gt; [Point 2 r]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679988315"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679988315"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679988314"><span class="annot"><span class="annottext">q :: Point 2 r
</span><a href="#local-6989586621679988314"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988315"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988314"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Point 2 r, Point 2 r) -&gt; [Point 2 r])
-&gt; (CoRec
      Identity
      '[NoIntersection, Point 2 r, (Point 2 r, Point 2 r),
        LineSegment 2 () r]
    -&gt; Maybe (Point 2 r, Point 2 r))
-&gt; CoRec
     Identity
     '[NoIntersection, Point 2 r, (Point 2 r, Point 2 r),
       LineSegment 2 () r]
-&gt; [Point 2 r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]).
NatToInt (RIndex (Point 2 r, Point 2 r) ts) =&gt;
CoRec Identity ts -&gt; Maybe (Point 2 r, Point 2 r)
forall t (ts :: [*]).
NatToInt (RIndex t ts) =&gt;
CoRec Identity ts -&gt; Maybe t
</span><span class="hs-identifier hs-var">asA</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988724"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><span class="annottext">(CoRec
   Identity
   '[NoIntersection, Point 2 r, (Point 2 r, Point 2 r),
     LineSegment 2 () r]
 -&gt; [Point 2 r])
-&gt; CoRec
     Identity
     '[NoIntersection, Point 2 r, (Point 2 r, Point 2 r),
       LineSegment 2 () r]
-&gt; [Point 2 r]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Line 2 r :+ l
</span><a href="#local-6989586621679988327"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">(Line 2 r :+ l)
-&gt; Getting (Line 2 r) (Line 2 r :+ l) (Line 2 r) -&gt; Line 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Line 2 r) (Line 2 r :+ l) (Line 2 r)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Line 2 r
-&gt; Boundary (Rectangle () r)
-&gt; Intersection (Line 2 r) (Boundary (Rectangle () r))
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; Boundary (Rectangle () r)
forall g. g -&gt; Boundary g
</span><a href="Data.Geometry.Boundary.html#Boundary"><span class="hs-identifier hs-var">Boundary</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988328"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#intersectionPoint"><span class="hs-identifier hs-type">intersectionPoint</span></a></span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679988699"><span class="annot"><a href="#local-6989586621679988699"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679988698"><span class="annot"><a href="#local-6989586621679988698"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>                                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988699"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988698"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988699"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988698"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span id="intersectionPoint"><span class="annot"><span class="annottext">intersectionPoint :: (Line 2 r :+ l) -&gt; (Line 2 r :+ l) -&gt; Maybe (Point 2 r)
</span><a href="Data.Geometry.Arrangement.Internal.html#intersectionPoint"><span class="hs-identifier hs-var hs-var">intersectionPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988309"><span class="annot"><span class="annottext">l :: Line 2 r
</span><a href="#local-6989586621679988309"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988308"><span class="annot"><span class="annottext">m :: Line 2 r
</span><a href="#local-6989586621679988308"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]).
NatToInt (RIndex (Point 2 r) ts) =&gt;
CoRec Identity ts -&gt; Maybe (Point 2 r)
forall t (ts :: [*]).
NatToInt (RIndex t ts) =&gt;
CoRec Identity ts -&gt; Maybe t
</span><span class="hs-identifier hs-var">asA</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoRec Identity '[NoIntersection, Point 2 r, Line 2 r]
 -&gt; Maybe (Point 2 r))
-&gt; CoRec Identity '[NoIntersection, Point 2 r, Line 2 r]
-&gt; Maybe (Point 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Line 2 r
</span><a href="#local-6989586621679988309"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Line 2 r -&gt; Line 2 r -&gt; Intersection (Line 2 r) (Line 2 r)
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">Line 2 r
</span><a href="#local-6989586621679988308"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span id="local-6989586621679988716"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#toSegments"><span class="hs-identifier hs-type">toSegments</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988716"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988716"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.LineSegment.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988716"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-125"></span><span id="toSegments"><span class="annot"><span class="annottext">toSegments :: [Point 2 r] -&gt; [LineSegment 2 () r]
</span><a href="Data.Geometry.Arrangement.Internal.html#toSegments"><span class="hs-identifier hs-var hs-var">toSegments</span></a></span></span><span> </span><span id="local-6989586621679988307"><span class="annot"><span class="annottext">ps :: [Point 2 r]
</span><a href="#local-6989586621679988307"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679988306"><span class="annot"><span class="annottext">pts :: [Point 2 r :+ ()]
</span><a href="#local-6989586621679988306"><span class="hs-identifier hs-var hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Point 2 r :+ ()) -&gt; [Point 2 r] -&gt; [Point 2 r :+ ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r :+ ()
forall a. a -&gt; a :+ ()
</span><span class="hs-identifier hs-var">ext</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r]
</span><a href="#local-6989586621679988307"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">((Point 2 r :+ ()) -&gt; (Point 2 r :+ ()) -&gt; LineSegment 2 () r)
-&gt; [Point 2 r :+ ()] -&gt; [Point 2 r :+ ()] -&gt; [LineSegment 2 () r]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r :+ ()) -&gt; (Point 2 r :+ ()) -&gt; LineSegment 2 () r
forall (d :: Nat) r p.
(Point d r :+ p) -&gt; (Point d r :+ p) -&gt; LineSegment d p r
</span><a href="Data.Geometry.LineSegment.html#ClosedLineSegment"><span class="hs-identifier hs-var">ClosedLineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ ()]
</span><a href="#local-6989586621679988306"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point 2 r :+ ()] -&gt; [Point 2 r :+ ()]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r :+ ()]
</span><a href="#local-6989586621679988306"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Constructs a boundingbox containing all intersections</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- running time: \(O(n^2)\), where \(n\) is the number of input lines</span><span>
</span><span id="line-132"></span><span id="local-6989586621679988817"><span id="local-6989586621679988818"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#makeBoundingBox"><span class="hs-identifier hs-type">makeBoundingBox</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988818"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988818"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988818"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988817"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988818"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-133"></span><span id="makeBoundingBox"><span class="annot"><span class="annottext">makeBoundingBox :: [Line 2 r :+ l] -&gt; Rectangle () r
</span><a href="Data.Geometry.Arrangement.Internal.html#makeBoundingBox"><span class="hs-identifier hs-var hs-var">makeBoundingBox</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; Rectangle () r -&gt; Rectangle () r
forall r (d :: Nat) p.
(Num r, Arity d) =&gt;
r -&gt; Box d p r -&gt; Box d p r
</span><a href="Data.Geometry.Box.Internal.html#grow"><span class="hs-identifier hs-var">grow</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Rectangle () r -&gt; Rectangle () r)
-&gt; ([Line 2 r :+ l] -&gt; Rectangle () r)
-&gt; [Line 2 r :+ l]
-&gt; Rectangle () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Point 2 r] -&gt; Rectangle () r
forall g (c :: * -&gt; *).
(IsBoxable g, Foldable c, Ord (NumType g), Arity (Dimension g)) =&gt;
c g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Data.Geometry.Box.Internal.html#boundingBoxList%27"><span class="hs-identifier hs-var">boundingBoxList'</span></a></span><span> </span><span class="annot"><span class="annottext">([Point 2 r] -&gt; Rectangle () r)
-&gt; ([Line 2 r :+ l] -&gt; [Point 2 r])
-&gt; [Line 2 r :+ l]
-&gt; Rectangle () r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l] -&gt; [Point 2 r]
forall r l. (Ord r, Fractional r) =&gt; [Line 2 r :+ l] -&gt; [Point 2 r]
</span><a href="Data.Geometry.Arrangement.Internal.html#intersections"><span class="hs-identifier hs-var">intersections</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Computes all intersections</span><span>
</span><span id="line-136"></span><span id="local-6989586621679988656"><span id="local-6989586621679988657"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#intersections"><span class="hs-identifier hs-type">intersections</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988657"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988657"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988657"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988656"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988657"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-137"></span><span id="intersections"><span class="annot"><span class="annottext">intersections :: [Line 2 r :+ l] -&gt; [Point 2 r]
</span><a href="Data.Geometry.Arrangement.Internal.html#intersections"><span class="hs-identifier hs-var hs-var">intersections</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Line 2 r :+ l, Line 2 r :+ l) -&gt; Maybe (Point 2 r))
-&gt; [(Line 2 r :+ l, Line 2 r :+ l)] -&gt; [Point 2 r]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Line 2 r :+ l) -&gt; (Line 2 r :+ l) -&gt; Maybe (Point 2 r))
-&gt; (Line 2 r :+ l, Line 2 r :+ l) -&gt; Maybe (Point 2 r)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">(Line 2 r :+ l) -&gt; (Line 2 r :+ l) -&gt; Maybe (Point 2 r)
forall r l.
(Ord r, Fractional r) =&gt;
(Line 2 r :+ l) -&gt; (Line 2 r :+ l) -&gt; Maybe (Point 2 r)
</span><a href="Data.Geometry.Arrangement.Internal.html#intersectionPoint"><span class="hs-identifier hs-var">intersectionPoint</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Line 2 r :+ l, Line 2 r :+ l)] -&gt; [Point 2 r])
-&gt; ([Line 2 r :+ l] -&gt; [(Line 2 r :+ l, Line 2 r :+ l)])
-&gt; [Line 2 r :+ l]
-&gt; [Point 2 r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l] -&gt; [(Line 2 r :+ l, Line 2 r :+ l)]
forall a. [a] -&gt; [(a, a)]
</span><a href="Data.Geometry.Arrangement.Internal.html#allPairs"><span class="hs-identifier hs-var">allPairs</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- intersections :: forall p r. (Ord r, Fractional r)</span><span>
</span><span id="line-141"></span><span class="hs-comment">--               =&gt; [Line 2 r :+ p] -&gt; Map.Map (Point 2 r) (NonEmpty (Line 2 r :+ p))</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- intersections = Map.map sortNub . collect</span><span>
</span><span id="line-143"></span><span class="hs-comment">--               . mapMaybe (\(l,m) -&gt; (l, m,) &lt;$&gt; f l m) . allPairs</span><span>
</span><span id="line-144"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-145"></span><span class="hs-comment">--     f (l :+ _) (m :+ _) = asA (Proxy :: Proxy (Point 2 r)) $ l `intersect` m</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- collect :: Ord k =&gt; [(v,v,k)] -&gt; Map.Map k (NonEmpty v)</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- collect = foldr f mempty</span><span>
</span><span id="line-151"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-152"></span><span class="hs-comment">--     f (l,m,p) = Map.insertWith (&lt;&gt;) p (NonEmpty.fromList [l,m])</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- sortNub :: Ord r =&gt; NonEmpty (Line 2 r :+ p) -&gt; NonEmpty (Line 2 r :+ p)</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- sortNub = fmap (NonEmpty.head) .  groupLines</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- groupLines :: Ord r =&gt; NonEmpty (Line 2 r :+ p)</span><span>
</span><span id="line-158"></span><span class="hs-comment">--            -&gt; NonEmpty (NonEmpty (Line 2 r :+ p))</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- groupLines = NonEmpty.groupWith1 L2 . NonEmpty.sortWith L2</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- -- | Newtype wrapper that allows us to sort lines</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- newtype L2 r p = L2 (Line 2 r :+ p) deriving (Show)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- instance Eq r =&gt; Eq (L2 r p) where</span><span>
</span><span id="line-166"></span><span class="hs-comment">--   (L2 (Line p u :+ _)) == (L2 (Line q v :+ _)) = (p,u) == (q,v)</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- instance Ord r =&gt; Ord (L2 r p) where</span><span>
</span><span id="line-168"></span><span class="hs-comment">--   (L2 (Line p u :+ _)) `compare` (L2 (Line q v :+ _)) = p `compare` q &lt;&gt; u `compare` v</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- -- | Collect the intersection points per line</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- byLine :: Ord r</span><span>
</span><span id="line-172"></span><span class="hs-comment">--        =&gt; Map.Map (Point 2 r) (NonEmpty (Line 2 r :+ p))</span><span>
</span><span id="line-173"></span><span class="hs-comment">--        -&gt; Map.Map (L2 r p)    (NonEmpty (Point 2 r))</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- byLine = foldr f mempty . flatten . Map.assocs</span><span>
</span><span id="line-175"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-176"></span><span class="hs-comment">--     flatten = concatMap (\(p,ls) -&gt; map (\l -&gt; (L2 l,p)) $ NonEmpty.toList ls)</span><span>
</span><span id="line-177"></span><span class="hs-comment">--     f (l,p) = Map.insertWith (&lt;&gt;) l $ NonEmpty.fromList [p]</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Computes the intersections with a particular side</span><span>
</span><span id="line-181"></span><span id="local-6989586621679988623"><span id="local-6989586621679988624"><span id="local-6989586621679988625"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#sideIntersections"><span class="hs-identifier hs-type">sideIntersections</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988625"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988625"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988625"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988624"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.LineSegment.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988623"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988625"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-183"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988625"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988625"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988624"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-184"></span><span id="sideIntersections"><span class="annot"><span class="annottext">sideIntersections :: [Line 2 r :+ l]
-&gt; LineSegment 2 q r -&gt; [(Point 2 r, Line 2 r :+ l)]
</span><a href="Data.Geometry.Arrangement.Internal.html#sideIntersections"><span class="hs-identifier hs-var hs-var">sideIntersections</span></a></span></span><span> </span><span id="local-6989586621679988296"><span class="annot"><span class="annottext">ls :: [Line 2 r :+ l]
</span><a href="#local-6989586621679988296"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679988295"><span class="annot"><span class="annottext">s :: LineSegment 2 q r
</span><a href="#local-6989586621679988295"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679988294"><span class="annot"><span class="annottext">l :: Line 2 r :+ l
</span><a href="#local-6989586621679988294"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 q r
-&gt; Line
     (Dimension (LineSegment 2 q r)) (NumType (LineSegment 2 q r))
forall t.
HasSupportingLine t =&gt;
t -&gt; Line (Dimension t) (NumType t)
</span><a href="Data.Geometry.Line.Internal.html#supportingLine"><span class="hs-identifier hs-var">supportingLine</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 q r
</span><a href="#local-6989586621679988295"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Line 2 r -&gt; l -&gt; Line 2 r :+ l
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">l
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-185"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Line 2 r :+ l) -&gt; Point 2 r)
-&gt; [(Point 2 r, Line 2 r :+ l)] -&gt; [(Point 2 r, Line 2 r :+ l)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sortOn</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r, Line 2 r :+ l) -&gt; Point 2 r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(Point 2 r, Line 2 r :+ l)] -&gt; [(Point 2 r, Line 2 r :+ l)])
-&gt; ([Line 2 r :+ l] -&gt; [(Point 2 r, Line 2 r :+ l)])
-&gt; [Line 2 r :+ l]
-&gt; [(Point 2 r, Line 2 r :+ l)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, Line 2 r :+ l) -&gt; Bool)
-&gt; [(Point 2 r, Line 2 r :+ l)] -&gt; [(Point 2 r, Line 2 r :+ l)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; LineSegment 2 q r -&gt; Bool)
-&gt; LineSegment 2 q r -&gt; Point 2 r -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; LineSegment 2 q r -&gt; Bool
forall r (d :: Nat) p.
(Ord r, Fractional r, Arity d) =&gt;
Point d r -&gt; LineSegment d p r -&gt; Bool
</span><a href="Data.Geometry.LineSegment.html#onSegment"><span class="hs-identifier hs-var">onSegment</span></a></span><span> </span><span class="annot"><span class="annottext">LineSegment 2 q r
</span><a href="#local-6989586621679988295"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Bool)
-&gt; ((Point 2 r, Line 2 r :+ l) -&gt; Point 2 r)
-&gt; (Point 2 r, Line 2 r :+ l)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r, Line 2 r :+ l) -&gt; Point 2 r
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                          </span><span class="annot"><span class="annottext">([(Point 2 r, Line 2 r :+ l)] -&gt; [(Point 2 r, Line 2 r :+ l)])
-&gt; ([Line 2 r :+ l] -&gt; [(Point 2 r, Line 2 r :+ l)])
-&gt; [Line 2 r :+ l]
-&gt; [(Point 2 r, Line 2 r :+ l)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Line 2 r :+ l) -&gt; Maybe (Point 2 r, Line 2 r :+ l))
-&gt; [Line 2 r :+ l] -&gt; [(Point 2 r, Line 2 r :+ l)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679988288"><span class="annot"><span class="annottext">m :: Line 2 r :+ l
</span><a href="#local-6989586621679988288"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Line 2 r :+ l
</span><a href="#local-6989586621679988288"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; (Point 2 r, Line 2 r :+ l))
-&gt; Maybe (Point 2 r) -&gt; Maybe (Point 2 r, Line 2 r :+ l)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Line 2 r :+ l
</span><a href="#local-6989586621679988294"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(Line 2 r :+ l) -&gt; (Line 2 r :+ l) -&gt; Maybe (Point 2 r)
forall r l.
(Ord r, Fractional r) =&gt;
(Line 2 r :+ l) -&gt; (Line 2 r :+ l) -&gt; Maybe (Point 2 r)
</span><a href="Data.Geometry.Arrangement.Internal.html#intersectionPoint"><span class="hs-operator hs-var">`intersectionPoint`</span></a></span><span> </span><span class="annot"><span class="annottext">Line 2 r :+ l
</span><a href="#local-6989586621679988288"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Line 2 r :+ l] -&gt; [(Point 2 r, Line 2 r :+ l)])
-&gt; [Line 2 r :+ l] -&gt; [(Point 2 r, Line 2 r :+ l)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988296"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Constructs the unbounded intersections. Reported in clockwise direction.</span><span>
</span><span id="line-189"></span><span id="local-6989586621679988710"><span id="local-6989586621679988711"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#unBoundedParts"><span class="hs-identifier hs-type">unBoundedParts</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988711"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988711"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988711"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-191"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988711"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988710"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988711"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988711"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988710"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-193"></span><span id="unBoundedParts"><span class="annot"><span class="annottext">unBoundedParts :: Rectangle () r
-&gt; [Line 2 r :+ l] -&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="Data.Geometry.Arrangement.Internal.html#unBoundedParts"><span class="hs-identifier hs-var hs-var">unBoundedParts</span></a></span></span><span> </span><span id="local-6989586621679988286"><span class="annot"><span class="annottext">rect :: Rectangle () r
</span><a href="#local-6989586621679988286"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span id="local-6989586621679988285"><span class="annot"><span class="annottext">ls :: [Line 2 r :+ l]
</span><a href="#local-6989586621679988285"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point 2 r, Maybe (Line 2 r :+ l))
</span><a href="#local-6989586621679988284"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988283"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point 2 r, Maybe (Line 2 r :+ l))
</span><a href="#local-6989586621679988282"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988280"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point 2 r, Maybe (Line 2 r :+ l))
</span><a href="#local-6989586621679988279"><span class="hs-identifier hs-var">br</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988278"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Point 2 r, Maybe (Line 2 r :+ l))
</span><a href="#local-6989586621679988277"><span class="hs-identifier hs-var">bl</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988276"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679988275"><span class="annot"><span class="annottext">sideIntersections' :: LineSegment 2 () r -&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988275"><span class="hs-identifier hs-var hs-var">sideIntersections'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter
  [(Point 2 r, Line 2 r :+ l)]
  [(Point 2 r, Maybe (Line 2 r :+ l))]
  (Line 2 r :+ l)
  (Maybe (Line 2 r :+ l))
-&gt; ((Line 2 r :+ l) -&gt; Maybe (Line 2 r :+ l))
-&gt; [(Point 2 r, Line 2 r :+ l)]
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Point 2 r, Line 2 r :+ l)
 -&gt; Identity (Point 2 r, Maybe (Line 2 r :+ l)))
-&gt; [(Point 2 r, Line 2 r :+ l)]
-&gt; Identity [(Point 2 r, Maybe (Line 2 r :+ l))]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">(((Point 2 r, Line 2 r :+ l)
  -&gt; Identity (Point 2 r, Maybe (Line 2 r :+ l)))
 -&gt; [(Point 2 r, Line 2 r :+ l)]
 -&gt; Identity [(Point 2 r, Maybe (Line 2 r :+ l))])
-&gt; (((Line 2 r :+ l) -&gt; Identity (Maybe (Line 2 r :+ l)))
    -&gt; (Point 2 r, Line 2 r :+ l)
    -&gt; Identity (Point 2 r, Maybe (Line 2 r :+ l)))
-&gt; ASetter
     [(Point 2 r, Line 2 r :+ l)]
     [(Point 2 r, Maybe (Line 2 r :+ l))]
     (Line 2 r :+ l)
     (Maybe (Line 2 r :+ l))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((Line 2 r :+ l) -&gt; Identity (Maybe (Line 2 r :+ l)))
-&gt; (Point 2 r, Line 2 r :+ l)
-&gt; Identity (Point 2 r, Maybe (Line 2 r :+ l))
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Line 2 r :+ l) -&gt; Maybe (Line 2 r :+ l)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([(Point 2 r, Line 2 r :+ l)]
 -&gt; [(Point 2 r, Maybe (Line 2 r :+ l))])
-&gt; (LineSegment 2 () r -&gt; [(Point 2 r, Line 2 r :+ l)])
-&gt; LineSegment 2 () r
-&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
-&gt; LineSegment 2 () r -&gt; [(Point 2 r, Line 2 r :+ l)]
forall r l q.
(Ord r, Fractional r) =&gt;
[Line 2 r :+ l]
-&gt; LineSegment 2 q r -&gt; [(Point 2 r, Line 2 r :+ l)]
</span><a href="Data.Geometry.Arrangement.Internal.html#sideIntersections"><span class="hs-identifier hs-var">sideIntersections</span></a></span><span> </span><span class="annot"><span class="annottext">[Line 2 r :+ l]
</span><a href="#local-6989586621679988285"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="Data.Geometry.Box.Sides.html#Sides"><span class="hs-identifier hs-type">Sides</span></a></span><span> </span><span id="local-6989586621679988283"><span class="annot"><span class="annottext">t :: [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988283"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679988280"><span class="annot"><span class="annottext">r :: [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988280"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679988278"><span class="annot"><span class="annottext">b :: [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988278"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679988276"><span class="annot"><span class="annottext">l :: [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988276"><span class="hs-identifier hs-var">l</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineSegment 2 () r -&gt; [(Point 2 r, Maybe (Line 2 r :+ l))]
</span><a href="#local-6989586621679988275"><span class="hs-identifier hs-var">sideIntersections'</span></a></span><span>    </span><span class="annot"><span class="annottext">(LineSegment 2 () r -&gt; [(Point 2 r, Maybe (Line 2 r :+ l))])
-&gt; Sides (LineSegment 2 () r)
-&gt; Sides [(Point 2 r, Maybe (Line 2 r :+ l))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; Sides (LineSegment 2 () r)
forall r p. Num r =&gt; Rectangle p r -&gt; Sides (LineSegment 2 p r)
</span><a href="Data.Geometry.Box.Sides.html#sides"><span class="hs-identifier hs-var">sides</span></a></span><span>   </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988286"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="Data.Geometry.Box.Corners.html#Corners"><span class="hs-identifier hs-type">Corners</span></a></span><span> </span><span id="local-6989586621679988284"><span class="annot"><span class="annottext">tl :: (Point 2 r, Maybe (Line 2 r :+ l))
</span><a href="#local-6989586621679988284"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679988282"><span class="annot"><span class="annottext">tr :: (Point 2 r, Maybe (Line 2 r :+ l))
</span><a href="#local-6989586621679988282"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679988279"><span class="annot"><span class="annottext">br :: (Point 2 r, Maybe (Line 2 r :+ l))
</span><a href="#local-6989586621679988279"><span class="hs-identifier hs-var">br</span></a></span></span><span> </span><span id="local-6989586621679988277"><span class="annot"><span class="annottext">bl :: (Point 2 r, Maybe (Line 2 r :+ l))
</span><a href="#local-6989586621679988277"><span class="hs-identifier hs-var">bl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Maybe (Line 2 r :+ l)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; (Point 2 r, Maybe (Line 2 r :+ l)))
-&gt; ((Point 2 r :+ ()) -&gt; Point 2 r)
-&gt; (Point 2 r :+ ())
-&gt; (Point 2 r, Maybe (Line 2 r :+ l))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r :+ ())
-&gt; Getting (Point 2 r) (Point 2 r :+ ()) (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Point 2 r) (Point 2 r :+ ()) (Point 2 r)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ ()) -&gt; (Point 2 r, Maybe (Line 2 r :+ l)))
-&gt; Corners (Point 2 r :+ ())
-&gt; Corners (Point 2 r, Maybe (Line 2 r :+ l))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; Corners (Point 2 r :+ ())
forall r p. Num r =&gt; Rectangle p r -&gt; Corners (Point 2 r :+ p)
</span><a href="Data.Geometry.Box.Corners.html#corners"><span class="hs-identifier hs-var">corners</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle () r
</span><a href="#local-6989586621679988286"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Links the vertices  of the outer boundary with those in the subdivision</span><span>
</span><span id="line-201"></span><span id="local-6989586621679988785"><span id="local-6989586621679988786"><span id="local-6989586621679988787"><span id="local-6989586621679988788"><span id="local-6989586621679988789"><span id="local-6989586621679988790"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#link"><span class="hs-identifier hs-type">link</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679988790"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988790"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679988789"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988788"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988787"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679988786"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988785"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988790"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-202"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988790"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679988788"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679988789"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-203"></span><span id="link"><span class="annot"><span class="annottext">link :: [(Point 2 r, a)]
-&gt; PlanarSubdivision s v (Maybe e) f r
-&gt; Vector (Point 2 r, VertexId' s, a)
</span><a href="Data.Geometry.Arrangement.Internal.html#link"><span class="hs-identifier hs-var hs-var">link</span></a></span></span><span> </span><span id="local-6989586621679988268"><span class="annot"><span class="annottext">vs :: [(Point 2 r, a)]
</span><a href="#local-6989586621679988268"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679988267"><span class="annot"><span class="annottext">ps :: PlanarSubdivision s v (Maybe e) f r
</span><a href="#local-6989586621679988267"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, VertexId' s, a)] -&gt; Vector (Point 2 r, VertexId' s, a)
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Point 2 r, VertexId' s, a)]
 -&gt; Vector (Point 2 r, VertexId' s, a))
-&gt; (Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
    -&gt; [(Point 2 r, VertexId' s, a)])
-&gt; Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
-&gt; Vector (Point 2 r, VertexId' s, a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(((Point 2 r, a), (Point 2 r, VertexId' s))
 -&gt; (Point 2 r, VertexId' s, a))
-&gt; [((Point 2 r, a), (Point 2 r, VertexId' s))]
-&gt; [(Point 2 r, VertexId' s, a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679988266"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679988266"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679988265"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679988265"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span id="local-6989586621679988264"><span class="annot"><span class="annottext">y :: VertexId' s
</span><a href="#local-6989586621679988264"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988266"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679988264"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988265"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((Point 2 r, a), (Point 2 r, VertexId' s))]
 -&gt; [(Point 2 r, VertexId' s, a)])
-&gt; (Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
    -&gt; [((Point 2 r, a), (Point 2 r, VertexId' s))])
-&gt; Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
-&gt; [(Point 2 r, VertexId' s, a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CSeq ((Point 2 r, a), (Point 2 r, VertexId' s))
-&gt; [((Point 2 r, a), (Point 2 r, VertexId' s))]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span>
</span><span id="line-204"></span><span>           </span><span class="annot"><span class="annottext">(CSeq ((Point 2 r, a), (Point 2 r, VertexId' s))
 -&gt; [((Point 2 r, a), (Point 2 r, VertexId' s))])
-&gt; (Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
    -&gt; CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
-&gt; Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
-&gt; [((Point 2 r, a), (Point 2 r, VertexId' s))]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
-&gt; CSeq ((Point 2 r, a), (Point 2 r, VertexId' s))
forall a. Maybe a -&gt; a
</span><a href="#local-6989586621679988262"><span class="hs-identifier hs-var">fromJust'</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
 -&gt; Vector (Point 2 r, VertexId' s, a))
-&gt; Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
-&gt; Vector (Point 2 r, VertexId' s, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, a) -&gt; (Point 2 r, VertexId' s) -&gt; Bool)
-&gt; CSeq (Point 2 r, a)
-&gt; CSeq (Point 2 r, VertexId' s)
-&gt; Maybe (CSeq ((Point 2 r, a), (Point 2 r, VertexId' s)))
forall a b.
(a -&gt; b -&gt; Bool) -&gt; CSeq a -&gt; CSeq b -&gt; Maybe (CSeq (a, b))
</span><a href="Data.Geometry.Arrangement.Internal.html#alignWith"><span class="hs-identifier hs-var">alignWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679988260"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679988260"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988259"><span class="annot"><span class="annottext">q :: Point 2 r
</span><a href="#local-6989586621679988259"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988260"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988259"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Point 2 r, a)] -&gt; CSeq (Point 2 r, a)
forall a. [a] -&gt; CSeq a
</span><span class="hs-identifier hs-var">CSeq.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, a)]
</span><a href="#local-6989586621679988268"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CSeq (Point 2 r, VertexId' s)
</span><a href="#local-6989586621679988257"><span class="hs-identifier hs-var">vs'</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679988257"><span class="annot"><span class="annottext">vs' :: CSeq (Point 2 r, VertexId' s)
</span><a href="#local-6989586621679988257"><span class="hs-identifier hs-var hs-var">vs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Point 2 r, VertexId' s)] -&gt; CSeq (Point 2 r, VertexId' s)
forall a. [a] -&gt; CSeq a
</span><span class="hs-identifier hs-var">CSeq.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Point 2 r, VertexId' s)] -&gt; CSeq (Point 2 r, VertexId' s))
-&gt; (Vector (VertexId' s) -&gt; [(Point 2 r, VertexId' s)])
-&gt; Vector (VertexId' s)
-&gt; CSeq (Point 2 r, VertexId' s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VertexId' s -&gt; (Point 2 r, VertexId' s))
-&gt; [VertexId' s] -&gt; [(Point 2 r, VertexId' s)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679988256"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679988256"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r
</span><a href="#local-6989586621679988267"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r
-&gt; Getting
     (Point 2 r) (PlanarSubdivision s v (Maybe e) f r) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' s
-&gt; Lens' (PlanarSubdivision s v (Maybe e) f r) (Point 2 r)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (Point 2 r)
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#locationOf"><span class="hs-identifier hs-var">locationOf</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679988256"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679988256"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([VertexId' s] -&gt; [(Point 2 r, VertexId' s)])
-&gt; (Vector (VertexId' s) -&gt; [VertexId' s])
-&gt; Vector (VertexId' s)
-&gt; [(Point 2 r, VertexId' s)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (VertexId' s) -&gt; [VertexId' s]
forall a. Vector a -&gt; [a]
</span><span class="hs-identifier hs-var">V.toList</span></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">(Vector (VertexId' s) -&gt; CSeq (Point 2 r, VertexId' s))
-&gt; Vector (VertexId' s) -&gt; CSeq (Point 2 r, VertexId' s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FaceId' s
-&gt; PlanarSubdivision s v (Maybe e) f r -&gt; Vector (VertexId' s)
forall k (s :: k) v e f r.
FaceId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (VertexId' s)
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#boundaryVertices"><span class="hs-identifier hs-var">boundaryVertices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r -&gt; FaceId' s
forall k (s :: k) v e f r. PlanarSubdivision s v e f r -&gt; FaceId' s
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#outerFaceId"><span class="hs-identifier hs-var">outerFaceId</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r
</span><a href="#local-6989586621679988267"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r
</span><a href="#local-6989586621679988267"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679988262"><span class="annot"><span class="annottext">fromJust' :: Maybe a -&gt; a
</span><a href="#local-6989586621679988262"><span class="hs-identifier hs-var hs-var">fromJust'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a -&gt; a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Data.Geometry.Arrangement.link: fromJust&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621679988719"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#makePairs"><span class="hs-identifier hs-type">makePairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679988719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679988719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679988719"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-213"></span><span id="makePairs"><span class="annot"><span class="annottext">makePairs :: [a] -&gt; [(a, [a])]
</span><a href="Data.Geometry.Arrangement.Internal.html#makePairs"><span class="hs-identifier hs-var hs-var">makePairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [(a, [a])]
forall a. [a] -&gt; [(a, [a])]
</span><a href="#local-6989586621679988249"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679988249"><span class="annot"><span class="annottext">go :: [a] -&gt; [(a, [a])]
</span><a href="#local-6989586621679988249"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="#local-6989586621679988249"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988248"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679988248"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679988247"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679988247"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988248"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679988247"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, [a]) -&gt; [(a, [a])] -&gt; [(a, [a])]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((a, [a]) -&gt; (a, [a])) -&gt; [(a, [a])] -&gt; [(a, [a])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; (a, [a]) -&gt; (a, [a])
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988248"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [(a, [a])]
</span><a href="#local-6989586621679988249"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679988247"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span id="local-6989586621679988653"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#allPairs"><span class="hs-identifier hs-type">allPairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679988653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679988653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679988653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-219"></span><span id="allPairs"><span class="annot"><span class="annottext">allPairs :: [a] -&gt; [(a, a)]
</span><a href="Data.Geometry.Arrangement.Internal.html#allPairs"><span class="hs-identifier hs-var hs-var">allPairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [(a, a)]
forall a. [a] -&gt; [(a, a)]
</span><a href="#local-6989586621679988245"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679988245"><span class="annot"><span class="annottext">go :: [t] -&gt; [(t, t)]
</span><a href="#local-6989586621679988245"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="#local-6989586621679988245"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988244"><span class="annot"><span class="annottext">x :: t
</span><a href="#local-6989586621679988244"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679988243"><span class="annot"><span class="annottext">xs :: [t]
</span><a href="#local-6989586621679988243"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(t -&gt; (t, t)) -&gt; [t] -&gt; [(t, t)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679988244"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679988243"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[(t, t)] -&gt; [(t, t)] -&gt; [(t, t)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[t] -&gt; [(t, t)]
</span><a href="#local-6989586621679988245"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679988243"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Given a predicate that tests if two elements of a CSeq match, find a</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- rotation of the seqs such at they match.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- Running time: \(O(n)\)</span><span>
</span><span id="line-228"></span><span id="local-6989586621679988604"><span id="local-6989586621679988605"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#alignWith"><span class="hs-identifier hs-type">alignWith</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679988605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679988604"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSeq.CSeq</span></span><span> </span><span class="annot"><a href="#local-6989586621679988605"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSeq.CSeq</span></span><span> </span><span class="annot"><a href="#local-6989586621679988604"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-229"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CSeq.CSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679988605"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679988604"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-230"></span><span id="alignWith"><span class="annot"><span class="annottext">alignWith :: (a -&gt; b -&gt; Bool) -&gt; CSeq a -&gt; CSeq b -&gt; Maybe (CSeq (a, b))
</span><a href="Data.Geometry.Arrangement.Internal.html#alignWith"><span class="hs-identifier hs-var hs-var">alignWith</span></a></span></span><span> </span><span id="local-6989586621679988242"><span class="annot"><span class="annottext">p :: a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679988242"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679988241"><span class="annot"><span class="annottext">xs :: CSeq a
</span><a href="#local-6989586621679988241"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679988240"><span class="annot"><span class="annottext">ys :: CSeq b
</span><a href="#local-6989586621679988240"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSeq a -&gt; CSeq b -&gt; CSeq (a, b)
forall a b. CSeq a -&gt; CSeq b -&gt; CSeq (a, b)
</span><span class="hs-identifier hs-var">CSeq.zipL</span></span><span> </span><span class="annot"><span class="annottext">CSeq a
</span><a href="#local-6989586621679988241"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">(CSeq b -&gt; CSeq (a, b)) -&gt; Maybe (CSeq b) -&gt; Maybe (CSeq (a, b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Bool) -&gt; CSeq b -&gt; Maybe (CSeq b)
forall a. (a -&gt; Bool) -&gt; CSeq a -&gt; Maybe (CSeq a)
</span><span class="hs-identifier hs-var">CSeq.findRotateTo</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; Bool
</span><a href="#local-6989586621679988242"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSeq a -&gt; a
forall a. CSeq a -&gt; a
</span><span class="hs-identifier hs-var">CSeq.focus</span></span><span> </span><span class="annot"><span class="annottext">CSeq a
</span><a href="#local-6989586621679988241"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CSeq b
</span><a href="#local-6989586621679988240"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Given an Arrangement and a line in the arrangement, follow the line</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- through he arrangement.</span><span>
</span><span id="line-236"></span><span class="hs-comment">--</span><span>
</span><span id="line-237"></span><span id="local-6989586621679988231"><span id="local-6989586621679988232"><span id="local-6989586621679988233"><span id="local-6989586621679988234"><span id="local-6989586621679988235"><span id="local-6989586621679988236"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#traverseLine"><span class="hs-identifier hs-type">traverseLine</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988236"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988236"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988236"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988235"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988234"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988233"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679988232"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988231"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988236"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679988235"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span><span>
</span><span id="line-239"></span><span id="traverseLine"><span class="annot"><span class="annottext">traverseLine :: Line 2 r -&gt; Arrangement s l v (Maybe e) f r -&gt; [Dart s]
</span><a href="Data.Geometry.Arrangement.Internal.html#traverseLine"><span class="hs-identifier hs-var hs-var">traverseLine</span></a></span></span><span> </span><span id="local-6989586621679988229"><span class="annot"><span class="annottext">l :: Line 2 r
</span><a href="#local-6989586621679988229"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679988228"><span class="annot"><span class="annottext">arr :: Arrangement s l v (Maybe e) f r
</span><a href="#local-6989586621679988228"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679988227"><span class="annot"><span class="annottext">md :: Maybe (Dart s)
</span><a href="#local-6989586621679988227"><span class="hs-identifier hs-var hs-var">md</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Line 2 r -&gt; Arrangement s l v (Maybe e) f r -&gt; Maybe (Dart s)
forall k (s :: k) l v e f r.
(Ord r, Fractional r) =&gt;
Line 2 r -&gt; Arrangement s l v (Maybe e) f r -&gt; Maybe (Dart s)
</span><a href="Data.Geometry.Arrangement.Internal.html#findStart"><span class="hs-identifier hs-var">findStart</span></a></span><span> </span><span class="annot"><span class="annottext">Line 2 r
</span><a href="#local-6989586621679988229"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Arrangement s l v (Maybe e) f r
</span><a href="#local-6989586621679988228"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-240"></span><span>                         </span><span id="local-6989586621679988225"><span class="annot"><span class="annottext">dup :: b -&gt; (b, b)
</span><a href="#local-6989586621679988225"><span class="hs-identifier hs-var hs-var">dup</span></a></span></span><span> </span><span id="local-6989586621679988224"><span class="annot"><span class="annottext">x :: b
</span><a href="#local-6989586621679988224"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679988224"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679988224"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Dart s] -&gt; (Dart s -&gt; [Dart s]) -&gt; Maybe (Dart s) -&gt; [Dart s]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dart s -&gt; Maybe (Dart s, Dart s)) -&gt; Dart s -&gt; [Dart s]
forall b a. (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]
</span><span class="hs-identifier hs-var">List.unfoldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dart s -&gt; (Dart s, Dart s))
-&gt; Maybe (Dart s) -&gt; Maybe (Dart s, Dart s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; (Dart s, Dart s)
forall b. b -&gt; (b, b)
</span><a href="#local-6989586621679988225"><span class="hs-identifier hs-var">dup</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Dart s) -&gt; Maybe (Dart s, Dart s))
-&gt; (Dart s -&gt; Maybe (Dart s)) -&gt; Dart s -&gt; Maybe (Dart s, Dart s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Arrangement s l v (Maybe e) f r -&gt; Dart s -&gt; Maybe (Dart s)
forall k r (s :: k) l v e f.
(Ord r, Num r) =&gt;
Arrangement s l v e f r -&gt; Dart s -&gt; Maybe (Dart s)
</span><a href="Data.Geometry.Arrangement.Internal.html#follow"><span class="hs-identifier hs-var">follow</span></a></span><span> </span><span class="annot"><span class="annottext">Arrangement s l v (Maybe e) f r
</span><a href="#local-6989586621679988228"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Dart s)
</span><a href="#local-6989586621679988227"><span class="hs-identifier hs-var">md</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Find the starting point of the line  the arrangement</span><span>
</span><span id="line-244"></span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#findStart"><span class="hs-identifier hs-type">findStart</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679988553"><span class="annot"><a href="#local-6989586621679988553"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679988552"><span class="annot"><a href="#local-6989586621679988552"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679988551"><span class="annot"><a href="#local-6989586621679988551"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679988550"><span class="annot"><a href="#local-6989586621679988550"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679988549"><span class="annot"><a href="#local-6989586621679988549"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679988554"><span class="annot"><a href="#local-6989586621679988554"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988554"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988554"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988554"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988553"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988552"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988551"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679988550"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988549"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988554"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679988553"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span id="findStart"><span class="annot"><span class="annottext">findStart :: Line 2 r -&gt; Arrangement s l v (Maybe e) f r -&gt; Maybe (Dart s)
</span><a href="Data.Geometry.Arrangement.Internal.html#findStart"><span class="hs-identifier hs-var hs-var">findStart</span></a></span></span><span> </span><span id="local-6989586621679988221"><span class="annot"><span class="annottext">l :: Line 2 r
</span><a href="#local-6989586621679988221"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679988220"><span class="annot"><span class="annottext">arr :: Arrangement s l v (Maybe e) f r
</span><a href="#local-6989586621679988220"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679988219"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679988219"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (ts :: [*]).
NatToInt (RIndex (Point 2 r, Point 2 r) ts) =&gt;
CoRec Identity ts -&gt; Maybe (Point 2 r, Point 2 r)
forall t (ts :: [*]).
NatToInt (RIndex t ts) =&gt;
CoRec Identity ts -&gt; Maybe t
</span><span class="hs-identifier hs-var">asA</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988554"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988554"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoRec
   Identity
   '[NoIntersection, Point 2 r, (Point 2 r, Point 2 r),
     LineSegment 2 () r]
 -&gt; Maybe (Point 2 r, Point 2 r))
-&gt; CoRec
     Identity
     '[NoIntersection, Point 2 r, (Point 2 r, Point 2 r),
       LineSegment 2 () r]
-&gt; Maybe (Point 2 r, Point 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-248"></span><span>                 </span><span class="annot"><span class="annottext">Line 2 r
</span><a href="#local-6989586621679988221"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Line 2 r
-&gt; Boundary (Rectangle () r)
-&gt; Intersection (Line 2 r) (Boundary (Rectangle () r))
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; Boundary (Rectangle () r)
forall g. g -&gt; Boundary g
</span><a href="Data.Geometry.Boundary.html#Boundary"><span class="hs-identifier hs-var">Boundary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arrangement s l v (Maybe e) f r
</span><a href="#local-6989586621679988220"><span class="hs-identifier hs-var">arr</span></a></span><span class="annot"><span class="annottext">Arrangement s l v (Maybe e) f r
-&gt; Getting
     (Rectangle () r) (Arrangement s l v (Maybe e) f r) (Rectangle () r)
-&gt; Rectangle () r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Rectangle () r) (Arrangement s l v (Maybe e) f r) (Rectangle () r)
forall k (s :: k) l v e f r.
Lens' (Arrangement s l v e f r) (Rectangle () r)
</span><a href="Data.Geometry.Arrangement.Internal.html#boundedArea"><span class="hs-identifier hs-var">boundedArea</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span id="local-6989586621679988218"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679988218"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Point 2 r
-&gt; Arrangement s l v (Maybe e) f r
-&gt; Maybe (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
forall k r (s :: k) l v e f.
(Ord r, Fractional r) =&gt;
Point 2 r
-&gt; Arrangement s l v e f r
-&gt; Maybe (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
</span><a href="Data.Geometry.Arrangement.Internal.html#findStartVertex"><span class="hs-identifier hs-var">findStartVertex</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988219"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Arrangement s l v (Maybe e) f r
</span><a href="#local-6989586621679988220"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r
-&gt; VertexId' s -&gt; Maybe (Dart s)
forall k (s :: k) v e f r.
PlanarSubdivision s v (Maybe e) f r
-&gt; VertexId' s -&gt; Maybe (Dart s)
</span><a href="Data.Geometry.Arrangement.Internal.html#findStartDart"><span class="hs-identifier hs-var">findStartDart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arrangement s l v (Maybe e) f r
</span><a href="#local-6989586621679988220"><span class="hs-identifier hs-var">arr</span></a></span><span class="annot"><span class="annottext">Arrangement s l v (Maybe e) f r
-&gt; Getting
     (PlanarSubdivision s v (Maybe e) f r)
     (Arrangement s l v (Maybe e) f r)
     (PlanarSubdivision s v (Maybe e) f r)
-&gt; PlanarSubdivision s v (Maybe e) f r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (PlanarSubdivision s v (Maybe e) f r)
  (Arrangement s l v (Maybe e) f r)
  (PlanarSubdivision s v (Maybe e) f r)
forall k (s :: k) l v e f r v e f.
Lens
  (Arrangement s l v e f r)
  (Arrangement s l v e f r)
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
</span><a href="Data.Geometry.Arrangement.Internal.html#subdivision"><span class="hs-identifier hs-var">subdivision</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679988218"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Given a point on the boundary of the boundedArea box; find the vertex</span><span>
</span><span id="line-255"></span><span class="hs-comment">--  this point corresponds to.</span><span>
</span><span id="line-256"></span><span class="hs-comment">--</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- running time: \(O(\log n)\)</span><span>
</span><span id="line-258"></span><span class="hs-comment">--</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- basically; maps every point to a tuple of the point and the side the</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- point occurs on. We then binary search to find the point we are looking</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- for.</span><span>
</span><span id="line-262"></span><span id="local-6989586621679988521"><span id="local-6989586621679988522"><span id="local-6989586621679988523"><span id="local-6989586621679988524"><span id="local-6989586621679988525"><span id="local-6989586621679988526"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#findStartVertex"><span class="hs-identifier hs-type">findStartVertex</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988526"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679988526"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988526"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-264"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988525"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988524"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988523"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988522"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988521"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988526"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-265"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988526"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679988525"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Line.Internal.html#Line"><span class="hs-identifier hs-type">Line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679988526"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621679988524"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-266"></span><span id="findStartVertex"><span class="annot"><span class="annottext">findStartVertex :: Point 2 r
-&gt; Arrangement s l v e f r
-&gt; Maybe (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
</span><a href="Data.Geometry.Arrangement.Internal.html#findStartVertex"><span class="hs-identifier hs-var hs-var">findStartVertex</span></a></span></span><span> </span><span id="local-6989586621679988215"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621679988215"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679988214"><span class="annot"><span class="annottext">arr :: Arrangement s l v e f r
</span><a href="#local-6989586621679988214"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679988213"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679988213"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Maybe Integer
</span><a href="#local-6989586621679988212"><span class="hs-identifier hs-var">findSide</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988215"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679988211"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679988211"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)) -&gt; Bool)
-&gt; Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
-&gt; Maybe Int
forall (v :: * -&gt; *) a.
Vector v a =&gt;
(a -&gt; Bool) -&gt; v a -&gt; Maybe Int
</span><span class="hs-identifier hs-var">binarySearchVec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)) -&gt; Bool
</span><a href="#local-6989586621679988209"><span class="hs-identifier hs-var">pred'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679988213"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arrangement s l v e f r
</span><a href="#local-6989586621679988214"><span class="hs-identifier hs-var">arr</span></a></span><span class="annot"><span class="annottext">Arrangement s l v e f r
-&gt; Getting
     (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
     (Arrangement s l v e f r)
     (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
-&gt; Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
  (Arrangement s l v e f r)
  (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
forall k (s :: k) l v e f r.
Lens' (Arrangement s l v e f r) (ArrangementBoundary s l r)
</span><a href="Data.Geometry.Arrangement.Internal.html#unboundedIntersections"><span class="hs-identifier hs-var">unboundedIntersections</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><span class="annottext">(Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
-&gt; Maybe (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
 -&gt; Maybe (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
-&gt; (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
-&gt; Maybe (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arrangement s l v e f r
</span><a href="#local-6989586621679988214"><span class="hs-identifier hs-var">arr</span></a></span><span class="annot"><span class="annottext">Arrangement s l v e f r
-&gt; Getting
     (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
     (Arrangement s l v e f r)
     (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
-&gt; (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">(Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
 -&gt; Const
      (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
      (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))))
-&gt; Arrangement s l v e f r
-&gt; Const
     (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
     (Arrangement s l v e f r)
forall k (s :: k) l v e f r.
Lens' (Arrangement s l v e f r) (ArrangementBoundary s l r)
</span><a href="Data.Geometry.Arrangement.Internal.html#unboundedIntersections"><span class="hs-identifier hs-var">unboundedIntersections</span></a></span><span class="annot"><span class="annottext">((Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
  -&gt; Const
       (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
       (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))))
 -&gt; Arrangement s l v e f r
 -&gt; Const
      (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
      (Arrangement s l v e f r))
-&gt; (((Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
     -&gt; Const
          (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
          (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
    -&gt; Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
    -&gt; Const
         (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
         (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))))
-&gt; Getting
     (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
     (Arrangement s l v e f r)
     (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Traversing
  (-&gt;)
  (Const (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
  (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
  (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
  (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
  (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
-&gt; ((Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
    -&gt; Const
         (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
         (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
-&gt; Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
-&gt; Const
     (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))
     (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
forall (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s t a.
(HasCallStack, Conjoined p, Functor f) =&gt;
Traversing p f s t a a -&gt; Over p f s t a a
</span><span class="hs-identifier hs-var">singular</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
-&gt; Traversal'
     (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
     (IxValue (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l))))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Int
Index (Vector (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)))
</span><a href="#local-6989586621679988211"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><a href="Data.Geometry.Box.Sides.html#Sides"><span class="hs-identifier hs-type">Sides</span></a></span><span> </span><span id="local-6989586621679988206"><span class="annot"><span class="annottext">t :: LineSegment 2 () r
</span><a href="#local-6989586621679988206"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679988205"><span class="annot"><span class="annottext">r :: LineSegment 2 () r
</span><a href="#local-6989586621679988205"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679988204"><span class="annot"><span class="annottext">b :: LineSegment 2 () r
</span><a href="#local-6989586621679988204"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679988203"><span class="annot"><span class="annottext">l :: LineSegment 2 () r
</span><a href="#local-6989586621679988203"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; Sides (LineSegment 2 () r)
forall p. Rectangle p r -&gt; Sides (LineSegment 2 p r)
</span><a href="#local-6989586621679988202"><span class="hs-identifier hs-var">sides''</span></a></span><span> </span><span class="annot"><span class="annottext">(Rectangle () r -&gt; Sides (LineSegment 2 () r))
-&gt; Rectangle () r -&gt; Sides (LineSegment 2 () r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arrangement s l v e f r
</span><a href="#local-6989586621679988214"><span class="hs-identifier hs-var">arr</span></a></span><span class="annot"><span class="annottext">Arrangement s l v e f r
-&gt; Getting
     (Rectangle () r) (Arrangement s l v e f r) (Rectangle () r)
-&gt; Rectangle () r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Rectangle () r) (Arrangement s l v e f r) (Rectangle () r)
forall k (s :: k) l v e f r.
Lens' (Arrangement s l v e f r) (Rectangle () r)
</span><a href="Data.Geometry.Arrangement.Internal.html#boundedArea"><span class="hs-identifier hs-var">boundedArea</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679988202"><span class="annot"><span class="annottext">sides'' :: Rectangle p r -&gt; Sides (LineSegment 2 p r)
</span><a href="#local-6989586621679988202"><span class="hs-identifier hs-var hs-var">sides''</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 p r -&gt; LineSegment 2 p r)
-&gt; Sides (LineSegment 2 p r) -&gt; Sides (LineSegment 2 p r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.LineSegment.html#ClosedLineSegment"><span class="hs-identifier hs-type">ClosedLineSegment</span></a></span><span> </span><span id="local-6989586621679988201"><span class="annot"><span class="annottext">a :: Point 2 r :+ p
</span><a href="#local-6989586621679988201"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679988200"><span class="annot"><span class="annottext">c :: Point 2 r :+ p
</span><a href="#local-6989586621679988200"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EndPoint (Point 2 r :+ p)
-&gt; EndPoint (Point 2 r :+ p) -&gt; LineSegment 2 p r
forall (d :: Nat) r p.
EndPoint (Point d r :+ p)
-&gt; EndPoint (Point d r :+ p) -&gt; LineSegment d p r
</span><a href="Data.Geometry.LineSegment.html#LineSegment"><span class="hs-identifier hs-var">LineSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r :+ p) -&gt; EndPoint (Point 2 r :+ p)
forall a. a -&gt; EndPoint a
</span><span class="hs-identifier hs-var">Closed</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ p
</span><a href="#local-6989586621679988201"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r :+ p) -&gt; EndPoint (Point 2 r :+ p)
forall a. a -&gt; EndPoint a
</span><span class="hs-identifier hs-var">Open</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r :+ p
</span><a href="#local-6989586621679988200"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Sides (LineSegment 2 p r) -&gt; Sides (LineSegment 2 p r))
-&gt; (Rectangle p r -&gt; Sides (LineSegment 2 p r))
-&gt; Rectangle p r
-&gt; Sides (LineSegment 2 p r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rectangle p r -&gt; Sides (LineSegment 2 p r)
forall r p. Num r =&gt; Rectangle p r -&gt; Sides (LineSegment 2 p r)
</span><a href="Data.Geometry.Box.Sides.html#sides"><span class="hs-identifier hs-var">sides</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679988212"><span class="annot"><span class="annottext">findSide :: Point 2 r -&gt; Maybe Integer
</span><a href="#local-6989586621679988212"><span class="hs-identifier hs-var hs-var">findSide</span></a></span></span><span> </span><span id="local-6989586621679988196"><span class="annot"><span class="annottext">q :: Point 2 r
</span><a href="#local-6989586621679988196"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Integer, LineSegment 2 () r) -&gt; Integer)
-&gt; Maybe (Integer, LineSegment 2 () r) -&gt; Maybe Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Integer, LineSegment 2 () r) -&gt; Integer
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Integer, LineSegment 2 () r) -&gt; Maybe Integer)
-&gt; ([(Integer, LineSegment 2 () r)]
    -&gt; Maybe (Integer, LineSegment 2 () r))
-&gt; [(Integer, LineSegment 2 () r)]
-&gt; Maybe Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Integer, LineSegment 2 () r) -&gt; Bool)
-&gt; [(Integer, LineSegment 2 () r)]
-&gt; Maybe (Integer, LineSegment 2 () r)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">List.find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; LineSegment 2 () r -&gt; Bool
forall r (d :: Nat) p.
(Ord r, Fractional r, Arity d) =&gt;
Point d r -&gt; LineSegment d p r -&gt; Bool
</span><a href="Data.Geometry.LineSegment.html#onSegment"><span class="hs-identifier hs-var">onSegment</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988196"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">(LineSegment 2 () r -&gt; Bool)
-&gt; ((Integer, LineSegment 2 () r) -&gt; LineSegment 2 () r)
-&gt; (Integer, LineSegment 2 () r)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Integer, LineSegment 2 () r) -&gt; LineSegment 2 () r
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Integer, LineSegment 2 () r)] -&gt; Maybe Integer)
-&gt; [(Integer, LineSegment 2 () r)] -&gt; Maybe Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
-&gt; [LineSegment 2 () r] -&gt; [(Integer, LineSegment 2 () r)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LineSegment 2 () r
</span><a href="#local-6989586621679988206"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LineSegment 2 () r
</span><a href="#local-6989586621679988205"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LineSegment 2 () r
</span><a href="#local-6989586621679988204"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LineSegment 2 () r
</span><a href="#local-6989586621679988203"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679988209"><span class="annot"><span class="annottext">pred' :: Integer -&gt; (Point 2 r, VertexId' s, Maybe (Line 2 r :+ l)) -&gt; Bool
</span><a href="#local-6989586621679988209"><span class="hs-identifier hs-var hs-var">pred'</span></a></span></span><span> </span><span id="local-6989586621679988194"><span class="annot"><span class="annottext">ss :: Integer
</span><a href="#local-6989586621679988194"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988193"><span class="annot"><span class="annottext">q :: Point 2 r
</span><a href="#local-6989586621679988193"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679988192"><span class="annot"><span class="annottext">j :: Integer
</span><a href="#local-6989586621679988192"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Maybe Integer
</span><a href="#local-6989586621679988212"><span class="hs-identifier hs-var">findSide</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988193"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-277"></span><span>                           </span><span id="local-6989586621679988191"><span class="annot"><span class="annottext">x :: Ordering
</span><a href="#local-6989586621679988191"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Point 2 r) -&gt; (Integer, Point 2 r) -&gt; Ordering
forall a a. (Num a, Ord a, Ord a) =&gt; (a, a) -&gt; (a, a) -&gt; Ordering
</span><a href="#local-6989586621679988190"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679988194"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988215"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679988192"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988193"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>                       </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679988191"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679988191"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679988190"><span class="annot"><span class="annottext">before :: (a, a) -&gt; (a, a) -&gt; Ordering
</span><a href="#local-6989586621679988190"><span class="hs-identifier hs-var hs-var">before</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988188"><span class="annot"><span class="annottext">i :: a
</span><a href="#local-6989586621679988188"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679988187"><span class="annot"><span class="annottext">p' :: a
</span><a href="#local-6989586621679988187"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679988186"><span class="annot"><span class="annottext">j :: a
</span><a href="#local-6989586621679988186"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679988185"><span class="annot"><span class="annottext">q' :: a
</span><a href="#local-6989586621679988185"><span class="hs-identifier hs-var">q'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988188"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988186"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-281"></span><span>                                </span><span class="annot"><span class="hs-identifier hs-type">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-282"></span><span>                                </span><span class="annot"><span class="hs-identifier hs-type">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-283"></span><span>                                </span><span class="annot"><span class="hs-identifier hs-type">EQ</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988188"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988188"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Down a
forall a. a -&gt; Down a
</span><span class="hs-identifier hs-var">Down</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988187"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Down a -&gt; Down a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Down a
forall a. a -&gt; Down a
</span><span class="hs-identifier hs-var">Down</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988185"><span class="hs-identifier hs-var">q'</span></a></span><span>
</span><span id="line-284"></span><span>                                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988187"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679988185"><span class="hs-identifier hs-var">q'</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | Find the starting dart of the given vertex v. Reports a dart s.t.</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- tailOf d = v</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- running me: \(O(k)\) where \(k\) is the degree of the vertex</span><span>
</span><span id="line-291"></span><span id="local-6989586621679988515"><span id="local-6989586621679988516"><span id="local-6989586621679988517"><span id="local-6989586621679988518"><span id="local-6989586621679988519"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#findStartDart"><span class="hs-identifier hs-type">findStartDart</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.PlanarSubdivision.Basic.html#PlanarSubdivision"><span class="hs-identifier hs-type">PlanarSubdivision</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988519"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988518"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679988517"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679988516"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988515"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VertexId'</span></span><span> </span><span class="annot"><a href="#local-6989586621679988519"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679988519"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-292"></span><span id="findStartDart"><span class="annot"><span class="annottext">findStartDart :: PlanarSubdivision s v (Maybe e) f r
-&gt; VertexId' s -&gt; Maybe (Dart s)
</span><a href="Data.Geometry.Arrangement.Internal.html#findStartDart"><span class="hs-identifier hs-var hs-var">findStartDart</span></a></span></span><span> </span><span id="local-6989586621679988182"><span class="annot"><span class="annottext">ps :: PlanarSubdivision s v (Maybe e) f r
</span><a href="#local-6989586621679988182"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679988181"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679988181"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Bool) -&gt; Vector (Dart s) -&gt; Maybe (Dart s)
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Maybe a
</span><span class="hs-identifier hs-var">V.find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679988179"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679988179"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe e -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe e -&gt; Bool) -&gt; Maybe e -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r
</span><a href="#local-6989586621679988182"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r
-&gt; Getting
     (Maybe e) (PlanarSubdivision s v (Maybe e) f r) (Maybe e)
-&gt; Maybe e
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Dart s
-&gt; Lens'
     (PlanarSubdivision s v (Maybe e) f r)
     (DataOf (PlanarSubdivision s v (Maybe e) f r) (Dart s))
forall g i. HasDataOf g i =&gt; i -&gt; Lens' g (DataOf g i)
</span><span class="hs-identifier hs-var">dataOf</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679988179"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; Maybe (Dart s))
-&gt; Vector (Dart s) -&gt; Maybe (Dart s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s
-&gt; PlanarSubdivision s v (Maybe e) f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679988181"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v (Maybe e) f r
</span><a href="#local-6989586621679988182"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-comment">-- the &quot;real&quot; dart is the one that has ata associated to it.</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | Given a dart d that incoming to v (headOf d == v), find the outgoing dart</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- colinear with the incoming one. Again reports dart d' s.t. tailOf d' = v</span><span>
</span><span id="line-298"></span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- running time: \(O(k)\), where k is the degree of the vertex d points to</span><span>
</span><span id="line-300"></span><span id="local-6989586621679988536"><span id="local-6989586621679988537"><span id="local-6989586621679988538"><span id="local-6989586621679988539"><span id="local-6989586621679988540"><span id="local-6989586621679988541"><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#follow"><span class="hs-identifier hs-type">follow</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679988541"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679988541"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Arrangement.Internal.html#Arrangement"><span class="hs-identifier hs-type">Arrangement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988540"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988539"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988538"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988537"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988536"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679988541"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679988540"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dart</span></span><span> </span><span class="annot"><a href="#local-6989586621679988540"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-301"></span><span id="follow"><span class="annot"><span class="annottext">follow :: Arrangement s l v e f r -&gt; Dart s -&gt; Maybe (Dart s)
</span><a href="Data.Geometry.Arrangement.Internal.html#follow"><span class="hs-identifier hs-var hs-var">follow</span></a></span></span><span> </span><span id="local-6989586621679988175"><span class="annot"><span class="annottext">arr :: Arrangement s l v e f r
</span><a href="#local-6989586621679988175"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span id="local-6989586621679988174"><span class="annot"><span class="annottext">d :: Dart s
</span><a href="#local-6989586621679988174"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dart s -&gt; Bool) -&gt; Vector (Dart s) -&gt; Maybe (Dart s)
forall a. (a -&gt; Bool) -&gt; Vector a -&gt; Maybe a
</span><span class="hs-identifier hs-var">V.find</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Bool
</span><a href="#local-6989586621679988173"><span class="hs-identifier hs-var">extends</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Dart s) -&gt; Maybe (Dart s))
-&gt; Vector (Dart s) -&gt; Maybe (Dart s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
forall k (s :: k) v e f r.
VertexId' s -&gt; PlanarSubdivision s v e f r -&gt; Vector (Dart s)
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#incidentEdges"><span class="hs-identifier hs-var">incidentEdges</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId' s
</span><a href="#local-6989586621679988172"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679988171"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621679988171"><span class="annot"><span class="annottext">ps :: PlanarSubdivision s v e f r
</span><a href="#local-6989586621679988171"><span class="hs-identifier hs-var hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arrangement s l v e f r
</span><a href="#local-6989586621679988175"><span class="hs-identifier hs-var">arr</span></a></span><span class="annot"><span class="annottext">Arrangement s l v e f r
-&gt; Getting
     (PlanarSubdivision s v e f r)
     (Arrangement s l v e f r)
     (PlanarSubdivision s v e f r)
-&gt; PlanarSubdivision s v e f r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting
  (PlanarSubdivision s v e f r)
  (Arrangement s l v e f r)
  (PlanarSubdivision s v e f r)
forall k (s :: k) l v e f r v e f.
Lens
  (Arrangement s l v e f r)
  (Arrangement s l v e f r)
  (PlanarSubdivision s v e f r)
  (PlanarSubdivision s v e f r)
</span><a href="Data.Geometry.Arrangement.Internal.html#subdivision"><span class="hs-identifier hs-var">subdivision</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621679988172"><span class="annot"><span class="annottext">v :: VertexId' s
</span><a href="#local-6989586621679988172"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679988174"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679988171"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679988169"><span class="annot"><span class="annottext">up :: Point 2 r
</span><a href="#local-6989586621679988169"><span class="hs-identifier hs-var">up</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679988168"><span class="annot"><span class="annottext">vp :: Point 2 r
</span><a href="#local-6989586621679988168"><span class="hs-identifier hs-var">vp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter
  (VertexData r v, VertexData r v)
  (Point 2 r, Point 2 r)
  (VertexData r v)
  (Point 2 r)
-&gt; (VertexData r v -&gt; Point 2 r)
-&gt; (VertexData r v, VertexData r v)
-&gt; (Point 2 r, Point 2 r)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  (VertexData r v, VertexData r v)
  (Point 2 r, Point 2 r)
  (VertexData r v)
  (Point 2 r)
forall (r :: * -&gt; * -&gt; *) a b.
Bitraversable r =&gt;
Traversal (r a a) (r b b) a b
</span><span class="hs-identifier hs-var">both</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexData r v
-&gt; Getting (Point 2 r) (VertexData r v) (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting (Point 2 r) (VertexData r v) (Point 2 r)
forall r1 v r2.
Lens (VertexData r1 v) (VertexData r2 v) (Point 2 r1) (Point 2 r2)
</span><a href="Data.PlaneGraph.Core.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((VertexData r v, VertexData r v) -&gt; (Point 2 r, Point 2 r))
-&gt; (VertexData r v, VertexData r v) -&gt; (Point 2 r, Point 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dart s
-&gt; PlanarSubdivision s v e f r -&gt; (VertexData r v, VertexData r v)
forall k (s :: k) v e f r.
Dart s
-&gt; PlanarSubdivision s v e f r -&gt; (VertexData r v, VertexData r v)
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#endPointData"><span class="hs-identifier hs-var">endPointData</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679988174"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679988171"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679988173"><span class="annot"><span class="annottext">extends :: Dart s -&gt; Bool
</span><a href="#local-6989586621679988173"><span class="hs-identifier hs-var hs-var">extends</span></a></span></span><span> </span><span id="local-6989586621679988164"><span class="annot"><span class="annottext">d' :: Dart s
</span><a href="#local-6989586621679988164"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679988163"><span class="annot"><span class="annottext">wp :: Point 2 r
</span><a href="#local-6989586621679988163"><span class="hs-identifier hs-var hs-var">wp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679988171"><span class="hs-identifier hs-var">ps</span></a></span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
-&gt; Getting (Point 2 r) (PlanarSubdivision s v e f r) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (Point 2 r)
forall k (s :: k) v e f r.
VertexId' s -&gt; Lens' (PlanarSubdivision s v e f r) (Point 2 r)
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#locationOf"><span class="hs-identifier hs-var">locationOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
forall k (s :: k) v e f r.
Dart s -&gt; PlanarSubdivision s v e f r -&gt; VertexId' s
</span><a href="Data.Geometry.PlanarSubdivision.Basic.html#headOf"><span class="hs-identifier hs-var">headOf</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679988164"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">PlanarSubdivision s v e f r
</span><a href="#local-6989586621679988171"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679988164"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Dart s -&gt; Dart s
forall k (s :: k). Dart s -&gt; Dart s
</span><span class="hs-identifier hs-var">twin</span></span><span> </span><span class="annot"><span class="annottext">Dart s
</span><a href="#local-6989586621679988174"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
forall r.
(Ord r, Num r) =&gt;
Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
</span><a href="Data.Geometry.Point.Orientation.Degenerate.html#ccw"><span class="hs-identifier hs-var">ccw</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988169"><span class="hs-identifier hs-var">up</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988168"><span class="hs-identifier hs-var">vp</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679988163"><span class="hs-identifier hs-var">wp</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><a href="Data.Geometry.Point.Orientation.Degenerate.html#CoLinear"><span class="hs-identifier hs-var">CoLinear</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- TODO: we can skip the findStart by just traversing from all boundary points</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- computeFaceData :: (Arrangement s v e f r -&gt; Dart s -&gt; f')</span><span>
</span><span id="line-315"></span><span class="hs-comment">--                -&gt; Arrangement s v e f r -&gt; V.Vertex f'</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- computeFaceData arr f = fmap fromJust . V.create $ do</span><span>
</span><span id="line-317"></span><span class="hs-comment">--                           v &lt;- MV.replicate (arr^.subdivision.to numFaces) Nothing</span><span>
</span><span id="line-318"></span><span class="hs-comment">--                           mapM_ (computeFaceData' arr f v) $ arr^.inputLines</span><span>
</span><span id="line-319"></span><span class="hs-comment">--                           pure v</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- computeFaceData' arr f v l = mapM_ (assign ) traverseLine arr l</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-325"></span></pre></body></html>