<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_5u3SerC8ateG6GObai14QS"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  Data.Geometry.QuadTree</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-9"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Geometry.QuadTree</span><span class="hs-comment">-- ( module Data.Geometry.QuadTree.Cell</span><span>
</span><span id="line-11"></span><span>                             </span><span class="hs-comment">-- , module Data.Geometry.QuadTree.Quadrants</span><span>
</span><span id="line-12"></span><span>                             </span><span class="hs-comment">-- , module Data.Geometry.QuadTree.Split</span><span>
</span><span id="line-13"></span><span>                             </span><span class="hs-comment">-- , QuadTree(..)</span><span>
</span><span id="line-14"></span><span>                             </span><span class="hs-comment">-- , leaves</span><span>
</span><span id="line-15"></span><span>                             </span><span class="hs-comment">-- , withCells</span><span>
</span><span id="line-16"></span><span>                             </span><span class="hs-comment">-- )</span><span>
</span><span id="line-17"></span><span>                             </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^?!)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ix</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ext</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Box.html"><span class="hs-identifier">Data.Geometry.Box</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Point.html"><span class="hs-identifier">Data.Geometry.Point</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html"><span class="hs-identifier">Data.Geometry.QuadTree.Cell</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html"><span class="hs-identifier">Data.Geometry.QuadTree.Quadrants</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html"><span class="hs-identifier">Data.Geometry.QuadTree.Split</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html"><span class="hs-identifier">Data.Geometry.QuadTree.Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier">Tree</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html"><span class="hs-identifier">Data.Geometry.QuadTree.Tree</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tree</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Geometry.Vector.html"><span class="hs-identifier">Data.Geometry.Vector</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Intersection</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Tree.Util</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TreeNode</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">levels</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | QuadTree on the starting cell</span><span>
</span><span id="line-38"></span><span id="local-6989586621680025344"><span id="local-6989586621680025345"></span></span><span class="hs-keyword">data</span><span> </span><span id="QuadTree"><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-var">QuadTree</span></a></span></span><span> </span><span id="local-6989586621680025520"><span class="annot"><a href="#local-6989586621680025520"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621680025519"><span class="annot"><a href="#local-6989586621680025519"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621680025518"><span class="annot"><a href="#local-6989586621680025518"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="QuadTree"><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-var">QuadTree</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_startingCell"><span class="annot"><span class="annottext">QuadTree v p r -&gt; Cell r
</span><a href="Data.Geometry.QuadTree.html#_startingCell"><span class="hs-identifier hs-var hs-var">_startingCell</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025518"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="_tree"><span class="annot"><span class="annottext">QuadTree v p r -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.html#_tree"><span class="hs-identifier hs-var hs-var">_tree</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025520"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025519"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>                               </span><span class="hs-special">}</span><span>
</span><span id="line-41"></span><span>                    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680025335"><span id="local-6989586621680025337"><span id="local-6989586621680025339"><span class="annot"><span class="annottext">Int -&gt; QuadTree v p r -&gt; ShowS
[QuadTree v p r] -&gt; ShowS
QuadTree v p r -&gt; String
(Int -&gt; QuadTree v p r -&gt; ShowS)
-&gt; (QuadTree v p r -&gt; String)
-&gt; ([QuadTree v p r] -&gt; ShowS)
-&gt; Show (QuadTree v p r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall v p r.
(Show r, Show p, Show v) =&gt;
Int -&gt; QuadTree v p r -&gt; ShowS
forall v p r. (Show r, Show p, Show v) =&gt; [QuadTree v p r] -&gt; ShowS
forall v p r. (Show r, Show p, Show v) =&gt; QuadTree v p r -&gt; String
showList :: [QuadTree v p r] -&gt; ShowS
$cshowList :: forall v p r. (Show r, Show p, Show v) =&gt; [QuadTree v p r] -&gt; ShowS
show :: QuadTree v p r -&gt; String
$cshow :: forall v p r. (Show r, Show p, Show v) =&gt; QuadTree v p r -&gt; String
showsPrec :: Int -&gt; QuadTree v p r -&gt; ShowS
$cshowsPrec :: forall v p r.
(Show r, Show p, Show v) =&gt;
Int -&gt; QuadTree v p r -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680025330"><span id="local-6989586621680025332"><span class="annot"><span class="annottext">QuadTree v p r -&gt; QuadTree v p r -&gt; Bool
(QuadTree v p r -&gt; QuadTree v p r -&gt; Bool)
-&gt; (QuadTree v p r -&gt; QuadTree v p r -&gt; Bool)
-&gt; Eq (QuadTree v p r)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall v p r.
(Eq r, Eq p, Eq v) =&gt;
QuadTree v p r -&gt; QuadTree v p r -&gt; Bool
/= :: QuadTree v p r -&gt; QuadTree v p r -&gt; Bool
$c/= :: forall v p r.
(Eq r, Eq p, Eq v) =&gt;
QuadTree v p r -&gt; QuadTree v p r -&gt; Bool
== :: QuadTree v p r -&gt; QuadTree v p r -&gt; Bool
$c== :: forall v p r.
(Eq r, Eq p, Eq v) =&gt;
QuadTree v p r -&gt; QuadTree v p r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(forall x. QuadTree v p r -&gt; Rep (QuadTree v p r) x)
-&gt; (forall x. Rep (QuadTree v p r) x -&gt; QuadTree v p r)
-&gt; Generic (QuadTree v p r)
forall x. Rep (QuadTree v p r) x -&gt; QuadTree v p r
forall x. QuadTree v p r -&gt; Rep (QuadTree v p r) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall v p r x. Rep (QuadTree v p r) x -&gt; QuadTree v p r
forall v p r x. QuadTree v p r -&gt; Rep (QuadTree v p r) x
$cto :: forall v p r x. Rep (QuadTree v p r) x -&gt; QuadTree v p r
$cfrom :: forall v p r x. QuadTree v p r -&gt; Rep (QuadTree v p r) x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span id="local-6989586621680025322"><span id="local-6989586621680025324"><span class="annot"><span class="annottext">a -&gt; QuadTree v p b -&gt; QuadTree v p a
(a -&gt; b) -&gt; QuadTree v p a -&gt; QuadTree v p b
(forall a b. (a -&gt; b) -&gt; QuadTree v p a -&gt; QuadTree v p b)
-&gt; (forall a b. a -&gt; QuadTree v p b -&gt; QuadTree v p a)
-&gt; Functor (QuadTree v p)
forall a b. a -&gt; QuadTree v p b -&gt; QuadTree v p a
forall a b. (a -&gt; b) -&gt; QuadTree v p a -&gt; QuadTree v p b
forall v p a b. a -&gt; QuadTree v p b -&gt; QuadTree v p a
forall v p a b. (a -&gt; b) -&gt; QuadTree v p a -&gt; QuadTree v p b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; QuadTree v p b -&gt; QuadTree v p a
$c&lt;$ :: forall v p a b. a -&gt; QuadTree v p b -&gt; QuadTree v p a
fmap :: (a -&gt; b) -&gt; QuadTree v p a -&gt; QuadTree v p b
$cfmap :: forall v p a b. (a -&gt; b) -&gt; QuadTree v p a -&gt; QuadTree v p b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680025287"><span id="local-6989586621680025289"><span id="local-6989586621680025291"><span id="local-6989586621680025293"><span id="local-6989586621680025295"><span id="local-6989586621680025297"><span id="local-6989586621680025299"><span id="local-6989586621680025301"><span id="local-6989586621680025303"><span id="local-6989586621680025305"><span id="local-6989586621680025307"><span id="local-6989586621680025309"><span id="local-6989586621680025311"><span id="local-6989586621680025313"><span id="local-6989586621680025315"><span id="local-6989586621680025317"><span id="local-6989586621680025319"><span class="annot"><span class="annottext">QuadTree v p a -&gt; Bool
(a -&gt; m) -&gt; QuadTree v p a -&gt; m
(a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
(forall m. Monoid m =&gt; QuadTree v p m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadTree v p a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadTree v p a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; QuadTree v p a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; QuadTree v p a -&gt; a)
-&gt; (forall a. QuadTree v p a -&gt; [a])
-&gt; (forall a. QuadTree v p a -&gt; Bool)
-&gt; (forall a. QuadTree v p a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; QuadTree v p a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; QuadTree v p a -&gt; a)
-&gt; (forall a. Ord a =&gt; QuadTree v p a -&gt; a)
-&gt; (forall a. Num a =&gt; QuadTree v p a -&gt; a)
-&gt; (forall a. Num a =&gt; QuadTree v p a -&gt; a)
-&gt; Foldable (QuadTree v p)
forall a. Eq a =&gt; a -&gt; QuadTree v p a -&gt; Bool
forall a. Num a =&gt; QuadTree v p a -&gt; a
forall a. Ord a =&gt; QuadTree v p a -&gt; a
forall m. Monoid m =&gt; QuadTree v p m -&gt; m
forall a. QuadTree v p a -&gt; Bool
forall a. QuadTree v p a -&gt; Int
forall a. QuadTree v p a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; QuadTree v p a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadTree v p a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
forall v p a. Eq a =&gt; a -&gt; QuadTree v p a -&gt; Bool
forall v p a. Num a =&gt; QuadTree v p a -&gt; a
forall v p a. Ord a =&gt; QuadTree v p a -&gt; a
forall v p m. Monoid m =&gt; QuadTree v p m -&gt; m
forall v p a. QuadTree v p a -&gt; Bool
forall v p a. QuadTree v p a -&gt; Int
forall v p a. QuadTree v p a -&gt; [a]
forall v p a. (a -&gt; a -&gt; a) -&gt; QuadTree v p a -&gt; a
forall v p m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadTree v p a -&gt; m
forall v p b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
forall v p a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
product :: QuadTree v p a -&gt; a
$cproduct :: forall v p a. Num a =&gt; QuadTree v p a -&gt; a
sum :: QuadTree v p a -&gt; a
$csum :: forall v p a. Num a =&gt; QuadTree v p a -&gt; a
minimum :: QuadTree v p a -&gt; a
$cminimum :: forall v p a. Ord a =&gt; QuadTree v p a -&gt; a
maximum :: QuadTree v p a -&gt; a
$cmaximum :: forall v p a. Ord a =&gt; QuadTree v p a -&gt; a
elem :: a -&gt; QuadTree v p a -&gt; Bool
$celem :: forall v p a. Eq a =&gt; a -&gt; QuadTree v p a -&gt; Bool
length :: QuadTree v p a -&gt; Int
$clength :: forall v p a. QuadTree v p a -&gt; Int
null :: QuadTree v p a -&gt; Bool
$cnull :: forall v p a. QuadTree v p a -&gt; Bool
toList :: QuadTree v p a -&gt; [a]
$ctoList :: forall v p a. QuadTree v p a -&gt; [a]
foldl1 :: (a -&gt; a -&gt; a) -&gt; QuadTree v p a -&gt; a
$cfoldl1 :: forall v p a. (a -&gt; a -&gt; a) -&gt; QuadTree v p a -&gt; a
foldr1 :: (a -&gt; a -&gt; a) -&gt; QuadTree v p a -&gt; a
$cfoldr1 :: forall v p a. (a -&gt; a -&gt; a) -&gt; QuadTree v p a -&gt; a
foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
$cfoldl' :: forall v p b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
$cfoldl :: forall v p b a. (b -&gt; a -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
foldr' :: (a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
$cfoldr' :: forall v p a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
$cfoldr :: forall v p a b. (a -&gt; b -&gt; b) -&gt; b -&gt; QuadTree v p a -&gt; b
foldMap' :: (a -&gt; m) -&gt; QuadTree v p a -&gt; m
$cfoldMap' :: forall v p m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadTree v p a -&gt; m
foldMap :: (a -&gt; m) -&gt; QuadTree v p a -&gt; m
$cfoldMap :: forall v p m a. Monoid m =&gt; (a -&gt; m) -&gt; QuadTree v p a -&gt; m
fold :: QuadTree v p m -&gt; m
$cfold :: forall v p m. Monoid m =&gt; QuadTree v p m -&gt; m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680025276"><span id="local-6989586621680025278"><span id="local-6989586621680025280"><span id="local-6989586621680025282"><span class="annot"><span class="annottext">Functor (QuadTree v p)
Foldable (QuadTree v p)
(Functor (QuadTree v p), Foldable (QuadTree v p)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; QuadTree v p a -&gt; f (QuadTree v p b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    QuadTree v p (f a) -&gt; f (QuadTree v p a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; QuadTree v p a -&gt; m (QuadTree v p b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    QuadTree v p (m a) -&gt; m (QuadTree v p a))
-&gt; Traversable (QuadTree v p)
(a -&gt; f b) -&gt; QuadTree v p a -&gt; f (QuadTree v p b)
forall v p. Functor (QuadTree v p)
forall v p. Foldable (QuadTree v p)
forall v p (m :: * -&gt; *) a.
Monad m =&gt;
QuadTree v p (m a) -&gt; m (QuadTree v p a)
forall v p (f :: * -&gt; *) a.
Applicative f =&gt;
QuadTree v p (f a) -&gt; f (QuadTree v p a)
forall v p (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; QuadTree v p a -&gt; m (QuadTree v p b)
forall v p (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; QuadTree v p a -&gt; f (QuadTree v p b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
QuadTree v p (m a) -&gt; m (QuadTree v p a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
QuadTree v p (f a) -&gt; f (QuadTree v p a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; QuadTree v p a -&gt; m (QuadTree v p b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; QuadTree v p a -&gt; f (QuadTree v p b)
sequence :: QuadTree v p (m a) -&gt; m (QuadTree v p a)
$csequence :: forall v p (m :: * -&gt; *) a.
Monad m =&gt;
QuadTree v p (m a) -&gt; m (QuadTree v p a)
mapM :: (a -&gt; m b) -&gt; QuadTree v p a -&gt; m (QuadTree v p b)
$cmapM :: forall v p (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; QuadTree v p a -&gt; m (QuadTree v p b)
sequenceA :: QuadTree v p (f a) -&gt; f (QuadTree v p a)
$csequenceA :: forall v p (f :: * -&gt; *) a.
Applicative f =&gt;
QuadTree v p (f a) -&gt; f (QuadTree v p a)
traverse :: (a -&gt; f b) -&gt; QuadTree v p a -&gt; f (QuadTree v p b)
$ctraverse :: forall v p (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; QuadTree v p a -&gt; f (QuadTree v p b)
$cp2Traversable :: forall v p. Foldable (QuadTree v p)
$cp1Traversable :: forall v p. Functor (QuadTree v p)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span id="tree"><span id="startingCell"><span id="local-6989586621680025274"><span id="local-6989586621680025516"><span id="local-6989586621680025517"><span id="local-6989586621680025518"><span id="local-6989586621680025519"><span id="local-6989586621680025520"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">QuadTree</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- * Functions operating on the QuadTree (in terms of the 'Tree' type)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span id="local-6989586621680025269"><span id="local-6989586621680025270"><span id="local-6989586621680025271"><span class="annot"><a href="Data.Geometry.QuadTree.html#withCells"><span class="hs-identifier hs-type">withCells</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025271"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025271"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025270"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025269"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025271"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680025270"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025271"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680025269"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025271"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025271"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-48"></span><span id="withCells"><span class="annot"><span class="annottext">withCells :: QuadTree v p r -&gt; QuadTree (v :+ Cell r) (p :+ Cell r) r
</span><a href="Data.Geometry.QuadTree.html#withCells"><span class="hs-identifier hs-var hs-var">withCells</span></a></span></span><span> </span><span id="local-6989586621680025267"><span class="annot"><span class="annottext">qt :: QuadTree v p r
</span><a href="#local-6989586621680025267"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QuadTree v p r
</span><a href="#local-6989586621680025267"><span class="hs-identifier hs-var">qt</span></a></span><span class="annot"><span class="annottext">QuadTree v p r
-&gt; (QuadTree v p r -&gt; QuadTree (v :+ Cell r) (p :+ Cell r) r)
-&gt; QuadTree (v :+ Cell r) (p :+ Cell r) r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Tree v p -&gt; Identity (Tree (v :+ Cell r) (p :+ Cell r)))
-&gt; QuadTree v p r
-&gt; Identity (QuadTree (v :+ Cell r) (p :+ Cell r) r)
forall v p r v p.
Lens (QuadTree v p r) (QuadTree v p r) (Tree v p) (Tree v p)
</span><a href="Data.Geometry.QuadTree.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">((Tree v p -&gt; Identity (Tree (v :+ Cell r) (p :+ Cell r)))
 -&gt; QuadTree v p r
 -&gt; Identity (QuadTree (v :+ Cell r) (p :+ Cell r) r))
-&gt; Tree (v :+ Cell r) (p :+ Cell r)
-&gt; QuadTree v p r
-&gt; QuadTree (v :+ Cell r) (p :+ Cell r) r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">QuadTree v p r -&gt; Tree (v :+ Cell r) (p :+ Cell r)
forall r v p.
(Fractional r, Ord r) =&gt;
QuadTree v p r -&gt; Tree (v :+ Cell r) (p :+ Cell r)
</span><a href="Data.Geometry.QuadTree.html#withCellsTree"><span class="hs-identifier hs-var">withCellsTree</span></a></span><span> </span><span class="annot"><span class="annottext">QuadTree v p r
</span><a href="#local-6989586621680025267"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span id="local-6989586621680025507"><span id="local-6989586621680025508"><span id="local-6989586621680025509"><span class="annot"><a href="Data.Geometry.QuadTree.html#withCellsTree"><span class="hs-identifier hs-type">withCellsTree</span></a></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025509"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025509"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>                             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025508"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025507"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025509"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680025508"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025509"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680025507"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025509"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-52"></span><span id="withCellsTree"><span class="annot"><span class="annottext">withCellsTree :: QuadTree v p r -&gt; Tree (v :+ Cell r) (p :+ Cell r)
</span><a href="Data.Geometry.QuadTree.html#withCellsTree"><span class="hs-identifier hs-var hs-var">withCellsTree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span id="local-6989586621680025265"><span class="annot"><span class="annottext">c :: Cell r
</span><a href="#local-6989586621680025265"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680025264"><span class="annot"><span class="annottext">t :: Tree v p
</span><a href="#local-6989586621680025264"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; Tree v p -&gt; Tree (v :+ Cell r) (p :+ Cell r)
forall r v p.
Fractional r =&gt;
Cell r -&gt; Tree v p -&gt; Tree (v :+ Cell r) (p :+ Cell r)
</span><a href="Data.Geometry.QuadTree.Tree.html#withCells"><span class="hs-identifier hs-var">Tree.withCells</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025265"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Tree v p
</span><a href="#local-6989586621680025264"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621680025260"><span id="local-6989586621680025261"><span id="local-6989586621680025262"><span class="annot"><a href="Data.Geometry.QuadTree.html#leaves"><span class="hs-identifier hs-type">leaves</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025262"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025261"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025260"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621680025261"><span class="hs-identifier hs-type">p</span></a></span></span></span></span><span>
</span><span id="line-55"></span><span id="leaves"><span class="annot"><span class="annottext">leaves :: QuadTree v p r -&gt; NonEmpty p
</span><a href="Data.Geometry.QuadTree.html#leaves"><span class="hs-identifier hs-var hs-var">leaves</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tree v p -&gt; NonEmpty p
forall v p. Tree v p -&gt; NonEmpty p
</span><a href="Data.Geometry.QuadTree.Tree.html#leaves"><span class="hs-identifier hs-var">Tree.leaves</span></a></span><span> </span><span class="annot"><span class="annottext">(Tree v p -&gt; NonEmpty p)
-&gt; (QuadTree v p r -&gt; Tree v p) -&gt; QuadTree v p r -&gt; NonEmpty p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Tree v p) (QuadTree v p r) (Tree v p)
-&gt; QuadTree v p r -&gt; Tree v p
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Tree v p) (QuadTree v p r) (Tree v p)
forall v p r v p.
Lens (QuadTree v p r) (QuadTree v p r) (Tree v p) (Tree v p)
</span><a href="Data.Geometry.QuadTree.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span id="local-6989586621680025254"><span id="local-6989586621680025255"><span id="local-6989586621680025256"><span class="annot"><a href="Data.Geometry.QuadTree.html#perLevel"><span class="hs-identifier hs-type">perLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025256"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025255"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025254"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TreeNode</span></span><span> </span><span class="annot"><a href="#local-6989586621680025256"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025255"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-58"></span><span id="perLevel"><span class="annot"><span class="annottext">perLevel :: QuadTree v p r -&gt; NonEmpty (NonEmpty (TreeNode v p))
</span><a href="Data.Geometry.QuadTree.html#perLevel"><span class="hs-identifier hs-var hs-var">perLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tree (TreeNode v p) -&gt; NonEmpty (NonEmpty (TreeNode v p))
forall a. Tree a -&gt; NonEmpty (NonEmpty a)
</span><span class="hs-identifier hs-var">levels</span></span><span> </span><span class="annot"><span class="annottext">(Tree (TreeNode v p) -&gt; NonEmpty (NonEmpty (TreeNode v p)))
-&gt; (QuadTree v p r -&gt; Tree (TreeNode v p))
-&gt; QuadTree v p r
-&gt; NonEmpty (NonEmpty (TreeNode v p))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tree v p -&gt; Tree (TreeNode v p)
forall v p. Tree v p -&gt; Tree (TreeNode v p)
</span><a href="Data.Geometry.QuadTree.Tree.html#toRoseTree"><span class="hs-identifier hs-var">Tree.toRoseTree</span></a></span><span> </span><span class="annot"><span class="annottext">(Tree v p -&gt; Tree (TreeNode v p))
-&gt; (QuadTree v p r -&gt; Tree v p)
-&gt; QuadTree v p r
-&gt; Tree (TreeNode v p)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Tree v p) (QuadTree v p r) (Tree v p)
-&gt; QuadTree v p r -&gt; Tree v p
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Tree v p) (QuadTree v p r) (Tree v p)
forall v p r v p.
Lens (QuadTree v p r) (QuadTree v p r) (Tree v p) (Tree v p)
</span><a href="Data.Geometry.QuadTree.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Given a starting cell, a Tree builder, and some input required by</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- the builder, constructs a quadTree.</span><span>
</span><span id="line-65"></span><span id="local-6989586621680025466"><span id="local-6989586621680025467"><span id="local-6989586621680025468"><span id="local-6989586621680025469"><span class="annot"><a href="Data.Geometry.QuadTree.html#buildOn"><span class="hs-identifier hs-type">buildOn</span></a></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025469"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025469"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025468"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Tree"><span class="hs-identifier hs-type">Tree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025467"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025466"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025468"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025467"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025466"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025469"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-66"></span><span id="buildOn"><span class="annot"><span class="annottext">buildOn :: Cell r -&gt; (Cell r -&gt; i -&gt; Tree v p) -&gt; i -&gt; QuadTree v p r
</span><a href="Data.Geometry.QuadTree.html#buildOn"><span class="hs-identifier hs-var hs-var">buildOn</span></a></span></span><span> </span><span id="local-6989586621680025250"><span class="annot"><span class="annottext">c0 :: Cell r
</span><a href="#local-6989586621680025250"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span id="local-6989586621680025249"><span class="annot"><span class="annottext">builder :: Cell r -&gt; i -&gt; Tree v p
</span><a href="#local-6989586621680025249"><span class="hs-identifier hs-var">builder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; Tree v p -&gt; QuadTree v p r
forall v p r. Cell r -&gt; Tree v p -&gt; QuadTree v p r
</span><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-var">QuadTree</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025250"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="annot"><span class="annottext">(Tree v p -&gt; QuadTree v p r)
-&gt; (i -&gt; Tree v p) -&gt; i -&gt; QuadTree v p r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; i -&gt; Tree v p
</span><a href="#local-6989586621680025249"><span class="hs-identifier hs-var">builder</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025250"><span class="hs-identifier hs-var">c0</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | The Equivalent of Tree.build for constructing a QuadTree</span><span>
</span><span id="line-69"></span><span id="local-6989586621680025388"><span id="local-6989586621680025389"><span id="local-6989586621680025390"><span id="local-6989586621680025391"><span class="annot"><a href="Data.Geometry.QuadTree.html#build"><span class="hs-identifier hs-type">build</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025391"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025391"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025391"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025390"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025390"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025389"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025388"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025391"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025390"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025389"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025388"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025391"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-70"></span><span id="build"><span class="annot"><span class="annottext">build :: (Cell r -&gt; i -&gt; Split i v p) -&gt; Cell r -&gt; i -&gt; QuadTree v p r
</span><a href="Data.Geometry.QuadTree.html#build"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621680025247"><span class="annot"><span class="annottext">f :: Cell r -&gt; i -&gt; Split i v p
</span><a href="#local-6989586621680025247"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680025246"><span class="annot"><span class="annottext">c :: Cell r
</span><a href="#local-6989586621680025246"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; (Cell r -&gt; i -&gt; Tree v p) -&gt; i -&gt; QuadTree v p r
forall r i v p.
Cell r -&gt; (Cell r -&gt; i -&gt; Tree v p) -&gt; i -&gt; QuadTree v p r
</span><a href="Data.Geometry.QuadTree.html#buildOn"><span class="hs-identifier hs-var">buildOn</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025246"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Cell r -&gt; i -&gt; Split i v p) -&gt; Cell r -&gt; i -&gt; Tree v p
forall r pts v p.
Fractional r =&gt;
Splitter r pts v p -&gt; Cell r -&gt; pts -&gt; Tree v p
</span><a href="Data.Geometry.QuadTree.Tree.html#build"><span class="hs-identifier hs-var">Tree.build</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; i -&gt; Split i v p
</span><a href="#local-6989586621680025247"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Build a QuadtTree from a set of points.</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- pre: the points lie inside the initial given cell.</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- running time: \(O(nh)\), where \(n\) is the number of points and</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- \(h\) is the height of the resulting quadTree.</span><span>
</span><span id="line-78"></span><span id="local-6989586621680025243"><span id="local-6989586621680025244"><span class="annot"><a href="Data.Geometry.QuadTree.html#fromPointsBox"><span class="hs-identifier hs-type">fromPointsBox</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025244"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025244"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025244"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025244"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680025243"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025244"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680025243"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025244"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-80"></span><span id="fromPointsBox"><span class="annot"><span class="annottext">fromPointsBox :: Cell r
-&gt; [Point 2 r :+ p] -&gt; QuadTree () (Maybe (Point 2 r :+ p)) r
</span><a href="Data.Geometry.QuadTree.html#fromPointsBox"><span class="hs-identifier hs-var hs-var">fromPointsBox</span></a></span></span><span> </span><span id="local-6989586621680025241"><span class="annot"><span class="annottext">c :: Cell r
</span><a href="#local-6989586621680025241"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cell r
-&gt; (Cell r -&gt; [Point 2 r :+ p] -&gt; Tree () (Maybe (Point 2 r :+ p)))
-&gt; [Point 2 r :+ p]
-&gt; QuadTree () (Maybe (Point 2 r :+ p)) r
forall r i v p.
Cell r -&gt; (Cell r -&gt; i -&gt; Tree v p) -&gt; i -&gt; QuadTree v p r
</span><a href="Data.Geometry.QuadTree.html#buildOn"><span class="hs-identifier hs-var">buildOn</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025241"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; [Point 2 r :+ p] -&gt; Tree () (Maybe (Point 2 r :+ p))
forall r p.
(Fractional r, Ord r) =&gt;
Cell r -&gt; [Point 2 r :+ p] -&gt; Tree () (Maybe (Point 2 r :+ p))
</span><a href="Data.Geometry.QuadTree.Tree.html#fromPoints"><span class="hs-identifier hs-var">Tree.fromPoints</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span id="local-6989586621680025238"><span id="local-6989586621680025239"><span class="annot"><a href="Data.Geometry.QuadTree.html#fromPoints"><span class="hs-identifier hs-type">fromPoints</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621680025239"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025239"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025239"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680025238"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025239"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="#local-6989586621680025238"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025239"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-84"></span><span id="fromPoints"><span class="annot"><span class="annottext">fromPoints :: NonEmpty (Point 2 r :+ p) -&gt; QuadTree () (Maybe (Point 2 r :+ p)) r
</span><a href="Data.Geometry.QuadTree.html#fromPoints"><span class="hs-identifier hs-var hs-var">fromPoints</span></a></span></span><span> </span><span id="local-6989586621680025236"><span class="annot"><span class="annottext">pts :: NonEmpty (Point 2 r :+ p)
</span><a href="#local-6989586621680025236"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cell r
-&gt; (Cell r -&gt; [Point 2 r :+ p] -&gt; Tree () (Maybe (Point 2 r :+ p)))
-&gt; [Point 2 r :+ p]
-&gt; QuadTree () (Maybe (Point 2 r :+ p)) r
forall r i v p.
Cell r -&gt; (Cell r -&gt; i -&gt; Tree v p) -&gt; i -&gt; QuadTree v p r
</span><a href="Data.Geometry.QuadTree.html#buildOn"><span class="hs-identifier hs-var">buildOn</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025235"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; [Point 2 r :+ p] -&gt; Tree () (Maybe (Point 2 r :+ p))
forall r p.
(Fractional r, Ord r) =&gt;
Cell r -&gt; [Point 2 r :+ p] -&gt; Tree () (Maybe (Point 2 r :+ p))
</span><a href="Data.Geometry.QuadTree.Tree.html#fromPoints"><span class="hs-identifier hs-var">Tree.fromPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty (Point 2 r :+ p) -&gt; [Point 2 r :+ p]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Point 2 r :+ p)
</span><a href="#local-6989586621680025236"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621680025235"><span class="annot"><span class="annottext">c :: Cell r
</span><a href="#local-6989586621680025235"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle () r -&gt; Cell r
forall r p. (RealFrac r, Ord r) =&gt; Rectangle p r -&gt; Cell r
</span><a href="Data.Geometry.QuadTree.Cell.html#fitsRectangle"><span class="hs-identifier hs-var">fitsRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">(Rectangle () r -&gt; Cell r) -&gt; Rectangle () r -&gt; Cell r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Point 2 r)
-&gt; Box (Dimension (Point 2 r)) () (NumType (Point 2 r))
forall g (c :: * -&gt; *).
(IsBoxable g, Foldable1 c, Ord (NumType g), Arity (Dimension g)) =&gt;
c g -&gt; Box (Dimension g) () (NumType g)
</span><a href="Data.Geometry.Box.Internal.html#boundingBoxList"><span class="hs-identifier hs-var">boundingBoxList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (Point 2 r) (Point 2 r :+ p) (Point 2 r)
-&gt; (Point 2 r :+ p) -&gt; Point 2 r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) (Point 2 r :+ p) (Point 2 r)
forall core extra core'.
Lens (core :+ extra) (core' :+ extra) core core'
</span><span class="hs-identifier hs-var">core</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r :+ p) -&gt; Point 2 r)
-&gt; NonEmpty (Point 2 r :+ p) -&gt; NonEmpty (Point 2 r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Point 2 r :+ p)
</span><a href="#local-6989586621680025236"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">{- HLINT ignore findLeaf -}</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Locates the cell containing the given point, if it exists.</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- running time: \(O(h)\), where \(h\) is the height of the quadTree</span><span>
</span><span id="line-92"></span><span id="local-6989586621680025227"><span id="local-6989586621680025228"><span id="local-6989586621680025229"><span class="annot"><a href="Data.Geometry.QuadTree.html#findLeaf"><span class="hs-identifier hs-type">findLeaf</span></a></span><span>                                       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025229"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025229"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                                               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025229"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025228"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025227"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025229"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680025227"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025229"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-94"></span><span id="findLeaf"><span class="annot"><span class="annottext">findLeaf :: Point 2 r -&gt; QuadTree v p r -&gt; Maybe (p :+ Cell r)
</span><a href="Data.Geometry.QuadTree.html#findLeaf"><span class="hs-identifier hs-var hs-var">findLeaf</span></a></span></span><span> </span><span id="local-6989586621680025225"><span class="annot"><span class="annottext">q :: Point 2 r
</span><a href="#local-6989586621680025225"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span id="local-6989586621680025224"><span class="annot"><span class="annottext">c0 :: Cell r
</span><a href="#local-6989586621680025224"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span id="local-6989586621680025223"><span class="annot"><span class="annottext">t :: Tree v p
</span><a href="#local-6989586621680025223"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680025225"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Cell r -&gt; Bool
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025224"><span class="hs-identifier hs-var">c0</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(p :+ Cell r) -&gt; Maybe (p :+ Cell r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((p :+ Cell r) -&gt; Maybe (p :+ Cell r))
-&gt; (p :+ Cell r) -&gt; Maybe (p :+ Cell r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; Tree v p -&gt; p :+ Cell r
</span><a href="#local-6989586621680025221"><span class="hs-identifier hs-var">findLeaf'</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025224"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="annot"><span class="annottext">Tree v p
</span><a href="#local-6989586621680025223"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-95"></span><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (p :+ Cell r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- |</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- pre: p intersects c</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621680025221"><span class="annot"><span class="annottext">findLeaf' :: Cell r -&gt; Tree v p -&gt; p :+ Cell r
</span><a href="#local-6989586621680025221"><span class="hs-identifier hs-var hs-var">findLeaf'</span></a></span></span><span> </span><span id="local-6989586621680025220"><span class="annot"><span class="annottext">c :: Cell r
</span><a href="#local-6989586621680025220"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621680025218"><span class="annot"><span class="annottext">p :: p
</span><a href="#local-6989586621680025218"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621680025218"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; Cell r -&gt; p :+ Cell r
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><span class="hs-operator hs-var">:+</span></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025220"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><a href="Data.Geometry.QuadTree.Tree.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621680025215"><span class="annot"><span class="annottext">qs :: Quadrants (Tree v p)
</span><a href="#local-6989586621680025215"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680025214"><span class="annot"><span class="annottext">quad :: InterCardinalDirection
</span><a href="#local-6989586621680025214"><span class="hs-identifier hs-var hs-var">quad</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Cell r -&gt; InterCardinalDirection
forall r.
(Fractional r, Ord r) =&gt;
Point 2 r -&gt; Cell r -&gt; InterCardinalDirection
</span><a href="Data.Geometry.QuadTree.Cell.html#quadrantOf"><span class="hs-identifier hs-var">quadrantOf</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680025225"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025220"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-102"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; Tree v p -&gt; p :+ Cell r
</span><a href="#local-6989586621680025221"><span class="hs-identifier hs-var">findLeaf'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cell r -&gt; Quadrants (Cell r)
forall r. (Num r, Fractional r) =&gt; Cell r -&gt; Quadrants (Cell r)
</span><a href="Data.Geometry.QuadTree.Cell.html#splitCell"><span class="hs-identifier hs-var">splitCell</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025220"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Quadrants (Cell r)
-&gt; Getting (Endo (Cell r)) (Quadrants (Cell r)) (Cell r) -&gt; Cell r
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">Index (Quadrants (Cell r))
-&gt; Traversal' (Quadrants (Cell r)) (IxValue (Quadrants (Cell r)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index (Quadrants (Cell r))
InterCardinalDirection
</span><a href="#local-6989586621680025214"><span class="hs-identifier hs-var">quad</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quadrants (Tree v p)
</span><a href="#local-6989586621680025215"><span class="hs-identifier hs-var">qs</span></a></span><span class="annot"><span class="annottext">Quadrants (Tree v p)
-&gt; Getting (Endo (Tree v p)) (Quadrants (Tree v p)) (Tree v p)
-&gt; Tree v p
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span class="annot"><span class="annottext">Index (Quadrants (Tree v p))
-&gt; Traversal'
     (Quadrants (Tree v p)) (IxValue (Quadrants (Tree v p)))
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index (Quadrants (Tree v p))
InterCardinalDirection
</span><a href="#local-6989586621680025214"><span class="hs-identifier hs-var">quad</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621680025209"><span id="local-6989586621680025210"><span id="local-6989586621680025211"><span class="annot"><a href="Data.Geometry.QuadTree.html#fromZeros"><span class="hs-identifier hs-type">fromZeros</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025211"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025211"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680025210"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680025210"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680025209"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-type">Quadrants</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025211"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025211"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025210"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025209"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621680025209"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025211"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-109"></span><span id="fromZeros"><span class="annot"><span class="annottext">fromZeros :: Cell r -&gt; (Point 2 r -&gt; a) -&gt; QuadTree v (Either v Sign) r
</span><a href="Data.Geometry.QuadTree.html#fromZeros"><span class="hs-identifier hs-var hs-var">fromZeros</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Limiter r (Corners Sign) (Corners Sign) Sign
-&gt; Cell r
-&gt; (Point 2 r -&gt; a)
-&gt; QuadTree (Corners Sign) (Signs Sign) r
forall r a.
(Fractional r, Ord r, Eq a, Num a) =&gt;
Limiter r (Corners Sign) (Corners Sign) Sign
-&gt; Cell r
-&gt; (Point 2 r -&gt; a)
-&gt; QuadTree (Corners Sign) (Signs Sign) r
</span><a href="Data.Geometry.QuadTree.html#fromZerosWith"><span class="hs-identifier hs-var">fromZerosWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Limiter r (Corners Sign) (Corners Sign) Sign
forall r i v p. Int -&gt; Limiter r i v p
</span><a href="Data.Geometry.QuadTree.Split.html#limitWidthTo"><span class="hs-identifier hs-var">limitWidthTo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621680025404"><span id="local-6989586621680025405"><span class="annot"><a href="Data.Geometry.QuadTree.html#fromZerosWith"><span class="hs-identifier hs-type">fromZerosWith</span></a></span><span>            </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025405"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025405"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680025404"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680025404"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>                         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html#Limiter"><span class="hs-identifier hs-type">Limiter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025405"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Box.Corners.html#Corners"><span class="hs-identifier hs-type">Corners</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Box.Corners.html#Corners"><span class="hs-identifier hs-type">Corners</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span><span>
</span><span id="line-114"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025405"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-115"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025405"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025404"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-type">Quadrants</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.html#Signs"><span class="hs-identifier hs-type">Signs</span></a></span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025405"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-117"></span><span id="fromZerosWith"><span class="annot"><span class="annottext">fromZerosWith :: Limiter r (Corners Sign) (Corners Sign) Sign
-&gt; Cell r
-&gt; (Point 2 r -&gt; a)
-&gt; QuadTree (Corners Sign) (Signs Sign) r
</span><a href="Data.Geometry.QuadTree.html#fromZerosWith"><span class="hs-identifier hs-var hs-var">fromZerosWith</span></a></span></span><span> </span><span id="local-6989586621680025205"><span class="annot"><span class="annottext">limit :: Limiter r (Corners Sign) (Corners Sign) Sign
</span><a href="#local-6989586621680025205"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621680025204"><span class="annot"><span class="annottext">c0 :: Cell r
</span><a href="#local-6989586621680025204"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span id="local-6989586621680025203"><span class="annot"><span class="annottext">f :: Point 2 r -&gt; a
</span><a href="#local-6989586621680025203"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Limiter r (Corners Sign) (Corners Sign) Sign
-&gt; Cell r
-&gt; (Point 2 r -&gt; Sign)
-&gt; QuadTree (Corners Sign) (Signs Sign) r
forall sign r.
(Eq sign, Fractional r, Ord r) =&gt;
Limiter r (Corners sign) (Corners sign) sign
-&gt; Cell r
-&gt; (Point 2 r -&gt; sign)
-&gt; QuadTree (Corners sign) (Signs sign) r
</span><a href="Data.Geometry.QuadTree.html#fromZerosWith%27"><span class="hs-identifier hs-var">fromZerosWith'</span></a></span><span> </span><span class="annot"><span class="annottext">Limiter r (Corners Sign) (Corners Sign) Sign
</span><a href="#local-6989586621680025205"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025204"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; a) -&gt; Point 2 r -&gt; Sign
forall a b. (Num a, Eq a) =&gt; (b -&gt; a) -&gt; b -&gt; Sign
</span><a href="Data.Geometry.QuadTree.html#fromSignum"><span class="hs-identifier hs-var">fromSignum</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; a
</span><a href="#local-6989586621680025203"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">type</span><span> </span><span id="Signs"><span class="annot"><a href="Data.Geometry.QuadTree.html#Signs"><span class="hs-identifier hs-var">Signs</span></a></span></span><span> </span><span id="local-6989586621680025200"><span class="annot"><a href="#local-6989586621680025200"><span class="hs-identifier hs-type">sign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Box.Corners.html#Corners"><span class="hs-identifier hs-type">Corners</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025200"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025200"><span class="hs-identifier hs-type">sign</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621680025396"><span id="local-6989586621680025397"><span class="annot"><a href="Data.Geometry.QuadTree.html#fromZerosWith%27"><span class="hs-identifier hs-type">fromZerosWith'</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680025397"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025396"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025396"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html#Limiter"><span class="hs-identifier hs-type">Limiter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025396"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Box.Corners.html#Corners"><span class="hs-identifier hs-type">Corners</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025397"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Box.Corners.html#Corners"><span class="hs-identifier hs-type">Corners</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025397"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025397"><span class="hs-identifier hs-type">sign</span></a></span><span>
</span><span id="line-125"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025396"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-126"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025396"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025397"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-type">Quadrants</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025397"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.html#Signs"><span class="hs-identifier hs-type">Signs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025397"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025396"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-128"></span><span id="fromZerosWith%27"><span class="annot"><span class="annottext">fromZerosWith' :: Limiter r (Corners sign) (Corners sign) sign
-&gt; Cell r
-&gt; (Point 2 r -&gt; sign)
-&gt; QuadTree (Corners sign) (Signs sign) r
</span><a href="Data.Geometry.QuadTree.html#fromZerosWith%27"><span class="hs-identifier hs-var hs-var">fromZerosWith'</span></a></span></span><span> </span><span id="local-6989586621680025199"><span class="annot"><span class="annottext">limit :: Limiter r (Corners sign) (Corners sign) sign
</span><a href="#local-6989586621680025199"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621680025198"><span class="annot"><span class="annottext">c0 :: Cell r
</span><a href="#local-6989586621680025198"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span id="local-6989586621680025197"><span class="annot"><span class="annottext">f :: Point 2 r -&gt; sign
</span><a href="#local-6989586621680025197"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Cell r
 -&gt; Corners sign
 -&gt; Split (Corners sign) (Corners sign) (Signs sign))
-&gt; Cell r -&gt; Corners sign -&gt; QuadTree (Corners sign) (Signs sign) r
forall r i v p.
(Fractional r, Ord r) =&gt;
(Cell r -&gt; i -&gt; Split i v p) -&gt; Cell r -&gt; i -&gt; QuadTree v p r
</span><a href="Data.Geometry.QuadTree.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Limiter r (Corners sign) (Corners sign) sign
</span><a href="#local-6989586621680025199"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">Limiter r (Corners sign) (Corners sign) sign
-&gt; Limiter r (Corners sign) (Corners sign) sign
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; sign)
-&gt; Splitter r (Corners sign) (Corners sign) sign
forall r sign.
(Fractional r, Eq sign) =&gt;
(Point 2 r -&gt; sign)
-&gt; Splitter r (Quadrants sign) (Quadrants sign) sign
</span><a href="Data.Geometry.QuadTree.html#shouldSplitZeros"><span class="hs-identifier hs-var">shouldSplitZeros</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; sign
</span><a href="#local-6989586621680025197"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025198"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; sign
</span><a href="#local-6989586621680025197"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; sign) -&gt; Corners (Point 2 r) -&gt; Corners sign
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cell r -&gt; Corners (Point 2 r)
forall r. Fractional r =&gt; Cell r -&gt; Quadrants (Point 2 r)
</span><a href="Data.Geometry.QuadTree.Cell.html#cellCorners"><span class="hs-identifier hs-var">cellCorners</span></a></span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025198"><span class="hs-identifier hs-var">c0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- type Sign = Ordering</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- pattern Negative :: Sign</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- pattern Negative = LT</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- pattern Zero :: Sign</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- pattern Zero     = EQ</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- pattern Positive :: Sign</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- pattern Positive = GT</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- {-# COMPLETE Negative, Zero, Positive #-}</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- fromOrdering :: Ordering -&gt; Sign</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- fromOrdering = id</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">data</span><span> </span><span id="Sign"><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-var">Sign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Negative"><span class="annot"><a href="Data.Geometry.QuadTree.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Zero"><span class="annot"><a href="Data.Geometry.QuadTree.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Positive"><span class="annot"><a href="Data.Geometry.QuadTree.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680025186"><span id="local-6989586621680025188"><span id="local-6989586621680025190"><span class="annot"><span class="annottext">Int -&gt; Sign -&gt; ShowS
[Sign] -&gt; ShowS
Sign -&gt; String
(Int -&gt; Sign -&gt; ShowS)
-&gt; (Sign -&gt; String) -&gt; ([Sign] -&gt; ShowS) -&gt; Show Sign
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Sign] -&gt; ShowS
$cshowList :: [Sign] -&gt; ShowS
show :: Sign -&gt; String
$cshow :: Sign -&gt; String
showsPrec :: Int -&gt; Sign -&gt; ShowS
$cshowsPrec :: Int -&gt; Sign -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680025182"><span id="local-6989586621680025184"><span class="annot"><span class="annottext">Sign -&gt; Sign -&gt; Bool
(Sign -&gt; Sign -&gt; Bool) -&gt; (Sign -&gt; Sign -&gt; Bool) -&gt; Eq Sign
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Sign -&gt; Sign -&gt; Bool
$c/= :: Sign -&gt; Sign -&gt; Bool
== :: Sign -&gt; Sign -&gt; Bool
$c== :: Sign -&gt; Sign -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621680025167"><span id="local-6989586621680025169"><span id="local-6989586621680025171"><span id="local-6989586621680025173"><span id="local-6989586621680025175"><span id="local-6989586621680025177"><span id="local-6989586621680025179"><span class="annot"><span class="annottext">Eq Sign
Eq Sign =&gt;
(Sign -&gt; Sign -&gt; Ordering)
-&gt; (Sign -&gt; Sign -&gt; Bool)
-&gt; (Sign -&gt; Sign -&gt; Bool)
-&gt; (Sign -&gt; Sign -&gt; Bool)
-&gt; (Sign -&gt; Sign -&gt; Bool)
-&gt; (Sign -&gt; Sign -&gt; Sign)
-&gt; (Sign -&gt; Sign -&gt; Sign)
-&gt; Ord Sign
Sign -&gt; Sign -&gt; Bool
Sign -&gt; Sign -&gt; Ordering
Sign -&gt; Sign -&gt; Sign
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Sign -&gt; Sign -&gt; Sign
$cmin :: Sign -&gt; Sign -&gt; Sign
max :: Sign -&gt; Sign -&gt; Sign
$cmax :: Sign -&gt; Sign -&gt; Sign
&gt;= :: Sign -&gt; Sign -&gt; Bool
$c&gt;= :: Sign -&gt; Sign -&gt; Bool
&gt; :: Sign -&gt; Sign -&gt; Bool
$c&gt; :: Sign -&gt; Sign -&gt; Bool
&lt;= :: Sign -&gt; Sign -&gt; Bool
$c&lt;= :: Sign -&gt; Sign -&gt; Bool
&lt; :: Sign -&gt; Sign -&gt; Bool
$c&lt; :: Sign -&gt; Sign -&gt; Bool
compare :: Sign -&gt; Sign -&gt; Ordering
$ccompare :: Sign -&gt; Sign -&gt; Ordering
$cp1Ord :: Eq Sign
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Interpret an ordering result as a Sign</span><span>
</span><span id="line-151"></span><span class="annot"><a href="Data.Geometry.QuadTree.html#fromOrdering"><span class="hs-identifier hs-type">fromOrdering</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span><span>
</span><span id="line-152"></span><span id="fromOrdering"><span class="annot"><span class="annottext">fromOrdering :: Ordering -&gt; Sign
</span><a href="Data.Geometry.QuadTree.html#fromOrdering"><span class="hs-identifier hs-var hs-var">fromOrdering</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="Data.Geometry.QuadTree.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="Data.Geometry.QuadTree.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="Data.Geometry.QuadTree.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span id="local-6989586621680025394"><span id="local-6989586621680025395"><span class="annot"><a href="Data.Geometry.QuadTree.html#fromSignum"><span class="hs-identifier hs-type">fromSignum</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621680025395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680025395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680025394"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025395"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025394"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#Sign"><span class="hs-identifier hs-type">Sign</span></a></span></span></span><span>
</span><span id="line-158"></span><span id="fromSignum"><span class="annot"><span class="annottext">fromSignum :: (b -&gt; a) -&gt; b -&gt; Sign
</span><a href="Data.Geometry.QuadTree.html#fromSignum"><span class="hs-identifier hs-var hs-var">fromSignum</span></a></span></span><span> </span><span id="local-6989586621680025164"><span class="annot"><span class="annottext">f :: b -&gt; a
</span><a href="#local-6989586621680025164"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680025163"><span class="annot"><span class="annottext">x :: b
</span><a href="#local-6989586621680025163"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; a
</span><a href="#local-6989586621680025164"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680025163"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-159"></span><span>                       </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="Data.Geometry.QuadTree.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span>
</span><span id="line-160"></span><span>                       </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="Data.Geometry.QuadTree.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span><span>
</span><span id="line-161"></span><span>                       </span><span class="hs-number">1</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="Data.Geometry.QuadTree.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span>
</span><span id="line-162"></span><span>                       </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Sign
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;absurd: fromSignum&quot;</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Splitter that determines if we should split a cell based on the</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- sign of the corners.</span><span>
</span><span id="line-166"></span><span class="annot"><a href="Data.Geometry.QuadTree.html#shouldSplitZeros"><span class="hs-identifier hs-type">shouldSplitZeros</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680025387"><span class="annot"><a href="#local-6989586621680025387"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621680025386"><span class="annot"><a href="#local-6989586621680025386"><span class="hs-identifier hs-type">sign</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025387"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680025386"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.Point.Internal.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621680025387"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025386"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ The function we are evaluating</span><span>
</span><span id="line-168"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Split.html#Splitter"><span class="hs-identifier hs-type">Splitter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025387"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-169"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-type">Quadrants</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025386"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- the input are the signs of the corners</span><span>
</span><span id="line-170"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-type">Quadrants</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025386"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- at internal nodes we store signs of corners</span><span>
</span><span id="line-171"></span><span>                             </span><span class="annot"><a href="#local-6989586621680025386"><span class="hs-identifier hs-type">sign</span></a></span><span>
</span><span id="line-172"></span><span id="shouldSplitZeros"><span class="annot"><span class="annottext">shouldSplitZeros :: (Point 2 r -&gt; sign)
-&gt; Splitter r (Quadrants sign) (Quadrants sign) sign
</span><a href="Data.Geometry.QuadTree.html#shouldSplitZeros"><span class="hs-identifier hs-var hs-var">shouldSplitZeros</span></a></span></span><span> </span><span id="local-6989586621680025160"><span class="annot"><span class="annottext">f :: Point 2 r -&gt; sign
</span><a href="#local-6989586621680025160"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span id="local-6989586621680025158"><span class="annot"><span class="annottext">w' :: Int
</span><a href="#local-6989586621680025158"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621680025157"><span class="annot"><span class="annottext">p :: Point 2 r
</span><a href="#local-6989586621680025157"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680025156"><span class="annot"><span class="annottext">qs :: Quadrants sign
</span><a href="#local-6989586621680025156"><span class="hs-identifier hs-var">qs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-type">Quadrants</span></a></span><span> </span><span id="local-6989586621680025154"><span class="annot"><span class="annottext">nw :: sign
</span><a href="#local-6989586621680025154"><span class="hs-identifier hs-var">nw</span></a></span></span><span> </span><span id="local-6989586621680025153"><span class="annot"><span class="annottext">ne :: sign
</span><a href="#local-6989586621680025153"><span class="hs-identifier hs-var">ne</span></a></span></span><span> </span><span id="local-6989586621680025152"><span class="annot"><span class="annottext">se :: sign
</span><a href="#local-6989586621680025152"><span class="hs-identifier hs-var">se</span></a></span></span><span> </span><span id="local-6989586621680025151"><span class="annot"><span class="annottext">sw :: sign
</span><a href="#local-6989586621680025151"><span class="hs-identifier hs-var">sw</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(sign -&gt; Bool) -&gt; Quadrants sign -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">sign -&gt; Bool
</span><a href="#local-6989586621680025149"><span class="hs-identifier hs-var">sameSign</span></a></span><span> </span><span class="annot"><span class="annottext">Quadrants sign
</span><a href="#local-6989586621680025156"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">sign -&gt; Split (Quadrants sign) (Quadrants sign) sign
forall i v p. p -&gt; Split i v p
</span><a href="Data.Geometry.QuadTree.Split.html#No"><span class="hs-identifier hs-var">No</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025153"><span class="hs-identifier hs-var">ne</span></a></span><span>
</span><span id="line-173"></span><span>                                                          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Quadrants sign
-&gt; Quadrants (Quadrants sign)
-&gt; Split (Quadrants sign) (Quadrants sign) sign
forall i v p. v -&gt; Quadrants i -&gt; Split i v p
</span><a href="Data.Geometry.QuadTree.Split.html#Yes"><span class="hs-identifier hs-var">Yes</span></a></span><span> </span><span class="annot"><span class="annottext">Quadrants sign
</span><a href="#local-6989586621680025156"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="annot"><span class="annottext">Quadrants (Quadrants sign)
</span><a href="#local-6989586621680025146"><span class="hs-identifier hs-var">qs'</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621680025145"><span class="annot"><span class="annottext">m :: sign
</span><a href="#local-6989586621680025145"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; sign
</span><a href="#local-6989586621680025144"><span class="hs-identifier hs-var">fAt</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025143"><span class="hs-identifier hs-var">rr</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025143"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621680025142"><span class="annot"><span class="annottext">n :: sign
</span><a href="#local-6989586621680025142"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; sign
</span><a href="#local-6989586621680025144"><span class="hs-identifier hs-var">fAt</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025143"><span class="hs-identifier hs-var">rr</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025141"><span class="hs-identifier hs-var">ww</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621680025140"><span class="annot"><span class="annottext">e :: sign
</span><a href="#local-6989586621680025140"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; sign
</span><a href="#local-6989586621680025144"><span class="hs-identifier hs-var">fAt</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025141"><span class="hs-identifier hs-var">ww</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025143"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621680025139"><span class="annot"><span class="annottext">s :: sign
</span><a href="#local-6989586621680025139"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; sign
</span><a href="#local-6989586621680025144"><span class="hs-identifier hs-var">fAt</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025143"><span class="hs-identifier hs-var">rr</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621680025138"><span class="annot"><span class="annottext">w :: sign
</span><a href="#local-6989586621680025138"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; sign
</span><a href="#local-6989586621680025144"><span class="hs-identifier hs-var">fAt</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025143"><span class="hs-identifier hs-var">rr</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621680025149"><span class="annot"><span class="annottext">sameSign :: sign -&gt; Bool
</span><a href="#local-6989586621680025149"><span class="hs-identifier hs-var hs-var">sameSign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">sign -&gt; sign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025153"><span class="hs-identifier hs-var">ne</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-comment">-- signs at the new corners</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621680025146"><span class="annot"><span class="annottext">qs' :: Quadrants (Quadrants sign)
</span><a href="#local-6989586621680025146"><span class="hs-identifier hs-var hs-var">qs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Quadrants sign
-&gt; Quadrants sign
-&gt; Quadrants sign
-&gt; Quadrants sign
-&gt; Quadrants (Quadrants sign)
forall a. a -&gt; a -&gt; a -&gt; a -&gt; Corners a
</span><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-var">Quadrants</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">sign -&gt; sign -&gt; sign -&gt; sign -&gt; Quadrants sign
forall a. a -&gt; a -&gt; a -&gt; a -&gt; Corners a
</span><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-var">Quadrants</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025154"><span class="hs-identifier hs-var">nw</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025142"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025145"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025138"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">sign -&gt; sign -&gt; sign -&gt; sign -&gt; Quadrants sign
forall a. a -&gt; a -&gt; a -&gt; a -&gt; Corners a
</span><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-var">Quadrants</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025142"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025153"><span class="hs-identifier hs-var">ne</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025140"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025145"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">sign -&gt; sign -&gt; sign -&gt; sign -&gt; Quadrants sign
forall a. a -&gt; a -&gt; a -&gt; a -&gt; Corners a
</span><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-var">Quadrants</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025145"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025140"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025152"><span class="hs-identifier hs-var">se</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025139"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">sign -&gt; sign -&gt; sign -&gt; sign -&gt; Quadrants sign
forall a. a -&gt; a -&gt; a -&gt; a -&gt; Corners a
</span><a href="Data.Geometry.QuadTree.Quadrants.html#Quadrants"><span class="hs-identifier hs-var">Quadrants</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025138"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025145"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025139"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025151"><span class="hs-identifier hs-var">sw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621680025137"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621680025137"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680025158"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621680025143"><span class="annot"><span class="annottext">rr :: r
</span><a href="#local-6989586621680025143"><span class="hs-identifier hs-var hs-var">rr</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; r
forall r. Fractional r =&gt; Int -&gt; r
</span><a href="Data.Geometry.QuadTree.Cell.html#pow"><span class="hs-identifier hs-var">pow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680025137"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621680025141"><span class="annot"><span class="annottext">ww :: r
</span><a href="#local-6989586621680025141"><span class="hs-identifier hs-var hs-var">ww</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; r
forall r. Fractional r =&gt; Int -&gt; r
</span><a href="Data.Geometry.QuadTree.Cell.html#pow"><span class="hs-identifier hs-var">pow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680025158"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621680025144"><span class="annot"><span class="annottext">fAt :: r -&gt; r -&gt; sign
</span><a href="#local-6989586621680025144"><span class="hs-identifier hs-var hs-var">fAt</span></a></span></span><span> </span><span id="local-6989586621680025135"><span class="annot"><span class="annottext">x :: r
</span><a href="#local-6989586621680025135"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680025134"><span class="annot"><span class="annottext">y :: r
</span><a href="#local-6989586621680025134"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; sign
</span><a href="#local-6989586621680025160"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; sign) -&gt; Point 2 r -&gt; sign
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621680025157"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Diff (Point 2) r -&gt; Point 2 r
forall (p :: * -&gt; *) a. (Affine p, Num a) =&gt; p a -&gt; Diff p a -&gt; p a
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Vector 2 r
forall r. r -&gt; r -&gt; Vector 2 r
</span><a href="Data.Geometry.Vector.VectorFamily.html#Vector2"><span class="hs-identifier hs-var">Vector2</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025135"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621680025134"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621680025130"><span id="local-6989586621680025131"><span class="annot"><a href="Data.Geometry.QuadTree.html#isZeroCell"><span class="hs-identifier hs-type">isZeroCell</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621680025131"><span class="hs-identifier hs-type">sign</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680025131"><span class="hs-identifier hs-type">sign</span></a></span><span> </span><span class="hs-comment">-- ^ the zero value</span><span>
</span><span id="line-197"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621680025130"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025131"><span class="hs-identifier hs-type">sign</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-198"></span><span id="isZeroCell"><span class="annot"><span class="annottext">isZeroCell :: sign -&gt; Either v sign -&gt; Bool
</span><a href="Data.Geometry.QuadTree.html#isZeroCell"><span class="hs-identifier hs-var hs-var">isZeroCell</span></a></span></span><span> </span><span id="local-6989586621680025128"><span class="annot"><span class="annottext">z :: sign
</span><a href="#local-6989586621680025128"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- if we kept splitting then we must have a sign transition</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621680025127"><span class="annot"><span class="annottext">s :: sign
</span><a href="#local-6989586621680025127"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025127"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">sign -&gt; sign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">sign
</span><a href="#local-6989586621680025128"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | Constructs an empty/complete tree from the starting width</span><span>
</span><span id="line-207"></span><span id="local-6989586621680025126"><span class="annot"><a href="Data.Geometry.QuadTree.html#completeTree"><span class="hs-identifier hs-type">completeTree</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621680025126"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680025126"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.Cell.html#Cell"><span class="hs-identifier hs-type">Cell</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680025126"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Geometry.QuadTree.html#QuadTree"><span class="hs-identifier hs-type">QuadTree</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680025126"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-208"></span><span id="completeTree"><span class="annot"><span class="annottext">completeTree :: Cell r -&gt; QuadTree () () r
</span><a href="Data.Geometry.QuadTree.html#completeTree"><span class="hs-identifier hs-var hs-var">completeTree</span></a></span></span><span> </span><span id="local-6989586621680025124"><span class="annot"><span class="annottext">c0 :: Cell r
</span><a href="#local-6989586621680025124"><span class="hs-identifier hs-var">c0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">(Cell r -&gt; Int -&gt; Split Int () ())
-&gt; Cell r -&gt; Int -&gt; QuadTree () () r
forall r i v p.
(Fractional r, Ord r) =&gt;
(Cell r -&gt; i -&gt; Split i v p) -&gt; Cell r -&gt; i -&gt; QuadTree v p r
</span><a href="Data.Geometry.QuadTree.html#build"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621680025123"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621680025123"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680025123"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Split Int () ()
forall i v p. p -&gt; Split i v p
</span><a href="Data.Geometry.QuadTree.Split.html#No"><span class="hs-identifier hs-var">No</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">() -&gt; Quadrants Int -&gt; Split Int () ()
forall i v p. v -&gt; Quadrants i -&gt; Split i v p
</span><a href="Data.Geometry.QuadTree.Split.html#Yes"><span class="hs-identifier hs-var">Yes</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Quadrants Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Quadrants Int) -&gt; Int -&gt; Quadrants Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680025123"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025124"><span class="hs-identifier hs-var">c0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cell r
</span><a href="#local-6989586621680025124"><span class="hs-identifier hs-var">c0</span></a></span><span class="annot"><span class="annottext">Cell r -&gt; Getting Int (Cell r) Int -&gt; Int
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span class="annot"><span class="annottext">Getting Int (Cell r) Int
forall r. Lens' (Cell r) Int
</span><a href="Data.Geometry.QuadTree.Cell.html#cellWidthIndex"><span class="hs-identifier hs-var">cellWidthIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-212"></span></pre></body></html>