<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK prune #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      : Data.ByteString</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   : (c) The University of Glasgow 2001,</span><span>
</span><span id="line-8"></span><span class="hs-comment">--               (c) David Roundy 2003-2005,</span><span>
</span><span id="line-9"></span><span class="hs-comment">--               (c) Simon Marlow 2005,</span><span>
</span><span id="line-10"></span><span class="hs-comment">--               (c) Bjorn Bringert 2006,</span><span>
</span><span id="line-11"></span><span class="hs-comment">--               (c) Don Stewart 2005-2008,</span><span>
</span><span id="line-12"></span><span class="hs-comment">--               (c) Duncan Coutts 2006-2013</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Maintainer  : dons00@gmail.com, duncan@community.haskell.org</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Stability   : stable</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Portability : portable</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- A time- and space-efficient implementation of byte vectors using</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- packed Word8 arrays, suitable for high performance use, both in terms</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- of large data quantities and high speed requirements. Byte vectors</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- are encoded as strict 'Word8' arrays of bytes, held in a 'ForeignPtr',</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- and can be passed between C and Haskell with little effort.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- The recomended way to assemble ByteStrings from smaller parts</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- is to use the builder monoid from &quot;Data.ByteString.Builder&quot;.</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- This module is intended to be imported @qualified@, to avoid name</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- clashes with &quot;Prelude&quot; functions.  eg.</span><span>
</span><span id="line-30"></span><span class="hs-comment">--</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- &gt; import qualified Data.ByteString as B</span><span>
</span><span id="line-32"></span><span class="hs-comment">--</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- Original GHC implementation by Bryan O\'Sullivan.</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- Rewritten to use 'Data.Array.Unboxed.UArray' by Simon Marlow.</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- Rewritten to support slices and use 'ForeignPtr' by David Roundy.</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- Rewritten again and extended by Don Stewart and Duncan Coutts.</span><span>
</span><span id="line-37"></span><span class="hs-comment">--</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Strict @ByteString@</span></span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#StrictByteString"><span class="hs-identifier">StrictByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Heap fragmentation</span></span><span>
</span><span id="line-46"></span><span>        </span><span class="hs-comment">-- | With GHC, the 'ByteString' representation uses /pinned memory/,</span><span>
</span><span id="line-47"></span><span>        </span><span class="hs-comment">-- meaning it cannot be moved by GC. While this is ideal for use with</span><span>
</span><span id="line-48"></span><span>        </span><span class="hs-comment">-- the foreign function interface and is usually efficient, this</span><span>
</span><span id="line-49"></span><span>        </span><span class="hs-comment">-- representation may lead to issues with heap fragmentation and wasted</span><span>
</span><span id="line-50"></span><span>        </span><span class="hs-comment">-- space if the program selectively retains a fraction of many small</span><span>
</span><span id="line-51"></span><span>        </span><span class="hs-comment">-- 'ByteString's, keeping them live in memory over long durations.</span><span>
</span><span id="line-52"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span>        </span><span class="hs-comment">-- While 'ByteString' is indispensable when working with large blobs of</span><span>
</span><span id="line-54"></span><span>        </span><span class="hs-comment">-- data and especially when interfacing with native C libraries, be sure</span><span>
</span><span id="line-55"></span><span>        </span><span class="hs-comment">-- to also check the 'Data.ByteString.Short.ShortByteString' type.</span><span>
</span><span id="line-56"></span><span>        </span><span class="hs-comment">-- As a type backed by /unpinned/ memory, @ShortByteString@ behaves</span><span>
</span><span id="line-57"></span><span>        </span><span class="hs-comment">-- similarly to @Text@ (from the @text@ package) on the heap, completely</span><span>
</span><span id="line-58"></span><span>        </span><span class="hs-comment">-- avoids fragmentation issues, and in many use-cases may better suit</span><span>
</span><span id="line-59"></span><span>        </span><span class="hs-comment">-- your bytestring-storage needs.</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Introducing and eliminating 'ByteString's</span></span><span>
</span><span id="line-62"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#singleton"><span class="hs-identifier">singleton</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#pack"><span class="hs-identifier">pack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#unpack"><span class="hs-identifier">unpack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>        </span><span class="annot"><a href="Data.ByteString.Lazy.Internal.html#fromStrict"><span class="hs-identifier">fromStrict</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><a href="Data.ByteString.Lazy.Internal.html#toStrict"><span class="hs-identifier">toStrict</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#fromFilePath"><span class="hs-identifier">fromFilePath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#toFilePath"><span class="hs-identifier">toFilePath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Basic interface</span></span><span>
</span><span id="line-72"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#cons"><span class="hs-identifier">cons</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#snoc"><span class="hs-identifier">snoc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#append"><span class="hs-identifier">append</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#head"><span class="hs-identifier">head</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#uncons"><span class="hs-identifier">uncons</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#unsnoc"><span class="hs-identifier">unsnoc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#last"><span class="hs-identifier">last</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#tail"><span class="hs-identifier">tail</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#init"><span class="hs-identifier">init</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#null"><span class="hs-identifier">null</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#length"><span class="hs-identifier">length</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Transforming ByteStrings</span></span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#map"><span class="hs-identifier">map</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#reverse"><span class="hs-identifier">reverse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#intersperse"><span class="hs-identifier">intersperse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#intercalate"><span class="hs-identifier">intercalate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#transpose"><span class="hs-identifier">transpose</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Reducing 'ByteString's (folds)</span></span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#foldl"><span class="hs-identifier">foldl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#foldl%27"><span class="hs-identifier">foldl'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#foldl1"><span class="hs-identifier">foldl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#foldl1%27"><span class="hs-identifier">foldl1'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#foldr"><span class="hs-identifier">foldr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#foldr%27"><span class="hs-identifier">foldr'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#foldr1"><span class="hs-identifier">foldr1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#foldr1%27"><span class="hs-identifier">foldr1'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Special folds</span></span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#concat"><span class="hs-identifier">concat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#concatMap"><span class="hs-identifier">concatMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#any"><span class="hs-identifier">any</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#all"><span class="hs-identifier">all</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#maximum"><span class="hs-identifier">maximum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#minimum"><span class="hs-identifier">minimum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Building ByteStrings</span></span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Scans</span></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#scanl"><span class="hs-identifier">scanl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#scanl1"><span class="hs-identifier">scanl1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#scanr"><span class="hs-identifier">scanr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#scanr1"><span class="hs-identifier">scanr1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Accumulating maps</span></span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#mapAccumL"><span class="hs-identifier">mapAccumL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#mapAccumR"><span class="hs-identifier">mapAccumR</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Generating and unfolding ByteStrings</span></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#replicate"><span class="hs-identifier">replicate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#unfoldr"><span class="hs-identifier">unfoldr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#unfoldrN"><span class="hs-identifier">unfoldrN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Substrings</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Breaking strings</span></span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#take"><span class="hs-identifier">take</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#takeEnd"><span class="hs-identifier">takeEnd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#drop"><span class="hs-identifier">drop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#dropEnd"><span class="hs-identifier">dropEnd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#splitAt"><span class="hs-identifier">splitAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#takeWhile"><span class="hs-identifier">takeWhile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#takeWhileEnd"><span class="hs-identifier">takeWhileEnd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#dropWhile"><span class="hs-identifier">dropWhile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#dropWhileEnd"><span class="hs-identifier">dropWhileEnd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#span"><span class="hs-identifier">span</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#spanEnd"><span class="hs-identifier">spanEnd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#break"><span class="hs-identifier">break</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#breakEnd"><span class="hs-identifier">breakEnd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#group"><span class="hs-identifier">group</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#groupBy"><span class="hs-identifier">groupBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#inits"><span class="hs-identifier">inits</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#tails"><span class="hs-identifier">tails</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#initsNE"><span class="hs-identifier">initsNE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#tailsNE"><span class="hs-identifier">tailsNE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#stripPrefix"><span class="hs-identifier">stripPrefix</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#stripSuffix"><span class="hs-identifier">stripSuffix</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Breaking into many substrings</span></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#split"><span class="hs-identifier">split</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#splitWith"><span class="hs-identifier">splitWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Predicates</span></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#isPrefixOf"><span class="hs-identifier">isPrefixOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#isSuffixOf"><span class="hs-identifier">isSuffixOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#isInfixOf"><span class="hs-identifier">isInfixOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Encoding validation</span></span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#isValidUtf8"><span class="hs-identifier">isValidUtf8</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Search for arbitrary substrings</span></span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#breakSubstring"><span class="hs-identifier">breakSubstring</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Searching ByteStrings</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Searching by equality</span></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#elem"><span class="hs-identifier">elem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#notElem"><span class="hs-identifier">notElem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Searching with a predicate</span></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#find"><span class="hs-identifier">find</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#filter"><span class="hs-identifier">filter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#partition"><span class="hs-identifier">partition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Indexing ByteStrings</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#index"><span class="hs-identifier">index</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#indexMaybe"><span class="hs-identifier">indexMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#%21%3F"><span class="hs-operator">(!?)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#elemIndex"><span class="hs-identifier">elemIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#elemIndices"><span class="hs-identifier">elemIndices</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#elemIndexEnd"><span class="hs-identifier">elemIndexEnd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#findIndex"><span class="hs-identifier">findIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-185"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#findIndices"><span class="hs-identifier">findIndices</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#findIndexEnd"><span class="hs-identifier">findIndexEnd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#count"><span class="hs-identifier">count</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Zipping and unzipping ByteStrings</span></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#zip"><span class="hs-identifier">zip</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#zipWith"><span class="hs-identifier">zipWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#packZipWith"><span class="hs-identifier">packZipWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#unzip"><span class="hs-identifier">unzip</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Ordered ByteStrings</span></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#sort"><span class="hs-identifier">sort</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Low level conversions</span></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Copying ByteStrings</span></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#copy"><span class="hs-identifier">copy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Packing 'CString's and pointers</span></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#packCString"><span class="hs-identifier">packCString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#packCStringLen"><span class="hs-identifier">packCStringLen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Using ByteStrings as 'CString's</span></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#useAsCString"><span class="hs-identifier">useAsCString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#useAsCStringLen"><span class="hs-identifier">useAsCStringLen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><span class="hs-comment">-- * I\/O with 'ByteString's</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Standard input and output</span></span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#getLine"><span class="hs-identifier">getLine</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#getContents"><span class="hs-identifier">getContents</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#putStr"><span class="hs-identifier">putStr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#interact"><span class="hs-identifier">interact</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** Files</span></span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#readFile"><span class="hs-identifier">readFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#writeFile"><span class="hs-identifier">writeFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#appendFile"><span class="hs-identifier">appendFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="hs-comment">-- ** I\/O with Handles</span></span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#hGetLine"><span class="hs-identifier">hGetLine</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#hGetContents"><span class="hs-identifier">hGetContents</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#hGet"><span class="hs-identifier">hGet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#hGetSome"><span class="hs-identifier">hGetSome</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#hGetNonBlocking"><span class="hs-identifier">hGetNonBlocking</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#hPut"><span class="hs-identifier">hPut</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#hPutNonBlocking"><span class="hs-identifier">hPutNonBlocking</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><a href="Data.ByteString.html#hPutStr"><span class="hs-identifier">hPutStr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-235"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">reverse</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">head</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">tail</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">last</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">init</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">Foldable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">map</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">lines</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">unlines</span></span><span>
</span><span id="line-237"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">concat</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">any</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">take</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">drop</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">splitAt</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">takeWhile</span></span><span>
</span><span id="line-238"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">dropWhile</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">span</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">break</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">filter</span></span><span>
</span><span id="line-239"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">all</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">concatMap</span></span><span>
</span><span id="line-240"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">scanl</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">scanl1</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">scanr</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">scanr1</span></span><span>
</span><span id="line-241"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">readFile</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">writeFile</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">appendFile</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">replicate</span></span><span>
</span><span id="line-242"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">getContents</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">getLine</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">putStr</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">putStrLn</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">interact</span></span><span>
</span><span id="line-243"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">zip</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">zipWith</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">unzip</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">notElem</span></span><span>
</span><span id="line-244"></span><span>                                </span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Bits.html"><span class="hs-identifier">Data.Bits</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">finiteBitSize</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shiftL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.|.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html"><span class="hs-identifier">Data.ByteString.Internal.Type</span></a></span><span>
</span><span id="line-249"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Lazy.Internal.html"><span class="hs-identifier">Data.ByteString.Lazy.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Lazy.Internal.html#fromStrict"><span class="hs-identifier">fromStrict</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Lazy.Internal.html#toStrict"><span class="hs-identifier">toStrict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Unsafe.html"><span class="hs-identifier">Data.ByteString.Unsafe</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-253"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-254"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IOException</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">catch</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">finally</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">assert</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throwIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.C.String.html"><span class="hs-identifier">Foreign.C.String</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CStringLen</span></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.ForeignPtr.html"><span class="hs-identifier">Foreign.ForeignPtr</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ForeignPtr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">touchForeignPtr</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.ForeignPtr.Unsafe.html"><span class="hs-identifier">Foreign.ForeignPtr.Unsafe</span></a></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeForeignPtrToPtr</span></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Marshal.Alloc.html"><span class="hs-identifier">Foreign.Marshal.Alloc</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">allocaBytes</span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Marshal.Array.html"><span class="hs-identifier">Foreign.Marshal.Array</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">allocaArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Marshal.Utils.html"><span class="hs-identifier">Foreign.Marshal.Utils</span></a></span><span>
</span><span id="line-267"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Ptr.html"><span class="hs-identifier">Foreign.Ptr</span></a></span><span>
</span><span id="line-268"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Storable.html"><span class="hs-identifier">Foreign.Storable</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Storable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- hGetBuf and hPutBuf not available in yhc or nhc</span><span>
</span><span id="line-271"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">stdin</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">stdout</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">hClose</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">hFileSize</span></span><span>
</span><span id="line-272"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">hGetBuf</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">hPutBuf</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">hGetBufNonBlocking</span></span><span>
</span><span id="line-273"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">hPutBufNonBlocking</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">withBinaryFile</span></span><span>
</span><span id="line-274"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">IOMode</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">hGetBufSome</span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.IO.Error.html"><span class="hs-identifier">System.IO.Error</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mkIOError</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">illegalOperationErrorType</span></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.IORef.html"><span class="hs-identifier">Data.IORef</span></a></span><span>
</span><span id="line-278"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.IO.Handle.Internals.html"><span class="hs-identifier">GHC.IO.Handle.Internals</span></a></span><span>
</span><span id="line-279"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.IO.Handle.Types.html"><span class="hs-identifier">GHC.IO.Handle.Types</span></a></span><span>
</span><span id="line-280"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.IO.Buffer.html"><span class="hs-identifier">GHC.IO.Buffer</span></a></span><span>
</span><span id="line-281"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.IO.BufferedIO.html"><span class="hs-identifier">GHC.IO.BufferedIO</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Buffered</span></span><span>
</span><span id="line-282"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.IO.Encoding.html"><span class="hs-identifier">GHC.IO.Encoding</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getFileSystemEncoding</span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Foreign.html"><span class="hs-identifier">GHC.Foreign</span></a></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">newCStringLen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">peekCStringLen</span></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Stack.Types.html"><span class="hs-identifier">GHC.Stack.Types</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">HasCallStack</span></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Base.html"><span class="hs-identifier">GHC.Base</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">build</span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Word.html"><span class="hs-identifier">GHC.Word</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- Introducing and eliminating 'ByteString's</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><span class="hs-comment">-- | /O(1)/ Convert a 'Word8' into a 'ByteString'</span></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Data.ByteString.html#singleton"><span class="hs-identifier hs-type">singleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- Taking a slice of some static data rather than allocating a new</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- buffer for each call is nice for several reasons. Since it doesn't</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- involve any side effects hidden in a 'GHC.Magic.runRW#' call, it</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- can be simplified to a constructor application. This may enable GHC</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- to perform further optimizations after inlining, and also causes a</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- fresh singleton to take only 4 words of heap space instead of 9.</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- (The buffer object itself would take up 3 words: header, size, and</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- 1 word of content. The ForeignPtrContents object used to keep the</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- buffer alive would need two more.)</span><span>
</span><span id="line-304"></span><span id="singleton"><span class="annot"><span class="annottext">singleton :: Word8 -&gt; ByteString
</span><a href="Data.ByteString.html#singleton"><span class="hs-identifier hs-var hs-var">singleton</span></a></span></span><span> </span><span id="local-6989586621679122200"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122200"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122200"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.html#allBytes"><span class="hs-identifier hs-var">allBytes</span></a></span><span>
</span><span id="line-305"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#singleton"><span class="hs-pragma hs-type">singleton</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><span class="hs-comment">-- | A static blob of all possible bytes (0x00 to 0xff) in order</span></span><span>
</span><span id="line-308"></span><span class="annot"><a href="Data.ByteString.html#allBytes"><span class="hs-identifier hs-type">allBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-309"></span><span id="allBytes"><span class="annot"><span class="annottext">allBytes :: ByteString
</span><a href="Data.ByteString.html#allBytes"><span class="hs-identifier hs-var hs-var">allBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Addr# -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenLiteral"><span class="hs-identifier hs-var">unsafePackLenLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x100</span></span><span>
</span><span id="line-310"></span><span>  </span><span class="annot"><span class="annottext">Addr#
</span><span class="hs-string">&quot;\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&quot;#</span></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- | /O(n)/ Convert a @['Word8']@ into a 'ByteString'.</span><span>
</span><span id="line-313"></span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- For applications with large numbers of string literals, 'pack' can be a</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- bottleneck. In such cases, consider using 'unsafePackAddress' (GHC only).</span><span>
</span><span id="line-316"></span><span class="annot"><a href="Data.ByteString.html#pack"><span class="hs-identifier hs-type">pack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-317"></span><span id="pack"><span class="annot"><span class="annottext">pack :: [Word8] -&gt; ByteString
</span><a href="Data.ByteString.html#pack"><span class="hs-identifier hs-var hs-var">pack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#packBytes"><span class="hs-identifier hs-var">packBytes</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ Converts a 'ByteString' to a @['Word8']@.</span></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Data.ByteString.html#unpack"><span class="hs-identifier hs-type">unpack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span id="unpack"><span class="annot"><span class="annottext">unpack :: ByteString -&gt; [Word8]
</span><a href="Data.ByteString.html#unpack"><span class="hs-identifier hs-var hs-var">unpack</span></a></span></span><span> </span><span id="local-6989586621679122207"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122207"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall b. (Word8 -&gt; b -&gt; b) -&gt; b -&gt; b) -&gt; [Word8]
forall a. (forall b. (a -&gt; b -&gt; b) -&gt; b -&gt; b) -&gt; [a]
</span><span class="hs-identifier hs-var">build</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; (Word8 -&gt; b -&gt; b) -&gt; b -&gt; b
forall a. ByteString -&gt; (Word8 -&gt; a -&gt; a) -&gt; a -&gt; a
</span><a href="Data.ByteString.html#unpackFoldr"><span class="hs-identifier hs-var">unpackFoldr</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122207"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#unpack"><span class="hs-pragma hs-type">unpack</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">--</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- Have unpack fuse with good list consumers</span><span>
</span><span id="line-326"></span><span class="hs-comment">--</span><span>
</span><span id="line-327"></span><span id="local-6989586621679121612"><span class="annot"><a href="Data.ByteString.html#unpackFoldr"><span class="hs-identifier hs-type">unpackFoldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121612"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-328"></span><span id="unpackFoldr"><span class="annot"><span class="annottext">unpackFoldr :: forall a. ByteString -&gt; (Word8 -&gt; a -&gt; a) -&gt; a -&gt; a
</span><a href="Data.ByteString.html#unpackFoldr"><span class="hs-identifier hs-var hs-var">unpackFoldr</span></a></span></span><span> </span><span id="local-6989586621679122209"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122209"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679122210"><span class="annot"><span class="annottext">Word8 -&gt; a -&gt; a
</span><a href="#local-6989586621679122210"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679122211"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122211"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; a -&gt; a) -&gt; a -&gt; ByteString -&gt; a
forall a. (Word8 -&gt; a -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; a -&gt; a
</span><a href="#local-6989586621679122210"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122211"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122209"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-329"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#unpackFoldr"><span class="hs-pragma hs-type">unpackFoldr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-332"></span><span class="annot"><span class="hs-pragma">&quot;ByteString unpack-list&quot;</span></span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span>  </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122212"><span class="annot"><a href="#local-6989586621679122212"><span class="hs-pragma hs-var">bs</span></a></span></span><span> </span><span class="hs-pragma">.</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#unpackFoldr"><span class="hs-pragma hs-type">unpackFoldr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122212"><span class="hs-pragma hs-type">bs</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackBytes"><span class="hs-pragma hs-type">unpackBytes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122212"><span class="hs-pragma hs-type">bs</span></a></span><span>
</span><span id="line-334"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- | Convert a 'FilePath' to a 'ByteString'.</span><span>
</span><span id="line-337"></span><span class="hs-comment">--</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- The 'FilePath' type is expected to use the file system encoding</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- as reported by 'GHC.IO.Encoding.getFileSystemEncoding'. This</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- encoding allows for round-tripping of arbitrary data on platforms</span><span>
</span><span id="line-341"></span><span class="hs-comment">-- that allow arbitrary bytes in their paths. This conversion</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- function does the same thing that `System.IO.openFile` would</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- do when decoding the 'FilePath'.</span><span>
</span><span id="line-344"></span><span class="hs-comment">--</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- This function is in 'IO' because the file system encoding can be</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- changed. If the encoding can be assumed to be constant in your</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- use case, you may invoke this function via 'unsafePerformIO'.</span><span>
</span><span id="line-348"></span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- @since 0.11.2.0</span><span>
</span><span id="line-350"></span><span class="annot"><a href="Data.ByteString.html#fromFilePath"><span class="hs-identifier hs-type">fromFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-351"></span><span id="fromFilePath"><span class="annot"><span class="annottext">fromFilePath :: FilePath -&gt; IO ByteString
</span><a href="Data.ByteString.html#fromFilePath"><span class="hs-identifier hs-var hs-var">fromFilePath</span></a></span></span><span> </span><span id="local-6989586621679122214"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679122214"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679122215"><span class="annot"><a href="#local-6989586621679122215"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO TextEncoding
</span><span class="hs-identifier hs-var">getFileSystemEncoding</span></span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">newCStringLen</span></span><span> </span><span class="annot"><a href="#local-6989586621679122215"><span class="hs-identifier hs-type">enc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122214"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="Data.ByteString.Unsafe.html#unsafePackMallocCStringLen"><span class="hs-identifier hs-type">unsafePackMallocCStringLen</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-comment">-- | Convert a 'ByteString' to a 'FilePath'.</span><span>
</span><span id="line-356"></span><span class="hs-comment">--</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- This function uses the file system encoding, and resulting 'FilePath's</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- can be safely used with standard IO functions and will reference the</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- correct path in the presence of arbitrary non-UTF-8 encoded paths.</span><span>
</span><span id="line-360"></span><span class="hs-comment">--</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- This function is in 'IO' because the file system encoding can be</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- changed. If the encoding can be assumed to be constant in your</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- use case, you may invoke this function via 'unsafePerformIO'.</span><span>
</span><span id="line-364"></span><span class="hs-comment">--</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- @since 0.11.2.0</span><span>
</span><span id="line-366"></span><span class="annot"><a href="Data.ByteString.html#toFilePath"><span class="hs-identifier hs-type">toFilePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-367"></span><span id="toFilePath"><span class="annot"><span class="annottext">toFilePath :: ByteString -&gt; IO FilePath
</span><a href="Data.ByteString.html#toFilePath"><span class="hs-identifier hs-var hs-var">toFilePath</span></a></span></span><span> </span><span id="local-6989586621679122217"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122217"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679122218"><span class="annot"><a href="#local-6989586621679122218"><span class="hs-identifier hs-var">enc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO TextEncoding
</span><span class="hs-identifier hs-var">getFileSystemEncoding</span></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#useAsCStringLen"><span class="hs-identifier hs-type">useAsCStringLen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122217"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">peekCStringLen</span></span><span> </span><span class="annot"><a href="#local-6989586621679122218"><span class="hs-identifier hs-type">enc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- Basic interface</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><span class="hs-comment">-- | /O(1)/ Test whether a ByteString is empty.</span></span><span>
</span><span id="line-375"></span><span class="annot"><a href="Data.ByteString.html#null"><span class="hs-identifier hs-type">null</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-376"></span><span id="null"><span class="annot"><span class="annottext">null :: ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var hs-var">null</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679122220"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122220"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122220"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122220"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-377"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#null"><span class="hs-pragma hs-type">null</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-380"></span><span class="annot"><span class="hs-comment">-- | /O(1)/ 'length' returns the length of a ByteString as an 'Int'.</span></span><span>
</span><span id="line-381"></span><span class="annot"><a href="Data.ByteString.html#length"><span class="hs-identifier hs-type">length</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-382"></span><span id="length"><span class="annot"><span class="annottext">length :: ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var hs-var">length</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679122222"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122222"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Int
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122222"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122222"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-383"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#length"><span class="hs-pragma hs-type">length</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Data.ByteString.html#cons"><span class="hs-operator hs-type">`cons`</span></a></span><span> </span><span class="hs-comment">--same as list (:)</span><span>
</span><span id="line-388"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Data.ByteString.html#snoc"><span class="hs-operator hs-type">`snoc`</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">-- | /O(n)/ 'cons' is analogous to (:) for lists, but of different</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- complexity, as it requires making a copy.</span><span>
</span><span id="line-392"></span><span class="annot"><a href="Data.ByteString.html#cons"><span class="hs-identifier hs-type">cons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-393"></span><span id="cons"><span class="annot"><span class="annottext">cons :: Word8 -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#cons"><span class="hs-identifier hs-var hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679122223"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122223"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122224"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122224"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122225"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122225"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var">checkedAdd</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;cons&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122225"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122228"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122228"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122228"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122223"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122228"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122224"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122225"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-396"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#cons"><span class="hs-pragma hs-type">cons</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ Append a byte to the end of a 'ByteString'</span></span><span>
</span><span id="line-399"></span><span class="annot"><a href="Data.ByteString.html#snoc"><span class="hs-identifier hs-type">snoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-400"></span><span id="snoc"><span class="annot"><span class="annottext">snoc :: ByteString -&gt; Word8 -&gt; ByteString
</span><a href="Data.ByteString.html#snoc"><span class="hs-identifier hs-var hs-var">snoc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122232"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122232"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122233"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122233"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679122234"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122234"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var">checkedAdd</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;snoc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122233"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122235"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122235"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122235"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122232"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122233"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122235"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122233"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122234"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-403"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#snoc"><span class="hs-pragma hs-type">snoc</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">-- | /O(1)/ Extract the first element of a ByteString, which must be non-empty.</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-407"></span><span class="hs-comment">--</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- This is a partial function, consider using 'uncons' instead.</span><span>
</span><span id="line-409"></span><span class="annot"><a href="Data.ByteString.html#head"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-410"></span><span id="head"><span class="annot"><span class="annottext">head :: HasCallStack =&gt; ByteString -&gt; Word8
</span><a href="Data.ByteString.html#head"><span class="hs-identifier hs-var hs-var">head</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122242"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122242"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122243"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122243"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122243"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;head&quot;</span></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Word8 -&gt; Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Word8 -&gt; Word8) -&gt; IO Word8 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122242"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Word8) -&gt; IO Word8)
-&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122247"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122247"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122247"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-413"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#head"><span class="hs-pragma hs-type">head</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">-- | /O(1)/ Extract the elements after the head of a ByteString, which must be non-empty.</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-417"></span><span class="hs-comment">--</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- This is a partial function, consider using 'uncons' instead.</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Data.ByteString.html#tail"><span class="hs-identifier hs-type">tail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-420"></span><span id="tail"><span class="annot"><span class="annottext">tail :: HasCallStack =&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#tail"><span class="hs-identifier hs-var hs-var">tail</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122256"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122256"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679122257"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122257"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122257"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;tail&quot;</span></span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122256"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122257"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#tail"><span class="hs-pragma hs-type">tail</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-comment">-- | /O(1)/ Extract the 'head' and 'tail' of a ByteString, returning 'Nothing'</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- if it is empty.</span><span>
</span><span id="line-427"></span><span class="annot"><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-type">uncons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span id="uncons"><span class="annot"><span class="annottext">uncons :: ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var hs-var">uncons</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122258"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122258"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122259"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122259"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122259"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8, ByteString) -&gt; Maybe (Word8, ByteString)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO Word8 -&gt; Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Word8 -&gt; Word8) -&gt; IO Word8 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122258"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-431"></span><span>                                                     </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Word8) -&gt; IO Word8)
-&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122260"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122260"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122260"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-432"></span><span>                        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122258"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122259"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#uncons"><span class="hs-pragma hs-type">uncons</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- | /O(1)/ Extract the last element of a ByteString, which must be finite and non-empty.</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-437"></span><span class="hs-comment">--</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- This is a partial function, consider using 'unsnoc' instead.</span><span>
</span><span id="line-439"></span><span class="annot"><a href="Data.ByteString.html#last"><span class="hs-identifier hs-type">last</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-440"></span><span id="last"><span class="annot"><span class="annottext">last :: HasCallStack =&gt; ByteString -&gt; Word8
</span><a href="Data.ByteString.html#last"><span class="hs-identifier hs-var hs-var">last</span></a></span></span><span> </span><span id="local-6989586621679122267"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122267"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122268"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122268"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122269"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122269"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122267"><span class="hs-identifier hs-var">ps</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;last&quot;</span></span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Word8 -&gt; Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Word8 -&gt; Word8) -&gt; IO Word8 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-443"></span><span>                    </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122268"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Word8) -&gt; IO Word8)
-&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122270"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122270"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122270"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122269"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#last"><span class="hs-pragma hs-type">last</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | /O(1)/ Returns all the elements of a 'ByteString' except the last one.</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-448"></span><span class="hs-comment">--</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- This is a partial function, consider using 'unsnoc' instead.</span><span>
</span><span id="line-450"></span><span class="annot"><a href="Data.ByteString.html#init"><span class="hs-identifier hs-type">init</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-451"></span><span id="init"><span class="annot"><span class="annottext">init :: HasCallStack =&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#init"><span class="hs-identifier hs-var hs-var">init</span></a></span></span><span> </span><span id="local-6989586621679122277"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122277"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122278"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122278"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679122279"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122279"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122277"><span class="hs-identifier hs-var">ps</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;init&quot;</span></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122278"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122279"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#init"><span class="hs-pragma hs-type">init</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-comment">-- | /O(1)/ Extract the 'init' and 'last' of a ByteString, returning 'Nothing'</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- if it is empty.</span><span>
</span><span id="line-458"></span><span class="annot"><a href="Data.ByteString.html#unsnoc"><span class="hs-identifier hs-type">unsnoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span id="unsnoc"><span class="annot"><span class="annottext">unsnoc :: ByteString -&gt; Maybe (ByteString, Word8)
</span><a href="Data.ByteString.html#unsnoc"><span class="hs-identifier hs-var hs-var">unsnoc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122280"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122280"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122281"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122281"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122281"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ByteString, Word8)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString, Word8) -&gt; Maybe (ByteString, Word8)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122280"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122281"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-462"></span><span>                        </span><span class="annot"><span class="annottext">IO Word8 -&gt; Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Word8 -&gt; Word8) -&gt; IO Word8 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-463"></span><span>                          </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122280"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Word8) -&gt; IO Word8)
-&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122282"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122282"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122282"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122281"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#unsnoc"><span class="hs-pragma hs-type">unsnoc</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ Append two ByteStrings</span></span><span>
</span><span id="line-467"></span><span class="annot"><a href="Data.ByteString.html#append"><span class="hs-identifier hs-type">append</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-468"></span><span id="append"><span class="annot"><span class="annottext">append :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#append"><span class="hs-identifier hs-var hs-var">append</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span>
</span><span id="line-469"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#append"><span class="hs-pragma hs-type">append</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- Transformations</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">-- | /O(n)/ 'map' @f xs@ is the ByteString obtained by applying @f@ to each</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- element of @xs@.</span><span>
</span><span id="line-476"></span><span class="annot"><a href="Data.ByteString.html#map"><span class="hs-identifier hs-type">map</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-477"></span><span id="map"><span class="annot"><span class="annottext">map :: (Word8 -&gt; Word8) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#map"><span class="hs-identifier hs-var hs-var">map</span></a></span></span><span> </span><span id="local-6989586621679122283"><span class="annot"><span class="annottext">Word8 -&gt; Word8
</span><a href="#local-6989586621679122283"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122284"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122284"><span class="hs-identifier hs-var">srcPtr</span></a></span></span><span> </span><span id="local-6989586621679122285"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122285"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122285"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122286"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122286"><span class="hs-identifier hs-var">dstPtr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO ()
forall {b}. ForeignPtr Word8 -&gt; ForeignPtr b -&gt; IO ()
</span><a href="#local-6989586621679122287"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122284"><span class="hs-identifier hs-var">srcPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122286"><span class="hs-identifier hs-var">dstPtr</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-479"></span><span>    </span><span id="local-6989586621679122287"><span class="annot"><span class="annottext">m :: ForeignPtr Word8 -&gt; ForeignPtr b -&gt; IO ()
</span><a href="#local-6989586621679122287"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122296"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122296"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122297"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122297"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="#local-6989586621679122298"><span class="hs-identifier hs-var">map_</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-481"></span><span>      </span><span class="annot"><a href="#local-6989586621679122298"><span class="hs-identifier hs-type">map_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>      </span><span id="local-6989586621679122298"><span class="annot"><span class="annottext">map_ :: Int -&gt; IO ()
</span><a href="#local-6989586621679122298"><span class="hs-identifier hs-var hs-var">map_</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122299"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122299"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-483"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122299"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122285"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-485"></span><span>              </span><span id="local-6989586621679122300"><span class="annot"><a href="#local-6989586621679122300"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var">peekFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122296"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122299"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-486"></span><span>              </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-type">pokeFpByteOff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122297"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122299"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122283"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122300"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>              </span><span class="annot"><a href="#local-6989586621679122298"><span class="hs-identifier hs-type">map_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122299"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#map"><span class="hs-pragma hs-type">map</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ 'reverse' @xs@ efficiently returns the elements of @xs@ in reverse order.</span></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Data.ByteString.html#reverse"><span class="hs-identifier hs-type">reverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-492"></span><span id="reverse"><span class="annot"><span class="annottext">reverse :: ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#reverse"><span class="hs-identifier hs-var hs-var">reverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122304"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122304"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122305"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122305"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122305"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122306"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122306"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122306"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122307"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122307"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122304"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122308"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122308"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-495"></span><span>      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; CSize -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#c_reverse"><span class="hs-identifier hs-var">c_reverse</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122307"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122308"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122305"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-comment">-- | /O(n)/ The 'intersperse' function takes a 'Word8' and a</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- 'ByteString' and \`intersperses\' that byte between the elements of</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- the 'ByteString'.  It is analogous to the intersperse function on</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- Lists.</span><span>
</span><span id="line-501"></span><span class="annot"><a href="Data.ByteString.html#intersperse"><span class="hs-identifier hs-type">intersperse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-502"></span><span id="intersperse"><span class="annot"><span class="annottext">intersperse :: Word8 -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#intersperse"><span class="hs-identifier hs-var hs-var">intersperse</span></a></span></span><span> </span><span id="local-6989586621679122310"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122310"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679122311"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122311"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122312"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122312"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122313"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122313"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122311"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122311"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122313"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122316"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122316"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-505"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122316"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122317"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122317"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-506"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122312"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122318"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122318"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-507"></span><span>          </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; CSize -&gt; Word8 -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#c_intersperse"><span class="hs-identifier hs-var">c_intersperse</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122317"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122318"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122313"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122310"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span class="hs-comment">-- | The 'transpose' function transposes the rows and columns of its</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- 'ByteString' argument.</span><span>
</span><span id="line-511"></span><span class="annot"><a href="Data.ByteString.html#transpose"><span class="hs-identifier hs-type">transpose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-512"></span><span id="transpose"><span class="annot"><span class="annottext">transpose :: [ByteString] -&gt; [ByteString]
</span><a href="Data.ByteString.html#transpose"><span class="hs-identifier hs-var hs-var">transpose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString) -&gt; [[Word8]] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="Data.ByteString.html#pack"><span class="hs-identifier hs-var">pack</span></a></span><span> </span><span class="annot"><span class="annottext">([[Word8]] -&gt; [ByteString])
-&gt; ([ByteString] -&gt; [[Word8]]) -&gt; [ByteString] -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[Word8]] -&gt; [[Word8]]
forall a. [[a]] -&gt; [[a]]
</span><span class="hs-identifier hs-var">List.transpose</span></span><span> </span><span class="annot"><span class="annottext">([[Word8]] -&gt; [[Word8]])
-&gt; ([ByteString] -&gt; [[Word8]]) -&gt; [ByteString] -&gt; [[Word8]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [Word8]) -&gt; [ByteString] -&gt; [[Word8]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8]
</span><a href="Data.ByteString.html#unpack"><span class="hs-identifier hs-var">unpack</span></a></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- Reducing 'ByteString's</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-comment">-- | 'foldl', applied to a binary operator, a starting value (typically</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- the left-identity of the operator), and a ByteString, reduces the</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- ByteString using the binary operator, from left to right.</span><span>
</span><span id="line-520"></span><span class="hs-comment">--</span><span>
</span><span id="line-521"></span><span id="local-6989586621679121648"><span class="annot"><a href="Data.ByteString.html#foldl"><span class="hs-identifier hs-type">foldl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679121648"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121648"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121648"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121648"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-522"></span><span id="foldl"><span class="annot"><span class="annottext">foldl :: forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldl"><span class="hs-identifier hs-var hs-var">foldl</span></a></span></span><span> </span><span id="local-6989586621679122322"><span class="annot"><span class="annottext">a -&gt; Word8 -&gt; a
</span><a href="#local-6989586621679122322"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122323"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122323"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122324"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122324"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679122325"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122325"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-524"></span><span>    </span><span id="local-6989586621679122328"><span class="annot"><span class="annottext">end :: Ptr b
</span><a href="#local-6989586621679122328"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Ptr Word8
forall a. ForeignPtr a -&gt; Ptr a
</span><span class="hs-identifier hs-var">unsafeForeignPtrToPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122324"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-comment">-- not tail recursive; traverses array right to left</span><span>
</span><span id="line-526"></span><span>    </span><span id="local-6989586621679122333"><span class="annot"><span class="annottext">go :: Ptr Word8 -&gt; a
</span><a href="#local-6989586621679122333"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122334"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122334"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122334"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
forall {b}. Ptr b
</span><a href="#local-6989586621679122328"><span class="hs-identifier hs-var">end</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122323"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-527"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122339"><span class="annot"><span class="annottext">x :: Word8
</span><a href="#local-6989586621679122339"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Word8 -&gt; Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Word8 -&gt; Word8) -&gt; IO Word8 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-528"></span><span>                                   </span><span id="local-6989586621679122340"><span class="annot"><a href="#local-6989586621679122340"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122334"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-529"></span><span>                                   </span><span class="annot"><span class="hs-identifier hs-type">touchForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679122324"><span class="hs-identifier hs-type">fp</span></a></span><span>
</span><span id="line-530"></span><span>                                   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679122340"><span class="hs-identifier hs-type">x'</span></a></span><span>
</span><span id="line-531"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a -&gt; Word8 -&gt; a
</span><a href="#local-6989586621679122322"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; a
</span><a href="#local-6989586621679122333"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122334"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122339"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; a
</span><a href="#local-6989586621679122333"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr (ZonkAny 3)
forall {b}. Ptr b
</span><a href="#local-6989586621679122328"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr (ZonkAny 3) -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122325"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#foldl"><span class="hs-pragma hs-type">foldl</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">{-
Note [fold inlining]:

GHC will only inline a function marked INLINE
if it is fully saturated (meaning the number of
arguments provided at the call site is at least
equal to the number of lhs arguments).

-}</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- | 'foldl'' is like 'foldl', but strict in the accumulator.</span><span>
</span><span id="line-547"></span><span class="hs-comment">--</span><span>
</span><span id="line-548"></span><span id="local-6989586621679122341"><span class="annot"><a href="Data.ByteString.html#foldl%27"><span class="hs-identifier hs-type">foldl'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122341"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122341"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122341"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-549"></span><span id="foldl%27"><span class="annot"><span class="annottext">foldl' :: forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldl%27"><span class="hs-identifier hs-var hs-var">foldl'</span></a></span></span><span> </span><span id="local-6989586621679122342"><span class="annot"><span class="annottext">a -&gt; Word8 -&gt; a
</span><a href="#local-6989586621679122342"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122343"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122343"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122344"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122344"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679122345"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122345"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-550"></span><span>          </span><span class="hs-comment">-- see fold inlining</span><span>
</span><span id="line-551"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621679122346"><span class="annot"><span class="annottext">g :: ForeignPtr Word8 -&gt; IO a
</span><a href="#local-6989586621679122346"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679122347"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122347"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ForeignPtr Word8 -&gt; IO a
</span><a href="#local-6989586621679122348"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122343"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122347"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-553"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-554"></span><span>        </span><span id="local-6989586621679122349"><span class="annot"><span class="annottext">end :: ForeignPtr b
</span><a href="#local-6989586621679122349"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122347"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122345"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-555"></span><span>        </span><span class="hs-comment">-- tail recursive; traverses array left to right</span><span>
</span><span id="line-556"></span><span>        </span><span id="local-6989586621679122348"><span class="annot"><span class="annottext">go :: a -&gt; ForeignPtr Word8 -&gt; IO a
</span><a href="#local-6989586621679122348"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122355"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122355"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122356"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122356"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122356"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
forall {b}. ForeignPtr b
</span><a href="#local-6989586621679122349"><span class="hs-identifier hs-var">end</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122355"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-557"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679122357"><span class="annot"><a href="#local-6989586621679122357"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122356"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-558"></span><span>                                  </span><span class="annot"><a href="#local-6989586621679122348"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122342"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122355"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122357"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122356"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-560"></span><span>    </span><span class="annot"><span class="annottext">IO a -&gt; a
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; a) -&gt; IO a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO a
</span><a href="#local-6989586621679122346"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122344"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-561"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#foldl%27"><span class="hs-pragma hs-type">foldl'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span class="hs-comment">-- | 'foldr', applied to a binary operator, a starting value</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- (typically the right-identity of the operator), and a ByteString,</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- reduces the ByteString using the binary operator, from right to left.</span><span>
</span><span id="line-566"></span><span id="local-6989586621679121614"><span class="annot"><a href="Data.ByteString.html#foldr"><span class="hs-identifier hs-type">foldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121614"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121614"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121614"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121614"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-567"></span><span id="foldr"><span class="annot"><span class="annottext">foldr :: forall a. (Word8 -&gt; a -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldr"><span class="hs-identifier hs-var hs-var">foldr</span></a></span></span><span> </span><span id="local-6989586621679122359"><span class="annot"><span class="annottext">Word8 -&gt; a -&gt; a
</span><a href="#local-6989586621679122359"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679122360"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122360"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122361"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122361"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679122362"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122362"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-568"></span><span>          </span><span class="hs-comment">-- see fold inlining</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-570"></span><span>    </span><span id="local-6989586621679122363"><span class="annot"><span class="annottext">ptr :: Ptr Word8
</span><a href="#local-6989586621679122363"><span class="hs-identifier hs-var hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Ptr Word8
forall a. ForeignPtr a -&gt; Ptr a
</span><span class="hs-identifier hs-var">unsafeForeignPtrToPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122361"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-571"></span><span>    </span><span id="local-6989586621679122364"><span class="annot"><span class="annottext">end :: Ptr b
</span><a href="#local-6989586621679122364"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122363"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr b
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122362"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-comment">-- not tail recursive; traverses array left to right</span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621679122366"><span class="annot"><span class="annottext">go :: Ptr Word8 -&gt; a
</span><a href="#local-6989586621679122366"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122367"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122367"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122367"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
forall {b}. Ptr b
</span><a href="#local-6989586621679122364"><span class="hs-identifier hs-var">end</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122360"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-574"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122372"><span class="annot"><span class="annottext">x :: Word8
</span><a href="#local-6989586621679122372"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Word8 -&gt; Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Word8 -&gt; Word8) -&gt; IO Word8 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>                                   </span><span id="local-6989586621679122373"><span class="annot"><a href="#local-6989586621679122373"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122367"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-576"></span><span>                                   </span><span class="annot"><span class="hs-identifier hs-type">touchForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679122361"><span class="hs-identifier hs-type">fp</span></a></span><span>
</span><span id="line-577"></span><span>                                   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679122373"><span class="hs-identifier hs-type">x'</span></a></span><span>
</span><span id="line-578"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; a -&gt; a
</span><a href="#local-6989586621679122359"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122372"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; a
</span><a href="#local-6989586621679122366"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122367"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; a
</span><a href="#local-6989586621679122366"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122363"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-581"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#foldr"><span class="hs-pragma hs-type">foldr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="annot"><span class="hs-comment">-- | 'foldr'' is like 'foldr', but strict in the accumulator.</span></span><span>
</span><span id="line-584"></span><span id="local-6989586621679122374"><span class="annot"><a href="Data.ByteString.html#foldr%27"><span class="hs-identifier hs-type">foldr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122374"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122374"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122374"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122374"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-585"></span><span id="foldr%27"><span class="annot"><span class="annottext">foldr' :: forall a. (Word8 -&gt; a -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldr%27"><span class="hs-identifier hs-var hs-var">foldr'</span></a></span></span><span> </span><span id="local-6989586621679122375"><span class="annot"><span class="annottext">Word8 -&gt; a -&gt; a
</span><a href="#local-6989586621679122375"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679122376"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122376"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122377"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122377"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679122378"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122378"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-586"></span><span>          </span><span class="hs-comment">-- see fold inlining</span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621679122379"><span class="annot"><span class="annottext">g :: ForeignPtr a -&gt; IO a
</span><a href="#local-6989586621679122379"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679122380"><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679122380"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ForeignPtr Word8 -&gt; IO a
</span><a href="#local-6989586621679122381"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122376"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr (ZonkAny 2)
forall {b}. ForeignPtr b
</span><a href="#local-6989586621679122382"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr (ZonkAny 2) -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122378"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-590"></span><span>        </span><span id="local-6989586621679122382"><span class="annot"><span class="annottext">end :: ForeignPtr b
</span><a href="#local-6989586621679122382"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679122380"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr a -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>        </span><span class="hs-comment">-- tail recursive; traverses array right to left</span><span>
</span><span id="line-592"></span><span>        </span><span id="local-6989586621679122381"><span class="annot"><span class="annottext">go :: a -&gt; ForeignPtr Word8 -&gt; IO a
</span><a href="#local-6989586621679122381"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122391"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122391"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122392"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122392"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122392"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
forall {b}. ForeignPtr b
</span><a href="#local-6989586621679122382"><span class="hs-identifier hs-var">end</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122391"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-593"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679122393"><span class="annot"><a href="#local-6989586621679122393"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122392"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-594"></span><span>                                  </span><span class="annot"><a href="#local-6989586621679122381"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122375"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122393"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122391"><span class="hs-identifier hs-type">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122392"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusForeignPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><span class="annottext">IO a -&gt; a
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; a) -&gt; IO a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO a
forall {a}. ForeignPtr a -&gt; IO a
</span><a href="#local-6989586621679122379"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122377"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#foldr%27"><span class="hs-pragma hs-type">foldr'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span class="hs-comment">-- | 'foldl1' is a variant of 'foldl' that has no starting value</span><span>
</span><span id="line-601"></span><span class="hs-comment">-- argument, and thus must be applied to non-empty 'ByteString's.</span><span>
</span><span id="line-602"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-603"></span><span class="annot"><a href="Data.ByteString.html#foldl1"><span class="hs-identifier hs-type">foldl1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-604"></span><span id="foldl1"><span class="annot"><span class="annottext">foldl1 :: HasCallStack =&gt; (Word8 -&gt; Word8 -&gt; Word8) -&gt; ByteString -&gt; Word8
</span><a href="Data.ByteString.html#foldl1"><span class="hs-identifier hs-var hs-var">foldl1</span></a></span></span><span> </span><span id="local-6989586621679122397"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122397"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122398"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122398"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122398"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-605"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;foldl1&quot;</span></span><span>
</span><span id="line-606"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122399"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122399"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122400"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122400"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; Word8
forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldl"><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122397"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122399"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122400"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-607"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#foldl1"><span class="hs-pragma hs-type">foldl1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="hs-comment">-- | 'foldl1'' is like 'foldl1', but strict in the accumulator.</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-611"></span><span class="annot"><a href="Data.ByteString.html#foldl1%27"><span class="hs-identifier hs-type">foldl1'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-612"></span><span id="foldl1%27"><span class="annot"><span class="annottext">foldl1' :: HasCallStack =&gt; (Word8 -&gt; Word8 -&gt; Word8) -&gt; ByteString -&gt; Word8
</span><a href="Data.ByteString.html#foldl1%27"><span class="hs-identifier hs-var hs-var">foldl1'</span></a></span></span><span> </span><span id="local-6989586621679122404"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122404"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122405"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122405"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122405"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-613"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;foldl1'&quot;</span></span><span>
</span><span id="line-614"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122406"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122406"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122407"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122407"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; Word8
forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122404"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122406"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122407"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-615"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#foldl1%27"><span class="hs-pragma hs-type">foldl1'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">-- | 'foldr1' is a variant of 'foldr' that has no starting value argument,</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- and thus must be applied to non-empty 'ByteString's</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-620"></span><span class="annot"><a href="Data.ByteString.html#foldr1"><span class="hs-identifier hs-type">foldr1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-621"></span><span id="foldr1"><span class="annot"><span class="annottext">foldr1 :: HasCallStack =&gt; (Word8 -&gt; Word8 -&gt; Word8) -&gt; ByteString -&gt; Word8
</span><a href="Data.ByteString.html#foldr1"><span class="hs-identifier hs-var hs-var">foldr1</span></a></span></span><span> </span><span id="local-6989586621679122411"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122411"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122412"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122412"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (ByteString, Word8)
</span><a href="Data.ByteString.html#unsnoc"><span class="hs-identifier hs-var">unsnoc</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122412"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-622"></span><span>  </span><span class="annot"><span class="annottext">Maybe (ByteString, Word8)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;foldr1&quot;</span></span><span>
</span><span id="line-623"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122413"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122413"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122414"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122414"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; Word8
forall a. (Word8 -&gt; a -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122411"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122414"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122413"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-624"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#foldr1"><span class="hs-pragma hs-type">foldr1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="hs-comment">-- | 'foldr1'' is a variant of 'foldr1', but is strict in the</span><span>
</span><span id="line-627"></span><span class="hs-comment">-- accumulator.</span><span>
</span><span id="line-628"></span><span class="annot"><a href="Data.ByteString.html#foldr1%27"><span class="hs-identifier hs-type">foldr1'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-629"></span><span id="foldr1%27"><span class="annot"><span class="annottext">foldr1' :: HasCallStack =&gt; (Word8 -&gt; Word8 -&gt; Word8) -&gt; ByteString -&gt; Word8
</span><a href="Data.ByteString.html#foldr1%27"><span class="hs-identifier hs-var hs-var">foldr1'</span></a></span></span><span> </span><span id="local-6989586621679122418"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122418"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122419"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122419"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (ByteString, Word8)
</span><a href="Data.ByteString.html#unsnoc"><span class="hs-identifier hs-var">unsnoc</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122419"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-630"></span><span>  </span><span class="annot"><span class="annottext">Maybe (ByteString, Word8)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;foldr1'&quot;</span></span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122420"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122420"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122421"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122421"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; Word8
forall a. (Word8 -&gt; a -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldr%27"><span class="hs-identifier hs-var">foldr'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122418"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122421"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122420"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-632"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#foldr1%27"><span class="hs-pragma hs-type">foldr1'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- Special folds</span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ Concatenate a list of ByteStrings.</span></span><span>
</span><span id="line-638"></span><span class="annot"><a href="Data.ByteString.html#concat"><span class="hs-identifier hs-type">concat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-639"></span><span id="concat"><span class="annot"><span class="annottext">concat :: [ByteString] -&gt; ByteString
</span><a href="Data.ByteString.html#concat"><span class="hs-identifier hs-var hs-var">concat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="annot"><span class="hs-comment">-- | Map a function over a 'ByteString' and concatenate the results</span></span><span>
</span><span id="line-642"></span><span class="annot"><a href="Data.ByteString.html#concatMap"><span class="hs-identifier hs-type">concatMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-643"></span><span id="concatMap"><span class="annot"><span class="annottext">concatMap :: (Word8 -&gt; ByteString) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#concatMap"><span class="hs-identifier hs-var hs-var">concatMap</span></a></span></span><span> </span><span id="local-6989586621679122422"><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><a href="#local-6989586621679122422"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="Data.ByteString.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; (ByteString -&gt; [ByteString]) -&gt; ByteString -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; [ByteString] -&gt; [ByteString])
-&gt; [ByteString] -&gt; ByteString -&gt; [ByteString]
forall a. (Word8 -&gt; a -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [ByteString] -&gt; [ByteString])
-&gt; (Word8 -&gt; ByteString) -&gt; Word8 -&gt; [ByteString] -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString
</span><a href="#local-6989586621679122422"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span class="hs-comment">-- foldr (append . f) empty</span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span class="hs-comment">-- | /O(n)/ Applied to a predicate and a ByteString, 'any' determines if</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- any element of the 'ByteString' satisfies the predicate.</span><span>
</span><span id="line-649"></span><span class="annot"><a href="Data.ByteString.html#any"><span class="hs-identifier hs-type">any</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-650"></span><span id="any"><span class="annot"><span class="annottext">any :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#any"><span class="hs-identifier hs-var hs-var">any</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-651"></span><span class="annot"><a href="Data.ByteString.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span id="local-6989586621679122423"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122423"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122424"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122424"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122425"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122425"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Bool
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Bool) -&gt; IO Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Bool
</span><a href="#local-6989586621679122426"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122424"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-653"></span><span>    </span><span id="local-6989586621679122426"><span class="annot"><span class="annottext">g :: ForeignPtr Word8 -&gt; IO Bool
</span><a href="#local-6989586621679122426"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679122427"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122427"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Bool
</span><a href="#local-6989586621679122428"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122427"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-654"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-655"></span><span>        </span><span id="local-6989586621679122429"><span class="annot"><span class="annottext">end :: ForeignPtr b
</span><a href="#local-6989586621679122429"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122427"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122425"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-656"></span><span>        </span><span id="local-6989586621679122428"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; IO Bool
</span><a href="#local-6989586621679122428"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122435"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122435"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122435"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
forall {b}. ForeignPtr b
</span><a href="#local-6989586621679122429"><span class="hs-identifier hs-var">end</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-657"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679122436"><span class="annot"><a href="#local-6989586621679122436"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122435"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-658"></span><span>                               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122423"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122436"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-type">True</span></a></span><span>
</span><span id="line-659"></span><span>                                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679122428"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122435"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#any"><span class="hs-pragma hs-type">any</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-663"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise any (x ==)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122437"><span class="annot"><a href="#local-6989586621679122437"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-664"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#any"><span class="hs-pragma hs-type">any</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#anyByte"><span class="hs-pragma hs-type">anyByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122437"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-665"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise any (== x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122439"><span class="annot"><a href="#local-6989586621679122439"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-666"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#any"><span class="hs-pragma hs-type">any</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#anyByte"><span class="hs-pragma hs-type">anyByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122439"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-667"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-668"></span><span>
</span><span id="line-669"></span><span class="annot"><span class="hs-comment">-- | Is any element of 'ByteString' equal to c?</span></span><span>
</span><span id="line-670"></span><span class="annot"><a href="Data.ByteString.html#anyByte"><span class="hs-identifier hs-type">anyByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-671"></span><span id="anyByte"><span class="annot"><span class="annottext">anyByte :: Word8 -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#anyByte"><span class="hs-identifier hs-var hs-var">anyByte</span></a></span></span><span> </span><span id="local-6989586621679122440"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122440"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122441"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122441"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122442"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122442"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Bool
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Bool) -&gt; IO Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122441"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Bool) -&gt; IO Bool)
-&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122443"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122443"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-672"></span><span>    </span><span id="local-6989586621679122444"><span class="annot"><a href="#local-6989586621679122444"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier hs-var">memchr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122443"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122440"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122442"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="#local-6989586621679122444"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-type">/=</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">nullPtr</span></span><span>
</span><span id="line-674"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#anyByte"><span class="hs-pragma hs-type">anyByte</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- | /O(n)/ Applied to a predicate and a 'ByteString', 'all' determines</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- if all elements of the 'ByteString' satisfy the predicate.</span><span>
</span><span id="line-678"></span><span class="annot"><a href="Data.ByteString.html#all"><span class="hs-identifier hs-type">all</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-679"></span><span id="all"><span class="annot"><span class="annottext">all :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#all"><span class="hs-identifier hs-var hs-var">all</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-680"></span><span class="annot"><a href="Data.ByteString.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span id="local-6989586621679122449"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122449"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122450"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122450"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122451"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122451"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Bool
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Bool) -&gt; IO Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Bool
</span><a href="#local-6989586621679122452"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122450"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-681"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621679122452"><span class="annot"><span class="annottext">g :: ForeignPtr Word8 -&gt; IO Bool
</span><a href="#local-6989586621679122452"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679122453"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122453"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Bool
</span><a href="#local-6989586621679122454"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122453"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-683"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-684"></span><span>        </span><span id="local-6989586621679122455"><span class="annot"><span class="annottext">end :: ForeignPtr b
</span><a href="#local-6989586621679122455"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122453"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122451"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-685"></span><span>        </span><span id="local-6989586621679122454"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; IO Bool
</span><a href="#local-6989586621679122454"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122461"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122461"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122461"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
forall {b}. ForeignPtr b
</span><a href="#local-6989586621679122455"><span class="hs-identifier hs-var">end</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>  </span><span class="hs-comment">-- end of list</span><span>
</span><span id="line-686"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679122462"><span class="annot"><a href="#local-6989586621679122462"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122461"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-687"></span><span>                               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122449"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122462"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-688"></span><span>                                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621679122454"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122461"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-type">False</span></a></span><span>
</span><span id="line-690"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#all"><span class="hs-pragma hs-type">all</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-693"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise all (x /=)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122463"><span class="annot"><a href="#local-6989586621679122463"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-694"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#all"><span class="hs-pragma hs-type">all</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">neWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-pragma hs-type">not</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#anyByte"><span class="hs-pragma hs-type">anyByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122463"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-695"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise all (/= x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122465"><span class="annot"><a href="#local-6989586621679122465"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-696"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#all"><span class="hs-pragma hs-type">all</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">neWord8</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-pragma hs-type">not</span></a></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#anyByte"><span class="hs-pragma hs-type">anyByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122465"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span class="hs-comment">-- | /O(n)/ 'maximum' returns the maximum value from a 'ByteString'</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-703"></span><span class="annot"><a href="Data.ByteString.html#maximum"><span class="hs-identifier hs-type">maximum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-704"></span><span id="maximum"><span class="annot"><span class="annottext">maximum :: HasCallStack =&gt; ByteString -&gt; Word8
</span><a href="Data.ByteString.html#maximum"><span class="hs-identifier hs-var hs-var">maximum</span></a></span></span><span> </span><span id="local-6989586621679122471"><span class="annot"><span class="annottext">xs :: ByteString
</span><a href="#local-6989586621679122471"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122472"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122472"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122473"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122473"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122471"><span class="hs-identifier hs-var">xs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;maximum&quot;</span></span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Word8 -&gt; Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Word8 -&gt; Word8) -&gt; IO Word8 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122472"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Word8) -&gt; IO Word8)
-&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122474"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122474"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-707"></span><span>                      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CSize -&gt; IO Word8
</span><a href="Data.ByteString.Internal.Type.html#c_maximum"><span class="hs-identifier hs-var">c_maximum</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122474"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122473"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#maximum"><span class="hs-pragma hs-type">maximum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="hs-comment">-- | /O(n)/ 'minimum' returns the minimum value from a 'ByteString'</span><span>
</span><span id="line-711"></span><span class="hs-comment">-- An exception will be thrown in the case of an empty ByteString.</span><span>
</span><span id="line-712"></span><span class="annot"><a href="Data.ByteString.html#minimum"><span class="hs-identifier hs-type">minimum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-713"></span><span id="minimum"><span class="annot"><span class="annottext">minimum :: HasCallStack =&gt; ByteString -&gt; Word8
</span><a href="Data.ByteString.html#minimum"><span class="hs-identifier hs-var hs-var">minimum</span></a></span></span><span> </span><span id="local-6989586621679122481"><span class="annot"><span class="annottext">xs :: ByteString
</span><a href="#local-6989586621679122481"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122482"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122482"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122483"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122483"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122481"><span class="hs-identifier hs-var">xs</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var">errorEmptyList</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;minimum&quot;</span></span><span>
</span><span id="line-715"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Word8 -&gt; Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Word8 -&gt; Word8) -&gt; IO Word8 -&gt; Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122482"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Word8) -&gt; IO Word8)
-&gt; (Ptr Word8 -&gt; IO Word8) -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122484"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122484"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-716"></span><span>                      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CSize -&gt; IO Word8
</span><a href="Data.ByteString.Internal.Type.html#c_minimum"><span class="hs-identifier hs-var">c_minimum</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122484"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122483"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#minimum"><span class="hs-pragma hs-type">minimum</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span class="hs-comment">-- | The 'mapAccumL' function behaves like a combination of 'map' and</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- 'foldl'; it applies a function to each element of a ByteString,</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- passing an accumulating parameter from left to right, and returning a</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- final value of this accumulator together with the new ByteString.</span><span>
</span><span id="line-725"></span><span id="local-6989586621679121670"><span class="annot"><a href="Data.ByteString.html#mapAccumL"><span class="hs-identifier hs-type">mapAccumL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679121670"><span class="hs-identifier hs-type">acc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679121670"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121670"><span class="hs-identifier hs-type">acc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679121670"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-726"></span><span id="mapAccumL"><span class="annot"><span class="annottext">mapAccumL :: forall acc.
(acc -&gt; Word8 -&gt; (acc, Word8))
-&gt; acc -&gt; ByteString -&gt; (acc, ByteString)
</span><a href="Data.ByteString.html#mapAccumL"><span class="hs-identifier hs-var hs-var">mapAccumL</span></a></span></span><span> </span><span id="local-6989586621679122489"><span class="annot"><span class="annottext">acc -&gt; Word8 -&gt; (acc, Word8)
</span><a href="#local-6989586621679122489"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122490"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122490"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122491"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122491"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679122492"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122492"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO (acc, ByteString) -&gt; (acc, ByteString)
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (acc, ByteString) -&gt; (acc, ByteString))
-&gt; IO (acc, ByteString) -&gt; (acc, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-727"></span><span>               </span><span class="hs-comment">-- see fold inlining</span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621679122494"><span class="annot"><a href="#local-6989586621679122494"><span class="hs-identifier hs-var">gp</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122492"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-729"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-730"></span><span>      </span><span id="local-6989586621679122496"><span class="annot"><a href="#local-6989586621679122496"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679122497"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122497"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679122498"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122498"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">acc -&gt; Int -&gt; IO acc
</span><a href="#local-6989586621679122499"><span class="hs-identifier hs-var">mapAccumL_</span></a></span><span> </span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122490"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-731"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-732"></span><span>          </span><span id="local-6989586621679122499"><span class="annot"><span class="annottext">mapAccumL_ :: acc -&gt; Int -&gt; IO acc
</span><a href="#local-6989586621679122499"><span class="hs-identifier hs-var hs-var">mapAccumL_</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122508"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122508"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122509"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122509"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-733"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122509"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122492"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">acc -&gt; IO acc
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122508"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-734"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-735"></span><span>                  </span><span id="local-6989586621679122510"><span class="annot"><a href="#local-6989586621679122510"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var">peekFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122497"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122509"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-736"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122511"><span class="annot"><a href="#local-6989586621679122511"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122512"><span class="annot"><a href="#local-6989586621679122512"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679122489"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122508"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122510"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-737"></span><span>                  </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-type">pokeFpByteOff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122498"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122509"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122512"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-738"></span><span>                  </span><span class="annot"><a href="#local-6989586621679122499"><span class="hs-identifier hs-type">mapAccumL_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122511"><span class="hs-identifier hs-type">s'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122509"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>    </span><span id="local-6989586621679122513"><span class="annot"><a href="#local-6989586621679122513"><span class="hs-identifier hs-var">acc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679122496"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122491"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122494"><span class="hs-identifier hs-type">gp</span></a></span><span>
</span><span id="line-740"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122513"><span class="hs-identifier hs-type">acc'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122494"><span class="hs-identifier hs-type">gp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122492"><span class="hs-identifier hs-type">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#mapAccumL"><span class="hs-pragma hs-type">mapAccumL</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-742"></span><span>
</span><span id="line-743"></span><span class="hs-comment">-- | The 'mapAccumR' function behaves like a combination of 'map' and</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- 'foldr'; it applies a function to each element of a ByteString,</span><span>
</span><span id="line-745"></span><span class="hs-comment">-- passing an accumulating parameter from right to left, and returning a</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- final value of this accumulator together with the new ByteString.</span><span>
</span><span id="line-747"></span><span id="local-6989586621679122514"><span class="annot"><a href="Data.ByteString.html#mapAccumR"><span class="hs-identifier hs-type">mapAccumR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122514"><span class="hs-identifier hs-type">acc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122514"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679122514"><span class="hs-identifier hs-type">acc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122514"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-748"></span><span id="mapAccumR"><span class="annot"><span class="annottext">mapAccumR :: forall acc.
(acc -&gt; Word8 -&gt; (acc, Word8))
-&gt; acc -&gt; ByteString -&gt; (acc, ByteString)
</span><a href="Data.ByteString.html#mapAccumR"><span class="hs-identifier hs-var hs-var">mapAccumR</span></a></span></span><span> </span><span id="local-6989586621679122518"><span class="annot"><span class="annottext">acc -&gt; Word8 -&gt; (acc, Word8)
</span><a href="#local-6989586621679122518"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122519"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122519"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122520"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122520"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679122521"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122521"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO (acc, ByteString) -&gt; (acc, ByteString)
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (acc, ByteString) -&gt; (acc, ByteString))
-&gt; IO (acc, ByteString) -&gt; (acc, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-749"></span><span>               </span><span class="hs-comment">-- see fold inlining</span><span>
</span><span id="line-750"></span><span>    </span><span id="local-6989586621679122522"><span class="annot"><a href="#local-6989586621679122522"><span class="hs-identifier hs-var">gp</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122521"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-751"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-752"></span><span>      </span><span id="local-6989586621679122525"><span class="annot"><a href="#local-6989586621679122525"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679122526"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122526"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679122527"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122527"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">acc -&gt; Int -&gt; IO acc
</span><a href="#local-6989586621679122528"><span class="hs-identifier hs-var">mapAccumR_</span></a></span><span> </span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122519"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122521"><span class="hs-identifier hs-var">len</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-754"></span><span>          </span><span id="local-6989586621679122528"><span class="annot"><span class="annottext">mapAccumR_ :: acc -&gt; Int -&gt; IO acc
</span><a href="#local-6989586621679122528"><span class="hs-identifier hs-var hs-var">mapAccumR_</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122539"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122539"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">acc -&gt; IO acc
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122539"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-755"></span><span>          </span><span class="annot"><a href="#local-6989586621679122528"><span class="hs-identifier hs-var">mapAccumR_</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122540"><span class="annot"><span class="annottext">acc
</span><a href="#local-6989586621679122540"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122541"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122541"><span class="hs-identifier hs-var">n</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-756"></span><span>              </span><span id="local-6989586621679122542"><span class="annot"><a href="#local-6989586621679122542"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var">peekFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122526"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122541"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-757"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122543"><span class="annot"><a href="#local-6989586621679122543"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122544"><span class="annot"><a href="#local-6989586621679122544"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679122518"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122540"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122542"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-758"></span><span>              </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-type">pokeFpByteOff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122527"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122541"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122544"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-759"></span><span>              </span><span class="annot"><a href="#local-6989586621679122528"><span class="hs-identifier hs-type">mapAccumR_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122543"><span class="hs-identifier hs-type">s'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122541"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>    </span><span id="local-6989586621679122545"><span class="annot"><a href="#local-6989586621679122545"><span class="hs-identifier hs-var">acc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679122525"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122520"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122522"><span class="hs-identifier hs-type">gp</span></a></span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122545"><span class="hs-identifier hs-type">acc'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122522"><span class="hs-identifier hs-type">gp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122521"><span class="hs-identifier hs-type">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#mapAccumR"><span class="hs-pragma hs-type">mapAccumR</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- Building ByteStrings</span><span>
</span><span id="line-766"></span><span>
</span><span id="line-767"></span><span class="hs-comment">-- | 'scanl' is similar to 'foldl', but returns a list of successive</span><span>
</span><span id="line-768"></span><span class="hs-comment">-- reduced values from the left.</span><span>
</span><span id="line-769"></span><span class="hs-comment">--</span><span>
</span><span id="line-770"></span><span class="hs-comment">-- &gt; scanl f z [x1, x2, ...] == [z, z `f` x1, (z `f` x1) `f` x2, ...]</span><span>
</span><span id="line-771"></span><span class="hs-comment">--</span><span>
</span><span id="line-772"></span><span class="hs-comment">-- Note that</span><span>
</span><span id="line-773"></span><span class="hs-comment">--</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- &gt; head (scanl f z xs) == z</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- &gt; last (scanl f z xs) == foldl f z xs</span><span>
</span><span id="line-776"></span><span class="hs-comment">--</span><span>
</span><span id="line-777"></span><span class="annot"><a href="Data.ByteString.html#scanl"><span class="hs-identifier hs-type">scanl</span></a></span><span>
</span><span id="line-778"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ accumulator -&gt; element -&gt; new accumulator</span></span><span>
</span><span id="line-780"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-781"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ starting value of accumulator</span></span><span>
</span><span id="line-782"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-783"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ input of length n</span></span><span>
</span><span id="line-784"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-785"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ output of length n+1</span></span><span>
</span><span id="line-786"></span><span id="scanl"><span class="annot"><span class="annottext">scanl :: (Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#scanl"><span class="hs-identifier hs-var hs-var">scanl</span></a></span></span><span> </span><span id="local-6989586621679122546"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122546"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122547"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122547"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122548"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122548"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679122549"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122549"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var">checkedAdd</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;scanl&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122549"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122550"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122550"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-787"></span><span>         </span><span class="hs-comment">-- see fold inlining</span><span>
</span><span id="line-788"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122550"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122547"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-789"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-790"></span><span>          </span><span id="local-6989586621679122551"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; ForeignPtr b -&gt; IO ()
</span><a href="#local-6989586621679122551"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679122552"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122552"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679122553"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122553"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679122554"><span class="hs-identifier hs-var">scanl_</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122547"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-791"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-792"></span><span>              </span><span id="local-6989586621679122554"><span class="annot"><span class="annottext">scanl_ :: Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679122554"><span class="hs-identifier hs-var hs-var">scanl_</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122563"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122563"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122564"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122564"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-793"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122564"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122549"><span class="hs-identifier hs-var">len</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-795"></span><span>                      </span><span id="local-6989586621679122565"><span class="annot"><a href="#local-6989586621679122565"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var">peekFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122552"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122564"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-796"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122566"><span class="annot"><a href="#local-6989586621679122566"><span class="hs-identifier hs-var hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122546"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122563"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122565"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-797"></span><span>                      </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-type">pokeFpByteOff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122553"><span class="hs-identifier hs-type">dst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122564"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122566"><span class="hs-identifier hs-type">z'</span></a></span><span>
</span><span id="line-798"></span><span>                      </span><span class="annot"><a href="#local-6989586621679122554"><span class="hs-identifier hs-type">scanl_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122566"><span class="hs-identifier hs-type">z'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122564"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr (ZonkAny 1) -&gt; IO ()
forall {b}. ForeignPtr Word8 -&gt; ForeignPtr b -&gt; IO ()
</span><a href="#local-6989586621679122551"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122548"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122550"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr (ZonkAny 1)
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#scanl"><span class="hs-pragma hs-type">scanl</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-801"></span><span>
</span><span id="line-802"></span><span class="hs-comment">-- | 'scanl1' is a variant of 'scanl' that has no starting value argument.</span><span>
</span><span id="line-803"></span><span class="hs-comment">--</span><span>
</span><span id="line-804"></span><span class="hs-comment">-- &gt; scanl1 f [x1, x2, ...] == [x1, x1 `f` x2, ...]</span><span>
</span><span id="line-805"></span><span class="annot"><a href="Data.ByteString.html#scanl1"><span class="hs-identifier hs-type">scanl1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-806"></span><span id="scanl1"><span class="annot"><span class="annottext">scanl1 :: (Word8 -&gt; Word8 -&gt; Word8) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#scanl1"><span class="hs-identifier hs-var hs-var">scanl1</span></a></span></span><span> </span><span id="local-6989586621679122567"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122567"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122568"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122568"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122568"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-807"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-808"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122569"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122569"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122570"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122570"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#scanl"><span class="hs-identifier hs-var">scanl</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122567"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122569"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122570"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-809"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#scanl1"><span class="hs-pragma hs-type">scanl1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span class="hs-comment">-- | 'scanr' is similar to 'foldr', but returns a list of successive</span><span>
</span><span id="line-812"></span><span class="hs-comment">-- reduced values from the right.</span><span>
</span><span id="line-813"></span><span class="hs-comment">--</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- &gt; scanr f z [..., x{n-1}, xn] == [..., x{n-1} `f` (xn `f` z), xn `f` z, z]</span><span>
</span><span id="line-815"></span><span class="hs-comment">--</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- Note that</span><span>
</span><span id="line-817"></span><span class="hs-comment">--</span><span>
</span><span id="line-818"></span><span class="hs-comment">-- &gt; head (scanr f z xs) == foldr f z xs</span><span>
</span><span id="line-819"></span><span class="hs-comment">-- &gt; last (scanr f z xs) == z</span><span>
</span><span id="line-820"></span><span class="hs-comment">--</span><span>
</span><span id="line-821"></span><span class="annot"><a href="Data.ByteString.html#scanr"><span class="hs-identifier hs-type">scanr</span></a></span><span>
</span><span id="line-822"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ element -&gt; accumulator -&gt; new accumulator</span></span><span>
</span><span id="line-824"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-825"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ starting value of accumulator</span></span><span>
</span><span id="line-826"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-827"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ input of length n</span></span><span>
</span><span id="line-828"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-829"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ output of length n+1</span></span><span>
</span><span id="line-830"></span><span id="scanr"><span class="annot"><span class="annottext">scanr :: (Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#scanr"><span class="hs-identifier hs-var hs-var">scanr</span></a></span></span><span> </span><span id="local-6989586621679122571"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122571"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122572"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122572"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122573"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122573"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679122574"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122574"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var">checkedAdd</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;scanr&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122574"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122575"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122575"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-831"></span><span>         </span><span class="hs-comment">-- see fold inlining</span><span>
</span><span id="line-832"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; ForeignPtr b -&gt; Int -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-var">pokeFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122575"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122574"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122572"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-833"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-834"></span><span>          </span><span id="local-6989586621679122578"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; ForeignPtr b -&gt; IO ()
</span><a href="#local-6989586621679122578"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679122579"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122579"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679122580"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122580"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679122581"><span class="hs-identifier hs-var">scanr_</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122572"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122574"><span class="hs-identifier hs-var">len</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-835"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-836"></span><span>              </span><span id="local-6989586621679122581"><span class="annot"><span class="annottext">scanr_ :: Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679122581"><span class="hs-identifier hs-var hs-var">scanr_</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122591"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122591"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122592"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122592"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-837"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122592"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-839"></span><span>                      </span><span id="local-6989586621679122593"><span class="annot"><a href="#local-6989586621679122593"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var">peekFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122579"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122592"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-840"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122594"><span class="annot"><a href="#local-6989586621679122594"><span class="hs-identifier hs-var hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122571"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122593"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122591"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-841"></span><span>                      </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-type">pokeFpByteOff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122580"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122592"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122594"><span class="hs-identifier hs-type">z'</span></a></span><span>
</span><span id="line-842"></span><span>                      </span><span class="annot"><a href="#local-6989586621679122581"><span class="hs-identifier hs-type">scanr_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122594"><span class="hs-identifier hs-type">z'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122592"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO ()
forall {b}. ForeignPtr Word8 -&gt; ForeignPtr b -&gt; IO ()
</span><a href="#local-6989586621679122578"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122573"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122575"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-844"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#scanr"><span class="hs-pragma hs-type">scanr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="annot"><span class="hs-comment">-- | 'scanr1' is a variant of 'scanr' that has no starting value argument.</span></span><span>
</span><span id="line-847"></span><span class="annot"><a href="Data.ByteString.html#scanr1"><span class="hs-identifier hs-type">scanr1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-848"></span><span id="scanr1"><span class="annot"><span class="annottext">scanr1 :: (Word8 -&gt; Word8 -&gt; Word8) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#scanr1"><span class="hs-identifier hs-var hs-var">scanr1</span></a></span></span><span> </span><span id="local-6989586621679122595"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122595"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122596"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122596"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (ByteString, Word8)
</span><a href="Data.ByteString.html#unsnoc"><span class="hs-identifier hs-var">unsnoc</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122596"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-849"></span><span>  </span><span class="annot"><span class="annottext">Maybe (ByteString, Word8)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-850"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122597"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122597"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122598"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122598"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Word8) -&gt; Word8 -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#scanr"><span class="hs-identifier hs-var">scanr</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679122595"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122598"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122597"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-851"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#scanr1"><span class="hs-pragma hs-type">scanr1</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- Unfolds and replicates</span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span class="hs-comment">-- | /O(n)/ 'replicate' @n x@ is a ByteString of length @n@ with @x@</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- the value of every element. The following holds:</span><span>
</span><span id="line-858"></span><span class="hs-comment">--</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- &gt; replicate w c = fst (unfoldrN w (\u -&gt; Just (u,u)) c)</span><span>
</span><span id="line-860"></span><span class="annot"><a href="Data.ByteString.html#replicate"><span class="hs-identifier hs-type">replicate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-861"></span><span id="replicate"><span class="annot"><span class="annottext">replicate :: Int -&gt; Word8 -&gt; ByteString
</span><a href="Data.ByteString.html#replicate"><span class="hs-identifier hs-var hs-var">replicate</span></a></span></span><span> </span><span id="local-6989586621679122599"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122599"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679122600"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122600"><span class="hs-identifier hs-var">c</span></a></span></span><span>
</span><span id="line-862"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122599"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-863"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122599"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122601"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122601"><span class="hs-identifier hs-var">fptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-864"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122601"><span class="hs-identifier hs-var">fptr</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122602"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122602"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-865"></span><span>                      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Word8 -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">fillBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122602"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122600"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122599"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-866"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#replicate"><span class="hs-pragma hs-type">replicate</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span class="hs-comment">-- | /O(n)/, where /n/ is the length of the result.  The 'unfoldr'</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- function is analogous to the List \'unfoldr\'.  'unfoldr' builds a</span><span>
</span><span id="line-870"></span><span class="hs-comment">-- ByteString from a seed value.  The function takes the element and</span><span>
</span><span id="line-871"></span><span class="hs-comment">-- returns 'Nothing' if it is done producing the ByteString or returns</span><span>
</span><span id="line-872"></span><span class="hs-comment">-- 'Just' @(a,b)@, in which case, @a@ is the next byte in the string,</span><span>
</span><span id="line-873"></span><span class="hs-comment">-- and @b@ is the seed value for further production.</span><span>
</span><span id="line-874"></span><span class="hs-comment">--</span><span>
</span><span id="line-875"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-876"></span><span class="hs-comment">--</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- &gt;    unfoldr (\x -&gt; if x &lt;= 5 then Just (x, x + 1) else Nothing) 0</span><span>
</span><span id="line-878"></span><span class="hs-comment">-- &gt; == pack [0, 1, 2, 3, 4, 5]</span><span>
</span><span id="line-879"></span><span class="hs-comment">--</span><span>
</span><span id="line-880"></span><span id="local-6989586621679121679"><span class="annot"><a href="Data.ByteString.html#unfoldr"><span class="hs-identifier hs-type">unfoldr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679121679"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679121679"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121679"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span>
</span><span id="line-881"></span><span id="unfoldr"><span class="annot"><span class="annottext">unfoldr :: forall a. (a -&gt; Maybe (Word8, a)) -&gt; a -&gt; ByteString
</span><a href="Data.ByteString.html#unfoldr"><span class="hs-identifier hs-var hs-var">unfoldr</span></a></span></span><span> </span><span id="local-6989586621679122604"><span class="annot"><span class="annottext">a -&gt; Maybe (Word8, a)
</span><a href="#local-6989586621679122604"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="Data.ByteString.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; ByteString)
-&gt; (a -&gt; [ByteString]) -&gt; a -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; a -&gt; [ByteString]
</span><a href="#local-6989586621679122605"><span class="hs-identifier hs-var">unfoldChunk</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span>
</span><span id="line-882"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679122605"><span class="annot"><span class="annottext">unfoldChunk :: Int -&gt; Int -&gt; a -&gt; [ByteString]
</span><a href="#local-6989586621679122605"><span class="hs-identifier hs-var hs-var">unfoldChunk</span></a></span></span><span> </span><span id="local-6989586621679122607"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122607"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679122608"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122608"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679122609"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122609"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-883"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (a -&gt; Maybe (Word8, a)) -&gt; a -&gt; (ByteString, Maybe a)
forall a.
Int -&gt; (a -&gt; Maybe (Word8, a)) -&gt; a -&gt; (ByteString, Maybe a)
</span><a href="Data.ByteString.html#unfoldrN"><span class="hs-identifier hs-var">unfoldrN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122607"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe (Word8, a)
</span><a href="#local-6989586621679122604"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122609"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-884"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679122610"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122610"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122610"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-885"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679122611"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122611"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679122612"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122612"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122611"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; a -&gt; [ByteString]
</span><a href="#local-6989586621679122605"><span class="hs-identifier hs-var">unfoldChunk</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122608"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122607"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122608"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122612"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-886"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#unfoldr"><span class="hs-pragma hs-type">unfoldr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span class="hs-comment">-- | /O(n)/ Like 'unfoldr', 'unfoldrN' builds a ByteString from a seed</span><span>
</span><span id="line-889"></span><span class="hs-comment">-- value.  However, the length of the result is limited by the first</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- argument to 'unfoldrN'.  This function is more efficient than 'unfoldr'</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- when the maximum length of the result is known.</span><span>
</span><span id="line-892"></span><span class="hs-comment">--</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- The following equation relates 'unfoldrN' and 'unfoldr':</span><span>
</span><span id="line-894"></span><span class="hs-comment">--</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- &gt; fst (unfoldrN n f s) == take n (unfoldr f s)</span><span>
</span><span id="line-896"></span><span class="hs-comment">--</span><span>
</span><span id="line-897"></span><span id="local-6989586621679121681"><span class="annot"><a href="Data.ByteString.html#unfoldrN"><span class="hs-identifier hs-type">unfoldrN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679121681"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679121681"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121681"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679121681"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-898"></span><span id="unfoldrN"><span class="annot"><span class="annottext">unfoldrN :: forall a.
Int -&gt; (a -&gt; Maybe (Word8, a)) -&gt; a -&gt; (ByteString, Maybe a)
</span><a href="Data.ByteString.html#unfoldrN"><span class="hs-identifier hs-var hs-var">unfoldrN</span></a></span></span><span> </span><span id="local-6989586621679122616"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122616"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679122617"><span class="annot"><span class="annottext">a -&gt; Maybe (Word8, a)
</span><a href="#local-6989586621679122617"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122618"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122618"><span class="hs-identifier hs-var">x0</span></a></span></span><span>
</span><span id="line-899"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122616"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122618"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (ByteString, Maybe a) -&gt; (ByteString, Maybe a)
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (ByteString, Maybe a) -&gt; (ByteString, Maybe a))
-&gt; IO (ByteString, Maybe a) -&gt; (ByteString, Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (ForeignPtr Word8 -&gt; IO (Int, Int, Maybe a))
-&gt; IO (ByteString, Maybe a)
forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, Int, a)) -&gt; IO (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim%27"><span class="hs-identifier hs-var">createFpAndTrim'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122616"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO (Int, Int, Maybe a))
 -&gt; IO (ByteString, Maybe a))
-&gt; (ForeignPtr Word8 -&gt; IO (Int, Int, Maybe a))
-&gt; IO (ByteString, Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122620"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122620"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; a -&gt; Int -&gt; IO (Int, Int, Maybe a)
forall {a} {b}.
Num a =&gt;
ForeignPtr b -&gt; a -&gt; Int -&gt; IO (a, Int, Maybe a)
</span><a href="#local-6989586621679122621"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122620"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122618"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-901"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-902"></span><span>    </span><span id="local-6989586621679122621"><span class="annot"><span class="annottext">go :: ForeignPtr b -&gt; a -&gt; Int -&gt; IO (a, Int, Maybe a)
</span><a href="#local-6989586621679122621"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122624"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122624"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122625"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122625"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122626"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122626"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; IO (a, Int, Maybe a)
forall {a}. Num a =&gt; a -&gt; Int -&gt; IO (a, Int, Maybe a)
</span><a href="#local-6989586621679122627"><span class="hs-identifier hs-var">go'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122625"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122626"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-903"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-904"></span><span>        </span><span id="local-6989586621679122627"><span class="annot"><span class="annottext">go' :: a -&gt; Int -&gt; IO (a, Int, Maybe a)
</span><a href="#local-6989586621679122627"><span class="hs-identifier hs-var hs-var">go'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122638"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122638"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122639"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122639"><span class="hs-identifier hs-var">n'</span></a></span></span><span>
</span><span id="line-905"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122639"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122616"><span class="hs-identifier hs-var">i</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Int, Maybe a) -&gt; IO (a, Int, Maybe a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122639"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122638"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe (Word8, a)
</span><a href="#local-6989586621679122617"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122638"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-907"></span><span>                          </span><span class="annot"><span class="annottext">Maybe (Word8, a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, Int, Maybe a) -&gt; IO (a, Int, Maybe a)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122639"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-908"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122640"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122640"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679122641"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122641"><span class="hs-identifier hs-var">x''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">ForeignPtr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; ForeignPtr b -&gt; Int -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-var">pokeFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122624"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122639"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122640"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-909"></span><span>                                             </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; IO (a, Int, Maybe a)
</span><a href="#local-6989586621679122627"><span class="hs-identifier hs-var">go'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679122641"><span class="hs-identifier hs-var">x''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122639"><span class="hs-identifier hs-var">n'</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#unfoldrN"><span class="hs-pragma hs-type">unfoldrN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-911"></span><span>
</span><span id="line-912"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-913"></span><span class="hs-comment">-- Substrings</span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="hs-comment">-- | /O(1)/ 'take' @n@, applied to a ByteString @xs@, returns the prefix</span><span>
</span><span id="line-916"></span><span class="hs-comment">-- of @xs@ of length @n@, or @xs@ itself if @n &gt; 'length' xs@.</span><span>
</span><span id="line-917"></span><span class="annot"><a href="Data.ByteString.html#take"><span class="hs-identifier hs-type">take</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-918"></span><span id="take"><span class="annot"><span class="annottext">take :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#take"><span class="hs-identifier hs-var hs-var">take</span></a></span></span><span> </span><span id="local-6989586621679122642"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122642"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679122643"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122643"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122644"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122644"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122645"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122645"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122642"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-920"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122642"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122645"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122643"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-921"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122644"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122642"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-922"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#take"><span class="hs-pragma hs-type">take</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span class="hs-comment">-- | /O(1)/ @'takeEnd' n xs@ is equivalent to @'drop' ('length' xs - n) xs@.</span><span>
</span><span id="line-925"></span><span class="hs-comment">-- Takes @n@ elements from end of bytestring.</span><span>
</span><span id="line-926"></span><span class="hs-comment">--</span><span>
</span><span id="line-927"></span><span class="hs-comment">-- &gt;&gt;&gt; takeEnd 3 &quot;abcdefg&quot;</span><span>
</span><span id="line-928"></span><span class="hs-comment">-- &quot;efg&quot;</span><span>
</span><span id="line-929"></span><span class="hs-comment">-- &gt;&gt;&gt; takeEnd 0 &quot;abcdefg&quot;</span><span>
</span><span id="line-930"></span><span class="hs-comment">-- &quot;&quot;</span><span>
</span><span id="line-931"></span><span class="hs-comment">-- &gt;&gt;&gt; takeEnd 4 &quot;abc&quot;</span><span>
</span><span id="line-932"></span><span class="hs-comment">-- &quot;abc&quot;</span><span>
</span><span id="line-933"></span><span class="hs-comment">--</span><span>
</span><span id="line-934"></span><span class="hs-comment">-- @since 0.11.1.0</span><span>
</span><span id="line-935"></span><span class="annot"><a href="Data.ByteString.html#takeEnd"><span class="hs-identifier hs-type">takeEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-936"></span><span id="takeEnd"><span class="annot"><span class="annottext">takeEnd :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#takeEnd"><span class="hs-identifier hs-var hs-var">takeEnd</span></a></span></span><span> </span><span id="local-6989586621679122646"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122646"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679122647"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122647"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122648"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122648"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122649"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122649"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122646"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122649"><span class="hs-identifier hs-var">len</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122647"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-938"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122646"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-939"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122648"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122649"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122646"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122646"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-940"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#takeEnd"><span class="hs-pragma hs-type">takeEnd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-941"></span><span>
</span><span id="line-942"></span><span class="hs-comment">-- | /O(1)/ 'drop' @n xs@ returns the suffix of @xs@ after the first @n@</span><span>
</span><span id="line-943"></span><span class="hs-comment">-- elements, or 'empty' if @n &gt; 'length' xs@.</span><span>
</span><span id="line-944"></span><span class="annot"><a href="Data.ByteString.html#drop"><span class="hs-identifier hs-type">drop</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-945"></span><span id="drop"><span class="annot"><span class="annottext">drop :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#drop"><span class="hs-identifier hs-var hs-var">drop</span></a></span></span><span> </span><span id="local-6989586621679122650"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122650"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679122651"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122651"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122652"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122652"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122653"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122653"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-946"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122650"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122651"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-947"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122650"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122653"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-948"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122652"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122650"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122653"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122650"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-949"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#drop"><span class="hs-pragma hs-type">drop</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-950"></span><span>
</span><span id="line-951"></span><span class="hs-comment">-- | /O(1)/ @'dropEnd' n xs@ is equivalent to @'take' ('length' xs - n) xs@.</span><span>
</span><span id="line-952"></span><span class="hs-comment">-- Drops @n@ elements from end of bytestring.</span><span>
</span><span id="line-953"></span><span class="hs-comment">--</span><span>
</span><span id="line-954"></span><span class="hs-comment">-- &gt;&gt;&gt; dropEnd 3 &quot;abcdefg&quot;</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- &quot;abcd&quot;</span><span>
</span><span id="line-956"></span><span class="hs-comment">-- &gt;&gt;&gt; dropEnd 0 &quot;abcdefg&quot;</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- &quot;abcdefg&quot;</span><span>
</span><span id="line-958"></span><span class="hs-comment">-- &gt;&gt;&gt; dropEnd 4 &quot;abc&quot;</span><span>
</span><span id="line-959"></span><span class="hs-comment">-- &quot;&quot;</span><span>
</span><span id="line-960"></span><span class="hs-comment">--</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- @since 0.11.1.0</span><span>
</span><span id="line-962"></span><span class="annot"><a href="Data.ByteString.html#dropEnd"><span class="hs-identifier hs-type">dropEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-963"></span><span id="dropEnd"><span class="annot"><span class="annottext">dropEnd :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#dropEnd"><span class="hs-identifier hs-var hs-var">dropEnd</span></a></span></span><span> </span><span id="local-6989586621679122654"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122654"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679122655"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122655"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122656"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122656"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122657"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122657"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122654"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122655"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-965"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122654"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122657"><span class="hs-identifier hs-var">len</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-966"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122656"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122657"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122654"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-967"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#dropEnd"><span class="hs-pragma hs-type">dropEnd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-968"></span><span>
</span><span id="line-969"></span><span class="annot"><span class="hs-comment">-- | /O(1)/ 'splitAt' @n xs@ is equivalent to @('take' n xs, 'drop' n xs)@.</span></span><span>
</span><span id="line-970"></span><span class="annot"><a href="Data.ByteString.html#splitAt"><span class="hs-identifier hs-type">splitAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span id="splitAt"><span class="annot"><span class="annottext">splitAt :: Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#splitAt"><span class="hs-identifier hs-var hs-var">splitAt</span></a></span></span><span> </span><span id="local-6989586621679122658"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122658"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679122659"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122659"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122660"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122660"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122661"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122661"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122658"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122659"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122658"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122661"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122659"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122660"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122658"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122660"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122658"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122661"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122658"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#splitAt"><span class="hs-pragma hs-type">splitAt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span class="hs-comment">-- | Similar to 'Prelude.takeWhile',</span><span>
</span><span id="line-978"></span><span class="hs-comment">-- returns the longest (possibly empty) prefix of elements</span><span>
</span><span id="line-979"></span><span class="hs-comment">-- satisfying the predicate.</span><span>
</span><span id="line-980"></span><span class="annot"><a href="Data.ByteString.html#takeWhile"><span class="hs-identifier hs-type">takeWhile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-981"></span><span id="takeWhile"><span class="annot"><span class="annottext">takeWhile :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#takeWhile"><span class="hs-identifier hs-var hs-var">takeWhile</span></a></span></span><span> </span><span id="local-6989586621679122662"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122662"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122663"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122663"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#findIndexOrLength"><span class="hs-identifier hs-var">findIndexOrLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Word8 -&gt; Bool) -&gt; Word8 -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122662"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122663"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122663"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-982"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#takeWhile"><span class="hs-pragma hs-type">takeWhile</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-983"></span><span>
</span><span id="line-984"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-985"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise takeWhile (x /=)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122665"><span class="annot"><a href="#local-6989586621679122665"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-986"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#takeWhile"><span class="hs-pragma hs-type">takeWhile</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">neWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fst</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#breakByte"><span class="hs-pragma hs-type">breakByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122665"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-987"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise takeWhile (/= x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122668"><span class="annot"><a href="#local-6989586621679122668"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-988"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#takeWhile"><span class="hs-pragma hs-type">takeWhile</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">neWord8</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fst</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#breakByte"><span class="hs-pragma hs-type">breakByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122668"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-989"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise takeWhile (x ==)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122669"><span class="annot"><a href="#local-6989586621679122669"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-990"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#takeWhile"><span class="hs-pragma hs-type">takeWhile</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fst</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#spanByte"><span class="hs-pragma hs-type">spanByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122669"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-991"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise takeWhile (== x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122671"><span class="annot"><a href="#local-6989586621679122671"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-992"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#takeWhile"><span class="hs-pragma hs-type">takeWhile</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fst</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#spanByte"><span class="hs-pragma hs-type">spanByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122671"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-994"></span><span>
</span><span id="line-995"></span><span class="hs-comment">-- | Returns the longest (possibly empty) suffix of elements</span><span>
</span><span id="line-996"></span><span class="hs-comment">-- satisfying the predicate.</span><span>
</span><span id="line-997"></span><span class="hs-comment">--</span><span>
</span><span id="line-998"></span><span class="hs-comment">-- @'takeWhileEnd' p@ is equivalent to @'reverse' . 'takeWhile' p . 'reverse'@.</span><span>
</span><span id="line-999"></span><span class="hs-comment">--</span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- @since 0.10.12.0</span><span>
</span><span id="line-1001"></span><span class="annot"><a href="Data.ByteString.html#takeWhileEnd"><span class="hs-identifier hs-type">takeWhileEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1002"></span><span id="takeWhileEnd"><span class="annot"><span class="annottext">takeWhileEnd :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#takeWhileEnd"><span class="hs-identifier hs-var hs-var">takeWhileEnd</span></a></span></span><span> </span><span id="local-6989586621679122672"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122672"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122673"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122673"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.html#findFromEndUntil"><span class="hs-identifier hs-var">findFromEndUntil</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Word8 -&gt; Bool) -&gt; Word8 -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122672"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122673"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122673"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1003"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#takeWhileEnd"><span class="hs-pragma hs-type">takeWhileEnd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1004"></span><span>
</span><span id="line-1005"></span><span class="hs-comment">-- | Similar to 'Prelude.dropWhile',</span><span>
</span><span id="line-1006"></span><span class="hs-comment">-- drops the longest (possibly empty) prefix of elements</span><span>
</span><span id="line-1007"></span><span class="hs-comment">-- satisfying the predicate and returns the remainder.</span><span>
</span><span id="line-1008"></span><span class="annot"><a href="Data.ByteString.html#dropWhile"><span class="hs-identifier hs-type">dropWhile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1009"></span><span id="dropWhile"><span class="annot"><span class="annottext">dropWhile :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#dropWhile"><span class="hs-identifier hs-var hs-var">dropWhile</span></a></span></span><span> </span><span id="local-6989586621679122675"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122675"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122676"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122676"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#findIndexOrLength"><span class="hs-identifier hs-var">findIndexOrLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Word8 -&gt; Bool) -&gt; Word8 -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122675"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122676"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122676"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1010"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#dropWhile"><span class="hs-pragma hs-type">dropWhile</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1011"></span><span>
</span><span id="line-1012"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1013"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise dropWhile (x /=)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122677"><span class="annot"><a href="#local-6989586621679122677"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1014"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#dropWhile"><span class="hs-pragma hs-type">dropWhile</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">neWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">snd</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#breakByte"><span class="hs-pragma hs-type">breakByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122677"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1015"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise dropWhile (/= x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122679"><span class="annot"><a href="#local-6989586621679122679"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1016"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#dropWhile"><span class="hs-pragma hs-type">dropWhile</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">neWord8</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">snd</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#breakByte"><span class="hs-pragma hs-type">breakByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122679"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1017"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise dropWhile (x ==)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122680"><span class="annot"><a href="#local-6989586621679122680"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1018"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#dropWhile"><span class="hs-pragma hs-type">dropWhile</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">snd</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#spanByte"><span class="hs-pragma hs-type">spanByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122680"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1019"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise dropWhile (== x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122681"><span class="annot"><a href="#local-6989586621679122681"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1020"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#dropWhile"><span class="hs-pragma hs-type">dropWhile</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><span class="hs-pragma hs-type">snd</span></span><span> </span><span class="annot"><span class="hs-pragma hs-type">.</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#spanByte"><span class="hs-pragma hs-type">spanByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122681"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1021"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span class="hs-comment">-- | Similar to 'Prelude.dropWhileEnd',</span><span>
</span><span id="line-1024"></span><span class="hs-comment">-- drops the longest (possibly empty) suffix of elements</span><span>
</span><span id="line-1025"></span><span class="hs-comment">-- satisfying the predicate and returns the remainder.</span><span>
</span><span id="line-1026"></span><span class="hs-comment">--</span><span>
</span><span id="line-1027"></span><span class="hs-comment">-- @'dropWhileEnd' p@ is equivalent to @'reverse' . 'dropWhile' p . 'reverse'@.</span><span>
</span><span id="line-1028"></span><span class="hs-comment">--</span><span>
</span><span id="line-1029"></span><span class="hs-comment">-- @since 0.10.12.0</span><span>
</span><span id="line-1030"></span><span class="annot"><a href="Data.ByteString.html#dropWhileEnd"><span class="hs-identifier hs-type">dropWhileEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1031"></span><span id="dropWhileEnd"><span class="annot"><span class="annottext">dropWhileEnd :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#dropWhileEnd"><span class="hs-identifier hs-var hs-var">dropWhileEnd</span></a></span></span><span> </span><span id="local-6989586621679122682"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122682"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122683"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122683"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.html#findFromEndUntil"><span class="hs-identifier hs-var">findFromEndUntil</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Word8 -&gt; Bool) -&gt; Word8 -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122682"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122683"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122683"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1032"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#dropWhileEnd"><span class="hs-pragma hs-type">dropWhileEnd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1033"></span><span>
</span><span id="line-1034"></span><span class="hs-comment">-- | Similar to 'Prelude.break',</span><span>
</span><span id="line-1035"></span><span class="hs-comment">-- returns the longest (possibly empty) prefix of elements which __do not__</span><span>
</span><span id="line-1036"></span><span class="hs-comment">-- satisfy the predicate and the remainder of the string.</span><span>
</span><span id="line-1037"></span><span class="hs-comment">--</span><span>
</span><span id="line-1038"></span><span class="hs-comment">-- 'break' @p@ is equivalent to @'span' (not . p)@ and to @('takeWhile' (not . p) &amp;&amp;&amp; 'dropWhile' (not . p))@.</span><span>
</span><span id="line-1039"></span><span class="hs-comment">--</span><span>
</span><span id="line-1040"></span><span class="hs-comment">-- Under GHC, a rewrite rule will transform break (==) into a</span><span>
</span><span id="line-1041"></span><span class="hs-comment">-- call to the specialised breakByte:</span><span>
</span><span id="line-1042"></span><span class="hs-comment">--</span><span>
</span><span id="line-1043"></span><span class="hs-comment">-- &gt; break ((==) x) = breakByte x</span><span>
</span><span id="line-1044"></span><span class="hs-comment">-- &gt; break (==x) = breakByte x</span><span>
</span><span id="line-1045"></span><span class="hs-comment">--</span><span>
</span><span id="line-1046"></span><span class="annot"><a href="Data.ByteString.html#break"><span class="hs-identifier hs-type">break</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1047"></span><span id="break"><span class="annot"><span class="annottext">break :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#break"><span class="hs-identifier hs-var hs-var">break</span></a></span></span><span> </span><span id="local-6989586621679122684"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122684"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679122685"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122685"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#findIndexOrLength"><span class="hs-identifier hs-var">findIndexOrLength</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122684"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122685"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span id="local-6989586621679122686"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122686"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122686"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122685"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122686"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122685"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1048"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#break"><span class="hs-pragma hs-type">break</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- See bytestring #70</span><span>
</span><span id="line-1051"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1052"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise break (x ==)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122687"><span class="annot"><a href="#local-6989586621679122687"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1053"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#break"><span class="hs-pragma hs-type">break</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#breakByte"><span class="hs-pragma hs-type">breakByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122687"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1054"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise break (== x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122688"><span class="annot"><a href="#local-6989586621679122688"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1055"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#break"><span class="hs-pragma hs-type">break</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#breakByte"><span class="hs-pragma hs-type">breakByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122688"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1056"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span class="hs-comment">-- INTERNAL:</span><span>
</span><span id="line-1059"></span><span>
</span><span id="line-1060"></span><span class="hs-comment">-- | 'breakByte' breaks its ByteString argument at the first occurrence</span><span>
</span><span id="line-1061"></span><span class="hs-comment">-- of the specified byte. It is more efficient than 'break' as it is</span><span>
</span><span id="line-1062"></span><span class="hs-comment">-- implemented with @memchr(3)@. I.e.</span><span>
</span><span id="line-1063"></span><span class="hs-comment">--</span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- &gt; break (==99) &quot;abcd&quot; == breakByte 99 &quot;abcd&quot; -- fromEnum 'c' == 99</span><span>
</span><span id="line-1065"></span><span class="hs-comment">--</span><span>
</span><span id="line-1066"></span><span class="annot"><a href="Data.ByteString.html#breakByte"><span class="hs-identifier hs-type">breakByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1067"></span><span id="breakByte"><span class="annot"><span class="annottext">breakByte :: Word8 -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#breakByte"><span class="hs-identifier hs-var hs-var">breakByte</span></a></span></span><span> </span><span id="local-6989586621679122689"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122689"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679122690"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122690"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122689"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122690"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1068"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122690"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1069"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679122691"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122691"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122691"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122690"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122691"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122690"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#breakByte"><span class="hs-pragma hs-type">breakByte</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1071"></span><span>
</span><span id="line-1072"></span><span class="hs-comment">-- | Returns the longest (possibly empty) suffix of elements which __do not__</span><span>
</span><span id="line-1073"></span><span class="hs-comment">-- satisfy the predicate and the remainder of the string.</span><span>
</span><span id="line-1074"></span><span class="hs-comment">--</span><span>
</span><span id="line-1075"></span><span class="hs-comment">-- 'breakEnd' @p@ is equivalent to @'spanEnd' (not . p)@ and to @('dropWhileEnd' (not . p) &amp;&amp;&amp; 'takeWhileEnd' (not . p))@.</span><span>
</span><span id="line-1076"></span><span class="hs-comment">--</span><span>
</span><span id="line-1077"></span><span class="annot"><a href="Data.ByteString.html#breakEnd"><span class="hs-identifier hs-type">breakEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1078"></span><span id="breakEnd"><span class="annot"><span class="annottext">breakEnd :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#breakEnd"><span class="hs-identifier hs-var hs-var">breakEnd</span></a></span></span><span>  </span><span id="local-6989586621679122692"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122692"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679122693"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122693"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.html#findFromEndUntil"><span class="hs-identifier hs-var">findFromEndUntil</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122692"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122693"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122693"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1079"></span><span>
</span><span id="line-1080"></span><span class="hs-comment">-- | Similar to 'Prelude.span',</span><span>
</span><span id="line-1081"></span><span class="hs-comment">-- returns the longest (possibly empty) prefix of elements</span><span>
</span><span id="line-1082"></span><span class="hs-comment">-- satisfying the predicate and the remainder of the string.</span><span>
</span><span id="line-1083"></span><span class="hs-comment">--</span><span>
</span><span id="line-1084"></span><span class="hs-comment">-- 'span' @p@ is equivalent to @'break' (not . p)@ and to @('takeWhile' p &amp;&amp;&amp; 'dropWhile' p)@.</span><span>
</span><span id="line-1085"></span><span class="hs-comment">--</span><span>
</span><span id="line-1086"></span><span class="annot"><a href="Data.ByteString.html#span"><span class="hs-identifier hs-type">span</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1087"></span><span id="span"><span class="annot"><span class="annottext">span :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#span"><span class="hs-identifier hs-var hs-var">span</span></a></span></span><span> </span><span id="local-6989586621679122694"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122694"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#break"><span class="hs-identifier hs-var">break</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Word8 -&gt; Bool) -&gt; Word8 -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122694"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1088"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#span"><span class="hs-pragma hs-type">span</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1089"></span><span>
</span><span id="line-1090"></span><span class="hs-comment">-- | 'spanByte' breaks its ByteString argument at the first</span><span>
</span><span id="line-1091"></span><span class="hs-comment">-- occurrence of a byte other than its argument. It is more efficient</span><span>
</span><span id="line-1092"></span><span class="hs-comment">-- than 'span (==)'</span><span>
</span><span id="line-1093"></span><span class="hs-comment">--</span><span>
</span><span id="line-1094"></span><span class="hs-comment">-- &gt; span  (==99) &quot;abcd&quot; == spanByte 99 &quot;abcd&quot; -- fromEnum 'c' == 99</span><span>
</span><span id="line-1095"></span><span class="hs-comment">--</span><span>
</span><span id="line-1096"></span><span class="annot"><a href="Data.ByteString.html#spanByte"><span class="hs-identifier hs-type">spanByte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1097"></span><span id="spanByte"><span class="annot"><span class="annottext">spanByte :: Word8 -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#spanByte"><span class="hs-identifier hs-var hs-var">spanByte</span></a></span></span><span> </span><span id="local-6989586621679122695"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122695"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679122696"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122696"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122697"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122697"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122698"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122698"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1098"></span><span>    </span><span class="annot"><span class="annottext">IO (ByteString, ByteString) -&gt; (ByteString, ByteString)
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (ByteString, ByteString) -&gt; (ByteString, ByteString))
-&gt; IO (ByteString, ByteString) -&gt; (ByteString, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="annot"><span class="annottext">ForeignPtr Word8
-&gt; (Ptr Word8 -&gt; IO (ByteString, ByteString))
-&gt; IO (ByteString, ByteString)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122697"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO (ByteString, ByteString)
forall {b}. Ptr b -&gt; IO (ByteString, ByteString)
</span><a href="#local-6989586621679122699"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1099"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1100"></span><span>    </span><span id="local-6989586621679122699"><span class="annot"><span class="annottext">g :: Ptr b -&gt; IO (ByteString, ByteString)
</span><a href="#local-6989586621679122699"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679122700"><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679122700"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ByteString, ByteString)
</span><a href="#local-6989586621679122701"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1101"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1102"></span><span>        </span><span id="local-6989586621679122701"><span class="annot"><span class="annottext">go :: Int -&gt; IO (ByteString, ByteString)
</span><a href="#local-6989586621679122701"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122710"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122710"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122710"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122698"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; IO (ByteString, ByteString)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122696"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679122711"><span class="annot"><a href="#local-6989586621679122711"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr b -&gt; Int -&gt; IO Word8
forall b. Ptr b -&gt; Int -&gt; IO Word8
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679122700"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122710"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1104"></span><span>                               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122695"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-type">/=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122711"><span class="hs-identifier hs-type">c'</span></a></span><span>
</span><span id="line-1105"></span><span>                                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-type">unsafeTake</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122710"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122696"><span class="hs-identifier hs-type">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-type">unsafeDrop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122710"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122696"><span class="hs-identifier hs-type">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1106"></span><span>                                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679122701"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122710"><span class="hs-identifier hs-type">i</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1107"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#spanByte"><span class="hs-pragma hs-type">spanByte</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1108"></span><span>
</span><span id="line-1109"></span><span class="hs-comment">-- See bytestring #70</span><span>
</span><span id="line-1110"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1111"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise span (x ==)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122712"><span class="annot"><a href="#local-6989586621679122712"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1112"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#span"><span class="hs-pragma hs-type">span</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span> </span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#spanByte"><span class="hs-pragma hs-type">spanByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122712"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1113"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise span (== x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122713"><span class="annot"><a href="#local-6989586621679122713"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-1114"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#span"><span class="hs-pragma hs-type">span</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span> </span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#spanByte"><span class="hs-pragma hs-type">spanByte</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122713"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1115"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1116"></span><span>
</span><span id="line-1117"></span><span class="hs-comment">-- | Returns the longest (possibly empty) suffix of elements</span><span>
</span><span id="line-1118"></span><span class="hs-comment">-- satisfying the predicate and the remainder of the string.</span><span>
</span><span id="line-1119"></span><span class="hs-comment">--</span><span>
</span><span id="line-1120"></span><span class="hs-comment">-- 'spanEnd' @p@ is equivalent to @'breakEnd' (not . p)@ and to @('dropWhileEnd' p &amp;&amp;&amp; 'takeWhileEnd' p)@.</span><span>
</span><span id="line-1121"></span><span class="hs-comment">--</span><span>
</span><span id="line-1122"></span><span class="hs-comment">-- We have</span><span>
</span><span id="line-1123"></span><span class="hs-comment">--</span><span>
</span><span id="line-1124"></span><span class="hs-comment">-- &gt; spanEnd (not . isSpace) &quot;x y z&quot; == (&quot;x y &quot;, &quot;z&quot;)</span><span>
</span><span id="line-1125"></span><span class="hs-comment">--</span><span>
</span><span id="line-1126"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-1127"></span><span class="hs-comment">--</span><span>
</span><span id="line-1128"></span><span class="hs-comment">-- &gt; spanEnd (not . isSpace) ps</span><span>
</span><span id="line-1129"></span><span class="hs-comment">-- &gt;    ==</span><span>
</span><span id="line-1130"></span><span class="hs-comment">-- &gt; let (x, y) = span (not . isSpace) (reverse ps) in (reverse y, reverse x)</span><span>
</span><span id="line-1131"></span><span class="hs-comment">--</span><span>
</span><span id="line-1132"></span><span class="annot"><a href="Data.ByteString.html#spanEnd"><span class="hs-identifier hs-type">spanEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span id="spanEnd"><span class="annot"><span class="annottext">spanEnd :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#spanEnd"><span class="hs-identifier hs-var hs-var">spanEnd</span></a></span></span><span>  </span><span id="local-6989586621679122714"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122714"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679122715"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122715"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.html#findFromEndUntil"><span class="hs-identifier hs-var">findFromEndUntil</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Word8 -&gt; Bool) -&gt; Word8 -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122714"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122715"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122715"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1134"></span><span>
</span><span id="line-1135"></span><span class="hs-comment">-- | /O(n)/ Splits a 'ByteString' into components delimited by</span><span>
</span><span id="line-1136"></span><span class="hs-comment">-- separators, where the predicate returns True for a separator element.</span><span>
</span><span id="line-1137"></span><span class="hs-comment">-- The resulting components do not contain the separators.  Two adjacent</span><span>
</span><span id="line-1138"></span><span class="hs-comment">-- separators result in an empty component in the output.  eg.</span><span>
</span><span id="line-1139"></span><span class="hs-comment">--</span><span>
</span><span id="line-1140"></span><span class="hs-comment">-- &gt; splitWith (==97) &quot;aabbaca&quot; == [&quot;&quot;,&quot;&quot;,&quot;bb&quot;,&quot;c&quot;,&quot;&quot;] -- fromEnum 'a' == 97</span><span>
</span><span id="line-1141"></span><span class="hs-comment">-- &gt; splitWith undefined &quot;&quot;     == []                  -- and not [&quot;&quot;]</span><span>
</span><span id="line-1142"></span><span class="hs-comment">--</span><span>
</span><span id="line-1143"></span><span class="annot"><a href="Data.ByteString.html#splitWith"><span class="hs-identifier hs-type">splitWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1144"></span><span id="splitWith"><span class="annot"><span class="annottext">splitWith :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#splitWith"><span class="hs-identifier hs-var hs-var">splitWith</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1145"></span><span class="annot"><a href="Data.ByteString.html#splitWith"><span class="hs-identifier hs-var">splitWith</span></a></span><span> </span><span id="local-6989586621679122716"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122716"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122717"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122717"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679122718"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122718"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ForeignPtr Word8 -&gt; [ByteString]
</span><a href="#local-6989586621679122719"><span class="hs-identifier hs-var">splitWith0</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122718"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122717"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-1146"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679122719"><span class="annot"><span class="annottext">splitWith0 :: Int -&gt; Int -&gt; ForeignPtr Word8 -&gt; [ByteString]
</span><a href="#local-6989586621679122719"><span class="hs-identifier hs-var hs-var">splitWith0</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122720"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122720"><span class="hs-identifier hs-var">off'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122721"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122721"><span class="hs-identifier hs-var">len'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122722"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122722"><span class="hs-identifier hs-var">fp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1147"></span><span>          </span><span class="annot"><span class="annottext">IO [ByteString] -&gt; [ByteString]
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [ByteString] -&gt; [ByteString])
-&gt; IO [ByteString] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1148"></span><span>              </span><span class="annot"><span class="annottext">ForeignPtr Word8
-&gt; Int -&gt; Int -&gt; Int -&gt; ForeignPtr Word8 -&gt; IO [ByteString]
</span><a href="#local-6989586621679122723"><span class="hs-identifier hs-var">splitLoop</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122717"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122720"><span class="hs-identifier hs-var">off'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122721"><span class="hs-identifier hs-var">len'</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122722"><span class="hs-identifier hs-var">fp'</span></a></span><span>
</span><span id="line-1149"></span><span>
</span><span id="line-1150"></span><span>        </span><span class="annot"><a href="#local-6989586621679122723"><span class="hs-identifier hs-type">splitLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1151"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1152"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1153"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1154"></span><span>        </span><span id="local-6989586621679122723"><span class="annot"><span class="annottext">splitLoop :: ForeignPtr Word8
-&gt; Int -&gt; Int -&gt; Int -&gt; ForeignPtr Word8 -&gt; IO [ByteString]
</span><a href="#local-6989586621679122723"><span class="hs-identifier hs-var hs-var">splitLoop</span></a></span></span><span> </span><span id="local-6989586621679122724"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122724"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679122725"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122725"><span class="hs-identifier hs-var">idx2</span></a></span></span><span> </span><span id="local-6989586621679122726"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122726"><span class="hs-identifier hs-var">off'</span></a></span></span><span> </span><span id="local-6989586621679122727"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122727"><span class="hs-identifier hs-var">len'</span></a></span></span><span> </span><span id="local-6989586621679122728"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122728"><span class="hs-identifier hs-var">fp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [ByteString]
</span><a href="#local-6989586621679122729"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122725"><span class="hs-identifier hs-var">idx2</span></a></span><span>
</span><span id="line-1155"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1156"></span><span>            </span><span id="local-6989586621679122729"><span class="annot"><span class="annottext">go :: Int -&gt; IO [ByteString]
</span><a href="#local-6989586621679122729"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679122744"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122744"><span class="hs-identifier hs-var">idx'</span></a></span></span><span>
</span><span id="line-1157"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122744"><span class="hs-identifier hs-var">idx'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122727"><span class="hs-identifier hs-var">len'</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; IO [ByteString]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122728"><span class="hs-identifier hs-var">fp'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122726"><span class="hs-identifier hs-var">off'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122744"><span class="hs-identifier hs-var">idx'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1158"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1159"></span><span>                    </span><span id="local-6989586621679122745"><span class="annot"><a href="#local-6989586621679122745"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var">peekFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122724"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122726"><span class="hs-identifier hs-var">off'</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122744"><span class="hs-identifier hs-var">idx'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1160"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122716"><span class="hs-identifier hs-type">predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122745"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-1161"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">plusForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679122728"><span class="hs-identifier hs-type">fp'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122726"><span class="hs-identifier hs-type">off'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679122744"><span class="hs-identifier hs-type">idx'</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span>
</span><span id="line-1162"></span><span>                                  </span><span class="annot"><a href="#local-6989586621679122719"><span class="hs-identifier hs-type">splitWith0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122726"><span class="hs-identifier hs-type">off'</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><a href="#local-6989586621679122744"><span class="hs-identifier hs-type">idx'</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122727"><span class="hs-identifier hs-type">len'</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><a href="#local-6989586621679122744"><span class="hs-identifier hs-type">idx'</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679122728"><span class="hs-identifier hs-type">fp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1163"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679122729"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122744"><span class="hs-identifier hs-type">idx'</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1164"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#splitWith"><span class="hs-pragma hs-type">splitWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1165"></span><span>
</span><span id="line-1166"></span><span class="hs-comment">-- | /O(n)/ Break a 'ByteString' into pieces separated by the byte</span><span>
</span><span id="line-1167"></span><span class="hs-comment">-- argument, consuming the delimiter. I.e.</span><span>
</span><span id="line-1168"></span><span class="hs-comment">--</span><span>
</span><span id="line-1169"></span><span class="hs-comment">-- &gt; split 10  &quot;a\nb\nd\ne&quot; == [&quot;a&quot;,&quot;b&quot;,&quot;d&quot;,&quot;e&quot;]   -- fromEnum '\n' == 10</span><span>
</span><span id="line-1170"></span><span class="hs-comment">-- &gt; split 97  &quot;aXaXaXa&quot;    == [&quot;&quot;,&quot;X&quot;,&quot;X&quot;,&quot;X&quot;,&quot;&quot;] -- fromEnum 'a' == 97</span><span>
</span><span id="line-1171"></span><span class="hs-comment">-- &gt; split 120 &quot;x&quot;          == [&quot;&quot;,&quot;&quot;]             -- fromEnum 'x' == 120</span><span>
</span><span id="line-1172"></span><span class="hs-comment">-- &gt; split undefined &quot;&quot;     == []                  -- and not [&quot;&quot;]</span><span>
</span><span id="line-1173"></span><span class="hs-comment">--</span><span>
</span><span id="line-1174"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-1175"></span><span class="hs-comment">--</span><span>
</span><span id="line-1176"></span><span class="hs-comment">-- &gt; intercalate [c] . split c == id</span><span>
</span><span id="line-1177"></span><span class="hs-comment">-- &gt; split == splitWith . (==)</span><span>
</span><span id="line-1178"></span><span class="hs-comment">--</span><span>
</span><span id="line-1179"></span><span class="hs-comment">-- As for all splitting functions in this library, this function does</span><span>
</span><span id="line-1180"></span><span class="hs-comment">-- not copy the substrings, it just constructs new 'ByteString's that</span><span>
</span><span id="line-1181"></span><span class="hs-comment">-- are slices of the original.</span><span>
</span><span id="line-1182"></span><span class="hs-comment">--</span><span>
</span><span id="line-1183"></span><span class="annot"><a href="Data.ByteString.html#split"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1184"></span><span id="split"><span class="annot"><span class="annottext">split :: Word8 -&gt; ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#split"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1185"></span><span class="annot"><a href="Data.ByteString.html#split"><span class="hs-identifier hs-var">split</span></a></span><span> </span><span id="local-6989586621679122746"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122746"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122747"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122747"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122748"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122748"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [ByteString]
</span><a href="#local-6989586621679122749"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1186"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1187"></span><span>        </span><span id="local-6989586621679122749"><span class="annot"><span class="annottext">loop :: Int -&gt; [ByteString]
</span><a href="#local-6989586621679122749"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122755"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122755"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1188"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122759"><span class="annot"><span class="annottext">q :: Ptr Word8
</span><a href="#local-6989586621679122759"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Ptr Word8) -&gt; Ptr Word8
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Ptr Word8) -&gt; Ptr Word8) -&gt; IO (Ptr Word8) -&gt; Ptr Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; IO (Ptr Word8)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122747"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; IO (Ptr Word8))
-&gt; (Ptr Word8 -&gt; IO (Ptr Word8)) -&gt; IO (Ptr Word8)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122760"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122760"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1189"></span><span>                      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier hs-var">memchr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122760"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122755"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1190"></span><span>                             </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122746"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122748"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122755"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1191"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122759"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
forall {b}. Ptr b
</span><span class="hs-identifier hs-var">nullPtr</span></span><span>
</span><span id="line-1192"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122747"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122755"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122748"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122755"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1193"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122761"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679122761"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122759"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int
forall a b. Ptr a -&gt; Ptr b -&gt; Int
</span><span class="hs-operator hs-var">`minusPtr`</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Ptr Word8
forall a. ForeignPtr a -&gt; Ptr a
</span><span class="hs-identifier hs-var">unsafeForeignPtrToPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122747"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1194"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122747"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122755"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122761"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122755"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [ByteString]
</span><a href="#local-6989586621679122749"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122761"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1195"></span><span>
</span><span id="line-1196"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#split"><span class="hs-pragma hs-type">split</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1197"></span><span>
</span><span id="line-1198"></span><span>
</span><span id="line-1199"></span><span class="hs-comment">-- | The 'group' function takes a ByteString and returns a list of</span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- ByteStrings such that the concatenation of the result is equal to the</span><span>
</span><span id="line-1201"></span><span class="hs-comment">-- argument.  Moreover, each string in the result contains only equal</span><span>
</span><span id="line-1202"></span><span class="hs-comment">-- elements.  For example,</span><span>
</span><span id="line-1203"></span><span class="hs-comment">--</span><span>
</span><span id="line-1204"></span><span class="hs-comment">-- &gt; group &quot;Mississippi&quot; = [&quot;M&quot;,&quot;i&quot;,&quot;ss&quot;,&quot;i&quot;,&quot;ss&quot;,&quot;i&quot;,&quot;pp&quot;,&quot;i&quot;]</span><span>
</span><span id="line-1205"></span><span class="hs-comment">--</span><span>
</span><span id="line-1206"></span><span class="hs-comment">-- It is a special case of 'groupBy', which allows the programmer to</span><span>
</span><span id="line-1207"></span><span class="hs-comment">-- supply their own equality test. It is about 40% faster than</span><span>
</span><span id="line-1208"></span><span class="hs-comment">-- /groupBy (==)/</span><span>
</span><span id="line-1209"></span><span class="annot"><a href="Data.ByteString.html#group"><span class="hs-identifier hs-type">group</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1210"></span><span id="group"><span class="annot"><span class="annottext">group :: ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#group"><span class="hs-identifier hs-var hs-var">group</span></a></span></span><span> </span><span id="local-6989586621679122763"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122763"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122763"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1211"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1212"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122764"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122764"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122765"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#group"><span class="hs-identifier hs-var">group</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122766"><span class="hs-identifier hs-var">zs</span></a></span><span>
</span><span id="line-1213"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1214"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679122765"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122765"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122766"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122766"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#spanByte"><span class="hs-identifier hs-var">spanByte</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122764"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122763"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1215"></span><span>
</span><span id="line-1216"></span><span class="annot"><span class="hs-comment">-- | The 'groupBy' function is the non-overloaded version of 'group'.</span></span><span>
</span><span id="line-1217"></span><span class="annot"><a href="Data.ByteString.html#groupBy"><span class="hs-identifier hs-type">groupBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1218"></span><span id="groupBy"><span class="annot"><span class="annottext">groupBy :: (Word8 -&gt; Word8 -&gt; Bool) -&gt; ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#groupBy"><span class="hs-identifier hs-var hs-var">groupBy</span></a></span></span><span> </span><span id="local-6989586621679122767"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
</span><a href="#local-6989586621679122767"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679122768"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122768"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122768"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1219"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1220"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679122769"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122769"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679122770"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122770"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122771"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122768"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; Bool) -&gt; ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
</span><a href="#local-6989586621679122767"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122771"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122768"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1222"></span><span>        </span><span id="local-6989586621679122771"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679122771"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#findIndexOrLength"><span class="hs-identifier hs-var">findIndexOrLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Word8 -&gt; Bool) -&gt; Word8 -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
</span><a href="#local-6989586621679122767"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122769"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122770"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1223"></span><span>
</span><span id="line-1224"></span><span class="hs-comment">-- | /O(n)/ The 'intercalate' function takes a 'ByteString' and a list of</span><span>
</span><span id="line-1225"></span><span class="hs-comment">-- 'ByteString's and concatenates the list after interspersing the first</span><span>
</span><span id="line-1226"></span><span class="hs-comment">-- argument between each element of the list.</span><span>
</span><span id="line-1227"></span><span class="annot"><a href="Data.ByteString.html#intercalate"><span class="hs-identifier hs-type">intercalate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1228"></span><span id="intercalate"><span class="annot"><span class="annottext">intercalate :: ByteString -&gt; [ByteString] -&gt; ByteString
</span><a href="Data.ByteString.html#intercalate"><span class="hs-identifier hs-var hs-var">intercalate</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1229"></span><span class="annot"><a href="Data.ByteString.html#intercalate"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679122774"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122774"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122774"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- This branch exists for laziness, not speed</span><span>
</span><span id="line-1230"></span><span class="annot"><a href="Data.ByteString.html#intercalate"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122775"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122775"><span class="hs-identifier hs-var">sepPtr</span></a></span></span><span> </span><span id="local-6989586621679122776"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122776"><span class="hs-identifier hs-var">sepLen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122777"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122777"><span class="hs-identifier hs-var">hPtr</span></a></span></span><span> </span><span id="local-6989586621679122778"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122778"><span class="hs-identifier hs-var">hLen</span></a></span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679122779"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679122779"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1231"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122780"><span class="hs-identifier hs-var">totalLen</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122781"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122781"><span class="hs-identifier hs-var">dstPtr0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1232"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122781"><span class="hs-identifier hs-var">dstPtr0</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122777"><span class="hs-identifier hs-var">hPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122778"><span class="hs-identifier hs-var">hLen</span></a></span><span>
</span><span id="line-1233"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122785"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; [ByteString] -&gt; IO ()
</span><a href="#local-6989586621679122785"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1234"></span><span>          </span><span class="annot"><a href="#local-6989586621679122785"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679122786"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122786"><span class="hs-identifier hs-var">dstPtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122787"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122787"><span class="hs-identifier hs-var">chunkPtr</span></a></span></span><span> </span><span id="local-6989586621679122788"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122788"><span class="hs-identifier hs-var">chunkLen</span></a></span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679122789"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679122789"><span class="hs-identifier hs-var">chunks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1235"></span><span>            </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122786"><span class="hs-identifier hs-var">dstPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122775"><span class="hs-identifier hs-var">sepPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122776"><span class="hs-identifier hs-var">sepLen</span></a></span><span>
</span><span id="line-1236"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122790"><span class="annot"><span class="annottext">destPtr' :: ForeignPtr b
</span><a href="#local-6989586621679122790"><span class="hs-identifier hs-var hs-var hs-var">destPtr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122786"><span class="hs-identifier hs-var">dstPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122776"><span class="hs-identifier hs-var">sepLen</span></a></span><span>
</span><span id="line-1237"></span><span>            </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
forall {b}. ForeignPtr b
</span><a href="#local-6989586621679122790"><span class="hs-identifier hs-var">destPtr'</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122787"><span class="hs-identifier hs-var">chunkPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122788"><span class="hs-identifier hs-var">chunkLen</span></a></span><span>
</span><span id="line-1238"></span><span>            </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; [ByteString] -&gt; IO ()
</span><a href="#local-6989586621679122785"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr (ZonkAny 4)
forall {b}. ForeignPtr b
</span><a href="#local-6989586621679122790"><span class="hs-identifier hs-var">destPtr'</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr (ZonkAny 4) -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122788"><span class="hs-identifier hs-var">chunkLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679122789"><span class="hs-identifier hs-var">chunks</span></a></span><span>
</span><span id="line-1239"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; [ByteString] -&gt; IO ()
</span><a href="#local-6989586621679122785"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122781"><span class="hs-identifier hs-var">dstPtr0</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122778"><span class="hs-identifier hs-var">hLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679122779"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1240"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1241"></span><span>  </span><span id="local-6989586621679122780"><span class="annot"><span class="annottext">totalLen :: Int
</span><a href="#local-6989586621679122780"><span class="hs-identifier hs-var hs-var">totalLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ByteString -&gt; Int) -&gt; Int -&gt; [ByteString] -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">List.foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679122794"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122794"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679122795"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122795"><span class="hs-identifier hs-var">chunk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122794"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679122796"><span class="hs-operator hs-var">+!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122776"><span class="hs-identifier hs-var">sepLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679122796"><span class="hs-operator hs-var">+!</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122795"><span class="hs-identifier hs-var">chunk</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122778"><span class="hs-identifier hs-var">hLen</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679122779"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1242"></span><span>  </span><span id="local-6989586621679122796"><span class="annot"><span class="annottext">+! :: Int -&gt; Int -&gt; Int
</span><a href="#local-6989586621679122796"><span class="hs-operator hs-var hs-var">(+!)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var">checkedAdd</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;intercalate&quot;</span></span><span>
</span><span id="line-1243"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.html#intercalate"><span class="hs-pragma hs-type">intercalate</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1244"></span><span>
</span><span id="line-1245"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1246"></span><span class="hs-comment">-- Indexing ByteStrings</span><span>
</span><span id="line-1247"></span><span>
</span><span id="line-1248"></span><span class="hs-comment">-- | /O(1)/ 'ByteString' index (subscript) operator, starting from 0.</span><span>
</span><span id="line-1249"></span><span class="hs-comment">--</span><span>
</span><span id="line-1250"></span><span class="hs-comment">-- This is a partial function, consider using 'indexMaybe' instead.</span><span>
</span><span id="line-1251"></span><span class="annot"><a href="Data.ByteString.html#index"><span class="hs-identifier hs-type">index</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1252"></span><span id="index"><span class="annot"><span class="annottext">index :: HasCallStack =&gt; ByteString -&gt; Int -&gt; Word8
</span><a href="Data.ByteString.html#index"><span class="hs-identifier hs-var hs-var">index</span></a></span></span><span> </span><span id="local-6989586621679122808"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122808"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679122809"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122809"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-1253"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122809"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#moduleError"><span class="hs-identifier hs-var">moduleError</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;index&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;negative index: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122809"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1254"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122809"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122808"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Word8
forall a. HasCallStack =&gt; FilePath -&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#moduleError"><span class="hs-identifier hs-var">moduleError</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;index&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;index too large: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122809"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1255"></span><span>                                         </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;, length = &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122808"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1256"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122808"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><a href="Data.ByteString.Unsafe.html#unsafeIndex"><span class="hs-operator hs-var">`unsafeIndex`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122809"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1257"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#index"><span class="hs-pragma hs-type">index</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1258"></span><span>
</span><span id="line-1259"></span><span class="hs-comment">-- | /O(1)/ 'ByteString' index, starting from 0, that returns 'Just' if:</span><span>
</span><span id="line-1260"></span><span class="hs-comment">--</span><span>
</span><span id="line-1261"></span><span class="hs-comment">-- &gt; 0 &lt;= n &lt; length bs</span><span>
</span><span id="line-1262"></span><span class="hs-comment">--</span><span>
</span><span id="line-1263"></span><span class="hs-comment">-- @since 0.11.0.0</span><span>
</span><span id="line-1264"></span><span class="annot"><a href="Data.ByteString.html#indexMaybe"><span class="hs-identifier hs-type">indexMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1265"></span><span id="indexMaybe"><span class="annot"><span class="annottext">indexMaybe :: ByteString -&gt; Int -&gt; Maybe Word8
</span><a href="Data.ByteString.html#indexMaybe"><span class="hs-identifier hs-var hs-var">indexMaybe</span></a></span></span><span> </span><span id="local-6989586621679122813"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122813"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679122814"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122814"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-1266"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122814"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1267"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122814"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122813"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1268"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Maybe Word8) -&gt; Word8 -&gt; Maybe Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122813"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><a href="Data.ByteString.Unsafe.html#unsafeIndex"><span class="hs-operator hs-var">`unsafeIndex`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122814"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1269"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#indexMaybe"><span class="hs-pragma hs-type">indexMaybe</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1270"></span><span>
</span><span id="line-1271"></span><span class="hs-comment">-- | /O(1)/ 'ByteString' index, starting from 0, that returns 'Just' if:</span><span>
</span><span id="line-1272"></span><span class="hs-comment">--</span><span>
</span><span id="line-1273"></span><span class="hs-comment">-- &gt; 0 &lt;= n &lt; length bs</span><span>
</span><span id="line-1274"></span><span class="hs-comment">--</span><span>
</span><span id="line-1275"></span><span class="hs-comment">-- @since 0.11.0.0</span><span>
</span><span id="line-1276"></span><span class="annot"><a href="Data.ByteString.html#%21%3F"><span class="hs-operator hs-type">(!?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1277"></span><span id="%21%3F"><span class="annot"><span class="annottext">!? :: ByteString -&gt; Int -&gt; Maybe Word8
</span><a href="Data.ByteString.html#%21%3F"><span class="hs-operator hs-var hs-var">(!?)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Maybe Word8
</span><a href="Data.ByteString.html#indexMaybe"><span class="hs-identifier hs-var">indexMaybe</span></a></span><span>
</span><span id="line-1278"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">!?</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- | /O(n)/ The 'elemIndex' function returns the index of the first</span><span>
</span><span id="line-1281"></span><span class="hs-comment">-- element in the given 'ByteString' which is equal to the query</span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- element, or 'Nothing' if there is no such element.</span><span>
</span><span id="line-1283"></span><span class="hs-comment">-- This implementation uses memchr(3).</span><span>
</span><span id="line-1284"></span><span class="annot"><a href="Data.ByteString.html#elemIndex"><span class="hs-identifier hs-type">elemIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1285"></span><span id="elemIndex"><span class="annot"><span class="annottext">elemIndex :: Word8 -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#elemIndex"><span class="hs-identifier hs-var hs-var">elemIndex</span></a></span></span><span> </span><span id="local-6989586621679122815"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122815"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122816"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122816"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122817"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122817"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Int) -&gt; Maybe Int
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Int) -&gt; Maybe Int) -&gt; IO (Maybe Int) -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO (Maybe Int)) -&gt; IO (Maybe Int)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122816"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO (Maybe Int)) -&gt; IO (Maybe Int))
-&gt; (Ptr Word8 -&gt; IO (Maybe Int)) -&gt; IO (Maybe Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122818"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122818"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1286"></span><span>    </span><span id="local-6989586621679122819"><span class="annot"><a href="#local-6989586621679122819"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier hs-var">memchr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122818"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122815"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122817"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1287"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122819"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">nullPtr</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="#local-6989586621679122819"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`minusPtr`</span></span><span> </span><span class="annot"><a href="#local-6989586621679122818"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-1288"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#elemIndex"><span class="hs-pragma hs-type">elemIndex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span class="hs-comment">-- | /O(n)/ The 'elemIndexEnd' function returns the last index of the</span><span>
</span><span id="line-1291"></span><span class="hs-comment">-- element in the given 'ByteString' which is equal to the query</span><span>
</span><span id="line-1292"></span><span class="hs-comment">-- element, or 'Nothing' if there is no such element. The following</span><span>
</span><span id="line-1293"></span><span class="hs-comment">-- holds:</span><span>
</span><span id="line-1294"></span><span class="hs-comment">--</span><span>
</span><span id="line-1295"></span><span class="hs-comment">-- &gt; elemIndexEnd c xs = case elemIndex c (reverse xs) of</span><span>
</span><span id="line-1296"></span><span class="hs-comment">-- &gt;   Nothing -&gt; Nothing</span><span>
</span><span id="line-1297"></span><span class="hs-comment">-- &gt;   Just i  -&gt; Just (length xs - 1 - i)</span><span>
</span><span id="line-1298"></span><span class="hs-comment">--</span><span>
</span><span id="line-1299"></span><span class="annot"><a href="Data.ByteString.html#elemIndexEnd"><span class="hs-identifier hs-type">elemIndexEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1300"></span><span id="elemIndexEnd"><span class="annot"><span class="annottext">elemIndexEnd :: Word8 -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#elemIndexEnd"><span class="hs-identifier hs-var hs-var">elemIndexEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#findIndexEnd"><span class="hs-identifier hs-var">findIndexEnd</span></a></span><span> </span><span class="annot"><span class="annottext">((Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Int)
-&gt; (Word8 -&gt; Word8 -&gt; Bool) -&gt; Word8 -&gt; ByteString -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">(==)</span></a></span><span>
</span><span id="line-1301"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#elemIndexEnd"><span class="hs-pragma hs-type">elemIndexEnd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1302"></span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- | /O(n)/ The 'elemIndices' function extends 'elemIndex', by returning</span><span>
</span><span id="line-1304"></span><span class="hs-comment">-- the indices of all elements equal to the query element, in ascending order.</span><span>
</span><span id="line-1305"></span><span class="hs-comment">-- This implementation uses memchr(3).</span><span>
</span><span id="line-1306"></span><span class="annot"><a href="Data.ByteString.html#elemIndices"><span class="hs-identifier hs-type">elemIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1307"></span><span id="elemIndices"><span class="annot"><span class="annottext">elemIndices :: Word8 -&gt; ByteString -&gt; [Int]
</span><a href="Data.ByteString.html#elemIndices"><span class="hs-identifier hs-var hs-var">elemIndices</span></a></span></span><span> </span><span id="local-6989586621679122820"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122820"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122821"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122821"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122822"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122822"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int]
</span><a href="#local-6989586621679122823"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1308"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1309"></span><span>        </span><span id="local-6989586621679122823"><span class="annot"><span class="annottext">loop :: Int -&gt; [Int]
</span><a href="#local-6989586621679122823"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122833"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122833"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [Int] -&gt; [Int]
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Int] -&gt; [Int]) -&gt; IO [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO [Int]) -&gt; IO [Int]
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122821"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO [Int]) -&gt; IO [Int])
-&gt; (Ptr Word8 -&gt; IO [Int]) -&gt; IO [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122834"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122834"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1310"></span><span>            </span><span id="local-6989586621679122835"><span class="annot"><a href="#local-6989586621679122835"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier hs-var">memchr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122834"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122833"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122820"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122822"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122833"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1311"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122835"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">nullPtr</span></span><span>
</span><span id="line-1312"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1313"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122836"><span class="annot"><a href="#local-6989586621679122836"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122835"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int
forall a b. Ptr a -&gt; Ptr b -&gt; Int
</span><span class="hs-operator hs-var">`minusPtr`</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122834"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1314"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679122836"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122823"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122836"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1315"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#elemIndices"><span class="hs-pragma hs-type">elemIndices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1316"></span><span>
</span><span id="line-1317"></span><span class="hs-comment">-- | count returns the number of times its argument appears in the ByteString</span><span>
</span><span id="line-1318"></span><span class="hs-comment">--</span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- &gt; count = length . elemIndices</span><span>
</span><span id="line-1320"></span><span class="hs-comment">--</span><span>
</span><span id="line-1321"></span><span class="hs-comment">-- But more efficiently than using length on the intermediate list.</span><span>
</span><span id="line-1322"></span><span class="annot"><a href="Data.ByteString.html#count"><span class="hs-identifier hs-type">count</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1323"></span><span id="count"><span class="annot"><span class="annottext">count :: Word8 -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.html#count"><span class="hs-identifier hs-var hs-var">count</span></a></span></span><span> </span><span id="local-6989586621679122837"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122837"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122838"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122838"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122839"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122839"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Int -&gt; Int
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; Int) -&gt; IO Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122838"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Int) -&gt; IO Int)
-&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122840"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122840"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1324"></span><span>    </span><span class="annot"><span class="annottext">CSize -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(CSize -&gt; Int) -&gt; IO CSize -&gt; IO Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CSize -&gt; Word8 -&gt; IO CSize
</span><a href="Data.ByteString.Internal.Type.html#c_count"><span class="hs-identifier hs-var">c_count</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122840"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122839"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122837"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1325"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#count"><span class="hs-pragma hs-type">count</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1326"></span><span>
</span><span id="line-1327"></span><span class="hs-comment">-- | /O(n)/ The 'findIndex' function takes a predicate and a 'ByteString' and</span><span>
</span><span id="line-1328"></span><span class="hs-comment">-- returns the index of the first element in the ByteString</span><span>
</span><span id="line-1329"></span><span class="hs-comment">-- satisfying the predicate.</span><span>
</span><span id="line-1330"></span><span class="annot"><a href="Data.ByteString.html#findIndex"><span class="hs-identifier hs-type">findIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1331"></span><span id="findIndex"><span class="annot"><span class="annottext">findIndex :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#findIndex"><span class="hs-identifier hs-var hs-var">findIndex</span></a></span></span><span> </span><span id="local-6989586621679122843"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122843"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122844"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122844"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122845"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122845"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Int) -&gt; Maybe Int
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Int) -&gt; Maybe Int) -&gt; IO (Maybe Int) -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (Maybe Int)
forall {a}. ForeignPtr a -&gt; IO (Maybe Int)
</span><a href="#local-6989586621679122846"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122844"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1332"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1333"></span><span>    </span><span id="local-6989586621679122846"><span class="annot"><span class="annottext">g :: ForeignPtr a -&gt; IO (Maybe Int)
</span><a href="#local-6989586621679122846"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122847"><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679122847"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Maybe Int)
</span><a href="#local-6989586621679122848"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1334"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1335"></span><span>        </span><span id="local-6989586621679122848"><span class="annot"><span class="annottext">go :: Int -&gt; IO (Maybe Int)
</span><a href="#local-6989586621679122848"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122856"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122856"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122856"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122845"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; IO (Maybe Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1336"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679122857"><span class="annot"><a href="#local-6989586621679122857"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">(ForeignPtr Word8 -&gt; IO Word8) -&gt; ForeignPtr Word8 -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679122847"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr a -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122856"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1337"></span><span>                               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122843"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122857"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-1338"></span><span>                                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679122856"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1339"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679122848"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122856"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1340"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#findIndex"><span class="hs-pragma hs-type">findIndex</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1341"></span><span>
</span><span id="line-1342"></span><span class="hs-comment">-- | /O(n)/ The 'findIndexEnd' function takes a predicate and a 'ByteString' and</span><span>
</span><span id="line-1343"></span><span class="hs-comment">-- returns the index of the last element in the ByteString</span><span>
</span><span id="line-1344"></span><span class="hs-comment">-- satisfying the predicate.</span><span>
</span><span id="line-1345"></span><span class="hs-comment">--</span><span>
</span><span id="line-1346"></span><span class="hs-comment">-- @since 0.10.12.0</span><span>
</span><span id="line-1347"></span><span class="annot"><a href="Data.ByteString.html#findIndexEnd"><span class="hs-identifier hs-type">findIndexEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1348"></span><span id="findIndexEnd"><span class="annot"><span class="annottext">findIndexEnd :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#findIndexEnd"><span class="hs-identifier hs-var hs-var">findIndexEnd</span></a></span></span><span> </span><span id="local-6989586621679122858"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122858"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122859"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122859"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679122860"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122860"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Int) -&gt; Maybe Int
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Int) -&gt; Maybe Int) -&gt; IO (Maybe Int) -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (Maybe Int)
</span><a href="#local-6989586621679122861"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122859"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1349"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1350"></span><span>    </span><span id="local-6989586621679122861"><span class="annot"><span class="annottext">g :: ForeignPtr Word8 -&gt; IO (Maybe Int)
</span><a href="#local-6989586621679122861"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122864"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122864"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Maybe Int)
</span><a href="#local-6989586621679122865"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122860"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1351"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1352"></span><span>        </span><span id="local-6989586621679122865"><span class="annot"><span class="annottext">go :: Int -&gt; IO (Maybe Int)
</span><a href="#local-6989586621679122865"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122874"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122874"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122874"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; IO (Maybe Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1353"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679122875"><span class="annot"><a href="#local-6989586621679122875"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var">peekFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122864"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122874"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1354"></span><span>                               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122858"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122875"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-1355"></span><span>                                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621679122874"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1356"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679122865"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122874"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1357"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#findIndexEnd"><span class="hs-pragma hs-type">findIndexEnd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1358"></span><span>
</span><span id="line-1359"></span><span class="hs-comment">-- | /O(n)/ The 'findIndices' function extends 'findIndex', by returning the</span><span>
</span><span id="line-1360"></span><span class="hs-comment">-- indices of all elements satisfying the predicate, in ascending order.</span><span>
</span><span id="line-1361"></span><span class="annot"><a href="Data.ByteString.html#findIndices"><span class="hs-identifier hs-type">findIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1362"></span><span id="findIndices"><span class="annot"><span class="annottext">findIndices :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; [Int]
</span><a href="Data.ByteString.html#findIndices"><span class="hs-identifier hs-var hs-var">findIndices</span></a></span></span><span> </span><span id="local-6989586621679122876"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122876"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; [Int]
</span><a href="#local-6989586621679122877"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1363"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-1364"></span><span>     </span><span id="local-6989586621679122877"><span class="annot"><span class="annottext">loop :: Int -&gt; ByteString -&gt; [Int]
</span><a href="#local-6989586621679122877"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122882"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122882"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122883"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122883"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#findIndex"><span class="hs-identifier hs-var">findIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122876"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122883"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1365"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122884"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122884"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1366"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122886"><span class="annot"><span class="annottext">j :: Int
</span><a href="#local-6989586621679122886"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122882"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122884"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1367"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122886"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; [Int]
</span><a href="#local-6989586621679122877"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122886"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122884"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122883"><span class="hs-identifier hs-var">qs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1368"></span><span>                     </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1369"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#findIndices"><span class="hs-pragma hs-type">findIndices</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1370"></span><span>
</span><span id="line-1371"></span><span>
</span><span id="line-1372"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-1373"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise findIndex (x ==)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122887"><span class="annot"><a href="#local-6989586621679122887"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.ByteString.html#findIndex"><span class="hs-pragma hs-type">findIndex</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#elemIndex"><span class="hs-pragma hs-type">elemIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122887"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1374"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise findIndex (== x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122888"><span class="annot"><a href="#local-6989586621679122888"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.ByteString.html#findIndex"><span class="hs-pragma hs-type">findIndex</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#elemIndex"><span class="hs-pragma hs-type">elemIndex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122888"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1375"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise findIndices (x ==)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122889"><span class="annot"><a href="#local-6989586621679122889"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.ByteString.html#findIndices"><span class="hs-pragma hs-type">findIndices</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">x</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#elemIndices"><span class="hs-pragma hs-type">elemIndices</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122889"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1376"></span><span class="annot"><span class="hs-pragma">&quot;ByteString specialise findIndices (== x)&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679122890"><span class="annot"><a href="#local-6989586621679122890"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span> </span><span class="annot"><a href="Data.ByteString.html#findIndices"><span class="hs-pragma hs-type">findIndices</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">`</span><span class="hs-pragma">eqWord8</span><span class="hs-pragma">`</span><span class="hs-pragma">x</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.html#elemIndices"><span class="hs-pragma hs-type">elemIndices</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122890"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-1377"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1378"></span><span>
</span><span id="line-1379"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1380"></span><span class="hs-comment">-- Searching ByteStrings</span><span>
</span><span id="line-1381"></span><span>
</span><span id="line-1382"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ 'elem' is the 'ByteString' membership predicate.</span></span><span>
</span><span id="line-1383"></span><span class="annot"><a href="Data.ByteString.html#elem"><span class="hs-identifier hs-type">elem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1384"></span><span id="elem"><span class="annot"><span class="annottext">elem :: Word8 -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#elem"><span class="hs-identifier hs-var hs-var">elem</span></a></span></span><span> </span><span id="local-6989586621679122891"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122891"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679122892"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122892"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122891"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122892"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1385"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#elem"><span class="hs-pragma hs-type">elem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1386"></span><span>
</span><span id="line-1387"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ 'notElem' is the inverse of 'elem'</span></span><span>
</span><span id="line-1388"></span><span class="annot"><a href="Data.ByteString.html#notElem"><span class="hs-identifier hs-type">notElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1389"></span><span id="notElem"><span class="annot"><span class="annottext">notElem :: Word8 -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#notElem"><span class="hs-identifier hs-var hs-var">notElem</span></a></span></span><span> </span><span id="local-6989586621679122893"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122893"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679122894"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122894"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122893"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122894"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1390"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#notElem"><span class="hs-pragma hs-type">notElem</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1391"></span><span>
</span><span id="line-1392"></span><span class="hs-comment">-- | /O(n)/ 'filter', applied to a predicate and a ByteString,</span><span>
</span><span id="line-1393"></span><span class="hs-comment">-- returns a ByteString containing those characters that satisfy the</span><span>
</span><span id="line-1394"></span><span class="hs-comment">-- predicate.</span><span>
</span><span id="line-1395"></span><span class="annot"><a href="Data.ByteString.html#filter"><span class="hs-identifier hs-type">filter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1396"></span><span id="filter"><span class="annot"><span class="annottext">filter :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#filter"><span class="hs-identifier hs-var hs-var">filter</span></a></span></span><span> </span><span id="local-6989586621679122895"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122895"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122896"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679122896"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122897"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122897"><span class="hs-identifier hs-var">pIn</span></a></span></span><span> </span><span id="local-6989586621679122898"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122898"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1397"></span><span>        </span><span class="hs-comment">-- see fold inlining.</span><span>
</span><span id="line-1398"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122896"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1399"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122896"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1400"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-1401"></span><span>      </span><span class="annot"><span class="annottext">IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; ByteString) -&gt; IO ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-identifier hs-var">createFpAndTrim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122898"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122900"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122900"><span class="hs-identifier hs-var">pOut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1402"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-1403"></span><span>          </span><span id="local-6989586621679122901"><span class="annot"><span class="annottext">go' :: ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
</span><a href="#local-6989586621679122901"><span class="hs-identifier hs-var hs-var hs-var">go'</span></a></span></span><span> </span><span id="local-6989586621679122902"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122902"><span class="hs-identifier hs-var">pf</span></a></span></span><span> </span><span id="local-6989586621679122903"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122903"><span class="hs-identifier hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
</span><a href="#local-6989586621679122904"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122902"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122903"><span class="hs-identifier hs-var">pt</span></a></span><span>
</span><span id="line-1404"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-1405"></span><span>              </span><span id="local-6989586621679122905"><span class="annot"><span class="annottext">end :: ForeignPtr b
</span><a href="#local-6989586621679122905"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122902"><span class="hs-identifier hs-var">pf</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122898"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1406"></span><span>              </span><span id="local-6989586621679122904"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
</span><a href="#local-6989586621679122904"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122912"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122912"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122913"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122913"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122912"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
forall {b}. ForeignPtr b
</span><a href="#local-6989586621679122905"><span class="hs-identifier hs-var">end</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122913"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1407"></span><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1408"></span><span>                           </span><span id="local-6989586621679122914"><span class="annot"><a href="#local-6989586621679122914"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122912"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1409"></span><span>                           </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679122895"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122914"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-1410"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-type">pokeFp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122913"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122914"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-1411"></span><span>                               </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679122904"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122912"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122913"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1412"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679122904"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122912"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679122913"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1413"></span><span>        </span><span id="local-6989586621679122915"><span class="annot"><a href="#local-6989586621679122915"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
</span><a href="#local-6989586621679122901"><span class="hs-identifier hs-var">go'</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122897"><span class="hs-identifier hs-var">pIn</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122900"><span class="hs-identifier hs-var">pOut</span></a></span><span>
</span><span id="line-1414"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="#local-6989586621679122915"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#minusForeignPtr"><span class="hs-operator hs-type">`minusForeignPtr`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122900"><span class="hs-identifier hs-type">pOut</span></a></span><span> </span><span class="hs-comment">-- actual length</span><span>
</span><span id="line-1415"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#filter"><span class="hs-pragma hs-type">filter</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1416"></span><span>
</span><span id="line-1417"></span><span class="hs-comment">{-
--
-- | /O(n)/ A first order equivalent of /filter . (==)/, for the common
-- case of filtering a single byte. It is more efficient to use
-- /filterByte/ in this case.
--
-- &gt; filterByte == filter . (==)
--
-- filterByte is around 10x faster, and uses much less space, than its
-- filter equivalent
--
filterByte :: Word8 -&gt; ByteString -&gt; ByteString
filterByte w ps = replicate (count w ps) w
{-# INLINE filterByte #-}

{-# RULES
&quot;ByteString specialise filter (== x)&quot; forall x.
    filter ((==) x) = filterByte x
&quot;ByteString specialise filter (== x)&quot; forall x.
    filter (== x) = filterByte x
  #-}
-}</span><span>
</span><span id="line-1439"></span><span>
</span><span id="line-1440"></span><span class="hs-comment">-- | /O(n)/ The 'find' function takes a predicate and a ByteString,</span><span>
</span><span id="line-1441"></span><span class="hs-comment">-- and returns the first element in matching the predicate, or 'Nothing'</span><span>
</span><span id="line-1442"></span><span class="hs-comment">-- if there is no such element.</span><span>
</span><span id="line-1443"></span><span class="hs-comment">--</span><span>
</span><span id="line-1444"></span><span class="hs-comment">-- &gt; find f p = case findIndex f p of Just n -&gt; Just (p ! n) ; _ -&gt; Nothing</span><span>
</span><span id="line-1445"></span><span class="hs-comment">--</span><span>
</span><span id="line-1446"></span><span class="annot"><a href="Data.ByteString.html#find"><span class="hs-identifier hs-type">find</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1447"></span><span id="find"><span class="annot"><span class="annottext">find :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Word8
</span><a href="Data.ByteString.html#find"><span class="hs-identifier hs-var hs-var">find</span></a></span></span><span> </span><span id="local-6989586621679122917"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122917"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122918"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122918"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Maybe Int
</span><a href="Data.ByteString.html#findIndex"><span class="hs-identifier hs-var">findIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122917"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122918"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1448"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679122919"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122919"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122918"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><a href="Data.ByteString.Unsafe.html#unsafeIndex"><span class="hs-operator hs-var">`unsafeIndex`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122919"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1449"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Word8
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1450"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#find"><span class="hs-pragma hs-type">find</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1451"></span><span>
</span><span id="line-1452"></span><span class="hs-comment">-- | /O(n)/ The 'partition' function takes a predicate a ByteString and returns</span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- the pair of ByteStrings with elements which do and do not satisfy the</span><span>
</span><span id="line-1454"></span><span class="hs-comment">-- predicate, respectively; i.e.,</span><span>
</span><span id="line-1455"></span><span class="hs-comment">--</span><span>
</span><span id="line-1456"></span><span class="hs-comment">-- &gt; partition p bs == (filter p xs, filter (not . p) xs)</span><span>
</span><span id="line-1457"></span><span class="hs-comment">--</span><span>
</span><span id="line-1458"></span><span class="annot"><a href="Data.ByteString.html#partition"><span class="hs-identifier hs-type">partition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1459"></span><span id="partition"><span class="annot"><span class="annottext">partition :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#partition"><span class="hs-identifier hs-var hs-var">partition</span></a></span></span><span> </span><span id="local-6989586621679122920"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122920"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679122921"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122921"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (ByteString, ByteString) -&gt; (ByteString, ByteString)
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (ByteString, ByteString) -&gt; (ByteString, ByteString))
-&gt; IO (ByteString, ByteString) -&gt; (ByteString, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1460"></span><span>    </span><span class="hs-keyword">do</span><span>        </span><span id="local-6989586621679122922"><span class="annot"><a href="#local-6989586621679122922"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122923"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-1461"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122926"><span class="annot"><a href="#local-6989586621679122926"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122922"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122923"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1462"></span><span>              </span><span id="local-6989586621679122927"><span class="annot"><a href="#local-6989586621679122927"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679122928"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621679122922"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122926"><span class="hs-identifier hs-type">end</span></a></span><span>
</span><span id="line-1463"></span><span>              </span><span class="annot"><a href="#local-6989586621679122929"><span class="hs-identifier hs-type">rev</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122927"><span class="hs-identifier hs-type">mid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122926"><span class="hs-identifier hs-type">end</span></a></span><span>
</span><span id="line-1464"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679122930"><span class="annot"><a href="#local-6989586621679122930"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122927"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int
forall a b. ForeignPtr a -&gt; ForeignPtr b -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#minusForeignPtr"><span class="hs-operator hs-var">`minusForeignPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122922"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1465"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122922"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122930"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1466"></span><span>                      </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122922"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusForeignPtr`</span></span><span> </span><span class="annot"><a href="#local-6989586621679122930"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122923"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621679122930"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1467"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1468"></span><span>    </span><span id="local-6989586621679122923"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679122923"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122921"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1469"></span><span>    </span><span id="local-6989586621679122932"><span class="annot"><span class="annottext">incr :: ForeignPtr a -&gt; ForeignPtr b
</span><a href="#local-6989586621679122932"><span class="hs-identifier hs-var hs-var">incr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr a -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1470"></span><span>    </span><span id="local-6989586621679122935"><span class="annot"><span class="annottext">decr :: ForeignPtr a -&gt; ForeignPtr b
</span><a href="#local-6989586621679122935"><span class="hs-identifier hs-var hs-var">decr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr a -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1471"></span><span>
</span><span id="line-1472"></span><span>    </span><span id="local-6989586621679122928"><span class="annot"><span class="annottext">sep :: Int
-&gt; ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
</span><a href="#local-6989586621679122928"><span class="hs-identifier hs-var hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122946"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122946"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122947"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122947"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122948"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122948"><span class="hs-identifier hs-var">p2</span></a></span></span><span>
</span><span id="line-1473"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122946"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122923"><span class="hs-identifier hs-var">len</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122947"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-1474"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679122920"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122949"><span class="hs-identifier hs-var">w</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122947"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122949"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1475"></span><span>                        </span><span class="annot"><span class="annottext">Int
-&gt; ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
</span><a href="#local-6989586621679122928"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122946"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8
forall {a} {b}. ForeignPtr a -&gt; ForeignPtr b
</span><a href="#local-6989586621679122932"><span class="hs-identifier hs-var">incr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122947"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122948"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-1476"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122948"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679122949"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1477"></span><span>                        </span><span class="annot"><span class="annottext">Int
-&gt; ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
</span><a href="#local-6989586621679122928"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122946"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122947"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8
forall {a} {b}. ForeignPtr a -&gt; ForeignPtr b
</span><a href="#local-6989586621679122935"><span class="hs-identifier hs-var">decr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122948"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1478"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1479"></span><span>        </span><span id="local-6989586621679122949"><span class="annot"><span class="annottext">w :: Word8
</span><a href="#local-6989586621679122949"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122921"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><a href="Data.ByteString.Unsafe.html#unsafeIndex"><span class="hs-operator hs-var">`unsafeIndex`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122946"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1480"></span><span>
</span><span id="line-1481"></span><span>    </span><span id="local-6989586621679122929"><span class="annot"><span class="annottext">rev :: ForeignPtr b -&gt; ForeignPtr b -&gt; IO ()
</span><a href="#local-6989586621679122929"><span class="hs-identifier hs-var hs-var">rev</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122962"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122962"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679122963"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122963"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-comment">-- fixme: surely there are faster ways to do this</span><span>
</span><span id="line-1482"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122962"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr b -&gt; ForeignPtr b -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122963"><span class="hs-identifier hs-var">p2</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1483"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679122964"><span class="annot"><a href="#local-6989586621679122964"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr b -&gt; IO b
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679122962"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-1484"></span><span>                       </span><span id="local-6989586621679122965"><span class="annot"><a href="#local-6989586621679122965"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-type">peekFp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122963"><span class="hs-identifier hs-type">p2</span></a></span><span>
</span><span id="line-1485"></span><span>                       </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-type">pokeFp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122962"><span class="hs-identifier hs-type">p1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122965"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1486"></span><span>                       </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-type">pokeFp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122963"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122964"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1487"></span><span>                       </span><span class="annot"><a href="#local-6989586621679122929"><span class="hs-identifier hs-type">rev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122932"><span class="hs-identifier hs-type">incr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122962"><span class="hs-identifier hs-type">p1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679122935"><span class="hs-identifier hs-type">decr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679122963"><span class="hs-identifier hs-type">p2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1488"></span><span>
</span><span id="line-1489"></span><span class="hs-comment">-- --------------------------------------------------------------------</span><span>
</span><span id="line-1490"></span><span class="hs-comment">-- Sarching for substrings</span><span>
</span><span id="line-1491"></span><span>
</span><span id="line-1492"></span><span class="hs-comment">-- |/O(n)/ The 'isPrefixOf' function takes two ByteStrings and returns 'True'</span><span>
</span><span id="line-1493"></span><span class="hs-comment">-- if the first is a prefix of the second.</span><span>
</span><span id="line-1494"></span><span class="annot"><a href="Data.ByteString.html#isPrefixOf"><span class="hs-identifier hs-type">isPrefixOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1495"></span><span id="isPrefixOf"><span class="annot"><span class="annottext">isPrefixOf :: ByteString -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#isPrefixOf"><span class="hs-identifier hs-var hs-var">isPrefixOf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122966"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122966"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679122967"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122967"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122968"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122968"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679122969"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122969"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1496"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122967"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1497"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122969"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122967"><span class="hs-identifier hs-var">l1</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1498"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Bool
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Bool) -&gt; IO Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122966"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Bool) -&gt; IO Bool)
-&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122970"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122970"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1499"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122968"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Bool) -&gt; IO Bool)
-&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122971"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122971"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1500"></span><span>            </span><span id="local-6989586621679122972"><span class="annot"><a href="#local-6989586621679122972"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO CInt
</span><a href="Data.ByteString.Internal.Type.html#memcmp"><span class="hs-identifier hs-var">memcmp</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122970"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122971"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122967"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1501"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="#local-6989586621679122972"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-1502"></span><span>
</span><span id="line-1503"></span><span class="hs-comment">-- | /O(n)/ The 'stripPrefix' function takes two ByteStrings and returns 'Just'</span><span>
</span><span id="line-1504"></span><span class="hs-comment">-- the remainder of the second iff the first is its prefix, and otherwise</span><span>
</span><span id="line-1505"></span><span class="hs-comment">-- 'Nothing'.</span><span>
</span><span id="line-1506"></span><span class="hs-comment">--</span><span>
</span><span id="line-1507"></span><span class="hs-comment">-- @since 0.10.8.0</span><span>
</span><span id="line-1508"></span><span class="annot"><a href="Data.ByteString.html#stripPrefix"><span class="hs-identifier hs-type">stripPrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1509"></span><span id="stripPrefix"><span class="annot"><span class="annottext">stripPrefix :: ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><a href="Data.ByteString.html#stripPrefix"><span class="hs-identifier hs-var hs-var">stripPrefix</span></a></span></span><span> </span><span id="local-6989586621679122974"><span class="annot"><span class="annottext">bs1 :: ByteString
</span><a href="#local-6989586621679122974"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679122975"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122975"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679122976"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122976"><span class="hs-identifier hs-var">bs2</span></a></span></span><span>
</span><span id="line-1510"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122974"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#isPrefixOf"><span class="hs-operator hs-var">`isPrefixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122976"><span class="hs-identifier hs-var">bs2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122975"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122976"><span class="hs-identifier hs-var">bs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1511"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1512"></span><span>
</span><span id="line-1513"></span><span class="hs-comment">-- | /O(n)/ The 'isSuffixOf' function takes two ByteStrings and returns 'True'</span><span>
</span><span id="line-1514"></span><span class="hs-comment">-- iff the first is a suffix of the second.</span><span>
</span><span id="line-1515"></span><span class="hs-comment">--</span><span>
</span><span id="line-1516"></span><span class="hs-comment">-- The following holds:</span><span>
</span><span id="line-1517"></span><span class="hs-comment">--</span><span>
</span><span id="line-1518"></span><span class="hs-comment">-- &gt; isSuffixOf x y == reverse x `isPrefixOf` reverse y</span><span>
</span><span id="line-1519"></span><span class="hs-comment">--</span><span>
</span><span id="line-1520"></span><span class="hs-comment">-- However, the real implementation uses memcmp to compare the end of the</span><span>
</span><span id="line-1521"></span><span class="hs-comment">-- string only, with no reverse required..</span><span>
</span><span id="line-1522"></span><span class="annot"><a href="Data.ByteString.html#isSuffixOf"><span class="hs-identifier hs-type">isSuffixOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1523"></span><span id="isSuffixOf"><span class="annot"><span class="annottext">isSuffixOf :: ByteString -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#isSuffixOf"><span class="hs-identifier hs-var hs-var">isSuffixOf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122977"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122977"><span class="hs-identifier hs-var">x1</span></a></span></span><span> </span><span id="local-6989586621679122978"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122978"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122979"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122979"><span class="hs-identifier hs-var">x2</span></a></span></span><span> </span><span id="local-6989586621679122980"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122980"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1524"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122978"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1525"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122980"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122978"><span class="hs-identifier hs-var">l1</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1526"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Bool
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Bool) -&gt; IO Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122977"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Bool) -&gt; IO Bool)
-&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122981"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122981"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1527"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122979"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Bool) -&gt; IO Bool)
-&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122982"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122982"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1528"></span><span>            </span><span id="local-6989586621679122983"><span class="annot"><a href="#local-6989586621679122983"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO CInt
</span><a href="Data.ByteString.Internal.Type.html#memcmp"><span class="hs-identifier hs-var">memcmp</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122981"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122982"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122980"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122978"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122978"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1529"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="#local-6989586621679122983"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-1530"></span><span>
</span><span id="line-1531"></span><span class="hs-comment">-- | /O(n)/ The 'stripSuffix' function takes two ByteStrings and returns 'Just'</span><span>
</span><span id="line-1532"></span><span class="hs-comment">-- the remainder of the second iff the first is its suffix, and otherwise</span><span>
</span><span id="line-1533"></span><span class="hs-comment">-- 'Nothing'.</span><span>
</span><span id="line-1534"></span><span class="annot"><a href="Data.ByteString.html#stripSuffix"><span class="hs-identifier hs-type">stripSuffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1535"></span><span id="stripSuffix"><span class="annot"><span class="annottext">stripSuffix :: ByteString -&gt; ByteString -&gt; Maybe ByteString
</span><a href="Data.ByteString.html#stripSuffix"><span class="hs-identifier hs-var hs-var">stripSuffix</span></a></span></span><span> </span><span id="local-6989586621679122984"><span class="annot"><span class="annottext">bs1 :: ByteString
</span><a href="#local-6989586621679122984"><span class="hs-identifier hs-var">bs1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679122985"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122985"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679122986"><span class="annot"><span class="annottext">bs2 :: ByteString
</span><a href="#local-6989586621679122986"><span class="hs-identifier hs-var">bs2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679122987"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122987"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1536"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122984"><span class="hs-identifier hs-var">bs1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#isSuffixOf"><span class="hs-operator hs-var">`isSuffixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122986"><span class="hs-identifier hs-var">bs2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122987"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122985"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122986"><span class="hs-identifier hs-var">bs2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1537"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span class="annot"><span class="hs-comment">-- | Check whether one string is a substring of another.</span></span><span>
</span><span id="line-1540"></span><span class="annot"><a href="Data.ByteString.html#isInfixOf"><span class="hs-identifier hs-type">isInfixOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1541"></span><span id="isInfixOf"><span class="annot"><span class="annottext">isInfixOf :: ByteString -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.html#isInfixOf"><span class="hs-identifier hs-var hs-var">isInfixOf</span></a></span></span><span> </span><span id="local-6989586621679122988"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122988"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679122989"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122989"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122988"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Bool) -&gt; ByteString -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString) -&gt; ByteString
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((ByteString, ByteString) -&gt; ByteString)
-&gt; (ByteString, ByteString) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#breakSubstring"><span class="hs-identifier hs-var">breakSubstring</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122988"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122989"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1542"></span><span>
</span><span id="line-1543"></span><span class="hs-comment">-- | /O(n)/ Check whether a 'ByteString' represents valid UTF-8.</span><span>
</span><span id="line-1544"></span><span class="hs-comment">--</span><span>
</span><span id="line-1545"></span><span class="hs-comment">-- @since 0.11.2.0</span><span>
</span><span id="line-1546"></span><span class="annot"><a href="Data.ByteString.html#isValidUtf8"><span class="hs-identifier hs-type">isValidUtf8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1547"></span><span id="isValidUtf8"><span class="annot"><span class="annottext">isValidUtf8 :: ByteString -&gt; Bool
</span><a href="Data.ByteString.html#isValidUtf8"><span class="hs-identifier hs-var hs-var">isValidUtf8</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679122991"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122991"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span id="local-6989586621679122992"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122992"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Bool
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Bool) -&gt; IO Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679122991"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Bool) -&gt; IO Bool)
-&gt; (Ptr Word8 -&gt; IO Bool) -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679122993"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122993"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1548"></span><span>  </span><span class="hs-comment">-- Use a safe FFI call for large inputs to avoid GC synchronization pauses</span><span>
</span><span id="line-1549"></span><span>  </span><span class="hs-comment">-- in multithreaded contexts.</span><span>
</span><span id="line-1550"></span><span>  </span><span class="hs-comment">-- This specific limit was chosen based on results of a simple benchmark, see:</span><span>
</span><span id="line-1551"></span><span>  </span><span class="hs-comment">-- https://github.com/haskell/bytestring/issues/451#issuecomment-991879338</span><span>
</span><span id="line-1552"></span><span>  </span><span class="hs-comment">-- When changing this function, also consider changing the related function:</span><span>
</span><span id="line-1553"></span><span>  </span><span class="hs-comment">-- Data.ByteString.Short.Internal.isValidUtf8</span><span>
</span><span id="line-1554"></span><span>  </span><span id="local-6989586621679122994"><span class="annot"><a href="#local-6989586621679122994"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122992"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000000</span></span><span>
</span><span id="line-1555"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CSize -&gt; IO CInt
</span><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8"><span class="hs-identifier hs-var">cIsValidUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122993"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122992"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1556"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CSize -&gt; IO CInt
</span><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8Safe"><span class="hs-identifier hs-var">cIsValidUtf8Safe</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679122993"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122992"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1557"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679122994"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-type">/=</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-1558"></span><span>
</span><span id="line-1559"></span><span class="hs-comment">-- | Break a string on a substring, returning a pair of the part of the</span><span>
</span><span id="line-1560"></span><span class="hs-comment">-- string prior to the match, and the rest of the string.</span><span>
</span><span id="line-1561"></span><span class="hs-comment">--</span><span>
</span><span id="line-1562"></span><span class="hs-comment">-- The following relationships hold:</span><span>
</span><span id="line-1563"></span><span class="hs-comment">--</span><span>
</span><span id="line-1564"></span><span class="hs-comment">-- &gt; break (== c) l == breakSubstring (singleton c) l</span><span>
</span><span id="line-1565"></span><span class="hs-comment">--</span><span>
</span><span id="line-1566"></span><span class="hs-comment">-- For example, to tokenise a string, dropping delimiters:</span><span>
</span><span id="line-1567"></span><span class="hs-comment">--</span><span>
</span><span id="line-1568"></span><span class="hs-comment">-- &gt; tokenise x y = h : if null t then [] else tokenise x (drop (length x) t)</span><span>
</span><span id="line-1569"></span><span class="hs-comment">-- &gt;     where (h,t) = breakSubstring x y</span><span>
</span><span id="line-1570"></span><span class="hs-comment">--</span><span>
</span><span id="line-1571"></span><span class="hs-comment">-- To skip to the first occurrence of a string:</span><span>
</span><span id="line-1572"></span><span class="hs-comment">--</span><span>
</span><span id="line-1573"></span><span class="hs-comment">-- &gt; snd (breakSubstring x y)</span><span>
</span><span id="line-1574"></span><span class="hs-comment">--</span><span>
</span><span id="line-1575"></span><span class="hs-comment">-- To take the parts of a string before a delimiter:</span><span>
</span><span id="line-1576"></span><span class="hs-comment">--</span><span>
</span><span id="line-1577"></span><span class="hs-comment">-- &gt; fst (breakSubstring x y)</span><span>
</span><span id="line-1578"></span><span class="hs-comment">--</span><span>
</span><span id="line-1579"></span><span class="hs-comment">-- Note that calling `breakSubstring x` does some preprocessing work, so</span><span>
</span><span id="line-1580"></span><span class="hs-comment">-- you should avoid unnecessarily duplicating breakSubstring calls with the same</span><span>
</span><span id="line-1581"></span><span class="hs-comment">-- pattern.</span><span>
</span><span id="line-1582"></span><span class="hs-comment">--</span><span>
</span><span id="line-1583"></span><span class="annot"><a href="Data.ByteString.html#breakSubstring"><span class="hs-identifier hs-type">breakSubstring</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ String to search for</span></span><span>
</span><span id="line-1584"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ String to search in</span></span><span>
</span><span id="line-1585"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Head and tail of string broken at substring</span></span><span>
</span><span id="line-1586"></span><span id="breakSubstring"><span class="annot"><span class="annottext">breakSubstring :: ByteString -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#breakSubstring"><span class="hs-identifier hs-var hs-var">breakSubstring</span></a></span></span><span> </span><span id="local-6989586621679122997"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122997"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1587"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1588"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-1589"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#breakByte"><span class="hs-identifier hs-var">breakByte</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Word8
</span><a href="Data.ByteString.Unsafe.html#unsafeHead"><span class="hs-identifier hs-var">unsafeHead</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122997"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1590"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int
forall b. FiniteBits b =&gt; b -&gt; Int
</span><span class="hs-identifier hs-var">finiteBitSize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1591"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123000"><span class="hs-identifier hs-var">shift</span></a></span><span>
</span><span id="line-1592"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123001"><span class="hs-identifier hs-var">karpRabin</span></a></span><span>
</span><span id="line-1593"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1594"></span><span>    </span><span id="local-6989586621679123002"><span class="annot"><span class="annottext">unsafeSplitAt :: Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123002"><span class="hs-identifier hs-var hs-var">unsafeSplitAt</span></a></span></span><span> </span><span id="local-6989586621679123003"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123003"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679123004"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123004"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123003"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123004"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeDrop"><span class="hs-identifier hs-var">unsafeDrop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123003"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123004"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1595"></span><span>    </span><span id="local-6989586621679122998"><span class="annot"><span class="annottext">lp :: Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var hs-var">lp</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122997"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1596"></span><span>    </span><span class="annot"><a href="#local-6989586621679123001"><span class="hs-identifier hs-type">karpRabin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1597"></span><span>    </span><span id="local-6989586621679123001"><span class="annot"><span class="annottext">karpRabin :: ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123001"><span class="hs-identifier hs-var hs-var">karpRabin</span></a></span></span><span> </span><span id="local-6989586621679123005"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123005"><span class="hs-identifier hs-var">src</span></a></span></span><span>
</span><span id="line-1598"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123005"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123005"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1599"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123006"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Word32
</span><a href="#local-6989586621679123007"><span class="hs-identifier hs-var">rollingHash</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Word32) -&gt; ByteString -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123005"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-1600"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1601"></span><span>        </span><span id="local-6989586621679123010"><span class="annot"><span class="annottext">k :: Word32
</span><a href="#local-6989586621679123010"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2891336453</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-1602"></span><span>        </span><span id="local-6989586621679123007"><span class="annot"><span class="annottext">rollingHash :: ByteString -&gt; Word32
</span><a href="#local-6989586621679123007"><span class="hs-identifier hs-var hs-var">rollingHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Word8 -&gt; Word32) -&gt; Word32 -&gt; ByteString -&gt; Word32
forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679123016"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123016"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679123017"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123017"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123016"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123010"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123017"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1603"></span><span>        </span><span id="local-6989586621679123018"><span class="annot"><span class="annottext">hp :: Word32
</span><a href="#local-6989586621679123018"><span class="hs-identifier hs-var hs-var">hp</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word32
</span><a href="#local-6989586621679123007"><span class="hs-identifier hs-var">rollingHash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122997"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1604"></span><span>        </span><span id="local-6989586621679123021"><span class="annot"><span class="annottext">m :: Word32
</span><a href="#local-6989586621679123021"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123010"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-1605"></span><span>        </span><span id="local-6989586621679123025"><span class="annot"><span class="annottext">get :: Int -&gt; Word32
</span><a href="#local-6989586621679123025"><span class="hs-identifier hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word32) -&gt; (Int -&gt; Word8) -&gt; Int -&gt; Word32
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><a href="Data.ByteString.Unsafe.html#unsafeIndex"><span class="hs-identifier hs-var">unsafeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123005"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-1606"></span><span>        </span><span id="local-6989586621679123006"><span class="annot"><span class="annottext">search :: Word32 -&gt; Int -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123006"><span class="hs-identifier hs-var hs-var">search</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123033"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123033"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123034"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123034"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-1607"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123018"><span class="hs-identifier hs-var">hp</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123033"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122997"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123036"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteString)
</span><a href="#local-6989586621679123037"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-1608"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123005"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123034"><span class="hs-identifier hs-var">i</span></a></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123005"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- not found</span><span>
</span><span id="line-1609"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123006"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123038"><span class="hs-identifier hs-var">hs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123034"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1610"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1611"></span><span>            </span><span id="local-6989586621679123037"><span class="annot"><span class="annottext">u :: (ByteString, ByteString)
</span><a href="#local-6989586621679123037"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123036"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123036"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123002"><span class="hs-identifier hs-var">unsafeSplitAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123034"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123005"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-1612"></span><span>            </span><span id="local-6989586621679123038"><span class="annot"><span class="annottext">hs' :: Word32
</span><a href="#local-6989586621679123038"><span class="hs-identifier hs-var hs-var">hs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123033"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123010"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span>
</span><span id="line-1613"></span><span>                  </span><span class="annot"><span class="annottext">Int -&gt; Word32
</span><a href="#local-6989586621679123025"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123034"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span>
</span><span id="line-1614"></span><span>                  </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679123021"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
</span><a href="#local-6989586621679123025"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123034"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1615"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679123001"><span class="hs-pragma hs-type">karpRabin</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1616"></span><span>
</span><span id="line-1617"></span><span>    </span><span class="annot"><a href="#local-6989586621679123000"><span class="hs-identifier hs-type">shift</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1618"></span><span>    </span><span id="local-6989586621679123000"><span class="annot"><span class="annottext">shift :: ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123000"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123045"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123045"><span class="hs-identifier hs-var">src</span></a></span></span><span>
</span><span id="line-1619"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123045"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123045"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1620"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123046"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Word
</span><a href="#local-6989586621679123047"><span class="hs-identifier hs-var">intoWord</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Word) -&gt; ByteString -&gt; Word
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTake"><span class="hs-identifier hs-var">unsafeTake</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123045"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-1621"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1622"></span><span>        </span><span class="annot"><a href="#local-6989586621679123047"><span class="hs-identifier hs-type">intoWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span>
</span><span id="line-1623"></span><span>        </span><span id="local-6989586621679123047"><span class="annot"><span class="annottext">intoWord :: ByteString -&gt; Word
</span><a href="#local-6989586621679123047"><span class="hs-identifier hs-var hs-var">intoWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Word8 -&gt; Word) -&gt; Word -&gt; ByteString -&gt; Word
forall a. (a -&gt; Word8 -&gt; a) -&gt; a -&gt; ByteString -&gt; a
</span><a href="Data.ByteString.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679123048"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123048"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679123049"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123049"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123048"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123049"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1624"></span><span>        </span><span id="local-6989586621679123050"><span class="annot"><span class="annottext">wp :: Word
</span><a href="#local-6989586621679123050"><span class="hs-identifier hs-var hs-var">wp</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Word
</span><a href="#local-6989586621679123047"><span class="hs-identifier hs-var">intoWord</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679122997"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1625"></span><span>        </span><span id="local-6989586621679123059"><span class="annot"><span class="annottext">mask :: Word
</span><a href="#local-6989586621679123059"><span class="hs-identifier hs-var hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1626"></span><span>        </span><span id="local-6989586621679123046"><span class="annot"><span class="annottext">search :: Word -&gt; Int -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123046"><span class="hs-identifier hs-var hs-var">search</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123065"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123065"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123066"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123066"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-1627"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123050"><span class="hs-identifier hs-var">wp</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123002"><span class="hs-identifier hs-var">unsafeSplitAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123066"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679122998"><span class="hs-identifier hs-var">lp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123045"><span class="hs-identifier hs-var">src</span></a></span><span>
</span><span id="line-1628"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="Data.ByteString.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123045"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123066"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123045"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1629"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; (ByteString, ByteString)
</span><a href="#local-6989586621679123046"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123067"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123066"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1630"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1631"></span><span>            </span><span id="local-6989586621679123070"><span class="annot"><span class="annottext">b :: Word
</span><a href="#local-6989586621679123070"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><a href="Data.ByteString.Unsafe.html#unsafeIndex"><span class="hs-identifier hs-var">unsafeIndex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123045"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123066"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1632"></span><span>            </span><span id="local-6989586621679123067"><span class="annot"><span class="annottext">w' :: Word
</span><a href="#local-6989586621679123067"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123059"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679123070"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1633"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679123000"><span class="hs-pragma hs-type">shift</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1634"></span><span>
</span><span id="line-1635"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1636"></span><span class="hs-comment">-- Zipping</span><span>
</span><span id="line-1637"></span><span>
</span><span id="line-1638"></span><span class="hs-comment">-- | /O(n)/ 'zip' takes two ByteStrings and returns a list of</span><span>
</span><span id="line-1639"></span><span class="hs-comment">-- corresponding pairs of bytes. If one input ByteString is short,</span><span>
</span><span id="line-1640"></span><span class="hs-comment">-- excess elements of the longer ByteString are discarded. This is</span><span>
</span><span id="line-1641"></span><span class="hs-comment">-- equivalent to a pair of 'unpack' operations.</span><span>
</span><span id="line-1642"></span><span class="annot"><a href="Data.ByteString.html#zip"><span class="hs-identifier hs-type">zip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1643"></span><span id="zip"><span class="annot"><span class="annottext">zip :: ByteString -&gt; ByteString -&gt; [(Word8, Word8)]
</span><a href="Data.ByteString.html#zip"><span class="hs-identifier hs-var hs-var">zip</span></a></span></span><span> </span><span id="local-6989586621679123075"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123075"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679123076"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123076"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123075"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1644"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1645"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679123077"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123077"><span class="hs-identifier hs-var">psH</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123078"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123078"><span class="hs-identifier hs-var">psT</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123076"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1646"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1647"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679123079"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123079"><span class="hs-identifier hs-var">qsH</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123080"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123080"><span class="hs-identifier hs-var">qsT</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123077"><span class="hs-identifier hs-var">psH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123079"><span class="hs-identifier hs-var">qsH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Word8, Word8) -&gt; [(Word8, Word8)] -&gt; [(Word8, Word8)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; [(Word8, Word8)]
</span><a href="Data.ByteString.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123078"><span class="hs-identifier hs-var">psT</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123080"><span class="hs-identifier hs-var">qsT</span></a></span><span>
</span><span id="line-1648"></span><span>
</span><span id="line-1649"></span><span class="hs-comment">-- | 'zipWith' generalises 'zip' by zipping with the function given as</span><span>
</span><span id="line-1650"></span><span class="hs-comment">-- the first argument, instead of a tupling function.  For example,</span><span>
</span><span id="line-1651"></span><span class="hs-comment">-- @'zipWith' (+)@ is applied to two ByteStrings to produce the list of</span><span>
</span><span id="line-1652"></span><span class="hs-comment">-- corresponding sums.</span><span>
</span><span id="line-1653"></span><span id="local-6989586621679121721"><span class="annot"><a href="Data.ByteString.html#zipWith"><span class="hs-identifier hs-type">zipWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679121721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1654"></span><span id="zipWith"><span class="annot"><span class="annottext">zipWith :: forall a. (Word8 -&gt; Word8 -&gt; a) -&gt; ByteString -&gt; ByteString -&gt; [a]
</span><a href="Data.ByteString.html#zipWith"><span class="hs-identifier hs-var hs-var">zipWith</span></a></span></span><span> </span><span id="local-6989586621679123081"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; a
</span><a href="#local-6989586621679123081"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679123082"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123082"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679123083"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123083"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123082"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1655"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1656"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679123084"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123084"><span class="hs-identifier hs-var">psH</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123085"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123085"><span class="hs-identifier hs-var">psT</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Word8, ByteString)
</span><a href="Data.ByteString.html#uncons"><span class="hs-identifier hs-var">uncons</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123083"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1657"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Word8, ByteString)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1658"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679123086"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123086"><span class="hs-identifier hs-var">qsH</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123087"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123087"><span class="hs-identifier hs-var">qsT</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; a
</span><a href="#local-6989586621679123081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123084"><span class="hs-identifier hs-var">psH</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123086"><span class="hs-identifier hs-var">qsH</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Word8 -&gt; a) -&gt; ByteString -&gt; ByteString -&gt; [a]
forall a. (Word8 -&gt; Word8 -&gt; a) -&gt; ByteString -&gt; ByteString -&gt; [a]
</span><a href="Data.ByteString.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; a
</span><a href="#local-6989586621679123081"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123085"><span class="hs-identifier hs-var">psT</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123087"><span class="hs-identifier hs-var">qsT</span></a></span><span>
</span><span id="line-1659"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.html#zipWith"><span class="hs-pragma hs-type">zipWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1660"></span><span>
</span><span id="line-1661"></span><span class="hs-comment">-- | A specialised version of `zipWith` for the common case of a</span><span>
</span><span id="line-1662"></span><span class="hs-comment">-- simultaneous map over two ByteStrings, to build a 3rd.</span><span>
</span><span id="line-1663"></span><span class="hs-comment">--</span><span>
</span><span id="line-1664"></span><span class="hs-comment">-- @since 0.11.1.0</span><span>
</span><span id="line-1665"></span><span class="annot"><a href="Data.ByteString.html#packZipWith"><span class="hs-identifier hs-type">packZipWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1666"></span><span id="packZipWith"><span class="annot"><span class="annottext">packZipWith :: (Word8 -&gt; Word8 -&gt; Word8) -&gt; ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#packZipWith"><span class="hs-identifier hs-var hs-var">packZipWith</span></a></span></span><span> </span><span id="local-6989586621679123088"><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
</span><a href="#local-6989586621679123088"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679123089"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123089"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679123090"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123090"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679123091"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123091"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679123092"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123092"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; ByteString) -&gt; IO ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1667"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-var">createFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123094"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679123095"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123089"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123091"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1668"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1669"></span><span>    </span><span id="local-6989586621679123095"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679123095"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679123106"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123106"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679123107"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123107"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679123108"><span class="hs-identifier hs-var">zipWith_</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1670"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1671"></span><span>        </span><span class="annot"><a href="#local-6989586621679123108"><span class="hs-identifier hs-type">zipWith_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1672"></span><span>        </span><span id="local-6989586621679123108"><span class="annot"><span class="annottext">zipWith_ :: Int -&gt; ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679123108"><span class="hs-identifier hs-var hs-var">zipWith_</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123109"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123109"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123110"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123110"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-1673"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123109"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123094"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1674"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1675"></span><span>                </span><span id="local-6989586621679123111"><span class="annot"><a href="#local-6989586621679123111"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var">peekFpByteOff</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123106"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123109"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1676"></span><span>                </span><span id="local-6989586621679123112"><span class="annot"><a href="#local-6989586621679123112"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-type">peekFpByteOff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123107"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123109"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-1677"></span><span>                </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-type">pokeFpByteOff</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123110"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123109"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123088"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123111"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123112"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1678"></span><span>                </span><span class="annot"><a href="#local-6989586621679123108"><span class="hs-identifier hs-type">zipWith_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123109"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679123110"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-1679"></span><span>
</span><span id="line-1680"></span><span>    </span><span id="local-6989586621679123094"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679123094"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123090"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123092"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1681"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#packZipWith"><span class="hs-pragma hs-type">packZipWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1682"></span><span>
</span><span id="line-1683"></span><span class="hs-comment">-- | /O(n)/ 'unzip' transforms a list of pairs of bytes into a pair of</span><span>
</span><span id="line-1684"></span><span class="hs-comment">-- ByteStrings. Note that this performs two 'pack' operations.</span><span>
</span><span id="line-1685"></span><span class="annot"><a href="Data.ByteString.html#unzip"><span class="hs-identifier hs-type">unzip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1686"></span><span id="unzip"><span class="annot"><span class="annottext">unzip :: [(Word8, Word8)] -&gt; (ByteString, ByteString)
</span><a href="Data.ByteString.html#unzip"><span class="hs-identifier hs-var hs-var">unzip</span></a></span></span><span> </span><span id="local-6989586621679123115"><span class="annot"><span class="annottext">[(Word8, Word8)]
</span><a href="#local-6989586621679123115"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="Data.ByteString.html#pack"><span class="hs-identifier hs-var">pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Word8, Word8) -&gt; Word8) -&gt; [(Word8, Word8)] -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="annot"><span class="annottext">(Word8, Word8) -&gt; Word8
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Word8, Word8)]
</span><a href="#local-6989586621679123115"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="Data.ByteString.html#pack"><span class="hs-identifier hs-var">pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Word8, Word8) -&gt; Word8) -&gt; [(Word8, Word8)] -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">P.map</span></span><span> </span><span class="annot"><span class="annottext">(Word8, Word8) -&gt; Word8
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(Word8, Word8)]
</span><a href="#local-6989586621679123115"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1687"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#unzip"><span class="hs-pragma hs-type">unzip</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1688"></span><span>
</span><span id="line-1689"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1690"></span><span class="hs-comment">-- Special lists</span><span>
</span><span id="line-1691"></span><span>
</span><span id="line-1692"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ Returns all initial segments of the given 'ByteString', shortest first.</span></span><span>
</span><span id="line-1693"></span><span class="annot"><a href="Data.ByteString.html#inits"><span class="hs-identifier hs-type">inits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1694"></span><span class="hs-comment">-- see Note [Avoid NonEmpty combinators]</span><span>
</span><span id="line-1695"></span><span id="inits"><span class="annot"><span class="annottext">inits :: ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#inits"><span class="hs-identifier hs-var hs-var">inits</span></a></span></span><span> </span><span id="local-6989586621679123116"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123116"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty ByteString -&gt; [ByteString]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#toList"><span class="hs-identifier hs-var">NE.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty ByteString -&gt; [ByteString])
-&gt; NonEmpty ByteString -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; NonEmpty ByteString
</span><a href="Data.ByteString.html#initsNE"><span class="hs-identifier hs-var">initsNE</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123116"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1696"></span><span>
</span><span id="line-1697"></span><span class="hs-comment">-- | /O(n)/ Returns all initial segments of the given 'ByteString', shortest first.</span><span>
</span><span id="line-1698"></span><span class="hs-comment">--</span><span>
</span><span id="line-1699"></span><span class="hs-comment">-- @since 0.11.4.0</span><span>
</span><span id="line-1700"></span><span class="annot"><a href="Data.ByteString.html#initsNE"><span class="hs-identifier hs-type">initsNE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1701"></span><span class="hs-comment">-- see Note [Avoid NonEmpty combinators]</span><span>
</span><span id="line-1702"></span><span id="initsNE"><span class="annot"><span class="annottext">initsNE :: ByteString -&gt; NonEmpty ByteString
</span><a href="Data.ByteString.html#initsNE"><span class="hs-identifier hs-var hs-var">initsNE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679123118"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123118"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679123119"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123119"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; NonEmpty ByteString
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123118"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123121"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679123121"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123121"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123119"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1703"></span><span>
</span><span id="line-1704"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ Returns all final segments of the given 'ByteString', longest first.</span></span><span>
</span><span id="line-1705"></span><span class="annot"><a href="Data.ByteString.html#tails"><span class="hs-identifier hs-type">tails</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1706"></span><span class="hs-comment">-- see Note [Avoid NonEmpty combinators]</span><span>
</span><span id="line-1707"></span><span id="tails"><span class="annot"><span class="annottext">tails :: ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#tails"><span class="hs-identifier hs-var hs-var">tails</span></a></span></span><span> </span><span id="local-6989586621679123122"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123122"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty ByteString -&gt; [ByteString]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#toList"><span class="hs-identifier hs-var">NE.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty ByteString -&gt; [ByteString])
-&gt; NonEmpty ByteString -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; NonEmpty ByteString
</span><a href="Data.ByteString.html#tailsNE"><span class="hs-identifier hs-var">tailsNE</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123122"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-1708"></span><span>
</span><span id="line-1709"></span><span class="hs-comment">-- | /O(n)/ Returns all final segments of the given 'ByteString', longest first.</span><span>
</span><span id="line-1710"></span><span class="hs-comment">--</span><span>
</span><span id="line-1711"></span><span class="hs-comment">-- @since 0.11.4.0</span><span>
</span><span id="line-1712"></span><span class="annot"><a href="Data.ByteString.html#tailsNE"><span class="hs-identifier hs-type">tailsNE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1713"></span><span class="hs-comment">-- see Note [Avoid NonEmpty combinators]</span><span>
</span><span id="line-1714"></span><span id="tailsNE"><span class="annot"><span class="annottext">tailsNE :: ByteString -&gt; NonEmpty ByteString
</span><a href="Data.ByteString.html#tailsNE"><span class="hs-identifier hs-var hs-var">tailsNE</span></a></span></span><span> </span><span id="local-6989586621679123123"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123123"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
</span><a href="Data.ByteString.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123123"><span class="hs-identifier hs-var">p</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; NonEmpty ByteString
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1715"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123123"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; NonEmpty ByteString
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><a href="Data.ByteString.html#tails"><span class="hs-identifier hs-var">tails</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="Data.ByteString.Unsafe.html#unsafeTail"><span class="hs-identifier hs-var">unsafeTail</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123123"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1716"></span><span>
</span><span id="line-1717"></span><span class="hs-comment">-- less efficent spacewise: tails (BS x l) = [BS (plusForeignPtr x n) (l-n) | n &lt;- [0..l]]</span><span>
</span><span id="line-1718"></span><span>
</span><span id="line-1719"></span><span class="hs-comment">{-
Note [Avoid NonEmpty combinators]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

As of base-4.18, most of the NonEmpty API is surprisingly lazy.
Using it without forcing the arguments yourself is just begging GHC
to make your code waste time allocating useless selector thunks.
This may change in the future. See also this CLC issue:
  https://github.com/haskell/core-libraries-committee/issues/107
But until then, &quot;refactor&quot; with care!

(Even for uses of NonEmpty near lazy ByteStrings, we don't want
the extra laziness of the NonEmpty API.)
-}</span><span>
</span><span id="line-1733"></span><span>
</span><span id="line-1734"></span><span>
</span><span id="line-1735"></span><span>
</span><span id="line-1736"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1737"></span><span class="annot"><span class="hs-comment">-- ** Ordered 'ByteString's</span></span><span>
</span><span id="line-1738"></span><span>
</span><span id="line-1739"></span><span class="annot"><span class="hs-comment">-- | /O(n)/ Sort a ByteString efficiently, using counting sort.</span></span><span>
</span><span id="line-1740"></span><span class="annot"><a href="Data.ByteString.html#sort"><span class="hs-identifier hs-type">sort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1741"></span><span id="sort"><span class="annot"><span class="annottext">sort :: ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#sort"><span class="hs-identifier hs-var hs-var">sort</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679123125"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123125"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span id="local-6989586621679123126"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123126"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1742"></span><span>  </span><span class="hs-comment">-- qsort outperforms counting sort for small arrays</span><span>
</span><span id="line-1743"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123126"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123126"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123127"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123127"><span class="hs-identifier hs-var">destFP</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1744"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123127"><span class="hs-identifier hs-var">destFP</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123125"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123126"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1745"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123127"><span class="hs-identifier hs-var">destFP</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123128"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123128"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CSize -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#c_sort"><span class="hs-identifier hs-var">c_sort</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123128"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123126"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1746"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123126"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123130"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123130"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Ptr Int -&gt; IO ()) -&gt; IO ()
forall a b. Storable a =&gt; Int -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">allocaArray</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span> </span><span class="annot"><span class="annottext">((Ptr Int -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Int -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123131"><span class="annot"><span class="annottext">Ptr Int
</span><a href="#local-6989586621679123131"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1747"></span><span>
</span><span id="line-1748"></span><span>    </span><span class="annot"><span class="annottext">Ptr (ZonkAny 0) -&gt; Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Word8 -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">fillBytes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Int -&gt; Ptr (ZonkAny 0)
forall a b. Ptr a -&gt; Ptr b
</span><span class="hs-identifier hs-var">castPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr Int
</span><a href="#local-6989586621679123131"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Storable a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">sizeOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1749"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123125"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679123135"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123135"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Int -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679123136"><span class="hs-identifier hs-var">countOccurrences</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Int
</span><a href="#local-6989586621679123131"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123135"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123126"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1750"></span><span>
</span><span id="line-1751"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679123152"><span class="annot"><span class="annottext">go :: Int -&gt; Ptr b -&gt; IO ()
</span><a href="#local-6989586621679123152"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">Ptr b
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1752"></span><span>        </span><span class="annot"><a href="#local-6989586621679123152"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679123153"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123153"><span class="hs-identifier hs-var">i</span></a></span></span><span>   </span><span class="hs-glyph">!</span><span id="local-6989586621679123154"><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679123154"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679123155"><span class="annot"><a href="#local-6989586621679123155"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Int -&gt; Int -&gt; IO Int
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Int
</span><a href="#local-6989586621679123131"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123153"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1753"></span><span>                         </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123155"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-type">/=</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1754"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">fillBytes</span></span><span> </span><span class="annot"><a href="#local-6989586621679123154"><span class="hs-identifier hs-type">ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><a href="#local-6989586621679123153"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679123155"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-1755"></span><span>                         </span><span class="annot"><a href="#local-6989586621679123152"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123153"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123154"><span class="hs-identifier hs-type">ptr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusPtr`</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679123155"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1756"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123130"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Ptr Word8 -&gt; IO ()
forall {b}. Int -&gt; Ptr b -&gt; IO ()
</span><a href="#local-6989586621679123152"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1757"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1758"></span><span>    </span><span class="hs-comment">-- Count the number of occurrences of each byte.</span><span>
</span><span id="line-1759"></span><span>    </span><span class="annot"><a href="#local-6989586621679123136"><span class="hs-identifier hs-type">countOccurrences</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1760"></span><span>    </span><span id="local-6989586621679123136"><span class="annot"><span class="annottext">countOccurrences :: Ptr Int -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679123136"><span class="hs-identifier hs-var hs-var">countOccurrences</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123157"><span class="annot"><span class="annottext">Ptr Int
</span><a href="#local-6989586621679123157"><span class="hs-identifier hs-var">counts</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123158"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123158"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123159"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123159"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="#local-6989586621679123160"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1761"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-1762"></span><span>        </span><span id="local-6989586621679123160"><span class="annot"><span class="annottext">go :: Int -&gt; IO ()
</span><a href="#local-6989586621679123160"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123176"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123176"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123176"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123159"><span class="hs-identifier hs-var">len</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1763"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679123177"><span class="annot"><a href="#local-6989586621679123177"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Int) -&gt; IO Word8 -&gt; IO Int
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekElemOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123158"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123176"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1764"></span><span>                               </span><span id="local-6989586621679123178"><span class="annot"><a href="#local-6989586621679123178"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">peekElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621679123157"><span class="hs-identifier hs-type">counts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123177"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-1765"></span><span>                               </span><span class="annot"><span class="hs-identifier hs-type">pokeElemOff</span></span><span> </span><span class="annot"><a href="#local-6989586621679123157"><span class="hs-identifier hs-type">counts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123177"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123178"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1766"></span><span>                               </span><span class="annot"><a href="#local-6989586621679123160"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123176"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1767"></span><span>
</span><span id="line-1768"></span><span>
</span><span id="line-1769"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1770"></span><span class="hs-comment">-- Low level constructors</span><span>
</span><span id="line-1771"></span><span>
</span><span id="line-1772"></span><span class="hs-comment">-- | /O(n) construction/ Use a @ByteString@ with a function requiring a</span><span>
</span><span id="line-1773"></span><span class="hs-comment">-- null-terminated @CString@.  The @CString@ is a copy and will be freed</span><span>
</span><span id="line-1774"></span><span class="hs-comment">-- automatically; it must not be stored or used after the</span><span>
</span><span id="line-1775"></span><span class="hs-comment">-- subcomputation finishes.</span><span>
</span><span id="line-1776"></span><span id="local-6989586621679121740"><span class="annot"><a href="Data.ByteString.html#useAsCString"><span class="hs-identifier hs-type">useAsCString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121740"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121740"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1777"></span><span id="useAsCString"><span class="annot"><span class="annottext">useAsCString :: forall a. ByteString -&gt; (CString -&gt; IO a) -&gt; IO a
</span><a href="Data.ByteString.html#useAsCString"><span class="hs-identifier hs-var hs-var">useAsCString</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679123186"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123186"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679123187"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123187"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679123188"><span class="annot"><span class="annottext">CString -&gt; IO a
</span><a href="#local-6989586621679123188"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1778"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
forall a b. Int -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">allocaBytes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123187"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO a) -&gt; IO a) -&gt; (Ptr Word8 -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123189"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123189"><span class="hs-identifier hs-var">buf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1779"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123186"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123190"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123190"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123189"><span class="hs-identifier hs-var">buf</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123190"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123187"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1780"></span><span>    </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Word8 -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; Word8 -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123189"><span class="hs-identifier hs-var">buf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123187"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1781"></span><span>    </span><span class="annot"><span class="annottext">CString -&gt; IO a
</span><a href="#local-6989586621679123188"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CString
forall a b. Ptr a -&gt; Ptr b
</span><span class="hs-identifier hs-var">castPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123189"><span class="hs-identifier hs-var">buf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1782"></span><span>
</span><span id="line-1783"></span><span class="hs-comment">-- | /O(n) construction/ Use a @ByteString@ with a function requiring a 'CStringLen'.</span><span>
</span><span id="line-1784"></span><span class="hs-comment">-- As for 'useAsCString' this function makes a copy of the original @ByteString@.</span><span>
</span><span id="line-1785"></span><span class="hs-comment">-- It must not be stored or used after the subcomputation finishes.</span><span>
</span><span id="line-1786"></span><span class="hs-comment">--</span><span>
</span><span id="line-1787"></span><span class="hs-comment">-- Beware that this function is not required to add a terminating @\NUL@ byte at the end of the 'CStringLen' it provides.</span><span>
</span><span id="line-1788"></span><span class="hs-comment">-- If you need to construct a pointer to a null-terminated sequence, use 'useAsCString'</span><span>
</span><span id="line-1789"></span><span class="hs-comment">-- (and measure length independently if desired).</span><span>
</span><span id="line-1790"></span><span id="local-6989586621679121621"><span class="annot"><a href="Data.ByteString.html#useAsCStringLen"><span class="hs-identifier hs-type">useAsCStringLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CStringLen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121621"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1791"></span><span id="useAsCStringLen"><span class="annot"><span class="annottext">useAsCStringLen :: forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><a href="Data.ByteString.html#useAsCStringLen"><span class="hs-identifier hs-var hs-var">useAsCStringLen</span></a></span></span><span> </span><span id="local-6989586621679123193"><span class="annot"><span class="annottext">p :: ByteString
</span><a href="#local-6989586621679123193"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679123194"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123194"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679123195"><span class="annot"><span class="annottext">CStringLen -&gt; IO a
</span><a href="#local-6989586621679123195"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (CString -&gt; IO a) -&gt; IO a
forall a. ByteString -&gt; (CString -&gt; IO a) -&gt; IO a
</span><a href="Data.ByteString.html#useAsCString"><span class="hs-identifier hs-var">useAsCString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123193"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((CString -&gt; IO a) -&gt; IO a) -&gt; (CString -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123196"><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679123196"><span class="hs-identifier hs-var">cstr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CStringLen -&gt; IO a
</span><a href="#local-6989586621679123195"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679123196"><span class="hs-identifier hs-var">cstr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123194"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1792"></span><span>
</span><span id="line-1793"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1794"></span><span>
</span><span id="line-1795"></span><span class="hs-comment">-- | /O(n)./ Construct a new @ByteString@ from a @CString@. The</span><span>
</span><span id="line-1796"></span><span class="hs-comment">-- resulting @ByteString@ is an immutable copy of the original</span><span>
</span><span id="line-1797"></span><span class="hs-comment">-- @CString@, and is managed on the Haskell heap. The original</span><span>
</span><span id="line-1798"></span><span class="hs-comment">-- @CString@ must be null terminated.</span><span>
</span><span id="line-1799"></span><span class="annot"><a href="Data.ByteString.html#packCString"><span class="hs-identifier hs-type">packCString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1800"></span><span id="packCString"><span class="annot"><span class="annottext">packCString :: CString -&gt; IO ByteString
</span><a href="Data.ByteString.html#packCString"><span class="hs-identifier hs-var hs-var">packCString</span></a></span></span><span> </span><span id="local-6989586621679123197"><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679123197"><span class="hs-identifier hs-var">cstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1801"></span><span>    </span><span id="local-6989586621679123198"><span class="annot"><a href="#local-6989586621679123198"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CString -&gt; IO CSize
</span><a href="Data.ByteString.Internal.Type.html#c_strlen"><span class="hs-identifier hs-var">c_strlen</span></a></span><span> </span><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679123197"><span class="hs-identifier hs-var">cstr</span></a></span><span>
</span><span id="line-1802"></span><span>    </span><span class="annot"><a href="Data.ByteString.html#packCStringLen"><span class="hs-identifier hs-type">packCStringLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123197"><span class="hs-identifier hs-type">cstr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679123198"><span class="hs-identifier hs-type">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1803"></span><span>
</span><span id="line-1804"></span><span class="hs-comment">-- | /O(n)./ Construct a new @ByteString@ from a @CStringLen@. The</span><span>
</span><span id="line-1805"></span><span class="hs-comment">-- resulting @ByteString@ is an immutable copy of the original @CStringLen@.</span><span>
</span><span id="line-1806"></span><span class="hs-comment">-- The @ByteString@ is a normal Haskell value and will be managed on the</span><span>
</span><span id="line-1807"></span><span class="hs-comment">-- Haskell heap.</span><span>
</span><span id="line-1808"></span><span class="annot"><a href="Data.ByteString.html#packCStringLen"><span class="hs-identifier hs-type">packCStringLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CStringLen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1809"></span><span id="packCStringLen"><span class="annot"><span class="annottext">packCStringLen :: CStringLen -&gt; IO ByteString
</span><a href="Data.ByteString.html#packCStringLen"><span class="hs-identifier hs-var hs-var">packCStringLen</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679123200"><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679123200"><span class="hs-identifier hs-var">cstr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123201"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123201"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123201"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-var">createFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123201"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123202"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123202"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1810"></span><span>    </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123202"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123203"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123203"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123203"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CString -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span><span class="hs-identifier hs-var">castPtr</span></span><span> </span><span class="annot"><span class="annottext">CString
</span><a href="#local-6989586621679123200"><span class="hs-identifier hs-var">cstr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123201"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-1811"></span><span class="annot"><a href="Data.ByteString.html#packCStringLen"><span class="hs-identifier hs-var">packCStringLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123204"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123204"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1812"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ByteString
forall a. HasCallStack =&gt; FilePath -&gt; FilePath -&gt; IO a
</span><a href="Data.ByteString.html#moduleErrorIO"><span class="hs-identifier hs-var">moduleErrorIO</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;packCStringLen&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;negative length: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123204"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1813"></span><span>
</span><span id="line-1814"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1815"></span><span>
</span><span id="line-1816"></span><span class="hs-comment">-- | /O(n)/ Make a copy of the 'ByteString' with its own storage.</span><span>
</span><span id="line-1817"></span><span class="hs-comment">-- This is mainly useful to allow the rest of the data pointed</span><span>
</span><span id="line-1818"></span><span class="hs-comment">-- to by the 'ByteString' to be garbage collected, for example</span><span>
</span><span id="line-1819"></span><span class="hs-comment">-- if a large string has been read in, and only a small part of it</span><span>
</span><span id="line-1820"></span><span class="hs-comment">-- is needed in the rest of the program.</span><span>
</span><span id="line-1821"></span><span class="hs-comment">--</span><span>
</span><span id="line-1822"></span><span class="annot"><a href="Data.ByteString.html#copy"><span class="hs-identifier hs-type">copy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1823"></span><span id="copy"><span class="annot"><span class="annottext">copy :: ByteString -&gt; ByteString
</span><a href="Data.ByteString.html#copy"><span class="hs-identifier hs-var hs-var">copy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679123206"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123206"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679123207"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123207"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123207"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123208"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123208"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123208"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123206"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123207"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1824"></span><span>
</span><span id="line-1825"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1826"></span><span class="hs-comment">-- Line IO</span><span>
</span><span id="line-1827"></span><span>
</span><span id="line-1828"></span><span class="annot"><span class="hs-comment">-- | Read a line from stdin.</span></span><span>
</span><span id="line-1829"></span><span class="annot"><a href="Data.ByteString.html#getLine"><span class="hs-identifier hs-type">getLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1830"></span><span id="getLine"><span class="annot"><span class="annottext">getLine :: IO ByteString
</span><a href="Data.ByteString.html#getLine"><span class="hs-identifier hs-var hs-var">getLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGetLine"><span class="hs-identifier hs-var">hGetLine</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span>
</span><span id="line-1831"></span><span>
</span><span id="line-1832"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">getLine</span><span>
</span><span id="line-1833"></span><span>     </span><span class="hs-pragma">&quot;Deprecated since @bytestring-0.12@. Use 'Data.ByteString.Char8.getLine' instead. (Functions that rely on ASCII encodings belong in \&quot;Data.ByteString.Char8\&quot;)&quot;</span><span>
</span><span id="line-1834"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1835"></span><span>
</span><span id="line-1836"></span><span class="annot"><span class="hs-comment">-- | Read a line from a handle</span></span><span>
</span><span id="line-1837"></span><span class="annot"><a href="Data.ByteString.html#hGetLine"><span class="hs-identifier hs-type">hGetLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1838"></span><span id="hGetLine"><span class="annot"><span class="annottext">hGetLine :: Handle -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGetLine"><span class="hs-identifier hs-var hs-var">hGetLine</span></a></span></span><span> </span><span id="local-6989586621679123209"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123209"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1839"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; Handle -&gt; (Handle__ -&gt; IO ByteString) -&gt; IO ByteString
forall a. FilePath -&gt; Handle -&gt; (Handle__ -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">wantReadableHandle_</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Data.ByteString.hGetLine&quot;</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123209"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">((Handle__ -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Handle__ -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1840"></span><span>    </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679123211"><span class="annot"><span class="annottext">h_ :: Handle__
</span><a href="#local-6989586621679123211"><span class="hs-identifier hs-var">h_</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Handle__</span></span><span class="hs-special">{</span><span id="local-6989586621679123219"><span class="annot"><span class="annottext">IORef (Buffer Word8)
haByteBuffer :: IORef (Buffer Word8)
haByteBuffer :: Handle__ -&gt; IORef (Buffer Word8)
</span><a href="#local-6989586621679123219"><span class="hs-identifier hs-var hs-var">haByteBuffer</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1841"></span><span>      </span><span class="annot"><span class="annottext">Handle__ -&gt; IO ()
</span><span class="hs-identifier hs-var">flushCharReadBuffer</span></span><span> </span><span class="annot"><span class="annottext">Handle__
</span><a href="#local-6989586621679123211"><span class="hs-identifier hs-var">h_</span></a></span><span>
</span><span id="line-1842"></span><span>      </span><span id="local-6989586621679123222"><span class="annot"><a href="#local-6989586621679123222"><span class="hs-identifier hs-var">buf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IORef (Buffer Word8) -&gt; IO (Buffer Word8)
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Buffer Word8)
</span><a href="#local-6989586621679123219"><span class="hs-identifier hs-var">haByteBuffer</span></a></span><span>
</span><span id="line-1843"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">isEmptyBuffer</span></span><span> </span><span class="annot"><a href="#local-6989586621679123222"><span class="hs-identifier hs-type">buf</span></a></span><span>
</span><span id="line-1844"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621679123225"><span class="hs-identifier hs-type">fill</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123211"><span class="hs-identifier hs-type">h_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123222"><span class="hs-identifier hs-type">buf</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1845"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679123226"><span class="hs-identifier hs-type">haveBuf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123211"><span class="hs-identifier hs-type">h_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123222"><span class="hs-identifier hs-type">buf</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1846"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1847"></span><span>
</span><span id="line-1848"></span><span>  </span><span id="local-6989586621679123225"><span class="annot"><span class="annottext">fill :: Handle__ -&gt; Buffer Word8 -&gt; Int -&gt; [ByteString] -&gt; IO ByteString
</span><a href="#local-6989586621679123225"><span class="hs-identifier hs-var hs-var">fill</span></a></span></span><span> </span><span id="local-6989586621679123227"><span class="annot"><span class="annottext">h_ :: Handle__
</span><a href="#local-6989586621679123227"><span class="hs-identifier hs-var">h_</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Handle__</span></span><span class="hs-special">{</span><span id="local-6989586621679123239"><span class="annot"><span class="annottext">IORef (Buffer Word8)
haByteBuffer :: Handle__ -&gt; IORef (Buffer Word8)
haByteBuffer :: IORef (Buffer Word8)
</span><span class="hs-identifier hs-var hs-var">haByteBuffer</span></span></span><span class="hs-special">,</span><span id="local-6989586621679123240"><span class="annot"><span class="annottext">dev
haDevice :: dev
haDevice :: ()
</span><a href="#local-6989586621679123240"><span class="hs-identifier hs-var hs-var">haDevice</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679123242"><span class="annot"><span class="annottext">Buffer Word8
</span><a href="#local-6989586621679123242"><span class="hs-identifier hs-var">buf</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679123243"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123243"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679123244"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679123244"><span class="hs-identifier hs-var">xss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1849"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679123245"><span class="annot"><a href="#local-6989586621679123245"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679123246"><span class="annot"><a href="#local-6989586621679123246"><span class="hs-identifier hs-var">buf'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">dev -&gt; Buffer Word8 -&gt; IO (Int, Buffer Word8)
forall dev.
BufferedIO dev =&gt;
dev -&gt; Buffer Word8 -&gt; IO (Int, Buffer Word8)
</span><span class="hs-identifier hs-var">Buffered.fillReadBuffer</span></span><span> </span><span class="annot"><span class="annottext">dev
</span><a href="#local-6989586621679123240"><span class="hs-identifier hs-var">haDevice</span></a></span><span> </span><span class="annot"><span class="annottext">Buffer Word8
</span><a href="#local-6989586621679123242"><span class="hs-identifier hs-var">buf</span></a></span><span>
</span><span id="line-1850"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679123245"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-1851"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="hs-identifier hs-type">writeIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621679123239"><span class="hs-identifier hs-type">haByteBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123242"><span class="hs-identifier hs-type">buf</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">bufR</span></span><span class="hs-glyph">=</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">bufL</span></span><span class="hs-glyph">=</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1852"></span><span>               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679123243"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-type">&gt;</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-1853"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Data.ByteString.html#mkBigPS"><span class="hs-identifier hs-type">mkBigPS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123243"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123244"><span class="hs-identifier hs-type">xss</span></a></span><span>
</span><span id="line-1854"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ioe_EOF</span></span><span>
</span><span id="line-1855"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679123226"><span class="hs-identifier hs-type">haveBuf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123227"><span class="hs-identifier hs-type">h_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123246"><span class="hs-identifier hs-type">buf'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123243"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123244"><span class="hs-identifier hs-type">xss</span></a></span><span>
</span><span id="line-1856"></span><span>
</span><span id="line-1857"></span><span>  </span><span id="local-6989586621679123226"><span class="annot"><span class="annottext">haveBuf :: Handle__ -&gt; Buffer Word8 -&gt; Int -&gt; [ByteString] -&gt; IO ByteString
</span><a href="#local-6989586621679123226"><span class="hs-identifier hs-var hs-var">haveBuf</span></a></span></span><span> </span><span id="local-6989586621679123254"><span class="annot"><span class="annottext">h_ :: Handle__
</span><a href="#local-6989586621679123254"><span class="hs-identifier hs-var">h_</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Handle__</span></span><span class="hs-special">{</span><span id="local-6989586621679123268"><span class="annot"><span class="annottext">IORef (Buffer Word8)
haByteBuffer :: Handle__ -&gt; IORef (Buffer Word8)
haByteBuffer :: IORef (Buffer Word8)
</span><span class="hs-identifier hs-var hs-var">haByteBuffer</span></span></span><span class="hs-special">}</span><span>
</span><span id="line-1858"></span><span>          </span><span id="local-6989586621679123269"><span class="annot"><span class="annottext">buf :: Buffer Word8
</span><a href="#local-6989586621679123269"><span class="hs-identifier hs-var">buf</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Buffer</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bufRaw :: forall e. Buffer e -&gt; RawBuffer e
</span><span class="hs-identifier hs-var">bufRaw</span></span><span class="hs-glyph">=</span><span id="local-6989586621679123272"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123272"><span class="hs-identifier hs-var">raw</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bufR :: forall e. Buffer e -&gt; Int
</span><span class="hs-identifier hs-var">bufR</span></span><span class="hs-glyph">=</span><span id="local-6989586621679123273"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123273"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bufL :: forall e. Buffer e -&gt; Int
</span><span class="hs-identifier hs-var">bufL</span></span><span class="hs-glyph">=</span><span id="local-6989586621679123274"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123274"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1859"></span><span>          </span><span id="local-6989586621679123275"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123275"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679123276"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679123276"><span class="hs-identifier hs-var">xss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1860"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-1861"></span><span>        </span><span id="local-6989586621679123277"><span class="annot"><a href="#local-6989586621679123277"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ForeignPtr Word8 -&gt; IO Int
</span><a href="#local-6989586621679123278"><span class="hs-identifier hs-var">findEOL</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123274"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123273"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123272"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-1862"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679123281"><span class="annot"><a href="#local-6989586621679123281"><span class="hs-identifier hs-var hs-var">new_len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123275"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123277"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123274"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1863"></span><span>        </span><span id="local-6989586621679123282"><span class="annot"><a href="#local-6989586621679123282"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.ByteString.html#mkPS"><span class="hs-identifier hs-type">mkPS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123272"><span class="hs-identifier hs-type">raw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123274"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123277"><span class="hs-identifier hs-type">off</span></a></span><span>
</span><span id="line-1864"></span><span>
</span><span id="line-1865"></span><span>      </span><span class="hs-comment">-- if eol == True, then off is the offset of the '\n'</span><span>
</span><span id="line-1866"></span><span>      </span><span class="hs-comment">-- otherwise off == w and the buffer is now empty.</span><span>
</span><span id="line-1867"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679123277"><span class="hs-identifier hs-type">off</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-type">/=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123273"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-1868"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679123273"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123277"><span class="hs-identifier hs-type">off</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-1869"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">writeIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621679123268"><span class="hs-identifier hs-type">haByteBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123269"><span class="hs-identifier hs-type">buf</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">bufL</span></span><span class="hs-glyph">=</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">bufR</span></span><span class="hs-glyph">=</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1870"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">writeIORef</span></span><span> </span><span class="annot"><a href="#local-6989586621679123268"><span class="hs-identifier hs-type">haByteBuffer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123269"><span class="hs-identifier hs-type">buf</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">bufL</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679123277"><span class="hs-identifier hs-type">off</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1871"></span><span>                    </span><span class="annot"><a href="Data.ByteString.html#mkBigPS"><span class="hs-identifier hs-type">mkBigPS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123281"><span class="hs-identifier hs-type">new_len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123282"><span class="hs-identifier hs-type">xs</span></a></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><a href="#local-6989586621679123276"><span class="hs-identifier hs-type">xss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1872"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679123225"><span class="hs-identifier hs-type">fill</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123254"><span class="hs-identifier hs-type">h_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123269"><span class="hs-identifier hs-type">buf</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">bufL</span></span><span class="hs-glyph">=</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">bufR</span></span><span class="hs-glyph">=</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><a href="#local-6989586621679123281"><span class="hs-identifier hs-type">new_len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123282"><span class="hs-identifier hs-type">xs</span></a></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><a href="#local-6989586621679123276"><span class="hs-identifier hs-type">xss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1873"></span><span>
</span><span id="line-1874"></span><span>  </span><span class="hs-comment">-- find the end-of-line character, if there is one</span><span>
</span><span id="line-1875"></span><span>  </span><span id="local-6989586621679123278"><span class="annot"><span class="annottext">findEOL :: Int -&gt; Int -&gt; ForeignPtr Word8 -&gt; IO Int
</span><a href="#local-6989586621679123278"><span class="hs-identifier hs-var hs-var">findEOL</span></a></span></span><span> </span><span id="local-6989586621679123293"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123293"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679123294"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123294"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679123295"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123295"><span class="hs-identifier hs-var">raw</span></a></span></span><span>
</span><span id="line-1876"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123293"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123294"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO Int
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123294"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1877"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-1878"></span><span>            </span><span id="local-6989586621679123296"><span class="annot"><a href="#local-6989586621679123296"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO Word8
</span><span class="hs-identifier hs-var">readWord8Buf</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123295"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123293"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1879"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679123296"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ord</span></span><span> </span><span class="annot"><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1880"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679123293"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-comment">-- NB. not r+1: don't include the '\n'</span><span>
</span><span id="line-1881"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679123278"><span class="hs-identifier hs-type">findEOL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123293"><span class="hs-identifier hs-type">r</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679123294"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123295"><span class="hs-identifier hs-type">raw</span></a></span><span>
</span><span id="line-1882"></span><span>
</span><span id="line-1883"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">hGetLine</span><span>
</span><span id="line-1884"></span><span>     </span><span class="hs-pragma">&quot;Deprecated since @bytestring-0.12@. Use 'Data.ByteString.Char8.hGetLine' instead. (Functions that rely on ASCII encodings belong in \&quot;Data.ByteString.Char8\&quot;)&quot;</span><span>
</span><span id="line-1885"></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1886"></span><span>
</span><span id="line-1887"></span><span class="annot"><a href="Data.ByteString.html#mkPS"><span class="hs-identifier hs-type">mkPS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RawBuffer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1888"></span><span id="mkPS"><span class="annot"><span class="annottext">mkPS :: ForeignPtr Word8 -&gt; Int -&gt; Int -&gt; IO ByteString
</span><a href="Data.ByteString.html#mkPS"><span class="hs-identifier hs-var hs-var">mkPS</span></a></span></span><span> </span><span id="local-6989586621679123298"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123298"><span class="hs-identifier hs-var">buf</span></a></span></span><span> </span><span id="local-6989586621679123299"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123299"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679123300"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123300"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1889"></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-var">createFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123301"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123302"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123302"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123302"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123298"><span class="hs-identifier hs-var">buf</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123299"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123301"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-1890"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1891"></span><span>   </span><span id="local-6989586621679123301"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679123301"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123300"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123299"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-1892"></span><span>
</span><span id="line-1893"></span><span class="annot"><a href="Data.ByteString.html#mkBigPS"><span class="hs-identifier hs-type">mkBigPS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1894"></span><span id="mkBigPS"><span class="annot"><span class="annottext">mkBigPS :: Int -&gt; [ByteString] -&gt; IO ByteString
</span><a href="Data.ByteString.html#mkBigPS"><span class="hs-identifier hs-var hs-var">mkBigPS</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679123304"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123304"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123304"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1895"></span><span class="annot"><a href="Data.ByteString.html#mkBigPS"><span class="hs-identifier hs-var">mkBigPS</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679123305"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679123305"><span class="hs-identifier hs-var">pss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ByteString) -&gt; ByteString -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="Data.ByteString.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">P.reverse</span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679123305"><span class="hs-identifier hs-var">pss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1896"></span><span>
</span><span id="line-1897"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1898"></span><span class="hs-comment">-- Block IO</span><span>
</span><span id="line-1899"></span><span>
</span><span id="line-1900"></span><span class="annot"><span class="hs-comment">-- | Outputs a 'ByteString' to the specified 'Handle'.</span></span><span>
</span><span id="line-1901"></span><span class="annot"><a href="Data.ByteString.html#hPut"><span class="hs-identifier hs-type">hPut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1902"></span><span id="hPut"><span class="annot"><span class="annottext">hPut :: Handle -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#hPut"><span class="hs-identifier hs-var hs-var">hPut</span></a></span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1903"></span><span class="annot"><a href="Data.ByteString.html#hPut"><span class="hs-identifier hs-var">hPut</span></a></span><span> </span><span id="local-6989586621679123306"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123306"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679123307"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123307"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679123308"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123308"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123307"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123309"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123309"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutBuf</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123306"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123309"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123308"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span class="hs-comment">-- | Similar to 'hPut' except that it will never block. Instead it returns</span><span>
</span><span id="line-1906"></span><span class="hs-comment">-- any tail that did not get written. This tail may be 'empty' in the case that</span><span>
</span><span id="line-1907"></span><span class="hs-comment">-- the whole string was written, or the whole original string if nothing was</span><span>
</span><span id="line-1908"></span><span class="hs-comment">-- written. Partial writes are also possible.</span><span>
</span><span id="line-1909"></span><span class="hs-comment">--</span><span>
</span><span id="line-1910"></span><span class="hs-comment">-- Note: on Windows and with Haskell implementation other than GHC, this</span><span>
</span><span id="line-1911"></span><span class="hs-comment">-- function does not work correctly; it behaves identically to 'hPut'.</span><span>
</span><span id="line-1912"></span><span class="hs-comment">--</span><span>
</span><span id="line-1913"></span><span class="annot"><a href="Data.ByteString.html#hPutNonBlocking"><span class="hs-identifier hs-type">hPutNonBlocking</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1914"></span><span id="hPutNonBlocking"><span class="annot"><span class="annottext">hPutNonBlocking :: Handle -&gt; ByteString -&gt; IO ByteString
</span><a href="Data.ByteString.html#hPutNonBlocking"><span class="hs-identifier hs-var hs-var">hPutNonBlocking</span></a></span></span><span> </span><span id="local-6989586621679123310"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123310"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679123311"><span class="annot"><span class="annottext">bs :: ByteString
</span><a href="#local-6989586621679123311"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679123312"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123312"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679123313"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123313"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1915"></span><span>  </span><span id="local-6989586621679123314"><span class="annot"><a href="#local-6989586621679123314"><span class="hs-identifier hs-var">bytesWritten</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123312"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Int) -&gt; IO Int)
-&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123315"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123315"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Ptr Word8 -&gt; Int -&gt; IO Int
forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO Int
</span><span class="hs-identifier hs-var">hPutBufNonBlocking</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123310"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123315"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123313"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1916"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#drop"><span class="hs-identifier hs-type">drop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123314"><span class="hs-identifier hs-type">bytesWritten</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123311"><span class="hs-identifier hs-type">bs</span></a></span><span>
</span><span id="line-1917"></span><span>
</span><span id="line-1918"></span><span class="annot"><span class="hs-comment">-- | A synonym for 'hPut', for compatibility</span></span><span>
</span><span id="line-1919"></span><span class="annot"><a href="Data.ByteString.html#hPutStr"><span class="hs-identifier hs-type">hPutStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1920"></span><span id="hPutStr"><span class="annot"><span class="annottext">hPutStr :: Handle -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#hPutStr"><span class="hs-identifier hs-var hs-var">hPutStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#hPut"><span class="hs-identifier hs-var">hPut</span></a></span><span>
</span><span id="line-1921"></span><span>
</span><span id="line-1922"></span><span class="annot"><span class="hs-comment">-- | Write a ByteString to 'stdout'.</span></span><span>
</span><span id="line-1923"></span><span class="annot"><a href="Data.ByteString.html#putStr"><span class="hs-identifier hs-type">putStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1924"></span><span id="putStr"><span class="annot"><span class="annottext">putStr :: ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#putStr"><span class="hs-identifier hs-var hs-var">putStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#hPut"><span class="hs-identifier hs-var">hPut</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1925"></span><span>
</span><span id="line-1926"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1927"></span><span class="hs-comment">-- Low level IO</span><span>
</span><span id="line-1928"></span><span>
</span><span id="line-1929"></span><span class="hs-comment">-- | Read a 'ByteString' directly from the specified 'Handle'.  This</span><span>
</span><span id="line-1930"></span><span class="hs-comment">-- is far more efficient than reading the characters into a 'String'</span><span>
</span><span id="line-1931"></span><span class="hs-comment">-- and then using 'pack'. First argument is the Handle to read from,</span><span>
</span><span id="line-1932"></span><span class="hs-comment">-- and the second is the number of bytes to read. It returns the bytes</span><span>
</span><span id="line-1933"></span><span class="hs-comment">-- read, up to n, or 'empty' if EOF has been reached.</span><span>
</span><span id="line-1934"></span><span class="hs-comment">--</span><span>
</span><span id="line-1935"></span><span class="hs-comment">-- 'hGet' is implemented in terms of 'hGetBuf'.</span><span>
</span><span id="line-1936"></span><span class="hs-comment">--</span><span>
</span><span id="line-1937"></span><span class="hs-comment">-- If the handle is a pipe or socket, and the writing end</span><span>
</span><span id="line-1938"></span><span class="hs-comment">-- is closed, 'hGet' will behave as if EOF was reached.</span><span>
</span><span id="line-1939"></span><span class="hs-comment">--</span><span>
</span><span id="line-1940"></span><span class="annot"><a href="Data.ByteString.html#hGet"><span class="hs-identifier hs-type">hGet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1941"></span><span id="hGet"><span class="annot"><span class="annottext">hGet :: Handle -&gt; Int -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGet"><span class="hs-identifier hs-var hs-var">hGet</span></a></span></span><span> </span><span id="local-6989586621679123316"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123316"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679123317"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123317"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-1942"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123317"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-identifier hs-var">createFpAndTrim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123317"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123318"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123318"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1943"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123318"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Int) -&gt; IO Int)
-&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123319"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123319"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Ptr Word8 -&gt; Int -&gt; IO Int
forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO Int
</span><span class="hs-identifier hs-var">hGetBuf</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123316"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123319"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123317"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1944"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123317"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-1945"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; Int -&gt; IO ByteString
forall a. Handle -&gt; FilePath -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.html#illegalBufferSize"><span class="hs-identifier hs-var">illegalBufferSize</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123316"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;hGet&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123317"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1946"></span><span>
</span><span id="line-1947"></span><span class="hs-comment">-- | hGetNonBlocking is similar to 'hGet', except that it will never block</span><span>
</span><span id="line-1948"></span><span class="hs-comment">-- waiting for data to become available, instead it returns only whatever data</span><span>
</span><span id="line-1949"></span><span class="hs-comment">-- is available.  If there is no data available to be read, 'hGetNonBlocking'</span><span>
</span><span id="line-1950"></span><span class="hs-comment">-- returns 'empty'.</span><span>
</span><span id="line-1951"></span><span class="hs-comment">--</span><span>
</span><span id="line-1952"></span><span class="hs-comment">-- Note: on Windows and with Haskell implementation other than GHC, this</span><span>
</span><span id="line-1953"></span><span class="hs-comment">-- function does not work correctly; it behaves identically to 'hGet'.</span><span>
</span><span id="line-1954"></span><span class="hs-comment">--</span><span>
</span><span id="line-1955"></span><span class="annot"><a href="Data.ByteString.html#hGetNonBlocking"><span class="hs-identifier hs-type">hGetNonBlocking</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1956"></span><span id="hGetNonBlocking"><span class="annot"><span class="annottext">hGetNonBlocking :: Handle -&gt; Int -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGetNonBlocking"><span class="hs-identifier hs-var hs-var">hGetNonBlocking</span></a></span></span><span> </span><span id="local-6989586621679123321"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123321"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679123322"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123322"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-1957"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123322"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-identifier hs-var">createFpAndTrim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123322"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123323"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123323"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1958"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123323"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Int) -&gt; IO Int)
-&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123324"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123324"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Ptr Word8 -&gt; Int -&gt; IO Int
forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO Int
</span><span class="hs-identifier hs-var">hGetBufNonBlocking</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123321"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123324"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123322"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1959"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123322"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-1960"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; Int -&gt; IO ByteString
forall a. Handle -&gt; FilePath -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.html#illegalBufferSize"><span class="hs-identifier hs-var">illegalBufferSize</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123321"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;hGetNonBlocking&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123322"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1961"></span><span>
</span><span id="line-1962"></span><span class="hs-comment">-- | Like 'hGet', except that a shorter 'ByteString' may be returned</span><span>
</span><span id="line-1963"></span><span class="hs-comment">-- if there are not enough bytes immediately available to satisfy the</span><span>
</span><span id="line-1964"></span><span class="hs-comment">-- whole request.  'hGetSome' only blocks if there is no data</span><span>
</span><span id="line-1965"></span><span class="hs-comment">-- available, and EOF has not yet been reached.</span><span>
</span><span id="line-1966"></span><span class="hs-comment">--</span><span>
</span><span id="line-1967"></span><span class="annot"><a href="Data.ByteString.html#hGetSome"><span class="hs-identifier hs-type">hGetSome</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1968"></span><span id="hGetSome"><span class="annot"><span class="annottext">hGetSome :: Handle -&gt; Int -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGetSome"><span class="hs-identifier hs-var hs-var">hGetSome</span></a></span></span><span> </span><span id="local-6989586621679123325"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123325"><span class="hs-identifier hs-var">hh</span></a></span></span><span> </span><span id="local-6989586621679123326"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123326"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-1969"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123326"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-identifier hs-var">createFpAndTrim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123326"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123327"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123327"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1970"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123327"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Int) -&gt; IO Int)
-&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123328"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123328"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Ptr Word8 -&gt; Int -&gt; IO Int
forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO Int
</span><span class="hs-identifier hs-var">hGetBufSome</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123325"><span class="hs-identifier hs-var">hh</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123328"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123326"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1971"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123326"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-1972"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; Int -&gt; IO ByteString
forall a. Handle -&gt; FilePath -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.html#illegalBufferSize"><span class="hs-identifier hs-var">illegalBufferSize</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123325"><span class="hs-identifier hs-var">hh</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;hGetSome&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123326"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1973"></span><span>
</span><span id="line-1974"></span><span id="local-6989586621679121770"><span class="annot"><a href="Data.ByteString.html#illegalBufferSize"><span class="hs-identifier hs-type">illegalBufferSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121770"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1975"></span><span id="illegalBufferSize"><span class="annot"><span class="annottext">illegalBufferSize :: forall a. Handle -&gt; FilePath -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.html#illegalBufferSize"><span class="hs-identifier hs-var hs-var">illegalBufferSize</span></a></span></span><span> </span><span id="local-6989586621679123331"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123331"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span id="local-6989586621679123332"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123332"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679123333"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123333"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1976"></span><span>    </span><span class="annot"><span class="annottext">IOException -&gt; IO a
forall a. HasCallStack =&gt; IOException -&gt; IO a
</span><span class="hs-identifier hs-var">ioError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOErrorType
-&gt; FilePath -&gt; Maybe Handle -&gt; Maybe FilePath -&gt; IOException
</span><span class="hs-identifier hs-var">mkIOError</span></span><span> </span><span class="annot"><span class="annottext">IOErrorType
</span><span class="hs-identifier hs-var">illegalOperationErrorType</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123335"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Maybe Handle
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123331"><span class="hs-identifier hs-var">handle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-1977"></span><span>    </span><span class="hs-comment">--TODO: System.IO uses InvalidArgument here, but it's not exported :-(</span><span>
</span><span id="line-1978"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1979"></span><span>      </span><span id="local-6989586621679123335"><span class="annot"><span class="annottext">msg :: FilePath
</span><a href="#local-6989586621679123335"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123332"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;: illegal ByteString size &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; FilePath -&gt; FilePath
forall a. Show a =&gt; Int -&gt; a -&gt; FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123333"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1980"></span><span>
</span><span id="line-1981"></span><span>
</span><span id="line-1982"></span><span class="hs-comment">-- | Read a handle's entire contents strictly into a 'ByteString'.</span><span>
</span><span id="line-1983"></span><span class="hs-comment">--</span><span>
</span><span id="line-1984"></span><span class="hs-comment">-- This function reads chunks at a time, increasing the chunk size on each</span><span>
</span><span id="line-1985"></span><span class="hs-comment">-- read. The final string is then reallocated to the appropriate size. For</span><span>
</span><span id="line-1986"></span><span class="hs-comment">-- files &gt; half of available memory, this may lead to memory exhaustion.</span><span>
</span><span id="line-1987"></span><span class="hs-comment">-- Consider using 'readFile' in this case.</span><span>
</span><span id="line-1988"></span><span class="hs-comment">--</span><span>
</span><span id="line-1989"></span><span class="hs-comment">-- The Handle is closed once the contents have been read,</span><span>
</span><span id="line-1990"></span><span class="hs-comment">-- or if an exception is thrown.</span><span>
</span><span id="line-1991"></span><span class="hs-comment">--</span><span>
</span><span id="line-1992"></span><span class="annot"><a href="Data.ByteString.html#hGetContents"><span class="hs-identifier hs-type">hGetContents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-1993"></span><span id="hGetContents"><span class="annot"><span class="annottext">hGetContents :: Handle -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGetContents"><span class="hs-identifier hs-var hs-var">hGetContents</span></a></span></span><span> </span><span id="local-6989586621679123338"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123338"><span class="hs-identifier hs-var">hnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1994"></span><span>    </span><span id="local-6989586621679123339"><span class="annot"><a href="#local-6989586621679123339"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; Int -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGetContentsSizeHint"><span class="hs-identifier hs-var">hGetContentsSizeHint</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123338"><span class="hs-identifier hs-var">hnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1024</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2048</span></span><span>
</span><span id="line-1995"></span><span>            </span><span class="annot"><span class="annottext">IO ByteString -&gt; IO () -&gt; IO ByteString
forall a b. IO a -&gt; IO b -&gt; IO a
</span><span class="hs-operator hs-var">`finally`</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123338"><span class="hs-identifier hs-var">hnd</span></a></span><span>
</span><span id="line-1996"></span><span>    </span><span class="hs-comment">-- don't waste too much space for small files:</span><span>
</span><span id="line-1997"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Data.ByteString.html#length"><span class="hs-identifier hs-type">length</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123339"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-type">&lt;</span></a></span><span> </span><span class="annot"><span class="hs-number">900</span></span><span>
</span><span id="line-1998"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#copy"><span class="hs-identifier hs-type">copy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123339"><span class="hs-identifier hs-type">bs</span></a></span><span>
</span><span id="line-1999"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679123339"><span class="hs-identifier hs-type">bs</span></a></span><span>
</span><span id="line-2000"></span><span>
</span><span id="line-2001"></span><span class="annot"><a href="Data.ByteString.html#hGetContentsSizeHint"><span class="hs-identifier hs-type">hGetContentsSizeHint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-2002"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ first read size</span></span><span>
</span><span id="line-2003"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ initial buffer size increment</span></span><span>
</span><span id="line-2004"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-2005"></span><span id="hGetContentsSizeHint"><span class="annot"><span class="annottext">hGetContentsSizeHint :: Handle -&gt; Int -&gt; Int -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGetContentsSizeHint"><span class="hs-identifier hs-var hs-var">hGetContentsSizeHint</span></a></span></span><span> </span><span id="local-6989586621679123341"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123341"><span class="hs-identifier hs-var">hnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2006"></span><span>    </span><span class="annot"><span class="annottext">[ByteString] -&gt; Int -&gt; Int -&gt; IO ByteString
</span><a href="#local-6989586621679123342"><span class="hs-identifier hs-var">readChunks</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2007"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2008"></span><span>    </span><span id="local-6989586621679123342"><span class="annot"><span class="annottext">readChunks :: [ByteString] -&gt; Int -&gt; Int -&gt; IO ByteString
</span><a href="#local-6989586621679123342"><span class="hs-identifier hs-var hs-var">readChunks</span></a></span></span><span> </span><span id="local-6989586621679123352"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679123352"><span class="hs-identifier hs-var">chunks</span></a></span></span><span> </span><span id="local-6989586621679123353"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123353"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621679123354"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123354"><span class="hs-identifier hs-var">sz'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2009"></span><span>      </span><span id="local-6989586621679123355"><span class="annot"><a href="#local-6989586621679123355"><span class="hs-identifier hs-var">fp</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123353"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-2010"></span><span>      </span><span id="local-6989586621679123356"><span class="annot"><a href="#local-6989586621679123356"><span class="hs-identifier hs-var">readcount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679123355"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123357"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123357"><span class="hs-identifier hs-var">buf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Ptr Word8 -&gt; Int -&gt; IO Int
forall a. Handle -&gt; Ptr a -&gt; Int -&gt; IO Int
</span><span class="hs-identifier hs-var">hGetBuf</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123341"><span class="hs-identifier hs-var">hnd</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679123357"><span class="hs-identifier hs-var">buf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123353"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-2011"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679123358"><span class="annot"><a href="#local-6989586621679123358"><span class="hs-identifier hs-var hs-var">chunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679123355"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123356"><span class="hs-identifier hs-var">readcount</span></a></span><span>
</span><span id="line-2012"></span><span>      </span><span class="hs-comment">-- We rely on the hGetBuf behaviour (not hGetBufSome) where it reads up</span><span>
</span><span id="line-2013"></span><span>      </span><span class="hs-comment">-- to the size we ask for, or EOF. So short reads indicate EOF.</span><span>
</span><span id="line-2014"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679123356"><span class="hs-identifier hs-type">readcount</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-type">&lt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123353"><span class="hs-identifier hs-type">sz</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123353"><span class="hs-identifier hs-type">sz</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-type">&gt;</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-2015"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="Data.ByteString.html#concat"><span class="hs-identifier hs-type">concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">P.reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123358"><span class="hs-identifier hs-type">chunk</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123352"><span class="hs-identifier hs-type">chunks</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2016"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679123342"><span class="hs-identifier hs-type">readChunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123358"><span class="hs-identifier hs-type">chunk</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123352"><span class="hs-identifier hs-type">chunks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679123354"><span class="hs-identifier hs-type">sz'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123353"><span class="hs-identifier hs-type">sz</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><a href="#local-6989586621679123354"><span class="hs-identifier hs-type">sz'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#min"><span class="hs-operator hs-type">`min`</span></a></span><span> </span><span class="annot"><span class="hs-number">32752</span></span><span class="hs-special">)</span><span>
</span><span id="line-2017"></span><span>             </span><span class="hs-comment">-- we grow the buffer sizes, but not too huge</span><span>
</span><span id="line-2018"></span><span>             </span><span class="hs-comment">-- we concatenate in the end anyway</span><span>
</span><span id="line-2019"></span><span>
</span><span id="line-2020"></span><span class="hs-comment">-- | getContents. Read stdin strictly. Equivalent to hGetContents stdin</span><span>
</span><span id="line-2021"></span><span class="hs-comment">-- The 'Handle' is closed after the contents have been read.</span><span>
</span><span id="line-2022"></span><span class="hs-comment">--</span><span>
</span><span id="line-2023"></span><span class="annot"><a href="Data.ByteString.html#getContents"><span class="hs-identifier hs-type">getContents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-2024"></span><span id="getContents"><span class="annot"><span class="annottext">getContents :: IO ByteString
</span><a href="Data.ByteString.html#getContents"><span class="hs-identifier hs-var hs-var">getContents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ByteString
</span><a href="Data.ByteString.html#hGetContents"><span class="hs-identifier hs-var">hGetContents</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span>
</span><span id="line-2025"></span><span>
</span><span id="line-2026"></span><span class="hs-comment">-- | The interact function takes a function of type @ByteString -&gt; ByteString@</span><span>
</span><span id="line-2027"></span><span class="hs-comment">-- as its argument. The entire input from the standard input device is passed</span><span>
</span><span id="line-2028"></span><span class="hs-comment">-- to this function as its argument, and the resulting string is output on the</span><span>
</span><span id="line-2029"></span><span class="hs-comment">-- standard output device.</span><span>
</span><span id="line-2030"></span><span class="hs-comment">--</span><span>
</span><span id="line-2031"></span><span class="annot"><a href="Data.ByteString.html#interact"><span class="hs-identifier hs-type">interact</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2032"></span><span id="interact"><span class="annot"><span class="annottext">interact :: (ByteString -&gt; ByteString) -&gt; IO ()
</span><a href="Data.ByteString.html#interact"><span class="hs-identifier hs-var hs-var">interact</span></a></span></span><span> </span><span id="local-6989586621679123359"><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679123359"><span class="hs-identifier hs-var">transformer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#putStr"><span class="hs-identifier hs-var">putStr</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ())
-&gt; (ByteString -&gt; ByteString) -&gt; ByteString -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="#local-6989586621679123359"><span class="hs-identifier hs-var">transformer</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; IO ByteString -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO ByteString
</span><a href="Data.ByteString.html#getContents"><span class="hs-identifier hs-var">getContents</span></a></span><span>
</span><span id="line-2033"></span><span>
</span><span id="line-2034"></span><span class="hs-comment">-- | Read an entire file strictly into a 'ByteString'.</span><span>
</span><span id="line-2035"></span><span class="hs-comment">--</span><span>
</span><span id="line-2036"></span><span class="annot"><a href="Data.ByteString.html#readFile"><span class="hs-identifier hs-type">readFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-2037"></span><span id="readFile"><span class="annot"><span class="annottext">readFile :: FilePath -&gt; IO ByteString
</span><a href="Data.ByteString.html#readFile"><span class="hs-identifier hs-var hs-var">readFile</span></a></span></span><span> </span><span id="local-6989586621679123361"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123361"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2038"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; IOMode -&gt; (Handle -&gt; IO ByteString) -&gt; IO ByteString
forall r. FilePath -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withBinaryFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123361"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">ReadMode</span></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Handle -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679123363"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123363"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2039"></span><span>      </span><span class="hs-comment">-- hFileSize fails if file is not regular file (like</span><span>
</span><span id="line-2040"></span><span>      </span><span class="hs-comment">-- /dev/null). Catch exception and try reading anyway.</span><span>
</span><span id="line-2041"></span><span>      </span><span id="local-6989586621679123364"><span class="annot"><a href="#local-6989586621679123364"><span class="hs-identifier hs-var">filesz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Integer -&gt; (IOException -&gt; IO Integer) -&gt; IO Integer
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; IO Integer
</span><span class="hs-identifier hs-var">hFileSize</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679123363"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IOException -&gt; IO Integer
</span><a href="#local-6989586621679123365"><span class="hs-identifier hs-var">useZeroIfNotRegularFile</span></a></span><span>
</span><span id="line-2042"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679123374"><span class="annot"><a href="#local-6989586621679123374"><span class="hs-identifier hs-var hs-var">readsz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679123364"><span class="hs-identifier hs-var">filesz</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#max"><span class="hs-operator hs-var">`max`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-2043"></span><span>      </span><span class="annot"><a href="Data.ByteString.html#hGetContentsSizeHint"><span class="hs-identifier hs-type">hGetContentsSizeHint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123363"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679123374"><span class="hs-identifier hs-type">readsz</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679123374"><span class="hs-identifier hs-type">readsz</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#max"><span class="hs-operator hs-type">`max`</span></a></span><span> </span><span class="annot"><span class="hs-number">255</span></span><span class="hs-special">)</span><span>
</span><span id="line-2044"></span><span>      </span><span class="hs-comment">-- Our initial size is one bigger than the file size so that in the</span><span>
</span><span id="line-2045"></span><span>      </span><span class="hs-comment">-- typical case we will read the whole file in one go and not have</span><span>
</span><span id="line-2046"></span><span>      </span><span class="hs-comment">-- to allocate any more chunks. We'll still do the right thing if the</span><span>
</span><span id="line-2047"></span><span>      </span><span class="hs-comment">-- file size is 0 or is changed before we do the read.</span><span>
</span><span id="line-2048"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2049"></span><span>    </span><span class="annot"><a href="#local-6989586621679123365"><span class="hs-identifier hs-type">useZeroIfNotRegularFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-2050"></span><span>    </span><span id="local-6989586621679123365"><span class="annot"><span class="annottext">useZeroIfNotRegularFile :: IOException -&gt; IO Integer
</span><a href="#local-6989586621679123365"><span class="hs-identifier hs-var hs-var">useZeroIfNotRegularFile</span></a></span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; IO Integer
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2051"></span><span>
</span><span id="line-2052"></span><span class="annot"><a href="Data.ByteString.html#modifyFile"><span class="hs-identifier hs-type">modifyFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOMode</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2053"></span><span id="modifyFile"><span class="annot"><span class="annottext">modifyFile :: IOMode -&gt; FilePath -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#modifyFile"><span class="hs-identifier hs-var hs-var">modifyFile</span></a></span></span><span> </span><span id="local-6989586621679123377"><span class="annot"><span class="annottext">IOMode
</span><a href="#local-6989586621679123377"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679123378"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123378"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679123379"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123379"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IOMode -&gt; (Handle -&gt; IO ()) -&gt; IO ()
forall r. FilePath -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withBinaryFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123378"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="#local-6989586621679123377"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#hPut"><span class="hs-operator hs-var">`hPut`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123379"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2054"></span><span>
</span><span id="line-2055"></span><span class="annot"><span class="hs-comment">-- | Write a 'ByteString' to a file.</span></span><span>
</span><span id="line-2056"></span><span class="annot"><a href="Data.ByteString.html#writeFile"><span class="hs-identifier hs-type">writeFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2057"></span><span id="writeFile"><span class="annot"><span class="annottext">writeFile :: FilePath -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#writeFile"><span class="hs-identifier hs-var hs-var">writeFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOMode -&gt; FilePath -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#modifyFile"><span class="hs-identifier hs-var">modifyFile</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span>
</span><span id="line-2058"></span><span>
</span><span id="line-2059"></span><span class="annot"><span class="hs-comment">-- | Append a 'ByteString' to a file.</span></span><span>
</span><span id="line-2060"></span><span class="annot"><a href="Data.ByteString.html#appendFile"><span class="hs-identifier hs-type">appendFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2061"></span><span id="appendFile"><span class="annot"><span class="annottext">appendFile :: FilePath -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#appendFile"><span class="hs-identifier hs-var hs-var">appendFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOMode -&gt; FilePath -&gt; ByteString -&gt; IO ()
</span><a href="Data.ByteString.html#modifyFile"><span class="hs-identifier hs-var">modifyFile</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">AppendMode</span></span><span>
</span><span id="line-2062"></span><span>
</span><span id="line-2063"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-2064"></span><span class="hs-comment">-- Internal utilities</span><span>
</span><span id="line-2065"></span><span>
</span><span id="line-2066"></span><span class="hs-comment">-- Common up near identical calls to `error' to reduce the number</span><span>
</span><span id="line-2067"></span><span class="hs-comment">-- constant strings created when compiled:</span><span>
</span><span id="line-2068"></span><span id="local-6989586621679121629"><span class="annot"><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-type">errorEmptyList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121629"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2069"></span><span id="errorEmptyList"><span class="annot"><span class="annottext">errorEmptyList :: forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#errorEmptyList"><span class="hs-identifier hs-var hs-var">errorEmptyList</span></a></span></span><span> </span><span id="local-6989586621679123385"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123385"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; a
forall a. HasCallStack =&gt; FilePath -&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#moduleError"><span class="hs-identifier hs-var">moduleError</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123385"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;empty ByteString&quot;</span></span><span>
</span><span id="line-2070"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#errorEmptyList"><span class="hs-pragma hs-type">errorEmptyList</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2071"></span><span>
</span><span id="line-2072"></span><span id="local-6989586621679121696"><span class="annot"><a href="Data.ByteString.html#moduleError"><span class="hs-identifier hs-type">moduleError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679121696"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2073"></span><span id="moduleError"><span class="annot"><span class="annottext">moduleError :: forall a. HasCallStack =&gt; FilePath -&gt; FilePath -&gt; a
</span><a href="Data.ByteString.html#moduleError"><span class="hs-identifier hs-var hs-var">moduleError</span></a></span></span><span> </span><span id="local-6989586621679123389"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123389"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621679123390"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123390"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; a
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="Data.ByteString.html#moduleErrorMsg"><span class="hs-identifier hs-var">moduleErrorMsg</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123389"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123390"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2074"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#moduleError"><span class="hs-pragma hs-type">moduleError</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2075"></span><span>
</span><span id="line-2076"></span><span id="local-6989586621679121747"><span class="annot"><a href="Data.ByteString.html#moduleErrorIO"><span class="hs-identifier hs-type">moduleErrorIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679121747"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-2077"></span><span id="moduleErrorIO"><span class="annot"><span class="annottext">moduleErrorIO :: forall a. HasCallStack =&gt; FilePath -&gt; FilePath -&gt; IO a
</span><a href="Data.ByteString.html#moduleErrorIO"><span class="hs-identifier hs-var hs-var">moduleErrorIO</span></a></span></span><span> </span><span id="local-6989586621679123397"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123397"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621679123398"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123398"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOException -&gt; IO a
forall e a. (HasCallStack, Exception e) =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(IOException -&gt; IO a)
-&gt; (FilePath -&gt; IOException) -&gt; FilePath -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IOException
</span><span class="hs-identifier hs-var">userError</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO a) -&gt; FilePath -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="Data.ByteString.html#moduleErrorMsg"><span class="hs-identifier hs-var">moduleErrorMsg</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123397"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123398"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-2078"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Data.ByteString.html#moduleErrorIO"><span class="hs-pragma hs-type">moduleErrorIO</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2079"></span><span>
</span><span id="line-2080"></span><span class="annot"><a href="Data.ByteString.html#moduleErrorMsg"><span class="hs-identifier hs-type">moduleErrorMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-2081"></span><span id="moduleErrorMsg"><span class="annot"><span class="annottext">moduleErrorMsg :: FilePath -&gt; FilePath -&gt; FilePath
</span><a href="Data.ByteString.html#moduleErrorMsg"><span class="hs-identifier hs-var hs-var">moduleErrorMsg</span></a></span></span><span> </span><span id="local-6989586621679123400"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123400"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621679123401"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123401"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Data.ByteString.&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123400"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="annot"><span class="annottext">Char -&gt; FilePath -&gt; FilePath
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679123401"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-2082"></span><span>
</span><span id="line-2083"></span><span class="hs-comment">-- Find from the end of the string using predicate</span><span>
</span><span id="line-2084"></span><span class="annot"><a href="Data.ByteString.html#findFromEndUntil"><span class="hs-identifier hs-type">findFromEndUntil</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-2085"></span><span id="findFromEndUntil"><span class="annot"><span class="annottext">findFromEndUntil :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.html#findFromEndUntil"><span class="hs-identifier hs-var hs-var">findFromEndUntil</span></a></span></span><span> </span><span id="local-6989586621679123402"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679123402"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679123403"><span class="annot"><span class="annottext">ps :: ByteString
</span><a href="#local-6989586621679123403"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679123404"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123404"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (ByteString, Word8)
</span><a href="Data.ByteString.html#unsnoc"><span class="hs-identifier hs-var">unsnoc</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123403"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2086"></span><span>  </span><span class="annot"><span class="annottext">Maybe (ByteString, Word8)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-2087"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679123405"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123405"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679123406"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123406"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2088"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679123402"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679123406"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-2089"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679123404"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-2090"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.html#findFromEndUntil"><span class="hs-identifier hs-var">findFromEndUntil</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679123402"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679123405"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2091"></span></pre></body></html>