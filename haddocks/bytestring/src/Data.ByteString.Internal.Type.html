<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE Unsafe #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK not-home #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskellQuotes #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE UnliftedFFITypes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span class="hs-cpp">

#include &quot;bytestring-cpp-macros.h&quot;
</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Module      : Data.ByteString.Internal.Type</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Copyright   : (c) Don Stewart 2006-2008</span><span>
</span><span id="line-16"></span><span class="hs-comment">--               (c) Duncan Coutts 2006-2012</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Maintainer  : dons00@gmail.com, duncan@community.haskell.org</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Stability   : unstable</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Portability : non-portable</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- The 'ByteString' type, its instances, and whatever related</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- utilities the bytestring developers see fit to use internally.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html"><span class="hs-identifier">Data.ByteString.Internal.Type</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>        </span><span class="annot"><span class="hs-comment">-- * The @ByteString@ type and representation</span></span><span>
</span><span id="line-28"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span>
</span><span id="line-29"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier">BS</span></a></span><span>
</span><span id="line-30"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#PS"><span class="hs-identifier">PS</span></a></span><span> </span><span class="hs-comment">-- backwards compatibility shim</span><span>
</span><span id="line-31"></span><span>        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#StrictByteString"><span class="hs-identifier">StrictByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Internal indexing</span></span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#findIndexOrLength"><span class="hs-identifier">findIndexOrLength</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Conversion with lists: packing and unpacking</span></span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packBytes"><span class="hs-identifier">packBytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packUptoLenBytes"><span class="hs-identifier">packUptoLenBytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenBytes"><span class="hs-identifier">unsafePackLenBytes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packChars"><span class="hs-identifier">packChars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packUptoLenChars"><span class="hs-identifier">packUptoLenChars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenChars"><span class="hs-identifier">unsafePackLenChars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackBytes"><span class="hs-identifier">unpackBytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesLazy"><span class="hs-identifier">unpackAppendBytesLazy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesStrict"><span class="hs-identifier">unpackAppendBytesStrict</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackChars"><span class="hs-identifier">unpackChars</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsLazy"><span class="hs-identifier">unpackAppendCharsLazy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsStrict"><span class="hs-identifier">unpackAppendCharsStrict</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackAddress"><span class="hs-identifier">unsafePackAddress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenAddress"><span class="hs-identifier">unsafePackLenAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLiteral"><span class="hs-identifier">unsafePackLiteral</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenLiteral"><span class="hs-identifier">unsafePackLenLiteral</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Low level imperative construction</span></span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier">empty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier">createFp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpUptoN"><span class="hs-identifier">createFpUptoN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpUptoN%27"><span class="hs-identifier">createFpUptoN'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-identifier">createFpAndTrim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpAndTrim%27"><span class="hs-identifier">createFpAndTrim'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier">unsafeCreateFp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN"><span class="hs-identifier">unsafeCreateFpUptoN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN%27"><span class="hs-identifier">unsafeCreateFpUptoN'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#create"><span class="hs-identifier">create</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createUptoN"><span class="hs-identifier">createUptoN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createUptoN%27"><span class="hs-identifier">createUptoN'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createAndTrim"><span class="hs-identifier">createAndTrim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createAndTrim%27"><span class="hs-identifier">createAndTrim'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreate"><span class="hs-identifier">unsafeCreate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateUptoN"><span class="hs-identifier">unsafeCreateUptoN</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateUptoN%27"><span class="hs-identifier">unsafeCreateUptoN'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier">mallocByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Conversion to and from ForeignPtrs</span></span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mkDeferredByteString"><span class="hs-identifier">mkDeferredByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#fromForeignPtr"><span class="hs-identifier">fromForeignPtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#toForeignPtr"><span class="hs-identifier">toForeignPtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#fromForeignPtr0"><span class="hs-identifier">fromForeignPtr0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#toForeignPtr0"><span class="hs-identifier">toForeignPtr0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#nullForeignPtr"><span class="hs-identifier">nullForeignPtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier">peekFp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier">pokeFp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier">peekFpByteOff</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier">pokeFpByteOff</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#minusForeignPtr"><span class="hs-identifier">minusForeignPtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier">memcpyFp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#deferForeignPtrAvailability"><span class="hs-identifier">deferForeignPtrAvailability</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier">unsafeDupablePerformIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#SizeOverflowException"><span class="hs-identifier">SizeOverflowException</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#overflowError"><span class="hs-identifier">overflowError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier">checkedAdd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#checkedMultiply"><span class="hs-identifier">checkedMultiply</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Standard C Functions</span></span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_strlen"><span class="hs-identifier">c_strlen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_free_finalizer"><span class="hs-identifier">c_free_finalizer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier">memchr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memcmp"><span class="hs-identifier">memcmp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memcpy"><span class="hs-identifier">memcpy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memset"><span class="hs-identifier">memset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><span class="hs-comment">-- * cbits functions</span></span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_reverse"><span class="hs-identifier">c_reverse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_intersperse"><span class="hs-identifier">c_intersperse</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_maximum"><span class="hs-identifier">c_maximum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_minimum"><span class="hs-identifier">c_minimum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_count"><span class="hs-identifier">c_count</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_count_ba"><span class="hs-identifier">c_count_ba</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_elem_index"><span class="hs-identifier">c_elem_index</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_sort"><span class="hs-identifier">c_sort</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_int_dec"><span class="hs-identifier">c_int_dec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_int_dec_padded9"><span class="hs-identifier">c_int_dec_padded9</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_uint_dec"><span class="hs-identifier">c_uint_dec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_uint_hex"><span class="hs-identifier">c_uint_hex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_long_long_int_dec"><span class="hs-identifier">c_long_long_int_dec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_long_long_int_dec_padded18"><span class="hs-identifier">c_long_long_int_dec_padded18</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_long_long_uint_dec"><span class="hs-identifier">c_long_long_uint_dec</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_long_long_uint_hex"><span class="hs-identifier">c_long_long_uint_hex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8BA"><span class="hs-identifier">cIsValidUtf8BA</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8BASafe"><span class="hs-identifier">cIsValidUtf8BASafe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8"><span class="hs-identifier">cIsValidUtf8</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8Safe"><span class="hs-identifier">cIsValidUtf8Safe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Chars</span></span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#w2c"><span class="hs-identifier">w2c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier">c2w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#isSpaceWord8"><span class="hs-identifier">isSpaceWord8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#isSpaceChar8"><span class="hs-identifier">isSpaceChar8</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Deprecated and unmentionable</span></span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier">accursedUnutterablePerformIO</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Exported compatibility shim</span></span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="hs-identifier">plusForeignPtr</span></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="hs-identifier">unsafeWithForeignPtr</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">concat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.ForeignPtr.html"><span class="hs-identifier">Foreign.ForeignPtr</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ForeignPtr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withForeignPtr</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Ptr.html"><span class="hs-identifier">Foreign.Ptr</span></a></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Storable.html"><span class="hs-identifier">Foreign.Storable</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Storable</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.C.Types.html"><span class="hs-identifier">Foreign.C.Types</span></a></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.C.String.html"><span class="hs-identifier">Foreign.C.String</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CString</span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Marshal.Utils.html"><span class="hs-identifier">Foreign.Marshal.Utils</span></a></span><span>
</span><span id="line-139"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Foreign.Marshal.Alloc.html"><span class="hs-identifier">Foreign.Marshal.Alloc</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">finalizerFree</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if PURE_HASKELL
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Internal.Pure</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Pure</span><span>
</span><span id="line-143"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bits</span><span>                </span><span class="hs-special">(</span><span class="hs-identifier">toIntegralSized</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bits</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>               </span><span class="hs-special">(</span><span class="hs-identifier">fromMaybe</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator">&lt;$!&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Semigroup.html"><span class="hs-identifier">Data.Semigroup</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../deepseq-1.5.1.0-6837/src/Control.DeepSeq.html"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="../../deepseq-1.5.1.0-6837/src/Control.DeepSeq.html#NFData"><span class="hs-identifier">NFData</span></a></span><span class="hs-special">(</span><span class="annot"><a href="../../deepseq-1.5.1.0-6837/src/Control.DeepSeq.html#rnf"><span class="hs-identifier">rnf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.String.html"><span class="hs-identifier">Data.String</span></a></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">assert</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">throw</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Exception</span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Bits.html"><span class="hs-identifier">Data.Bits</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Char.html"><span class="hs-identifier">Data.Char</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Data.html"><span class="hs-identifier">Data.Data</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkConstr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkNoRepType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Constr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">DataType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Fixity</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Prefix</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">constrIndex</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Base.html"><span class="hs-identifier">GHC.Base</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#nullAddr%23"><span class="hs-identifier">nullAddr#</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#realWorld%23"><span class="hs-identifier">realWorld#</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">unsafeChr</span></span><span class="hs-special">,</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.CString.html#unpackCString%23"><span class="hs-identifier">unpackCString#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Exts.html"><span class="hs-identifier">GHC.Exts</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsList</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Addr%23"><span class="hs-identifier">Addr#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#minusAddr%23"><span class="hs-identifier">minusAddr#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier">ByteArray#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Magic.html#runRW%23"><span class="hs-identifier">runRW#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Magic.html#lazy"><span class="hs-identifier">lazy</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if HS_timesInt2_PRIMOP_AVAILABLE
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Exts.html"><span class="hs-identifier">GHC.Exts</span></a></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#timesInt2%23"><span class="hs-identifier">timesInt2#</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Exts</span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">timesWord2#</span><span>
</span><span id="line-170"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">or#</span><span>
</span><span id="line-171"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">uncheckedShiftRL#</span><span>
</span><span id="line-172"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">int2Word#</span><span>
</span><span id="line-173"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">word2Int#</span><span>
</span><span id="line-174"></span><span>                               </span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Bits</span><span>               </span><span class="hs-special">(</span><span class="hs-identifier">finiteBitSize</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-178"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.IO.html"><span class="hs-identifier">GHC.IO</span></a></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier">IO</span></a></span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier">IO</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.ForeignPtr.html"><span class="hs-identifier">GHC.ForeignPtr</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ForeignPtr</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ForeignPtr</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !HS_cstringLength_AND_FinalPtr_AVAILABLE
</span><span>                                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">newForeignPtr_</span><span class="hs-cpp">
#endif
</span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mallocPlainForeignPtrBytes</span></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.ForeignPtr.html"><span class="hs-identifier">GHC.ForeignPtr</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">plusForeignPtr</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if HS_cstringLength_AND_FinalPtr_AVAILABLE
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Exts.html"><span class="hs-identifier">GHC.Exts</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.CString.html#cstringLength%23"><span class="hs-identifier">cstringLength#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.ForeignPtr.html"><span class="hs-identifier">GHC.ForeignPtr</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ForeignPtrContents</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FinalPtr</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Ptr</span><span>                  </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-194"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Int.html"><span class="hs-identifier">GHC.Int</span></a></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier">Int</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">

#if HS_unsafeWithForeignPtr_AVAILABLE
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.ForeignPtr.html"><span class="hs-identifier">GHC.ForeignPtr</span></a></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeWithForeignPtr</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-200"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../template-haskell-2.23.0.0-c7f4/src/Language.Haskell.TH.Lib.html"><span class="hs-identifier">Language.Haskell.TH.Lib</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span>
</span><span id="line-201"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../template-haskell-2.23.0.0-c7f4/src/Language.Haskell.TH.Syntax.html"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span class="hs-cpp">

#if !HS_unsafeWithForeignPtr_AVAILABLE
</span><span class="hs-identifier">unsafeWithForeignPtr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ForeignPtr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-205"></span><span class="hs-identifier">unsafeWithForeignPtr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">withForeignPtr</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- CFILES stuff is Hugs only</span><span>
</span><span id="line-209"></span><span class="hs-pragma">{-# CFILES cbits/fpstring.c #-}</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span id="local-6989586621679117435"><span id="local-6989586621679117436"><span class="annot"><a href="Data.ByteString.Internal.Type.html#minusForeignPtr"><span class="hs-identifier hs-type">minusForeignPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117435"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117436"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span></span></span><span>
</span><span id="line-212"></span><span id="minusForeignPtr"><span class="annot"><span class="annottext">minusForeignPtr :: forall a b. ForeignPtr a -&gt; ForeignPtr b -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#minusForeignPtr"><span class="hs-identifier hs-var hs-var">minusForeignPtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span id="local-6989586621679117914"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679117914"><span class="hs-identifier hs-var">addr1</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForeignPtrContents
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span id="local-6989586621679117915"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679117915"><span class="hs-identifier hs-var">addr2</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForeignPtrContents
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Addr# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#minusAddr%23"><span class="hs-identifier hs-var">minusAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679117914"><span class="hs-identifier hs-var">addr1</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679117915"><span class="hs-identifier hs-var">addr2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span id="local-6989586621679117440"><span class="annot"><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-type">peekFp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Storable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117440"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-216"></span><span id="peekFp"><span class="annot"><span class="annottext">peekFp :: forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var hs-var">peekFp</span></a></span></span><span> </span><span id="local-6989586621679117918"><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679117918"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr a -&gt; (Ptr a -&gt; IO a) -&gt; IO a
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679117918"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr a -&gt; IO a
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span id="local-6989586621679117445"><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-type">pokeFp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Storable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-219"></span><span id="pokeFp"><span class="annot"><span class="annottext">pokeFp :: forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var hs-var">pokeFp</span></a></span></span><span> </span><span id="local-6989586621679117922"><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679117922"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679117923"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117923"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr a -&gt; (Ptr a -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679117922"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr a -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr a -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679117924"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679117924"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr a -&gt; a -&gt; IO ()
forall a. Storable a =&gt; Ptr a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">poke</span></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679117924"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117923"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span id="local-6989586621679117451"><span class="annot"><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-type">peekFpByteOff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Storable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117451"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-222"></span><span id="peekFpByteOff"><span class="annot"><span class="annottext">peekFpByteOff :: forall a. Storable a =&gt; ForeignPtr a -&gt; Int -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFpByteOff"><span class="hs-identifier hs-var hs-var">peekFpByteOff</span></a></span></span><span> </span><span id="local-6989586621679117928"><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679117928"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679117929"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117929"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr a -&gt; (Ptr a -&gt; IO a) -&gt; IO a
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr a
</span><a href="#local-6989586621679117928"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr a -&gt; IO a) -&gt; IO a) -&gt; (Ptr a -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679117930"><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679117930"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="annottext">Ptr a -&gt; Int -&gt; IO a
forall b. Ptr b -&gt; Int -&gt; IO a
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr a
</span><a href="#local-6989586621679117930"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117929"><span class="hs-identifier hs-var">off</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span id="local-6989586621679117454"><span id="local-6989586621679117455"><span class="annot"><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-type">pokeFpByteOff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Storable</span></span><span> </span><span class="annot"><a href="#local-6989586621679117454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117455"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-226"></span><span id="pokeFpByteOff"><span class="annot"><span class="annottext">pokeFpByteOff :: forall a b. Storable a =&gt; ForeignPtr b -&gt; Int -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFpByteOff"><span class="hs-identifier hs-var hs-var">pokeFpByteOff</span></a></span></span><span> </span><span id="local-6989586621679117934"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679117934"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679117935"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117935"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621679117936"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117936"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr b -&gt; (Ptr b -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679117934"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr b -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr b -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679117937"><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679117937"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="annottext">Ptr b -&gt; Int -&gt; a -&gt; IO ()
forall b. Ptr b -&gt; Int -&gt; a -&gt; IO ()
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">pokeByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679117937"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117935"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117936"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | Most operations on a 'ByteString' need to read from the buffer</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- given by its @ForeignPtr Word8@ field.  But since most operations</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- on @ByteString@ are (nominally) pure, their implementations cannot</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- see the IO state thread that was used to initialize the contents of</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- that buffer.  This means that under some circumstances, these</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- buffer-reads may be executed before the writes used to initialize</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- the buffer are executed, with unpredictable results.</span><span>
</span><span id="line-236"></span><span class="hs-comment">--</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- 'deferForeignPtrAvailability' exists to help solve this problem.</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- At runtime, a call @'deferForeignPtrAvailability' x@ is equivalent</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- to @pure $! x@, but the former is more opaque to the simplifier, so</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- that reads from the pointer in its result cannot be executed until</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- the @'deferForeignPtrAvailability' x@ call is complete.</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- The opaque bits evaporate during CorePrep, so using</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- 'deferForeignPtrAvailability' incurs no direct overhead.</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- @since 0.11.5.0</span><span>
</span><span id="line-247"></span><span id="local-6989586621679117459"><span class="annot"><a href="Data.ByteString.Internal.Type.html#deferForeignPtrAvailability"><span class="hs-identifier hs-type">deferForeignPtrAvailability</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117459"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117459"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-248"></span><span id="deferForeignPtrAvailability"><span class="annot"><span class="annottext">deferForeignPtrAvailability :: forall a. ForeignPtr a -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#deferForeignPtrAvailability"><span class="hs-identifier hs-var hs-var">deferForeignPtrAvailability</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span id="local-6989586621679117939"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679117939"><span class="hs-identifier hs-var">addr0#</span></a></span></span><span> </span><span id="local-6989586621679117940"><span class="annot"><span class="annottext">ForeignPtrContents
</span><a href="#local-6989586621679117940"><span class="hs-identifier hs-var">guts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(State# RealWorld -&gt; (# State# RealWorld, ForeignPtr a #))
-&gt; IO (ForeignPtr a)
forall a. (State# RealWorld -&gt; (# State# RealWorld, a #)) -&gt; IO a
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-var">IO</span></a></span><span> </span><span class="annot"><span class="annottext">((State# RealWorld -&gt; (# State# RealWorld, ForeignPtr a #))
 -&gt; IO (ForeignPtr a))
-&gt; (State# RealWorld -&gt; (# State# RealWorld, ForeignPtr a #))
-&gt; IO (ForeignPtr a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679117941"><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679117941"><span class="hs-identifier hs-var">s0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((State# RealWorld -&gt; (# State# RealWorld, Addr# #))
 -&gt; (# State# RealWorld, Addr# #))
-&gt; (State# RealWorld -&gt; (# State# RealWorld, Addr# #))
-&gt; (# State# RealWorld, Addr# #)
forall a. a -&gt; a
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Magic.html#lazy"><span class="hs-identifier hs-var">lazy</span></a></span><span> </span><span class="annot"><span class="annottext">(State# RealWorld -&gt; (# State# RealWorld, Addr# #))
-&gt; (# State# RealWorld, Addr# #)
forall o. (State# RealWorld -&gt; o) -&gt; o
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Magic.html#runRW%23"><span class="hs-identifier hs-var">runRW#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">State# RealWorld
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679117941"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679117939"><span class="hs-identifier hs-var">addr0#</span></a></span><span> </span><span class="hs-special">#)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679117942"><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679117942"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117943"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679117943"><span class="hs-identifier hs-var">addr1#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679117942"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; ForeignPtrContents -&gt; ForeignPtr a
forall a. Addr# -&gt; ForeignPtrContents -&gt; ForeignPtr a
</span><span class="hs-identifier hs-var">ForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679117943"><span class="hs-identifier hs-var">addr1#</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtrContents
</span><a href="#local-6989586621679117940"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Variant of 'fromForeignPtr0' that calls 'deferForeignPtrAvailability'</span><span>
</span><span id="line-253"></span><span class="hs-comment">--</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- @since 0.11.5.0</span><span>
</span><span id="line-255"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mkDeferredByteString"><span class="hs-identifier hs-type">mkDeferredByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-256"></span><span id="mkDeferredByteString"><span class="annot"><span class="annottext">mkDeferredByteString :: ForeignPtr Word8 -&gt; Int -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#mkDeferredByteString"><span class="hs-identifier hs-var hs-var">mkDeferredByteString</span></a></span></span><span> </span><span id="local-6989586621679117944"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679117944"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679117945"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117945"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679117946"><span class="annot"><a href="#local-6989586621679117946"><span class="hs-identifier hs-var">deferredFp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (ForeignPtr Word8)
forall a. ForeignPtr a -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#deferForeignPtrAvailability"><span class="hs-identifier hs-var">deferForeignPtrAvailability</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679117944"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117946"><span class="hs-identifier hs-type">deferredFp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117945"><span class="hs-identifier hs-type">len</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621679117472"><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-type">unsafeDupablePerformIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117472"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117472"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- Why does this exist? In base-4.15.1.0 until at least base-4.18.0.0,</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- the version of unsafeDupablePerformIO in base prevents unboxing of</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- its results with an opaque call to GHC.Exts.lazy, for reasons described</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- in Note [unsafePerformIO and strictness] in GHC.IO.Unsafe. (See</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- https://hackage.haskell.org/package/base-4.18.0.0/docs/src/GHC.IO.Unsafe.html#line-30 .)</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- Even if we accept the (very questionable) premise that the sort of</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- function described in that note should work, we expect no such</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- calls to be made in the context of bytestring.  (And we really want</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- unboxing!)</span><span>
</span><span id="line-270"></span><span id="unsafeDupablePerformIO"><span class="annot"><span class="annottext">unsafeDupablePerformIO :: forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var hs-var">unsafeDupablePerformIO</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span id="local-6989586621679117948"><span class="annot"><span class="annottext">State# RealWorld -&gt; (# State# RealWorld, a #)
</span><a href="#local-6989586621679117948"><span class="hs-identifier hs-var">act</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(State# RealWorld -&gt; (# State# RealWorld, a #))
-&gt; (# State# RealWorld, a #)
forall o. (State# RealWorld -&gt; o) -&gt; o
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Magic.html#runRW%23"><span class="hs-identifier hs-var">runRW#</span></a></span><span> </span><span class="annot"><span class="annottext">State# RealWorld -&gt; (# State# RealWorld, a #)
</span><a href="#local-6989586621679117948"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117949"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117949"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679117949"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | A space-efficient representation of a 'Word8' vector, supporting many</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- efficient operations.</span><span>
</span><span id="line-278"></span><span class="hs-comment">--</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- A 'ByteString' contains 8-bit bytes, or by using the operations from</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- &quot;Data.ByteString.Char8&quot; it can be interpreted as containing 8-bit</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- characters.</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-keyword">data</span><span> </span><span id="ByteString"><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-var">ByteString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BS"><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- payload</span><span>
</span><span id="line-284"></span><span>                     </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>                </span><span class="hs-comment">-- length</span><span>
</span><span id="line-285"></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ @since 0.11.0.0</span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | Type synonym for the strict flavour of 'ByteString'.</span><span>
</span><span id="line-288"></span><span class="hs-comment">--</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- @since 0.11.2.0</span><span>
</span><span id="line-290"></span><span class="hs-keyword">type</span><span> </span><span id="StrictByteString"><span class="annot"><a href="Data.ByteString.Internal.Type.html#StrictByteString"><span class="hs-identifier hs-var">StrictByteString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- @'PS' foreignPtr offset length@ represents a 'ByteString' with data</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- backed by a given @foreignPtr@, starting at a given @offset@ in bytes</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- and of a specified @length@.</span><span>
</span><span id="line-296"></span><span class="hs-comment">--</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- This pattern is used to emulate the legacy 'ByteString' data</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- constructor, so that pre-existing code generally doesn't need to</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- change to benefit from the simplified 'BS' constructor and can</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- continue to function unchanged.</span><span>
</span><span id="line-301"></span><span class="hs-comment">--</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- /Note:/ Matching with this constructor will always be given a 0 offset,</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- as the base will be manipulated by 'plusForeignPtr' instead.</span><span>
</span><span id="line-304"></span><span class="hs-comment">--</span><span>
</span><span id="line-305"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#PS"><span class="hs-identifier hs-type">PS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-306"></span><span class="hs-keyword">pattern</span><span> </span><span id="PS"><span id="%24mPS"><span id="%24bPS"><span class="annot"><span class="annottext">$mPS :: forall {r}.
ByteString
-&gt; (ForeignPtr Word8 -&gt; Int -&gt; Int -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bPS :: ForeignPtr Word8 -&gt; Int -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#PS"><span class="hs-identifier hs-var hs-var hs-var">PS</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679117952"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117953"><span class="hs-identifier hs-type">zero</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117954"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679117952"><span class="annot"><a href="#local-6989586621679117952"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679117953"><span class="annot"><a href="#local-6989586621679117953"><span class="hs-identifier hs-var">zero</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679117954"><span class="annot"><a href="#local-6989586621679117954"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#PS"><span class="hs-identifier hs-var">PS</span></a></span><span> </span><span id="local-6989586621679117956"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679117956"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679117957"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117957"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679117958"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117958"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679117956"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117957"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679117958"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-308"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#PS"><span class="hs-pragma hs-type">PS</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117961"><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span>  </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621679117965"><span class="annot"><span class="annottext">== :: ByteString -&gt; ByteString -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var hs-var hs-var">(==)</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.Internal.Type.html#eq"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679117971"><span id="local-6989586621679117975"><span id="local-6989586621679117978"><span id="local-6989586621679117981"><span id="local-6989586621679117984"><span id="local-6989586621679117987"><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679117990"><span class="annot"><span class="annottext">compare :: ByteString -&gt; ByteString -&gt; Ordering
</span><a href="#local-6989586621679117990"><span class="hs-identifier hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Ordering
</span><a href="Data.ByteString.Internal.Type.html#compareBytes"><span class="hs-identifier hs-var">compareBytes</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679117998"><span class="annot"><span class="annottext">&lt;&gt; :: ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-operator hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#append"><span class="hs-identifier hs-var">append</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679118000"><span class="annot"><span class="annottext">sconcat :: NonEmpty ByteString -&gt; ByteString
</span><a href="#local-6989586621679118000"><span class="hs-identifier hs-var hs-var hs-var">sconcat</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679118002"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118002"><span class="hs-identifier hs-var">b</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span id="local-6989586621679118003"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118003"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118002"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; [ByteString]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118003"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">stimes</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679118008"><span class="annot"><span class="annottext">stimes :: forall b. Integral b =&gt; b -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var hs-var">stimes</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; ByteString -&gt; ByteString
forall b. Integral b =&gt; b -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesPolymorphic"><span class="hs-identifier hs-var">stimesPolymorphic</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679118017"><span class="annot"><span class="annottext">mempty :: ByteString
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679118019"><span class="annot"><span class="annottext">mappend :: ByteString -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679118020"><span class="annot"><span class="annottext">mconcat :: [ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var hs-var">mconcat</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../deepseq-1.5.1.0-6837/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621679118024"><span class="annot"><span class="annottext">rnf :: ByteString -&gt; ()
</span><a href="../../deepseq-1.5.1.0-6837/src/Control.DeepSeq.html#rnf"><span class="hs-identifier hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679118027"><span id="local-6989586621679118031"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679118038"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; ByteString -&gt; ShowS
</span><a href="#local-6989586621679118038"><span class="hs-identifier hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679118040"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118040"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118041"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118041"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679118042"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118042"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118040"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String
</span><a href="Data.ByteString.Internal.Type.html#unpackChars"><span class="hs-identifier hs-var">unpackChars</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118041"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118042"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679118045"><span id="local-6989586621679118049"><span id="local-6989586621679118052"><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621679118059"><span class="annot"><span class="annottext">readsPrec :: Int -&gt; ReadS ByteString
</span><a href="#local-6989586621679118059"><span class="hs-identifier hs-var hs-var hs-var">readsPrec</span></a></span></span><span> </span><span id="local-6989586621679118061"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118061"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118062"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118062"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#packChars"><span class="hs-identifier hs-var">packChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118063"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118064"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679118063"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118063"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679118064"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118064"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ReadS String
forall a. Read a =&gt; Int -&gt; ReadS a
</span><span class="hs-identifier hs-var">readsPrec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118061"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118062"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><span class="hs-comment">-- | @since 0.10.12.0</span></span><span>
</span><span id="line-337"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679118067"><span class="annot"><span class="hs-identifier hs-type">IsList</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Item"><span class="annot"><span class="hs-identifier hs-var">Item</span></span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621679118072"><span class="annot"><span class="annottext">fromList :: [Item ByteString] -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var hs-var">fromList</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
[Item ByteString] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#packBytes"><span class="hs-identifier hs-var">packBytes</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679118073"><span class="annot"><span class="annottext">toList :: ByteString -&gt; [Item ByteString]
</span><span class="hs-identifier hs-var hs-var hs-var">toList</span></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8]
ByteString -&gt; [Item ByteString]
</span><a href="Data.ByteString.Internal.Type.html#unpackBytes"><span class="hs-identifier hs-var">unpackBytes</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | Beware: 'fromString' truncates multi-byte characters to octets.</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- e.g. &quot;&#26543;&#26422;&#12395;&#28879;&#12398;&#12392;&#12414;&#12426;&#12369;&#12426;&#31179;&#12398;&#26286;&quot; becomes &#65533;6k&#65533;nh~&#65533;Q&#65533;&#65533;n&#65533;</span><span>
</span><span id="line-344"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">fromString</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679118077"><span class="annot"><span class="annottext">fromString :: String -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var hs-var">fromString</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#packChars"><span class="hs-identifier hs-var">packChars</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679118085"><span id="local-6989586621679118091"><span id="local-6989586621679118096"><span id="local-6989586621679118099"><span id="local-6989586621679118102"><span id="local-6989586621679118105"><span id="local-6989586621679118108"><span id="local-6989586621679118111"><span id="local-6989586621679118116"><span id="local-6989586621679118121"><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679118130"><span class="annot"><span class="annottext">gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ByteString -&gt; c ByteString
</span><a href="#local-6989586621679118130"><span class="hs-identifier hs-var hs-var hs-var">gfoldl</span></a></span></span><span> </span><span id="local-6989586621679118132"><span class="annot"><span class="annottext">forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b
</span><a href="#local-6989586621679118132"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679118133"><span class="annot"><span class="annottext">forall g. g -&gt; c g
</span><a href="#local-6989586621679118133"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679118134"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118134"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString) -&gt; c ([Word8] -&gt; ByteString)
forall g. g -&gt; c g
</span><a href="#local-6989586621679118133"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#packBytes"><span class="hs-identifier hs-var">packBytes</span></a></span><span> </span><span class="annot"><span class="annottext">c ([Word8] -&gt; ByteString) -&gt; [Word8] -&gt; c ByteString
forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b
</span><a href="#local-6989586621679118132"><span class="hs-operator hs-var">`f`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8]
</span><a href="Data.ByteString.Internal.Type.html#unpackBytes"><span class="hs-identifier hs-var">unpackBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118134"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621679118135"><span class="annot"><span class="annottext">toConstr :: ByteString -&gt; Constr
</span><a href="#local-6989586621679118135"><span class="hs-identifier hs-var hs-var hs-var">toConstr</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constr
</span><a href="Data.ByteString.Internal.Type.html#packConstr"><span class="hs-identifier hs-var">packConstr</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621679118144"><span class="annot"><span class="annottext">gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ByteString
</span><a href="#local-6989586621679118144"><span class="hs-identifier hs-var hs-var hs-var">gunfold</span></a></span></span><span> </span><span id="local-6989586621679118146"><span class="annot"><span class="annottext">forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r
</span><a href="#local-6989586621679118146"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679118147"><span class="annot"><span class="annottext">forall r. r -&gt; c r
</span><a href="#local-6989586621679118147"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span id="local-6989586621679118148"><span class="annot"><span class="annottext">Constr
</span><a href="#local-6989586621679118148"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Constr -&gt; Int
</span><span class="hs-identifier hs-var">constrIndex</span></span><span> </span><span class="annot"><span class="annottext">Constr
</span><a href="#local-6989586621679118148"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">c ([Word8] -&gt; ByteString) -&gt; c ByteString
forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r
</span><a href="#local-6989586621679118146"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Word8] -&gt; ByteString) -&gt; c ([Word8] -&gt; ByteString)
forall r. r -&gt; c r
</span><a href="#local-6989586621679118147"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#packBytes"><span class="hs-identifier hs-var">packBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; c ByteString
forall a. (?callStack::CallStack) =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gunfold: unexpected constructor of strict ByteString&quot;</span></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621679118150"><span class="annot"><span class="annottext">dataTypeOf :: ByteString -&gt; DataType
</span><a href="#local-6989586621679118150"><span class="hs-identifier hs-var hs-var hs-var">dataTypeOf</span></a></span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataType
</span><a href="Data.ByteString.Internal.Type.html#byteStringDataType"><span class="hs-identifier hs-var">byteStringDataType</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packConstr"><span class="hs-identifier hs-type">packConstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constr</span></span><span>
</span><span id="line-357"></span><span id="packConstr"><span class="annot"><span class="annottext">packConstr :: Constr
</span><a href="Data.ByteString.Internal.Type.html#packConstr"><span class="hs-identifier hs-var hs-var">packConstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataType -&gt; String -&gt; [String] -&gt; Fixity -&gt; Constr
</span><span class="hs-identifier hs-var">mkConstr</span></span><span> </span><span class="annot"><span class="annottext">DataType
</span><a href="Data.ByteString.Internal.Type.html#byteStringDataType"><span class="hs-identifier hs-var">byteStringDataType</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pack&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Fixity
</span><span class="hs-identifier hs-var">Prefix</span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#byteStringDataType"><span class="hs-identifier hs-type">byteStringDataType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DataType</span></span><span>
</span><span id="line-360"></span><span id="byteStringDataType"><span class="annot"><span class="annottext">byteStringDataType :: DataType
</span><a href="Data.ByteString.Internal.Type.html#byteStringDataType"><span class="hs-identifier hs-var hs-var">byteStringDataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DataType
</span><span class="hs-identifier hs-var">mkNoRepType</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Data.ByteString.ByteString&quot;</span></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="annot"><span class="hs-comment">-- | @since 0.11.2.0</span></span><span>
</span><span id="line-363"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Lift</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,16,0)
</span><span class="hs-comment">-- template-haskell-2.16 first ships with ghc-8.10</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679118168"><span class="annot"><span class="annottext">lift :: forall (m :: * -&gt; *). Quote m =&gt; ByteString -&gt; m Exp
</span><span class="hs-identifier hs-var hs-var hs-var">lift</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118169"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118169"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span id="local-6989586621679118170"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118170"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenLiteral"><span class="hs-identifier hs-type">unsafePackLenLiteral</span></a></span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">m Exp -&gt; m Exp -&gt; m Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`TH.appE`</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; m Exp
forall (m :: * -&gt; *). Quote m =&gt; Lit -&gt; m Exp
</span><span class="hs-identifier hs-var">TH.litE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Lit
</span><span class="hs-identifier hs-var">TH.integerL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118170"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">m Exp -&gt; m Exp -&gt; m Exp
forall (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; m Exp -&gt; m Exp
</span><span class="hs-operator hs-var">`TH.appE`</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; m Exp
forall (m :: * -&gt; *). Quote m =&gt; Lit -&gt; m Exp
</span><span class="hs-identifier hs-var">TH.litE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes -&gt; Lit
</span><span class="hs-identifier hs-var">TH.BytesPrimL</span></span><span> </span><span class="annot"><span class="annottext">(Bytes -&gt; Lit) -&gt; Bytes -&gt; Lit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word -&gt; Word -&gt; Bytes
</span><span class="hs-identifier hs-var">TH.Bytes</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118169"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118170"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-identifier">lift</span><span> </span><span class="hs-identifier">bs</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">BS</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span> </span><span class="hs-identifier">unsafePackLenLiteral</span><span> </span><span class="hs-special">|]</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">`</span><span class="hs-identifier">TH.appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">TH.litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TH.integerL</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-special">`</span><span class="hs-identifier">TH.appE</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">TH.litE</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TH.StringPrimL</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">unpackBytes</span><span> </span><span class="hs-identifier">bs</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_template_haskell(2,17,0)
</span><span class="hs-comment">-- template-haskell-2.17 first ships with ghc-9.0</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679118177"><span class="annot"><span class="annottext">liftTyped :: forall (m :: * -&gt; *). Quote m =&gt; ByteString -&gt; Code m ByteString
</span><span class="hs-identifier hs-var hs-var hs-var">liftTyped</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Exp -&gt; Code m ByteString
forall a (m :: * -&gt; *). Quote m =&gt; m Exp -&gt; Code m a
</span><span class="hs-identifier hs-var">TH.unsafeCodeCoerce</span></span><span> </span><span class="annot"><span class="annottext">(m Exp -&gt; Code m ByteString)
-&gt; (ByteString -&gt; m Exp) -&gt; ByteString -&gt; Code m ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; m Exp
forall t (m :: * -&gt; *). (Lift t, Quote m) =&gt; t -&gt; m Exp
forall (m :: * -&gt; *). Quote m =&gt; ByteString -&gt; m Exp
</span><span class="hs-identifier hs-var">TH.lift</span></span><span class="hs-cpp">
#elif MIN_VERSION_template_haskell(2,16,0)
</span><span class="hs-comment">-- template-haskell-2.16 first ships with ghc-8.10</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-identifier">liftTyped</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">TH.unsafeTExpCoerce</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">TH.lift</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-383"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- Internal indexing</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | 'findIndexOrLength' is a variant of findIndex, that returns the length</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- of the string if no element is found, rather than Nothing.</span><span>
</span><span id="line-388"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#findIndexOrLength"><span class="hs-identifier hs-type">findIndexOrLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-389"></span><span id="findIndexOrLength"><span class="annot"><span class="annottext">findIndexOrLength :: (Word8 -&gt; Bool) -&gt; ByteString -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#findIndexOrLength"><span class="hs-identifier hs-var hs-var">findIndexOrLength</span></a></span></span><span> </span><span id="local-6989586621679118179"><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="#local-6989586621679118179"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118180"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118180"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679118181"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118181"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="annottext">IO Int -&gt; Int
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; Int) -&gt; IO Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118182"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118180"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679118182"><span class="annot"><span class="annottext">g :: ForeignPtr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118182"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679118183"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118183"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO Int
</span><a href="#local-6989586621679118184"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-393"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>        </span><span id="local-6989586621679118184"><span class="annot"><span class="annottext">go :: Int -&gt; IO Int
</span><a href="#local-6989586621679118184"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118185"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118185"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118185"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118181"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO Int
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118181"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-395"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679118186"><span class="annot"><a href="#local-6989586621679118186"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">(ForeignPtr Word8 -&gt; IO Word8) -&gt; ForeignPtr Word8 -&gt; IO Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118183"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118185"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-396"></span><span>                               </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679118179"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118186"><span class="hs-identifier hs-type">w</span></a></span><span>
</span><span id="line-397"></span><span>                                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679118185"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-398"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679118184"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118185"><span class="hs-identifier hs-type">n</span></a></span><span class="annot"><span class="hs-operator hs-type">+</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#findIndexOrLength"><span class="hs-pragma hs-type">findIndexOrLength</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- Packing and unpacking from lists</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packBytes"><span class="hs-identifier hs-type">packBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-405"></span><span id="packBytes"><span class="annot"><span class="annottext">packBytes :: [Word8] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#packBytes"><span class="hs-identifier hs-var hs-var">packBytes</span></a></span></span><span> </span><span id="local-6989586621679118188"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118188"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Word8] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenBytes"><span class="hs-identifier hs-var">unsafePackLenBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">List.length</span></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118188"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118188"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packChars"><span class="hs-identifier hs-type">packChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-408"></span><span id="packChars"><span class="annot"><span class="annottext">packChars :: String -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#packChars"><span class="hs-identifier hs-var hs-var">packChars</span></a></span></span><span> </span><span id="local-6989586621679118190"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118190"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenChars"><span class="hs-identifier hs-var">unsafePackLenChars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">List.length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118190"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118190"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packChars"><span class="hs-pragma hs-type">packChars</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-413"></span><span class="annot"><span class="hs-pragma">&quot;ByteString packChars/packAddress&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679118191"><span class="annot"><a href="#local-6989586621679118191"><span class="hs-pragma hs-var">s</span></a></span></span><span> </span><span class="hs-pragma">.</span><span>
</span><span id="line-414"></span><span>   </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packChars"><span class="hs-pragma hs-type">packChars</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.CString.html#unpackCString%23"><span class="hs-pragma hs-type">unpackCString#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118191"><span class="hs-pragma hs-type">s</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLiteral"><span class="hs-pragma hs-type">unsafePackLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118191"><span class="hs-pragma hs-type">s</span></a></span><span>
</span><span id="line-415"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenBytes"><span class="hs-identifier hs-type">unsafePackLenBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-418"></span><span id="unsafePackLenBytes"><span class="annot"><span class="annottext">unsafePackLenBytes :: Int -&gt; [Word8] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenBytes"><span class="hs-identifier hs-var hs-var">unsafePackLenBytes</span></a></span></span><span> </span><span id="local-6989586621679118192"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118192"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679118193"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118193"><span class="hs-identifier hs-var">xs0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118192"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118194"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118194"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; [Word8] -&gt; IO ()
forall {b}. Storable b =&gt; ForeignPtr b -&gt; [b] -&gt; IO ()
</span><a href="#local-6989586621679118195"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118194"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118193"><span class="hs-identifier hs-var">xs0</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-421"></span><span>    </span><span id="local-6989586621679118195"><span class="annot"><span class="annottext">go :: ForeignPtr b -&gt; [b] -&gt; IO ()
</span><a href="#local-6989586621679118195"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">ForeignPtr b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><a href="#local-6989586621679118195"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118200"><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679118200"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679118201"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679118201"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118202"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679118202"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr b -&gt; b -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679118200"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679118201"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr b -&gt; [b] -&gt; IO ()
</span><a href="#local-6989586621679118195"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr b
</span><a href="#local-6989586621679118200"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr b -&gt; Int -&gt; ForeignPtr b
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679118202"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenChars"><span class="hs-identifier hs-type">unsafePackLenChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-425"></span><span id="unsafePackLenChars"><span class="annot"><span class="annottext">unsafePackLenChars :: Int -&gt; String -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenChars"><span class="hs-identifier hs-var hs-var">unsafePackLenChars</span></a></span></span><span> </span><span id="local-6989586621679118203"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118203"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679118204"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118204"><span class="hs-identifier hs-var">cs0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118203"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118205"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118205"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; String -&gt; IO ()
</span><a href="#local-6989586621679118206"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118205"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118204"><span class="hs-identifier hs-var">cs0</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679118206"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; String -&gt; IO ()
</span><a href="#local-6989586621679118206"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="#local-6989586621679118206"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118210"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118210"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679118211"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679118211"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118212"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118212"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118210"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Word8
</span><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier hs-var">c2w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679118211"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; String -&gt; IO ()
</span><a href="#local-6989586621679118206"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118210"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118212"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-comment">-- | /O(n)/ Pack a null-terminated sequence of bytes, pointed to by an</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- Addr\# (an arbitrary machine address assumed to point outside the</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- garbage-collected heap) into a @ByteString@. A much faster way to</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- create an 'Addr#' is with an unboxed string literal, than to pack a</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- boxed string. A unboxed string literal is compiled to a static @char</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- []@ by GHC. Establishing the length of the string requires a call to</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- @strlen(3)@, so the 'Addr#' must point to a null-terminated buffer (as</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- is the case with @\&quot;string\&quot;\#@ literals in GHC). Use 'Data.ByteString.Unsafe.unsafePackAddressLen'</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- if you know the length of the string statically.</span><span>
</span><span id="line-441"></span><span class="hs-comment">--</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- An example:</span><span>
</span><span id="line-443"></span><span class="hs-comment">--</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- &gt; literalFS = unsafePackAddress &quot;literal&quot;#</span><span>
</span><span id="line-445"></span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- This function is /unsafe/. If you modify the buffer pointed to by the</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- original 'Addr#' this modification will be reflected in the resulting</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- @ByteString@, breaking referential transparency.</span><span>
</span><span id="line-449"></span><span class="hs-comment">--</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- Note this also won't work if your 'Addr#' has embedded @\'\\0\'@ characters in</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- the string, as @strlen@ will return too short a length.</span><span>
</span><span id="line-452"></span><span class="hs-comment">--</span><span>
</span><span id="line-453"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackAddress"><span class="hs-identifier hs-type">unsafePackAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-454"></span><span id="unsafePackAddress"><span class="annot"><span class="annottext">unsafePackAddress :: Addr# -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackAddress"><span class="hs-identifier hs-var hs-var">unsafePackAddress</span></a></span></span><span> </span><span id="local-6989586621679118213"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118213"><span class="hs-identifier hs-var">addr#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-cpp">
#if HS_cstringLength_AND_FinalPtr_AVAILABLE
</span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Addr# -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenAddress"><span class="hs-identifier hs-var">unsafePackLenAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.CString.html#cstringLength%23"><span class="hs-identifier hs-var">cstringLength#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118213"><span class="hs-identifier hs-var">addr#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118213"><span class="hs-identifier hs-var">addr#</span></a></span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">l</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">c_strlen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">addr#</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-identifier">unsafePackLenAddress</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">addr#</span><span class="hs-cpp">
#endif
</span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackAddress"><span class="hs-pragma hs-type">unsafePackAddress</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">-- | See 'unsafePackAddress'. This function is similar,</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- but takes an additional length argument rather then computing</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- it with @strlen@.</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- Therefore embedding @\'\\0\'@ characters is possible.</span><span>
</span><span id="line-467"></span><span class="hs-comment">--</span><span>
</span><span id="line-468"></span><span class="hs-comment">-- @since 0.11.2.0</span><span>
</span><span id="line-469"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenAddress"><span class="hs-identifier hs-type">unsafePackLenAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-470"></span><span id="unsafePackLenAddress"><span class="annot"><span class="annottext">unsafePackLenAddress :: Int -&gt; Addr# -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenAddress"><span class="hs-identifier hs-var hs-var">unsafePackLenAddress</span></a></span></span><span> </span><span id="local-6989586621679118214"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118214"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679118215"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118215"><span class="hs-identifier hs-var">addr#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-cpp">
#if HS_cstringLength_AND_FinalPtr_AVAILABLE
</span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; ForeignPtrContents -&gt; ForeignPtr Word8
forall a. Addr# -&gt; ForeignPtrContents -&gt; ForeignPtr a
</span><span class="hs-identifier hs-var">ForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118215"><span class="hs-identifier hs-var">addr#</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtrContents
</span><span class="hs-identifier hs-var">FinalPtr</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118214"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">newForeignPtr_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">addr#</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">BS</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">len</span><span class="hs-cpp">
#endif
</span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenAddress"><span class="hs-pragma hs-type">unsafePackLenAddress</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- | See 'unsafePackAddress'. This function has similar behavior. Prefer</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- this function when the address in known to be an @Addr#@ literal. In</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- that context, there is no need for the sequencing guarantees that 'IO'</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- provides. On GHC 9.0 and up, this function uses the @FinalPtr@ data</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- constructor for @ForeignPtrContents@.</span><span>
</span><span id="line-484"></span><span class="hs-comment">--</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- @since 0.11.1.0</span><span>
</span><span id="line-486"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLiteral"><span class="hs-identifier hs-type">unsafePackLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-487"></span><span id="unsafePackLiteral"><span class="annot"><span class="annottext">unsafePackLiteral :: Addr# -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLiteral"><span class="hs-identifier hs-var hs-var">unsafePackLiteral</span></a></span></span><span> </span><span id="local-6989586621679118216"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118216"><span class="hs-identifier hs-var">addr#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if HS_cstringLength_AND_FinalPtr_AVAILABLE
</span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Addr# -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenLiteral"><span class="hs-identifier hs-var">unsafePackLenLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.CString.html#cstringLength%23"><span class="hs-identifier hs-var">cstringLength#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118216"><span class="hs-identifier hs-var">addr#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118216"><span class="hs-identifier hs-var">addr#</span></a></span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">accursedUnutterablePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">c_strlen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">addr#</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">unsafePackLenLiteral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">addr#</span><span class="hs-cpp">
#endif
</span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLiteral"><span class="hs-pragma hs-type">unsafePackLiteral</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-comment">-- | See 'unsafePackLiteral'. This function is similar,</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- but takes an additional length argument rather then computing</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- it with @strlen@.</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- Therefore embedding @\'\\0\'@ characters is possible.</span><span>
</span><span id="line-501"></span><span class="hs-comment">--</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- @since 0.11.2.0</span><span>
</span><span id="line-503"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenLiteral"><span class="hs-identifier hs-type">unsafePackLenLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-504"></span><span id="unsafePackLenLiteral"><span class="annot"><span class="annottext">unsafePackLenLiteral :: Int -&gt; Addr# -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafePackLenLiteral"><span class="hs-identifier hs-var hs-var">unsafePackLenLiteral</span></a></span></span><span> </span><span id="local-6989586621679118217"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118217"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679118218"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118218"><span class="hs-identifier hs-var">addr#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if HS_cstringLength_AND_FinalPtr_AVAILABLE
</span><span>  </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; ForeignPtrContents -&gt; ForeignPtr Word8
forall a. Addr# -&gt; ForeignPtrContents -&gt; ForeignPtr a
</span><span class="hs-identifier hs-var">ForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679118218"><span class="hs-identifier hs-var">addr#</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtrContents
</span><span class="hs-identifier hs-var">FinalPtr</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118217"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-comment">-- newForeignPtr_ allocates a MutVar# internally. If that MutVar#</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-comment">-- gets commoned up with the MutVar# of some unrelated ForeignPtr,</span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-comment">-- it may prevent automatic finalization for that other ForeignPtr.</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-comment">-- So we avoid accursedUnutterablePerformIO here.</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-identifier">BS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unsafeDupablePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">newForeignPtr_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">addr#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">len</span><span class="hs-cpp">
#endif
</span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafePackLenLiteral"><span class="hs-pragma hs-type">unsafePackLenLiteral</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packUptoLenBytes"><span class="hs-identifier hs-type">packUptoLenBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span id="packUptoLenBytes"><span class="annot"><span class="annottext">packUptoLenBytes :: Int -&gt; [Word8] -&gt; (ByteString, [Word8])
</span><a href="Data.ByteString.Internal.Type.html#packUptoLenBytes"><span class="hs-identifier hs-var hs-var">packUptoLenBytes</span></a></span></span><span> </span><span id="local-6989586621679118219"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118219"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679118220"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118220"><span class="hs-identifier hs-var">xs0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><span class="annottext">Int
-&gt; (ForeignPtr Word8 -&gt; IO (Int, [Word8])) -&gt; (ByteString, [Word8])
forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN%27"><span class="hs-identifier hs-var">unsafeCreateFpUptoN'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118219"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO (Int, [Word8])) -&gt; (ByteString, [Word8]))
-&gt; (ForeignPtr Word8 -&gt; IO (Int, [Word8])) -&gt; (ByteString, [Word8])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118221"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118221"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-519"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679118222"><span class="annot"><span class="annottext">p_end :: ForeignPtr Word8
</span><a href="#local-6989586621679118222"><span class="hs-identifier hs-var hs-var">p_end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118221"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118219"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-520"></span><span>          </span><span id="local-6989586621679118223"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; [Word8] -&gt; IO (Int, [Word8])
</span><a href="#local-6989586621679118223"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118224"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118224"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, [Word8]) -&gt; IO (Int, [Word8])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118224"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int
forall a b. ForeignPtr a -&gt; ForeignPtr b -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#minusForeignPtr"><span class="hs-operator hs-var">`minusForeignPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118221"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>          </span><span class="annot"><a href="#local-6989586621679118223"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118225"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118225"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118226"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118226"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118225"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118222"><span class="hs-identifier hs-var">p_end</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, [Word8]) -&gt; IO (Int, [Word8])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118219"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118226"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>          </span><span class="annot"><a href="#local-6989586621679118223"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118227"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118227"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679118228"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118228"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118229"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118229"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118227"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118228"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Int, [Word8]) -&gt; IO (Int, [Word8])
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; [Word8] -&gt; IO (Int, [Word8])
</span><a href="#local-6989586621679118223"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118227"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118229"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; [Word8] -&gt; IO (Int, [Word8])
</span><a href="#local-6989586621679118223"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118221"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118220"><span class="hs-identifier hs-var">xs0</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#packUptoLenChars"><span class="hs-identifier hs-type">packUptoLenChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span id="packUptoLenChars"><span class="annot"><span class="annottext">packUptoLenChars :: Int -&gt; String -&gt; (ByteString, String)
</span><a href="Data.ByteString.Internal.Type.html#packUptoLenChars"><span class="hs-identifier hs-var hs-var">packUptoLenChars</span></a></span></span><span> </span><span id="local-6989586621679118230"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118230"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679118231"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118231"><span class="hs-identifier hs-var">cs0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><span class="annottext">Int
-&gt; (ForeignPtr Word8 -&gt; IO (Int, String)) -&gt; (ByteString, String)
forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN%27"><span class="hs-identifier hs-var">unsafeCreateFpUptoN'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118230"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO (Int, String)) -&gt; (ByteString, String))
-&gt; (ForeignPtr Word8 -&gt; IO (Int, String)) -&gt; (ByteString, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118232"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118232"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-528"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679118233"><span class="annot"><span class="annottext">p_end :: ForeignPtr Word8
</span><a href="#local-6989586621679118233"><span class="hs-identifier hs-var hs-var">p_end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118232"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118230"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-529"></span><span>          </span><span id="local-6989586621679118234"><span class="annot"><span class="annottext">go :: ForeignPtr Word8 -&gt; String -&gt; IO (Int, String)
</span><a href="#local-6989586621679118234"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118235"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118235"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, String) -&gt; IO (Int, String)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118235"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int
forall a b. ForeignPtr a -&gt; ForeignPtr b -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#minusForeignPtr"><span class="hs-operator hs-var">`minusForeignPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118232"><span class="hs-identifier hs-var">p0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>          </span><span class="annot"><a href="#local-6989586621679118234"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118236"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118236"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118237"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118237"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118236"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118233"><span class="hs-identifier hs-var">p_end</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, String) -&gt; IO (Int, String)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118230"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118237"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>          </span><span class="annot"><a href="#local-6989586621679118234"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118238"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118238"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679118239"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679118239"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118240"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118240"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Word8 -&gt; IO ()
forall a. Storable a =&gt; ForeignPtr a -&gt; a -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#pokeFp"><span class="hs-identifier hs-var">pokeFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118238"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Word8
</span><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier hs-var">c2w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679118239"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Int, String) -&gt; IO (Int, String)
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; String -&gt; IO (Int, String)
</span><a href="#local-6989586621679118234"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118238"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118240"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-532"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; String -&gt; IO (Int, String)
</span><a href="#local-6989586621679118234"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118232"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118231"><span class="hs-identifier hs-var">cs0</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">-- Unpacking bytestrings into lists efficiently is a tradeoff: on the one hand</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- we would like to write a tight loop that just blasts the list into memory, on</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- the other hand we want it to be unpacked lazily so we don't end up with a</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- massive list data structure in memory.</span><span>
</span><span id="line-538"></span><span class="hs-comment">--</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- Our strategy is to combine both: we will unpack lazily in reasonable sized</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- chunks, where each chunk is unpacked strictly.</span><span>
</span><span id="line-541"></span><span class="hs-comment">--</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- unpackBytes and unpackChars do the lazy loop, while unpackAppendBytes and</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- unpackAppendChars do the chunks strictly.</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackBytes"><span class="hs-identifier hs-type">unpackBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span>
</span><span id="line-546"></span><span id="unpackBytes"><span class="annot"><span class="annottext">unpackBytes :: ByteString -&gt; [Word8]
</span><a href="Data.ByteString.Internal.Type.html#unpackBytes"><span class="hs-identifier hs-var hs-var">unpackBytes</span></a></span></span><span> </span><span id="local-6989586621679118241"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118241"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8] -&gt; [Word8]
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesLazy"><span class="hs-identifier hs-var">unpackAppendBytesLazy</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118241"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackChars"><span class="hs-identifier hs-type">unpackChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-549"></span><span id="unpackChars"><span class="annot"><span class="annottext">unpackChars :: ByteString -&gt; String
</span><a href="Data.ByteString.Internal.Type.html#unpackChars"><span class="hs-identifier hs-var hs-var">unpackChars</span></a></span></span><span> </span><span id="local-6989586621679118242"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118242"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ShowS
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsLazy"><span class="hs-identifier hs-var">unpackAppendCharsLazy</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118242"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesLazy"><span class="hs-identifier hs-type">unpackAppendBytesLazy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span>
</span><span id="line-552"></span><span id="unpackAppendBytesLazy"><span class="annot"><span class="annottext">unpackAppendBytesLazy :: ByteString -&gt; [Word8] -&gt; [Word8]
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesLazy"><span class="hs-identifier hs-var hs-var">unpackAppendBytesLazy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118243"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118243"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118244"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118244"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679118245"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118245"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118244"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8] -&gt; [Word8]
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesStrict"><span class="hs-identifier hs-var">unpackAppendBytesStrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118243"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118244"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118245"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8] -&gt; [Word8]
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesStrict"><span class="hs-identifier hs-var">unpackAppendBytesStrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118243"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118247"><span class="hs-identifier hs-var">remainder</span></a></span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-556"></span><span>    </span><span id="local-6989586621679118247"><span class="annot"><span class="annottext">remainder :: [Word8]
</span><a href="#local-6989586621679118247"><span class="hs-identifier hs-var hs-var">remainder</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8] -&gt; [Word8]
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesLazy"><span class="hs-identifier hs-var">unpackAppendBytesLazy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118243"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118244"><span class="hs-identifier hs-var">len</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118245"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-comment">-- Why 100 bytes you ask? Because on a 64bit machine the list we allocate</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-comment">-- takes just shy of 4k which seems like a reasonable amount.</span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-comment">-- (5 words per list element, 8 bytes per word, 100 elements = 4000 bytes)</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsLazy"><span class="hs-identifier hs-type">unpackAppendCharsLazy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-563"></span><span id="unpackAppendCharsLazy"><span class="annot"><span class="annottext">unpackAppendCharsLazy :: ByteString -&gt; ShowS
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsLazy"><span class="hs-identifier hs-var hs-var">unpackAppendCharsLazy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118248"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118248"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118249"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118249"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679118250"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118250"><span class="hs-identifier hs-var">cs</span></a></span></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118249"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ShowS
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsStrict"><span class="hs-identifier hs-var">unpackAppendCharsStrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118248"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118249"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118250"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ShowS
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsStrict"><span class="hs-identifier hs-var">unpackAppendCharsStrict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118248"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118251"><span class="hs-identifier hs-var">remainder</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-567"></span><span>    </span><span id="local-6989586621679118251"><span class="annot"><span class="annottext">remainder :: String
</span><a href="#local-6989586621679118251"><span class="hs-identifier hs-var hs-var">remainder</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ShowS
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsLazy"><span class="hs-identifier hs-var">unpackAppendCharsLazy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118248"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118249"><span class="hs-identifier hs-var">len</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118250"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="hs-comment">-- For these unpack functions, since we're unpacking the whole list strictly we</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- build up the result list in an accumulator. This means we have to build up</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- the list starting at the end. So our traversal starts at the end of the</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- buffer and loops down until we hit the sentinal:</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesStrict"><span class="hs-identifier hs-type">unpackAppendBytesStrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span>
</span><span id="line-575"></span><span id="unpackAppendBytesStrict"><span class="annot"><span class="annottext">unpackAppendBytesStrict :: ByteString -&gt; [Word8] -&gt; [Word8]
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendBytesStrict"><span class="hs-identifier hs-var hs-var">unpackAppendBytesStrict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118252"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118252"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118253"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118253"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679118254"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118254"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><span class="annottext">IO [Word8] -&gt; [Word8]
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Word8] -&gt; [Word8]) -&gt; IO [Word8] -&gt; [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO [Word8]) -&gt; IO [Word8]
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118252"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO [Word8]) -&gt; IO [Word8])
-&gt; (Ptr Word8 -&gt; IO [Word8]) -&gt; IO [Word8]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118255"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118255"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-577"></span><span>      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; [Word8] -&gt; IO [Word8]
forall {b}. Storable b =&gt; Ptr b -&gt; Ptr b -&gt; [b] -&gt; IO [b]
</span><a href="#local-6989586621679118256"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118255"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118255"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118253"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679118254"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621679118256"><span class="annot"><span class="annottext">loop :: Ptr b -&gt; Ptr b -&gt; [b] -&gt; IO [b]
</span><a href="#local-6989586621679118256"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118266"><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679118266"><span class="hs-identifier hs-var">sentinal</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118267"><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679118267"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118268"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679118268"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-580"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679118267"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr b -&gt; Ptr b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679118266"><span class="hs-identifier hs-var">sentinal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[b] -&gt; IO [b]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679118268"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679118269"><span class="annot"><a href="#local-6989586621679118269"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr b -&gt; IO b
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">Ptr b
</span><a href="#local-6989586621679118267"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-582"></span><span>                           </span><span class="annot"><a href="#local-6989586621679118256"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118266"><span class="hs-identifier hs-type">sentinal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118267"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118269"><span class="hs-identifier hs-type">x</span></a></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><a href="#local-6989586621679118268"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsStrict"><span class="hs-identifier hs-type">unpackAppendCharsStrict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-585"></span><span id="unpackAppendCharsStrict"><span class="annot"><span class="annottext">unpackAppendCharsStrict :: ByteString -&gt; ShowS
</span><a href="Data.ByteString.Internal.Type.html#unpackAppendCharsStrict"><span class="hs-identifier hs-var hs-var">unpackAppendCharsStrict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118270"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118270"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118271"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118271"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679118272"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118272"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><span class="annottext">IO String -&gt; String
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO String -&gt; String) -&gt; IO String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO String) -&gt; IO String
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118270"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO String) -&gt; IO String)
-&gt; (Ptr Word8 -&gt; IO String) -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118273"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118273"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; String -&gt; IO String
</span><a href="#local-6989586621679118274"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118273"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118273"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr Word8
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118271"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118272"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-589"></span><span>    </span><span id="local-6989586621679118274"><span class="annot"><span class="annottext">loop :: Ptr Word8 -&gt; Ptr Word8 -&gt; String -&gt; IO String
</span><a href="#local-6989586621679118274"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118281"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118281"><span class="hs-identifier hs-var">sentinal</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118282"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118282"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118283"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118283"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-590"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118282"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118281"><span class="hs-identifier hs-var">sentinal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118283"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679118284"><span class="annot"><a href="#local-6989586621679118284"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Word8
forall a. Storable a =&gt; Ptr a -&gt; IO a
</span><span class="hs-identifier hs-var">peek</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118282"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-592"></span><span>                           </span><span class="annot"><a href="#local-6989586621679118274"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118281"><span class="hs-identifier hs-type">sentinal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118282"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#w2c"><span class="hs-identifier hs-type">w2c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118284"><span class="hs-identifier hs-type">x</span></a></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><a href="#local-6989586621679118283"><span class="hs-identifier hs-type">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="annot"><span class="hs-comment">-- | The 0 pointer. Used to indicate the empty Bytestring.</span></span><span>
</span><span id="line-597"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#nullForeignPtr"><span class="hs-identifier hs-type">nullForeignPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-cpp">
#if HS_cstringLength_AND_FinalPtr_AVAILABLE
</span><span id="nullForeignPtr"><span class="annot"><span class="annottext">nullForeignPtr :: ForeignPtr Word8
</span><a href="Data.ByteString.Internal.Type.html#nullForeignPtr"><span class="hs-identifier hs-var hs-var">nullForeignPtr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; ForeignPtrContents -&gt; ForeignPtr Word8
forall a. Addr# -&gt; ForeignPtrContents -&gt; ForeignPtr a
</span><span class="hs-identifier hs-var">ForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#nullAddr%23"><span class="hs-identifier hs-var">nullAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtrContents
</span><span class="hs-identifier hs-var">FinalPtr</span></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">nullForeignPtr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ForeignPtr</span><span> </span><span class="hs-identifier">nullAddr#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;nullForeignPtr&quot;</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-604"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-605"></span><span class="hs-comment">-- Low level constructors</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-comment">-- | /O(1)/ Build a ByteString from a ForeignPtr.</span><span>
</span><span id="line-608"></span><span class="hs-comment">--</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- If you do not need the offset parameter then you should be using</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- 'Data.ByteString.Unsafe.unsafePackCStringLen' or</span><span>
</span><span id="line-611"></span><span class="hs-comment">-- 'Data.ByteString.Unsafe.unsafePackCStringFinalizer' instead.</span><span>
</span><span id="line-612"></span><span class="hs-comment">--</span><span>
</span><span id="line-613"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#fromForeignPtr"><span class="hs-identifier hs-type">fromForeignPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-614"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Offset</span></span><span>
</span><span id="line-615"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Length</span></span><span>
</span><span id="line-616"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-617"></span><span id="fromForeignPtr"><span class="annot"><span class="annottext">fromForeignPtr :: ForeignPtr Word8 -&gt; Int -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#fromForeignPtr"><span class="hs-identifier hs-var hs-var">fromForeignPtr</span></a></span></span><span> </span><span id="local-6989586621679118285"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118285"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118286"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118286"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-identifier hs-var">plusForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118285"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118286"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#fromForeignPtr"><span class="hs-pragma hs-type">fromForeignPtr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="annot"><span class="hs-comment">-- | @since 0.11.0.0</span></span><span>
</span><span id="line-621"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#fromForeignPtr0"><span class="hs-identifier hs-type">fromForeignPtr0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-622"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Length</span></span><span>
</span><span id="line-623"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-624"></span><span id="fromForeignPtr0"><span class="annot"><span class="annottext">fromForeignPtr0 :: ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#fromForeignPtr0"><span class="hs-identifier hs-var hs-var">fromForeignPtr0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span>
</span><span id="line-625"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#fromForeignPtr0"><span class="hs-pragma hs-type">fromForeignPtr0</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="annot"><span class="hs-comment">-- | /O(1)/ Deconstruct a ForeignPtr from a ByteString</span></span><span>
</span><span id="line-628"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#toForeignPtr"><span class="hs-identifier hs-type">toForeignPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ (ptr, offset, length)</span></span><span>
</span><span id="line-629"></span><span id="toForeignPtr"><span class="annot"><span class="annottext">toForeignPtr :: ByteString -&gt; (ForeignPtr Word8, Int, Int)
</span><a href="Data.ByteString.Internal.Type.html#toForeignPtr"><span class="hs-identifier hs-var hs-var">toForeignPtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118287"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118287"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679118288"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118288"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118287"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118288"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#toForeignPtr"><span class="hs-pragma hs-type">toForeignPtr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="hs-comment">-- | /O(1)/ Deconstruct a ForeignPtr from a ByteString</span><span>
</span><span id="line-633"></span><span class="hs-comment">--</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- @since 0.11.0.0</span><span>
</span><span id="line-635"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#toForeignPtr0"><span class="hs-identifier hs-type">toForeignPtr0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ (ptr, length)</span></span><span>
</span><span id="line-636"></span><span id="toForeignPtr0"><span class="annot"><span class="annottext">toForeignPtr0 :: ByteString -&gt; (ForeignPtr Word8, Int)
</span><a href="Data.ByteString.Internal.Type.html#toForeignPtr0"><span class="hs-identifier hs-var hs-var">toForeignPtr0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118289"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118289"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679118290"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118290"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118289"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118290"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#toForeignPtr0"><span class="hs-pragma hs-type">toForeignPtr0</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-638"></span><span>
</span><span id="line-639"></span><span class="hs-comment">-- | A way of creating ByteStrings outside the IO monad. The @Int@</span><span>
</span><span id="line-640"></span><span class="hs-comment">-- argument gives the final size of the ByteString.</span><span>
</span><span id="line-641"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-type">unsafeCreateFp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-642"></span><span id="unsafeCreateFp"><span class="annot"><span class="annottext">unsafeCreateFp :: Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var hs-var">unsafeCreateFp</span></a></span></span><span> </span><span id="local-6989586621679118291"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118291"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118292"><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118292"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-var">createFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118291"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118292"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-pragma hs-type">unsafeCreateFp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span class="hs-comment">-- | Like 'unsafeCreateFp' but instead of giving the final size of the</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- ByteString, it is just an upper bound. The inner action returns</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- the actual size. Unlike 'createFpAndTrim' the ByteString is not</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- reallocated if the final size is less than the estimated size.</span><span>
</span><span id="line-649"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN"><span class="hs-identifier hs-type">unsafeCreateFpUptoN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-650"></span><span id="unsafeCreateFpUptoN"><span class="annot"><span class="annottext">unsafeCreateFpUptoN :: Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN"><span class="hs-identifier hs-var hs-var">unsafeCreateFpUptoN</span></a></span></span><span> </span><span id="local-6989586621679118293"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118293"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118294"><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118294"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpUptoN"><span class="hs-identifier hs-var">createFpUptoN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118293"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118294"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN"><span class="hs-pragma hs-type">unsafeCreateFpUptoN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span id="local-6989586621679117567"><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN%27"><span class="hs-identifier hs-type">unsafeCreateFpUptoN'</span></a></span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117567"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117567"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-655"></span><span id="unsafeCreateFpUptoN%27"><span class="annot"><span class="annottext">unsafeCreateFpUptoN' :: forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN%27"><span class="hs-identifier hs-var hs-var">unsafeCreateFpUptoN'</span></a></span></span><span> </span><span id="local-6989586621679118295"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118295"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118296"><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (Int, a)
</span><a href="#local-6989586621679118296"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (ByteString, a) -&gt; (ByteString, a)
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; IO (ByteString, a)
forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; IO (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#createFpUptoN%27"><span class="hs-identifier hs-var">createFpUptoN'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118295"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (Int, a)
</span><a href="#local-6989586621679118296"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN%27"><span class="hs-pragma hs-type">unsafeCreateFpUptoN'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span class="annot"><span class="hs-comment">-- | Create ByteString of size @l@ and use action @f@ to fill its contents.</span></span><span>
</span><span id="line-659"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-type">createFp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-660"></span><span id="createFp"><span class="annot"><span class="annottext">createFp :: Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-var hs-var">createFp</span></a></span></span><span> </span><span id="local-6989586621679118297"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118297"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679118298"><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118298"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO ByteString -&gt; IO ByteString
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118297"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; IO ByteString) -&gt; IO ByteString -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621679118299"><span class="annot"><a href="#local-6989586621679118299"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118297"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><a href="#local-6989586621679118298"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118299"><span class="hs-identifier hs-type">fp</span></a></span><span>
</span><span id="line-663"></span><span>    </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mkDeferredByteString"><span class="hs-identifier hs-type">mkDeferredByteString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118299"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118297"><span class="hs-identifier hs-type">len</span></a></span><span>
</span><span id="line-664"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-pragma hs-type">createFp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">-- | Given a maximum size @l@ and an action @f@ that fills the 'ByteString'</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- starting at the given 'Ptr' and returns the actual utilized length,</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- @`createFpUptoN'` l f@ returns the filled 'ByteString'.</span><span>
</span><span id="line-669"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpUptoN"><span class="hs-identifier hs-type">createFpUptoN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-670"></span><span id="createFpUptoN"><span class="annot"><span class="annottext">createFpUptoN :: Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpUptoN"><span class="hs-identifier hs-var hs-var">createFpUptoN</span></a></span></span><span> </span><span id="local-6989586621679118300"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118300"><span class="hs-identifier hs-var">maxLen</span></a></span></span><span> </span><span id="local-6989586621679118301"><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118301"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO ByteString -&gt; IO ByteString
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118300"><span class="hs-identifier hs-var">maxLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; IO ByteString) -&gt; IO ByteString -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-671"></span><span>    </span><span id="local-6989586621679118302"><span class="annot"><a href="#local-6989586621679118302"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118300"><span class="hs-identifier hs-var">maxLen</span></a></span><span>
</span><span id="line-672"></span><span>    </span><span id="local-6989586621679118303"><span class="annot"><a href="#local-6989586621679118303"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679118301"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118302"><span class="hs-identifier hs-type">fp</span></a></span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118303"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118303"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118300"><span class="hs-identifier hs-type">maxLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mkDeferredByteString"><span class="hs-identifier hs-type">mkDeferredByteString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118302"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118303"><span class="hs-identifier hs-type">len</span></a></span><span>
</span><span id="line-674"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpUptoN"><span class="hs-pragma hs-type">createFpUptoN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-- | Like 'createFpUptoN', but also returns an additional value created by the</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- action.</span><span>
</span><span id="line-678"></span><span id="local-6989586621679117573"><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpUptoN%27"><span class="hs-identifier hs-type">createFpUptoN'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-679"></span><span id="createFpUptoN%27"><span class="annot"><span class="annottext">createFpUptoN' :: forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; IO (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#createFpUptoN%27"><span class="hs-identifier hs-var hs-var">createFpUptoN'</span></a></span></span><span> </span><span id="local-6989586621679118318"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118318"><span class="hs-identifier hs-var">maxLen</span></a></span></span><span> </span><span id="local-6989586621679118319"><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (Int, a)
</span><a href="#local-6989586621679118319"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO (ByteString, a) -&gt; IO (ByteString, a)
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118318"><span class="hs-identifier hs-var">maxLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO (ByteString, a) -&gt; IO (ByteString, a))
-&gt; IO (ByteString, a) -&gt; IO (ByteString, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-680"></span><span>    </span><span id="local-6989586621679118320"><span class="annot"><a href="#local-6989586621679118320"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118318"><span class="hs-identifier hs-var">maxLen</span></a></span><span>
</span><span id="line-681"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679118321"><span class="annot"><a href="#local-6989586621679118321"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679118322"><span class="annot"><a href="#local-6989586621679118322"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679118319"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118320"><span class="hs-identifier hs-type">fp</span></a></span><span>
</span><span id="line-682"></span><span>    </span><span id="local-6989586621679118323"><span class="annot"><a href="#local-6989586621679118323"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mkDeferredByteString"><span class="hs-identifier hs-type">mkDeferredByteString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118320"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118321"><span class="hs-identifier hs-type">len</span></a></span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118321"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118321"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118318"><span class="hs-identifier hs-type">maxLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118323"><span class="hs-identifier hs-type">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118322"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpUptoN%27"><span class="hs-pragma hs-type">createFpUptoN'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-comment">-- | Given the maximum size needed and a function to make the contents</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- of a ByteString, createFpAndTrim makes the 'ByteString'. The generating</span><span>
</span><span id="line-688"></span><span class="hs-comment">-- function is required to return the actual final size (&lt;= the maximum</span><span>
</span><span id="line-689"></span><span class="hs-comment">-- size), and the resulting byte array is reallocated to this size.</span><span>
</span><span id="line-690"></span><span class="hs-comment">--</span><span>
</span><span id="line-691"></span><span class="hs-comment">-- createFpAndTrim is the main mechanism for creating custom, efficient</span><span>
</span><span id="line-692"></span><span class="hs-comment">-- ByteString functions, using Haskell or C functions to fill the space.</span><span>
</span><span id="line-693"></span><span class="hs-comment">--</span><span>
</span><span id="line-694"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-identifier hs-type">createFpAndTrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-695"></span><span id="createFpAndTrim"><span class="annot"><span class="annottext">createFpAndTrim :: Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-identifier hs-var hs-var">createFpAndTrim</span></a></span></span><span> </span><span id="local-6989586621679118324"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118324"><span class="hs-identifier hs-var">maxLen</span></a></span></span><span> </span><span id="local-6989586621679118325"><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118325"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO ByteString -&gt; IO ByteString
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118324"><span class="hs-identifier hs-var">maxLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; IO ByteString) -&gt; IO ByteString -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-696"></span><span>    </span><span id="local-6989586621679118326"><span class="annot"><a href="#local-6989586621679118326"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118324"><span class="hs-identifier hs-var">maxLen</span></a></span><span>
</span><span id="line-697"></span><span>    </span><span id="local-6989586621679118327"><span class="annot"><a href="#local-6989586621679118327"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679118325"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118326"><span class="hs-identifier hs-type">fp</span></a></span><span>
</span><span id="line-698"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118327"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118327"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118324"><span class="hs-identifier hs-type">maxLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679118327"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-type">&gt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118324"><span class="hs-identifier hs-type">maxLen</span></a></span><span>
</span><span id="line-699"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mkDeferredByteString"><span class="hs-identifier hs-type">mkDeferredByteString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118326"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118324"><span class="hs-identifier hs-type">maxLen</span></a></span><span>
</span><span id="line-700"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-type">createFp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118327"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118328"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118328"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118328"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118326"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118327"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-701"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-pragma hs-type">createFpAndTrim</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span id="local-6989586621679117577"><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpAndTrim%27"><span class="hs-identifier hs-type">createFpAndTrim'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117577"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117577"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-704"></span><span id="createFpAndTrim%27"><span class="annot"><span class="annottext">createFpAndTrim' :: forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, Int, a)) -&gt; IO (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim%27"><span class="hs-identifier hs-var hs-var">createFpAndTrim'</span></a></span></span><span> </span><span id="local-6989586621679118351"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118351"><span class="hs-identifier hs-var">maxLen</span></a></span></span><span> </span><span id="local-6989586621679118352"><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO (Int, Int, a)
</span><a href="#local-6989586621679118352"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO (ByteString, a) -&gt; IO (ByteString, a)
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118351"><span class="hs-identifier hs-var">maxLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO (ByteString, a) -&gt; IO (ByteString, a))
-&gt; IO (ByteString, a) -&gt; IO (ByteString, a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-705"></span><span>    </span><span id="local-6989586621679118353"><span class="annot"><a href="#local-6989586621679118353"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr Word8)
forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var">mallocByteString</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118351"><span class="hs-identifier hs-var">maxLen</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679118354"><span class="annot"><a href="#local-6989586621679118354"><span class="hs-identifier hs-var">off</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679118355"><span class="annot"><a href="#local-6989586621679118355"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679118356"><span class="annot"><a href="#local-6989586621679118356"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679118352"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118353"><span class="hs-identifier hs-type">fp</span></a></span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">assert</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-708"></span><span>      </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118355"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118355"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118351"><span class="hs-identifier hs-type">maxLen</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="hs-comment">-- length OK</span><span>
</span><span id="line-709"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118355"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-type">==</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-type">||</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118354"><span class="hs-identifier hs-type">off</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-type">&amp;&amp;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118354"><span class="hs-identifier hs-type">off</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-type">&lt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118351"><span class="hs-identifier hs-type">maxLen</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621679118355"><span class="hs-identifier hs-type">len</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- offset OK</span><span>
</span><span id="line-710"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>    </span><span id="local-6989586621679118358"><span class="annot"><a href="#local-6989586621679118358"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679118355"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-type">&gt;=</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118351"><span class="hs-identifier hs-type">maxLen</span></a></span><span>
</span><span id="line-712"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mkDeferredByteString"><span class="hs-identifier hs-type">mkDeferredByteString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118353"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118351"><span class="hs-identifier hs-type">maxLen</span></a></span><span> </span><span class="hs-comment">-- entire buffer used =&gt; offset is zero</span><span>
</span><span id="line-713"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-type">createFp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118355"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118359"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118359"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-714"></span><span>               </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118359"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118353"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118354"><span class="hs-identifier hs-var">off</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118355"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-715"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679118358"><span class="hs-identifier hs-type">bs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679118356"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createFpAndTrim%27"><span class="hs-pragma hs-type">createFpAndTrim'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span id="local-6989586621679117579"><span class="annot"><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-type">wrapAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117579"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679117579"><span class="hs-identifier hs-type">res</span></a></span></span><span>
</span><span id="line-720"></span><span id="wrapAction"><span class="annot"><span class="annottext">wrapAction :: forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var hs-var">wrapAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO res) -&gt; IO res)
-&gt; (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO res) -&gt; IO res
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withForeignPtr</span></span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-comment">-- Cannot use unsafeWithForeignPtr, because action can diverge</span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="hs-comment">-- | A way of creating ByteStrings outside the IO monad. The @Int@</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- argument gives the final size of the ByteString.</span><span>
</span><span id="line-725"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreate"><span class="hs-identifier hs-type">unsafeCreate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-726"></span><span id="unsafeCreate"><span class="annot"><span class="annottext">unsafeCreate :: Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreate"><span class="hs-identifier hs-var hs-var">unsafeCreate</span></a></span></span><span> </span><span id="local-6989586621679118362"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118362"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118363"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118363"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118362"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO ()) -&gt; ForeignPtr Word8 -&gt; IO ()
forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var">wrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118363"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreate"><span class="hs-pragma hs-type">unsafeCreate</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span class="hs-comment">-- | Like 'unsafeCreate' but instead of giving the final size of the</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- ByteString, it is just an upper bound. The inner action returns</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- the actual size. Unlike 'createAndTrim' the ByteString is not</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- reallocated if the final size is less than the estimated size.</span><span>
</span><span id="line-733"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateUptoN"><span class="hs-identifier hs-type">unsafeCreateUptoN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-734"></span><span id="unsafeCreateUptoN"><span class="annot"><span class="annottext">unsafeCreateUptoN :: Int -&gt; (Ptr Word8 -&gt; IO Int) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateUptoN"><span class="hs-identifier hs-var hs-var">unsafeCreateUptoN</span></a></span></span><span> </span><span id="local-6989586621679118364"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118364"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118365"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118365"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN"><span class="hs-identifier hs-var">unsafeCreateFpUptoN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118364"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO Int) -&gt; ForeignPtr Word8 -&gt; IO Int
forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var">wrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118365"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateUptoN"><span class="hs-pragma hs-type">unsafeCreateUptoN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span class="annot"><span class="hs-comment">-- | @since 0.10.12.0</span></span><span>
</span><span id="line-738"></span><span id="local-6989586621679117585"><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateUptoN%27"><span class="hs-identifier hs-type">unsafeCreateUptoN'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117585"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117585"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-739"></span><span id="unsafeCreateUptoN%27"><span class="annot"><span class="annottext">unsafeCreateUptoN' :: forall a. Int -&gt; (Ptr Word8 -&gt; IO (Int, a)) -&gt; (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateUptoN%27"><span class="hs-identifier hs-var hs-var">unsafeCreateUptoN'</span></a></span></span><span> </span><span id="local-6989586621679118366"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118366"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118367"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO (Int, a)
</span><a href="#local-6989586621679118367"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; (ByteString, a)
forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFpUptoN%27"><span class="hs-identifier hs-var">unsafeCreateFpUptoN'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118366"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO (Int, a)) -&gt; ForeignPtr Word8 -&gt; IO (Int, a)
forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var">wrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO (Int, a)
</span><a href="#local-6989586621679118367"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#unsafeCreateUptoN%27"><span class="hs-pragma hs-type">unsafeCreateUptoN'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-741"></span><span>
</span><span id="line-742"></span><span class="annot"><span class="hs-comment">-- | Create ByteString of size @l@ and use action @f@ to fill its contents.</span></span><span>
</span><span id="line-743"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#create"><span class="hs-identifier hs-type">create</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-744"></span><span id="create"><span class="annot"><span class="annottext">create :: Int -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#create"><span class="hs-identifier hs-var hs-var">create</span></a></span></span><span> </span><span id="local-6989586621679118368"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118368"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118369"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118369"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFp"><span class="hs-identifier hs-var">createFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118368"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO ()) -&gt; ForeignPtr Word8 -&gt; IO ()
forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var">wrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118369"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-745"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#create"><span class="hs-pragma hs-type">create</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span class="hs-comment">-- | Given a maximum size @l@ and an action @f@ that fills the 'ByteString'</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- starting at the given 'Ptr' and returns the actual utilized length,</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- @`createUptoN'` l f@ returns the filled 'ByteString'.</span><span>
</span><span id="line-750"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createUptoN"><span class="hs-identifier hs-type">createUptoN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-751"></span><span id="createUptoN"><span class="annot"><span class="annottext">createUptoN :: Int -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createUptoN"><span class="hs-identifier hs-var hs-var">createUptoN</span></a></span></span><span> </span><span id="local-6989586621679118370"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118370"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118371"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118371"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpUptoN"><span class="hs-identifier hs-var">createFpUptoN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118370"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO Int) -&gt; ForeignPtr Word8 -&gt; IO Int
forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var">wrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118371"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createUptoN"><span class="hs-pragma hs-type">createUptoN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-753"></span><span>
</span><span id="line-754"></span><span class="hs-comment">-- | Like 'createUptoN', but also returns an additional value created by the</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- action.</span><span>
</span><span id="line-756"></span><span class="hs-comment">--</span><span>
</span><span id="line-757"></span><span class="hs-comment">-- @since 0.10.12.0</span><span>
</span><span id="line-758"></span><span id="local-6989586621679117587"><span class="annot"><a href="Data.ByteString.Internal.Type.html#createUptoN%27"><span class="hs-identifier hs-type">createUptoN'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117587"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117587"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-759"></span><span id="createUptoN%27"><span class="annot"><span class="annottext">createUptoN' :: forall a. Int -&gt; (Ptr Word8 -&gt; IO (Int, a)) -&gt; IO (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#createUptoN%27"><span class="hs-identifier hs-var hs-var">createUptoN'</span></a></span></span><span> </span><span id="local-6989586621679118372"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118372"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118373"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO (Int, a)
</span><a href="#local-6989586621679118373"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; IO (ByteString, a)
forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, a)) -&gt; IO (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#createFpUptoN%27"><span class="hs-identifier hs-var">createFpUptoN'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118372"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO (Int, a)) -&gt; ForeignPtr Word8 -&gt; IO (Int, a)
forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var">wrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO (Int, a)
</span><a href="#local-6989586621679118373"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createUptoN%27"><span class="hs-pragma hs-type">createUptoN'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span class="hs-comment">-- | Given the maximum size needed and a function to make the contents</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- of a ByteString, createAndTrim makes the 'ByteString'. The generating</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- function is required to return the actual final size (&lt;= the maximum</span><span>
</span><span id="line-765"></span><span class="hs-comment">-- size), and the resulting byte array is reallocated to this size.</span><span>
</span><span id="line-766"></span><span class="hs-comment">--</span><span>
</span><span id="line-767"></span><span class="hs-comment">-- createAndTrim is the main mechanism for creating custom, efficient</span><span>
</span><span id="line-768"></span><span class="hs-comment">-- ByteString functions, using Haskell or C functions to fill the space.</span><span>
</span><span id="line-769"></span><span class="hs-comment">--</span><span>
</span><span id="line-770"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createAndTrim"><span class="hs-identifier hs-type">createAndTrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-771"></span><span id="createAndTrim"><span class="annot"><span class="annottext">createAndTrim :: Int -&gt; (Ptr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createAndTrim"><span class="hs-identifier hs-var hs-var">createAndTrim</span></a></span></span><span> </span><span id="local-6989586621679118374"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118374"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118375"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118375"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO Int) -&gt; IO ByteString
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim"><span class="hs-identifier hs-var">createFpAndTrim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118374"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO Int) -&gt; ForeignPtr Word8 -&gt; IO Int
forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var">wrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO Int
</span><a href="#local-6989586621679118375"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createAndTrim"><span class="hs-pragma hs-type">createAndTrim</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span id="local-6989586621679117589"><span class="annot"><a href="Data.ByteString.Internal.Type.html#createAndTrim%27"><span class="hs-identifier hs-type">createAndTrim'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117589"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679117589"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-775"></span><span id="createAndTrim%27"><span class="annot"><span class="annottext">createAndTrim' :: forall a.
Int -&gt; (Ptr Word8 -&gt; IO (Int, Int, a)) -&gt; IO (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#createAndTrim%27"><span class="hs-identifier hs-var hs-var">createAndTrim'</span></a></span></span><span> </span><span id="local-6989586621679118376"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118376"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679118377"><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO (Int, Int, a)
</span><a href="#local-6989586621679118377"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, Int, a)) -&gt; IO (ByteString, a)
forall a.
Int -&gt; (ForeignPtr Word8 -&gt; IO (Int, Int, a)) -&gt; IO (ByteString, a)
</span><a href="Data.ByteString.Internal.Type.html#createFpAndTrim%27"><span class="hs-identifier hs-var">createFpAndTrim'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118376"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ptr Word8 -&gt; IO (Int, Int, a))
-&gt; ForeignPtr Word8 -&gt; IO (Int, Int, a)
forall res. (Ptr Word8 -&gt; IO res) -&gt; ForeignPtr Word8 -&gt; IO res
</span><a href="Data.ByteString.Internal.Type.html#wrapAction"><span class="hs-identifier hs-var">wrapAction</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; IO (Int, Int, a)
</span><a href="#local-6989586621679118377"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-776"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#createAndTrim%27"><span class="hs-pragma hs-type">createAndTrim'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span>
</span><span id="line-779"></span><span class="hs-comment">-- | Wrapper of 'Foreign.ForeignPtr.mallocForeignPtrBytes' with faster implementation for GHC</span><span>
</span><span id="line-780"></span><span class="hs-comment">--</span><span>
</span><span id="line-781"></span><span id="local-6989586621679117575"><span class="annot"><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-type">mallocByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679117575"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-782"></span><span id="mallocByteString"><span class="annot"><span class="annottext">mallocByteString :: forall a. Int -&gt; IO (ForeignPtr a)
</span><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-identifier hs-var hs-var">mallocByteString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (ForeignPtr a)
forall a. Int -&gt; IO (ForeignPtr a)
</span><span class="hs-identifier hs-var">mallocPlainForeignPtrBytes</span></span><span>
</span><span id="line-783"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#mallocByteString"><span class="hs-pragma hs-type">mallocByteString</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-784"></span><span>
</span><span id="line-785"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- Implementations for Eq, Ord and Monoid instances</span><span>
</span><span id="line-787"></span><span>
</span><span id="line-788"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#eq"><span class="hs-identifier hs-type">eq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-789"></span><span id="eq"><span class="annot"><span class="annottext">eq :: ByteString -&gt; ByteString -&gt; Bool
</span><a href="Data.ByteString.Internal.Type.html#eq"><span class="hs-identifier hs-var hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621679118378"><span class="annot"><span class="annottext">a :: ByteString
</span><a href="#local-6989586621679118378"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118379"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118379"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118380"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118380"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679118381"><span class="annot"><span class="annottext">b :: ByteString
</span><a href="#local-6989586621679118381"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118382"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118382"><span class="hs-identifier hs-var">fp'</span></a></span></span><span> </span><span id="local-6989586621679118383"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118383"><span class="hs-identifier hs-var">len'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118380"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118383"><span class="hs-identifier hs-var">len'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>    </span><span class="hs-comment">-- short cut on length</span><span>
</span><span id="line-791"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118379"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118382"><span class="hs-identifier hs-var">fp'</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>     </span><span class="hs-comment">-- short cut for the same string</span><span>
</span><span id="line-792"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Ordering
</span><a href="Data.ByteString.Internal.Type.html#compareBytes"><span class="hs-identifier hs-var">compareBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118378"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118381"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-793"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#eq"><span class="hs-pragma hs-type">eq</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-794"></span><span class="annot"><span class="hs-comment">-- ^ still needed</span></span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#compareBytes"><span class="hs-identifier hs-type">compareBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a></span><span>
</span><span id="line-797"></span><span id="compareBytes"><span class="annot"><span class="annottext">compareBytes :: ByteString -&gt; ByteString -&gt; Ordering
</span><a href="Data.ByteString.Internal.Type.html#compareBytes"><span class="hs-identifier hs-var hs-var">compareBytes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>  </span><span class="hs-comment">-- short cut for empty strings</span><span>
</span><span id="line-798"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#compareBytes"><span class="hs-identifier hs-var">compareBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118385"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118385"><span class="hs-identifier hs-var">fp1</span></a></span></span><span> </span><span id="local-6989586621679118386"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118386"><span class="hs-identifier hs-var">len1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118387"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118387"><span class="hs-identifier hs-var">fp2</span></a></span></span><span> </span><span id="local-6989586621679118388"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118388"><span class="hs-identifier hs-var">len2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-799"></span><span>    </span><span class="annot"><span class="annottext">IO Ordering -&gt; Ordering
forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var">accursedUnutterablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Ordering -&gt; Ordering) -&gt; IO Ordering -&gt; Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-800"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Ordering) -&gt; IO Ordering
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118385"><span class="hs-identifier hs-var">fp1</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Ordering) -&gt; IO Ordering)
-&gt; (Ptr Word8 -&gt; IO Ordering) -&gt; IO Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118389"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118389"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-801"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO Ordering) -&gt; IO Ordering
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118387"><span class="hs-identifier hs-var">fp2</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO Ordering) -&gt; IO Ordering)
-&gt; (Ptr Word8 -&gt; IO Ordering) -&gt; IO Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118390"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118390"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-802"></span><span>        </span><span id="local-6989586621679118391"><span class="annot"><a href="#local-6989586621679118391"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO CInt
</span><a href="Data.ByteString.Internal.Type.html#memcmp"><span class="hs-identifier hs-var">memcmp</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118389"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118390"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118386"><span class="hs-identifier hs-var">len1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118388"><span class="hs-identifier hs-var">len2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679118391"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#compare"><span class="hs-operator hs-type">`compare`</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-804"></span><span>                    </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118386"><span class="hs-identifier hs-var">len1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#compare"><span class="hs-operator hs-var">`compare`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118388"><span class="hs-identifier hs-var">len2</span></a></span><span>
</span><span id="line-805"></span><span>                    </span><span id="local-6989586621679118393"><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679118393"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679118393"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span class="annot"><span class="hs-comment">-- | /O(1)/ The empty 'ByteString'</span></span><span>
</span><span id="line-809"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-810"></span><span class="hs-comment">-- This enables bypassing #457 by not using (polymorphic) mempty in</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- any definitions used by the (Monoid ByteString) instance</span><span>
</span><span id="line-812"></span><span id="empty"><span class="annot"><span class="annottext">empty :: ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="Data.ByteString.Internal.Type.html#nullForeignPtr"><span class="hs-identifier hs-var">nullForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#append"><span class="hs-identifier hs-type">append</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-815"></span><span id="append"><span class="annot"><span class="annottext">append :: ByteString -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#append"><span class="hs-identifier hs-var hs-var">append</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621679118394"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118394"><span class="hs-identifier hs-var">b</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118394"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-816"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#append"><span class="hs-identifier hs-var">append</span></a></span><span> </span><span id="local-6989586621679118395"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118395"><span class="hs-identifier hs-var">a</span></a></span></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118395"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-817"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#append"><span class="hs-identifier hs-var">append</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118396"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118396"><span class="hs-identifier hs-var">fp1</span></a></span></span><span> </span><span id="local-6989586621679118397"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118397"><span class="hs-identifier hs-var">len1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118398"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118398"><span class="hs-identifier hs-var">fp2</span></a></span></span><span> </span><span id="local-6989586621679118399"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118399"><span class="hs-identifier hs-var">len2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-818"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var">checkedAdd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;append&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118397"><span class="hs-identifier hs-var">len1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118399"><span class="hs-identifier hs-var">len2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118400"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118400"><span class="hs-identifier hs-var">destptr1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-819"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679118401"><span class="annot"><span class="annottext">destptr2 :: ForeignPtr Word8
</span><a href="#local-6989586621679118401"><span class="hs-identifier hs-var hs-var hs-var">destptr2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118400"><span class="hs-identifier hs-var">destptr1</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118397"><span class="hs-identifier hs-var">len1</span></a></span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118400"><span class="hs-identifier hs-var">destptr1</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118396"><span class="hs-identifier hs-var">fp1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118397"><span class="hs-identifier hs-var">len1</span></a></span><span>
</span><span id="line-821"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118401"><span class="hs-identifier hs-var">destptr2</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118398"><span class="hs-identifier hs-var">fp2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118399"><span class="hs-identifier hs-var">len2</span></a></span><span>
</span><span id="line-822"></span><span>
</span><span id="line-823"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#concat"><span class="hs-identifier hs-type">concat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-824"></span><span id="concat"><span class="annot"><span class="annottext">concat :: [ByteString] -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#concat"><span class="hs-identifier hs-var hs-var">concat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118402"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118402"><span class="hs-identifier hs-var">bss0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118403"><span class="hs-identifier hs-var">goLen0</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118402"><span class="hs-identifier hs-var">bss0</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118402"><span class="hs-identifier hs-var">bss0</span></a></span><span>
</span><span id="line-825"></span><span>    </span><span class="hs-comment">-- The idea here is we first do a pass over the input list to determine:</span><span>
</span><span id="line-826"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-827"></span><span>    </span><span class="hs-comment">--  1. is a copy necessary? e.g. @concat []@, @concat [mempty, &quot;hello&quot;]@,</span><span>
</span><span id="line-828"></span><span>    </span><span class="hs-comment">--     and @concat [&quot;hello&quot;, mempty, mempty]@ can all be handled without</span><span>
</span><span id="line-829"></span><span>    </span><span class="hs-comment">--     copying.</span><span>
</span><span id="line-830"></span><span>    </span><span class="hs-comment">--  2. if a copy is necessary, how large is the result going to be?</span><span>
</span><span id="line-831"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-832"></span><span>    </span><span class="hs-comment">-- If a copy is necessary then we create a buffer of the appropriate size</span><span>
</span><span id="line-833"></span><span>    </span><span class="hs-comment">-- and do another pass over the input list, copying the chunks into the</span><span>
</span><span id="line-834"></span><span>    </span><span class="hs-comment">-- buffer. Also, since foreign calls aren't entirely free we skip over</span><span>
</span><span id="line-835"></span><span>    </span><span class="hs-comment">-- empty chunks while copying.</span><span>
</span><span id="line-836"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-837"></span><span>    </span><span class="hs-comment">-- We pass the original [ByteString] (bss0) through as an argument through</span><span>
</span><span id="line-838"></span><span>    </span><span class="hs-comment">-- goLen0, goLen1, and goLen since we will need it again in goCopy. Passing</span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-comment">-- it as an explicit argument avoids capturing it in these functions'</span><span>
</span><span id="line-840"></span><span>    </span><span class="hs-comment">-- closures which would result in unnecessary closure allocation.</span><span>
</span><span id="line-841"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-842"></span><span>    </span><span class="hs-comment">-- It's still possible that the result is empty</span><span>
</span><span id="line-843"></span><span>    </span><span id="local-6989586621679118403"><span class="annot"><span class="annottext">goLen0 :: [ByteString] -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118403"><span class="hs-identifier hs-var hs-var">goLen0</span></a></span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-844"></span><span>    </span><span class="annot"><a href="#local-6989586621679118403"><span class="hs-identifier hs-var">goLen0</span></a></span><span> </span><span id="local-6989586621679118406"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118406"><span class="hs-identifier hs-var">bss0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>     </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118407"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118407"><span class="hs-identifier hs-var">bss</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118403"><span class="hs-identifier hs-var">goLen0</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118406"><span class="hs-identifier hs-var">bss0</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118407"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-845"></span><span>    </span><span class="annot"><a href="#local-6989586621679118403"><span class="hs-identifier hs-var">goLen0</span></a></span><span> </span><span id="local-6989586621679118408"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118408"><span class="hs-identifier hs-var">bss0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679118409"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118409"><span class="hs-identifier hs-var">bs</span></a></span></span><span>           </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118410"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118410"><span class="hs-identifier hs-var">bss</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118411"><span class="hs-identifier hs-var">goLen1</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118408"><span class="hs-identifier hs-var">bss0</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118409"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118410"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span>    </span><span class="hs-comment">-- It's still possible that the result is a single chunk</span><span>
</span><span id="line-848"></span><span>    </span><span id="local-6989586621679118411"><span class="annot"><span class="annottext">goLen1 :: [ByteString] -&gt; ByteString -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118411"><span class="hs-identifier hs-var hs-var">goLen1</span></a></span></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><span class="hs-identifier">_</span></span><span>    </span><span id="local-6989586621679118414"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118414"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118414"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-849"></span><span>    </span><span class="annot"><a href="#local-6989586621679118411"><span class="hs-identifier hs-var">goLen1</span></a></span><span> </span><span id="local-6989586621679118415"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118415"><span class="hs-identifier hs-var">bss0</span></a></span></span><span> </span><span id="local-6989586621679118416"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118416"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118417"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118417"><span class="hs-identifier hs-var">bss</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118411"><span class="hs-identifier hs-var">goLen1</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118415"><span class="hs-identifier hs-var">bss0</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118416"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118417"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-850"></span><span>    </span><span class="annot"><a href="#local-6989586621679118411"><span class="hs-identifier hs-var">goLen1</span></a></span><span> </span><span id="local-6989586621679118418"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118418"><span class="hs-identifier hs-var">bss0</span></a></span></span><span> </span><span id="local-6989586621679118419"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118419"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679118420"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118420"><span class="hs-identifier hs-var">len</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118421"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118421"><span class="hs-identifier hs-var">bss</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Int -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118422"><span class="hs-identifier hs-var">goLen</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118418"><span class="hs-identifier hs-var">bss0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var">checkedAdd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;concat&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118423"><span class="hs-identifier hs-var">len'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118420"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118421"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-851"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679118423"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118423"><span class="hs-identifier hs-var">len'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118419"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span>    </span><span class="hs-comment">-- General case, just find the total length we'll need</span><span>
</span><span id="line-854"></span><span>    </span><span id="local-6989586621679118422"><span class="annot"><span class="annottext">goLen :: [ByteString] -&gt; Int -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118422"><span class="hs-identifier hs-var hs-var">goLen</span></a></span></span><span> </span><span id="local-6989586621679118424"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118424"><span class="hs-identifier hs-var">bss0</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118425"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118425"><span class="hs-identifier hs-var">total</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679118426"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118426"><span class="hs-identifier hs-var">len</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118427"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118427"><span class="hs-identifier hs-var">bss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Int -&gt; [ByteString] -&gt; ByteString
</span><a href="#local-6989586621679118422"><span class="hs-identifier hs-var">goLen</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118424"><span class="hs-identifier hs-var">bss0</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118428"><span class="hs-identifier hs-var">total'</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118427"><span class="hs-identifier hs-var">bss</span></a></span><span>
</span><span id="line-855"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679118428"><span class="annot"><span class="annottext">total' :: Int
</span><a href="#local-6989586621679118428"><span class="hs-identifier hs-var hs-var">total'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var">checkedAdd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;concat&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118425"><span class="hs-identifier hs-var">total</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118426"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-856"></span><span>    </span><span class="annot"><a href="#local-6989586621679118422"><span class="hs-identifier hs-var">goLen</span></a></span><span> </span><span id="local-6989586621679118429"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118429"><span class="hs-identifier hs-var">bss0</span></a></span></span><span> </span><span id="local-6989586621679118430"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118430"><span class="hs-identifier hs-var">total</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-857"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118430"><span class="hs-identifier hs-var">total</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118431"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118431"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118432"><span class="hs-identifier hs-var">goCopy</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118429"><span class="hs-identifier hs-var">bss0</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118431"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span>    </span><span class="hs-comment">-- Copy the data</span><span>
</span><span id="line-860"></span><span>    </span><span id="local-6989586621679118432"><span class="annot"><span class="annottext">goCopy :: [ByteString] -&gt; ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118432"><span class="hs-identifier hs-var hs-var">goCopy</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                  </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>    </span><span class="annot"><a href="#local-6989586621679118432"><span class="hs-identifier hs-var">goCopy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118437"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118437"><span class="hs-identifier hs-var">bss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118438"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118438"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118432"><span class="hs-identifier hs-var">goCopy</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118437"><span class="hs-identifier hs-var">bss</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118438"><span class="hs-identifier hs-var">ptr</span></a></span><span>
</span><span id="line-862"></span><span>    </span><span class="annot"><a href="#local-6989586621679118432"><span class="hs-identifier hs-var">goCopy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118439"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118439"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118440"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118440"><span class="hs-identifier hs-var">len</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679118441"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118441"><span class="hs-identifier hs-var">bss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118442"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118442"><span class="hs-identifier hs-var">ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-863"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118442"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118439"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118440"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-864"></span><span>      </span><span class="annot"><span class="annottext">[ByteString] -&gt; ForeignPtr Word8 -&gt; IO ()
</span><a href="#local-6989586621679118432"><span class="hs-identifier hs-var">goCopy</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679118441"><span class="hs-identifier hs-var">bss</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118442"><span class="hs-identifier hs-var">ptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118440"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#concat"><span class="hs-pragma hs-type">concat</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span class="hs-pragma">{-# RULES</span><span>
</span><span id="line-868"></span><span class="annot"><span class="hs-pragma">&quot;ByteString concat [] -&gt; empty&quot;</span></span><span>
</span><span id="line-869"></span><span>   </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#concat"><span class="hs-pragma hs-type">concat</span></a></span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-pragma hs-type">empty</span></a></span><span>
</span><span id="line-870"></span><span class="annot"><span class="hs-pragma">&quot;ByteString concat [bs] -&gt; bs&quot;</span></span><span> </span><span class="hs-pragma">forall</span><span> </span><span id="local-6989586621679118443"><span class="annot"><a href="#local-6989586621679118443"><span class="hs-pragma hs-var">x</span></a></span></span><span class="hs-pragma">.</span><span>
</span><span id="line-871"></span><span>   </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#concat"><span class="hs-pragma hs-type">concat</span></a></span><span> </span><span class="hs-pragma">[</span><span class="annot"><a href="#local-6989586621679118443"><span class="hs-pragma hs-type">x</span></a></span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="annot"><a href="#local-6989586621679118443"><span class="hs-pragma hs-type">x</span></a></span><span>
</span><span id="line-872"></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-873"></span><span>
</span><span id="line-874"></span><span class="hs-comment">-- | Repeats the given ByteString n times.</span><span>
</span><span id="line-875"></span><span class="hs-comment">-- Polymorphic wrapper to make sure any generated</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- specializations are reasonably small.</span><span>
</span><span id="line-877"></span><span id="local-6989586621679118444"><span class="annot"><a href="Data.ByteString.Internal.Type.html#stimesPolymorphic"><span class="hs-identifier hs-type">stimesPolymorphic</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679118444"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118444"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span></span><span>
</span><span id="line-878"></span><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#stimesPolymorphic"><span class="hs-pragma hs-type">stimesPolymorphic</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-879"></span><span id="stimesPolymorphic"><span class="annot"><span class="annottext">stimesPolymorphic :: forall b. Integral b =&gt; b -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesPolymorphic"><span class="hs-identifier hs-var hs-var">stimesPolymorphic</span></a></span></span><span> </span><span id="local-6989586621679118454"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679118454"><span class="hs-identifier hs-var">nRaw</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118455"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118455"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Int
</span><a href="Data.ByteString.Internal.Type.html#checkedIntegerToInt"><span class="hs-identifier hs-var">checkedIntegerToInt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679118457"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-880"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679118458"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118458"><span class="hs-identifier hs-var">nInt</span></a></span></span><span>
</span><span id="line-881"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118458"><span class="hs-identifier hs-var">nInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesNonNegativeInt"><span class="hs-identifier hs-var">stimesNonNegativeInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118458"><span class="hs-identifier hs-var">nInt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118455"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-882"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesNegativeErr"><span class="hs-identifier hs-var">stimesNegativeErr</span></a></span><span>
</span><span id="line-883"></span><span>  </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-884"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679118457"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesNegativeErr"><span class="hs-identifier hs-var">stimesNegativeErr</span></a></span><span>
</span><span id="line-885"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679118455"><span class="hs-identifier hs-var">bs</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-886"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesOverflowErr"><span class="hs-identifier hs-var">stimesOverflowErr</span></a></span><span>
</span><span id="line-887"></span><span>  </span><span class="hs-keyword">where</span><span>  </span><span id="local-6989586621679118457"><span class="annot"><span class="annottext">n :: Integer
</span><a href="#local-6989586621679118457"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679118454"><span class="hs-identifier hs-var">nRaw</span></a></span><span>
</span><span id="line-888"></span><span>  </span><span class="hs-comment">-- By exclusively using n instead of nRaw, the semantics are kept simple</span><span>
</span><span id="line-889"></span><span>  </span><span class="hs-comment">-- and the likelihood of potentially dangerous mistakes minimized.</span><span>
</span><span id="line-890"></span><span>
</span><span id="line-891"></span><span>
</span><span id="line-892"></span><span class="hs-comment">{-
Note [Float error calls out of INLINABLE things]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If a function is marked INLINE or INLINABLE, then when ghc inlines or
specializes it, it duplicates the function body exactly as written.

This feature is useful for systems of rewrite rules, but sometimes
comes at a code-size cost.  One situation where this cost generally
comes with no compensating up-side is when the function in question
calls `error` or something similar.

Such an `error` call is not meaningfully improved by the extra context
inlining or specialization provides, and if inlining or specialization
happens in a different module from where the function was originally
defined, CSE will not be able to de-duplicate the error call floated
out of the inlined RHS and the error call floated out of the original
RHS.  See also https://gitlab.haskell.org/ghc/ghc/-/issues/23823

To mitigate this, we manually float the error calls out of INLINABLE
functions when it is possible to do so.
-}</span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#stimesNegativeErr"><span class="hs-identifier hs-type">stimesNegativeErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-916"></span><span class="hs-comment">-- See Note [Float error calls out of INLINABLE things]</span><span>
</span><span id="line-917"></span><span id="stimesNegativeErr"><span class="annot"><span class="annottext">stimesNegativeErr :: ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesNegativeErr"><span class="hs-identifier hs-var hs-var">stimesNegativeErr</span></a></span></span><span>
</span><span id="line-918"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
forall a. String -&gt; a
</span><span class="hs-identifier hs-var">errorWithoutStackTrace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stimes @ByteString: non-negative multiplier expected&quot;</span></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#stimesOverflowErr"><span class="hs-identifier hs-type">stimesOverflowErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-921"></span><span class="hs-comment">-- See Note [Float error calls out of INLINABLE things]</span><span>
</span><span id="line-922"></span><span id="stimesOverflowErr"><span class="annot"><span class="annottext">stimesOverflowErr :: ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesOverflowErr"><span class="hs-identifier hs-var hs-var">stimesOverflowErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
forall a. String -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#overflowError"><span class="hs-identifier hs-var">overflowError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stimes&quot;</span></span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span class="annot"><span class="hs-comment">-- | Repeats the given ByteString n times.</span></span><span>
</span><span id="line-925"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#stimesNonNegativeInt"><span class="hs-identifier hs-type">stimesNonNegativeInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-926"></span><span id="stimesNonNegativeInt"><span class="annot"><span class="annottext">stimesNonNegativeInt :: Int -&gt; ByteString -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#stimesNonNegativeInt"><span class="hs-identifier hs-var hs-var">stimesNonNegativeInt</span></a></span></span><span> </span><span id="local-6989586621679118464"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118464"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-type">BS</span></a></span><span> </span><span id="local-6989586621679118465"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118465"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118466"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118466"><span class="hs-identifier hs-var">len</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118464"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-928"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118464"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#BS"><span class="hs-identifier hs-var">BS</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118465"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118466"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-929"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118466"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="Data.ByteString.Internal.Type.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-930"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118466"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118464"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118467"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118467"><span class="hs-identifier hs-var">destfptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-931"></span><span>      </span><span id="local-6989586621679118468"><span class="annot"><a href="#local-6989586621679118468"><span class="hs-identifier hs-var">byte</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO Word8
forall a. Storable a =&gt; ForeignPtr a -&gt; IO a
</span><a href="Data.ByteString.Internal.Type.html#peekFp"><span class="hs-identifier hs-var">peekFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118465"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-932"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><a href="#local-6989586621679118467"><span class="hs-identifier hs-type">destfptr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118469"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118469"><span class="hs-identifier hs-var">destptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-933"></span><span>        </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Word8 -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">fillBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118469"><span class="hs-identifier hs-var">destptr</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118468"><span class="hs-identifier hs-var">byte</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118464"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-934"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
</span><a href="Data.ByteString.Internal.Type.html#unsafeCreateFp"><span class="hs-identifier hs-var">unsafeCreateFp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118471"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">((ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString)
-&gt; (ForeignPtr Word8 -&gt; IO ()) -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118472"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118472"><span class="hs-identifier hs-var">destptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-935"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118472"><span class="hs-identifier hs-var">destptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118465"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118466"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-936"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679118473"><span class="hs-identifier hs-var">fillFrom</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118472"><span class="hs-identifier hs-var">destptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118466"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-937"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-938"></span><span>    </span><span id="local-6989586621679118471"><span class="annot"><span class="annottext">size :: Int
</span><a href="#local-6989586621679118471"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedMultiply"><span class="hs-identifier hs-var">checkedMultiply</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stimes&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118464"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118466"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-939"></span><span>    </span><span id="local-6989586621679118474"><span class="annot"><span class="annottext">halfSize :: Int
</span><a href="#local-6989586621679118474"><span class="hs-identifier hs-var hs-var">halfSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118471"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-comment">-- subtraction and division won't overflow</span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span>    </span><span class="annot"><a href="#local-6989586621679118473"><span class="hs-identifier hs-type">fillFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-942"></span><span>    </span><span id="local-6989586621679118473"><span class="annot"><span class="annottext">fillFrom :: ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679118473"><span class="hs-identifier hs-var hs-var">fillFrom</span></a></span></span><span> </span><span id="local-6989586621679118476"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118476"><span class="hs-identifier hs-var">destptr</span></a></span></span><span> </span><span id="local-6989586621679118477"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118477"><span class="hs-identifier hs-var">copied</span></a></span></span><span>
</span><span id="line-943"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118477"><span class="hs-identifier hs-var">copied</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118474"><span class="hs-identifier hs-var">halfSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-944"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118476"><span class="hs-identifier hs-var">destptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118477"><span class="hs-identifier hs-var">copied</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118476"><span class="hs-identifier hs-var">destptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118477"><span class="hs-identifier hs-var">copied</span></a></span><span>
</span><span id="line-945"></span><span>        </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="#local-6989586621679118473"><span class="hs-identifier hs-var">fillFrom</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118476"><span class="hs-identifier hs-var">destptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118477"><span class="hs-identifier hs-var">copied</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-946"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var">memcpyFp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118476"><span class="hs-identifier hs-var">destptr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Int -&gt; ForeignPtr Word8
forall a b. ForeignPtr a -&gt; Int -&gt; ForeignPtr b
</span><span class="hs-operator hs-var">`plusForeignPtr`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118477"><span class="hs-identifier hs-var">copied</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118476"><span class="hs-identifier hs-var">destptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118471"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118477"><span class="hs-identifier hs-var">copied</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-950"></span><span>
</span><span id="line-951"></span><span class="annot"><span class="hs-comment">-- | Conversion between 'Word8' and 'Char'. Should compile to a no-op.</span></span><span>
</span><span id="line-952"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#w2c"><span class="hs-identifier hs-type">w2c</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span>
</span><span id="line-953"></span><span id="w2c"><span class="annot"><span class="annottext">w2c :: Word8 -&gt; Char
</span><a href="Data.ByteString.Internal.Type.html#w2c"><span class="hs-identifier hs-var hs-var">w2c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char
</span><span class="hs-identifier hs-var">unsafeChr</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Char) -&gt; (Word8 -&gt; Int) -&gt; Word8 -&gt; Char
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-954"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#w2c"><span class="hs-pragma hs-type">w2c</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-955"></span><span>
</span><span id="line-956"></span><span class="hs-comment">-- | Unsafe conversion between 'Char' and 'Word8'. This is a no-op and</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- silently truncates to 8 bits Chars &gt; '\255'. It is provided as</span><span>
</span><span id="line-958"></span><span class="hs-comment">-- convenience for ByteString construction.</span><span>
</span><span id="line-959"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier hs-type">c2w</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-960"></span><span id="c2w"><span class="annot"><span class="annottext">c2w :: Char -&gt; Word8
</span><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier hs-var hs-var">c2w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word8) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Word8
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span>
</span><span id="line-961"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-pragma hs-type">c2w</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-962"></span><span>
</span><span id="line-963"></span><span class="annot"><span class="hs-comment">-- | Selects words corresponding to white-space characters in the Latin-1 range</span></span><span>
</span><span id="line-964"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#isSpaceWord8"><span class="hs-identifier hs-type">isSpaceWord8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-965"></span><span id="isSpaceWord8"><span class="annot"><span class="annottext">isSpaceWord8 :: Word8 -&gt; Bool
</span><a href="Data.ByteString.Internal.Type.html#isSpaceWord8"><span class="hs-identifier hs-var hs-var">isSpaceWord8</span></a></span></span><span> </span><span id="local-6989586621679118479"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118479"><span class="hs-identifier hs-var">w8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-966"></span><span>    </span><span class="hs-comment">-- Avoid the cost of narrowing arithmetic results to Word8,</span><span>
</span><span id="line-967"></span><span>    </span><span class="hs-comment">-- the conversion from Word8 to Word is free.</span><span>
</span><span id="line-968"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679118480"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a></span><span>
</span><span id="line-969"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679118480"><span class="annot"><span class="annottext">w :: Word
</span><a href="#local-6989586621679118480"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118479"><span class="hs-identifier hs-var">w8</span></a></span><span>
</span><span id="line-970"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679118480"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x50</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-comment">-- Quick non-whitespace filter</span><span>
</span><span id="line-971"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679118480"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x21</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x7e</span></span><span> </span><span class="hs-comment">-- Second non-whitespace filter</span><span>
</span><span id="line-972"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679118480"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x20</span></span><span>     </span><span class="hs-comment">-- SP</span><span>
</span><span id="line-973"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679118480"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0xa0</span></span><span>     </span><span class="hs-comment">-- NBSP</span><span>
</span><span id="line-974"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679118480"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x09</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- HT, NL, VT, FF, CR</span><span>
</span><span id="line-975"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#isSpaceWord8"><span class="hs-pragma hs-type">isSpaceWord8</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span class="annot"><span class="hs-comment">-- | Selects white-space characters in the Latin-1 range</span></span><span>
</span><span id="line-978"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#isSpaceChar8"><span class="hs-identifier hs-type">isSpaceChar8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-979"></span><span id="isSpaceChar8"><span class="annot"><span class="annottext">isSpaceChar8 :: Char -&gt; Bool
</span><a href="Data.ByteString.Internal.Type.html#isSpaceChar8"><span class="hs-identifier hs-var hs-var">isSpaceChar8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Bool
</span><a href="Data.ByteString.Internal.Type.html#isSpaceWord8"><span class="hs-identifier hs-var">isSpaceWord8</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Bool) -&gt; (Char -&gt; Word8) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Word8
</span><a href="Data.ByteString.Internal.Type.html#c2w"><span class="hs-identifier hs-var">c2w</span></a></span><span>
</span><span id="line-980"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#isSpaceChar8"><span class="hs-pragma hs-type">isSpaceChar8</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-981"></span><span>
</span><span id="line-982"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-983"></span><span>
</span><span id="line-984"></span><span class="hs-comment">-- | The type of exception raised by 'overflowError'</span><span>
</span><span id="line-985"></span><span class="hs-comment">-- and on failure by overflow-checked arithmetic operations.</span><span>
</span><span id="line-986"></span><span class="hs-keyword">newtype</span><span> </span><span id="SizeOverflowException"><span class="annot"><a href="Data.ByteString.Internal.Type.html#SizeOverflowException"><span class="hs-identifier hs-var">SizeOverflowException</span></a></span></span><span>
</span><span id="line-987"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="SizeOverflowException"><span class="annot"><a href="Data.ByteString.Internal.Type.html#SizeOverflowException"><span class="hs-identifier hs-var">SizeOverflowException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-988"></span><span>
</span><span id="line-989"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679118484"><span id="local-6989586621679118489"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#SizeOverflowException"><span class="hs-identifier hs-type">SizeOverflowException</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-990"></span><span>  </span><span id="local-6989586621679118491"><span class="annot"><span class="annottext">show :: SizeOverflowException -&gt; String
</span><a href="#local-6989586621679118491"><span class="hs-identifier hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Internal.Type.html#SizeOverflowException"><span class="hs-identifier hs-type">SizeOverflowException</span></a></span><span> </span><span id="local-6989586621679118493"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118493"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118493"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679118499"><span id="local-6989586621679118503"><span id="local-6989586621679118506"><span id="local-6989586621679118509"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#SizeOverflowException"><span class="hs-identifier hs-type">SizeOverflowException</span></a></span></span></span></span></span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span class="hs-comment">-- | Raises a 'SizeOverflowException',</span><span>
</span><span id="line-995"></span><span class="hs-comment">-- with a message using the given function name.</span><span>
</span><span id="line-996"></span><span id="local-6989586621679117596"><span class="annot"><a href="Data.ByteString.Internal.Type.html#overflowError"><span class="hs-identifier hs-type">overflowError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679117596"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-997"></span><span id="overflowError"><span class="annot"><span class="annottext">overflowError :: forall a. String -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#overflowError"><span class="hs-identifier hs-var hs-var">overflowError</span></a></span></span><span> </span><span id="local-6989586621679118515"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118515"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SizeOverflowException -&gt; a
forall a e. (?callStack::CallStack, Exception e) =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">throw</span></span><span> </span><span class="annot"><span class="annottext">(SizeOverflowException -&gt; a) -&gt; SizeOverflowException -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SizeOverflowException
</span><a href="Data.ByteString.Internal.Type.html#SizeOverflowException"><span class="hs-identifier hs-var">SizeOverflowException</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118516"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-998"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679118516"><span class="annot"><span class="annottext">msg :: String
</span><a href="#local-6989586621679118516"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Data.ByteString.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118515"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: size overflow&quot;</span></span><span>
</span><span id="line-999"></span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- | Add two non-negative numbers.</span><span>
</span><span id="line-1001"></span><span class="hs-comment">-- Calls 'overflowError' on overflow.</span><span>
</span><span id="line-1002"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-type">checkedAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1003"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-pragma hs-type">checkedAdd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1004"></span><span id="checkedAdd"><span class="annot"><span class="annottext">checkedAdd :: String -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedAdd"><span class="hs-identifier hs-var hs-var">checkedAdd</span></a></span></span><span> </span><span id="local-6989586621679118517"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118517"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621679118518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118518"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679118519"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118519"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-1005"></span><span>  </span><span class="hs-comment">-- checking &quot;r &lt; 0&quot; here matches the condition in mallocPlainForeignPtrBytes,</span><span>
</span><span id="line-1006"></span><span>  </span><span class="hs-comment">-- helping the compiler see the latter is redundant in some places</span><span>
</span><span id="line-1007"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118520"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. String -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#overflowError"><span class="hs-identifier hs-var">overflowError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118517"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-1008"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118520"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1009"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679118520"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679118520"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Int
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118518"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118519"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118518"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118519"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1010"></span><span>
</span><span id="line-1011"></span><span class="hs-comment">-- | Multiplies two non-negative numbers.</span><span>
</span><span id="line-1012"></span><span class="hs-comment">-- Calls 'overflowError' on overflow.</span><span>
</span><span id="line-1013"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#checkedMultiply"><span class="hs-identifier hs-type">checkedMultiply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1014"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#checkedMultiply"><span class="hs-pragma hs-type">checkedMultiply</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1015"></span><span id="checkedMultiply"><span class="annot"><span class="annottext">checkedMultiply :: String -&gt; Int -&gt; Int -&gt; Int
</span><a href="Data.ByteString.Internal.Type.html#checkedMultiply"><span class="hs-identifier hs-var hs-var">checkedMultiply</span></a></span></span><span> </span><span id="local-6989586621679118521"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118521"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118522"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679118522"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679118523"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679118523"><span class="hs-identifier hs-var">x#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679118524"><span class="annot"><span class="annottext">y :: Int
</span><a href="#local-6989586621679118524"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679118525"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679118525"><span class="hs-identifier hs-var">y#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int -&gt; Int
forall a. (?callStack::CallStack) =&gt; Bool -&gt; a -&gt; a
</span><span class="hs-identifier hs-var hs-var">assert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#min"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118522"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118524"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="hs-cpp">
#if HS_timesInt2_PRIMOP_AVAILABLE
</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; (# Int#, Int#, Int# #)
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#timesInt2%23"><span class="hs-identifier hs-var">timesInt2#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679118523"><span class="hs-identifier hs-var">x#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679118525"><span class="hs-identifier hs-var">y#</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1018"></span><span>    </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679118526"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679118526"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679118526"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-1019"></span><span>    </span><span class="annot"><span class="annottext">(# Int#, Int#, Int# #)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. String -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#overflowError"><span class="hs-identifier hs-var">overflowError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679118521"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">timesWord2#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-identifier">x#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">int2Word#</span><span> </span><span class="hs-identifier">y#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1022"></span><span>    </span><span class="hs-special">(#</span><span> </span><span class="hs-identifier">hi</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lo</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">or#</span><span> </span><span class="hs-identifier">hi</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">uncheckedShiftRL#</span><span> </span><span class="hs-identifier">lo</span><span> </span><span class="hs-identifier">shiftAmt</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1023"></span><span>      </span><span class="hs-number">0##</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">I#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word2Int#</span><span> </span><span class="hs-identifier">lo</span><span class="hs-special">)</span><span>
</span><span id="line-1024"></span><span>      </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">overflowError</span><span> </span><span class="hs-identifier">fun</span><span>
</span><span id="line-1025"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">I#</span><span> </span><span class="hs-identifier">shiftAmt</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">finiteBitSize</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Word</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1028"></span><span>
</span><span id="line-1029"></span><span class="hs-comment">-- | Attempts to convert an 'Integer' value to an 'Int', returning</span><span>
</span><span id="line-1030"></span><span class="hs-comment">-- 'Nothing' if doing so would result in an overflow.</span><span>
</span><span id="line-1031"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#checkedIntegerToInt"><span class="hs-identifier hs-type">checkedIntegerToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1032"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#checkedIntegerToInt"><span class="hs-pragma hs-type">checkedIntegerToInt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1033"></span><span class="hs-comment">-- We could use Data.Bits.toIntegralSized, but this hand-rolled</span><span>
</span><span id="line-1034"></span><span class="hs-comment">-- version is currently a bit faster as of GHC 9.2.</span><span>
</span><span id="line-1035"></span><span class="hs-comment">-- It's even faster to just match on the Integer constructors, but</span><span>
</span><span id="line-1036"></span><span class="hs-comment">-- we'd still need a fallback implementation for integer-simple.</span><span>
</span><span id="line-1037"></span><span id="checkedIntegerToInt"><span class="annot"><span class="annottext">checkedIntegerToInt :: Integer -&gt; Maybe Int
</span><a href="Data.ByteString.Internal.Type.html#checkedIntegerToInt"><span class="hs-identifier hs-var hs-var">checkedIntegerToInt</span></a></span></span><span> </span><span id="local-6989586621679118527"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679118527"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-1038"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679118527"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118528"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118528"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-1039"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1040"></span><span>  </span><span class="hs-keyword">where</span><span>  </span><span id="local-6989586621679118528"><span class="annot"><span class="annottext">res :: Int
</span><a href="#local-6989586621679118528"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679118527"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1041"></span><span>
</span><span id="line-1042"></span><span>
</span><span id="line-1043"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1044"></span><span>
</span><span id="line-1045"></span><span class="hs-comment">-- | This \&quot;function\&quot; has a superficial similarity to 'System.IO.Unsafe.unsafePerformIO' but</span><span>
</span><span id="line-1046"></span><span class="hs-comment">-- it is in fact a malevolent agent of chaos. It unpicks the seams of reality</span><span>
</span><span id="line-1047"></span><span class="hs-comment">-- (and the 'IO' monad) so that the normal rules no longer apply. It lulls you</span><span>
</span><span id="line-1048"></span><span class="hs-comment">-- into thinking it is reasonable, but when you are not looking it stabs you</span><span>
</span><span id="line-1049"></span><span class="hs-comment">-- in the back and aliases all of your mutable buffers. The carcass of many a</span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- seasoned Haskell programmer lie strewn at its feet.</span><span>
</span><span id="line-1051"></span><span class="hs-comment">--</span><span>
</span><span id="line-1052"></span><span class="hs-comment">-- Witness the trail of destruction:</span><span>
</span><span id="line-1053"></span><span class="hs-comment">--</span><span>
</span><span id="line-1054"></span><span class="hs-comment">-- * &lt;https://github.com/haskell/bytestring/commit/71c4b438c675aa360c79d79acc9a491e7bbc26e7&gt;</span><span>
</span><span id="line-1055"></span><span class="hs-comment">--</span><span>
</span><span id="line-1056"></span><span class="hs-comment">-- * &lt;https://github.com/haskell/bytestring/commit/210c656390ae617d9ee3b8bcff5c88dd17cef8da&gt;</span><span>
</span><span id="line-1057"></span><span class="hs-comment">--</span><span>
</span><span id="line-1058"></span><span class="hs-comment">-- * &lt;https://github.com/haskell/aeson/commit/720b857e2e0acf2edc4f5512f2b217a89449a89d&gt;</span><span>
</span><span id="line-1059"></span><span class="hs-comment">--</span><span>
</span><span id="line-1060"></span><span class="hs-comment">-- * &lt;https://ghc.haskell.org/trac/ghc/ticket/3486&gt;</span><span>
</span><span id="line-1061"></span><span class="hs-comment">--</span><span>
</span><span id="line-1062"></span><span class="hs-comment">-- * &lt;https://ghc.haskell.org/trac/ghc/ticket/3487&gt;</span><span>
</span><span id="line-1063"></span><span class="hs-comment">--</span><span>
</span><span id="line-1064"></span><span class="hs-comment">-- * &lt;https://ghc.haskell.org/trac/ghc/ticket/7270&gt;</span><span>
</span><span id="line-1065"></span><span class="hs-comment">--</span><span>
</span><span id="line-1066"></span><span class="hs-comment">-- * &lt;https://gitlab.haskell.org/ghc/ghc/-/issues/22204&gt;</span><span>
</span><span id="line-1067"></span><span class="hs-comment">--</span><span>
</span><span id="line-1068"></span><span class="hs-comment">-- Do not talk about \&quot;safe\&quot;! You do not know what is safe!</span><span>
</span><span id="line-1069"></span><span class="hs-comment">--</span><span>
</span><span id="line-1070"></span><span class="hs-comment">-- Yield not to its blasphemous call! Flee traveller! Flee or you will be</span><span>
</span><span id="line-1071"></span><span class="hs-comment">-- corrupted and devoured!</span><span>
</span><span id="line-1072"></span><span class="hs-comment">--</span><span>
</span><span id="line-1073"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-pragma hs-type">accursedUnutterablePerformIO</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1074"></span><span id="local-6989586621679118529"><span class="annot"><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-type">accursedUnutterablePerformIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679118529"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679118529"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1075"></span><span id="accursedUnutterablePerformIO"><span class="annot"><span class="annottext">accursedUnutterablePerformIO :: forall a. IO a -&gt; a
</span><a href="Data.ByteString.Internal.Type.html#accursedUnutterablePerformIO"><span class="hs-identifier hs-var hs-var">accursedUnutterablePerformIO</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span id="local-6989586621679118530"><span class="annot"><span class="annottext">State# RealWorld -&gt; (# State# RealWorld, a #)
</span><a href="#local-6989586621679118530"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">State# RealWorld -&gt; (# State# RealWorld, a #)
</span><a href="#local-6989586621679118530"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#realWorld%23"><span class="hs-identifier hs-var">realWorld#</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679118531"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679118531"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679118531"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1076"></span><span>
</span><span id="line-1077"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1078"></span><span class="hs-comment">--</span><span>
</span><span id="line-1079"></span><span class="hs-comment">-- Standard C functions</span><span>
</span><span id="line-1080"></span><span class="hs-comment">--</span><span>
</span><span id="line-1081"></span><span>
</span><span id="line-1082"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier hs-type">memchr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1083"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memcmp"><span class="hs-identifier hs-type">memcmp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span>
</span><span id="line-1084"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">memset</span><span> </span><span class="hs-pragma">&quot;Use Foreign.Marshal.Utils.fillBytes instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1085"></span><span class="annot"><span class="hs-comment">-- | deprecated since @bytestring-0.11.5.0@</span></span><span>
</span><span id="line-1086"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memset"><span class="hs-identifier hs-type">memset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if !PURE_HASKELL
</span><span>
</span><span id="line-1090"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;string.h strlen&quot;</span></span><span> </span><span id="c_strlen"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_strlen"><span class="hs-identifier hs-var">c_strlen</span></a></span></span><span>
</span><span id="line-1091"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-1092"></span><span>
</span><span id="line-1093"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;string.h memchr&quot;</span></span><span> </span><span id="c_memchr"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_memchr"><span class="hs-identifier hs-var">c_memchr</span></a></span></span><span>
</span><span id="line-1094"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1095"></span><span id="memchr"><span class="annot"><span class="annottext">memchr :: Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Internal.Type.html#memchr"><span class="hs-identifier hs-var hs-var">memchr</span></a></span></span><span> </span><span id="local-6989586621679118533"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118533"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118534"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118534"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679118535"><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679118535"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CInt -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Internal.Type.html#c_memchr"><span class="hs-identifier hs-var">c_memchr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118533"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; CInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118534"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679118535"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-1096"></span><span>
</span><span id="line-1097"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;string.h memcmp&quot;</span></span><span> </span><span id="c_memcmp"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_memcmp"><span class="hs-identifier hs-var">c_memcmp</span></a></span></span><span>
</span><span id="line-1098"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span>
</span><span id="line-1099"></span><span id="memcmp"><span class="annot"><span class="annottext">memcmp :: Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO CInt
</span><a href="Data.ByteString.Internal.Type.html#memcmp"><span class="hs-identifier hs-var hs-var">memcmp</span></a></span></span><span> </span><span id="local-6989586621679118537"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118537"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118538"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118538"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679118539"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118539"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; CSize -&gt; IO CInt
</span><a href="Data.ByteString.Internal.Type.html#c_memcmp"><span class="hs-identifier hs-var">c_memcmp</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118537"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118538"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118539"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;string.h memset&quot;</span></span><span> </span><span id="c_memset"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_memset"><span class="hs-identifier hs-var">c_memset</span></a></span></span><span>
</span><span id="line-1102"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span id="memset"><span class="annot"><span class="annottext">memset :: Ptr Word8 -&gt; Word8 -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Internal.Type.html#memset"><span class="hs-identifier hs-var hs-var">memset</span></a></span></span><span> </span><span id="local-6989586621679118541"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118541"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679118542"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118542"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679118543"><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679118543"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; CInt -&gt; CSize -&gt; IO (Ptr Word8)
</span><a href="Data.ByteString.Internal.Type.html#c_memset"><span class="hs-identifier hs-var">c_memset</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118541"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; CInt
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621679118542"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679118543"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-cpp">

#else
</span><span>
</span><span id="line-1107"></span><span class="hs-identifier">c_strlen</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CSize</span><span>
</span><span id="line-1108"></span><span class="hs-identifier">c_strlen</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">Pure.strlen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">castPtr</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span class="hs-identifier">memchr</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.memchr</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span>
</span><span id="line-1111"></span><span>
</span><span id="line-1112"></span><span class="hs-identifier">memcmp</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">Pure.memcmp</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">s</span><span>
</span><span id="line-1113"></span><span>
</span><span id="line-1114"></span><span class="hs-identifier">memset</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&lt;$</span><span> </span><span class="hs-identifier">fillBytes</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">len</span><span class="hs-special">)</span><span class="hs-cpp">

#endif
</span><span>
</span><span id="line-1118"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">memcpy</span><span> </span><span class="hs-pragma">&quot;Use Foreign.Marshal.Utils.copyBytes instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1119"></span><span class="annot"><span class="hs-comment">-- | deprecated since @bytestring-0.11.5.0@</span></span><span>
</span><span id="line-1120"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memcpy"><span class="hs-identifier hs-type">memcpy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1121"></span><span id="memcpy"><span class="annot"><span class="annottext">memcpy :: Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpy"><span class="hs-identifier hs-var hs-var">memcpy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span>
</span><span id="line-1122"></span><span>
</span><span id="line-1123"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-type">memcpyFp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1124"></span><span id="memcpyFp"><span class="annot"><span class="annottext">memcpyFp :: ForeignPtr Word8 -&gt; ForeignPtr Word8 -&gt; Int -&gt; IO ()
</span><a href="Data.ByteString.Internal.Type.html#memcpyFp"><span class="hs-identifier hs-var hs-var">memcpyFp</span></a></span></span><span> </span><span id="local-6989586621679118545"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118545"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679118546"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118546"><span class="hs-identifier hs-var">fq</span></a></span></span><span> </span><span id="local-6989586621679118547"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118547"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118545"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118548"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118548"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1125"></span><span>                     </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">unsafeWithForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679118546"><span class="hs-identifier hs-var">fq</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ()) -&gt; IO ()) -&gt; (Ptr Word8 -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679118549"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118549"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr Word8 -&gt; Int -&gt; IO ()
forall a. Ptr a -&gt; Ptr a -&gt; Int -&gt; IO ()
</span><span class="hs-identifier hs-var">copyBytes</span></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118548"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679118549"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679118547"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1126"></span><span>
</span><span id="line-1127"></span><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_free_finalizer"><span class="hs-identifier hs-type">c_free_finalizer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FunPtr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span id="c_free_finalizer"><span class="annot"><span class="annottext">c_free_finalizer :: FunPtr (Ptr Word8 -&gt; IO ())
</span><a href="Data.ByteString.Internal.Type.html#c_free_finalizer"><span class="hs-identifier hs-var hs-var">c_free_finalizer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunPtr (Ptr Word8 -&gt; IO ())
forall a. FinalizerPtr a
</span><span class="hs-identifier hs-var">finalizerFree</span></span><span>
</span><span id="line-1129"></span><span>
</span><span id="line-1130"></span><span>
</span><span id="line-1131"></span><span>
</span><span id="line-1132"></span><span class="hs-comment">-- ---------------------------------------------------------------------</span><span>
</span><span id="line-1133"></span><span class="hs-comment">--</span><span>
</span><span id="line-1134"></span><span class="hs-comment">-- Uses our C code</span><span>
</span><span id="line-1135"></span><span class="hs-comment">--</span><span class="hs-cpp">

#if !PURE_HASKELL
</span><span>
</span><span id="line-1139"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static fpstring.h fps_reverse&quot;</span></span><span> </span><span id="c_reverse"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_reverse"><span class="hs-identifier hs-var">c_reverse</span></a></span></span><span>
</span><span id="line-1140"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span>
</span><span id="line-1142"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static fpstring.h fps_intersperse&quot;</span></span><span> </span><span id="c_intersperse"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_intersperse"><span class="hs-identifier hs-var">c_intersperse</span></a></span></span><span>
</span><span id="line-1143"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1144"></span><span>
</span><span id="line-1145"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static fpstring.h fps_maximum&quot;</span></span><span> </span><span id="c_maximum"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_maximum"><span class="hs-identifier hs-var">c_maximum</span></a></span></span><span>
</span><span id="line-1146"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1147"></span><span>
</span><span id="line-1148"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static fpstring.h fps_minimum&quot;</span></span><span> </span><span id="c_minimum"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_minimum"><span class="hs-identifier hs-var">c_minimum</span></a></span></span><span>
</span><span id="line-1149"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-1150"></span><span>
</span><span id="line-1151"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static fpstring.h fps_count&quot;</span></span><span> </span><span id="c_count"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_count"><span class="hs-identifier hs-var">c_count</span></a></span></span><span>
</span><span id="line-1152"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-1153"></span><span>
</span><span id="line-1154"></span><span class="hs-comment">-- fps_count works with both pointers and ByteArray#</span><span>
</span><span id="line-1155"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static fpstring.h fps_count&quot;</span></span><span> </span><span id="c_count_ba"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_count_ba"><span class="hs-identifier hs-var">c_count_ba</span></a></span></span><span>
</span><span id="line-1156"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-1157"></span><span>
</span><span id="line-1158"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static fpstring.h fps_sort&quot;</span></span><span> </span><span id="c_sort"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_sort"><span class="hs-identifier hs-var">c_sort</span></a></span></span><span>
</span><span id="line-1159"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1160"></span><span>
</span><span id="line-1161"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static sbs_elem_index&quot;</span></span><span>
</span><span id="line-1162"></span><span>    </span><span id="c_elem_index"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_elem_index"><span class="hs-identifier hs-var">c_elem_index</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CPtrdiff</span></span><span>
</span><span id="line-1163"></span><span>
</span><span id="line-1164"></span><span>
</span><span id="line-1165"></span><span>
</span><span id="line-1166"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static _hs_bytestring_uint_dec&quot;</span></span><span> </span><span id="c_uint_dec"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_uint_dec"><span class="hs-identifier hs-var">c_uint_dec</span></a></span></span><span>
</span><span id="line-1167"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CUInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>
</span><span id="line-1169"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static _hs_bytestring_long_long_uint_dec&quot;</span></span><span> </span><span id="c_long_long_uint_dec"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_long_long_uint_dec"><span class="hs-identifier hs-var">c_long_long_uint_dec</span></a></span></span><span>
</span><span id="line-1170"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CULLong</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static _hs_bytestring_int_dec&quot;</span></span><span> </span><span id="c_int_dec"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_int_dec"><span class="hs-identifier hs-var">c_int_dec</span></a></span></span><span>
</span><span id="line-1173"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1174"></span><span>
</span><span id="line-1175"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static _hs_bytestring_long_long_int_dec&quot;</span></span><span> </span><span id="c_long_long_int_dec"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_long_long_int_dec"><span class="hs-identifier hs-var">c_long_long_int_dec</span></a></span></span><span>
</span><span id="line-1176"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CLLong</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>
</span><span id="line-1178"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static _hs_bytestring_uint_hex&quot;</span></span><span> </span><span id="c_uint_hex"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_uint_hex"><span class="hs-identifier hs-var">c_uint_hex</span></a></span></span><span>
</span><span id="line-1179"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CUInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1180"></span><span>
</span><span id="line-1181"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static _hs_bytestring_long_long_uint_hex&quot;</span></span><span> </span><span id="c_long_long_uint_hex"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_long_long_uint_hex"><span class="hs-identifier hs-var">c_long_long_uint_hex</span></a></span></span><span>
</span><span id="line-1182"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CULLong</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-1183"></span><span>
</span><span id="line-1184"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static _hs_bytestring_int_dec_padded9&quot;</span></span><span>
</span><span id="line-1185"></span><span>    </span><span id="c_int_dec_padded9"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_int_dec_padded9"><span class="hs-identifier hs-var">c_int_dec_padded9</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span>
</span><span id="line-1187"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;static _hs_bytestring_long_long_int_dec_padded18&quot;</span></span><span>
</span><span id="line-1188"></span><span>    </span><span id="c_long_long_int_dec_padded18"><span class="annot"><a href="Data.ByteString.Internal.Type.html#c_long_long_int_dec_padded18"><span class="hs-identifier hs-var">c_long_long_int_dec_padded18</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CLLong</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span class="hs-comment">-- We import bytestring_is_valid_utf8 both unsafe and safe. For small inputs</span><span>
</span><span id="line-1191"></span><span class="hs-comment">-- we can use the unsafe version to get a bit more performance, but for large</span><span>
</span><span id="line-1192"></span><span class="hs-comment">-- inputs the safe version should be used to avoid GC synchronization pauses</span><span>
</span><span id="line-1193"></span><span class="hs-comment">-- in multithreaded contexts.</span><span>
</span><span id="line-1194"></span><span>
</span><span id="line-1195"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;bytestring_is_valid_utf8&quot;</span></span><span> </span><span id="cIsValidUtf8BA"><span class="annot"><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8BA"><span class="hs-identifier hs-var">cIsValidUtf8BA</span></a></span></span><span>
</span><span id="line-1196"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span>
</span><span id="line-1197"></span><span>
</span><span id="line-1198"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">safe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;bytestring_is_valid_utf8&quot;</span></span><span> </span><span id="cIsValidUtf8BASafe"><span class="annot"><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8BASafe"><span class="hs-identifier hs-var">cIsValidUtf8BASafe</span></a></span></span><span>
</span><span id="line-1199"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span>
</span><span id="line-1200"></span><span>
</span><span id="line-1201"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;bytestring_is_valid_utf8&quot;</span></span><span> </span><span id="cIsValidUtf8"><span class="annot"><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8"><span class="hs-identifier hs-var">cIsValidUtf8</span></a></span></span><span>
</span><span id="line-1202"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span>
</span><span id="line-1203"></span><span>
</span><span id="line-1204"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">safe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;bytestring_is_valid_utf8&quot;</span></span><span> </span><span id="cIsValidUtf8Safe"><span class="annot"><a href="Data.ByteString.Internal.Type.html#cIsValidUtf8Safe"><span class="hs-identifier hs-var">cIsValidUtf8Safe</span></a></span></span><span>
</span><span id="line-1205"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span class="hs-cpp">


#else
</span><span>
</span><span id="line-1210"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-1211"></span><span class="hs-comment">-- Haskell version of functions in fpstring.c</span><span>
</span><span id="line-1212"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-1213"></span><span>
</span><span id="line-1214"></span><span class="hs-comment">-- | Reverse n-bytes from the second pointer into the first</span><span>
</span><span id="line-1215"></span><span class="hs-identifier">c_reverse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1216"></span><span class="hs-identifier">c_reverse</span><span> </span><span class="hs-identifier">p1</span><span> </span><span class="hs-identifier">p2</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.reverseBytes</span><span> </span><span class="hs-identifier">p1</span><span> </span><span class="hs-identifier">p2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span>
</span><span id="line-1217"></span><span>
</span><span id="line-1218"></span><span class="hs-comment">-- | find maximum char in a packed string</span><span>
</span><span id="line-1219"></span><span class="hs-identifier">c_maximum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">Word8</span><span>
</span><span id="line-1220"></span><span class="hs-identifier">c_maximum</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.findMaximum</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>
</span><span id="line-1222"></span><span class="hs-comment">-- | find minimum char in a packed string</span><span>
</span><span id="line-1223"></span><span class="hs-identifier">c_minimum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">Word8</span><span>
</span><span id="line-1224"></span><span class="hs-identifier">c_minimum</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.findMinimum</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span>
</span><span id="line-1225"></span><span>
</span><span id="line-1226"></span><span class="hs-comment">-- | count the number of occurrences of a char in a string</span><span>
</span><span id="line-1227"></span><span class="hs-identifier">c_count</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CSize</span><span>
</span><span id="line-1228"></span><span class="hs-identifier">c_count</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">Pure.countOcc</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-1229"></span><span>
</span><span id="line-1230"></span><span class="hs-comment">-- | count the number of occurrences of a char in a string</span><span>
</span><span id="line-1231"></span><span class="hs-identifier">c_count_ba</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ByteArray#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CSize</span><span>
</span><span id="line-1232"></span><span class="hs-identifier">c_count_ba</span><span> </span><span class="hs-identifier">ba</span><span> </span><span class="hs-identifier">o</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">Pure.countOccBA</span><span> </span><span class="hs-identifier">ba</span><span> </span><span class="hs-identifier">o</span><span> </span><span class="hs-identifier">c</span><span>
</span><span id="line-1233"></span><span>
</span><span id="line-1234"></span><span class="hs-comment">-- | duplicate a string, interspersing the character through the elements of the</span><span>
</span><span id="line-1235"></span><span class="hs-comment">-- duplicated string</span><span>
</span><span id="line-1236"></span><span class="hs-identifier">c_intersperse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span class="hs-identifier">c_intersperse</span><span> </span><span class="hs-identifier">p1</span><span> </span><span class="hs-identifier">p2</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.intersperse</span><span> </span><span class="hs-identifier">p1</span><span> </span><span class="hs-identifier">p2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">e</span><span>
</span><span id="line-1238"></span><span>
</span><span id="line-1239"></span><span class="hs-comment">-- | Quick sort bytes</span><span>
</span><span id="line-1240"></span><span class="hs-identifier">c_sort</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span class="hs-identifier">c_sort</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.quickSort</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span>
</span><span id="line-1243"></span><span class="hs-identifier">c_elem_index</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ByteArray#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CPtrdiff</span><span>
</span><span id="line-1244"></span><span class="hs-identifier">c_elem_index</span><span> </span><span class="hs-identifier">ba</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-operator">&lt;$!&gt;</span><span> </span><span class="hs-identifier">Pure.elemIndex</span><span> </span><span class="hs-identifier">ba</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span>
</span><span id="line-1245"></span><span>
</span><span id="line-1246"></span><span class="hs-identifier">cIsValidUtf8BA</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ByteArray#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CInt</span><span>
</span><span id="line-1247"></span><span class="hs-identifier">cIsValidUtf8BA</span><span> </span><span class="hs-identifier">ba</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bool_to_cint</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">Pure.isValidUtf8BA</span><span> </span><span class="hs-identifier">ba</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span>
</span><span id="line-1248"></span><span>
</span><span id="line-1249"></span><span class="hs-identifier">cIsValidUtf8</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CInt</span><span>
</span><span id="line-1250"></span><span class="hs-identifier">cIsValidUtf8</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-identifier">sz</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bool_to_cint</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">Pure.isValidUtf8</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">sz</span><span class="hs-special">)</span><span>
</span><span id="line-1251"></span><span>
</span><span id="line-1252"></span><span class="hs-comment">-- Pure module is compiled with `-fno-omit-yields` so it's always safe (it won't</span><span>
</span><span id="line-1253"></span><span class="hs-comment">-- block on large inputs)</span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span class="hs-identifier">cIsValidUtf8BASafe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ByteArray#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CInt</span><span>
</span><span id="line-1256"></span><span class="hs-identifier">cIsValidUtf8BASafe</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cIsValidUtf8BA</span><span>
</span><span id="line-1257"></span><span>
</span><span id="line-1258"></span><span class="hs-identifier">cIsValidUtf8Safe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CSize</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">CInt</span><span>
</span><span id="line-1259"></span><span class="hs-identifier">cIsValidUtf8Safe</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cIsValidUtf8</span><span>
</span><span id="line-1260"></span><span>
</span><span id="line-1261"></span><span class="hs-identifier">bool_to_cint</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">CInt</span><span>
</span><span id="line-1262"></span><span class="hs-identifier">bool_to_cint</span><span> </span><span class="hs-identifier">True</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-1263"></span><span class="hs-identifier">bool_to_cint</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-1264"></span><span>
</span><span id="line-1265"></span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Bits</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Integral</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-1266"></span><span class="hs-identifier">checkedCast</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1267"></span><span>  </span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">errorWithoutStackTrace</span><span> </span><span class="hs-string">&quot;checkedCast: overflow&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-1268"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">toIntegralSized</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span>
</span><span id="line-1269"></span><span>
</span><span id="line-1270"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-1271"></span><span class="hs-comment">-- Haskell version of functions in itoa.c</span><span>
</span><span id="line-1272"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-1273"></span><span>
</span><span id="line-1274"></span><span class="hs-identifier">c_int_dec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span class="hs-identifier">c_int_dec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.encodeSignedDec</span><span>
</span><span id="line-1276"></span><span>
</span><span id="line-1277"></span><span class="hs-identifier">c_long_long_int_dec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CLLong</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span class="hs-special">)</span><span>
</span><span id="line-1278"></span><span class="hs-identifier">c_long_long_int_dec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.encodeSignedDec</span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span class="hs-identifier">c_uint_dec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CUInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span class="hs-special">)</span><span>
</span><span id="line-1281"></span><span class="hs-identifier">c_uint_dec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.encodeUnsignedDec</span><span>
</span><span id="line-1282"></span><span>
</span><span id="line-1283"></span><span class="hs-identifier">c_long_long_uint_dec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CULLong</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span class="hs-special">)</span><span>
</span><span id="line-1284"></span><span class="hs-identifier">c_long_long_uint_dec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.encodeUnsignedDec</span><span>
</span><span id="line-1285"></span><span>
</span><span id="line-1286"></span><span class="hs-identifier">c_uint_hex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CUInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span class="hs-special">)</span><span>
</span><span id="line-1287"></span><span class="hs-identifier">c_uint_hex</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.encodeUnsignedHex</span><span>
</span><span id="line-1288"></span><span>
</span><span id="line-1289"></span><span class="hs-identifier">c_long_long_uint_hex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CULLong</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span class="hs-special">)</span><span>
</span><span id="line-1290"></span><span class="hs-identifier">c_long_long_uint_hex</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.encodeUnsignedHex</span><span>
</span><span id="line-1291"></span><span>
</span><span id="line-1292"></span><span class="hs-identifier">c_int_dec_padded9</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CInt</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1293"></span><span class="hs-identifier">c_int_dec_padded9</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.encodeUnsignedDecPadded</span><span> </span><span class="hs-number">9</span><span>
</span><span id="line-1294"></span><span>
</span><span id="line-1295"></span><span class="hs-identifier">c_long_long_int_dec_padded18</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CLLong</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">Word8</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1296"></span><span class="hs-identifier">c_long_long_int_dec_padded18</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pure.encodeUnsignedDecPadded</span><span> </span><span class="hs-number">18</span><span class="hs-cpp">

#endif
</span></pre></body></html>