<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      : Data.ByteString.Builder.RealFloat.F2S</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   : (c) Lawrence Wu 2021</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     : BSD-style</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  : lawrencejwu@gmail.com</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Implementation of float-to-string conversion</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html"><span class="hs-identifier">Data.ByteString.Builder.RealFloat.F2S</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier">FloatingDecimal</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2s"><span class="hs-identifier">f2s</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2Intermediate"><span class="hs-identifier">f2Intermediate</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Arrow.html"><span class="hs-identifier">Control.Arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Bits.html"><span class="hs-identifier">Data.Bits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.|.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeShiftL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsafeShiftR</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Internal.html"><span class="hs-identifier">Data.ByteString.Builder.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier">Builder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Prim.html"><span class="hs-identifier">Data.ByteString.Builder.Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.Prim.html#primBounded"><span class="hs-identifier">primBounded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html"><span class="hs-identifier">Data.ByteString.Builder.RealFloat.Internal</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Int.html"><span class="hs-identifier">GHC.Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int32</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Word.html"><span class="hs-identifier">GHC.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word32</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">

#if !PURE_HASKELL
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Ptr.html"><span class="hs-identifier">GHC.Ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ptr</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- See Data.ByteString.Builder.RealFloat.TableGenerator for a high-level</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- explanation of the ryu algorithm</span><span class="hs-cpp">

#if !PURE_HASKELL
</span><span class="hs-comment">-- | Table of 2^k / 5^q + 1</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- &gt; fmap (finv float_pow5_inv_bitcount) [0..float_max_inv_split]</span><span>
</span><span id="line-36"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;hs_bytestring_float_pow5_inv_split&quot;</span></span><span>
</span><span id="line-37"></span><span>  </span><span id="float_pow5_inv_split"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_pow5_inv_split"><span class="hs-identifier hs-var">float_pow5_inv_split</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | Table of 5^(-e2-q) / 2^k + 1</span><span>
</span><span id="line-40"></span><span class="hs-comment">--</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- &gt; fmap (fnorm float_pow5_bitcount) [0..float_max_split]</span><span>
</span><span id="line-42"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;hs_bytestring_float_pow5_split&quot;</span></span><span>
</span><span id="line-43"></span><span>  </span><span id="float_pow5_split"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_pow5_split"><span class="hs-identifier hs-var">float_pow5_split</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Number of mantissa bits of a 32-bit float. The number of significant bits</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- (floatDigits (undefined :: Float)) is 24 since we have a leading 1 for</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- normal floats and 0 for subnormal floats</span><span>
</span><span id="line-49"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_mantissa_bits"><span class="hs-identifier hs-type">float_mantissa_bits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-50"></span><span id="float_mantissa_bits"><span class="annot"><span class="annottext">float_mantissa_bits :: Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_mantissa_bits"><span class="hs-identifier hs-var hs-var">float_mantissa_bits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">23</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><span class="hs-comment">-- | Number of exponent bits of a 32-bit float</span></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_exponent_bits"><span class="hs-identifier hs-type">float_exponent_bits</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-54"></span><span id="float_exponent_bits"><span class="annot"><span class="annottext">float_exponent_bits :: Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_exponent_bits"><span class="hs-identifier hs-var hs-var">float_exponent_bits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><span class="hs-comment">-- | Bias in encoded 32-bit float representation (2^7 - 1)</span></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_bias"><span class="hs-identifier hs-type">float_bias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-58"></span><span id="float_bias"><span class="annot"><span class="annottext">float_bias :: Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_bias"><span class="hs-identifier hs-var hs-var">float_bias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">127</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">data</span><span> </span><span id="FloatingDecimal"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier hs-var">FloatingDecimal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FloatingDecimal"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier hs-var">FloatingDecimal</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="fmantissa"><span class="annot"><span class="annottext">FloatingDecimal -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#fmantissa"><span class="hs-identifier hs-var hs-var">fmantissa</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fexponent"><span class="annot"><span class="annottext">FloatingDecimal -&gt; Int32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#fexponent"><span class="hs-identifier hs-var hs-var">fexponent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679130953"><span id="local-6989586621679130961"><span id="local-6989586621679130965"><span class="annot"><span class="annottext">Int -&gt; FloatingDecimal -&gt; ShowS
[FloatingDecimal] -&gt; ShowS
FloatingDecimal -&gt; String
(Int -&gt; FloatingDecimal -&gt; ShowS)
-&gt; (FloatingDecimal -&gt; String)
-&gt; ([FloatingDecimal] -&gt; ShowS)
-&gt; Show FloatingDecimal
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; FloatingDecimal -&gt; ShowS
showsPrec :: Int -&gt; FloatingDecimal -&gt; ShowS
$cshow :: FloatingDecimal -&gt; String
show :: FloatingDecimal -&gt; String
$cshowList :: [FloatingDecimal] -&gt; ShowS
showList :: [FloatingDecimal] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679130970"><span id="local-6989586621679130976"><span class="annot"><span class="annottext">FloatingDecimal -&gt; FloatingDecimal -&gt; Bool
(FloatingDecimal -&gt; FloatingDecimal -&gt; Bool)
-&gt; (FloatingDecimal -&gt; FloatingDecimal -&gt; Bool)
-&gt; Eq FloatingDecimal
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: FloatingDecimal -&gt; FloatingDecimal -&gt; Bool
== :: FloatingDecimal -&gt; FloatingDecimal -&gt; Bool
$c/= :: FloatingDecimal -&gt; FloatingDecimal -&gt; Bool
/= :: FloatingDecimal -&gt; FloatingDecimal -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | Multiply a 32-bit number with a 64-bit number while keeping the upper 64</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- bits. Then shift by specified amount minus 32</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulShift32"><span class="hs-identifier hs-type">mulShift32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-68"></span><span id="mulShift32"><span class="annot"><span class="annottext">mulShift32 :: Word32 -&gt; Word64 -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulShift32"><span class="hs-identifier hs-var hs-var">mulShift32</span></a></span></span><span> </span><span id="local-6989586621679130981"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679130981"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679130982"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679130982"><span class="hs-identifier hs-var">factor</span></a></span></span><span> </span><span id="local-6989586621679130983"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679130983"><span class="hs-identifier hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679130988"><span class="annot"><span class="annottext">factorLo :: Word64
</span><a href="#local-6989586621679130988"><span class="hs-identifier hs-var hs-var">factorLo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679130982"><span class="hs-identifier hs-var">factor</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word64
forall a. (Bits a, Integral a) =&gt; Int -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-70"></span><span>      </span><span id="local-6989586621679130991"><span class="annot"><span class="annottext">factorHi :: Word64
</span><a href="#local-6989586621679130991"><span class="hs-identifier hs-var hs-var">factorHi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679130982"><span class="hs-identifier hs-var">factor</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-71"></span><span>      </span><span id="local-6989586621679130994"><span class="annot"><span class="annottext">bits0 :: Word64
</span><a href="#local-6989586621679130994"><span class="hs-identifier hs-var hs-var">bits0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier hs-var">word32ToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679130981"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679130988"><span class="hs-identifier hs-var">factorLo</span></a></span><span>
</span><span id="line-72"></span><span>      </span><span id="local-6989586621679130998"><span class="annot"><span class="annottext">bits1 :: Word64
</span><a href="#local-6989586621679130998"><span class="hs-identifier hs-var hs-var">bits1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToWord64"><span class="hs-identifier hs-var">word32ToWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679130981"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679130991"><span class="hs-identifier hs-var">factorHi</span></a></span><span>
</span><span id="line-73"></span><span>      </span><span id="local-6989586621679131001"><span class="annot"><span class="annottext">total :: Word64
</span><a href="#local-6989586621679131001"><span class="hs-identifier hs-var hs-var">total</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679130994"><span class="hs-identifier hs-var">bits0</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Word64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679130998"><span class="hs-identifier hs-var">bits1</span></a></span><span>
</span><span id="line-74"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word64ToWord32"><span class="hs-identifier hs-var">word64ToWord32</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; Word32) -&gt; Word64 -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679131001"><span class="hs-identifier hs-var">total</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int -&gt; Word64
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679130983"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="annot"><span class="hs-comment">-- | Index into the 64-bit word lookup table float_pow5_inv_split</span></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#get_float_pow5_inv_split"><span class="hs-identifier hs-type">get_float_pow5_inv_split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-cpp">
#if !PURE_HASKELL
</span><span id="get_float_pow5_inv_split"><span class="annot"><span class="annottext">get_float_pow5_inv_split :: Int -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#get_float_pow5_inv_split"><span class="hs-identifier hs-var hs-var">get_float_pow5_inv_split</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word64 -&gt; Int -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord64At"><span class="hs-identifier hs-var">getWord64At</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word64
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_pow5_inv_split"><span class="hs-identifier hs-var">float_pow5_inv_split</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- &gt; putStr $ case64 (finv float_pow5_inv_bitcount) [0..float_max_inv_split]</span><span>
</span><span id="line-82"></span><span class="hs-identifier">get_float_pow5_inv_split</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x800000000000001</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-number">1</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x666666666666667</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-number">2</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x51eb851eb851eb9</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-number">3</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x4189374bc6a7efa</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-number">4</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x68db8bac710cb2a</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-number">5</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x53e2d6238da3c22</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-number">6</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x431bde82d7b634e</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-number">7</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x6b5fca6af2bd216</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-number">8</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x55e63b88c230e78</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-number">9</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x44b82fa09b5a52d</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-number">10</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x6df37f675ef6eae</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-number">11</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x57f5ff85e592558</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-number">12</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x465e6604b7a8447</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-number">13</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x709709a125da071</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-number">14</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x5a126e1a84ae6c1</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-number">15</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x480ebe7b9d58567</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x734aca5f6226f0b</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-number">17</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x5c3bd5191b525a3</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-number">18</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x49c97747490eae9</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-number">19</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x760f253edb4ab0e</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-number">20</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x5e72843249088d8</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-number">21</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x4b8ed0283a6d3e0</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-number">22</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x78e480405d7b966</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-number">23</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x60b6cd004ac9452</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-number">24</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x4d5f0a66a23a9db</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-number">25</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x7bcb43d769f762b</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-number">26</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x63090312bb2c4ef</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-number">27</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x4f3a68dbc8f03f3</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-number">28</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x7ec3daf94180651</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-number">29</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x65697bfa9acd1da</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x51212ffbaf0a7e2</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-116"></span><span class="annot"><span class="hs-comment">-- | Index into the 64-bit word lookup table float_pow5_split</span></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#get_float_pow5_split"><span class="hs-identifier hs-type">get_float_pow5_split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-cpp">
#if !PURE_HASKELL
</span><span id="get_float_pow5_split"><span class="annot"><span class="annottext">get_float_pow5_split :: Int -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#get_float_pow5_split"><span class="hs-identifier hs-var hs-var">get_float_pow5_split</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr Word64 -&gt; Int -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#getWord64At"><span class="hs-identifier hs-var">getWord64At</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word64
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_pow5_split"><span class="hs-identifier hs-var">float_pow5_split</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- &gt; putStr $ case64 (fnorm float_pow5_bitcount) [0..float_max_split]</span><span>
</span><span id="line-122"></span><span class="hs-identifier">get_float_pow5_split</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1000000000000000</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-number">1</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1400000000000000</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-number">2</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1900000000000000</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-number">3</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1f40000000000000</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-number">4</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1388000000000000</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-number">5</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x186a000000000000</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-number">6</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1e84800000000000</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-number">7</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1312d00000000000</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-number">8</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x17d7840000000000</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-number">9</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1dcd650000000000</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-number">10</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x12a05f2000000000</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-number">11</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x174876e800000000</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-number">12</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1d1a94a200000000</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-number">13</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x12309ce540000000</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-number">14</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x16bcc41e90000000</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-number">15</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1c6bf52634000000</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-number">16</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x11c37937e0800000</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-number">17</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x16345785d8a00000</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-number">18</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1bc16d674ec80000</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-number">19</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1158e460913d0000</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-number">20</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x15af1d78b58c4000</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-number">21</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1b1ae4d6e2ef5000</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-number">22</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x10f0cf064dd59200</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-number">23</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x152d02c7e14af680</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-number">24</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1a784379d99db420</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-number">25</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x108b2a2c28029094</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-number">26</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x14adf4b7320334b9</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-number">27</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x19d971e4fe8401e7</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-number">28</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1027e72f1f128130</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-number">29</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1431e0fae6d7217c</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-number">30</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x193e5939a08ce9db</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-number">31</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1f8def8808b02452</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-number">32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x13b8b5b5056e16b3</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-number">33</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x18a6e32246c99c60</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-number">34</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1ed09bead87c0378</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-number">35</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x13426172c74d822b</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-number">36</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1812f9cf7920e2b6</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-number">37</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1e17b84357691b64</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-number">38</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x12ced32a16a1b11e</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-number">39</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x178287f49c4a1d66</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-number">40</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1d6329f1c35ca4bf</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-number">41</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x125dfa371a19e6f7</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-number">42</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x16f578c4e0a060b5</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-number">43</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1cb2d6f618c878e3</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-number">44</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x11efc659cf7d4b8d</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-number">45</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x166bb7f0435c9e71</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">0x1c06a5ec5433c60d</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">-- | Take the high bits of m * 2^k / 5^q / 2^-e2+q+k</span></span><span>
</span><span id="line-173"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5InvDivPow2"><span class="hs-identifier hs-type">mulPow5InvDivPow2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-174"></span><span id="mulPow5InvDivPow2"><span class="annot"><span class="annottext">mulPow5InvDivPow2 :: Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5InvDivPow2"><span class="hs-identifier hs-var hs-var">mulPow5InvDivPow2</span></a></span></span><span> </span><span id="local-6989586621679131008"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131008"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679131009"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131009"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679131010"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131010"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64 -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulShift32"><span class="hs-identifier hs-var">mulShift32</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131008"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#get_float_pow5_inv_split"><span class="hs-identifier hs-var">get_float_pow5_inv_split</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131009"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131010"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><span class="hs-comment">-- | Take the high bits of m * 5^-e2-q / 2^k / 2^q-k</span></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5DivPow2"><span class="hs-identifier hs-type">mulPow5DivPow2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-178"></span><span id="mulPow5DivPow2"><span class="annot"><span class="annottext">mulPow5DivPow2 :: Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5DivPow2"><span class="hs-identifier hs-var hs-var">mulPow5DivPow2</span></a></span></span><span> </span><span id="local-6989586621679131012"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131012"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679131013"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131013"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679131014"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131014"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word64 -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulShift32"><span class="hs-identifier hs-var">mulShift32</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131012"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word64
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#get_float_pow5_split"><span class="hs-identifier hs-var">get_float_pow5_split</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131013"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131014"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><span class="hs-comment">-- | Handle case e2 &gt;= 0</span></span><span>
</span><span id="line-181"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2dGT"><span class="hs-identifier hs-type">f2dGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-type">BoundsState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span id="f2dGT"><span class="annot"><span class="annottext">f2dGT :: Int32 -&gt; Word32 -&gt; Word32 -&gt; Word32 -&gt; (BoundsState Word32, Int32)
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2dGT"><span class="hs-identifier hs-var hs-var">f2dGT</span></a></span></span><span> </span><span id="local-6989586621679131016"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131016"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span id="local-6989586621679131017"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131017"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679131018"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131018"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679131019"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131019"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679131020"><span class="annot"><span class="annottext">e2 :: Int
</span><a href="#local-6989586621679131020"><span class="hs-identifier hs-var hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#int32ToInt"><span class="hs-identifier hs-var">int32ToInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131016"><span class="hs-identifier hs-var">e2'</span></a></span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-comment">-- q = e10 = log_10(2^e2)</span><span>
</span><span id="line-185"></span><span>      </span><span id="local-6989586621679131022"><span class="annot"><span class="annottext">q :: Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow2"><span class="hs-identifier hs-var">log10pow2</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131020"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-comment">-- k = B0 + log_2(5^q)</span><span>
</span><span id="line-187"></span><span>      </span><span id="local-6989586621679131027"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679131027"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.TableGenerator.html#float_pow5_inv_bitcount"><span class="hs-identifier hs-var">float_pow5_inv_bitcount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bits"><span class="hs-identifier hs-var">pow5bits</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-188"></span><span>      </span><span id="local-6989586621679131033"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679131033"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131020"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131027"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-comment">-- (u, v, w) * 2^k / 5^q / 2^-e2+q+k</span><span>
</span><span id="line-190"></span><span>      </span><span id="local-6989586621679131034"><span class="annot"><span class="annottext">u' :: Word32
</span><a href="#local-6989586621679131034"><span class="hs-identifier hs-var hs-var">u'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5InvDivPow2"><span class="hs-identifier hs-var">mulPow5InvDivPow2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131017"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131033"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span id="local-6989586621679131035"><span class="annot"><span class="annottext">v' :: Word32
</span><a href="#local-6989586621679131035"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5InvDivPow2"><span class="hs-identifier hs-var">mulPow5InvDivPow2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131018"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131033"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-192"></span><span>      </span><span id="local-6989586621679131036"><span class="annot"><span class="annottext">w' :: Word32
</span><a href="#local-6989586621679131036"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5InvDivPow2"><span class="hs-identifier hs-var">mulPow5InvDivPow2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131019"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131033"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679131052"><span class="annot"><span class="annottext">lastRemoved :: Word32
</span><a href="#local-6989586621679131052"><span class="hs-identifier hs-var hs-var">lastRemoved</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var">fquot10</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131036"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var">fquot10</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131034"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-195"></span><span>          </span><span class="hs-comment">-- We need to know one removed digit even if we are not going to loop</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-comment">-- below. We could use q = X - 1 above, except that would require 33</span><span>
</span><span id="line-197"></span><span>          </span><span class="hs-comment">-- bits for the result, and we've found that 32-bit arithmetic is</span><span>
</span><span id="line-198"></span><span>          </span><span class="hs-comment">-- faster even on 64-bit machines.</span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679131062"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679131062"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.TableGenerator.html#float_pow5_inv_bitcount"><span class="hs-identifier hs-var">float_pow5_inv_bitcount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bits"><span class="hs-identifier hs-var">pow5bits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-200"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem10"><span class="hs-identifier hs-var">frem10</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5InvDivPow2"><span class="hs-identifier hs-var">mulPow5InvDivPow2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131018"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131020"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131062"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679131077"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131077"><span class="hs-identifier hs-var">vvTrailing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679131078"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131078"><span class="hs-identifier hs-var">vuTrailing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679131079"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131079"><span class="hs-identifier hs-var">vw'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-204"></span><span>          </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem5"><span class="hs-identifier hs-var">frem5</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131018"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-205"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Bool
forall a. Mantissa a =&gt; a -&gt; Int -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf5"><span class="hs-identifier hs-var">multipleOfPowerOf5</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131018"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131036"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Bool
forall a. Mantissa a =&gt; a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#acceptBounds"><span class="hs-identifier hs-var">acceptBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131018"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-207"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Bool
forall a. Mantissa a =&gt; a -&gt; Int -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf5"><span class="hs-identifier hs-var">multipleOfPowerOf5</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131017"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131036"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-209"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131036"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord32"><span class="hs-identifier hs-var">boolToWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Bool
forall a. Mantissa a =&gt; a -&gt; Int -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf5"><span class="hs-identifier hs-var">multipleOfPowerOf5</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131019"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-211"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131036"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
-&gt; Word32 -&gt; Word32 -&gt; Word32 -&gt; Bool -&gt; Bool -&gt; BoundsState Word32
forall a. a -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; Bool -&gt; BoundsState a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-var">BoundsState</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131034"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131035"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131079"><span class="hs-identifier hs-var">vw'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131052"><span class="hs-identifier hs-var">lastRemoved</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131078"><span class="hs-identifier hs-var">vuTrailing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131077"><span class="hs-identifier hs-var">vvTrailing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#intToInt32"><span class="hs-identifier hs-var">intToInt32</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131022"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><span class="hs-comment">-- | Handle case e2 &lt; 0</span></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2dLT"><span class="hs-identifier hs-type">f2dLT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-type">BoundsState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span id="f2dLT"><span class="annot"><span class="annottext">f2dLT :: Int32 -&gt; Word32 -&gt; Word32 -&gt; Word32 -&gt; (BoundsState Word32, Int32)
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2dLT"><span class="hs-identifier hs-var hs-var">f2dLT</span></a></span></span><span> </span><span id="local-6989586621679131088"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131088"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span id="local-6989586621679131089"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131089"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679131090"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131090"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679131091"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131091"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679131092"><span class="annot"><span class="annottext">e2 :: Int
</span><a href="#local-6989586621679131092"><span class="hs-identifier hs-var hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#int32ToInt"><span class="hs-identifier hs-var">int32ToInt</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131088"><span class="hs-identifier hs-var">e2'</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span id="local-6989586621679131094"><span class="annot"><span class="annottext">q :: Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#log10pow5"><span class="hs-identifier hs-var">log10pow5</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131092"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>      </span><span id="local-6989586621679131097"><span class="annot"><span class="annottext">e10 :: Int
</span><a href="#local-6989586621679131097"><span class="hs-identifier hs-var hs-var">e10</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131092"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-220"></span><span>      </span><span id="local-6989586621679131100"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131092"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-comment">-- k = log_2(5^-e2-q) - B1</span><span>
</span><span id="line-222"></span><span>      </span><span id="local-6989586621679131102"><span class="annot"><span class="annottext">k :: Int
</span><a href="#local-6989586621679131102"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bits"><span class="hs-identifier hs-var">pow5bits</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.TableGenerator.html#float_pow5_bitcount"><span class="hs-identifier hs-var">float_pow5_bitcount</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span id="local-6989586621679131105"><span class="annot"><span class="annottext">j :: Int
</span><a href="#local-6989586621679131105"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131102"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-comment">-- (u, v, w) * 5^-e2-q / 2^k / 2^q-k</span><span>
</span><span id="line-225"></span><span>      </span><span id="local-6989586621679131106"><span class="annot"><span class="annottext">u' :: Word32
</span><a href="#local-6989586621679131106"><span class="hs-identifier hs-var hs-var">u'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5DivPow2"><span class="hs-identifier hs-var">mulPow5DivPow2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131089"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131105"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span id="local-6989586621679131107"><span class="annot"><span class="annottext">v' :: Word32
</span><a href="#local-6989586621679131107"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5DivPow2"><span class="hs-identifier hs-var">mulPow5DivPow2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131090"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131105"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-227"></span><span>      </span><span id="local-6989586621679131108"><span class="annot"><span class="annottext">w' :: Word32
</span><a href="#local-6989586621679131108"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5DivPow2"><span class="hs-identifier hs-var">mulPow5DivPow2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131091"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131105"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679131117"><span class="annot"><span class="annottext">lastRemoved :: Word32
</span><a href="#local-6989586621679131117"><span class="hs-identifier hs-var hs-var">lastRemoved</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var">fquot10</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131108"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#fquot10"><span class="hs-identifier hs-var">fquot10</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131106"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679131124"><span class="annot"><span class="annottext">j' :: Int
</span><a href="#local-6989586621679131124"><span class="hs-identifier hs-var hs-var">j'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#pow5bits"><span class="hs-identifier hs-var">pow5bits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.TableGenerator.html#float_pow5_bitcount"><span class="hs-identifier hs-var">float_pow5_bitcount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#frem10"><span class="hs-identifier hs-var">frem10</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Int -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#mulPow5DivPow2"><span class="hs-identifier hs-var">mulPow5DivPow2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131090"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131100"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131124"><span class="hs-identifier hs-var">j'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679131140"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131140"><span class="hs-identifier hs-var">vvTrailing</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679131141"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131141"><span class="hs-identifier hs-var">vuTrailing</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679131142"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131142"><span class="hs-identifier hs-var">vw'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Bool
forall a. Mantissa a =&gt; a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#acceptBounds"><span class="hs-identifier hs-var">acceptBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131090"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-236"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131090"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131089"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131108"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- mmShift == 1</span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-238"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131108"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">31</span></span><span>
</span><span id="line-240"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Bool
forall a. Mantissa a =&gt; a -&gt; Int -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#multipleOfPowerOf2"><span class="hs-identifier hs-var">multipleOfPowerOf2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131090"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131094"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131108"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-242"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131108"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
-&gt; Word32 -&gt; Word32 -&gt; Word32 -&gt; Bool -&gt; Bool -&gt; BoundsState Word32
forall a. a -&gt; a -&gt; a -&gt; a -&gt; Bool -&gt; Bool -&gt; BoundsState a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#BoundsState"><span class="hs-identifier hs-var">BoundsState</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131106"><span class="hs-identifier hs-var">u'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131107"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131142"><span class="hs-identifier hs-var">vw'</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131117"><span class="hs-identifier hs-var">lastRemoved</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131141"><span class="hs-identifier hs-var">vuTrailing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131140"><span class="hs-identifier hs-var">vvTrailing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#intToInt32"><span class="hs-identifier hs-var">intToInt32</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679131097"><span class="hs-identifier hs-var">e10</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Returns the decimal representation of the given mantissa and exponent of a</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- 32-bit Float using the ryu algorithm.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2d"><span class="hs-identifier hs-type">f2d</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier hs-type">FloatingDecimal</span></a></span><span>
</span><span id="line-248"></span><span id="f2d"><span class="annot"><span class="annottext">f2d :: Word32 -&gt; Word32 -&gt; FloatingDecimal
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2d"><span class="hs-identifier hs-var hs-var">f2d</span></a></span></span><span> </span><span id="local-6989586621679131145"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131145"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679131146"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131146"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679131153"><span class="annot"><span class="annottext">mf :: Word32
</span><a href="#local-6989586621679131153"><span class="hs-identifier hs-var hs-var">mf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131146"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-250"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131145"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-251"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_mantissa_bits"><span class="hs-identifier hs-var">float_mantissa_bits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131145"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679131161"><span class="annot"><span class="annottext">ef :: Int32
</span><a href="#local-6989586621679131161"><span class="hs-identifier hs-var hs-var">ef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#intToInt32"><span class="hs-identifier hs-var">intToInt32</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int32) -&gt; Int -&gt; Int32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131146"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-253"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_bias"><span class="hs-identifier hs-var">float_bias</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_mantissa_bits"><span class="hs-identifier hs-var">float_mantissa_bits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#word32ToInt"><span class="hs-identifier hs-var">word32ToInt</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131146"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_bias"><span class="hs-identifier hs-var">float_bias</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_mantissa_bits"><span class="hs-identifier hs-var">float_mantissa_bits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679131165"><span class="annot"><span class="annottext">e2 :: Int32
</span><a href="#local-6989586621679131165"><span class="hs-identifier hs-var hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131161"><span class="hs-identifier hs-var">ef</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Int32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">2</span></span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-comment">-- Step 2. 3-tuple (u, v, w) * 2**e2</span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679131175"><span class="annot"><span class="annottext">u :: Word32
</span><a href="#local-6989586621679131175"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131153"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Word32
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#boolToWord32"><span class="hs-identifier hs-var">boolToWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131145"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131146"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679131179"><span class="annot"><span class="annottext">v :: Word32
</span><a href="#local-6989586621679131179"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131153"><span class="hs-identifier hs-var">mf</span></a></span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679131184"><span class="annot"><span class="annottext">w :: Word32
</span><a href="#local-6989586621679131184"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131153"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2</span></span><span>
</span><span id="line-260"></span><span>      </span><span class="hs-comment">-- Step 3. convert to decimal power base</span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679131188"><span class="annot"><span class="annottext">BoundsState Word32
</span><a href="#local-6989586621679131188"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679131189"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131189"><span class="hs-identifier hs-var">e10</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131165"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-263"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Word32 -&gt; Word32 -&gt; Word32 -&gt; (BoundsState Word32, Int32)
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2dGT"><span class="hs-identifier hs-var">f2dGT</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131165"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131175"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131179"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131184"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-264"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Word32 -&gt; Word32 -&gt; Word32 -&gt; (BoundsState Word32, Int32)
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2dLT"><span class="hs-identifier hs-var">f2dLT</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131165"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131175"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131179"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131184"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span class="hs-comment">-- Step 4: Find the shortest decimal representation in the interval of</span><span>
</span><span id="line-266"></span><span>      </span><span class="hs-comment">-- valid representations.</span><span>
</span><span id="line-267"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679131195"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131195"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679131196"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131196"><span class="hs-identifier hs-var">removed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679131212"><span class="annot"><span class="annottext">rounded :: BoundsState Word32 -&gt; Word32
</span><a href="#local-6989586621679131212"><span class="hs-identifier hs-var hs-var">rounded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; BoundsState Word32 -&gt; Word32
forall a. Mantissa a =&gt; Bool -&gt; BoundsState a -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#closestCorrectlyRounded"><span class="hs-identifier hs-var">closestCorrectlyRounded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Bool
forall a. Mantissa a =&gt; a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#acceptBounds"><span class="hs-identifier hs-var">acceptBounds</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131179"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(BoundsState Word32 -&gt; Word32)
-&gt; (BoundsState Word32, Int32) -&gt; (Word32, Int32)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">BoundsState Word32 -&gt; Word32
</span><a href="#local-6989586621679131212"><span class="hs-identifier hs-var">rounded</span></a></span><span> </span><span class="annot"><span class="annottext">((BoundsState Word32, Int32) -&gt; (Word32, Int32))
-&gt; (BoundsState Word32, Int32) -&gt; (Word32, Int32)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">BoundsState Word32 -&gt; Bool
forall a. BoundsState a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vvIsTrailingZeros"><span class="hs-identifier hs-var">vvIsTrailingZeros</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState Word32
</span><a href="#local-6989586621679131188"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState Word32 -&gt; Bool
forall a. BoundsState a -&gt; Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#vuIsTrailingZeros"><span class="hs-identifier hs-var">vuIsTrailingZeros</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState Word32
</span><a href="#local-6989586621679131188"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-270"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BoundsState Word32 -&gt; (BoundsState Word32, Int32)
forall a.
(Show a, Mantissa a) =&gt;
BoundsState a -&gt; (BoundsState a, Int32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#trimTrailing"><span class="hs-identifier hs-var">trimTrailing</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState Word32
</span><a href="#local-6989586621679131188"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-271"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">BoundsState Word32 -&gt; (BoundsState Word32, Int32)
forall a. Mantissa a =&gt; BoundsState a -&gt; (BoundsState a, Int32)
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#trimNoTrailing"><span class="hs-identifier hs-var">trimNoTrailing</span></a></span><span> </span><span class="annot"><span class="annottext">BoundsState Word32
</span><a href="#local-6989586621679131188"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679131219"><span class="annot"><span class="annottext">e' :: Int32
</span><a href="#local-6989586621679131219"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131189"><span class="hs-identifier hs-var">e10</span></a></span><span> </span><span class="annot"><span class="annottext">Int32 -&gt; Int32 -&gt; Int32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131196"><span class="hs-identifier hs-var">removed</span></a></span><span>
</span><span id="line-273"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int32 -&gt; FloatingDecimal
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier hs-var">FloatingDecimal</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131195"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131219"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><span class="hs-comment">-- | Split a Float into (sign, mantissa, exponent)</span></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#breakdown"><span class="hs-identifier hs-type">breakdown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span id="breakdown"><span class="annot"><span class="annottext">breakdown :: Float -&gt; (Bool, Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#breakdown"><span class="hs-identifier hs-var hs-var">breakdown</span></a></span></span><span> </span><span id="local-6989586621679131221"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679131221"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679131222"><span class="annot"><span class="annottext">bits :: Word32
</span><a href="#local-6989586621679131222"><span class="hs-identifier hs-var hs-var">bits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Word32
</span><span class="hs-identifier hs-var">castFloatToWord32</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679131221"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-279"></span><span>      </span><span id="local-6989586621679131230"><span class="annot"><span class="annottext">sign :: Bool
</span><a href="#local-6989586621679131230"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131222"><span class="hs-identifier hs-var">bits</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_mantissa_bits"><span class="hs-identifier hs-var">float_mantissa_bits</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_exponent_bits"><span class="hs-identifier hs-var">float_exponent_bits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-280"></span><span>      </span><span id="local-6989586621679131234"><span class="annot"><span class="annottext">mantissa :: Word32
</span><a href="#local-6989586621679131234"><span class="hs-identifier hs-var hs-var">mantissa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131222"><span class="hs-identifier hs-var">bits</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a. (Bits a, Integral a) =&gt; Int -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_mantissa_bits"><span class="hs-identifier hs-var">float_mantissa_bits</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span id="local-6989586621679131239"><span class="annot"><span class="annottext">expo :: Word32
</span><a href="#local-6989586621679131239"><span class="hs-identifier hs-var hs-var">expo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131222"><span class="hs-identifier hs-var">bits</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int -&gt; Word32
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`unsafeShiftR`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_mantissa_bits"><span class="hs-identifier hs-var">float_mantissa_bits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a. (Bits a, Integral a) =&gt; Int -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_exponent_bits"><span class="hs-identifier hs-var">float_exponent_bits</span></a></span><span>
</span><span id="line-282"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131230"><span class="hs-identifier hs-var">sign</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131234"><span class="hs-identifier hs-var">mantissa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131239"><span class="hs-identifier hs-var">expo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><span class="hs-comment">-- | Dispatches to `f2d` and applies the given formatters</span></span><span>
</span><span id="line-285"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2s%27"><span class="hs-pragma hs-type">f2s'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-286"></span><span id="local-6989586621679130917"><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2s%27"><span class="hs-identifier hs-type">f2s'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#NonNumbersAndZero"><span class="hs-identifier hs-type">NonNumbersAndZero</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679130917"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-287"></span><span id="f2s%27"><span class="annot"><span class="annottext">f2s' :: forall a.
(Bool -&gt; Word32 -&gt; Int32 -&gt; a)
-&gt; (NonNumbersAndZero -&gt; a) -&gt; Float -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2s%27"><span class="hs-identifier hs-var hs-var">f2s'</span></a></span></span><span> </span><span id="local-6989586621679131252"><span class="annot"><span class="annottext">Bool -&gt; Word32 -&gt; Int32 -&gt; a
</span><a href="#local-6989586621679131252"><span class="hs-identifier hs-var">formatter</span></a></span></span><span> </span><span id="local-6989586621679131253"><span class="annot"><span class="annottext">NonNumbersAndZero -&gt; a
</span><a href="#local-6989586621679131253"><span class="hs-identifier hs-var">specialFormatter</span></a></span></span><span> </span><span id="local-6989586621679131254"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679131254"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679131255"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131255"><span class="hs-identifier hs-var">sign</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679131256"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131256"><span class="hs-identifier hs-var">mantissa</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679131257"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131257"><span class="hs-identifier hs-var">expo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; (Bool, Word32, Word32)
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#breakdown"><span class="hs-identifier hs-var">breakdown</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679131254"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-289"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131257"><span class="hs-identifier hs-var">expo</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a. (Bits a, Integral a) =&gt; Int -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#mask"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#float_exponent_bits"><span class="hs-identifier hs-var">float_exponent_bits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131257"><span class="hs-identifier hs-var">expo</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131256"><span class="hs-identifier hs-var">mantissa</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NonNumbersAndZero -&gt; a
</span><a href="#local-6989586621679131253"><span class="hs-identifier hs-var">specialFormatter</span></a></span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.Internal.html#NonNumbersAndZero"><span class="hs-identifier hs-type">NonNumbersAndZero</span></a></span><span>
</span><span id="line-291"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">negative :: Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#negative"><span class="hs-identifier hs-var">negative</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131255"><span class="hs-identifier hs-var">sign</span></a></span><span>
</span><span id="line-292"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">exponent_all_one :: Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#exponent_all_one"><span class="hs-identifier hs-var">exponent_all_one</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131257"><span class="hs-identifier hs-var">expo</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span>
</span><span id="line-293"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mantissa_non_zero :: Bool
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#mantissa_non_zero"><span class="hs-identifier hs-var">mantissa_non_zero</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131256"><span class="hs-identifier hs-var">mantissa</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-294"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier hs-type">FloatingDecimal</span></a></span><span> </span><span id="local-6989586621679131263"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131263"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679131264"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131264"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; FloatingDecimal
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2d"><span class="hs-identifier hs-var">f2d</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131256"><span class="hs-identifier hs-var">mantissa</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131257"><span class="hs-identifier hs-var">expo</span></a></span><span>
</span><span id="line-295"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Word32 -&gt; Int32 -&gt; a
</span><a href="#local-6989586621679131252"><span class="hs-identifier hs-var">formatter</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679131255"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679131263"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679131264"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><span class="hs-comment">-- | Render a Float in scientific notation</span></span><span>
</span><span id="line-298"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2s"><span class="hs-identifier hs-type">f2s</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.Internal.html#Builder"><span class="hs-identifier hs-type">Builder</span></a></span><span>
</span><span id="line-299"></span><span id="f2s"><span class="annot"><span class="annottext">f2s :: Float -&gt; Builder
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2s"><span class="hs-identifier hs-var hs-var">f2s</span></a></span></span><span> </span><span id="local-6989586621679131265"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679131265"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoundedPrim () -&gt; () -&gt; Builder
forall a. BoundedPrim a -&gt; a -&gt; Builder
</span><a href="Data.ByteString.Builder.Prim.html#primBounded"><span class="hs-identifier hs-var">primBounded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; Word32 -&gt; Int32 -&gt; BoundedPrim ())
-&gt; (NonNumbersAndZero -&gt; BoundedPrim ()) -&gt; Float -&gt; BoundedPrim ()
forall a.
(Bool -&gt; Word32 -&gt; Int32 -&gt; a)
-&gt; (NonNumbersAndZero -&gt; a) -&gt; Float -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2s%27"><span class="hs-identifier hs-var">f2s'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Word32 -&gt; Int32 -&gt; BoundedPrim ()
forall a. Mantissa a =&gt; Bool -&gt; a -&gt; Int32 -&gt; BoundedPrim ()
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsScientific"><span class="hs-identifier hs-var">toCharsScientific</span></a></span><span> </span><span class="annot"><span class="annottext">NonNumbersAndZero -&gt; BoundedPrim ()
</span><a href="Data.ByteString.Builder.RealFloat.Internal.html#toCharsNonNumbersAndZero"><span class="hs-identifier hs-var">toCharsNonNumbersAndZero</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679131265"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-comment">-- | Returns the decimal representation of a Float. NaN and Infinity will</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- return `FloatingDecimal 0 0`</span><span>
</span><span id="line-303"></span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2Intermediate"><span class="hs-identifier hs-type">f2Intermediate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier hs-type">FloatingDecimal</span></a></span><span>
</span><span id="line-304"></span><span id="f2Intermediate"><span class="annot"><span class="annottext">f2Intermediate :: Float -&gt; FloatingDecimal
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2Intermediate"><span class="hs-identifier hs-var hs-var">f2Intermediate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Word32 -&gt; Int32 -&gt; FloatingDecimal)
-&gt; (NonNumbersAndZero -&gt; FloatingDecimal)
-&gt; Float
-&gt; FloatingDecimal
forall a.
(Bool -&gt; Word32 -&gt; Int32 -&gt; a)
-&gt; (NonNumbersAndZero -&gt; a) -&gt; Float -&gt; a
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#f2s%27"><span class="hs-identifier hs-var">f2s'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Word32 -&gt; Int32 -&gt; FloatingDecimal)
-&gt; Bool -&gt; Word32 -&gt; Int32 -&gt; FloatingDecimal
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int32 -&gt; FloatingDecimal
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier hs-var">FloatingDecimal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FloatingDecimal -&gt; NonNumbersAndZero -&gt; FloatingDecimal
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(FloatingDecimal -&gt; NonNumbersAndZero -&gt; FloatingDecimal)
-&gt; FloatingDecimal -&gt; NonNumbersAndZero -&gt; FloatingDecimal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Int32 -&gt; FloatingDecimal
</span><a href="Data.ByteString.Builder.RealFloat.F2S.html#FloatingDecimal"><span class="hs-identifier hs-var">FloatingDecimal</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span></pre></body></html>