<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>GHC.Internal.TopHandler</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ghc-internal-9.1202.0: Basic libraries</span><ul class="links" id="page-menu"><li><a href="src/GHC.Internal.TopHandler.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) The University of Glasgow 2001-2002</td></tr><tr><th>License</th><td>see libraries/base/LICENSE</td></tr><tr><th>Maintainer</th><td>ghc-devs@haskell.org</td></tr><tr><th>Stability</th><td>internal</td></tr><tr><th>Portability</th><td>non-portable (GHC Extensions)</td></tr><tr><th>Safe Haskell</th><td>Trustworthy</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">GHC.Internal.TopHandler</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Support for catching exceptions raised during top-level computations
 (e.g. <code class="inline-code">Main.main</code>, <code><a href="Control-Concurrent.html#v:forkIO" title="Control.Concurrent">forkIO</a></code>, and foreign exports)</p><p><em>The API of this module is unstable and not meant to be consumed by the general public.</em>
 If you absolutely must depend on it, make sure to use a tight upper
 bound, e.g., <code class="inline-code">base &lt; 4.X</code> rather than <code class="inline-code">base &lt; 5</code>, because the interface can
 change rapidly without much warning.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:runMainIO">runMainIO</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a</li><li class="src short"><a href="#v:runIO">runIO</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a</li><li class="src short"><a href="#v:runIOFastExit">runIOFastExit</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a</li><li class="src short"><a href="#v:runNonIO">runNonIO</a> :: a -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a</li><li class="src short"><a href="#v:topHandler">topHandler</a> :: <a href="GHC-Internal-Control-Exception-Base.html#t:SomeException" title="GHC.Internal.Control.Exception.Base">SomeException</a> -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a</li><li class="src short"><a href="#v:topHandlerFastExit">topHandlerFastExit</a> :: <a href="GHC-Internal-Control-Exception-Base.html#t:SomeException" title="GHC.Internal.Control.Exception.Base">SomeException</a> -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a</li><li class="src short"><a href="#v:reportStackOverflow">reportStackOverflow</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> ()</li><li class="src short"><a href="#v:reportError">reportError</a> :: <a href="GHC-Internal-Control-Exception-Base.html#t:SomeException" title="GHC.Internal.Control.Exception.Base">SomeException</a> -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> ()</li><li class="src short"><a href="#v:flushStdHandles">flushStdHandles</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:runMainIO" class="def">runMainIO</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a <a href="src/GHC.Internal.TopHandler.html#runMainIO" class="link">Source</a> <a href="#v:runMainIO" class="selflink">#</a></p><div class="doc"><p><code><a href="GHC-Internal-TopHandler.html#v:runMainIO" title="GHC.Internal.TopHandler">runMainIO</a></code> is wrapped around <code><a href="Main.html#v:main" title="Main">main</a></code> (or whatever main is
 called in the program).  It catches otherwise uncaught exceptions,
 and also flushes stdout/stderr before exiting.</p></div></div><div class="top"><p class="src"><a id="v:runIO" class="def">runIO</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a <a href="src/GHC.Internal.TopHandler.html#runIO" class="link">Source</a> <a href="#v:runIO" class="selflink">#</a></p><div class="doc"><p><code><a href="GHC-Internal-TopHandler.html#v:runIO" title="GHC.Internal.TopHandler">runIO</a></code> is wrapped around every <code class="inline-code">foreign export</code> and <code class="inline-code">foreign
 import &quot;wrapper&quot;</code> to mop up any uncaught exceptions.  Thus, the
 result of running <code><a href="GHC-Internal-System-Exit.html#v:exitWith" title="GHC.Internal.System.Exit">exitWith</a></code> in a foreign-exported
 function is the same as in the main thread: it terminates the
 program.</p></div></div><div class="top"><p class="src"><a id="v:runIOFastExit" class="def">runIOFastExit</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a <a href="src/GHC.Internal.TopHandler.html#runIOFastExit" class="link">Source</a> <a href="#v:runIOFastExit" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="GHC-Internal-TopHandler.html#v:runIO" title="GHC.Internal.TopHandler">runIO</a></code>, but in the event of an exception that causes an exit,
 we don't shut down the system cleanly, we just exit.  This is
 useful in some cases, because the safe exit version will give other
 threads a chance to clean up first, which might shut down the
 system in a different way.  For example, try</p><p>main = forkIO (runIO (exitWith (ExitFailure 1))) &gt;&gt; threadDelay 10000</p><p>This will sometimes exit with &quot;interrupted&quot; and code 0, because the
 main thread is given a chance to shut down when the child thread calls
 safeExit.  There is a race to shut down between the main and child threads.</p></div></div><div class="top"><p class="src"><a id="v:runNonIO" class="def">runNonIO</a> :: a -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a <a href="src/GHC.Internal.TopHandler.html#runNonIO" class="link">Source</a> <a href="#v:runNonIO" class="selflink">#</a></p><div class="doc"><p>The same as <code><a href="GHC-Internal-TopHandler.html#v:runIO" title="GHC.Internal.TopHandler">runIO</a></code>, but for non-IO computations.  Used for
 wrapping <code class="inline-code">foreign export</code> and <code class="inline-code">foreign import &quot;wrapper&quot;</code> when these
 are used to export Haskell functions with non-IO types.</p></div></div><div class="top"><p class="src"><a id="v:topHandler" class="def">topHandler</a> :: <a href="GHC-Internal-Control-Exception-Base.html#t:SomeException" title="GHC.Internal.Control.Exception.Base">SomeException</a> -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a <a href="src/GHC.Internal.TopHandler.html#topHandler" class="link">Source</a> <a href="#v:topHandler" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:topHandlerFastExit" class="def">topHandlerFastExit</a> :: <a href="GHC-Internal-Control-Exception-Base.html#t:SomeException" title="GHC.Internal.Control.Exception.Base">SomeException</a> -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> a <a href="src/GHC.Internal.TopHandler.html#topHandlerFastExit" class="link">Source</a> <a href="#v:topHandlerFastExit" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:reportStackOverflow" class="def">reportStackOverflow</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> () <a href="src/GHC.Internal.Conc.Sync.html#reportStackOverflow" class="link">Source</a> <a href="#v:reportStackOverflow" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:reportError" class="def">reportError</a> :: <a href="GHC-Internal-Control-Exception-Base.html#t:SomeException" title="GHC.Internal.Control.Exception.Base">SomeException</a> -&gt; <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> () <a href="src/GHC.Internal.Conc.Sync.html#reportError" class="link">Source</a> <a href="#v:reportError" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:flushStdHandles" class="def">flushStdHandles</a> :: <a href="GHC-Internal-System-IO.html#t:IO" title="GHC.Internal.System.IO">IO</a> () <a href="src/GHC.Internal.TopHandler.html#flushStdHandles" class="link">Source</a> <a href="#v:flushStdHandles" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.30.0</p></div></body></html>