<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns, MagicHash, UnboxedTuples, NoImplicitPrelude #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -O2 -fno-warn-name-shadowing #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      :  GHC.Internal.Encoding.UTF8</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow, 1994-2023</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  see libraries/base/LICENSE</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Maintainer  :  ghc-devs@haskell.org</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Stability   :  internal</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Portability :  non-portable (GHC extensions)</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- /The API of this module is unstable and not meant to be consumed by the general public./</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- If you absolutely must depend on it, make sure to use a tight upper</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- bound, e.g., @base &lt; 4.X@ rather than @base &lt; 5@, because the interface can</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- change rapidly without much warning.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Simple UTF-8 codecs supporting non-streaming encoding/decoding.</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- For encoding where codepoints may be broken across buffers,</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- see &quot;GHC.IO.Encoding.UTF8&quot;.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- This is one of several UTF-8 implementations provided by GHC; see Note</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- [GHC's many UTF-8 implementations] in &quot;GHC.Encoding.UTF8&quot; for an</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- overview.</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html"><span class="hs-identifier">GHC.Internal.Encoding.UTF8</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Decoding single characters</span></span><span>
</span><span id="line-29"></span><span>      </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharAddr%23"><span class="hs-identifier">utf8DecodeCharAddr#</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharPtr"><span class="hs-identifier">utf8DecodeCharPtr</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharByteArray%23"><span class="hs-identifier">utf8DecodeCharByteArray#</span></a></span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Decoding strings</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeByteArray%23"><span class="hs-identifier">utf8DecodeByteArray#</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeForeignPtr"><span class="hs-identifier">utf8DecodeForeignPtr</span></a></span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Counting characters</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8CountCharsByteArray%23"><span class="hs-identifier">utf8CountCharsByteArray#</span></a></span><span>
</span><span id="line-37"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Comparison</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8CompareByteArray%23"><span class="hs-identifier">utf8CompareByteArray#</span></a></span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Encoding strings</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodePtr"><span class="hs-identifier">utf8EncodePtr</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodeByteArray%23"><span class="hs-identifier">utf8EncodeByteArray#</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodedLength"><span class="hs-identifier">utf8EncodedLength</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html"><span class="hs-identifier">GHC.Types</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.Base.html"><span class="hs-identifier">GHC.Internal.Base</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.IO.html"><span class="hs-identifier">GHC.Internal.IO</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.ST.html"><span class="hs-identifier">GHC.Internal.ST</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.Word.html"><span class="hs-identifier">GHC.Internal.Word</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.ForeignPtr.html"><span class="hs-identifier">GHC.Internal.ForeignPtr</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.Num.html"><span class="hs-identifier">GHC.Internal.Num</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.Bits.html"><span class="hs-identifier">GHC.Internal.Bits</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.Real.html"><span class="hs-identifier">GHC.Internal.Real</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Internal.Ptr.html"><span class="hs-identifier">GHC.Internal.Ptr</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">{-
Note [GHC's many UTF-8 implementations]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Currently GHC ships with at least five UTF-8 implementations:

a. the implementation used by GHC in `ghc-boot:GHC.Utils.Encoding`; this can be
   used at a number of types including `Addr#`, `ByteArray#`, `ForeignPtr`,
   `Ptr`, `ShortByteString`, and `ByteString`. Most of this can be removed in
   GHC 9.6+2, when the copies in `base` will become available to `ghc-boot`.

b. the copy of the `ghc-boot` definition now exported by `base:GHC.Encoding.UTF8`.
   This can be used at `Addr#`, `Ptr`, `ByteArray#`, and `ForeignPtr`.

c. the decoder used by `unpackCStringUtf8#` in `ghc-prim:GHC.CString`; this is
   specialised at `Addr#`.

d. the codec used by the IO subsystem in `base:GHC.IO.Encoding.UTF8`; this is
   specialised at `Addr#` but, unlike the above, supports recovery in the presence
   of partial codepoints (since in IO contexts codepoints may be broken across
   buffers)

e. the implementation provided by the `text` library

On its face, this seems a tad silly. On the other hand, these implementations do
materially differ from one another (e.g. in the types they support, the
detail in errors they can report, and the ability to recover from partial
codepoints). Consequently, it's quite unclear that further consolidation
would be worthwhile.

The most obvious opportunity is to move (b) into `ghc-prim` and use it to
implement (c) (namely `unpackCStringUtf8#` and friends). However, it's not
clear that this would be worthwhile as several of the types supported by (b)
are defined in `base`.
-}</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- We can't write the decoder as efficiently as we'd like without</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- resorting to unboxed extensions, unfortunately.  I tried to write</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- an IO version of this function, but GHC can't eliminate boxed</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- results from an IO-returning function.</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- We assume we can ignore overflow when parsing a multibyte character here.</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- To make this safe, we add extra sentinel bytes to unparsed UTF-8 sequences</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- before decoding them (see &quot;GHC.Data.StringBuffer&quot;).</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeChar%23"><span class="hs-pragma hs-type">utf8DecodeChar#</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Decode a single codepoint from a byte buffer indexed by the given indexing</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- function.</span><span>
</span><span id="line-103"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeChar%23"><span class="hs-identifier hs-type">utf8DecodeChar#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Word%23"><span class="hs-identifier hs-type">Word#</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Char%23"><span class="hs-identifier hs-type">Char#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-104"></span><span id="utf8DecodeChar%23"><span class="annot"><span class="annottext">utf8DecodeChar# :: (Int# -&gt; Word#) -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeChar%23"><span class="hs-identifier hs-var hs-var">utf8DecodeChar#</span></a></span></span><span> </span><span id="local-6989586621679810259"><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="#local-6989586621679810259"><span class="hs-identifier hs-var">indexWord8#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810260"><span class="annot"><span class="annottext">ch0 :: Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var hs-var">ch0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="#local-6989586621679810259"><span class="hs-identifier hs-var">indexWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%3D%23"><span class="hs-operator hs-var">&lt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x7F#</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Char#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#chr%23"><span class="hs-identifier hs-var">chr#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xC0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#andI%23"><span class="hs-operator hs-var">`andI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%3D%23"><span class="hs-operator hs-var">&lt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xDF#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810262"><span class="annot"><span class="annottext">ch1 :: Int#
</span><a href="#local-6989586621679810262"><span class="hs-identifier hs-var hs-var">ch1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="#local-6989586621679810259"><span class="hs-identifier hs-var">indexWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810262"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%23"><span class="hs-operator hs-var">&lt;#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#orI%23"><span class="hs-operator hs-var">`orI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810262"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xC0#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810263"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Char#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#chr%23"><span class="hs-identifier hs-var">chr#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xC0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#uncheckedIShiftL%23"><span class="hs-operator hs-var">`uncheckedIShiftL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">6#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span>
</span><span id="line-113"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810262"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>           </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xE0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#andI%23"><span class="hs-operator hs-var">`andI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%3D%23"><span class="hs-operator hs-var">&lt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xEF#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810264"><span class="annot"><span class="annottext">ch1 :: Int#
</span><a href="#local-6989586621679810264"><span class="hs-identifier hs-var hs-var">ch1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="#local-6989586621679810259"><span class="hs-identifier hs-var">indexWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810264"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%23"><span class="hs-operator hs-var">&lt;#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#orI%23"><span class="hs-operator hs-var">`orI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810264"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xC0#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810263"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810265"><span class="annot"><span class="annottext">ch2 :: Int#
</span><a href="#local-6989586621679810265"><span class="hs-identifier hs-var hs-var">ch2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="#local-6989586621679810259"><span class="hs-identifier hs-var">indexWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810265"><span class="hs-identifier hs-var">ch2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%23"><span class="hs-operator hs-var">&lt;#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#orI%23"><span class="hs-operator hs-var">`orI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810265"><span class="hs-identifier hs-var">ch2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xC0#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810263"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Char#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#chr%23"><span class="hs-identifier hs-var">chr#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xE0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#uncheckedIShiftL%23"><span class="hs-operator hs-var">`uncheckedIShiftL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">12#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span>
</span><span id="line-122"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810264"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#uncheckedIShiftL%23"><span class="hs-operator hs-var">`uncheckedIShiftL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">6#</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span>
</span><span id="line-123"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810265"><span class="hs-identifier hs-var">ch2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>           </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">3#</span></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xF0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#andI%23"><span class="hs-operator hs-var">`andI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%3D%23"><span class="hs-operator hs-var">&lt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xF8#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810266"><span class="annot"><span class="annottext">ch1 :: Int#
</span><a href="#local-6989586621679810266"><span class="hs-identifier hs-var hs-var">ch1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="#local-6989586621679810259"><span class="hs-identifier hs-var">indexWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810266"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%23"><span class="hs-operator hs-var">&lt;#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#orI%23"><span class="hs-operator hs-var">`orI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810266"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xC0#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810263"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810267"><span class="annot"><span class="annottext">ch2 :: Int#
</span><a href="#local-6989586621679810267"><span class="hs-identifier hs-var hs-var">ch2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="#local-6989586621679810259"><span class="hs-identifier hs-var">indexWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810267"><span class="hs-identifier hs-var">ch2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%23"><span class="hs-operator hs-var">&lt;#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#orI%23"><span class="hs-operator hs-var">`orI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810267"><span class="hs-identifier hs-var">ch2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xC0#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810263"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810268"><span class="annot"><span class="annottext">ch3 :: Int#
</span><a href="#local-6989586621679810268"><span class="hs-identifier hs-var hs-var">ch3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word2Int%23"><span class="hs-identifier hs-var">word2Int#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Word#
</span><a href="#local-6989586621679810259"><span class="hs-identifier hs-var">indexWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">3#</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-132"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810268"><span class="hs-identifier hs-var">ch3</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3C%23"><span class="hs-operator hs-var">&lt;#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#orI%23"><span class="hs-operator hs-var">`orI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810268"><span class="hs-identifier hs-var">ch3</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xC0#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810263"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">3#</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Char#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#chr%23"><span class="hs-identifier hs-var">chr#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810260"><span class="hs-identifier hs-var">ch0</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0xF0#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#uncheckedIShiftL%23"><span class="hs-operator hs-var">`uncheckedIShiftL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">18#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span>
</span><span id="line-134"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810266"><span class="hs-identifier hs-var">ch1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#uncheckedIShiftL%23"><span class="hs-operator hs-var">`uncheckedIShiftL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">12#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span>
</span><span id="line-135"></span><span>                 </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810267"><span class="hs-identifier hs-var">ch2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#uncheckedIShiftL%23"><span class="hs-operator hs-var">`uncheckedIShiftL#`</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">6#</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span>
</span><span id="line-136"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810268"><span class="hs-identifier hs-var">ch3</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0x80#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>           </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">4#</span></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Internal.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810263"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-comment">-- all invalid sequences end up here:</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><a href="#local-6989586621679810263"><span class="hs-identifier hs-type">fail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Char%23"><span class="hs-identifier hs-type">Char#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-143"></span><span>        </span><span id="local-6989586621679810263"><span class="annot"><span class="annottext">fail :: Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810263"><span class="hs-identifier hs-var hs-var">fail</span></a></span></span><span> </span><span id="local-6989586621679810269"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810269"><span class="hs-identifier hs-var">nBytes#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Char#
</span><span class="hs-char">'\0'#</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810269"><span class="hs-identifier hs-var">nBytes#</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-comment">-- '\xFFFD' would be the usual replacement character, but</span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-comment">-- that's a valid symbol in Haskell, so will result in a</span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-comment">-- confusing parse error later on.  Instead we use '\0' which</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-comment">-- will signal a lexer error immediately.</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><span class="hs-comment">-- | Decode a single character at the given 'Addr#'.</span></span><span>
</span><span id="line-150"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharAddr%23"><span class="hs-identifier hs-type">utf8DecodeCharAddr#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Addr%23"><span class="hs-identifier hs-type">Addr#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Char%23"><span class="hs-identifier hs-type">Char#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-151"></span><span id="utf8DecodeCharAddr%23"><span class="annot"><span class="annottext">utf8DecodeCharAddr# :: Addr# -&gt; Int# -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharAddr%23"><span class="hs-identifier hs-var hs-var">utf8DecodeCharAddr#</span></a></span></span><span> </span><span id="local-6989586621679810270"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810270"><span class="hs-identifier hs-var">a#</span></a></span></span><span> </span><span id="local-6989586621679810271"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810271"><span class="hs-identifier hs-var">off#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if !MIN_VERSION_ghc_prim(0,10,0)
</span><span>    </span><span class="hs-identifier">utf8DecodeChar#</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">i#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">indexWord8OffAddr#</span><span> </span><span class="hs-identifier">a#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-identifier">off#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="annot"><span class="annottext">(Int# -&gt; Word#) -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeChar%23"><span class="hs-identifier hs-var">utf8DecodeChar#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679810272"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810272"><span class="hs-identifier hs-var">i#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word8ToWord%23"><span class="hs-identifier hs-var">word8ToWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Word8#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#indexWord8OffAddr%23"><span class="hs-identifier hs-var">indexWord8OffAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810270"><span class="hs-identifier hs-var">a#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810272"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810271"><span class="hs-identifier hs-var">off#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-158"></span><span class="annot"><span class="hs-comment">-- | Decode a single codepoint starting at the given 'Ptr'.</span></span><span>
</span><span id="line-159"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharPtr"><span class="hs-identifier hs-type">utf8DecodeCharPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Internal.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHC.Internal.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span id="utf8DecodeCharPtr"><span class="annot"><span class="annottext">utf8DecodeCharPtr :: Ptr Word8 -&gt; (Char, Int)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharPtr"><span class="hs-identifier hs-var hs-var">utf8DecodeCharPtr</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Internal.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span id="local-6989586621679810274"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810274"><span class="hs-identifier hs-var">a#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharAddr%23"><span class="hs-identifier hs-var">utf8DecodeCharAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810274"><span class="hs-identifier hs-var">a#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679810275"><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679810275"><span class="hs-identifier hs-var">c#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679810276"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810276"><span class="hs-identifier hs-var">nBytes#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Char# -&gt; Char
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#C%23"><span class="hs-identifier hs-var">C#</span></a></span><span> </span><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679810275"><span class="hs-identifier hs-var">c#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810276"><span class="hs-identifier hs-var">nBytes#</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Decode a single codepoint starting at the given byte offset into a</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- 'ByteArray#'.</span><span>
</span><span id="line-166"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharByteArray%23"><span class="hs-identifier hs-type">utf8DecodeCharByteArray#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Char%23"><span class="hs-identifier hs-type">Char#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-167"></span><span id="utf8DecodeCharByteArray%23"><span class="annot"><span class="annottext">utf8DecodeCharByteArray# :: ByteArray# -&gt; Int# -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharByteArray%23"><span class="hs-identifier hs-var hs-var">utf8DecodeCharByteArray#</span></a></span></span><span> </span><span id="local-6989586621679810277"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810277"><span class="hs-identifier hs-var">ba#</span></a></span></span><span> </span><span id="local-6989586621679810278"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810278"><span class="hs-identifier hs-var">off#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if !MIN_VERSION_ghc_prim(0,10,0)
</span><span>    </span><span class="hs-identifier">utf8DecodeChar#</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">i#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">indexWord8Array#</span><span> </span><span class="hs-identifier">ba#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-identifier">off#</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="annot"><span class="annottext">(Int# -&gt; Word#) -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeChar%23"><span class="hs-identifier hs-var">utf8DecodeChar#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679810279"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810279"><span class="hs-identifier hs-var">i#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word8ToWord%23"><span class="hs-identifier hs-var">word8ToWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word8#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#indexWord8Array%23"><span class="hs-identifier hs-var">indexWord8Array#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810277"><span class="hs-identifier hs-var">ba#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810279"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810278"><span class="hs-identifier hs-var">off#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-174"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8Decode%23"><span class="hs-pragma hs-type">utf8Decode#</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-175"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8Decode%23"><span class="hs-identifier hs-type">utf8Decode#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Char%23"><span class="hs-identifier hs-type">Char#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-special">#)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span id="utf8Decode%23"><span class="annot"><span class="annottext">utf8Decode# :: IO () -&gt; (Int# -&gt; (# Char#, Int# #)) -&gt; Int# -&gt; IO [Char]
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8Decode%23"><span class="hs-identifier hs-var hs-var">utf8Decode#</span></a></span></span><span> </span><span id="local-6989586621679810281"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679810281"><span class="hs-identifier hs-var">retain</span></a></span></span><span> </span><span id="local-6989586621679810282"><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810282"><span class="hs-identifier hs-var">decodeChar#</span></a></span></span><span> </span><span id="local-6989586621679810283"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810283"><span class="hs-identifier hs-var">len#</span></a></span></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; IO [Char]
</span><a href="#local-6989586621679810284"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679810284"><span class="annot"><span class="annottext">unpack :: Int# -&gt; IO [Char]
</span><a href="#local-6989586621679810284"><span class="hs-identifier hs-var hs-var">unpack</span></a></span></span><span> </span><span id="local-6989586621679810289"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810289"><span class="hs-identifier hs-var">i#</span></a></span></span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810289"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810283"><span class="hs-identifier hs-var">len#</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679810281"><span class="hs-identifier hs-var">retain</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO [Char] -&gt; IO [Char]
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="GHC.Internal.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO [Char]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Internal.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; (# Char#, Int# #)
</span><a href="#local-6989586621679810282"><span class="hs-identifier hs-var">decodeChar#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810289"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>              </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679810290"><span class="annot"><span class="annottext">Char#
</span><a href="#local-6989586621679810290"><span class="hs-identifier hs-var">c#</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679810291"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810291"><span class="hs-identifier hs-var">nBytes#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>                </span><span id="local-6989586621679810292"><span class="annot"><a href="#local-6989586621679810292"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Char] -&gt; IO [Char]
forall a. IO a -&gt; IO a
</span><a href="GHC.Internal.IO.Unsafe.html#unsafeDupableInterleaveIO"><span class="hs-identifier hs-var">unsafeDupableInterleaveIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Char] -&gt; IO [Char]) -&gt; IO [Char] -&gt; IO [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; IO [Char]
</span><a href="#local-6989586621679810284"><span class="hs-identifier hs-var">unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810289"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810291"><span class="hs-identifier hs-var">nBytes#</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                </span><span class="annot"><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-type">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#C%23"><span class="hs-identifier hs-type">C#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679810290"><span class="hs-identifier hs-type">c#</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679810292"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeForeignPtr"><span class="hs-identifier hs-type">utf8DecodeForeignPtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Internal.ForeignPtr.html#ForeignPtr"><span class="hs-identifier hs-type">ForeignPtr</span></a></span><span> </span><span class="annot"><a href="GHC.Internal.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span id="utf8DecodeForeignPtr"><span class="annot"><span class="annottext">utf8DecodeForeignPtr :: ForeignPtr Word8 -&gt; Int -&gt; Int -&gt; [Char]
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeForeignPtr"><span class="hs-identifier hs-var hs-var">utf8DecodeForeignPtr</span></a></span></span><span> </span><span id="local-6989586621679810294"><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679810294"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679810295"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679810295"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679810296"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810296"><span class="hs-identifier hs-var">len#</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [Char] -&gt; [Char]
forall a. IO a -&gt; a
</span><a href="GHC.Internal.IO.Unsafe.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Char] -&gt; [Char]) -&gt; IO [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Internal.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span id="local-6989586621679810298"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810298"><span class="hs-identifier hs-var">a#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; Ptr Word8
forall a. ForeignPtr a -&gt; Ptr a
</span><a href="GHC.Internal.ForeignPtr.html#unsafeForeignPtrToPtr"><span class="hs-identifier hs-var">unsafeForeignPtrToPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679810294"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Int -&gt; Ptr (ZonkAny 0)
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><a href="GHC.Internal.Ptr.html#plusPtr"><span class="hs-operator hs-var">`plusPtr`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679810295"><span class="hs-identifier hs-var">offset</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; (Int# -&gt; (# Char#, Int# #)) -&gt; Int# -&gt; IO [Char]
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8Decode%23"><span class="hs-identifier hs-var">utf8Decode#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignPtr Word8 -&gt; IO ()
forall a. ForeignPtr a -&gt; IO ()
</span><a href="GHC.Internal.ForeignPtr.html#touchForeignPtr"><span class="hs-identifier hs-var">touchForeignPtr</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr Word8
</span><a href="#local-6989586621679810294"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharAddr%23"><span class="hs-identifier hs-var">utf8DecodeCharAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810298"><span class="hs-identifier hs-var">a#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810296"><span class="hs-identifier hs-var">len#</span></a></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- Note that since utf8Decode# returns a thunk the lifetime of the</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- ForeignPtr actually needs to be longer than the lexical lifetime</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- withForeignPtr would provide here. That's why we use touchForeignPtr to</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- keep the fp alive until the last character has actually been decoded.</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeByteArray%23"><span class="hs-identifier hs-type">utf8DecodeByteArray#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span id="utf8DecodeByteArray%23"><span class="annot"><span class="annottext">utf8DecodeByteArray# :: ByteArray# -&gt; [Char]
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeByteArray%23"><span class="hs-identifier hs-var hs-var">utf8DecodeByteArray#</span></a></span></span><span> </span><span id="local-6989586621679810302"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810302"><span class="hs-identifier hs-var">ba#</span></a></span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO [Char] -&gt; [Char]
forall a. IO a -&gt; a
</span><a href="GHC.Internal.IO.Unsafe.html#unsafeDupablePerformIO"><span class="hs-identifier hs-var">unsafeDupablePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Char] -&gt; [Char]) -&gt; IO [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679810303"><span class="annot"><span class="annottext">len# :: Int#
</span><a href="#local-6989586621679810303"><span class="hs-identifier hs-var hs-var">len#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#sizeofByteArray%23"><span class="hs-identifier hs-var">sizeofByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810302"><span class="hs-identifier hs-var">ba#</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; (Int# -&gt; (# Char#, Int# #)) -&gt; Int# -&gt; IO [Char]
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8Decode%23"><span class="hs-identifier hs-var">utf8Decode#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharByteArray%23"><span class="hs-identifier hs-var">utf8DecodeCharByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810302"><span class="hs-identifier hs-var">ba#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810303"><span class="hs-identifier hs-var">len#</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8CompareByteArray%23"><span class="hs-identifier hs-type">utf8CompareByteArray#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a></span><span>
</span><span id="line-204"></span><span id="utf8CompareByteArray%23"><span class="annot"><span class="annottext">utf8CompareByteArray# :: ByteArray# -&gt; ByteArray# -&gt; Ordering
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8CompareByteArray%23"><span class="hs-identifier hs-var hs-var">utf8CompareByteArray#</span></a></span></span><span> </span><span id="local-6989586621679810304"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810304"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span id="local-6989586621679810305"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810305"><span class="hs-identifier hs-var">a2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Ordering
</span><a href="#local-6989586621679810306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span>
</span><span id="line-205"></span><span>   </span><span class="hs-comment">-- UTF-8 has the property that sorting by bytes values also sorts by</span><span>
</span><span id="line-206"></span><span>   </span><span class="hs-comment">-- code-points.</span><span>
</span><span id="line-207"></span><span>   </span><span class="hs-comment">-- BUT we use &quot;Modified UTF-8&quot; which encodes \0 as 0xC080 so this property</span><span>
</span><span id="line-208"></span><span>   </span><span class="hs-comment">-- doesn't hold and we must explicitly check this case here.</span><span>
</span><span id="line-209"></span><span>   </span><span class="hs-comment">-- Note that decoding every code point would also work but it would be much</span><span>
</span><span id="line-210"></span><span>   </span><span class="hs-comment">-- more costly.</span><span>
</span><span id="line-211"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>       </span><span class="hs-glyph">!</span><span id="local-6989586621679810307"><span class="annot"><span class="annottext">sz1 :: Int#
</span><a href="#local-6989586621679810307"><span class="hs-identifier hs-var hs-var">sz1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#sizeofByteArray%23"><span class="hs-identifier hs-var">sizeofByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810304"><span class="hs-identifier hs-var">a1</span></a></span><span>
</span><span id="line-213"></span><span>       </span><span class="hs-glyph">!</span><span id="local-6989586621679810308"><span class="annot"><span class="annottext">sz2 :: Int#
</span><a href="#local-6989586621679810308"><span class="hs-identifier hs-var hs-var">sz2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#sizeofByteArray%23"><span class="hs-identifier hs-var">sizeofByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810305"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-214"></span><span>       </span><span id="local-6989586621679810306"><span class="annot"><span class="annottext">go :: Int# -&gt; Int# -&gt; Ordering
</span><a href="#local-6989586621679810306"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679810309"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span></span><span> </span><span id="local-6989586621679810310"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span></span><span>
</span><span id="line-215"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810307"><span class="hs-identifier hs-var">sz1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#andI%23"><span class="hs-operator hs-var">`andI#`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810308"><span class="hs-identifier hs-var">sz2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span>
</span><span id="line-216"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810307"><span class="hs-identifier hs-var">sz1</span></a></span><span class="hs-special">)</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a></span><span>
</span><span id="line-217"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810308"><span class="hs-identifier hs-var">sz2</span></a></span><span class="hs-special">)</span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span>
</span><span id="line-218"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Internal.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if !MIN_VERSION_ghc_prim(0,10,0)
</span><span>               </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier">b1_1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">indexWord8Array#</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-identifier">off1</span><span>
</span><span id="line-221"></span><span>                   </span><span class="hs-glyph">!</span><span class="hs-identifier">b2_1</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">indexWord8Array#</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-identifier">off2</span><span class="hs-cpp">
#else
</span><span>               </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810311"><span class="annot"><span class="annottext">b1_1 :: Word#
</span><a href="#local-6989586621679810311"><span class="hs-identifier hs-var hs-var">b1_1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word8ToWord%23"><span class="hs-identifier hs-var">word8ToWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word8#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#indexWord8Array%23"><span class="hs-identifier hs-var">indexWord8Array#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810304"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621679810312"><span class="annot"><span class="annottext">b2_1 :: Word#
</span><a href="#local-6989586621679810312"><span class="hs-identifier hs-var hs-var">b2_1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word8ToWord%23"><span class="hs-identifier hs-var">word8ToWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word8#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#indexWord8Array%23"><span class="hs-identifier hs-var">indexWord8Array#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810305"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810311"><span class="hs-identifier hs-var">b1_1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-227"></span><span>                  </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xC0##</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810312"><span class="hs-identifier hs-var">b2_1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-228"></span><span>                     </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xC0##</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Ordering
</span><a href="#local-6989586621679810306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if !MIN_VERSION_ghc_prim(0,10,0)
</span><span>                     </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">indexWord8Array#</span><span> </span><span class="hs-identifier">a1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">off1</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#else
</span><span>                     </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word8ToWord%23"><span class="hs-identifier hs-var">word8ToWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word8#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#indexWord8Array%23"><span class="hs-identifier hs-var">indexWord8Array#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810304"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#endif
</span><span>                        </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0x80##</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a></span><span>
</span><span id="line-235"></span><span>                        </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Ordering
</span><a href="#local-6989586621679810306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                  </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810312"><span class="hs-identifier hs-var">b2_1</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if !MIN_VERSION_ghc_prim(0,10,0)
</span><span>                     </span><span class="hs-number">0xC0##</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">indexWord8Array#</span><span> </span><span class="hs-identifier">a2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">off2</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#else
</span><span>                     </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0xC0##</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word8# -&gt; Word#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#word8ToWord%23"><span class="hs-identifier hs-var">word8ToWord#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; Word8#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#indexWord8Array%23"><span class="hs-identifier hs-var">indexWord8Array#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810305"><span class="hs-identifier hs-var">a2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#endif
</span><span>                        </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-number">0x80##</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span>
</span><span id="line-243"></span><span>                        </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Ordering
</span><a href="#local-6989586621679810306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>                     </span><span class="annot"><span class="annottext">Word#
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810311"><span class="hs-identifier hs-var">b1_1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#gtWord%23"><span class="hs-operator hs-var">`gtWord#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810312"><span class="hs-identifier hs-var">b2_1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span>
</span><span id="line-245"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810311"><span class="hs-identifier hs-var">b1_1</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ltWord%23"><span class="hs-operator hs-var">`ltWord#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810312"><span class="hs-identifier hs-var">b2_1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a></span><span>
</span><span id="line-246"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Internal.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Ordering
</span><a href="#local-6989586621679810306"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810309"><span class="hs-identifier hs-var">off1</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810310"><span class="hs-identifier hs-var">off2</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8CountCharsByteArray%23"><span class="hs-identifier hs-type">utf8CountCharsByteArray#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-249"></span><span id="utf8CountCharsByteArray%23"><span class="annot"><span class="annottext">utf8CountCharsByteArray# :: ByteArray# -&gt; Int
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8CountCharsByteArray%23"><span class="hs-identifier hs-var hs-var">utf8CountCharsByteArray#</span></a></span></span><span> </span><span id="local-6989586621679810313"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810313"><span class="hs-identifier hs-var">ba</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int
</span><a href="#local-6989586621679810314"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679810315"><span class="annot"><span class="annottext">len# :: Int#
</span><a href="#local-6989586621679810315"><span class="hs-identifier hs-var hs-var">len#</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#sizeofByteArray%23"><span class="hs-identifier hs-var">sizeofByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810313"><span class="hs-identifier hs-var">ba</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679810314"><span class="annot"><span class="annottext">go :: Int# -&gt; Int# -&gt; Int
</span><a href="#local-6989586621679810314"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679810316"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810316"><span class="hs-identifier hs-var">i#</span></a></span></span><span> </span><span id="local-6989586621679810317"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810317"><span class="hs-identifier hs-var">n#</span></a></span></span><span>
</span><span id="line-253"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#isTrue%23"><span class="hs-identifier hs-var">isTrue#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810316"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%3E%3D%23"><span class="hs-operator hs-var">&gt;=#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810315"><span class="hs-identifier hs-var">len#</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810317"><span class="hs-identifier hs-var">n#</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Internal.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteArray# -&gt; Int# -&gt; (# Char#, Int# #)
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8DecodeCharByteArray%23"><span class="hs-identifier hs-var">utf8DecodeCharByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810313"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810316"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-256"></span><span>            </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">Char#
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679810318"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810318"><span class="hs-identifier hs-var">nBytes#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int
</span><a href="#local-6989586621679810314"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810316"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810318"><span class="hs-identifier hs-var">nBytes#</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810317"><span class="hs-identifier hs-var">n#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodeChar"><span class="hs-pragma hs-type">utf8EncodeChar</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-259"></span><span id="local-6989586621679810224"><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodeChar"><span class="hs-identifier hs-type">utf8EncodeChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Int%23"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#Word8%23"><span class="hs-identifier hs-type">Word8#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679810224"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#State%23"><span class="hs-identifier hs-type">State#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679810224"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Internal.ST.html#ST"><span class="hs-identifier hs-type">ST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679810224"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-261"></span><span id="utf8EncodeChar"><span class="annot"><span class="annottext">utf8EncodeChar :: forall s.
(Int# -&gt; Word8# -&gt; State# s -&gt; State# s) -&gt; Char -&gt; ST s Int
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodeChar"><span class="hs-identifier hs-var hs-var">utf8EncodeChar</span></a></span></span><span> </span><span id="local-6989586621679810390"><span class="annot"><span class="annottext">Int# -&gt; Word8# -&gt; State# s -&gt; State# s
</span><a href="#local-6989586621679810390"><span class="hs-identifier hs-var">write#</span></a></span></span><span> </span><span id="local-6989586621679810391"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810391"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679810395"><span class="annot"><span class="annottext">x :: Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="GHC.Internal.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="GHC.Internal.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810391"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x007f</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-266"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-267"></span><span>        </span><span class="hs-comment">-- NB. '\0' is encoded as '\xC0\x80', not '\0'.  This is so that we</span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-comment">-- can have 0-terminated UTF-8 strings (see GHC.Internal.Base.unpackCStringUtf8).</span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x07ff</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0xC0</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Internal.Bits.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x1F</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x80</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x3F</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-273"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0xffff</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0xE0</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Internal.Bits.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x0F</span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x80</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Internal.Bits.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x3F</span></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x80</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x3F</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Internal.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0xF0</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Internal.Bits.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">18</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x80</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Internal.Bits.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x3F</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x80</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Int -&gt; Word
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="GHC.Internal.Bits.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x3F</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x80</span></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679810395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0x3F</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679810400"><span class="hs-pragma hs-type">write</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679810400"><span class="annot"><span class="annottext">write :: Int -&gt; Word -&gt; ST s ()
</span><a href="#local-6989586621679810400"><span class="hs-identifier hs-var hs-var">write</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679810404"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810404"><span class="hs-identifier hs-var">off#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#W%23"><span class="hs-identifier hs-type">W#</span></a></span><span> </span><span id="local-6989586621679810405"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810405"><span class="hs-identifier hs-var">c#</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STRep s () -&gt; ST s ()
forall s a. STRep s a -&gt; ST s a
</span><a href="GHC.Internal.ST.html#ST"><span class="hs-identifier hs-var">ST</span></a></span><span> </span><span class="annot"><span class="annottext">(STRep s () -&gt; ST s ()) -&gt; STRep s () -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679810407"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679810407"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#if !MIN_VERSION_ghc_prim(0,10,0)
</span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">write#</span><span> </span><span class="hs-identifier">off#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">narrowWord8#</span><span> </span><span class="hs-identifier">c#</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Word8# -&gt; State# s -&gt; State# s
</span><a href="#local-6989586621679810390"><span class="hs-identifier hs-var">write#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810404"><span class="hs-identifier hs-var">off#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word# -&gt; Word8#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#wordToWord8%23"><span class="hs-identifier hs-var">wordToWord8#</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679810405"><span class="hs-identifier hs-var">c#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679810407"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#endif
</span><span>        </span><span id="local-6989586621679810408"><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679810408"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# s
</span><a href="#local-6989586621679810408"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodePtr"><span class="hs-identifier hs-type">utf8EncodePtr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Internal.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="GHC.Internal.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Internal.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span id="utf8EncodePtr"><span class="annot"><span class="annottext">utf8EncodePtr :: Ptr Word8 -&gt; [Char] -&gt; IO ()
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodePtr"><span class="hs-identifier hs-var hs-var">utf8EncodePtr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Internal.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span id="local-6989586621679810409"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810409"><span class="hs-identifier hs-var">a#</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679810410"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810410"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Addr# -&gt; [Char] -&gt; IO ()
</span><a href="#local-6989586621679810411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810409"><span class="hs-identifier hs-var">a#</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810410"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679810411"><span class="annot"><span class="annottext">go :: Addr# -&gt; [Char] -&gt; IO ()
</span><a href="#local-6989586621679810411"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">Addr#
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><a href="#local-6989586621679810411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679810414"><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810414"><span class="hs-identifier hs-var">a#</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679810415"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810415"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679810416"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810416"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-cpp">
#if !MIN_VERSION_ghc_prim(0,10,0)
</span><span>          </span><span class="hs-comment">-- writeWord8OffAddr# was taking a Word#</span><span>
</span><span id="line-300"></span><span>          </span><span class="hs-identifier">I#</span><span> </span><span class="hs-identifier">off#</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">stToIO</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">utf8EncodeChar</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">writeWord8OffAddr#</span><span> </span><span class="hs-identifier">a#</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">extendWord8#</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">c</span><span class="hs-cpp">
#else
</span><span>          </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679810417"><span class="annot"><a href="#local-6989586621679810417"><span class="hs-identifier hs-var">off#</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ST RealWorld Int -&gt; IO Int
forall a. ST RealWorld a -&gt; IO a
</span><a href="GHC.Internal.IO.html#stToIO"><span class="hs-identifier hs-var">stToIO</span></a></span><span> </span><span class="annot"><span class="annottext">(ST RealWorld Int -&gt; IO Int) -&gt; ST RealWorld Int -&gt; IO Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Word8# -&gt; State# RealWorld -&gt; State# RealWorld)
-&gt; Char -&gt; ST RealWorld Int
forall s.
(Int# -&gt; Word8# -&gt; State# s -&gt; State# s) -&gt; Char -&gt; ST s Int
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodeChar"><span class="hs-identifier hs-var">utf8EncodeChar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Addr# -&gt; Int# -&gt; Word8# -&gt; State# RealWorld -&gt; State# RealWorld
forall d. Addr# -&gt; Int# -&gt; Word8# -&gt; State# d -&gt; State# d
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#writeWord8OffAddr%23"><span class="hs-identifier hs-var">writeWord8OffAddr#</span></a></span><span> </span><span class="annot"><span class="annottext">Addr#
</span><a href="#local-6989586621679810414"><span class="hs-identifier hs-var">a#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810415"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-cpp">
#endif
</span><span>          </span><span class="annot"><a href="#local-6989586621679810411"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679810414"><span class="hs-identifier hs-type">a#</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#plusAddr%23"><span class="hs-operator hs-type">`plusAddr#`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679810417"><span class="hs-identifier hs-type">off#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679810416"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodeByteArray%23"><span class="hs-identifier hs-type">utf8EncodeByteArray#</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Internal.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#ByteArray%23"><span class="hs-identifier hs-type">ByteArray#</span></a></span><span>
</span><span id="line-307"></span><span id="utf8EncodeByteArray%23"><span class="annot"><span class="annottext">utf8EncodeByteArray# :: [Char] -&gt; ByteArray#
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodeByteArray%23"><span class="hs-identifier hs-var hs-var">utf8EncodeByteArray#</span></a></span></span><span> </span><span id="local-6989586621679810419"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810419"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(State# RealWorld -&gt; ByteArray#) -&gt; ByteArray#
forall o. (State# RealWorld -&gt; o) -&gt; o
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Magic.html#runRW%23"><span class="hs-identifier hs-var">runRW#</span></a></span><span> </span><span class="annot"><span class="annottext">((State# RealWorld -&gt; ByteArray#) -&gt; ByteArray#)
-&gt; (State# RealWorld -&gt; ByteArray#) -&gt; ByteArray#
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="GHC.Internal.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679810420"><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679810420"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodedLength"><span class="hs-identifier hs-var">utf8EncodedLength</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810419"><span class="hs-identifier hs-var">str</span></a></span><span>         </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679810421"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810421"><span class="hs-identifier hs-var">len#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
-&gt; State# RealWorld
-&gt; (# State# RealWorld, MutableByteArray# RealWorld #)
forall d. Int# -&gt; State# d -&gt; (# State# d, MutableByteArray# d #)
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#newByteArray%23"><span class="hs-identifier hs-var">newByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810421"><span class="hs-identifier hs-var">len#</span></a></span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679810420"><span class="hs-identifier hs-var">s</span></a></span><span>          </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679810422"><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679810422"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679810423"><span class="annot"><span class="annottext">MutableByteArray# RealWorld
</span><a href="#local-6989586621679810423"><span class="hs-identifier hs-var">mba#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# RealWorld -&gt; Int# -&gt; [Char] -&gt; ST RealWorld ()
forall {s}. MutableByteArray# s -&gt; Int# -&gt; [Char] -&gt; ST s ()
</span><a href="#local-6989586621679810424"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# RealWorld
</span><a href="#local-6989586621679810423"><span class="hs-identifier hs-var">mba#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810419"><span class="hs-identifier hs-var">str</span></a></span><span>                </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.Internal.ST.html#ST"><span class="hs-identifier hs-type">ST</span></a></span><span> </span><span id="local-6989586621679810425"><span class="annot"><span class="annottext">STRep RealWorld ()
</span><a href="#local-6989586621679810425"><span class="hs-identifier hs-var">f_go</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STRep RealWorld ()
</span><a href="#local-6989586621679810425"><span class="hs-identifier hs-var">f_go</span></a></span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679810422"><span class="hs-identifier hs-var">s</span></a></span><span>                        </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span id="local-6989586621679810426"><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679810426"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# RealWorld
-&gt; State# RealWorld -&gt; (# State# RealWorld, ByteArray# #)
forall d.
MutableByteArray# d -&gt; State# d -&gt; (# State# d, ByteArray# #)
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#unsafeFreezeByteArray%23"><span class="hs-identifier hs-var">unsafeFreezeByteArray#</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# RealWorld
</span><a href="#local-6989586621679810423"><span class="hs-identifier hs-var">mba#</span></a></span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><a href="#local-6989586621679810426"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">(#</span><span> </span><span class="annot"><span class="annottext">State# RealWorld
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679810427"><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810427"><span class="hs-identifier hs-var">ba#</span></a></span></span><span> </span><span class="hs-special">#)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><span class="annottext">ByteArray#
</span><a href="#local-6989586621679810427"><span class="hs-identifier hs-var">ba#</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679810424"><span class="annot"><span class="annottext">go :: MutableByteArray# s -&gt; Int# -&gt; [Char] -&gt; ST s ()
</span><a href="#local-6989586621679810424"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s ()
forall a. a -&gt; ST s a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="GHC.Internal.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="#local-6989586621679810424"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679810430"><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679810430"><span class="hs-identifier hs-var">mba#</span></a></span></span><span> </span><span id="local-6989586621679810431"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810431"><span class="hs-identifier hs-var">i#</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679810432"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810432"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679810433"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810433"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span class="hs-cpp">
#if !MIN_VERSION_ghc_prim(0,10,0)
</span><span>      </span><span class="hs-comment">-- writeWord8Array# was taking a Word#</span><span>
</span><span id="line-319"></span><span>      </span><span class="hs-identifier">I#</span><span> </span><span class="hs-identifier">off#</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">utf8EncodeChar</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">j#</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">writeWord8Array#</span><span> </span><span class="hs-identifier">mba#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">i#</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-identifier">j#</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">extendWord8#</span><span> </span><span class="hs-identifier">w</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">c</span><span class="hs-cpp">
#else
</span><span>      </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#I%23"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679810434"><span class="annot"><a href="#local-6989586621679810434"><span class="hs-identifier hs-var">off#</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Int# -&gt; Word8# -&gt; State# s -&gt; State# s) -&gt; Char -&gt; ST s Int
forall s.
(Int# -&gt; Word8# -&gt; State# s -&gt; State# s) -&gt; Char -&gt; ST s Int
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodeChar"><span class="hs-identifier hs-var">utf8EncodeChar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679810435"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810435"><span class="hs-identifier hs-var">j#</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s -&gt; Int# -&gt; Word8# -&gt; State# s -&gt; State# s
forall d.
MutableByteArray# d -&gt; Int# -&gt; Word8# -&gt; State# d -&gt; State# d
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#writeWord8Array%23"><span class="hs-identifier hs-var">writeWord8Array#</span></a></span><span> </span><span class="annot"><span class="annottext">MutableByteArray# s
</span><a href="#local-6989586621679810430"><span class="hs-identifier hs-var">mba#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810431"><span class="hs-identifier hs-var">i#</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679810435"><span class="hs-identifier hs-var">j#</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810432"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-cpp">
#endif
</span><span>      </span><span class="annot"><a href="#local-6989586621679810424"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679810430"><span class="hs-identifier hs-type">mba#</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679810431"><span class="hs-identifier hs-type">i#</span></a></span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Prim.html#%2B%23"><span class="hs-operator hs-type">+#</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679810434"><span class="hs-identifier hs-type">off#</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679810433"><span class="hs-identifier hs-type">cs</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="annot"><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodedLength"><span class="hs-identifier hs-type">utf8EncodedLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Internal.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-326"></span><span id="utf8EncodedLength"><span class="annot"><span class="annottext">utf8EncodedLength :: [Char] -&gt; Int
</span><a href="GHC.Internal.Encoding.UTF8.html#utf8EncodedLength"><span class="hs-identifier hs-var hs-var">utf8EncodedLength</span></a></span></span><span> </span><span id="local-6989586621679810436"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810436"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; Int
forall {t}. Num t =&gt; t -&gt; [Char] -&gt; t
</span><a href="#local-6989586621679810437"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810436"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679810437"><span class="annot"><span class="annottext">go :: t -&gt; [Char] -&gt; t
</span><a href="#local-6989586621679810437"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679810456"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679810456"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679810456"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><a href="#local-6989586621679810437"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679810457"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679810457"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679810458"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810458"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="../../ghc-prim-0.13.0-e168/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679810459"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810459"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="GHC.Internal.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810458"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="GHC.Internal.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810458"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x007f</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; [Char] -&gt; t
</span><a href="#local-6989586621679810437"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679810457"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810459"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-330"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="GHC.Internal.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810458"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x07ff</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; [Char] -&gt; t
</span><a href="#local-6989586621679810437"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679810457"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810459"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-331"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="GHC.Internal.Base.html#ord"><span class="hs-identifier hs-var">ord</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679810458"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xffff</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; [Char] -&gt; t
</span><a href="#local-6989586621679810437"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679810457"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810459"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-332"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="GHC.Internal.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; [Char] -&gt; t
</span><a href="#local-6989586621679810437"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679810457"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="GHC.Internal.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679810459"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-333"></span></pre></body></html>