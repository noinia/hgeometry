<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  Distribution.PackageDescription.Check.Conditional</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  Lennart Kolmodin 2008, Francesco Ariis 2023</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  BSD3</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  cabal-devel@haskell.org</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Checks on conditional targets (libraries, executables, etc. that are</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- still inside a CondTree and related checks that can only be performed</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- here (variables, duplicated modules).</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html"><span class="hs-identifier">Distribution.PackageDescription.Check.Conditional</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#checkCondTarget"><span class="hs-identifier">checkCondTarget</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#checkDuplicateModules"><span class="hs-identifier">checkDuplicateModules</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html"><span class="hs-identifier">Distribution.Compat.Prelude</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html"><span class="hs-identifier">Distribution.Compiler</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.ModuleName.html"><span class="hs-identifier">Distribution.ModuleName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.ModuleName.html#ModuleName"><span class="hs-identifier">ModuleName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html"><span class="hs-identifier">Distribution.Package</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.html"><span class="hs-identifier">Distribution.PackageDescription</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html"><span class="hs-identifier">Distribution.PackageDescription.Check.Monad</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html"><span class="hs-identifier">Distribution.System</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- As a prerequisite to some checks, we transform a target CondTree into</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- a CondTree of &#8220;target + useful context&#8221;.</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- This is slightly clearer, is easier to walk without resorting to</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- list comprehensions, allows us in the future to apply some sensible</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- &#8220;optimisations&#8221; to checks (exclusive branches, etc.).</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | @nf@ function is needed to appropriately name some targets which need</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- to be spoonfed (otherwise name appears as &quot;&quot;).</span><span>
</span><span id="line-41"></span><span id="local-6989586621679518158"><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#initTargetAnnotation"><span class="hs-identifier hs-type">initTargetAnnotation</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679518158"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnqualComponentName.html#UnqualComponentName"><span class="hs-identifier hs-type">UnqualComponentName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679518158"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679518158"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Naming function for targets.</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnqualComponentName.html#UnqualComponentName"><span class="hs-identifier hs-type">UnqualComponentName</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518158"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-46"></span><span id="initTargetAnnotation"><span class="annot"><span class="annottext">initTargetAnnotation :: forall a.
Monoid a =&gt;
(UnqualComponentName -&gt; a -&gt; a)
-&gt; UnqualComponentName -&gt; TargetAnnotation a
</span><a href="Distribution.PackageDescription.Check.Conditional.html#initTargetAnnotation"><span class="hs-identifier hs-var hs-var">initTargetAnnotation</span></a></span></span><span> </span><span id="local-6989586621679518318"><span class="annot"><span class="annottext">UnqualComponentName -&gt; a -&gt; a
</span><a href="#local-6989586621679518318"><span class="hs-identifier hs-var">nf</span></a></span></span><span> </span><span id="local-6989586621679518319"><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679518319"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool -&gt; TargetAnnotation a
forall a. a -&gt; Bool -&gt; TargetAnnotation a
</span><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-var">TargetAnnotation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnqualComponentName -&gt; a -&gt; a
</span><a href="#local-6989586621679518318"><span class="hs-identifier hs-var">nf</span></a></span><span> </span><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679518319"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><span class="hs-comment">-- | We &#8220;build up&#8221; target from various slices.</span></span><span>
</span><span id="line-49"></span><span id="local-6989586621679518164"><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#updateTargetAnnotation"><span class="hs-identifier hs-type">updateTargetAnnotation</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679518164"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679518164"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- A target (lib, exe, test, &#8230;)</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518164"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518164"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-54"></span><span id="updateTargetAnnotation"><span class="annot"><span class="annottext">updateTargetAnnotation :: forall a. Monoid a =&gt; a -&gt; TargetAnnotation a -&gt; TargetAnnotation a
</span><a href="Distribution.PackageDescription.Check.Conditional.html#updateTargetAnnotation"><span class="hs-identifier hs-var hs-var">updateTargetAnnotation</span></a></span></span><span> </span><span id="local-6989586621679518326"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518326"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679518327"><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518327"><span class="hs-identifier hs-var">ta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518327"><span class="hs-identifier hs-var">ta</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#taTarget"><span class="hs-identifier hs-var">taTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#taTarget"><span class="hs-identifier hs-var">taTarget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518327"><span class="hs-identifier hs-type">ta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679518326"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | Before walking a target 'CondTree', we need to annotate it with</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- information relevant to the checks (read 'TaraAnn' and 'checkCondTarget'</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- doc for more info).</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#annotateCondTree"><span class="hs-identifier hs-type">annotateCondTree</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679518168"><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-61"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#PackageFlag"><span class="hs-identifier hs-type">PackageFlag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- User flags.</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondTree"><span class="hs-identifier hs-type">CondTree</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondTree"><span class="hs-identifier hs-type">CondTree</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span id="annotateCondTree"><span class="annot"><span class="annottext">annotateCondTree :: forall a.
(Eq a, Monoid a) =&gt;
[PackageFlag]
-&gt; TargetAnnotation a
-&gt; CondTree ConfVar [Dependency] a
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="Distribution.PackageDescription.Check.Conditional.html#annotateCondTree"><span class="hs-identifier hs-var hs-var">annotateCondTree</span></a></span></span><span> </span><span id="local-6989586621679518338"><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518338"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679518339"><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518339"><span class="hs-identifier hs-var">ta</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondNode"><span class="hs-identifier hs-type">CondNode</span></a></span><span> </span><span id="local-6989586621679518341"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518341"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679518342"><span class="annot"><span class="annottext">[Dependency]
</span><a href="#local-6989586621679518342"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679518343"><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] a]
</span><a href="#local-6989586621679518343"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679518346"><span class="annot"><span class="annottext">ta' :: TargetAnnotation a
</span><a href="#local-6989586621679518346"><span class="hs-identifier hs-var hs-var">ta'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; TargetAnnotation a -&gt; TargetAnnotation a
forall a. Monoid a =&gt; a -&gt; TargetAnnotation a -&gt; TargetAnnotation a
</span><a href="Distribution.PackageDescription.Check.Conditional.html#updateTargetAnnotation"><span class="hs-identifier hs-var">updateTargetAnnotation</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518341"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518339"><span class="hs-identifier hs-var">ta</span></a></span><span>
</span><span id="line-68"></span><span>      </span><span id="local-6989586621679518347"><span class="annot"><span class="annottext">bs' :: [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518347"><span class="hs-identifier hs-var hs-var">bs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CondBranch ConfVar [Dependency] a
 -&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a))
-&gt; [CondBranch ConfVar [Dependency] a]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TargetAnnotation a
-&gt; CondBranch ConfVar [Dependency] a
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518348"><span class="hs-identifier hs-var">annotateBranch</span></a></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518346"><span class="hs-identifier hs-var">ta'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] a]
</span><a href="#local-6989586621679518343"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-69"></span><span>      </span><span id="local-6989586621679518352"><span class="annot"><span class="annottext">bs'' :: [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518352"><span class="hs-identifier hs-var hs-var">bs''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PackageFlag]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
forall a.
(Eq a, Monoid a) =&gt;
[PackageFlag]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="Distribution.PackageDescription.Check.Conditional.html#crossAnnotateBranches"><span class="hs-identifier hs-var">crossAnnotateBranches</span></a></span><span> </span><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518354"><span class="hs-identifier hs-var">defTrueFlags</span></a></span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518347"><span class="hs-identifier hs-var">bs'</span></a></span><span>
</span><span id="line-70"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
-&gt; [Dependency]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
forall v c a. a -&gt; c -&gt; [CondBranch v c a] -&gt; CondTree v c a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondNode"><span class="hs-identifier hs-var">CondNode</span></a></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518346"><span class="hs-identifier hs-var">ta'</span></a></span><span> </span><span class="annot"><span class="annottext">[Dependency]
</span><a href="#local-6989586621679518342"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518352"><span class="hs-identifier hs-var">bs''</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="#local-6989586621679518348"><span class="hs-identifier hs-type">annotateBranch</span></a></span><span>
</span><span id="line-73"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-75"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span>
</span><span id="line-76"></span><span>          </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span>
</span><span id="line-77"></span><span>          </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518168"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679518348"><span class="annot"><span class="annottext">annotateBranch :: TargetAnnotation a
-&gt; CondBranch ConfVar [Dependency] a
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518348"><span class="hs-identifier hs-var hs-var">annotateBranch</span></a></span></span><span> </span><span id="local-6989586621679518355"><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518355"><span class="hs-identifier hs-var">wta</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span id="local-6989586621679518357"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518357"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679518358"><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] a
</span><a href="#local-6989586621679518358"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679518359"><span class="annot"><span class="annottext">Maybe (CondTree ConfVar [Dependency] a)
</span><a href="#local-6989586621679518359"><span class="hs-identifier hs-var">mf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679518360"><span class="annot"><span class="annottext">uf :: Bool
</span><a href="#local-6989586621679518360"><span class="hs-identifier hs-var hs-var">uf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Condition ConfVar -&gt; Bool
</span><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518357"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-81"></span><span>          </span><span id="local-6989586621679518362"><span class="annot"><span class="annottext">wta' :: TargetAnnotation a
</span><a href="#local-6989586621679518362"><span class="hs-identifier hs-var hs-var">wta'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518355"><span class="hs-identifier hs-var">wta</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#taPackageFlag"><span class="hs-identifier hs-var">taPackageFlag</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#taPackageFlag"><span class="hs-identifier hs-var">taPackageFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518355"><span class="hs-identifier hs-type">wta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621679518360"><span class="hs-identifier hs-type">uf</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-82"></span><span>          </span><span id="local-6989586621679518368"><span class="annot"><span class="annottext">atf :: TargetAnnotation a
-&gt; CondTree ConfVar [Dependency] a
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518368"><span class="hs-identifier hs-var hs-var">atf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PackageFlag]
-&gt; TargetAnnotation a
-&gt; CondTree ConfVar [Dependency] a
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
forall a.
(Eq a, Monoid a) =&gt;
[PackageFlag]
-&gt; TargetAnnotation a
-&gt; CondTree ConfVar [Dependency] a
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="Distribution.PackageDescription.Check.Conditional.html#annotateCondTree"><span class="hs-identifier hs-var">annotateCondTree</span></a></span><span> </span><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518338"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-83"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
-&gt; Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
forall v c a.
Condition v
-&gt; CondTree v c a -&gt; Maybe (CondTree v c a) -&gt; CondBranch v c a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-var">CondBranch</span></a></span><span>
</span><span id="line-84"></span><span>            </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518357"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-85"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TargetAnnotation a
-&gt; CondTree ConfVar [Dependency] a
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518368"><span class="hs-identifier hs-var">atf</span></a></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518362"><span class="hs-identifier hs-var">wta'</span></a></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] a
</span><a href="#local-6989586621679518358"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TargetAnnotation a
-&gt; CondTree ConfVar [Dependency] a
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518368"><span class="hs-identifier hs-var">atf</span></a></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518355"><span class="hs-identifier hs-var">wta</span></a></span><span> </span><span class="annot"><span class="annottext">(CondTree ConfVar [Dependency] a
 -&gt; CondTree ConfVar [Dependency] (TargetAnnotation a))
-&gt; Maybe (CondTree ConfVar [Dependency] a)
-&gt; Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (CondTree ConfVar [Dependency] a)
</span><a href="#local-6989586621679518359"><span class="hs-identifier hs-var">mf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- Note how we are passing the *old* wta</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- in the `else` branch, since we are not</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">-- under that flag.</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- We only want to pick up variables that are flags and that are</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- \*off* by default.</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="#local-6989586621679518361"><span class="hs-identifier hs-type">isPkgFlagCond</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#Condition"><span class="hs-identifier hs-type">Condition</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679518361"><span class="annot"><span class="annottext">isPkgFlagCond :: Condition ConfVar -&gt; Bool
</span><a href="#local-6989586621679518361"><span class="hs-identifier hs-var hs-var">isPkgFlagCond</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#PackageFlag"><span class="hs-identifier hs-type">PackageFlag</span></a></span><span> </span><span id="local-6989586621679518373"><span class="annot"><span class="annottext">FlagName
</span><a href="#local-6989586621679518373"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagName -&gt; [FlagName] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">FlagName
</span><a href="#local-6989586621679518373"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[FlagName]
</span><a href="#local-6989586621679518375"><span class="hs-identifier hs-var">defOffFlags</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><span class="annottext">ConfVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#CNot"><span class="hs-identifier hs-type">CNot</span></a></span><span> </span><span id="local-6989586621679518377"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518377"><span class="hs-identifier hs-var">cn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Condition ConfVar -&gt; Bool
</span><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518377"><span class="hs-identifier hs-var">cn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#CAnd"><span class="hs-identifier hs-type">CAnd</span></a></span><span> </span><span id="local-6989586621679518380"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518380"><span class="hs-identifier hs-var">ca</span></a></span></span><span> </span><span id="local-6989586621679518381"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518381"><span class="hs-identifier hs-var">cb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Condition ConfVar -&gt; Bool
</span><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518380"><span class="hs-identifier hs-var">ca</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar -&gt; Bool
</span><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518381"><span class="hs-identifier hs-var">cb</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#COr"><span class="hs-identifier hs-type">COr</span></a></span><span> </span><span id="local-6989586621679518383"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518383"><span class="hs-identifier hs-var">ca</span></a></span></span><span> </span><span id="local-6989586621679518384"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518384"><span class="hs-identifier hs-var">cb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Condition ConfVar -&gt; Bool
</span><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518383"><span class="hs-identifier hs-var">ca</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar -&gt; Bool
</span><a href="#local-6989586621679518361"><span class="hs-identifier hs-var">isPkgFlagCond</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518384"><span class="hs-identifier hs-var">cb</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- Package flags that are off by default *and* that are manual.</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679518375"><span class="annot"><span class="annottext">defOffFlags :: [FlagName]
</span><a href="#local-6989586621679518375"><span class="hs-identifier hs-var hs-var">defOffFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">(PackageFlag -&gt; FlagName) -&gt; [PackageFlag] -&gt; [FlagName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PackageFlag -&gt; FlagName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#flagName"><span class="hs-identifier hs-var">flagName</span></a></span><span> </span><span class="annot"><span class="annottext">([PackageFlag] -&gt; [FlagName]) -&gt; [PackageFlag] -&gt; [FlagName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="annottext">(PackageFlag -&gt; Bool) -&gt; [PackageFlag] -&gt; [PackageFlag]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span>
</span><span id="line-105"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679518387"><span class="annot"><span class="annottext">PackageFlag
</span><a href="#local-6989586621679518387"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-106"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageFlag -&gt; Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#flagDefault"><span class="hs-identifier hs-var">flagDefault</span></a></span><span> </span><span class="annot"><span class="annottext">PackageFlag
</span><a href="#local-6989586621679518387"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">PackageFlag -&gt; Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#flagManual"><span class="hs-identifier hs-var">flagManual</span></a></span><span> </span><span class="annot"><span class="annottext">PackageFlag
</span><a href="#local-6989586621679518387"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-108"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>          </span><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518338"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="#local-6989586621679518354"><span class="hs-identifier hs-type">defTrueFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#PackageFlag"><span class="hs-identifier hs-type">PackageFlag</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679518354"><span class="annot"><span class="annottext">defTrueFlags :: [PackageFlag]
</span><a href="#local-6989586621679518354"><span class="hs-identifier hs-var hs-var">defTrueFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PackageFlag -&gt; Bool) -&gt; [PackageFlag] -&gt; [PackageFlag]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">PackageFlag -&gt; Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#flagDefault"><span class="hs-identifier hs-var">flagDefault</span></a></span><span> </span><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518338"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- Propagate contextual information in CondTree branches. This is</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- needed as CondTree is a rosetree and not a binary tree.</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#crossAnnotateBranches"><span class="hs-identifier hs-type">crossAnnotateBranches</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679518178"><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-118"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#PackageFlag"><span class="hs-identifier hs-type">PackageFlag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- `default: true` flags.</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span id="crossAnnotateBranches"><span class="annot"><span class="annottext">crossAnnotateBranches :: forall a.
(Eq a, Monoid a) =&gt;
[PackageFlag]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="Distribution.PackageDescription.Check.Conditional.html#crossAnnotateBranches"><span class="hs-identifier hs-var hs-var">crossAnnotateBranches</span></a></span></span><span> </span><span id="local-6989586621679518398"><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518398"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679518399"><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518399"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CondBranch ConfVar [Dependency] (TargetAnnotation a)
 -&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a))
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a)
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518400"><span class="hs-identifier hs-var">crossAnnBranch</span></a></span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518399"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="#local-6989586621679518400"><span class="hs-identifier hs-type">crossAnnBranch</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679518400"><span class="annot"><span class="annottext">crossAnnBranch :: CondBranch ConfVar [Dependency] (TargetAnnotation a)
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518400"><span class="hs-identifier hs-var hs-var">crossAnnBranch</span></a></span></span><span> </span><span id="local-6989586621679518401"><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518401"><span class="hs-identifier hs-var">wr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-129"></span><span>        </span><span id="local-6989586621679518413"><span class="annot"><span class="annottext">rs :: [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518413"><span class="hs-identifier hs-var hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; Bool)
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a)
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518401"><span class="hs-identifier hs-var">wr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518399"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span id="local-6989586621679518415"><span class="annot"><span class="annottext">ts :: [a]
</span><a href="#local-6989586621679518415"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; Maybe a)
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)] -&gt; [a]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; Maybe a
</span><a href="#local-6989586621679518417"><span class="hs-identifier hs-var">realiseBranch</span></a></span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518413"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-131"></span><span>       </span><span class="hs-keyword">in</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">a
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518418"><span class="hs-identifier hs-var">updateTargetAnnBranch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679518415"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518401"><span class="hs-identifier hs-var">wr</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="#local-6989586621679518417"><span class="hs-identifier hs-type">realiseBranch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679518417"><span class="annot"><span class="annottext">realiseBranch :: CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; Maybe a
</span><a href="#local-6989586621679518417"><span class="hs-identifier hs-var hs-var">realiseBranch</span></a></span></span><span> </span><span id="local-6989586621679518419"><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518419"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-comment">-- We are only interested in True by default package flags.</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="#local-6989586621679518420"><span class="hs-identifier hs-type">realiseBranchFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-139"></span><span>        </span><span id="local-6989586621679518420"><span class="annot"><span class="annottext">realiseBranchFunction :: ConfVar -&gt; Either ConfVar Bool
</span><a href="#local-6989586621679518420"><span class="hs-identifier hs-var hs-var">realiseBranchFunction</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#PackageFlag"><span class="hs-identifier hs-type">PackageFlag</span></a></span><span> </span><span id="local-6989586621679518421"><span class="annot"><span class="annottext">FlagName
</span><a href="#local-6989586621679518421"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FlagName -&gt; [FlagName] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">FlagName
</span><a href="#local-6989586621679518421"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PackageFlag -&gt; FlagName) -&gt; [PackageFlag] -&gt; [FlagName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PackageFlag -&gt; FlagName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#flagName"><span class="hs-identifier hs-var">flagName</span></a></span><span> </span><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518398"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either ConfVar Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><a href="#local-6989586621679518420"><span class="hs-identifier hs-var">realiseBranchFunction</span></a></span><span> </span><span class="annot"><span class="annottext">ConfVar
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either ConfVar Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-141"></span><span>        </span><span id="local-6989586621679518427"><span class="annot"><span class="annottext">ms :: Maybe ([Dependency], a)
</span><a href="#local-6989586621679518427"><span class="hs-identifier hs-var hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConfVar -&gt; Either ConfVar Bool)
-&gt; CondBranch ConfVar [Dependency] a -&gt; Maybe ([Dependency], a)
forall a d v.
(Semigroup a, Semigroup d) =&gt;
(v -&gt; Either v Bool) -&gt; CondBranch v d a -&gt; Maybe (d, a)
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#simplifyCondBranch"><span class="hs-identifier hs-var">simplifyCondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">ConfVar -&gt; Either ConfVar Bool
</span><a href="#local-6989586621679518420"><span class="hs-identifier hs-var">realiseBranchFunction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TargetAnnotation a -&gt; a)
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
-&gt; CondBranch ConfVar [Dependency] a
forall a b.
(a -&gt; b)
-&gt; CondBranch ConfVar [Dependency] a
-&gt; CondBranch ConfVar [Dependency] b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a -&gt; a
forall a. TargetAnnotation a -&gt; a
</span><a href="Distribution.PackageDescription.Check.Monad.html#taTarget"><span class="hs-identifier hs-var">taTarget</span></a></span><span> </span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518419"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>       </span><span class="hs-keyword">in</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">(([Dependency], a) -&gt; a) -&gt; Maybe ([Dependency], a) -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([Dependency], a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Maybe ([Dependency], a)
</span><a href="#local-6989586621679518427"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="#local-6989586621679518418"><span class="hs-identifier hs-type">updateTargetAnnBranch</span></a></span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679518418"><span class="annot"><span class="annottext">updateTargetAnnBranch :: a
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518418"><span class="hs-identifier hs-var hs-var">updateTargetAnnBranch</span></a></span></span><span> </span><span id="local-6989586621679518430"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518430"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span id="local-6989586621679518431"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518431"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679518432"><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518432"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679518433"><span class="annot"><span class="annottext">Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
</span><a href="#local-6989586621679518433"><span class="hs-identifier hs-var">mt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679518436"><span class="annot"><span class="annottext">updateTargetAnnTree :: CondTree v c (TargetAnnotation a)
-&gt; CondTree v c (TargetAnnotation a)
</span><a href="#local-6989586621679518436"><span class="hs-identifier hs-var hs-var">updateTargetAnnTree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondNode"><span class="hs-identifier hs-type">CondNode</span></a></span><span> </span><span id="local-6989586621679518437"><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518437"><span class="hs-identifier hs-var">ka</span></a></span></span><span> </span><span id="local-6989586621679518438"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679518438"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679518439"><span class="annot"><span class="annottext">[CondBranch v c (TargetAnnotation a)]
</span><a href="#local-6989586621679518439"><span class="hs-identifier hs-var">wbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TargetAnnotation a
-&gt; c
-&gt; [CondBranch v c (TargetAnnotation a)]
-&gt; CondTree v c (TargetAnnotation a)
forall v c a. a -&gt; c -&gt; [CondBranch v c a] -&gt; CondTree v c a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondNode"><span class="hs-identifier hs-var">CondNode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; TargetAnnotation a -&gt; TargetAnnotation a
forall a. Monoid a =&gt; a -&gt; TargetAnnotation a -&gt; TargetAnnotation a
</span><a href="Distribution.PackageDescription.Check.Conditional.html#updateTargetAnnotation"><span class="hs-identifier hs-var">updateTargetAnnotation</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518430"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518437"><span class="hs-identifier hs-var">ka</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679518438"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[CondBranch v c (TargetAnnotation a)]
</span><a href="#local-6989586621679518439"><span class="hs-identifier hs-var">wbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
-&gt; Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
-&gt; CondBranch ConfVar [Dependency] (TargetAnnotation a)
forall v c a.
Condition v
-&gt; CondTree v c a -&gt; Maybe (CondTree v c a) -&gt; CondBranch v c a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-var">CondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518431"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
forall {v} {c}.
CondTree v c (TargetAnnotation a)
-&gt; CondTree v c (TargetAnnotation a)
</span><a href="#local-6989586621679518436"><span class="hs-identifier hs-var">updateTargetAnnTree</span></a></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518432"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
forall {v} {c}.
CondTree v c (TargetAnnotation a)
-&gt; CondTree v c (TargetAnnotation a)
</span><a href="#local-6989586621679518436"><span class="hs-identifier hs-var">updateTargetAnnTree</span></a></span><span> </span><span class="annot"><span class="annottext">(CondTree ConfVar [Dependency] (TargetAnnotation a)
 -&gt; CondTree ConfVar [Dependency] (TargetAnnotation a))
-&gt; Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
-&gt; Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
</span><a href="#local-6989586621679518433"><span class="hs-identifier hs-var">mt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | A conditional target is a library, exe, benchmark etc., destructured</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- in a CondTree. Traversing method: we render the branches, pass a</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- relevant context, collect checks.</span><span>
</span><span id="line-157"></span><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#checkCondTarget"><span class="hs-identifier hs-type">checkCondTarget</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679518221"><span class="annot"><a href="#local-6989586621679518221"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679518222"><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-159"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679518221"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#PackageFlag"><span class="hs-identifier hs-type">PackageFlag</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- User flags.</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#CheckM"><span class="hs-identifier hs-type">CheckM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518221"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Check function (a = target).</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnqualComponentName.html#UnqualComponentName"><span class="hs-identifier hs-type">UnqualComponentName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- Naming function (some targets</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-comment">-- need to have their name</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- spoonfed to them.</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnqualComponentName.html#UnqualComponentName"><span class="hs-identifier hs-type">UnqualComponentName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondTree"><span class="hs-identifier hs-type">CondTree</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-comment">-- Target name/condtree.</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#CheckM"><span class="hs-identifier hs-type">CheckM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518221"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span id="checkCondTarget"><span class="annot"><span class="annottext">checkCondTarget :: forall (m :: * -&gt; *) a.
(Monad m, Eq a, Monoid a) =&gt;
[PackageFlag]
-&gt; (a -&gt; CheckM m ())
-&gt; (UnqualComponentName -&gt; a -&gt; a)
-&gt; (UnqualComponentName, CondTree ConfVar [Dependency] a)
-&gt; CheckM m ()
</span><a href="Distribution.PackageDescription.Check.Conditional.html#checkCondTarget"><span class="hs-identifier hs-var hs-var">checkCondTarget</span></a></span></span><span> </span><span id="local-6989586621679518459"><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518459"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621679518460"><span class="annot"><span class="annottext">a -&gt; CheckM m ()
</span><a href="#local-6989586621679518460"><span class="hs-identifier hs-var">cf</span></a></span></span><span> </span><span id="local-6989586621679518461"><span class="annot"><span class="annottext">UnqualComponentName -&gt; a -&gt; a
</span><a href="#local-6989586621679518461"><span class="hs-identifier hs-var">nf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679518462"><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679518462"><span class="hs-identifier hs-var">unqualName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518463"><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] a
</span><a href="#local-6989586621679518463"><span class="hs-identifier hs-var">ct</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a) -&gt; CheckM m ()
</span><a href="#local-6989586621679518464"><span class="hs-identifier hs-var">wTree</span></a></span><span> </span><span class="annot"><span class="annottext">(CondTree ConfVar [Dependency] (TargetAnnotation a) -&gt; CheckM m ())
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
-&gt; CheckM m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PackageFlag]
-&gt; TargetAnnotation a
-&gt; CondTree ConfVar [Dependency] a
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
forall a.
(Eq a, Monoid a) =&gt;
[PackageFlag]
-&gt; TargetAnnotation a
-&gt; CondTree ConfVar [Dependency] a
-&gt; CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="Distribution.PackageDescription.Check.Conditional.html#annotateCondTree"><span class="hs-identifier hs-var">annotateCondTree</span></a></span><span> </span><span class="annot"><span class="annottext">[PackageFlag]
</span><a href="#local-6989586621679518459"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UnqualComponentName -&gt; a -&gt; a)
-&gt; UnqualComponentName -&gt; TargetAnnotation a
forall a.
Monoid a =&gt;
(UnqualComponentName -&gt; a -&gt; a)
-&gt; UnqualComponentName -&gt; TargetAnnotation a
</span><a href="Distribution.PackageDescription.Check.Conditional.html#initTargetAnnotation"><span class="hs-identifier hs-var">initTargetAnnotation</span></a></span><span> </span><span class="annot"><span class="annottext">UnqualComponentName -&gt; a -&gt; a
</span><a href="#local-6989586621679518461"><span class="hs-identifier hs-var">nf</span></a></span><span> </span><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679518462"><span class="hs-identifier hs-var">unqualName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] a
</span><a href="#local-6989586621679518463"><span class="hs-identifier hs-var">ct</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-comment">-- Walking the tree. Remember that CondTree is not a binary</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- tree but a /rose/tree.</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="#local-6989586621679518464"><span class="hs-identifier hs-type">wTree</span></a></span><span>
</span><span id="line-175"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondTree"><span class="hs-identifier hs-type">CondTree</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#CheckM"><span class="hs-identifier hs-type">CheckM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518221"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679518464"><span class="annot"><span class="annottext">wTree :: CondTree ConfVar [Dependency] (TargetAnnotation a) -&gt; CheckM m ()
</span><a href="#local-6989586621679518464"><span class="hs-identifier hs-var hs-var">wTree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondNode"><span class="hs-identifier hs-type">CondNode</span></a></span><span> </span><span id="local-6989586621679518465"><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518465"><span class="hs-identifier hs-var">ta</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Dependency]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679518466"><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518466"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-comment">-- There are no branches ([] == True) *or* every branch</span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-comment">-- is &#8220;simple&#8221; (i.e. missing a 'condBranchIfFalse' part).</span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-comment">-- This is convenient but not necessarily correct in all</span><span>
</span><span id="line-181"></span><span>      </span><span class="hs-comment">-- cases; a more precise way would be to check incompatibility</span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-comment">-- among simple branches conditions (or introduce a principled</span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-comment">-- `cond` construct in `.cabal` files.</span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; Bool)
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; Bool
</span><a href="#local-6989586621679518468"><span class="hs-identifier hs-var">isSimple</span></a></span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518466"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>          </span><span class="annot"><span class="annottext">(CheckCtx m -&gt; CheckCtx m) -&gt; CheckM m () -&gt; CheckM m ()
forall (m :: * -&gt; *).
Monad m =&gt;
(CheckCtx m -&gt; CheckCtx m) -&gt; CheckM m () -&gt; CheckM m ()
</span><a href="Distribution.PackageDescription.Check.Monad.html#localCM"><span class="hs-identifier hs-var">localCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TargetAnnotation a -&gt; CheckCtx m -&gt; CheckCtx m
forall (m :: * -&gt; *) a.
Monad m =&gt;
TargetAnnotation a -&gt; CheckCtx m -&gt; CheckCtx m
</span><a href="Distribution.PackageDescription.Check.Monad.html#initCheckCtx"><span class="hs-identifier hs-var">initCheckCtx</span></a></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518465"><span class="hs-identifier hs-var">ta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; CheckM m ()
</span><a href="#local-6989586621679518460"><span class="hs-identifier hs-var">cf</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; CheckM m ()) -&gt; a -&gt; CheckM m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a -&gt; a
forall a. TargetAnnotation a -&gt; a
</span><a href="Distribution.PackageDescription.Check.Monad.html#taTarget"><span class="hs-identifier hs-var">taTarget</span></a></span><span> </span><span class="annot"><span class="annottext">TargetAnnotation a
</span><a href="#local-6989586621679518465"><span class="hs-identifier hs-var">ta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>          </span><span class="annot"><span class="annottext">(CondBranch ConfVar [Dependency] (TargetAnnotation a)
 -&gt; CheckM m ())
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
-&gt; CheckM m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; CheckM m ()
</span><a href="#local-6989586621679518472"><span class="hs-identifier hs-var">wBranch</span></a></span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518466"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-comment">-- If there are T/F conditions, there is no need to check</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-comment">-- the intermediate 'TargetAnnotation' too.</span><span>
</span><span id="line-189"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>          </span><span class="annot"><span class="annottext">(CondBranch ConfVar [Dependency] (TargetAnnotation a)
 -&gt; CheckM m ())
-&gt; [CondBranch ConfVar [Dependency] (TargetAnnotation a)]
-&gt; CheckM m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; CheckM m ()
</span><a href="#local-6989586621679518472"><span class="hs-identifier hs-var">wBranch</span></a></span><span> </span><span class="annot"><span class="annottext">[CondBranch ConfVar [Dependency] (TargetAnnotation a)]
</span><a href="#local-6989586621679518466"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="#local-6989586621679518468"><span class="hs-identifier hs-type">isSimple</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679518468"><span class="annot"><span class="annottext">isSimple :: CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; Bool
</span><a href="#local-6989586621679518468"><span class="hs-identifier hs-var hs-var">isSimple</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="#local-6989586621679518468"><span class="hs-identifier hs-var">isSimple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="#local-6989586621679518472"><span class="hs-identifier hs-type">wBranch</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#TargetAnnotation"><span class="hs-identifier hs-type">TargetAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518222"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#CheckM"><span class="hs-identifier hs-type">CheckM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518221"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679518472"><span class="annot"><span class="annottext">wBranch :: CondBranch ConfVar [Dependency] (TargetAnnotation a) -&gt; CheckM m ()
</span><a href="#local-6989586621679518472"><span class="hs-identifier hs-var hs-var">wBranch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondBranch"><span class="hs-identifier hs-type">CondBranch</span></a></span><span> </span><span id="local-6989586621679518473"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518473"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679518474"><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518474"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679518475"><span class="annot"><span class="annottext">Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
</span><a href="#local-6989586621679518475"><span class="hs-identifier hs-var">mf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><span class="annottext">Condition ConfVar -&gt; CheckM m ()
forall (m :: * -&gt; *). Monad m =&gt; Condition ConfVar -&gt; CheckM m ()
</span><a href="Distribution.PackageDescription.Check.Conditional.html#checkCondVars"><span class="hs-identifier hs-var">checkCondVars</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518473"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a) -&gt; CheckM m ()
</span><a href="#local-6989586621679518464"><span class="hs-identifier hs-var">wTree</span></a></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a)
</span><a href="#local-6989586621679518474"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><span class="annottext">CheckM m ()
-&gt; (CondTree ConfVar [Dependency] (TargetAnnotation a)
    -&gt; CheckM m ())
-&gt; Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
-&gt; CheckM m ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; CheckM m ()
forall a. a -&gt; CheckM m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] (TargetAnnotation a) -&gt; CheckM m ()
</span><a href="#local-6989586621679518464"><span class="hs-identifier hs-var">wTree</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (CondTree ConfVar [Dependency] (TargetAnnotation a))
</span><a href="#local-6989586621679518475"><span class="hs-identifier hs-var">mf</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><span class="hs-comment">-- | Condvar checking (misspelled OS in if conditions, etc).</span></span><span>
</span><span id="line-207"></span><span id="local-6989586621679518237"><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#checkCondVars"><span class="hs-identifier hs-type">checkCondVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679518237"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#Condition"><span class="hs-identifier hs-type">Condition</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#CheckM"><span class="hs-identifier hs-type">CheckM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518237"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-208"></span><span id="checkCondVars"><span class="annot"><span class="annottext">checkCondVars :: forall (m :: * -&gt; *). Monad m =&gt; Condition ConfVar -&gt; CheckM m ()
</span><a href="Distribution.PackageDescription.Check.Conditional.html#checkCondVars"><span class="hs-identifier hs-var hs-var">checkCondVars</span></a></span></span><span> </span><span id="local-6989586621679518482"><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518482"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Condition ConfVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518483"><span class="annot"><span class="annottext">[ConfVar]
</span><a href="#local-6989586621679518483"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
-&gt; (ConfVar -&gt; Either ConfVar Bool)
-&gt; (Condition ConfVar, [ConfVar])
forall c d.
Condition c -&gt; (c -&gt; Either d Bool) -&gt; (Condition d, [d])
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Condition.html#simplifyCondition"><span class="hs-identifier hs-var">simplifyCondition</span></a></span><span> </span><span class="annot"><span class="annottext">Condition ConfVar
</span><a href="#local-6989586621679518482"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679518485"><span class="annot"><span class="annottext">ConfVar
</span><a href="#local-6989586621679518485"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConfVar -&gt; Either ConfVar Bool
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">ConfVar
</span><a href="#local-6989586621679518485"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">-- Using simplifyCondition is convenient and correct,</span><span>
</span><span id="line-211"></span><span>      </span><span class="hs-comment">-- if checks become more complex we can always walk</span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-comment">-- 'Condition'.</span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><span class="annottext">(ConfVar -&gt; CheckM m ()) -&gt; [ConfVar] -&gt; CheckM m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">ConfVar -&gt; CheckM m ()
forall (m :: * -&gt; *). Monad m =&gt; ConfVar -&gt; CheckM m ()
</span><a href="#local-6989586621679518486"><span class="hs-identifier hs-var">vcheck</span></a></span><span> </span><span class="annot"><span class="annottext">[ConfVar]
</span><a href="#local-6989586621679518483"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679518245"><span class="annot"><a href="#local-6989586621679518486"><span class="hs-identifier hs-type">vcheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679518245"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#ConfVar"><span class="hs-identifier hs-type">ConfVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#CheckM"><span class="hs-identifier hs-type">CheckM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518245"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679518486"><span class="annot"><span class="annottext">vcheck :: forall (m :: * -&gt; *). Monad m =&gt; ConfVar -&gt; CheckM m ()
</span><a href="#local-6989586621679518486"><span class="hs-identifier hs-var hs-var">vcheck</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#OS"><span class="hs-identifier hs-type">OS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OtherOS"><span class="hs-identifier hs-type">OtherOS</span></a></span><span> </span><span id="local-6989586621679518494"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518494"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><span class="annottext">PackageCheck -&gt; CheckM m ()
forall (m :: * -&gt; *). Monad m =&gt; PackageCheck -&gt; CheckM m ()
</span><a href="Distribution.PackageDescription.Check.Monad.html#tellP"><span class="hs-identifier hs-var">tellP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckExplanation -&gt; PackageCheck
</span><a href="Distribution.PackageDescription.Check.Warning.html#PackageDistInexcusable"><span class="hs-identifier hs-var">PackageDistInexcusable</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckExplanation -&gt; PackageCheck)
-&gt; CheckExplanation -&gt; PackageCheck
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; CheckExplanation
</span><a href="Distribution.PackageDescription.Check.Warning.html#UnknownOS"><span class="hs-identifier hs-var">UnknownOS</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518494"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="#local-6989586621679518486"><span class="hs-identifier hs-var">vcheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#Arch"><span class="hs-identifier hs-type">Arch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OtherArch"><span class="hs-identifier hs-type">OtherArch</span></a></span><span> </span><span id="local-6989586621679518500"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518500"><span class="hs-identifier hs-var">arch</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>      </span><span class="annot"><span class="annottext">PackageCheck -&gt; CheckM m ()
forall (m :: * -&gt; *). Monad m =&gt; PackageCheck -&gt; CheckM m ()
</span><a href="Distribution.PackageDescription.Check.Monad.html#tellP"><span class="hs-identifier hs-var">tellP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckExplanation -&gt; PackageCheck
</span><a href="Distribution.PackageDescription.Check.Warning.html#PackageDistInexcusable"><span class="hs-identifier hs-var">PackageDistInexcusable</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckExplanation -&gt; PackageCheck)
-&gt; CheckExplanation -&gt; PackageCheck
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; CheckExplanation
</span><a href="Distribution.PackageDescription.Check.Warning.html#UnknownArch"><span class="hs-identifier hs-var">UnknownArch</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518500"><span class="hs-identifier hs-var">arch</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="#local-6989586621679518486"><span class="hs-identifier hs-var">vcheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ConfVar.html#Impl"><span class="hs-identifier hs-type">Impl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#OtherCompiler"><span class="hs-identifier hs-type">OtherCompiler</span></a></span><span> </span><span id="local-6989586621679518504"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518504"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="annottext">PackageCheck -&gt; CheckM m ()
forall (m :: * -&gt; *). Monad m =&gt; PackageCheck -&gt; CheckM m ()
</span><a href="Distribution.PackageDescription.Check.Monad.html#tellP"><span class="hs-identifier hs-var">tellP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckExplanation -&gt; PackageCheck
</span><a href="Distribution.PackageDescription.Check.Warning.html#PackageDistInexcusable"><span class="hs-identifier hs-var">PackageDistInexcusable</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckExplanation -&gt; PackageCheck)
-&gt; CheckExplanation -&gt; PackageCheck
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; CheckExplanation
</span><a href="Distribution.PackageDescription.Check.Warning.html#UnknownCompiler"><span class="hs-identifier hs-var">UnknownCompiler</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518504"><span class="hs-identifier hs-var">os</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="#local-6989586621679518486"><span class="hs-identifier hs-var">vcheck</span></a></span><span> </span><span class="annot"><span class="annottext">ConfVar
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; CheckM m ()
forall a. a -&gt; CheckM m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- Checking duplicated modules cannot unfortunately be done in the</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- &#8220;tree checking&#8221;. This is because of the monoidal instance in some targets,</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- where e.g. merged dependencies are `nub`&#8217;d, hence losing information for</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- this particular check.</span><span>
</span><span id="line-228"></span><span class="annot"><a href="Distribution.PackageDescription.Check.Conditional.html#checkDuplicateModules"><span class="hs-identifier hs-type">checkDuplicateModules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageCheck"><span class="hs-identifier hs-type">PackageCheck</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span id="checkDuplicateModules"><span class="annot"><span class="annottext">checkDuplicateModules :: GenericPackageDescription -&gt; [PackageCheck]
</span><a href="Distribution.PackageDescription.Check.Conditional.html#checkDuplicateModules"><span class="hs-identifier hs-var hs-var">checkDuplicateModules</span></a></span></span><span> </span><span id="local-6989586621679518506"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679518506"><span class="hs-identifier hs-var">pkg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">(CondTree ConfVar [Dependency] Library -&gt; [PackageCheck])
-&gt; [CondTree ConfVar [Dependency] Library] -&gt; [PackageCheck]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] Library -&gt; [PackageCheck]
forall {v} {c}. CondTree v c Library -&gt; [PackageCheck]
</span><a href="#local-6989586621679518508"><span class="hs-identifier hs-var">checkLib</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([CondTree ConfVar [Dependency] Library]
 -&gt; [CondTree ConfVar [Dependency] Library])
-&gt; (CondTree ConfVar [Dependency] Library
    -&gt; [CondTree ConfVar [Dependency] Library]
    -&gt; [CondTree ConfVar [Dependency] Library])
-&gt; Maybe (CondTree ConfVar [Dependency] Library)
-&gt; [CondTree ConfVar [Dependency] Library]
-&gt; [CondTree ConfVar [Dependency] Library]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">[CondTree ConfVar [Dependency] Library]
-&gt; [CondTree ConfVar [Dependency] Library]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericPackageDescription
-&gt; Maybe (CondTree ConfVar [Dependency] Library)
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#condLibrary"><span class="hs-identifier hs-var">condLibrary</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679518506"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([CondTree ConfVar [Dependency] Library]
 -&gt; [CondTree ConfVar [Dependency] Library])
-&gt; ([(UnqualComponentName, CondTree ConfVar [Dependency] Library)]
    -&gt; [CondTree ConfVar [Dependency] Library])
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] Library)]
-&gt; [CondTree ConfVar [Dependency] Library]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((UnqualComponentName, CondTree ConfVar [Dependency] Library)
 -&gt; CondTree ConfVar [Dependency] Library)
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] Library)]
-&gt; [CondTree ConfVar [Dependency] Library]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(UnqualComponentName, CondTree ConfVar [Dependency] Library)
-&gt; CondTree ConfVar [Dependency] Library
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(UnqualComponentName, CondTree ConfVar [Dependency] Library)]
 -&gt; [CondTree ConfVar [Dependency] Library])
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] Library)]
-&gt; [CondTree ConfVar [Dependency] Library]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] Library)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#condSubLibraries"><span class="hs-identifier hs-var">condSubLibraries</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679518506"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">[PackageCheck] -&gt; [PackageCheck] -&gt; [PackageCheck]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(CondTree ConfVar [Dependency] Executable -&gt; [PackageCheck])
-&gt; [CondTree ConfVar [Dependency] Executable] -&gt; [PackageCheck]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] Executable -&gt; [PackageCheck]
forall {v} {c}. CondTree v c Executable -&gt; [PackageCheck]
</span><a href="#local-6989586621679518513"><span class="hs-identifier hs-var">checkExe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((UnqualComponentName, CondTree ConfVar [Dependency] Executable)
 -&gt; CondTree ConfVar [Dependency] Executable)
-&gt; [(UnqualComponentName,
     CondTree ConfVar [Dependency] Executable)]
-&gt; [CondTree ConfVar [Dependency] Executable]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(UnqualComponentName, CondTree ConfVar [Dependency] Executable)
-&gt; CondTree ConfVar [Dependency] Executable
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(UnqualComponentName, CondTree ConfVar [Dependency] Executable)]
 -&gt; [CondTree ConfVar [Dependency] Executable])
-&gt; [(UnqualComponentName,
     CondTree ConfVar [Dependency] Executable)]
-&gt; [CondTree ConfVar [Dependency] Executable]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
-&gt; [(UnqualComponentName,
     CondTree ConfVar [Dependency] Executable)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#condExecutables"><span class="hs-identifier hs-var">condExecutables</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679518506"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">[PackageCheck] -&gt; [PackageCheck] -&gt; [PackageCheck]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(CondTree ConfVar [Dependency] TestSuite -&gt; [PackageCheck])
-&gt; [CondTree ConfVar [Dependency] TestSuite] -&gt; [PackageCheck]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] TestSuite -&gt; [PackageCheck]
forall {v} {c}. CondTree v c TestSuite -&gt; [PackageCheck]
</span><a href="#local-6989586621679518515"><span class="hs-identifier hs-var">checkTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((UnqualComponentName, CondTree ConfVar [Dependency] TestSuite)
 -&gt; CondTree ConfVar [Dependency] TestSuite)
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] TestSuite)]
-&gt; [CondTree ConfVar [Dependency] TestSuite]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(UnqualComponentName, CondTree ConfVar [Dependency] TestSuite)
-&gt; CondTree ConfVar [Dependency] TestSuite
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(UnqualComponentName, CondTree ConfVar [Dependency] TestSuite)]
 -&gt; [CondTree ConfVar [Dependency] TestSuite])
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] TestSuite)]
-&gt; [CondTree ConfVar [Dependency] TestSuite]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] TestSuite)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#condTestSuites"><span class="hs-identifier hs-var">condTestSuites</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679518506"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">[PackageCheck] -&gt; [PackageCheck] -&gt; [PackageCheck]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(CondTree ConfVar [Dependency] Benchmark -&gt; [PackageCheck])
-&gt; [CondTree ConfVar [Dependency] Benchmark] -&gt; [PackageCheck]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">CondTree ConfVar [Dependency] Benchmark -&gt; [PackageCheck]
forall {v} {c}. CondTree v c Benchmark -&gt; [PackageCheck]
</span><a href="#local-6989586621679518517"><span class="hs-identifier hs-var">checkBench</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((UnqualComponentName, CondTree ConfVar [Dependency] Benchmark)
 -&gt; CondTree ConfVar [Dependency] Benchmark)
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] Benchmark)]
-&gt; [CondTree ConfVar [Dependency] Benchmark]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(UnqualComponentName, CondTree ConfVar [Dependency] Benchmark)
-&gt; CondTree ConfVar [Dependency] Benchmark
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(UnqualComponentName, CondTree ConfVar [Dependency] Benchmark)]
 -&gt; [CondTree ConfVar [Dependency] Benchmark])
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] Benchmark)]
-&gt; [CondTree ConfVar [Dependency] Benchmark]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
-&gt; [(UnqualComponentName, CondTree ConfVar [Dependency] Benchmark)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#condBenchmarks"><span class="hs-identifier hs-var">condBenchmarks</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679518506"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-comment">-- the duplicate modules check is has not been thoroughly vetted for backpack</span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621679518508"><span class="annot"><span class="annottext">checkLib :: CondTree v c Library -&gt; [PackageCheck]
</span><a href="#local-6989586621679518508"><span class="hs-identifier hs-var hs-var">checkLib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Library -&gt; [ModuleName])
-&gt; CondTree v c Library
-&gt; [PackageCheck]
forall a v c.
String -&gt; (a -&gt; [ModuleName]) -&gt; CondTree v c a -&gt; [PackageCheck]
</span><a href="#local-6989586621679518519"><span class="hs-identifier hs-var">checkDups</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;library&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679518520"><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679518520"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Library -&gt; [ModuleName]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#explicitLibModules"><span class="hs-identifier hs-var">explicitLibModules</span></a></span><span> </span><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679518520"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [ModuleName] -&gt; [ModuleName]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(ModuleReexport -&gt; ModuleName) -&gt; [ModuleReexport] -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ModuleReexport -&gt; ModuleName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ModuleReexport.html#moduleReexportName"><span class="hs-identifier hs-var">moduleReexportName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Library -&gt; [ModuleReexport]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#reexportedModules"><span class="hs-identifier hs-var">reexportedModules</span></a></span><span> </span><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679518520"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621679518513"><span class="annot"><span class="annottext">checkExe :: CondTree v c Executable -&gt; [PackageCheck]
</span><a href="#local-6989586621679518513"><span class="hs-identifier hs-var hs-var">checkExe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Executable -&gt; [ModuleName])
-&gt; CondTree v c Executable
-&gt; [PackageCheck]
forall a v c.
String -&gt; (a -&gt; [ModuleName]) -&gt; CondTree v c a -&gt; [PackageCheck]
</span><a href="#local-6989586621679518519"><span class="hs-identifier hs-var">checkDups</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;executable&quot;</span></span><span> </span><span class="annot"><span class="annottext">Executable -&gt; [ModuleName]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Executable.html#exeModules"><span class="hs-identifier hs-var">exeModules</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679518515"><span class="annot"><span class="annottext">checkTest :: CondTree v c TestSuite -&gt; [PackageCheck]
</span><a href="#local-6989586621679518515"><span class="hs-identifier hs-var hs-var">checkTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (TestSuite -&gt; [ModuleName])
-&gt; CondTree v c TestSuite
-&gt; [PackageCheck]
forall a v c.
String -&gt; (a -&gt; [ModuleName]) -&gt; CondTree v c a -&gt; [PackageCheck]
</span><a href="#local-6989586621679518519"><span class="hs-identifier hs-var">checkDups</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;test suite&quot;</span></span><span> </span><span class="annot"><span class="annottext">TestSuite -&gt; [ModuleName]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.TestSuite.html#testModules"><span class="hs-identifier hs-var">testModules</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span id="local-6989586621679518517"><span class="annot"><span class="annottext">checkBench :: CondTree v c Benchmark -&gt; [PackageCheck]
</span><a href="#local-6989586621679518517"><span class="hs-identifier hs-var hs-var">checkBench</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Benchmark -&gt; [ModuleName])
-&gt; CondTree v c Benchmark
-&gt; [PackageCheck]
forall a v c.
String -&gt; (a -&gt; [ModuleName]) -&gt; CondTree v c a -&gt; [PackageCheck]
</span><a href="#local-6989586621679518519"><span class="hs-identifier hs-var">checkDups</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;benchmark&quot;</span></span><span> </span><span class="annot"><span class="annottext">Benchmark -&gt; [ModuleName]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Benchmark.html#benchmarkModules"><span class="hs-identifier hs-var">benchmarkModules</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621679518277"><span id="local-6989586621679518278"><span id="local-6989586621679518279"><span class="annot"><a href="#local-6989586621679518519"><span class="hs-identifier hs-type">checkDups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679518277"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.ModuleName.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#CondTree"><span class="hs-identifier hs-type">CondTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518278"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518279"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518277"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageCheck"><span class="hs-identifier hs-type">PackageCheck</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679518519"><span class="annot"><span class="annottext">checkDups :: forall a v c.
String -&gt; (a -&gt; [ModuleName]) -&gt; CondTree v c a -&gt; [PackageCheck]
</span><a href="#local-6989586621679518519"><span class="hs-identifier hs-var hs-var">checkDups</span></a></span></span><span> </span><span id="local-6989586621679518529"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518529"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679518530"><span class="annot"><span class="annottext">a -&gt; [ModuleName]
</span><a href="#local-6989586621679518530"><span class="hs-identifier hs-var">getModules</span></a></span></span><span> </span><span id="local-6989586621679518531"><span class="annot"><span class="annottext">CondTree v c a
</span><a href="#local-6989586621679518531"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679518535"><span class="annot"><span class="annottext">sumPair :: (Int, Int) -&gt; (Int, Int) -&gt; (Int, Int)
</span><a href="#local-6989586621679518535"><span class="hs-identifier hs-var hs-var">sumPair</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679518536"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679518536"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518537"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679518537"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679518538"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679518538"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518539"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679518539"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679518536"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679518537"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679518538"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679518539"><span class="hs-identifier hs-var">y'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>          </span><span id="local-6989586621679518548"><span class="annot"><span class="annottext">mergePair :: (a, a) -&gt; (b, b) -&gt; (a, b)
</span><a href="#local-6989586621679518548"><span class="hs-identifier hs-var hs-var">mergePair</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679518549"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518549"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518550"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518550"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679518551"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679518551"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518552"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679518552"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518549"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518550"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679518551"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679518552"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>          </span><span id="local-6989586621679518562"><span class="annot"><span class="annottext">maxPair :: (a, a) -&gt; (b, b) -&gt; (a, b)
</span><a href="#local-6989586621679518562"><span class="hs-identifier hs-var hs-var">maxPair</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679518563"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518563"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518564"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518564"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679518565"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679518565"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518566"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679518566"><span class="hs-identifier hs-var">y'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518563"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518564"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679518565"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679518566"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>          </span><span id="local-6989586621679518576"><span class="annot"><span class="annottext">libMap :: Map ModuleName (Int, Int)
</span><a href="#local-6989586621679518576"><span class="hs-identifier hs-var hs-var">libMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>            </span><span class="annot"><span class="annottext">Map ModuleName (Int, Int)
-&gt; ((c, a) -&gt; Map ModuleName (Int, Int))
-&gt; (Map ModuleName (Int, Int)
    -&gt; Map ModuleName (Int, Int) -&gt; Map ModuleName (Int, Int))
-&gt; (Map ModuleName (Int, Int)
    -&gt; Map ModuleName (Int, Int) -&gt; Map ModuleName (Int, Int))
-&gt; CondTree v c a
-&gt; Map ModuleName (Int, Int)
forall b c a v.
b
-&gt; ((c, a) -&gt; b)
-&gt; (b -&gt; b -&gt; b)
-&gt; (b -&gt; b -&gt; b)
-&gt; CondTree v c a
-&gt; b
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.CondTree.html#foldCondTree"><span class="hs-identifier hs-var">foldCondTree</span></a></span><span>
</span><span id="line-247"></span><span>              </span><span class="annot"><span class="annottext">Map ModuleName (Int, Int)
forall k a. Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-248"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679518579"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518579"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; (Int, Int) -&gt; (Int, Int))
-&gt; [(ModuleName, (Int, Int))] -&gt; Map ModuleName (Int, Int)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#fromListWith"><span class="hs-identifier hs-var">Map.fromListWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; (Int, Int)
</span><a href="#local-6989586621679518535"><span class="hs-identifier hs-var">sumPair</span></a></span><span> </span><span class="annot"><span class="annottext">([(ModuleName, (Int, Int))] -&gt; Map ModuleName (Int, Int))
-&gt; ([ModuleName] -&gt; [(ModuleName, (Int, Int))])
-&gt; [ModuleName]
-&gt; Map ModuleName (Int, Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; (ModuleName, (Int, Int)))
-&gt; [ModuleName] -&gt; [(ModuleName, (Int, Int))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679518581"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679518581"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679518581"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; Map ModuleName (Int, Int))
-&gt; [ModuleName] -&gt; Map ModuleName (Int, Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [ModuleName]
</span><a href="#local-6989586621679518530"><span class="hs-identifier hs-var">getModules</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679518579"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Int) -&gt; (Int, Int) -&gt; (Int, Int))
-&gt; Map ModuleName (Int, Int)
-&gt; Map ModuleName (Int, Int)
-&gt; Map ModuleName (Int, Int)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#unionWith"><span class="hs-identifier hs-var">Map.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; (Int, Int)
forall {a} {b}. (Num a, Ord b) =&gt; (a, a) -&gt; (b, b) -&gt; (a, b)
</span><a href="#local-6989586621679518548"><span class="hs-identifier hs-var">mergePair</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- if a module may occur in nonexclusive branches count it twice strictly and once loosely.</span><span>
</span><span id="line-250"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Int) -&gt; (Int, Int) -&gt; (Int, Int))
-&gt; Map ModuleName (Int, Int)
-&gt; Map ModuleName (Int, Int)
-&gt; Map ModuleName (Int, Int)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#unionWith"><span class="hs-identifier hs-var">Map.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; (Int, Int)
forall {a} {b}. (Ord a, Ord b) =&gt; (a, a) -&gt; (b, b) -&gt; (a, b)
</span><a href="#local-6989586621679518562"><span class="hs-identifier hs-var">maxPair</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- a module occurs the max of times it might appear in exclusive branches</span><span>
</span><span id="line-251"></span><span>              </span><span class="annot"><span class="annottext">CondTree v c a
</span><a href="#local-6989586621679518531"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-252"></span><span>          </span><span id="local-6989586621679518585"><span class="annot"><span class="annottext">dupLibsStrict :: [ModuleName]
</span><a href="#local-6989586621679518585"><span class="hs-identifier hs-var hs-var">dupLibsStrict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ModuleName (Int, Int) -&gt; [ModuleName]
forall k a. Map k a -&gt; [k]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">Map.keys</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ModuleName (Int, Int) -&gt; [ModuleName])
-&gt; Map ModuleName (Int, Int) -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool)
-&gt; Map ModuleName (Int, Int) -&gt; Map ModuleName (Int, Int)
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">Map.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map ModuleName (Int, Int)
</span><a href="#local-6989586621679518576"><span class="hs-identifier hs-var">libMap</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span id="local-6989586621679518592"><span class="annot"><span class="annottext">dupLibsLax :: [ModuleName]
</span><a href="#local-6989586621679518592"><span class="hs-identifier hs-var hs-var">dupLibsLax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ModuleName (Int, Int) -&gt; [ModuleName]
forall k a. Map k a -&gt; [k]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">Map.keys</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ModuleName (Int, Int) -&gt; [ModuleName])
-&gt; Map ModuleName (Int, Int) -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Bool)
-&gt; Map ModuleName (Int, Int) -&gt; Map ModuleName (Int, Int)
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">Map.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; ((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map ModuleName (Int, Int)
</span><a href="#local-6989586621679518576"><span class="hs-identifier hs-var">libMap</span></a></span><span>
</span><span id="line-254"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ModuleName] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621679518592"><span class="hs-identifier hs-var">dupLibsLax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>            </span><span class="hs-keyword">then</span><span>
</span><span id="line-256"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CheckExplanation -&gt; PackageCheck
</span><a href="Distribution.PackageDescription.Check.Warning.html#PackageBuildImpossible"><span class="hs-identifier hs-var">PackageBuildImpossible</span></a></span><span>
</span><span id="line-257"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [ModuleName] -&gt; CheckExplanation
</span><a href="Distribution.PackageDescription.Check.Warning.html#DuplicateModule"><span class="hs-identifier hs-var">DuplicateModule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518529"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621679518592"><span class="hs-identifier hs-var">dupLibsLax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-259"></span><span>            </span><span class="hs-keyword">else</span><span>
</span><span id="line-260"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ModuleName] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621679518585"><span class="hs-identifier hs-var">dupLibsStrict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>                </span><span class="hs-keyword">then</span><span>
</span><span id="line-262"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">CheckExplanation -&gt; PackageCheck
</span><a href="Distribution.PackageDescription.Check.Warning.html#PackageDistSuspicious"><span class="hs-identifier hs-var">PackageDistSuspicious</span></a></span><span>
</span><span id="line-263"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [ModuleName] -&gt; CheckExplanation
</span><a href="Distribution.PackageDescription.Check.Warning.html#PotentialDupModule"><span class="hs-identifier hs-var">PotentialDupModule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679518529"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621679518585"><span class="hs-identifier hs-var">dupLibsStrict</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-265"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-266"></span></pre></body></html>