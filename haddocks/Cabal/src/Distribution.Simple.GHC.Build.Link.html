<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html"><span class="hs-identifier">Distribution.Simple.GHC.Build.Link</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html"><span class="hs-identifier">Distribution.Compat.Prelude</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.IO.Class.html"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Binary.html"><span class="hs-identifier">Distribution.Compat.Binary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encode</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Compat.ResponseFile.html"><span class="hs-identifier">Distribution.Compat.ResponseFile</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.InstalledPackageInfo.html"><span class="hs-identifier">Distribution.InstalledPackageInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier">InstalledPackageInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.InstalledPackageInfo.html"><span class="hs-identifier">Distribution.InstalledPackageInfo</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IPI</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.InstalledPackageInfo.html"><span class="hs-identifier">Distribution.InstalledPackageInfo</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InstalledPackageInfo</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.ModuleName.html"><span class="hs-identifier">Distribution.ModuleName</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ModuleName</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html"><span class="hs-identifier">Distribution.Package</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.html"><span class="hs-identifier">Distribution.PackageDescription</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PD</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.Utils.html"><span class="hs-identifier">Distribution.PackageDescription.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.Utils.html#cabalBug"><span class="hs-identifier">cabalBug</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html"><span class="hs-identifier">Distribution.Pretty</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Build.Inputs.html"><span class="hs-identifier">Distribution.Simple.Build.Inputs</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildPaths.html"><span class="hs-identifier">Distribution.Simple.BuildPaths</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html"><span class="hs-identifier">Distribution.Simple.Compiler</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Modules.html"><span class="hs-identifier">Distribution.Simple.GHC.Build.Modules</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Utils.html"><span class="hs-identifier">Distribution.Simple.GHC.Build.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.GHC.Build.Utils.html#exeTargetName"><span class="hs-identifier">exeTargetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Utils.html#flibBuildName"><span class="hs-identifier">flibBuildName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Utils.html#flibTargetName"><span class="hs-identifier">flibTargetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Utils.html#withDynFLib"><span class="hs-identifier">withDynFLib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.ImplInfo.html"><span class="hs-identifier">Distribution.Simple.GHC.ImplInfo</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Internal.html"><span class="hs-identifier">Distribution.Simple.GHC.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Internal</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.LocalBuildInfo.html"><span class="hs-identifier">Distribution.Simple.LocalBuildInfo</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html"><span class="hs-identifier">Distribution.Simple.PackageIndex</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PackageIndex</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.PreProcess.Types.html"><span class="hs-identifier">Distribution.Simple.PreProcess.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.html"><span class="hs-identifier">Distribution.Simple.Program</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Ar.html"><span class="hs-identifier">Distribution.Simple.Program.Ar</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ar</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html"><span class="hs-identifier">Distribution.Simple.Program.GHC</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Ld.html"><span class="hs-identifier">Distribution.Simple.Program.Ld</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ld</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Common.html"><span class="hs-identifier">Distribution.Simple.Setup.Common</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html"><span class="hs-identifier">Distribution.Simple.Setup.Config</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Repl.html"><span class="hs-identifier">Distribution.Simple.Setup.Repl</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Utils.html"><span class="hs-identifier">Distribution.Simple.Utils</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html"><span class="hs-identifier">Distribution.System</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Types.ComponentLocalBuildInfo.html"><span class="hs-identifier">Distribution.Types.ComponentLocalBuildInfo</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html"><span class="hs-identifier">Distribution.Utils.NubList</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html"><span class="hs-identifier">Distribution.Utils.Path</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html"><span class="hs-identifier">Distribution.Verbosity</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Version.html"><span class="hs-identifier">Distribution.Version</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html"><span class="hs-identifier">System.Directory</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#createDirectoryIfMissing"><span class="hs-identifier">createDirectoryIfMissing</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesDirectoryExist"><span class="hs-identifier">doesDirectoryExist</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesFileExist"><span class="hs-identifier">doesFileExist</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#removeFile"><span class="hs-identifier">removeFile</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#renameFile"><span class="hs-identifier">renameFile</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.html"><span class="hs-identifier">System.FilePath</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.Posix.html#isRelative"><span class="hs-identifier">isRelative</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.Posix.html#replaceExtension"><span class="hs-identifier">replaceExtension</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Links together the object files of the Haskell modules and extra sources</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- using the context in which the component is being built.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- If the build kind is 'BuildRepl', we load the component into GHCi instead of linking.</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#linkOrLoadComponent"><span class="hs-identifier hs-type">linkOrLoadComponent</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Types.html#ConfiguredProgram"><span class="hs-identifier hs-type">ConfiguredProgram</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The configured GHC program that will be used for linking</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The package description containing the component being built</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-comment">-- ^ The full list of extra build sources (all C, C++, Js,</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-comment">-- Asm, and Cmm sources), which were compiled to object</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- files.</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Artifacts"><span class="hs-identifier hs-type">Artifacts</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Build"><span class="hs-identifier hs-type">Build</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">-- ^ The build target dir, and the target dir.</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">-- See Note [Build Target Dir vs Target Dir] in Distribution.Simple.GHC.Build</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">-- ^ The set of build ways wanted based on the user opts, and a function to</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-comment">-- convert a build way into the set of ghc options that were used to build</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">-- that way.</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Build.Inputs.html#PreBuildComponentInputs"><span class="hs-identifier hs-type">PreBuildComponentInputs</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The context and component being built in it.</span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span id="linkOrLoadComponent"><span class="annot"><span class="annottext">linkOrLoadComponent :: ConfiguredProgram
-&gt; PackageDescription
-&gt; [SymbolicPath Pkg 'File]
-&gt; (SymbolicPath Pkg ('Dir Artifacts),
    SymbolicPath Pkg ('Dir Build))
-&gt; ((Bool -&gt; [BuildWay], Bool -&gt; BuildWay, BuildWay),
    BuildWay -&gt; GhcOptions)
-&gt; PreBuildComponentInputs
-&gt; IO ()
</span><a href="Distribution.Simple.GHC.Build.Link.html#linkOrLoadComponent"><span class="hs-identifier hs-var hs-var">linkOrLoadComponent</span></a></span></span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679553172"><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679553172"><span class="hs-identifier hs-var">ghcProg</span></a></span></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679553173"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679553173"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679553174"><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553174"><span class="hs-identifier hs-var">extraSources</span></a></span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679553175"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553175"><span class="hs-identifier hs-var">buildTargetDir</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553176"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
</span><a href="#local-6989586621679553176"><span class="hs-identifier hs-var">targetDir</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679553177"><span class="annot"><span class="annottext">Bool -&gt; [BuildWay]
</span><a href="#local-6989586621679553177"><span class="hs-identifier hs-var">wantedLibWays</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553178"><span class="annot"><span class="annottext">Bool -&gt; BuildWay
</span><a href="#local-6989586621679553178"><span class="hs-identifier hs-var">wantedFLibWay</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553179"><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553179"><span class="hs-identifier hs-var">wantedExeWay</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553180"><span class="annot"><span class="annottext">BuildWay -&gt; GhcOptions
</span><a href="#local-6989586621679553180"><span class="hs-identifier hs-var">buildOpts</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621679553181"><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-92"></span><span>      </span><span id="local-6989586621679553182"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679553182"><span class="hs-identifier hs-var hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; Verbosity
</span><a href="Distribution.Simple.Build.Inputs.html#buildVerbosity"><span class="hs-identifier hs-var">buildVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span id="local-6989586621679553184"><span class="annot"><span class="annottext">target :: TargetInfo
</span><a href="#local-6989586621679553184"><span class="hs-identifier hs-var hs-var hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; TargetInfo
</span><a href="Distribution.Simple.Build.Inputs.html#targetInfo"><span class="hs-identifier hs-var">targetInfo</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span id="local-6989586621679553186"><span class="annot"><span class="annottext">component :: Component
</span><a href="#local-6989586621679553186"><span class="hs-identifier hs-var hs-var hs-var">component</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; Component
</span><a href="Distribution.Simple.Build.Inputs.html#buildComponent"><span class="hs-identifier hs-var">buildComponent</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-95"></span><span>      </span><span id="local-6989586621679553188"><span class="annot"><span class="annottext">what :: BuildingWhat
</span><a href="#local-6989586621679553188"><span class="hs-identifier hs-var hs-var hs-var">what</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; BuildingWhat
</span><a href="Distribution.Simple.Build.Inputs.html#buildingWhat"><span class="hs-identifier hs-var">buildingWhat</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span id="local-6989586621679553190"><span class="annot"><span class="annottext">lbi :: LocalBuildInfo
</span><a href="#local-6989586621679553190"><span class="hs-identifier hs-var hs-var hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; LocalBuildInfo
</span><a href="Distribution.Simple.Build.Inputs.html#localBuildInfo"><span class="hs-identifier hs-var">localBuildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span id="local-6989586621679553192"><span class="annot"><span class="annottext">bi :: BuildInfo
</span><a href="#local-6989586621679553192"><span class="hs-identifier hs-var hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; BuildInfo
</span><a href="Distribution.Simple.Build.Inputs.html#buildBI"><span class="hs-identifier hs-var">buildBI</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-98"></span><span>      </span><span id="local-6989586621679553194"><span class="annot"><span class="annottext">clbi :: ComponentLocalBuildInfo
</span><a href="#local-6989586621679553194"><span class="hs-identifier hs-var hs-var hs-var">clbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; ComponentLocalBuildInfo
</span><a href="Distribution.Simple.Build.Inputs.html#buildCLBI"><span class="hs-identifier hs-var">buildCLBI</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span id="local-6989586621679553196"><span class="annot"><span class="annottext">isIndef :: Bool
</span><a href="#local-6989586621679553196"><span class="hs-identifier hs-var hs-var hs-var">isIndef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentIsIndefinite"><span class="hs-identifier hs-var">componentIsIndefinite</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553194"><span class="hs-identifier hs-var">clbi</span></a></span><span>
</span><span id="line-100"></span><span>      </span><span id="local-6989586621679553198"><span class="annot"><span class="annottext">mbWorkDir :: Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679553198"><span class="hs-identifier hs-var hs-var hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.LocalBuildInfo.html#mbWorkDirLBI"><span class="hs-identifier hs-var">mbWorkDirLBI</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553190"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-comment">-- See Note [Symbolic paths] in Distribution.Utils.Path</span><span>
</span><span id="line-103"></span><span>      </span><span id="local-6989586621679553200"><span class="annot"><span class="annottext">i :: SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
</span><a href="#local-6989586621679553200"><span class="hs-identifier hs-var hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
forall (allowAbsolute :: AllowAbsolute) (to :: FileOrDir).
LocalBuildInfo -&gt; SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
</span><a href="Distribution.Simple.LocalBuildInfo.html#interpretSymbolicPathLBI"><span class="hs-identifier hs-var">interpretSymbolicPathLBI</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553190"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- ensure extra lib dirs exist before passing to ghc</span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679553202"><span class="annot"><a href="#local-6989586621679553202"><span class="hs-identifier hs-var">cleanedExtraLibDirs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [SymbolicPath Pkg ('Dir Lib)]
-&gt; IO [SymbolicPath Pkg ('Dir Lib)]
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [SymbolicPath Pkg ('Dir Lib)]
 -&gt; IO [SymbolicPath Pkg ('Dir Lib)])
-&gt; IO [SymbolicPath Pkg ('Dir Lib)]
-&gt; IO [SymbolicPath Pkg ('Dir Lib)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SymbolicPath Pkg ('Dir Lib) -&gt; IO Bool)
-&gt; [SymbolicPath Pkg ('Dir Lib)]
-&gt; IO [SymbolicPath Pkg ('Dir Lib)]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesDirectoryExist"><span class="hs-identifier hs-var">doesDirectoryExist</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Bool)
-&gt; (SymbolicPath Pkg ('Dir Lib) -&gt; FilePath)
-&gt; SymbolicPath Pkg ('Dir Lib)
-&gt; IO Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Lib) -&gt; FilePath
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
</span><a href="#local-6989586621679553200"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPath Pkg ('Dir Lib)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirs"><span class="hs-identifier hs-var">extraLibDirs</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679553192"><span class="hs-identifier hs-var">bi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679553207"><span class="annot"><a href="#local-6989586621679553207"><span class="hs-identifier hs-var">cleanedExtraLibDirsStatic</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">liftIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesDirectoryExist"><span class="hs-identifier hs-type">doesDirectoryExist</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621679553200"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirsStatic"><span class="hs-identifier hs-var">extraLibDirsStatic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553192"><span class="hs-identifier hs-type">bi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><a href="#local-6989586621679553209"><span class="hs-identifier hs-type">extraSourcesObjs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#RelativePath"><span class="hs-identifier hs-type">RelativePath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Artifacts"><span class="hs-identifier hs-type">Artifacts</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span>      </span><span id="local-6989586621679553209"><span class="annot"><a href="#local-6989586621679553209"><span class="hs-identifier hs-var hs-var">extraSourcesObjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts 'File
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; RelativePath Artifacts 'File)
-&gt; FilePath -&gt; RelativePath Artifacts 'File
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File -&gt; FilePath
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553212"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.Posix.html#replaceExtension"><span class="hs-operator hs-var">`replaceExtension`</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Distribution.Simple.BuildPaths.html#objExtension"><span class="hs-identifier hs-var">objExtension</span></a></span><span>
</span><span id="line-113"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679553212"><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553212"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553174"><span class="hs-identifier hs-var">extraSources</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-comment">-- TODO: Shouldn't we use withStaticLib for libraries and something else</span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-comment">-- for foreign libs in the three cases where we use `withFullyStaticExe` below?</span><span>
</span><span id="line-118"></span><span>      </span><span id="local-6989586621679553225"><span class="annot"><a href="#local-6989586621679553225"><span class="hs-identifier hs-var hs-var">linkerOpts</span></a></span></span><span> </span><span id="local-6989586621679553226"><span class="annot"><span class="annottext">NubListR FilePath
</span><a href="#local-6989586621679553226"><span class="hs-identifier hs-var">rpaths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="annottext">GhcOptions
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-120"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkOptions"><span class="hs-identifier hs-var">ghcOptLinkOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#ldOptions"><span class="hs-identifier hs-var">PD.ldOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553192"><span class="hs-identifier hs-type">bi</span></a></span><span>
</span><span id="line-122"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-string">&quot;-static&quot;</span></span><span>
</span><span id="line-123"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#withFullyStaticExe"><span class="hs-identifier hs-var">withFullyStaticExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553190"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-124"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>                </span><span class="hs-comment">-- Pass extra `ld-options` given</span><span>
</span><span id="line-126"></span><span>                </span><span class="hs-comment">-- through to GHC's linker.</span><span>
</span><span id="line-127"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">maybe</span></span><span>
</span><span id="line-128"></span><span>                  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span>                  </span><span class="annot"><a href="Distribution.Simple.Program.Types.html#programOverrideArgs"><span class="hs-identifier hs-var">programOverrideArgs</span></a></span><span>
</span><span id="line-130"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.Db.html#lookupProgram"><span class="hs-identifier hs-type">lookupProgram</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Builtin.html#ldProgram"><span class="hs-identifier hs-type">ldProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#withPrograms"><span class="hs-identifier hs-var">withPrograms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553190"><span class="hs-identifier hs-type">lbi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibs"><span class="hs-identifier hs-var">ghcOptLinkLibs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#withFullyStaticExe"><span class="hs-identifier hs-var">withFullyStaticExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553190"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-133"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibsStatic"><span class="hs-identifier hs-var">extraLibsStatic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553192"><span class="hs-identifier hs-type">bi</span></a></span><span>
</span><span id="line-134"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibs"><span class="hs-identifier hs-var">extraLibs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553192"><span class="hs-identifier hs-type">bi</span></a></span><span>
</span><span id="line-135"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibPath"><span class="hs-identifier hs-var">ghcOptLinkLibPath</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>              </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-137"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#withFullyStaticExe"><span class="hs-identifier hs-var">withFullyStaticExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553190"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-138"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621679553207"><span class="hs-identifier hs-type">cleanedExtraLibDirsStatic</span></a></span><span>
</span><span id="line-139"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679553202"><span class="hs-identifier hs-type">cleanedExtraLibDirs</span></a></span><span>
</span><span id="line-140"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkFrameworks"><span class="hs-identifier hs-var">ghcOptLinkFrameworks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-type">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#frameworks"><span class="hs-identifier hs-var">PD.frameworks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553192"><span class="hs-identifier hs-type">bi</span></a></span><span>
</span><span id="line-141"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkFrameworkDirs"><span class="hs-identifier hs-var">ghcOptLinkFrameworkDirs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraFrameworkDirs"><span class="hs-identifier hs-var">PD.extraFrameworkDirs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553192"><span class="hs-identifier hs-type">bi</span></a></span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputFiles"><span class="hs-identifier hs-var">ghcOptInputFiles</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>              </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span>
</span><span id="line-144"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#coerceSymbolicPath"><span class="hs-identifier hs-type">coerceSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679553175"><span class="hs-identifier hs-type">buildTargetDir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-type">&lt;/&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553247"><span class="hs-identifier hs-type">obj</span></a></span><span>
</span><span id="line-145"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679553247"><span class="annot"><a href="#local-6989586621679553247"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679553209"><span class="hs-identifier hs-type">extraSourcesObjs</span></a></span><span>
</span><span id="line-146"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptNoLink"><span class="hs-identifier hs-var">ghcOptNoLink</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-148"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptRPaths"><span class="hs-identifier hs-var">ghcOptRPaths</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679553226"><span class="hs-identifier hs-type">rpaths</span></a></span><span>
</span><span id="line-149"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679553188"><span class="hs-identifier hs-type">what</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Setup.html#BuildRepl"><span class="hs-identifier hs-type">BuildRepl</span></a></span><span> </span><span id="local-6989586621679553251"><span class="annot"><span class="annottext">ReplFlags
</span><a href="#local-6989586621679553251"><span class="hs-identifier hs-var">replFlags</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-154"></span><span>          </span><span class="hs-comment">-- For repl we use the vanilla (static) ghc options</span><span>
</span><span id="line-155"></span><span>          </span><span id="local-6989586621679553252"><span class="annot"><span class="annottext">staticOpts :: GhcOptions
</span><a href="#local-6989586621679553252"><span class="hs-identifier hs-var hs-var hs-var">staticOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuildWay -&gt; GhcOptions
</span><a href="#local-6989586621679553180"><span class="hs-identifier hs-var">buildOpts</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#StaticWay"><span class="hs-identifier hs-var">StaticWay</span></a></span><span>
</span><span id="line-156"></span><span>          </span><span id="local-6989586621679553262"><span class="annot"><span class="annottext">replOpts :: GhcOptions
</span><a href="#local-6989586621679553262"><span class="hs-identifier hs-var hs-var hs-var">replOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>            </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553252"><span class="hs-identifier hs-var">staticOpts</span></a></span><span>
</span><span id="line-158"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- Repl options use Static as the base, but doesn't need to pass -static.</span><span>
</span><span id="line-159"></span><span>                </span><span class="hs-comment">-- However, it maybe should, for uniformity.</span><span>
</span><span id="line-160"></span><span>                </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptDynLinkMode"><span class="hs-identifier hs-var">ghcOptDynLinkMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#NoFlag"><span class="hs-identifier hs-type">NoFlag</span></a></span><span>
</span><span id="line-161"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptExtra"><span class="hs-identifier hs-var">ghcOptExtra</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>                  </span><span class="annot"><a href="Distribution.Simple.GHC.Internal.html#filterGhciFlags"><span class="hs-identifier hs-type">Internal.filterGhciFlags</span></a></span><span>
</span><span id="line-163"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptExtra"><span class="hs-identifier hs-var">ghcOptExtra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553252"><span class="hs-identifier hs-type">staticOpts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>                    </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Repl.html#replOptionsFlags"><span class="hs-identifier hs-var">replOptionsFlags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Repl.html#replReplOptions"><span class="hs-identifier hs-var">replReplOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553251"><span class="hs-identifier hs-type">replFlags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-166"></span><span>              </span><span class="hs-comment">-- For a normal compile we do separate invocations of ghc for</span><span>
</span><span id="line-167"></span><span>              </span><span class="hs-comment">-- compiling as for linking. But for repl we have to do just</span><span>
</span><span id="line-168"></span><span>              </span><span class="hs-comment">-- the one invocation, so that one has to include all the</span><span>
</span><span id="line-169"></span><span>              </span><span class="hs-comment">-- linker stuff too, like -l flags and any .o files from C</span><span>
</span><span id="line-170"></span><span>              </span><span class="hs-comment">-- files etc.</span><span>
</span><span id="line-171"></span><span>              </span><span class="hs-comment">--</span><span>
</span><span id="line-172"></span><span>              </span><span class="hs-comment">-- TODO: The repl doesn't use the runtime paths from linkerOpts</span><span>
</span><span id="line-173"></span><span>              </span><span class="hs-comment">-- (ghcOptRPaths), which looks like a bug. After the refactor we</span><span>
</span><span id="line-174"></span><span>              </span><span class="hs-comment">-- can fix this.</span><span>
</span><span id="line-175"></span><span>              </span><span class="annot"><span class="annottext">GhcOptions -&gt; GhcOptions -&gt; GhcOptions
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">NubListR FilePath -&gt; GhcOptions
</span><a href="#local-6989586621679553225"><span class="hs-identifier hs-var">linkerOpts</span></a></span><span> </span><span class="annot"><span class="annottext">NubListR FilePath
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-176"></span><span>              </span><span class="annot"><span class="annottext">GhcOptions -&gt; GhcOptions -&gt; GhcOptions
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">GhcOptions
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-177"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptMode"><span class="hs-identifier hs-var">ghcOptMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcModeInteractive"><span class="hs-identifier hs-type">GhcModeInteractive</span></a></span><span>
</span><span id="line-178"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptOptimisation"><span class="hs-identifier hs-var">ghcOptOptimisation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcNoOptimisation"><span class="hs-identifier hs-type">GhcNoOptimisation</span></a></span><span>
</span><span id="line-179"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>          </span><span id="local-6989586621679553277"><span class="annot"><span class="annottext">replOpts_final :: GhcOptions
</span><a href="#local-6989586621679553277"><span class="hs-identifier hs-var hs-var hs-var">replOpts_final</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553262"><span class="hs-identifier hs-var">replOpts</span></a></span><span>
</span><span id="line-182"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputModules"><span class="hs-identifier hs-var">ghcOptInputModules</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#replNoLoad"><span class="hs-identifier hs-type">replNoLoad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Repl.html#replReplOptions"><span class="hs-identifier hs-var">replReplOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553251"><span class="hs-identifier hs-type">replFlags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputModules"><span class="hs-identifier hs-var">ghcOptInputModules</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553262"><span class="hs-identifier hs-type">replOpts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputFiles"><span class="hs-identifier hs-var">ghcOptInputFiles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#replNoLoad"><span class="hs-identifier hs-type">replNoLoad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Repl.html#replReplOptions"><span class="hs-identifier hs-var">replReplOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553251"><span class="hs-identifier hs-type">replFlags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputFiles"><span class="hs-identifier hs-var">ghcOptInputFiles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553262"><span class="hs-identifier hs-type">replOpts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-comment">-- TODO: problem here is we need the .c files built first, so we can load them</span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-comment">-- with ghci, but .c files can depend on .h files generated by ghc by ffi</span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-comment">-- exports.</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621679553186"><span class="hs-identifier hs-var">component</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Component.html#CLib"><span class="hs-identifier hs-type">CLib</span></a></span><span> </span><span id="local-6989586621679553282"><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679553282"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Library -&gt; ComponentLocalBuildInfo -&gt; [ModuleName]
</span><a href="Distribution.Simple.LocalBuildInfo.html#allLibModules"><span class="hs-identifier hs-var">allLibModules</span></a></span><span> </span><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679553282"><span class="hs-identifier hs-var">lib</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553194"><span class="hs-identifier hs-var">clbi</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Component
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-190"></span><span>          </span><span class="annot"><span class="annottext">Verbosity -&gt; FilePath -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553182"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;No exposed modules&quot;</span></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">ConfiguredProgram
-&gt; LocalBuildInfo
-&gt; ReplFlags
-&gt; GhcOptions
-&gt; PackageName
-&gt; TargetInfo
-&gt; IO ()
</span><a href="Distribution.Simple.GHC.Build.Link.html#runReplOrWriteFlags"><span class="hs-identifier hs-var">runReplOrWriteFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679553172"><span class="hs-identifier hs-var">ghcProg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553190"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">ReplFlags
</span><a href="#local-6989586621679553251"><span class="hs-identifier hs-var">replFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553277"><span class="hs-identifier hs-var">replOpts_final</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageIdentifier -&gt; PackageName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#pkgName"><span class="hs-identifier hs-var">pkgName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#package"><span class="hs-identifier hs-var">PD.package</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679553173"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TargetInfo
</span><a href="#local-6989586621679553184"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-192"></span><span>      </span><span id="local-6989586621679553289"><span class="annot"><span class="annottext">BuildingWhat
</span><a href="#local-6989586621679553289"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-194"></span><span>          </span><span id="local-6989586621679553290"><span class="annot"><span class="annottext">runGhcProg :: GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553290"><span class="hs-identifier hs-var hs-var">runGhcProg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; ConfiguredProgram
-&gt; Compiler
-&gt; Platform
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; GhcOptions
-&gt; IO ()
</span><a href="Distribution.Simple.Program.GHC.html#runGHC"><span class="hs-identifier hs-var">runGHC</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553182"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679553172"><span class="hs-identifier hs-var">ghcProg</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679553292"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679553293"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679553198"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span>
</span><span id="line-195"></span><span>          </span><span id="local-6989586621679553293"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621679553293"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553190"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-196"></span><span>          </span><span id="local-6989586621679553292"><span class="annot"><span class="annottext">comp :: Compiler
</span><a href="#local-6989586621679553292"><span class="hs-identifier hs-var hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553190"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-197"></span><span>          </span><span id="local-6989586621679553300"><span class="annot"><span class="annottext">get_rpaths :: Set BuildWay -&gt; IO (NubListR FilePath)
</span><a href="#local-6989586621679553300"><span class="hs-identifier hs-var hs-var">get_rpaths</span></a></span></span><span> </span><span id="local-6989586621679553301"><span class="annot"><span class="annottext">Set BuildWay
</span><a href="#local-6989586621679553301"><span class="hs-identifier hs-var">ways</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#DynWay"><span class="hs-identifier hs-var">DynWay</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay -&gt; Set BuildWay -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#member"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set BuildWay
</span><a href="#local-6989586621679553301"><span class="hs-identifier hs-var">ways</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; IO (NubListR FilePath)
</span><a href="Distribution.Simple.GHC.Build.Link.html#getRPaths"><span class="hs-identifier hs-var">getRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553181"><span class="hs-identifier hs-var">pbci</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">NubListR FilePath -&gt; IO (NubListR FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; NubListR FilePath
forall a. Ord a =&gt; [a] -&gt; NubListR a
</span><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-var">toNubListR</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>         </span><span class="hs-keyword">in</span><span>
</span><span id="line-200"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentIsIndefinite"><span class="hs-identifier hs-var">componentIsIndefinite</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553194"><span class="hs-identifier hs-var">clbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>            </span><span class="hs-comment">-- If not building dynamically, we don't pass any runtime paths.</span><span>
</span><span id="line-202"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>              </span><span class="annot"><span class="annottext">Verbosity -&gt; FilePath -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553182"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Linking...&quot;</span></span><span>
</span><span id="line-204"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553308"><span class="annot"><span class="annottext">linkExeLike :: UnqualComponentName -&gt; IO ()
</span><a href="#local-6989586621679553308"><span class="hs-identifier hs-var hs-var">linkExeLike</span></a></span></span><span> </span><span id="local-6989586621679553309"><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679553309"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-205"></span><span>                    </span><span id="local-6989586621679553310"><span class="annot"><a href="#local-6989586621679553310"><span class="hs-identifier hs-var">rpaths</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set BuildWay -&gt; IO (NubListR FilePath)
</span><a href="#local-6989586621679553300"><span class="hs-identifier hs-var">get_rpaths</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildWay -&gt; Set BuildWay
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553179"><span class="hs-identifier hs-var">wantedExeWay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>                    </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#linkExecutable"><span class="hs-identifier hs-type">linkExecutable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553225"><span class="hs-identifier hs-type">linkerOpts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553310"><span class="hs-identifier hs-type">rpaths</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553179"><span class="hs-identifier hs-type">wantedExeWay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553180"><span class="hs-identifier hs-type">buildOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679553176"><span class="hs-identifier hs-type">targetDir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553309"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553290"><span class="hs-identifier hs-type">runGhcProg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553190"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-207"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621679553186"><span class="hs-identifier hs-var">component</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-208"></span><span>                </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Component.html#CLib"><span class="hs-identifier hs-type">CLib</span></a></span><span> </span><span id="local-6989586621679553313"><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679553313"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553314"><span class="annot"><span class="annottext">libWays :: [BuildWay]
</span><a href="#local-6989586621679553314"><span class="hs-identifier hs-var hs-var hs-var">libWays</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [BuildWay]
</span><a href="#local-6989586621679553177"><span class="hs-identifier hs-var">wantedLibWays</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679553196"><span class="hs-identifier hs-var">isIndef</span></a></span><span>
</span><span id="line-210"></span><span>                  </span><span id="local-6989586621679553315"><span class="annot"><a href="#local-6989586621679553315"><span class="hs-identifier hs-var">rpaths</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set BuildWay -&gt; IO (NubListR FilePath)
</span><a href="#local-6989586621679553300"><span class="hs-identifier hs-var">get_rpaths</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[BuildWay] -&gt; Set BuildWay
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[BuildWay]
</span><a href="#local-6989586621679553314"><span class="hs-identifier hs-var">libWays</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>                  </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#linkLibrary"><span class="hs-identifier hs-type">linkLibrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553175"><span class="hs-identifier hs-type">buildTargetDir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553202"><span class="hs-identifier hs-type">cleanedExtraLibDirs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553173"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553182"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553290"><span class="hs-identifier hs-type">runGhcProg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553313"><span class="hs-identifier hs-type">lib</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553190"><span class="hs-identifier hs-type">lbi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553194"><span class="hs-identifier hs-type">clbi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553174"><span class="hs-identifier hs-type">extraSources</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553315"><span class="hs-identifier hs-type">rpaths</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553314"><span class="hs-identifier hs-type">libWays</span></a></span><span>
</span><span id="line-212"></span><span>                </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Component.html#CFLib"><span class="hs-identifier hs-type">CFLib</span></a></span><span> </span><span id="local-6989586621679553319"><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679553319"><span class="hs-identifier hs-var">flib</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553320"><span class="annot"><span class="annottext">flib_way :: BuildWay
</span><a href="#local-6989586621679553320"><span class="hs-identifier hs-var hs-var hs-var">flib_way</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; BuildWay
</span><a href="#local-6989586621679553178"><span class="hs-identifier hs-var">wantedFLibWay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; Bool
</span><a href="Distribution.Simple.GHC.Build.Utils.html#withDynFLib"><span class="hs-identifier hs-var">withDynFLib</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679553319"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>                  </span><span id="local-6989586621679553321"><span class="annot"><a href="#local-6989586621679553321"><span class="hs-identifier hs-var">rpaths</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set BuildWay -&gt; IO (NubListR FilePath)
</span><a href="#local-6989586621679553300"><span class="hs-identifier hs-var">get_rpaths</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildWay -&gt; Set BuildWay
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553320"><span class="hs-identifier hs-var">flib_way</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>                  </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#linkFLib"><span class="hs-identifier hs-type">linkFLib</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553319"><span class="hs-identifier hs-type">flib</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553192"><span class="hs-identifier hs-type">bi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553190"><span class="hs-identifier hs-type">lbi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553225"><span class="hs-identifier hs-type">linkerOpts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553321"><span class="hs-identifier hs-type">rpaths</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553320"><span class="hs-identifier hs-type">flib_way</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553180"><span class="hs-identifier hs-type">buildOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679553176"><span class="hs-identifier hs-type">targetDir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553290"><span class="hs-identifier hs-type">runGhcProg</span></a></span><span>
</span><span id="line-216"></span><span>                </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Component.html#CExe"><span class="hs-identifier hs-type">CExe</span></a></span><span> </span><span id="local-6989586621679553324"><span class="annot"><span class="annottext">Executable
</span><a href="#local-6989586621679553324"><span class="hs-identifier hs-var">exe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnqualComponentName -&gt; IO ()
</span><a href="#local-6989586621679553308"><span class="hs-identifier hs-var">linkExeLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Executable -&gt; UnqualComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Executable.html#exeName"><span class="hs-identifier hs-var">exeName</span></a></span><span> </span><span class="annot"><span class="annottext">Executable
</span><a href="#local-6989586621679553324"><span class="hs-identifier hs-var">exe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>                </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Component.html#CTest"><span class="hs-identifier hs-type">CTest</span></a></span><span> </span><span id="local-6989586621679553327"><span class="annot"><span class="annottext">TestSuite
</span><a href="#local-6989586621679553327"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnqualComponentName -&gt; IO ()
</span><a href="#local-6989586621679553308"><span class="hs-identifier hs-var">linkExeLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestSuite -&gt; UnqualComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.TestSuite.html#testName"><span class="hs-identifier hs-var">testName</span></a></span><span> </span><span class="annot"><span class="annottext">TestSuite
</span><a href="#local-6989586621679553327"><span class="hs-identifier hs-var">test</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>                </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Component.html#CBench"><span class="hs-identifier hs-type">CBench</span></a></span><span> </span><span id="local-6989586621679553330"><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621679553330"><span class="hs-identifier hs-var">bench</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnqualComponentName -&gt; IO ()
</span><a href="#local-6989586621679553308"><span class="hs-identifier hs-var">linkExeLike</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Benchmark -&gt; UnqualComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Benchmark.html#benchmarkName"><span class="hs-identifier hs-var">benchmarkName</span></a></span><span> </span><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621679553330"><span class="hs-identifier hs-var">bench</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><span class="hs-comment">-- | Link a library component</span></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#linkLibrary"><span class="hs-identifier hs-type">linkLibrary</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Artifacts"><span class="hs-identifier hs-type">Artifacts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The library target build directory</span></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Lib"><span class="hs-identifier hs-type">Lib</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The list of extra lib dirs that exist (aka &quot;cleaned&quot;)</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The package description containing this library</span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Run the configured Ghc program</span></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#Library"><span class="hs-identifier hs-type">Library</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.ComponentLocalBuildInfo.html#ComponentLocalBuildInfo"><span class="hs-identifier hs-type">ComponentLocalBuildInfo</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Extra build sources (that were compiled to objects)</span></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#NubListR"><span class="hs-identifier hs-type">NubListR</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ A list with the runtime-paths (rpaths), or empty if not linking dynamically</span></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Wanted build ways and corresponding build options</span></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span id="linkLibrary"><span class="annot"><span class="annottext">linkLibrary :: SymbolicPath Pkg ('Dir Artifacts)
-&gt; [SymbolicPath Pkg ('Dir Lib)]
-&gt; PackageDescription
-&gt; Verbosity
-&gt; (GhcOptions -&gt; IO ())
-&gt; Library
-&gt; LocalBuildInfo
-&gt; ComponentLocalBuildInfo
-&gt; [SymbolicPath Pkg 'File]
-&gt; NubListR FilePath
-&gt; [BuildWay]
-&gt; IO ()
</span><a href="Distribution.Simple.GHC.Build.Link.html#linkLibrary"><span class="hs-identifier hs-var hs-var">linkLibrary</span></a></span></span><span> </span><span id="local-6989586621679553332"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span></span><span> </span><span id="local-6989586621679553333"><span class="annot"><span class="annottext">[SymbolicPath Pkg ('Dir Lib)]
</span><a href="#local-6989586621679553333"><span class="hs-identifier hs-var">cleanedExtraLibDirs</span></a></span></span><span> </span><span id="local-6989586621679553334"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679553334"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span> </span><span id="local-6989586621679553335"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553335"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679553336"><span class="annot"><span class="annottext">GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553336"><span class="hs-identifier hs-var">runGhcProg</span></a></span></span><span> </span><span id="local-6989586621679553337"><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679553337"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span id="local-6989586621679553338"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span id="local-6989586621679553339"><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553339"><span class="hs-identifier hs-var">clbi</span></a></span></span><span> </span><span id="local-6989586621679553340"><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553340"><span class="hs-identifier hs-var">extraSources</span></a></span></span><span> </span><span id="local-6989586621679553341"><span class="annot"><span class="annottext">NubListR FilePath
</span><a href="#local-6989586621679553341"><span class="hs-identifier hs-var">rpaths</span></a></span></span><span> </span><span id="local-6989586621679553342"><span class="annot"><span class="annottext">[BuildWay]
</span><a href="#local-6989586621679553342"><span class="hs-identifier hs-var">wantedWays</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679553343"><span class="annot"><span class="annottext">common :: CommonSetupFlags
</span><a href="#local-6989586621679553343"><span class="hs-identifier hs-var hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">(ConfigFlags -&gt; CommonSetupFlags)
-&gt; ConfigFlags -&gt; CommonSetupFlags
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ConfigFlags
</span><a href="Distribution.Types.LocalBuildInfo.html#configFlags"><span class="hs-identifier hs-var">configFlags</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679553346"><span class="annot"><span class="annottext">mbWorkDir :: Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679553346"><span class="hs-identifier hs-var hs-var hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag (SymbolicPath CWD ('Dir Pkg))
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
forall a. Flag a -&gt; Maybe a
</span><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-var">flagToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag (SymbolicPath CWD ('Dir Pkg))
 -&gt; Maybe (SymbolicPath CWD ('Dir Pkg)))
-&gt; Flag (SymbolicPath CWD ('Dir Pkg))
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.Setup.Common.html#setupWorkingDir"><span class="hs-identifier hs-var">setupWorkingDir</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679553343"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>    </span><span id="local-6989586621679553349"><span class="annot"><span class="annottext">compiler_id :: CompilerId
</span><a href="#local-6989586621679553349"><span class="hs-identifier hs-var hs-var hs-var">compiler_id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; CompilerId
</span><a href="Distribution.Simple.Compiler.html#compilerId"><span class="hs-identifier hs-var">compilerId</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679553351"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679553351"><span class="annot"><span class="annottext">comp :: Compiler
</span><a href="#local-6989586621679553351"><span class="hs-identifier hs-var hs-var hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679553352"><span class="annot"><span class="annottext">ghcVersion :: Version
</span><a href="#local-6989586621679553352"><span class="hs-identifier hs-var hs-var hs-var">ghcVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Version
</span><a href="Distribution.Simple.Compiler.html#compilerVersion"><span class="hs-identifier hs-var">compilerVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679553351"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621679553354"><span class="annot"><span class="annottext">implInfo :: GhcImplInfo
</span><a href="#local-6989586621679553354"><span class="hs-identifier hs-var hs-var hs-var">implInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; GhcImplInfo
</span><a href="Distribution.Simple.GHC.ImplInfo.html#getImplInfo"><span class="hs-identifier hs-var">getImplInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679553351"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621679553356"><span class="annot"><span class="annottext">uid :: UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var hs-var hs-var">uid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo -&gt; UnitId
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentUnitId"><span class="hs-identifier hs-var">componentUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553339"><span class="hs-identifier hs-var">clbi</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679553358"><span class="annot"><span class="annottext">libBi :: BuildInfo
</span><a href="#local-6989586621679553358"><span class="hs-identifier hs-var hs-var hs-var">libBi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Library -&gt; BuildInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#libBuildInfo"><span class="hs-identifier hs-var">libBuildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679553337"><span class="hs-identifier hs-var">lib</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span id="local-6989586621679553361"><span class="annot"><span class="annottext">Arch
</span><a href="#local-6989586621679553361"><span class="hs-identifier hs-var hs-var">_hostArch</span></a></span></span><span> </span><span id="local-6989586621679553362"><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679553362"><span class="hs-identifier hs-var hs-var">hostOS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621679553370"><span class="annot"><span class="annottext">vanillaLibFilePath :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553370"><span class="hs-identifier hs-var hs-var hs-var">vanillaLibFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
-&gt; RelativePath Artifacts c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitId -&gt; FilePath
</span><a href="Distribution.Simple.BuildPaths.html#mkLibName"><span class="hs-identifier hs-var">mkLibName</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679553379"><span class="annot"><span class="annottext">profileLibFilePath :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553379"><span class="hs-identifier hs-var hs-var hs-var">profileLibFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
-&gt; RelativePath Artifacts c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitId -&gt; FilePath
</span><a href="Distribution.Simple.BuildPaths.html#mkProfLibName"><span class="hs-identifier hs-var">mkProfLibName</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>    </span><span id="local-6989586621679553388"><span class="annot"><span class="annottext">sharedLibFilePath :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553388"><span class="hs-identifier hs-var hs-var hs-var">sharedLibFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
-&gt; RelativePath Artifacts c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CompilerId -&gt; UnitId -&gt; FilePath
</span><a href="Distribution.Simple.BuildPaths.html#mkSharedLibName"><span class="hs-identifier hs-var">mkSharedLibName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CompilerId
</span><a href="#local-6989586621679553349"><span class="hs-identifier hs-var">compiler_id</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679553397"><span class="annot"><span class="annottext">profSharedLibFilePath :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553397"><span class="hs-identifier hs-var hs-var hs-var">profSharedLibFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
-&gt; RelativePath Artifacts c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CompilerId -&gt; UnitId -&gt; FilePath
</span><a href="Distribution.Simple.BuildPaths.html#mkProfSharedLibName"><span class="hs-identifier hs-var">mkProfSharedLibName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CompilerId
</span><a href="#local-6989586621679553349"><span class="hs-identifier hs-var">compiler_id</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679553406"><span class="annot"><span class="annottext">staticLibFilePath :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553406"><span class="hs-identifier hs-var hs-var hs-var">staticLibFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
-&gt; RelativePath Artifacts c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; CompilerId -&gt; UnitId -&gt; FilePath
</span><a href="Distribution.Simple.BuildPaths.html#mkStaticLibName"><span class="hs-identifier hs-var">mkStaticLibName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CompilerId
</span><a href="#local-6989586621679553349"><span class="hs-identifier hs-var">compiler_id</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679553415"><span class="annot"><span class="annottext">ghciLibFilePath :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553415"><span class="hs-identifier hs-var hs-var hs-var">ghciLibFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
-&gt; RelativePath Artifacts c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitId -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Internal.html#mkGHCiLibName"><span class="hs-identifier hs-var">Internal.mkGHCiLibName</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621679553424"><span class="annot"><span class="annottext">ghciProfLibFilePath :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553424"><span class="hs-identifier hs-var hs-var hs-var">ghciProfLibFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
-&gt; RelativePath Artifacts c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitId -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Internal.html#mkGHCiProfLibName"><span class="hs-identifier hs-var">Internal.mkGHCiProfLibName</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621679553426"><span class="annot"><span class="annottext">libInstallPath :: FilePath
</span><a href="#local-6989586621679553426"><span class="hs-identifier hs-var hs-var hs-var">libInstallPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">InstallDirs FilePath -&gt; FilePath
forall dir. InstallDirs dir -&gt; dir
</span><a href="Distribution.Simple.InstallDirs.html#libdir"><span class="hs-identifier hs-var">libdir</span></a></span><span> </span><span class="annot"><span class="annottext">(InstallDirs FilePath -&gt; FilePath)
-&gt; InstallDirs FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="annottext">PackageDescription
-&gt; LocalBuildInfo -&gt; UnitId -&gt; CopyDest -&gt; InstallDirs FilePath
</span><a href="Distribution.Simple.LocalBuildInfo.html#absoluteComponentInstallDirs"><span class="hs-identifier hs-var">absoluteComponentInstallDirs</span></a></span><span>
</span><span id="line-269"></span><span>          </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679553334"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span>
</span><span id="line-270"></span><span>          </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-271"></span><span>          </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span>
</span><span id="line-272"></span><span>          </span><span class="annot"><span class="annottext">CopyDest
</span><a href="Distribution.Simple.InstallDirs.html#NoCopyDest"><span class="hs-identifier hs-var">NoCopyDest</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679553431"><span class="annot"><span class="annottext">sharedLibInstallPath :: FilePath
</span><a href="#local-6989586621679553431"><span class="hs-identifier hs-var hs-var hs-var">sharedLibInstallPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553426"><span class="hs-identifier hs-var">libInstallPath</span></a></span><span>
</span><span id="line-275"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CompilerId -&gt; UnitId -&gt; FilePath
</span><a href="Distribution.Simple.BuildPaths.html#mkSharedLibName"><span class="hs-identifier hs-var">mkSharedLibName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CompilerId
</span><a href="#local-6989586621679553349"><span class="hs-identifier hs-var">compiler_id</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679553433"><span class="annot"><span class="annottext">profSharedLibInstallPath :: FilePath
</span><a href="#local-6989586621679553433"><span class="hs-identifier hs-var hs-var hs-var">profSharedLibInstallPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553426"><span class="hs-identifier hs-var">libInstallPath</span></a></span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CompilerId -&gt; UnitId -&gt; FilePath
</span><a href="Distribution.Simple.BuildPaths.html#mkProfSharedLibName"><span class="hs-identifier hs-var">mkProfSharedLibName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CompilerId
</span><a href="#local-6989586621679553349"><span class="hs-identifier hs-var">compiler_id</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553356"><span class="hs-identifier hs-var">uid</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="#local-6989586621679553434"><span class="hs-identifier hs-type">getObjFiles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679553434"><span class="annot"><span class="annottext">getObjFiles :: BuildWay -&gt; IO [SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553434"><span class="hs-identifier hs-var hs-var hs-var">getObjFiles</span></a></span></span><span> </span><span id="local-6989586621679553435"><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553435"><span class="hs-identifier hs-var">way</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="annottext">[IO [SymbolicPath Pkg 'File]] -&gt; IO [SymbolicPath Pkg 'File]
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">GhcImplInfo
-&gt; Library
-&gt; LocalBuildInfo
-&gt; ComponentLocalBuildInfo
-&gt; SymbolicPath Pkg ('Dir Artifacts)
-&gt; FilePath
-&gt; Bool
-&gt; IO [SymbolicPath Pkg 'File]
</span><a href="Distribution.Simple.GHC.Internal.html#getHaskellObjects"><span class="hs-identifier hs-var">Internal.getHaskellObjects</span></a></span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="annottext">GhcImplInfo
</span><a href="#local-6989586621679553354"><span class="hs-identifier hs-var">implInfo</span></a></span><span>
</span><span id="line-285"></span><span>            </span><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679553337"><span class="hs-identifier hs-var">lib</span></a></span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-287"></span><span>            </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553339"><span class="hs-identifier hs-var">clbi</span></a></span><span>
</span><span id="line-288"></span><span>            </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span>
</span><span id="line-289"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildWay -&gt; FilePath
</span><a href="Distribution.Simple.BuildWay.html#buildWayPrefix"><span class="hs-identifier hs-var">buildWayPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553435"><span class="hs-identifier hs-var">way</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Distribution.Simple.BuildPaths.html#objExtension"><span class="hs-identifier hs-var">objExtension</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File] -&gt; IO [SymbolicPath Pkg 'File]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([SymbolicPath Pkg 'File] -&gt; IO [SymbolicPath Pkg 'File])
-&gt; [SymbolicPath Pkg 'File] -&gt; IO [SymbolicPath Pkg 'File]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SymbolicPath Pkg 'File -&gt; SymbolicPath Pkg 'File)
-&gt; [SymbolicPath Pkg 'File] -&gt; [SymbolicPath Pkg 'File]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildWay -&gt; SymbolicPath Pkg 'File -&gt; SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553438"><span class="hs-identifier hs-var">srcObjPath</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553435"><span class="hs-identifier hs-var">way</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553340"><span class="hs-identifier hs-var">extraSources</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Maybe (SymbolicPath Pkg 'File)] -&gt; [SymbolicPath Pkg 'File]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-293"></span><span>            </span><span class="annot"><span class="annottext">([Maybe (SymbolicPath Pkg 'File)] -&gt; [SymbolicPath Pkg 'File])
-&gt; IO [Maybe (SymbolicPath Pkg 'File)]
-&gt; IO [SymbolicPath Pkg 'File]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[IO (Maybe (SymbolicPath Pkg 'File))]
-&gt; IO [Maybe (SymbolicPath Pkg 'File)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; [f a] -&gt; f [a]
</span><span class="hs-identifier hs-var">sequenceA</span></span><span>
</span><span id="line-294"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; [Suffix]
-&gt; [SymbolicPath Pkg ('Dir Artifacts)]
-&gt; RelativePath Artifacts 'File
-&gt; IO (Maybe (SymbolicPath Pkg 'File))
forall searchDir (allowAbsolute :: AllowAbsolute).
Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; [Suffix]
-&gt; [SymbolicPathX allowAbsolute Pkg ('Dir searchDir)]
-&gt; RelativePath searchDir 'File
-&gt; IO (Maybe (SymbolicPathX allowAbsolute Pkg 'File))
</span><a href="Distribution.Simple.Utils.html#findFileCwdWithExtension"><span class="hs-identifier hs-var">findFileCwdWithExtension</span></a></span><span>
</span><span id="line-295"></span><span>                </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679553346"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span>
</span><span id="line-296"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath -&gt; Suffix
</span><a href="Distribution.Simple.PreProcess.Types.html#Suffix"><span class="hs-identifier hs-var">Suffix</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Suffix) -&gt; FilePath -&gt; Suffix
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BuildWay -&gt; FilePath
</span><a href="Distribution.Simple.BuildWay.html#buildWayPrefix"><span class="hs-identifier hs-var">buildWayPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553435"><span class="hs-identifier hs-var">way</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Distribution.Simple.BuildPaths.html#objExtension"><span class="hs-identifier hs-var">objExtension</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>                </span><span class="annot"><span class="annottext">RelativePath Artifacts 'File
</span><a href="#local-6989586621679553444"><span class="hs-identifier hs-var">xPath</span></a></span><span>
</span><span id="line-299"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679553352"><span class="hs-identifier hs-var">ghcVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-var">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ghc-7.2+ does not make _stub.o files</span><span>
</span><span id="line-300"></span><span>              </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553447"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679553447"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Library -&gt; ComponentLocalBuildInfo -&gt; [ModuleName]
</span><a href="Distribution.Simple.LocalBuildInfo.html#allLibModules"><span class="hs-identifier hs-var">allLibModules</span></a></span><span> </span><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679553337"><span class="hs-identifier hs-var">lib</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553339"><span class="hs-identifier hs-var">clbi</span></a></span><span>
</span><span id="line-301"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679553444"><span class="hs-identifier hs-type">xPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#RelativePath"><span class="hs-identifier hs-type">RelativePath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Artifacts"><span class="hs-identifier hs-type">Artifacts</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span>
</span><span id="line-302"></span><span>                    </span><span id="local-6989586621679553444"><span class="annot"><span class="annottext">xPath :: RelativePath Artifacts 'File
</span><a href="#local-6989586621679553444"><span class="hs-identifier hs-var hs-var">xPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Artifacts 'File
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; RelativePath Artifacts 'File)
-&gt; FilePath -&gt; RelativePath Artifacts 'File
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.ModuleName.html#toFilePath"><span class="hs-identifier hs-var">ModuleName.toFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679553447"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_stub&quot;</span></span><span>
</span><span id="line-303"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-comment">-- Get the @.o@ path from a source path (e.g. @.hs@),</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- in the library target build directory.</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="#local-6989586621679553438"><span class="hs-identifier hs-type">srcObjPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679553438"><span class="annot"><span class="annottext">srcObjPath :: BuildWay -&gt; SymbolicPath Pkg 'File -&gt; SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553438"><span class="hs-identifier hs-var hs-var hs-var">srcObjPath</span></a></span></span><span> </span><span id="local-6989586621679553449"><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553449"><span class="hs-identifier hs-var">way</span></a></span></span><span> </span><span id="local-6989586621679553450"><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553450"><span class="hs-identifier hs-var">srcPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File -&gt; Maybe (RelativePath Pkg 'File)
forall from (to :: FileOrDir).
SymbolicPath from to -&gt; Maybe (RelativePath from to)
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#symbolicPathRelative_maybe"><span class="hs-identifier hs-var">symbolicPathRelative_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553452"><span class="hs-identifier hs-var">objPath</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-comment">-- Absolute path: should already be in the target build directory</span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-comment">-- (e.g. a preprocessed file)</span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-comment">-- TODO: assert this?</span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">Maybe (RelativePath Pkg 'File)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553452"><span class="hs-identifier hs-var">objPath</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679553453"><span class="annot"><span class="annottext">RelativePath Pkg 'File
</span><a href="#local-6989586621679553453"><span class="hs-identifier hs-var">objRelPath</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
-&gt; SymbolicPathX 'AllowAbsolute Pkg ('Dir Pkg)
forall (allowAbsolute :: AllowAbsolute) from (to1 :: FileOrDir)
       (to2 :: FileOrDir).
SymbolicPathX allowAbsolute from to1
-&gt; SymbolicPathX allowAbsolute from to2
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#coerceSymbolicPath"><span class="hs-identifier hs-var">coerceSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Artifacts)
</span><a href="#local-6989586621679553332"><span class="hs-identifier hs-var">buildTargetDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'AllowAbsolute Pkg ('Dir Pkg)
-&gt; RelativePath Pkg 'File -&gt; SymbolicPath Pkg 'File
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RelativePath Pkg 'File
</span><a href="#local-6989586621679553453"><span class="hs-identifier hs-var">objRelPath</span></a></span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>        </span><span id="local-6989586621679553452"><span class="annot"><span class="annottext">objPath :: SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553452"><span class="hs-identifier hs-var hs-var">objPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679553450"><span class="hs-identifier hs-var">srcPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File -&gt; FilePath -&gt; SymbolicPath Pkg 'File
forall (allowAbsolute :: AllowAbsolute) from.
SymbolicPathX allowAbsolute from 'File
-&gt; FilePath -&gt; SymbolicPathX allowAbsolute from 'File
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#replaceExtensionSymbolicPath"><span class="hs-operator hs-var">`replaceExtensionSymbolicPath`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildWay -&gt; FilePath
</span><a href="Distribution.Simple.BuildWay.html#buildWayPrefix"><span class="hs-identifier hs-var">buildWayPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553449"><span class="hs-identifier hs-var">way</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="Distribution.Simple.BuildPaths.html#objExtension"><span class="hs-identifier hs-var">objExtension</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-comment">-- I'm fairly certain that, just like the executable, we can keep just the</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-comment">-- module input list, and point to the right sources dir (as is already</span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-comment">-- done), and GHC will pick up the right suffix (p_ for profile, dyn_ when</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-comment">-- -shared...). The downside to doing this is that GHC would have to</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-comment">-- reconstruct the module graph again.</span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-comment">-- That would mean linking the lib would be just like the executable, and</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-comment">-- we could more easily merge the two.</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-comment">-- Right now, instead, we pass the path to each object file.</span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621679553473"><span class="annot"><span class="annottext">ghcBaseLinkArgs :: GhcOptions
</span><a href="#local-6989586621679553473"><span class="hs-identifier hs-var hs-var hs-var">ghcBaseLinkArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><span class="annottext">GhcOptions
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-330"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- TODO: This basically duplicates componentGhcOptions.</span><span>
</span><span id="line-331"></span><span>          </span><span class="hs-comment">-- I think we want to do the same as we do for executables: re-use the</span><span>
</span><span id="line-332"></span><span>          </span><span class="hs-comment">-- base options, and link by module names, not object paths.</span><span>
</span><span id="line-333"></span><span>          </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptExtra"><span class="hs-identifier hs-var">ghcOptExtra</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#hcStaticOptions"><span class="hs-identifier hs-type">hcStaticOptions</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-type">GHC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptHideAllPackages"><span class="hs-identifier hs-var">ghcOptHideAllPackages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptNoAutoLinkPackages"><span class="hs-identifier hs-var">ghcOptNoAutoLinkPackages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptPackageDBs"><span class="hs-identifier hs-var">ghcOptPackageDBs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#withPackageDB"><span class="hs-identifier hs-var">withPackageDB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553338"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptThisUnitId"><span class="hs-identifier hs-var">ghcOptThisUnitId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679553339"><span class="hs-identifier hs-type">clbi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-338"></span><span>            </span><span class="annot"><a href="Distribution.Types.ComponentLocalBuildInfo.html#LibComponentLocalBuildInfo"><span class="hs-identifier hs-type">LibComponentLocalBuildInfo</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">componentCompatPackageKey :: ComponentLocalBuildInfo -&gt; FilePath
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentCompatPackageKey"><span class="hs-identifier hs-var">componentCompatPackageKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679553483"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553483"><span class="hs-identifier hs-var">pk</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-339"></span><span>              </span><span class="annot"><span class="annottext">FilePath -&gt; Flag FilePath
forall a. a -&gt; Flag a
</span><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-var">toFlag</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553483"><span class="hs-identifier hs-var">pk</span></a></span><span>
</span><span id="line-340"></span><span>            </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Flag FilePath
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptThisComponentId"><span class="hs-identifier hs-var">ghcOptThisComponentId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679553339"><span class="hs-identifier hs-type">clbi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-342"></span><span>            </span><span class="annot"><a href="Distribution.Types.ComponentLocalBuildInfo.html#LibComponentLocalBuildInfo"><span class="hs-identifier hs-type">LibComponentLocalBuildInfo</span></a></span><span>
</span><span id="line-343"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">componentInstantiatedWith :: ComponentLocalBuildInfo -&gt; [(ModuleName, OpenModule)]
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentInstantiatedWith"><span class="hs-identifier hs-var">componentInstantiatedWith</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679553486"><span class="annot"><span class="annottext">[(ModuleName, OpenModule)]
</span><a href="#local-6989586621679553486"><span class="hs-identifier hs-var">insts</span></a></span></span><span>
</span><span id="line-344"></span><span>              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-345"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[(ModuleName, OpenModule)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(ModuleName, OpenModule)]
</span><a href="#local-6989586621679553486"><span class="hs-identifier hs-var">insts</span></a></span><span>
</span><span id="line-346"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Flag ComponentId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-347"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ComponentId -&gt; Flag ComponentId
forall a. a -&gt; Flag a
</span><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-var">toFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentLocalBuildInfo -&gt; ComponentId
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentComponentId"><span class="hs-identifier hs-var">componentComponentId</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553339"><span class="hs-identifier hs-var">clbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>            </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Flag ComponentId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInstantiatedWith"><span class="hs-identifier hs-var">ghcOptInstantiatedWith</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679553339"><span class="hs-identifier hs-type">clbi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><a href="Distribution.Types.ComponentLocalBuildInfo.html#LibComponentLocalBuildInfo"><span class="hs-identifier hs-type">LibComponentLocalBuildInfo</span></a></span><span>
</span><span id="line-351"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">componentInstantiatedWith :: ComponentLocalBuildInfo -&gt; [(ModuleName, OpenModule)]
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentInstantiatedWith"><span class="hs-identifier hs-var">componentInstantiatedWith</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679553489"><span class="annot"><span class="annottext">[(ModuleName, OpenModule)]
</span><a href="#local-6989586621679553489"><span class="hs-identifier hs-var">insts</span></a></span></span><span>
</span><span id="line-352"></span><span>              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-353"></span><span>                </span><span class="annot"><span class="annottext">[(ModuleName, OpenModule)]
</span><a href="#local-6989586621679553489"><span class="hs-identifier hs-var">insts</span></a></span><span>
</span><span id="line-354"></span><span>            </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-355"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptPackages"><span class="hs-identifier hs-var">ghcOptPackages</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>            </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-357"></span><span>              </span><span class="annot"><a href="Distribution.Simple.GHC.Internal.html#mkGhcOptPackages"><span class="hs-identifier hs-type">Internal.mkGhcOptPackages</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span> </span><span class="annot"><a href="#local-6989586621679553339"><span class="hs-identifier hs-type">clbi</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-comment">-- After the relocation lib is created we invoke ghc -shared</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-comment">-- with the dependencies spelled out as -package arguments</span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-comment">-- and ghc invokes the linker with the proper library paths</span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><a href="#local-6989586621679553492"><span class="hs-identifier hs-type">ghcSharedLinkArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span id="local-6989586621679553492"><span class="annot"><span class="annottext">ghcSharedLinkArgs :: [SymbolicPath Pkg 'File] -&gt; GhcOptions
</span><a href="#local-6989586621679553492"><span class="hs-identifier hs-var hs-var hs-var">ghcSharedLinkArgs</span></a></span></span><span> </span><span id="local-6989586621679553493"><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553493"><span class="hs-identifier hs-var">dynObjectFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553473"><span class="hs-identifier hs-var">ghcBaseLinkArgs</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptShared"><span class="hs-identifier hs-var">ghcOptShared</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-367"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptDynLinkMode"><span class="hs-identifier hs-var">ghcOptDynLinkMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcDynamicOnly"><span class="hs-identifier hs-type">GhcDynamicOnly</span></a></span><span>
</span><span id="line-368"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputFiles"><span class="hs-identifier hs-var">ghcOptInputFiles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#coerceSymbolicPath"><span class="hs-identifier hs-type">coerceSymbolicPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553493"><span class="hs-identifier hs-type">dynObjectFiles</span></a></span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptOutputFile"><span class="hs-identifier hs-var">ghcOptOutputFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553388"><span class="hs-identifier hs-type">sharedLibFilePath</span></a></span><span>
</span><span id="line-370"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- For dynamic libs, Mac OS/X needs to know the install location</span><span>
</span><span id="line-371"></span><span>          </span><span class="hs-comment">-- at build time. This only applies to GHC &lt; 7.8 - see the</span><span>
</span><span id="line-372"></span><span>          </span><span class="hs-comment">-- discussion in #1660.</span><span>
</span><span id="line-373"></span><span>          </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptDylibName"><span class="hs-identifier hs-var">ghcOptDylibName</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679553362"><span class="hs-identifier hs-type">hostOS</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OSX"><span class="hs-identifier hs-type">OSX</span></a></span><span>
</span><span id="line-375"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621679553352"><span class="hs-identifier hs-type">ghcVersion</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-type">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553431"><span class="hs-identifier hs-type">sharedLibInstallPath</span></a></span><span>
</span><span id="line-377"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibs"><span class="hs-identifier hs-var">ghcOptLinkLibs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibs"><span class="hs-identifier hs-var">extraLibs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibPath"><span class="hs-identifier hs-var">ghcOptLinkLibPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679553333"><span class="hs-identifier hs-type">cleanedExtraLibDirs</span></a></span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkFrameworks"><span class="hs-identifier hs-var">ghcOptLinkFrameworks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-type">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#frameworks"><span class="hs-identifier hs-var">PD.frameworks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkFrameworkDirs"><span class="hs-identifier hs-var">ghcOptLinkFrameworkDirs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-382"></span><span>            </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraFrameworkDirs"><span class="hs-identifier hs-var">PD.extraFrameworkDirs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span>
</span><span id="line-383"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptRPaths"><span class="hs-identifier hs-var">ghcOptRPaths</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679553341"><span class="hs-identifier hs-type">rpaths</span></a></span><span>
</span><span id="line-384"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>    </span><span id="local-6989586621679553508"><span class="annot"><span class="annottext">ghcProfSharedLinkArgs :: [SymbolicPath Pkg 'File] -&gt; GhcOptions
</span><a href="#local-6989586621679553508"><span class="hs-identifier hs-var hs-var hs-var">ghcProfSharedLinkArgs</span></a></span></span><span> </span><span id="local-6989586621679553509"><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553509"><span class="hs-identifier hs-var">pdynObjectFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553473"><span class="hs-identifier hs-var">ghcBaseLinkArgs</span></a></span><span>
</span><span id="line-387"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptShared"><span class="hs-identifier hs-var">ghcOptShared</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-388"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptProfilingMode"><span class="hs-identifier hs-var">ghcOptProfilingMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-389"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptProfilingAuto"><span class="hs-identifier hs-var">ghcOptProfilingAuto</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><a href="Distribution.Simple.GHC.Internal.html#profDetailLevelFlag"><span class="hs-identifier hs-type">Internal.profDetailLevelFlag</span></a></span><span>
</span><span id="line-391"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-392"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#withProfLibDetail"><span class="hs-identifier hs-var">withProfLibDetail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553338"><span class="hs-identifier hs-type">lbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptDynLinkMode"><span class="hs-identifier hs-var">ghcOptDynLinkMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcDynamicOnly"><span class="hs-identifier hs-type">GhcDynamicOnly</span></a></span><span>
</span><span id="line-394"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputFiles"><span class="hs-identifier hs-var">ghcOptInputFiles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553509"><span class="hs-identifier hs-type">pdynObjectFiles</span></a></span><span>
</span><span id="line-395"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptOutputFile"><span class="hs-identifier hs-var">ghcOptOutputFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553397"><span class="hs-identifier hs-type">profSharedLibFilePath</span></a></span><span>
</span><span id="line-396"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- For dynamic libs, Mac OS/X needs to know the install location</span><span>
</span><span id="line-397"></span><span>          </span><span class="hs-comment">-- at build time. This only applies to GHC &lt; 7.8 - see the</span><span>
</span><span id="line-398"></span><span>          </span><span class="hs-comment">-- discussion in #1660.</span><span>
</span><span id="line-399"></span><span>          </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptDylibName"><span class="hs-identifier hs-var">ghcOptDylibName</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-400"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679553362"><span class="hs-identifier hs-type">hostOS</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OSX"><span class="hs-identifier hs-type">OSX</span></a></span><span>
</span><span id="line-401"></span><span>              </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621679553352"><span class="hs-identifier hs-type">ghcVersion</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-type">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">8</span></span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553433"><span class="hs-identifier hs-type">profSharedLibInstallPath</span></a></span><span>
</span><span id="line-403"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-404"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibs"><span class="hs-identifier hs-var">ghcOptLinkLibs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibs"><span class="hs-identifier hs-var">extraLibs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span>
</span><span id="line-405"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibPath"><span class="hs-identifier hs-var">ghcOptLinkLibPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679553333"><span class="hs-identifier hs-type">cleanedExtraLibDirs</span></a></span><span>
</span><span id="line-406"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkFrameworks"><span class="hs-identifier hs-var">ghcOptLinkFrameworks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-type">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#frameworks"><span class="hs-identifier hs-var">PD.frameworks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span>
</span><span id="line-407"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkFrameworkDirs"><span class="hs-identifier hs-var">ghcOptLinkFrameworkDirs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-408"></span><span>            </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraFrameworkDirs"><span class="hs-identifier hs-var">PD.extraFrameworkDirs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span>
</span><span id="line-409"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptRPaths"><span class="hs-identifier hs-var">ghcOptRPaths</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679553341"><span class="hs-identifier hs-type">rpaths</span></a></span><span>
</span><span id="line-410"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679553516"><span class="annot"><span class="annottext">ghcStaticLinkArgs :: [SymbolicPathX 'AllowAbsolute Pkg to1] -&gt; GhcOptions
</span><a href="#local-6989586621679553516"><span class="hs-identifier hs-var hs-var hs-var">ghcStaticLinkArgs</span></a></span></span><span> </span><span id="local-6989586621679553517"><span class="annot"><span class="annottext">[SymbolicPathX 'AllowAbsolute Pkg to1]
</span><a href="#local-6989586621679553517"><span class="hs-identifier hs-var">staticObjectFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553473"><span class="hs-identifier hs-var">ghcBaseLinkArgs</span></a></span><span>
</span><span id="line-413"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptStaticLib"><span class="hs-identifier hs-var">ghcOptStaticLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputFiles"><span class="hs-identifier hs-var">ghcOptInputFiles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#coerceSymbolicPath"><span class="hs-identifier hs-type">coerceSymbolicPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553517"><span class="hs-identifier hs-type">staticObjectFiles</span></a></span><span>
</span><span id="line-415"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptOutputFile"><span class="hs-identifier hs-var">ghcOptOutputFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553406"><span class="hs-identifier hs-type">staticLibFilePath</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibs"><span class="hs-identifier hs-var">ghcOptLinkLibs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibs"><span class="hs-identifier hs-var">extraLibs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- TODO: Shouldn't this use cleanedExtraLibDirsStatic instead?</span><span>
</span><span id="line-418"></span><span>          </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibPath"><span class="hs-identifier hs-var">ghcOptLinkLibPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679553333"><span class="hs-identifier hs-type">cleanedExtraLibDirs</span></a></span><span>
</span><span id="line-419"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621679553519"><span class="annot"><a href="#local-6989586621679553519"><span class="hs-identifier hs-var">staticObjectFiles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuildWay -&gt; IO [SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553434"><span class="hs-identifier hs-var">getObjFiles</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#StaticWay"><span class="hs-identifier hs-var">StaticWay</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621679553520"><span class="annot"><a href="#local-6989586621679553520"><span class="hs-identifier hs-var">profObjectFiles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679553434"><span class="hs-identifier hs-type">getObjFiles</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#ProfWay"><span class="hs-identifier hs-type">ProfWay</span></a></span><span>
</span><span id="line-423"></span><span>  </span><span id="local-6989586621679553522"><span class="annot"><a href="#local-6989586621679553522"><span class="hs-identifier hs-var">dynamicObjectFiles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679553434"><span class="hs-identifier hs-type">getObjFiles</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#DynWay"><span class="hs-identifier hs-type">DynWay</span></a></span><span>
</span><span id="line-424"></span><span>  </span><span id="local-6989586621679553523"><span class="annot"><a href="#local-6989586621679553523"><span class="hs-identifier hs-var">profDynamicObjectFiles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679553434"><span class="hs-identifier hs-type">getObjFiles</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#ProfDynWay"><span class="hs-identifier hs-type">ProfDynWay</span></a></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-427"></span><span>    </span><span id="local-6989586621679553534"><span class="annot"><a href="#local-6989586621679553534"><span class="hs-identifier hs-var hs-var">linkWay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-428"></span><span>      </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#ProfWay"><span class="hs-identifier hs-var">ProfWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><span class="annottext">Verbosity
-&gt; LocalBuildInfo
-&gt; SymbolicPath Pkg 'File
-&gt; [SymbolicPath Pkg 'File]
-&gt; IO ()
</span><a href="Distribution.Simple.Program.Ar.html#createArLibArchive"><span class="hs-identifier hs-var">Ar.createArLibArchive</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553335"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
forall {c3 :: FileOrDir}. SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553379"><span class="hs-identifier hs-var">profileLibFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553520"><span class="hs-identifier hs-var">profObjectFiles</span></a></span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.LocalBuildInfo.html#withGHCiLib"><span class="hs-identifier hs-var">withGHCiLib</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-431"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679553537"><span class="annot"><a href="#local-6989586621679553537"><span class="hs-identifier hs-var">ldProg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Program -&gt; ProgramDb -&gt; IO (ConfiguredProgram, ProgramDb)
</span><a href="Distribution.Simple.Program.Db.html#requireProgram"><span class="hs-identifier hs-var">requireProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553335"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="Distribution.Simple.Program.Builtin.html#ldProgram"><span class="hs-identifier hs-var">ldProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ProgramDb
</span><a href="Distribution.Types.LocalBuildInfo.html#withPrograms"><span class="hs-identifier hs-var">withPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>          </span><span class="annot"><a href="Distribution.Simple.Program.Ld.html#combineObjectFiles"><span class="hs-identifier hs-type">Ld.combineObjectFiles</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><a href="#local-6989586621679553335"><span class="hs-identifier hs-type">verbosity</span></a></span><span>
</span><span id="line-434"></span><span>            </span><span class="annot"><a href="#local-6989586621679553338"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-435"></span><span>            </span><span class="annot"><a href="#local-6989586621679553537"><span class="hs-identifier hs-type">ldProg</span></a></span><span>
</span><span id="line-436"></span><span>            </span><span class="annot"><a href="#local-6989586621679553424"><span class="hs-identifier hs-type">ghciProfLibFilePath</span></a></span><span>
</span><span id="line-437"></span><span>            </span><span class="annot"><a href="#local-6989586621679553520"><span class="hs-identifier hs-type">profObjectFiles</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#ProfDynWay"><span class="hs-identifier hs-var">ProfDynWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><span class="annottext">GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553336"><span class="hs-identifier hs-var">runGhcProg</span></a></span><span> </span><span class="annot"><span class="annottext">(GhcOptions -&gt; IO ()) -&gt; GhcOptions -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File] -&gt; GhcOptions
</span><a href="#local-6989586621679553508"><span class="hs-identifier hs-var">ghcProfSharedLinkArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553523"><span class="hs-identifier hs-var">profDynamicObjectFiles</span></a></span><span>
</span><span id="line-440"></span><span>      </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#DynWay"><span class="hs-identifier hs-var">DynWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="annottext">GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553336"><span class="hs-identifier hs-var">runGhcProg</span></a></span><span> </span><span class="annot"><span class="annottext">(GhcOptions -&gt; IO ()) -&gt; GhcOptions -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File] -&gt; GhcOptions
</span><a href="#local-6989586621679553492"><span class="hs-identifier hs-var">ghcSharedLinkArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553522"><span class="hs-identifier hs-var">dynamicObjectFiles</span></a></span><span>
</span><span id="line-442"></span><span>      </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#StaticWay"><span class="hs-identifier hs-var">StaticWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.LocalBuildInfo.html#withVanillaLib"><span class="hs-identifier hs-var">withVanillaLib</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>          </span><span class="annot"><span class="annottext">Verbosity
-&gt; LocalBuildInfo
-&gt; SymbolicPath Pkg 'File
-&gt; [SymbolicPath Pkg 'File]
-&gt; IO ()
</span><a href="Distribution.Simple.Program.Ar.html#createArLibArchive"><span class="hs-identifier hs-var">Ar.createArLibArchive</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553335"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
forall {c3 :: FileOrDir}. SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553370"><span class="hs-identifier hs-var">vanillaLibFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553519"><span class="hs-identifier hs-var">staticObjectFiles</span></a></span><span>
</span><span id="line-445"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.LocalBuildInfo.html#withGHCiLib"><span class="hs-identifier hs-var">withGHCiLib</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679553541"><span class="annot"><a href="#local-6989586621679553541"><span class="hs-identifier hs-var">ldProg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Program -&gt; ProgramDb -&gt; IO (ConfiguredProgram, ProgramDb)
</span><a href="Distribution.Simple.Program.Db.html#requireProgram"><span class="hs-identifier hs-var">requireProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553335"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="Distribution.Simple.Program.Builtin.html#ldProgram"><span class="hs-identifier hs-var">ldProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ProgramDb
</span><a href="Distribution.Types.LocalBuildInfo.html#withPrograms"><span class="hs-identifier hs-var">withPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>            </span><span class="annot"><a href="Distribution.Simple.Program.Ld.html#combineObjectFiles"><span class="hs-identifier hs-type">Ld.combineObjectFiles</span></a></span><span>
</span><span id="line-448"></span><span>              </span><span class="annot"><a href="#local-6989586621679553335"><span class="hs-identifier hs-type">verbosity</span></a></span><span>
</span><span id="line-449"></span><span>              </span><span class="annot"><a href="#local-6989586621679553338"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-450"></span><span>              </span><span class="annot"><a href="#local-6989586621679553541"><span class="hs-identifier hs-type">ldProg</span></a></span><span>
</span><span id="line-451"></span><span>              </span><span class="annot"><a href="#local-6989586621679553415"><span class="hs-identifier hs-type">ghciLibFilePath</span></a></span><span>
</span><span id="line-452"></span><span>              </span><span class="annot"><a href="#local-6989586621679553519"><span class="hs-identifier hs-type">staticObjectFiles</span></a></span><span>
</span><span id="line-453"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.LocalBuildInfo.html#withStaticLib"><span class="hs-identifier hs-var">withStaticLib</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553338"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-454"></span><span>          </span><span class="annot"><span class="annottext">GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553336"><span class="hs-identifier hs-var">runGhcProg</span></a></span><span> </span><span class="annot"><span class="annottext">(GhcOptions -&gt; IO ()) -&gt; GhcOptions -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File] -&gt; GhcOptions
forall {to1 :: FileOrDir}.
[SymbolicPathX 'AllowAbsolute Pkg to1] -&gt; GhcOptions
</span><a href="#local-6989586621679553516"><span class="hs-identifier hs-var">ghcStaticLinkArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg 'File]
</span><a href="#local-6989586621679553519"><span class="hs-identifier hs-var">staticObjectFiles</span></a></span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-comment">-- ROMES: Why exactly branch on staticObjectFiles, rather than any other build</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-comment">-- kind that we might have wanted instead?</span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-comment">-- This would be simpler by not adding every object to the invocation, and</span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-comment">-- rather using module names.</span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621679553519"><span class="hs-identifier hs-type">staticObjectFiles</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553335"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptPackages"><span class="hs-identifier hs-var">ghcOptPackages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.GHC.Internal.html#componentGhcOptions"><span class="hs-identifier hs-type">Internal.componentGhcOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553335"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553338"><span class="hs-identifier hs-type">lbi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553358"><span class="hs-identifier hs-type">libBi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553339"><span class="hs-identifier hs-type">clbi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553332"><span class="hs-identifier hs-type">buildTargetDir</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">traverse_</span></span><span> </span><span class="annot"><a href="#local-6989586621679553534"><span class="hs-identifier hs-type">linkWay</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553342"><span class="hs-identifier hs-type">wantedWays</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-comment">-- | Link the executable resulting from building this component, be it an</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- executable, test, or benchmark component.</span><span>
</span><span id="line-466"></span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#linkExecutable"><span class="hs-identifier hs-type">linkExecutable</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The linker-specific GHC options</span></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-comment">-- ^ The wanted build ways and corresponding GhcOptions that were</span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-comment">-- used to compile the modules in that way.</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Build"><span class="hs-identifier hs-type">Build</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-comment">-- ^ The target dir (2024-01:note: not the same as build target</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-comment">-- dir, see Note [Build Target Dir vs Target Dir] in Distribution.Simple.GHC.Build)</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnqualComponentName.html#UnqualComponentName"><span class="hs-identifier hs-type">UnqualComponentName</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Name of executable-like target</span></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Run the configured GHC program</span></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span id="linkExecutable"><span class="annot"><span class="annottext">linkExecutable :: GhcOptions
-&gt; (BuildWay, BuildWay -&gt; GhcOptions)
-&gt; SymbolicPath Pkg ('Dir Build)
-&gt; UnqualComponentName
-&gt; (GhcOptions -&gt; IO ())
-&gt; LocalBuildInfo
-&gt; IO ()
</span><a href="Distribution.Simple.GHC.Build.Link.html#linkExecutable"><span class="hs-identifier hs-var hs-var">linkExecutable</span></a></span></span><span> </span><span id="local-6989586621679553547"><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553547"><span class="hs-identifier hs-var">linkerOpts</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679553548"><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553548"><span class="hs-identifier hs-var">way</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553549"><span class="annot"><span class="annottext">BuildWay -&gt; GhcOptions
</span><a href="#local-6989586621679553549"><span class="hs-identifier hs-var">buildOpts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679553550"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
</span><a href="#local-6989586621679553550"><span class="hs-identifier hs-var">targetDir</span></a></span></span><span> </span><span id="local-6989586621679553551"><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679553551"><span class="hs-identifier hs-var">targetName</span></a></span></span><span> </span><span id="local-6989586621679553552"><span class="annot"><span class="annottext">GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553552"><span class="hs-identifier hs-var">runGhcProg</span></a></span></span><span> </span><span id="local-6989586621679553553"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553553"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-482"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553554"><span class="annot"><span class="annottext">baseOpts :: GhcOptions
</span><a href="#local-6989586621679553554"><span class="hs-identifier hs-var hs-var hs-var">baseOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuildWay -&gt; GhcOptions
</span><a href="#local-6989586621679553549"><span class="hs-identifier hs-var">buildOpts</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553548"><span class="hs-identifier hs-var">way</span></a></span><span>
</span><span id="line-483"></span><span>      </span><span id="local-6989586621679553566"><span class="annot"><span class="annottext">linkOpts :: GhcOptions
</span><a href="#local-6989586621679553566"><span class="hs-identifier hs-var hs-var hs-var">linkOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>        </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553554"><span class="hs-identifier hs-var">baseOpts</span></a></span><span>
</span><span id="line-485"></span><span>          </span><span class="annot"><span class="annottext">GhcOptions -&gt; GhcOptions -&gt; GhcOptions
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553547"><span class="hs-identifier hs-var">linkerOpts</span></a></span><span>
</span><span id="line-486"></span><span>          </span><span class="annot"><span class="annottext">GhcOptions -&gt; GhcOptions -&gt; GhcOptions
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">GhcOptions
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-487"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- If there are no input Haskell files we pass -no-hs-main, and</span><span>
</span><span id="line-488"></span><span>              </span><span class="hs-comment">-- assume there is a main function in another non-haskell object</span><span>
</span><span id="line-489"></span><span>              </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkNoHsMain"><span class="hs-identifier hs-var">ghcOptLinkNoHsMain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputFiles"><span class="hs-identifier hs-var">ghcOptInputFiles</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553554"><span class="hs-identifier hs-type">baseOpts</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptInputScripts"><span class="hs-identifier hs-var">ghcOptInputScripts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553554"><span class="hs-identifier hs-type">baseOpts</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-491"></span><span>      </span><span id="local-6989586621679553569"><span class="annot"><span class="annottext">comp :: Compiler
</span><a href="#local-6989586621679553569"><span class="hs-identifier hs-var hs-var hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553553"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-comment">-- Work around old GHCs not relinking in this</span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-comment">-- situation, see #3294</span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553577"><span class="annot"><span class="annottext">target :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553577"><span class="hs-identifier hs-var hs-var hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-496"></span><span>        </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
</span><a href="#local-6989586621679553550"><span class="hs-identifier hs-var">targetDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
-&gt; RelativePath Build c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Build c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; UnqualComponentName -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Utils.html#exeTargetName"><span class="hs-identifier hs-var">exeTargetName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553553"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679553551"><span class="hs-identifier hs-var">targetName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; Version
</span><a href="Distribution.Simple.Compiler.html#compilerVersion"><span class="hs-identifier hs-var">compilerVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679553569"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-var">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553578"><span class="annot"><span class="annottext">targetPath :: FilePath
</span><a href="#local-6989586621679553578"><span class="hs-identifier hs-var hs-var hs-var">targetPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
-&gt; SymbolicPathX 'AllowAbsolute Pkg (ZonkAny 1) -&gt; FilePath
forall (allowAbsolute :: AllowAbsolute) (to :: FileOrDir).
LocalBuildInfo -&gt; SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
</span><a href="Distribution.Simple.LocalBuildInfo.html#interpretSymbolicPathLBI"><span class="hs-identifier hs-var">interpretSymbolicPathLBI</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553553"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'AllowAbsolute Pkg (ZonkAny 1)
forall {c3 :: FileOrDir}. SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553577"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-499"></span><span>    </span><span id="local-6989586621679553579"><span class="annot"><a href="#local-6989586621679553579"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553578"><span class="hs-identifier hs-var">targetPath</span></a></span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="annot"><a href="#local-6989586621679553579"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#removeFile"><span class="hs-identifier hs-type">removeFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553578"><span class="hs-identifier hs-type">targetPath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="annottext">GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553552"><span class="hs-identifier hs-var">runGhcProg</span></a></span><span> </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553566"><span class="hs-identifier hs-var">linkOpts</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptOutputFile"><span class="hs-identifier hs-var">ghcOptOutputFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553577"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="annot"><span class="hs-comment">-- | Link a foreign library component</span></span><span>
</span><span id="line-504"></span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#linkFLib"><span class="hs-identifier hs-type">linkFLib</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#ForeignLib"><span class="hs-identifier hs-type">ForeignLib</span></a></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#BuildInfo"><span class="hs-identifier hs-type">BuildInfo</span></a></span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The linker-specific GHC options</span></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html#BuildWay"><span class="hs-identifier hs-type">BuildWay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-comment">-- ^ The wanted build ways and corresponding GhcOptions that were</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-comment">-- used to compile the modules in that way.</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Build"><span class="hs-identifier hs-type">Build</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-comment">-- ^ The target dir (2024-01:note: not the same as build target</span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-comment">-- dir, see Note [Build Target Dir vs Target Dir] in Distribution.Simple.GHC.Build)</span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Run the configured GHC program</span></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span id="linkFLib"><span class="annot"><span class="annottext">linkFLib :: ForeignLib
-&gt; BuildInfo
-&gt; LocalBuildInfo
-&gt; GhcOptions
-&gt; (BuildWay, BuildWay -&gt; GhcOptions)
-&gt; SymbolicPath Pkg ('Dir Build)
-&gt; (GhcOptions -&gt; IO ())
-&gt; IO ()
</span><a href="Distribution.Simple.GHC.Build.Link.html#linkFLib"><span class="hs-identifier hs-var hs-var">linkFLib</span></a></span></span><span> </span><span id="local-6989586621679553580"><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679553580"><span class="hs-identifier hs-var">flib</span></a></span></span><span> </span><span id="local-6989586621679553581"><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679553581"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span id="local-6989586621679553582"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553582"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span id="local-6989586621679553583"><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553583"><span class="hs-identifier hs-var">linkerOpts</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679553584"><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553584"><span class="hs-identifier hs-var">way</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553585"><span class="annot"><span class="annottext">BuildWay -&gt; GhcOptions
</span><a href="#local-6989586621679553585"><span class="hs-identifier hs-var">buildOpts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679553586"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
</span><a href="#local-6989586621679553586"><span class="hs-identifier hs-var">targetDir</span></a></span></span><span> </span><span id="local-6989586621679553587"><span class="annot"><span class="annottext">GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553587"><span class="hs-identifier hs-var">runGhcProg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-521"></span><span>    </span><span id="local-6989586621679553588"><span class="annot"><span class="annottext">comp :: Compiler
</span><a href="#local-6989586621679553588"><span class="hs-identifier hs-var hs-var hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553582"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-comment">-- Instruct GHC to link against libHSrts.</span><span>
</span><span id="line-524"></span><span>    </span><span class="annot"><a href="#local-6989586621679553589"><span class="hs-identifier hs-type">rtsLinkOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span>
</span><span id="line-525"></span><span>    </span><span id="local-6989586621679553589"><span class="annot"><span class="annottext">rtsLinkOpts :: GhcOptions
</span><a href="#local-6989586621679553589"><span class="hs-identifier hs-var hs-var hs-var">rtsLinkOpts</span></a></span></span><span>
</span><span id="line-526"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679553590"><span class="hs-identifier hs-var">supportsFLinkRts</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-527"></span><span>          </span><span class="annot"><span class="annottext">GhcOptions
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-528"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkRts"><span class="hs-identifier hs-var">ghcOptLinkRts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-529"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-530"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-531"></span><span>          </span><span class="annot"><span class="annottext">GhcOptions
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-532"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibs"><span class="hs-identifier hs-var">ghcOptLinkLibs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679553592"><span class="hs-identifier hs-type">rtsOptLinkLibs</span></a></span><span>
</span><span id="line-533"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkLibPath"><span class="hs-identifier hs-var">ghcOptLinkLibPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeSymbolicPath"><span class="hs-identifier hs-type">makeSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#rtsLibPaths"><span class="hs-identifier hs-var">rtsLibPaths</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553595"><span class="hs-identifier hs-type">rtsInfo</span></a></span><span>
</span><span id="line-534"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-535"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-536"></span><span>        </span><span id="local-6989586621679553596"><span class="annot"><span class="annottext">threaded :: Bool
</span><a href="#local-6989586621679553596"><span class="hs-identifier hs-var hs-var">threaded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; Bool
</span><a href="Distribution.Simple.GHC.Build.Link.html#hasThreaded"><span class="hs-identifier hs-var">hasThreaded</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679553581"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-537"></span><span>        </span><span id="local-6989586621679553590"><span class="annot"><span class="annottext">supportsFLinkRts :: Bool
</span><a href="#local-6989586621679553590"><span class="hs-identifier hs-var hs-var">supportsFLinkRts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Version
</span><a href="Distribution.Simple.Compiler.html#compilerVersion"><span class="hs-identifier hs-var">compilerVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679553588"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-var">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span>        </span><span id="local-6989586621679553595"><span class="annot"><span class="annottext">rtsInfo :: RtsInfo
</span><a href="#local-6989586621679553595"><span class="hs-identifier hs-var hs-var">rtsInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; RtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#extractRtsInfo"><span class="hs-identifier hs-var">extractRtsInfo</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553582"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-539"></span><span>        </span><span id="local-6989586621679553592"><span class="annot"><span class="annottext">rtsOptLinkLibs :: [FilePath]
</span><a href="#local-6989586621679553592"><span class="hs-identifier hs-var hs-var">rtsOptLinkLibs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-540"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ForeignLib -&gt; Bool
</span><a href="Distribution.Simple.GHC.Build.Utils.html#withDynFLib"><span class="hs-identifier hs-var">withDynFLib</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679553580"><span class="hs-identifier hs-var">flib</span></a></span><span>
</span><span id="line-541"></span><span>              </span><span class="hs-keyword">then</span><span>
</span><span id="line-542"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679553596"><span class="hs-identifier hs-var">threaded</span></a></span><span>
</span><span id="line-543"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DynamicRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsThreadedLib"><span class="hs-identifier hs-var">dynRtsThreadedLib</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RtsInfo -&gt; DynamicRtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsDynamicInfo"><span class="hs-identifier hs-var">rtsDynamicInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RtsInfo
</span><a href="#local-6989586621679553595"><span class="hs-identifier hs-var">rtsInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">DynamicRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsVanillaLib"><span class="hs-identifier hs-var">dynRtsVanillaLib</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RtsInfo -&gt; DynamicRtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsDynamicInfo"><span class="hs-identifier hs-var">rtsDynamicInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RtsInfo
</span><a href="#local-6989586621679553595"><span class="hs-identifier hs-var">rtsInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>              </span><span class="hs-keyword">else</span><span>
</span><span id="line-546"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679553596"><span class="hs-identifier hs-var">threaded</span></a></span><span>
</span><span id="line-547"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedLib"><span class="hs-identifier hs-var">statRtsThreadedLib</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RtsInfo -&gt; StaticRtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsStaticInfo"><span class="hs-identifier hs-var">rtsStaticInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RtsInfo
</span><a href="#local-6989586621679553595"><span class="hs-identifier hs-var">rtsInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsVanillaLib"><span class="hs-identifier hs-var">statRtsVanillaLib</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RtsInfo -&gt; StaticRtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsStaticInfo"><span class="hs-identifier hs-var">rtsStaticInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RtsInfo
</span><a href="#local-6989586621679553595"><span class="hs-identifier hs-var">rtsInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><a href="#local-6989586621679553606"><span class="hs-identifier hs-type">linkOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621679553606"><span class="annot"><span class="annottext">linkOpts :: GhcOptions
</span><a href="#local-6989586621679553606"><span class="hs-identifier hs-var hs-var hs-var">linkOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ForeignLib -&gt; ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibType"><span class="hs-identifier hs-var">foreignLibType</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679553580"><span class="hs-identifier hs-var">flib</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-553"></span><span>      </span><span class="annot"><span class="annottext">ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibNativeShared"><span class="hs-identifier hs-var">ForeignLibNativeShared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-554"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildWay -&gt; GhcOptions
</span><a href="#local-6989586621679553585"><span class="hs-identifier hs-var">buildOpts</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="#local-6989586621679553584"><span class="hs-identifier hs-var">way</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>          </span><span class="annot"><span class="annottext">GhcOptions -&gt; GhcOptions -&gt; GhcOptions
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553583"><span class="hs-identifier hs-var">linkerOpts</span></a></span><span>
</span><span id="line-556"></span><span>          </span><span class="annot"><span class="annottext">GhcOptions -&gt; GhcOptions -&gt; GhcOptions
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553589"><span class="hs-identifier hs-var">rtsLinkOpts</span></a></span><span>
</span><span id="line-557"></span><span>          </span><span class="annot"><span class="annottext">GhcOptions -&gt; GhcOptions -&gt; GhcOptions
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">GhcOptions
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-558"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkNoHsMain"><span class="hs-identifier hs-var">ghcOptLinkNoHsMain</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-559"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptShared"><span class="hs-identifier hs-var">ghcOptShared</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-560"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptFPic"><span class="hs-identifier hs-var">ghcOptFPic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-561"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptLinkModDefFiles"><span class="hs-identifier hs-var">ghcOptLinkModDefFiles</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-type">toNubListR</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-type">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibModDefFile"><span class="hs-identifier hs-var">foreignLibModDefFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553580"><span class="hs-identifier hs-type">flib</span></a></span><span>
</span><span id="line-562"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-563"></span><span>      </span><span class="annot"><span class="annottext">ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibNativeStatic"><span class="hs-identifier hs-var">ForeignLibNativeStatic</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-564"></span><span>        </span><span class="hs-comment">-- this should be caught by buildFLib</span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-comment">-- (and if we do implement this, we probably don't even want to call</span><span>
</span><span id="line-566"></span><span>        </span><span class="hs-comment">-- ghc here, but rather Ar.createArLibArchive or something)</span><span>
</span><span id="line-567"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; GhcOptions
forall a. FilePath -&gt; a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.Utils.html#cabalBug"><span class="hs-identifier hs-var">cabalBug</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;static libraries not yet implemented&quot;</span></span><span>
</span><span id="line-568"></span><span>      </span><span class="annot"><span class="annottext">ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibTypeUnknown"><span class="hs-identifier hs-var">ForeignLibTypeUnknown</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-569"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; GhcOptions
forall a. FilePath -&gt; a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.Utils.html#cabalBug"><span class="hs-identifier hs-var">cabalBug</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;unknown foreign lib type&quot;</span></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-comment">-- We build under a (potentially) different filename to set a</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-comment">-- soname on supported platforms.  See also the note for</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-comment">-- @flibBuildName@.</span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553614"><span class="annot"><span class="annottext">buildName :: FilePath
</span><a href="#local-6989586621679553614"><span class="hs-identifier hs-var hs-var hs-var">buildName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ForeignLib -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Utils.html#flibBuildName"><span class="hs-identifier hs-var">flibBuildName</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553582"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679553580"><span class="hs-identifier hs-var">flib</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553622"><span class="annot"><span class="annottext">outFile :: SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553622"><span class="hs-identifier hs-var hs-var hs-var">outFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
</span><a href="#local-6989586621679553586"><span class="hs-identifier hs-var">targetDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
-&gt; RelativePath Build c3 -&gt; SymbolicPathX 'AllowAbsolute Pkg c3
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RelativePath Build c3
forall from (to :: FileOrDir).
HasCallStack =&gt;
FilePath -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553614"><span class="hs-identifier hs-var">buildName</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span class="annot"><span class="annottext">GhcOptions -&gt; IO ()
</span><a href="#local-6989586621679553587"><span class="hs-identifier hs-var">runGhcProg</span></a></span><span> </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553606"><span class="hs-identifier hs-var">linkOpts</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptOutputFile"><span class="hs-identifier hs-var">ghcOptOutputFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-type">toFlag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553622"><span class="hs-identifier hs-type">outFile</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553623"><span class="annot"><span class="annottext">i :: SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
</span><a href="#local-6989586621679553623"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
forall (allowAbsolute :: AllowAbsolute) (to :: FileOrDir).
LocalBuildInfo -&gt; SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
</span><a href="Distribution.Simple.LocalBuildInfo.html#interpretSymbolicPathLBI"><span class="hs-identifier hs-var">interpretSymbolicPathLBI</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553582"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#renameFile"><span class="hs-identifier hs-var">renameFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicPathX 'AllowAbsolute Pkg (ZonkAny 0) -&gt; FilePath
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
</span><a href="#local-6989586621679553623"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'AllowAbsolute Pkg (ZonkAny 0)
forall {c3 :: FileOrDir}. SymbolicPathX 'AllowAbsolute Pkg c3
</span><a href="#local-6989586621679553622"><span class="hs-identifier hs-var">outFile</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build) -&gt; FilePath
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; FilePath
</span><a href="#local-6989586621679553623"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
</span><a href="#local-6989586621679553586"><span class="hs-identifier hs-var">targetDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ForeignLib -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Utils.html#flibTargetName"><span class="hs-identifier hs-var">flibTargetName</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553582"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679553580"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>
</span><span id="line-579"></span><span class="hs-comment">-- | Calculate the RPATHs for the component we are building.</span><span>
</span><span id="line-580"></span><span class="hs-comment">--</span><span>
</span><span id="line-581"></span><span class="hs-comment">-- Calculates relative RPATHs when 'relocatable' is set.</span><span>
</span><span id="line-582"></span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#getRPaths"><span class="hs-identifier hs-type">getRPaths</span></a></span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Build.Inputs.html#PreBuildComponentInputs"><span class="hs-identifier hs-type">PreBuildComponentInputs</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The context and component being built in it.</span></span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Utils.NubList.html#NubListR"><span class="hs-identifier hs-type">NubListR</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span id="getRPaths"><span class="annot"><span class="annottext">getRPaths :: PreBuildComponentInputs -&gt; IO (NubListR FilePath)
</span><a href="Distribution.Simple.GHC.Build.Link.html#getRPaths"><span class="hs-identifier hs-var hs-var">getRPaths</span></a></span></span><span> </span><span id="local-6989586621679553625"><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553625"><span class="hs-identifier hs-var">pbci</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-587"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621679553626"><span class="annot"><span class="annottext">lbi :: LocalBuildInfo
</span><a href="#local-6989586621679553626"><span class="hs-identifier hs-var hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; LocalBuildInfo
</span><a href="Distribution.Simple.Build.Inputs.html#localBuildInfo"><span class="hs-identifier hs-var">localBuildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553625"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-589"></span><span>    </span><span id="local-6989586621679553627"><span class="annot"><span class="annottext">bi :: BuildInfo
</span><a href="#local-6989586621679553627"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; BuildInfo
</span><a href="Distribution.Simple.Build.Inputs.html#buildBI"><span class="hs-identifier hs-var">buildBI</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553625"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621679553628"><span class="annot"><span class="annottext">clbi :: ComponentLocalBuildInfo
</span><a href="#local-6989586621679553628"><span class="hs-identifier hs-var hs-var">clbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs -&gt; ComponentLocalBuildInfo
</span><a href="Distribution.Simple.Build.Inputs.html#buildCLBI"><span class="hs-identifier hs-var">buildCLBI</span></a></span><span> </span><span class="annot"><span class="annottext">PreBuildComponentInputs
</span><a href="#local-6989586621679553625"><span class="hs-identifier hs-var">pbci</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="annot"><span class="annottext">Arch
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679553629"><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679553629"><span class="hs-identifier hs-var">hostOS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553626"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621679553630"><span class="annot"><span class="annottext">compid :: CompilerId
</span><a href="#local-6989586621679553630"><span class="hs-identifier hs-var hs-var">compid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; CompilerId
</span><a href="Distribution.Simple.Compiler.html#compilerId"><span class="hs-identifier hs-var">compilerId</span></a></span><span> </span><span class="annot"><span class="annottext">(Compiler -&gt; CompilerId)
-&gt; (LocalBuildInfo -&gt; Compiler) -&gt; LocalBuildInfo -&gt; CompilerId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalBuildInfo -&gt; CompilerId) -&gt; LocalBuildInfo -&gt; CompilerId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553626"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span>    </span><span class="hs-comment">-- The list of RPath-supported operating systems below reflects the</span><span>
</span><span id="line-596"></span><span>    </span><span class="hs-comment">-- platforms on which Cabal's RPATH handling is tested. It does _NOT_</span><span>
</span><span id="line-597"></span><span>    </span><span class="hs-comment">-- reflect whether the OS supports RPATH.</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span>    </span><span class="hs-comment">-- E.g. when this comment was written, the *BSD operating systems were</span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-comment">-- untested with regards to Cabal RPATH handling, and were hence set to</span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-comment">-- 'False', while those operating systems themselves do support RPATH.</span><span>
</span><span id="line-602"></span><span>    </span><span id="local-6989586621679553632"><span class="annot"><span class="annottext">supportRPaths :: OS -&gt; Bool
</span><a href="#local-6989586621679553632"><span class="hs-identifier hs-var hs-var">supportRPaths</span></a></span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Linux"><span class="hs-identifier hs-var">Linux</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-603"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Windows"><span class="hs-identifier hs-var">Windows</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-604"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OSX"><span class="hs-identifier hs-var">OSX</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-605"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#FreeBSD"><span class="hs-identifier hs-var">FreeBSD</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-606"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CompilerId
</span><a href="#local-6989586621679553630"><span class="hs-identifier hs-var">compid</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-607"></span><span>        </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#CompilerId"><span class="hs-identifier hs-type">CompilerId</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span> </span><span id="local-6989586621679553637"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679553637"><span class="hs-identifier hs-var">ver</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679553637"><span class="hs-identifier hs-var">ver</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-var">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-608"></span><span>        </span><span class="annot"><span class="annottext">CompilerId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OpenBSD"><span class="hs-identifier hs-var">OpenBSD</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-610"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#NetBSD"><span class="hs-identifier hs-var">NetBSD</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-611"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#DragonFly"><span class="hs-identifier hs-var">DragonFly</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Solaris"><span class="hs-identifier hs-var">Solaris</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#AIX"><span class="hs-identifier hs-var">AIX</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-614"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#HPUX"><span class="hs-identifier hs-var">HPUX</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-615"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#IRIX"><span class="hs-identifier hs-var">IRIX</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#HaLVM"><span class="hs-identifier hs-var">HaLVM</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#IOS"><span class="hs-identifier hs-var">IOS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Android"><span class="hs-identifier hs-var">Android</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-619"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Ghcjs"><span class="hs-identifier hs-var">Ghcjs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Wasi"><span class="hs-identifier hs-var">Wasi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-621"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Hurd"><span class="hs-identifier hs-var">Hurd</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-622"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Haiku"><span class="hs-identifier hs-var">Haiku</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-623"></span><span>    </span><span class="annot"><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OtherOS"><span class="hs-identifier hs-type">OtherOS</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-comment">-- Do _not_ add a default case so that we get a warning here when a new OS</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-comment">-- is added.</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">OS -&gt; Bool
</span><a href="#local-6989586621679553632"><span class="hs-identifier hs-var">supportRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679553629"><span class="hs-identifier hs-var">hostOS</span></a></span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>      </span><span id="local-6989586621679553653"><span class="annot"><a href="#local-6989586621679553653"><span class="hs-identifier hs-var">libraryPaths</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [FilePath] -&gt; IO [FilePath]
forall a. IO a -&gt; IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO [FilePath] -&gt; IO [FilePath]) -&gt; IO [FilePath] -&gt; IO [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Bool
-&gt; LocalBuildInfo
-&gt; ComponentLocalBuildInfo
-&gt; IO [FilePath]
</span><a href="Distribution.Simple.LocalBuildInfo.html#depLibraryPaths"><span class="hs-identifier hs-var">depLibraryPaths</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.LocalBuildInfo.html#relocatable"><span class="hs-identifier hs-var">relocatable</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553626"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553626"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553628"><span class="hs-identifier hs-var">clbi</span></a></span><span>
</span><span id="line-630"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553655"><span class="annot"><a href="#local-6989586621679553655"><span class="hs-identifier hs-var hs-var">hostPref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679553629"><span class="hs-identifier hs-var">hostOS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-631"></span><span>            </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OSX"><span class="hs-identifier hs-var">OSX</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;@loader_path&quot;</span></span><span>
</span><span id="line-632"></span><span>            </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;$ORIGIN&quot;</span></span><span>
</span><span id="line-633"></span><span>          </span><span id="local-6989586621679553657"><span class="annot"><a href="#local-6989586621679553657"><span class="hs-identifier hs-var hs-var">relPath</span></a></span></span><span> </span><span id="local-6989586621679553658"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553658"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.Posix.html#isRelative"><span class="hs-identifier hs-var">isRelative</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553658"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553655"><span class="hs-identifier hs-var">hostPref</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553658"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553658"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-634"></span><span>          </span><span id="local-6989586621679553665"><span class="annot"><a href="#local-6989586621679553665"><span class="hs-identifier hs-var hs-var">rpaths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-635"></span><span>            </span><span class="annot"><span class="annottext">[FilePath] -&gt; NubListR FilePath
forall a. Ord a =&gt; [a] -&gt; NubListR a
</span><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-var">toNubListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679553657"><span class="hs-identifier hs-var">relPath</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679553653"><span class="hs-identifier hs-var">libraryPaths</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>              </span><span class="annot"><span class="annottext">NubListR FilePath -&gt; NubListR FilePath -&gt; NubListR FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; NubListR FilePath
forall a. Ord a =&gt; [a] -&gt; NubListR a
</span><a href="Distribution.Utils.NubList.html#toNubListR"><span class="hs-identifier hs-var">toNubListR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SymbolicPath Pkg ('Dir Lib) -&gt; FilePath)
-&gt; [SymbolicPath Pkg ('Dir Lib)] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Lib) -&gt; FilePath
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">([SymbolicPath Pkg ('Dir Lib)] -&gt; [FilePath])
-&gt; [SymbolicPath Pkg ('Dir Lib)] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPath Pkg ('Dir Lib)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirs"><span class="hs-identifier hs-var">extraLibDirs</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679553627"><span class="hs-identifier hs-var">bi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679553665"><span class="hs-identifier hs-type">rpaths</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">NubListR FilePath -&gt; IO (NubListR FilePath)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">NubListR FilePath
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-keyword">data</span><span> </span><span id="DynamicRtsInfo"><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#DynamicRtsInfo"><span class="hs-identifier hs-var">DynamicRtsInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DynamicRtsInfo"><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#DynamicRtsInfo"><span class="hs-identifier hs-var">DynamicRtsInfo</span></a></span></span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="dynRtsVanillaLib"><span class="annot"><span class="annottext">DynamicRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsVanillaLib"><span class="hs-identifier hs-var hs-var">dynRtsVanillaLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-642"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dynRtsThreadedLib"><span class="annot"><span class="annottext">DynamicRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsThreadedLib"><span class="hs-identifier hs-var hs-var">dynRtsThreadedLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dynRtsDebugLib"><span class="annot"><span class="annottext">DynamicRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsDebugLib"><span class="hs-identifier hs-var hs-var">dynRtsDebugLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dynRtsEventlogLib"><span class="annot"><span class="annottext">DynamicRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsEventlogLib"><span class="hs-identifier hs-var hs-var">dynRtsEventlogLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dynRtsThreadedDebugLib"><span class="annot"><span class="annottext">DynamicRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsThreadedDebugLib"><span class="hs-identifier hs-var hs-var">dynRtsThreadedDebugLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dynRtsThreadedEventlogLib"><span class="annot"><span class="annottext">DynamicRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsThreadedEventlogLib"><span class="hs-identifier hs-var hs-var">dynRtsThreadedEventlogLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span class="hs-keyword">data</span><span> </span><span id="StaticRtsInfo"><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#StaticRtsInfo"><span class="hs-identifier hs-var">StaticRtsInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StaticRtsInfo"><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#StaticRtsInfo"><span class="hs-identifier hs-var">StaticRtsInfo</span></a></span></span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="statRtsVanillaLib"><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsVanillaLib"><span class="hs-identifier hs-var hs-var">statRtsVanillaLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-651"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRtsThreadedLib"><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedLib"><span class="hs-identifier hs-var hs-var">statRtsThreadedLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRtsDebugLib"><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsDebugLib"><span class="hs-identifier hs-var hs-var">statRtsDebugLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-653"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRtsEventlogLib"><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsEventlogLib"><span class="hs-identifier hs-var hs-var">statRtsEventlogLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRtsThreadedDebugLib"><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedDebugLib"><span class="hs-identifier hs-var hs-var">statRtsThreadedDebugLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRtsThreadedEventlogLib"><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedEventlogLib"><span class="hs-identifier hs-var hs-var">statRtsThreadedEventlogLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRtsProfilingLib"><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsProfilingLib"><span class="hs-identifier hs-var hs-var">statRtsProfilingLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statRtsThreadedProfilingLib"><span class="annot"><span class="annottext">StaticRtsInfo -&gt; FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedProfilingLib"><span class="hs-identifier hs-var hs-var">statRtsThreadedProfilingLib</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-keyword">data</span><span> </span><span id="RtsInfo"><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#RtsInfo"><span class="hs-identifier hs-var">RtsInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RtsInfo"><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#RtsInfo"><span class="hs-identifier hs-var">RtsInfo</span></a></span></span><span>
</span><span id="line-661"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="rtsDynamicInfo"><span class="annot"><span class="annottext">RtsInfo -&gt; DynamicRtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsDynamicInfo"><span class="hs-identifier hs-var hs-var">rtsDynamicInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#DynamicRtsInfo"><span class="hs-identifier hs-type">DynamicRtsInfo</span></a></span><span>
</span><span id="line-662"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="rtsStaticInfo"><span class="annot"><span class="annottext">RtsInfo -&gt; StaticRtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsStaticInfo"><span class="hs-identifier hs-var hs-var">rtsStaticInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#StaticRtsInfo"><span class="hs-identifier hs-type">StaticRtsInfo</span></a></span><span>
</span><span id="line-663"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="rtsLibPaths"><span class="annot"><span class="annottext">RtsInfo -&gt; [FilePath]
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsLibPaths"><span class="hs-identifier hs-var hs-var">rtsLibPaths</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">-- | Extract (and compute) information about the RTS library</span><span>
</span><span id="line-667"></span><span class="hs-comment">--</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- TODO: This hardcodes the name as @HSrts-ghc&lt;version&gt;@. I don't know if we can</span><span>
</span><span id="line-669"></span><span class="hs-comment">-- find this information somewhere. We can lookup the 'hsLibraries' field of</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- 'InstalledPackageInfo' but it will tell us @[&quot;HSrts&quot;, &quot;Cffi&quot;]@, which</span><span>
</span><span id="line-671"></span><span class="hs-comment">-- doesn't really help.</span><span>
</span><span id="line-672"></span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#extractRtsInfo"><span class="hs-identifier hs-type">extractRtsInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#RtsInfo"><span class="hs-identifier hs-type">RtsInfo</span></a></span><span>
</span><span id="line-673"></span><span id="extractRtsInfo"><span class="annot"><span class="annottext">extractRtsInfo :: LocalBuildInfo -&gt; RtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#extractRtsInfo"><span class="hs-identifier hs-var hs-var">extractRtsInfo</span></a></span></span><span> </span><span id="local-6989586621679553679"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553679"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-674"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PackageIndex InstalledPackageInfo
-&gt; PackageName -&gt; [(Version, [InstalledPackageInfo])]
forall a. PackageIndex a -&gt; PackageName -&gt; [(Version, [a])]
</span><a href="Distribution.Simple.PackageIndex.html#lookupPackageName"><span class="hs-identifier hs-var">PackageIndex.lookupPackageName</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; PackageIndex InstalledPackageInfo
</span><a href="Distribution.Types.LocalBuildInfo.html#installedPkgs"><span class="hs-identifier hs-var">installedPkgs</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553679"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; PackageName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#mkPackageName"><span class="hs-identifier hs-var">mkPackageName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;rts&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-677"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679553683"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679553683"><span class="hs-identifier hs-var">rts</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; RtsInfo
</span><a href="#local-6989586621679553684"><span class="hs-identifier hs-var">aux</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679553683"><span class="hs-identifier hs-var">rts</span></a></span><span>
</span><span id="line-678"></span><span>    </span><span id="local-6989586621679553685"><span class="annot"><span class="annottext">[(Version, [InstalledPackageInfo])]
</span><a href="#local-6989586621679553685"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; RtsInfo
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;No (or multiple) ghc rts package is registered&quot;</span></span><span>
</span><span id="line-679"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-680"></span><span>    </span><span class="annot"><a href="#local-6989586621679553684"><span class="hs-identifier hs-type">aux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#RtsInfo"><span class="hs-identifier hs-type">RtsInfo</span></a></span><span>
</span><span id="line-681"></span><span>    </span><span id="local-6989586621679553684"><span class="annot"><span class="annottext">aux :: InstalledPackageInfo -&gt; RtsInfo
</span><a href="#local-6989586621679553684"><span class="hs-identifier hs-var hs-var">aux</span></a></span></span><span> </span><span id="local-6989586621679553687"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679553687"><span class="hs-identifier hs-var">rts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-682"></span><span>      </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#RtsInfo"><span class="hs-identifier hs-type">RtsInfo</span></a></span><span>
</span><span id="line-683"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rtsDynamicInfo :: DynamicRtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsDynamicInfo"><span class="hs-identifier hs-var">rtsDynamicInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-684"></span><span>            </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#DynamicRtsInfo"><span class="hs-identifier hs-type">DynamicRtsInfo</span></a></span><span>
</span><span id="line-685"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dynRtsVanillaLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsVanillaLib"><span class="hs-identifier hs-var">dynRtsVanillaLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679553688"><span class="hs-identifier hs-var">withGhcVersion</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts&quot;</span></span><span>
</span><span id="line-686"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dynRtsThreadedLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsThreadedLib"><span class="hs-identifier hs-var">dynRtsThreadedLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679553688"><span class="hs-identifier hs-var">withGhcVersion</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_thr&quot;</span></span><span>
</span><span id="line-687"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dynRtsDebugLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsDebugLib"><span class="hs-identifier hs-var">dynRtsDebugLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679553688"><span class="hs-identifier hs-var">withGhcVersion</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_debug&quot;</span></span><span>
</span><span id="line-688"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dynRtsEventlogLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsEventlogLib"><span class="hs-identifier hs-var">dynRtsEventlogLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679553688"><span class="hs-identifier hs-var">withGhcVersion</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_l&quot;</span></span><span>
</span><span id="line-689"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dynRtsThreadedDebugLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsThreadedDebugLib"><span class="hs-identifier hs-var">dynRtsThreadedDebugLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679553688"><span class="hs-identifier hs-var">withGhcVersion</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_thr_debug&quot;</span></span><span>
</span><span id="line-690"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dynRtsThreadedEventlogLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#dynRtsThreadedEventlogLib"><span class="hs-identifier hs-var">dynRtsThreadedEventlogLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="#local-6989586621679553688"><span class="hs-identifier hs-var">withGhcVersion</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_thr_l&quot;</span></span><span>
</span><span id="line-691"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-692"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rtsStaticInfo :: StaticRtsInfo
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsStaticInfo"><span class="hs-identifier hs-var">rtsStaticInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-693"></span><span>            </span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#StaticRtsInfo"><span class="hs-identifier hs-type">StaticRtsInfo</span></a></span><span>
</span><span id="line-694"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">statRtsVanillaLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsVanillaLib"><span class="hs-identifier hs-var">statRtsVanillaLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts&quot;</span></span><span>
</span><span id="line-695"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRtsThreadedLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedLib"><span class="hs-identifier hs-var">statRtsThreadedLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_thr&quot;</span></span><span>
</span><span id="line-696"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRtsDebugLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsDebugLib"><span class="hs-identifier hs-var">statRtsDebugLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_debug&quot;</span></span><span>
</span><span id="line-697"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRtsEventlogLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsEventlogLib"><span class="hs-identifier hs-var">statRtsEventlogLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_l&quot;</span></span><span>
</span><span id="line-698"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRtsThreadedDebugLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedDebugLib"><span class="hs-identifier hs-var">statRtsThreadedDebugLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_thr_debug&quot;</span></span><span>
</span><span id="line-699"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRtsThreadedEventlogLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedEventlogLib"><span class="hs-identifier hs-var">statRtsThreadedEventlogLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_thr_l&quot;</span></span><span>
</span><span id="line-700"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRtsProfilingLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsProfilingLib"><span class="hs-identifier hs-var">statRtsProfilingLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_p&quot;</span></span><span>
</span><span id="line-701"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">statRtsThreadedProfilingLib :: FilePath
</span><a href="Distribution.Simple.GHC.Build.Link.html#statRtsThreadedProfilingLib"><span class="hs-identifier hs-var">statRtsThreadedProfilingLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;HSrts_thr_p&quot;</span></span><span>
</span><span id="line-702"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-703"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rtsLibPaths :: [FilePath]
</span><a href="Distribution.Simple.GHC.Build.Link.html#rtsLibPaths"><span class="hs-identifier hs-var">rtsLibPaths</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; [FilePath]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#libraryDirs"><span class="hs-identifier hs-var">InstalledPackageInfo.libraryDirs</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679553687"><span class="hs-identifier hs-var">rts</span></a></span><span>
</span><span id="line-704"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-705"></span><span>    </span><span id="local-6989586621679553688"><span class="annot"><span class="annottext">withGhcVersion :: FilePath -&gt; FilePath
</span><a href="#local-6989586621679553688"><span class="hs-identifier hs-var hs-var">withGhcVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-ghc&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; Version
</span><a href="Distribution.Simple.Compiler.html#compilerVersion"><span class="hs-identifier hs-var">compilerVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553679"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span class="hs-comment">-- | Determine whether the given 'BuildInfo' is intended to link against the</span><span>
</span><span id="line-708"></span><span class="hs-comment">-- threaded RTS. This is used to determine which RTS to link against when</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- building a foreign library with a GHC without support for @-flink-rts@.</span><span>
</span><span id="line-710"></span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#hasThreaded"><span class="hs-identifier hs-type">hasThreaded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#BuildInfo"><span class="hs-identifier hs-type">BuildInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-711"></span><span id="hasThreaded"><span class="annot"><span class="annottext">hasThreaded :: BuildInfo -&gt; Bool
</span><a href="Distribution.Simple.GHC.Build.Link.html#hasThreaded"><span class="hs-identifier hs-var hs-var">hasThreaded</span></a></span></span><span> </span><span id="local-6989586621679553694"><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679553694"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-threaded&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679553696"><span class="hs-identifier hs-var">ghc</span></a></span><span>
</span><span id="line-712"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-713"></span><span>    </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#PerCompilerFlavor"><span class="hs-identifier hs-type">PerCompilerFlavor</span></a></span><span> </span><span id="local-6989586621679553696"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679553696"><span class="hs-identifier hs-var">ghc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; PerCompilerFlavor [FilePath]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#options"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679553694"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="hs-comment">-- | Load a target component into a repl, or write to disk a script which runs</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- GHCi with the GHC options Cabal elaborated to load the component interactively.</span><span>
</span><span id="line-717"></span><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#runReplOrWriteFlags"><span class="hs-identifier hs-type">runReplOrWriteFlags</span></a></span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Types.html#ConfiguredProgram"><span class="hs-identifier hs-type">ConfiguredProgram</span></a></span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Repl.html#ReplFlags"><span class="hs-identifier hs-type">ReplFlags</span></a></span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#GhcOptions"><span class="hs-identifier hs-type">GhcOptions</span></a></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span>
</span><span id="line-723"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.TargetInfo.html#TargetInfo"><span class="hs-identifier hs-type">TargetInfo</span></a></span><span>
</span><span id="line-724"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span id="runReplOrWriteFlags"><span class="annot"><span class="annottext">runReplOrWriteFlags :: ConfiguredProgram
-&gt; LocalBuildInfo
-&gt; ReplFlags
-&gt; GhcOptions
-&gt; PackageName
-&gt; TargetInfo
-&gt; IO ()
</span><a href="Distribution.Simple.GHC.Build.Link.html#runReplOrWriteFlags"><span class="hs-identifier hs-var hs-var">runReplOrWriteFlags</span></a></span></span><span> </span><span id="local-6989586621679553699"><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679553699"><span class="hs-identifier hs-var">ghcProg</span></a></span></span><span> </span><span id="local-6989586621679553700"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553700"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span id="local-6989586621679553701"><span class="annot"><span class="annottext">ReplFlags
</span><a href="#local-6989586621679553701"><span class="hs-identifier hs-var">rflags</span></a></span></span><span> </span><span id="local-6989586621679553702"><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553702"><span class="hs-identifier hs-var">ghcOpts</span></a></span></span><span> </span><span id="local-6989586621679553703"><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679553703"><span class="hs-identifier hs-var">pkg_name</span></a></span></span><span> </span><span id="local-6989586621679553704"><span class="annot"><span class="annottext">TargetInfo
</span><a href="#local-6989586621679553704"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553705"><span class="annot"><span class="annottext">bi :: BuildInfo
</span><a href="#local-6989586621679553705"><span class="hs-identifier hs-var hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component -&gt; BuildInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Component.html#componentBuildInfo"><span class="hs-identifier hs-var">componentBuildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Component -&gt; BuildInfo) -&gt; Component -&gt; BuildInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TargetInfo -&gt; Component
</span><a href="Distribution.Types.TargetInfo.html#targetComponent"><span class="hs-identifier hs-var">targetComponent</span></a></span><span> </span><span class="annot"><span class="annottext">TargetInfo
</span><a href="#local-6989586621679553704"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-727"></span><span>      </span><span id="local-6989586621679553708"><span class="annot"><span class="annottext">clbi :: ComponentLocalBuildInfo
</span><a href="#local-6989586621679553708"><span class="hs-identifier hs-var hs-var">clbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TargetInfo -&gt; ComponentLocalBuildInfo
</span><a href="Distribution.Types.TargetInfo.html#targetCLBI"><span class="hs-identifier hs-var">targetCLBI</span></a></span><span> </span><span class="annot"><span class="annottext">TargetInfo
</span><a href="#local-6989586621679553704"><span class="hs-identifier hs-var">target</span></a></span><span>
</span><span id="line-728"></span><span>      </span><span id="local-6989586621679553710"><span class="annot"><span class="annottext">comp :: Compiler
</span><a href="#local-6989586621679553710"><span class="hs-identifier hs-var hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553700"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-729"></span><span>      </span><span id="local-6989586621679553711"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621679553711"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553700"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-730"></span><span>      </span><span id="local-6989586621679553712"><span class="annot"><span class="annottext">common :: CommonSetupFlags
</span><a href="#local-6989586621679553712"><span class="hs-identifier hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">(ConfigFlags -&gt; CommonSetupFlags)
-&gt; ConfigFlags -&gt; CommonSetupFlags
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ConfigFlags
</span><a href="Distribution.Types.LocalBuildInfo.html#configFlags"><span class="hs-identifier hs-var">configFlags</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553700"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-731"></span><span>      </span><span id="local-6989586621679553713"><span class="annot"><span class="annottext">mbWorkDir :: Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679553713"><span class="hs-identifier hs-var hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.LocalBuildInfo.html#mbWorkDirLBI"><span class="hs-identifier hs-var">mbWorkDirLBI</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679553700"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-732"></span><span>      </span><span id="local-6989586621679553716"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679553716"><span class="hs-identifier hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Verbosity -&gt; Verbosity) -&gt; Flag Verbosity -&gt; Verbosity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Common.html#setupVerbosity"><span class="hs-identifier hs-var">setupVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679553712"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-733"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReplOptions -&gt; Flag FilePath
</span><a href="Distribution.Simple.Setup.Repl.html#replOptionsFlagOutput"><span class="hs-identifier hs-var">replOptionsFlagOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReplFlags -&gt; ReplOptions
</span><a href="Distribution.Simple.Setup.Repl.html#replReplOptions"><span class="hs-identifier hs-var">replReplOptions</span></a></span><span> </span><span class="annot"><span class="annottext">ReplFlags
</span><a href="#local-6989586621679553701"><span class="hs-identifier hs-var">rflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-734"></span><span>        </span><span class="annot"><span class="annottext">Flag FilePath
</span><a href="Distribution.Simple.Flag.html#NoFlag"><span class="hs-identifier hs-var">NoFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; ConfiguredProgram
-&gt; Compiler
-&gt; Platform
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; GhcOptions
-&gt; IO ()
</span><a href="Distribution.Simple.Program.GHC.html#runGHC"><span class="hs-identifier hs-var">runGHC</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679553716"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679553699"><span class="hs-identifier hs-var">ghcProg</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679553710"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679553711"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679553713"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553702"><span class="hs-identifier hs-var">ghcOpts</span></a></span><span>
</span><span id="line-735"></span><span>        </span><span class="annot"><a href="Distribution.Simple.Flag.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span id="local-6989586621679553720"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553720"><span class="hs-identifier hs-var">out_dir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-736"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553721"><span class="annot"><span class="annottext">uid :: UnitId
</span><a href="#local-6989586621679553721"><span class="hs-identifier hs-var hs-var hs-var">uid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo -&gt; UnitId
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentUnitId"><span class="hs-identifier hs-var">componentUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553708"><span class="hs-identifier hs-var">clbi</span></a></span><span>
</span><span id="line-737"></span><span>              </span><span id="local-6989586621679553724"><span class="annot"><span class="annottext">this_unit :: FilePath
</span><a href="#local-6989586621679553724"><span class="hs-identifier hs-var hs-var hs-var">this_unit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitId -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679553721"><span class="hs-identifier hs-var">uid</span></a></span><span>
</span><span id="line-738"></span><span>              </span><span id="local-6989586621679553725"><span class="annot"><span class="annottext">reexported_modules :: [ModuleName]
</span><a href="#local-6989586621679553725"><span class="hs-identifier hs-var hs-var hs-var">reexported_modules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-739"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679553726"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Distribution.Types.ComponentLocalBuildInfo.html#LibComponentLocalBuildInfo"><span class="hs-identifier hs-type">LibComponentLocalBuildInfo</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">componentExposedModules :: ComponentLocalBuildInfo -&gt; [ExposedModule]
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentExposedModules"><span class="hs-identifier hs-var">componentExposedModules</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679553728"><span class="annot"><span class="annottext">[ExposedModule]
</span><a href="#local-6989586621679553728"><span class="hs-identifier hs-var">exposed_mods</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679553708"><span class="hs-identifier hs-var">clbi</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ExposedModule.html#ExposedModule"><span class="hs-identifier hs-type">IPI.ExposedModule</span></a></span><span> </span><span id="local-6989586621679553726"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679553726"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ExposedModule]
</span><a href="#local-6989586621679553728"><span class="hs-identifier hs-var">exposed_mods</span></a></span><span>
</span><span id="line-740"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-741"></span><span>              </span><span id="local-6989586621679553730"><span class="annot"><span class="annottext">hidden_modules :: [ModuleName]
</span><a href="#local-6989586621679553730"><span class="hs-identifier hs-var hs-var hs-var">hidden_modules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [ModuleName]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#otherModules"><span class="hs-identifier hs-var">otherModules</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679553705"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-742"></span><span>              </span><span id="local-6989586621679553738"><span class="annot"><span class="annottext">extra_opts :: [FilePath]
</span><a href="#local-6989586621679553738"><span class="hs-identifier hs-var hs-var hs-var">extra_opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-743"></span><span>                </span><span class="annot"><span class="annottext">[[FilePath]] -&gt; [FilePath]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[FilePath]] -&gt; [FilePath]) -&gt; [[FilePath]] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-744"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-this-package-name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PackageName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679553703"><span class="hs-identifier hs-var">pkg_name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-745"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679553713"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-746"></span><span>                      </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-747"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679553740"><span class="annot"><span class="annottext">SymbolicPath CWD ('Dir Pkg)
</span><a href="#local-6989586621679553740"><span class="hs-identifier hs-var">wd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-working-dir&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SymbolicPath CWD ('Dir Pkg) -&gt; FilePath
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath CWD ('Dir Pkg)
</span><a href="#local-6989586621679553740"><span class="hs-identifier hs-var">wd</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-748"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-749"></span><span>                    </span><span class="annot"><span class="annottext">[[FilePath]] -&gt; [[FilePath]] -&gt; [[FilePath]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-reexported-module&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679553741"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679553741"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679553741"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621679553725"><span class="hs-identifier hs-var">reexported_modules</span></a></span><span>
</span><span id="line-750"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-751"></span><span>                    </span><span class="annot"><span class="annottext">[[FilePath]] -&gt; [[FilePath]] -&gt; [[FilePath]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-hidden-module&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; FilePath
forall a. Pretty a =&gt; a -&gt; FilePath
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679553742"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679553742"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679553742"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621679553730"><span class="hs-identifier hs-var">hidden_modules</span></a></span><span>
</span><span id="line-752"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-753"></span><span>          </span><span class="hs-comment">-- Create &quot;paths&quot; subdirectory if it doesn't exist. This is where we write</span><span>
</span><span id="line-754"></span><span>          </span><span class="hs-comment">-- information about how the PATH was augmented.</span><span>
</span><span id="line-755"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; FilePath -&gt; IO ()
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#createDirectoryIfMissing"><span class="hs-identifier hs-var">createDirectoryIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553720"><span class="hs-identifier hs-var">out_dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;paths&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>          </span><span class="hs-comment">-- Write out the PATH information into `paths` subdirectory.</span><span>
</span><span id="line-757"></span><span>          </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString -&gt; IO ()
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#writeFileAtomic"><span class="hs-identifier hs-var">writeFileAtomic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553720"><span class="hs-identifier hs-var">out_dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;paths&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553724"><span class="hs-identifier hs-var">this_unit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; ByteString
forall a. Binary a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679553699"><span class="hs-identifier hs-var">ghcProg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-758"></span><span>          </span><span class="hs-comment">-- Write out options for this component into a file ready for loading into</span><span>
</span><span id="line-759"></span><span>          </span><span class="hs-comment">-- the multi-repl</span><span>
</span><span id="line-760"></span><span>          </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString -&gt; IO ()
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#writeFileAtomic"><span class="hs-identifier hs-var">writeFileAtomic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553720"><span class="hs-identifier hs-var">out_dir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679553724"><span class="hs-identifier hs-var">this_unit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; ByteString -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-761"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#pack"><span class="hs-identifier hs-var">BS.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; ByteString) -&gt; FilePath -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-762"></span><span>              </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><span class="hs-identifier hs-var">escapeArgs</span></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; FilePath) -&gt; [FilePath] -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-763"></span><span>                </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679553738"><span class="hs-identifier hs-var">extra_opts</span></a></span><span>
</span><span id="line-764"></span><span>                  </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Platform -&gt; GhcOptions -&gt; [FilePath]
</span><a href="Distribution.Simple.Program.GHC.html#renderGhcOptions"><span class="hs-identifier hs-var">renderGhcOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679553710"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679553711"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GhcOptions
</span><a href="#local-6989586621679553702"><span class="hs-identifier hs-var">ghcOpts</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.Simple.Program.GHC.html#ghcOptMode"><span class="hs-identifier hs-var">ghcOptMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#NoFlag"><span class="hs-identifier hs-type">NoFlag</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>                  </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; [FilePath]
</span><a href="Distribution.Simple.Program.Types.html#programOverrideArgs"><span class="hs-identifier hs-var">programOverrideArgs</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679553699"><span class="hs-identifier hs-var">ghcProg</span></a></span><span>
</span><span id="line-766"></span><span>
</span><span id="line-767"></span><span id="local-6989586621679552930"><span class="annot"><a href="Distribution.Simple.GHC.Build.Link.html#replNoLoad"><span class="hs-identifier hs-type">replNoLoad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679552930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Repl.html#ReplOptions"><span class="hs-identifier hs-type">ReplOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#NubListR"><span class="hs-identifier hs-type">NubListR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679552930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html#NubListR"><span class="hs-identifier hs-type">NubListR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679552930"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-768"></span><span id="replNoLoad"><span class="annot"><span class="annottext">replNoLoad :: forall a. Ord a =&gt; ReplOptions -&gt; NubListR a -&gt; NubListR a
</span><a href="Distribution.Simple.GHC.Build.Link.html#replNoLoad"><span class="hs-identifier hs-var hs-var">replNoLoad</span></a></span></span><span> </span><span id="local-6989586621679553753"><span class="annot"><span class="annottext">ReplOptions
</span><a href="#local-6989586621679553753"><span class="hs-identifier hs-var">replFlags</span></a></span></span><span> </span><span id="local-6989586621679553754"><span class="annot"><span class="annottext">NubListR a
</span><a href="#local-6989586621679553754"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ReplOptions -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Repl.html#replOptionsNoLoad"><span class="hs-identifier hs-var">replOptionsNoLoad</span></a></span><span> </span><span class="annot"><span class="annottext">ReplOptions
</span><a href="#local-6989586621679553753"><span class="hs-identifier hs-var">replFlags</span></a></span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Flag Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool
forall a. a -&gt; Flag a
</span><a href="Distribution.Simple.Flag.html#Flag"><span class="hs-identifier hs-var">Flag</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NubListR a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-770"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NubListR a
</span><a href="#local-6989586621679553754"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-771"></span></pre></body></html>