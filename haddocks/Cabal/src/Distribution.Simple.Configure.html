<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Module      :  Distribution.Simple.Configure</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Copyright   :  Isaac Jones 2003-2005</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- License     :  BSD3</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Maintainer  :  cabal-devel@haskell.org</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Portability :  portable</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- This deals with the /configure/ phase. It provides the 'configure' action</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- which is given the package description and configure flags. It then tries</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- to: configure the compiler; resolves any conditionals in the package</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- description; resolve the package dependencies; check if all the extensions</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- used by this package are supported by the compiler; check that all the build</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- tools are available (including version checks if appropriate); checks for</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- any required @pkg-config@ packages (updating the 'BuildInfo' with the</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- results)</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- Then based on all this it saves the info in the 'LocalBuildInfo' and writes</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- it out to the @dist\/setup-config@ file. It also displays various details to</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- the user, the amount of information displayed depending on the verbosity</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- level.</span><span>
</span><span id="line-33"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html"><span class="hs-identifier">Distribution.Simple.Configure</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#configure"><span class="hs-identifier">configure</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#configure_setupHooks"><span class="hs-identifier">configure_setupHooks</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#writePersistBuildConfig"><span class="hs-identifier">writePersistBuildConfig</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#getConfigStateFile"><span class="hs-identifier">getConfigStateFile</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#getPersistBuildConfig"><span class="hs-identifier">getPersistBuildConfig</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#checkPersistBuildConfigOutdated"><span class="hs-identifier">checkPersistBuildConfigOutdated</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#tryGetPersistBuildConfig"><span class="hs-identifier">tryGetPersistBuildConfig</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#maybeGetPersistBuildConfig"><span class="hs-identifier">maybeGetPersistBuildConfig</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#findDistPref"><span class="hs-identifier">findDistPref</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#findDistPrefOrDefault"><span class="hs-identifier">findDistPrefOrDefault</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#getInternalLibraries"><span class="hs-identifier">getInternalLibraries</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Backpack.Id.html#computeComponentId"><span class="hs-identifier">computeComponentId</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Backpack.Id.html#computeCompatPackageKey"><span class="hs-identifier">computeCompatPackageKey</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#localBuildInfoFile"><span class="hs-identifier">localBuildInfoFile</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#getInstalledPackages"><span class="hs-identifier">getInstalledPackages</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#getInstalledPackagesMonitorFiles"><span class="hs-identifier">getInstalledPackagesMonitorFiles</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#getInstalledPackagesById"><span class="hs-identifier">getInstalledPackagesById</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#getPackageDBContents"><span class="hs-identifier">getPackageDBContents</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#configCompilerEx"><span class="hs-identifier">configCompilerEx</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#configCompilerAuxEx"><span class="hs-identifier">configCompilerAuxEx</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#computeEffectiveProfiling"><span class="hs-identifier">computeEffectiveProfiling</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ccLdOptionsBuildInfo"><span class="hs-identifier">ccLdOptionsBuildInfo</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#checkForeignDeps"><span class="hs-identifier">checkForeignDeps</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#interpretPackageDbFlags"><span class="hs-identifier">interpretPackageDbFlags</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileError"><span class="hs-identifier">ConfigStateFileError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#tryGetConfigStateFile"><span class="hs-identifier">tryGetConfigStateFile</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.PreProcess.html#platformDefines"><span class="hs-identifier">platformDefines</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html"><span class="hs-identifier">Distribution.Compat.Prelude</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Backpack.Configure.html"><span class="hs-identifier">Distribution.Backpack.Configure</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Backpack.ConfiguredComponent.html"><span class="hs-identifier">Distribution.Backpack.ConfiguredComponent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Backpack.ConfiguredComponent.html#newPackageDepsBehaviour"><span class="hs-identifier">newPackageDepsBehaviour</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Backpack.DescribeUnitId.html"><span class="hs-identifier">Distribution.Backpack.DescribeUnitId</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Backpack.Id.html"><span class="hs-identifier">Distribution.Backpack.Id</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html"><span class="hs-identifier">Distribution.Backpack.PreExistingComponent</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Graph.html"><span class="hs-identifier">Distribution.Compat.Graph</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Graph</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Compat.Stack.html"><span class="hs-identifier">Distribution.Compat.Stack</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html"><span class="hs-identifier">Distribution.Compiler</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.InstalledPackageInfo.html"><span class="hs-identifier">Distribution.InstalledPackageInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier">InstalledPackageInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.InstalledPackageInfo.html"><span class="hs-identifier">Distribution.InstalledPackageInfo</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IPI</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html"><span class="hs-identifier">Distribution.Package</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.html"><span class="hs-identifier">Distribution.PackageDescription</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.html"><span class="hs-identifier">Distribution.PackageDescription.Check</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Monad.html#doesFileExist"><span class="hs-identifier">doesFileExist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.Configuration.html"><span class="hs-identifier">Distribution.PackageDescription.Configuration</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.PrettyPrint.html"><span class="hs-identifier">Distribution.PackageDescription.PrettyPrint</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildTarget.html"><span class="hs-identifier">Distribution.Simple.BuildTarget</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildToolDepends.html"><span class="hs-identifier">Distribution.Simple.BuildToolDepends</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildWay.html"><span class="hs-identifier">Distribution.Simple.BuildWay</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html"><span class="hs-identifier">Distribution.Simple.Compiler</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.LocalBuildInfo.html"><span class="hs-identifier">Distribution.Simple.LocalBuildInfo</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html"><span class="hs-identifier">Distribution.Simple.PackageIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#InstalledPackageIndex"><span class="hs-identifier">InstalledPackageIndex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#lookupUnitId"><span class="hs-identifier">lookupUnitId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html"><span class="hs-identifier">Distribution.Simple.PackageIndex</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PackageIndex</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.PreProcess.html"><span class="hs-identifier">Distribution.Simple.PreProcess</span></a></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.html"><span class="hs-identifier">Distribution.Simple.Program</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html"><span class="hs-identifier">Distribution.Simple.Program.Db</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier">ProgramDb</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#lookupProgramByName"><span class="hs-identifier">lookupProgramByName</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#modifyProgramSearchPath"><span class="hs-identifier">modifyProgramSearchPath</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#prependProgramSearchPath"><span class="hs-identifier">prependProgramSearchPath</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#updateConfiguredProgs"><span class="hs-identifier">updateConfiguredProgs</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Common.html"><span class="hs-identifier">Distribution.Simple.Setup.Common</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Setup</span></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html"><span class="hs-identifier">Distribution.Simple.Setup.Config</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Setup</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html"><span class="hs-identifier">Distribution.Simple.SetupHooks.Internal</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#ConfigureHooks"><span class="hs-identifier">ConfigureHooks</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#applyComponentDiffs"><span class="hs-identifier">applyComponentDiffs</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#noConfigureHooks"><span class="hs-identifier">noConfigureHooks</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html"><span class="hs-identifier">Distribution.Simple.SetupHooks.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SetupHooks</span></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Utils.html"><span class="hs-identifier">Distribution.Simple.Utils</span></a></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html"><span class="hs-identifier">Distribution.System</span></a></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html"><span class="hs-identifier">Distribution.Types.ComponentRequestedSpec</span></a></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Types.GivenComponent.html"><span class="hs-identifier">Distribution.Types.GivenComponent</span></a></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html"><span class="hs-identifier">Distribution.Types.LocalBuildConfig</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LBC</span></span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html"><span class="hs-identifier">Distribution.Types.LocalBuildInfo</span></a></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageVersionConstraint.html"><span class="hs-identifier">Distribution.Types.PackageVersionConstraint</span></a></span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Utils.LogProgress.html"><span class="hs-identifier">Distribution.Utils.LogProgress</span></a></span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Utils.NubList.html"><span class="hs-identifier">Distribution.Utils.NubList</span></a></span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html"><span class="hs-identifier">Distribution.Verbosity</span></a></span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Version.html"><span class="hs-identifier">Distribution.Version</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.GHC.html"><span class="hs-identifier">Distribution.Simple.GHC</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.GHCJS.html"><span class="hs-identifier">Distribution.Simple.GHCJS</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHCJS</span></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.HaskellSuite.html"><span class="hs-identifier">Distribution.Simple.HaskellSuite</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HaskellSuite</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Simple.UHC.html"><span class="hs-identifier">Distribution.Simple.UHC</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UHC</span></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">try</span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html"><span class="hs-identifier">Data.ByteString.Lazy.Char8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BLC8</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">intersect</span></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stripPrefix</span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(\\)</span></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NEL</span></span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Compat.Directory.html"><span class="hs-identifier">Distribution.Compat.Directory</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesPathExist"><span class="hs-identifier">doesPathExist</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#listDirectory"><span class="hs-identifier">listDirectory</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Compat.Environment.html"><span class="hs-identifier">Distribution.Compat.Environment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lookupEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Parsec.html"><span class="hs-identifier">Distribution.Parsec</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Parsec.html#simpleParsec"><span class="hs-identifier">simpleParsec</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html"><span class="hs-identifier">Distribution.Pretty</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#defaultStyle"><span class="hs-identifier">defaultStyle</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier">pretty</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier">prettyShow</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html"><span class="hs-identifier">Distribution.Simple.Errors</span></a></span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Types.AnnotatedId.html"><span class="hs-identifier">Distribution.Types.AnnotatedId</span></a></span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html"><span class="hs-identifier">Distribution.Utils.Path</span></a></span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Structured.html"><span class="hs-identifier">Distribution.Utils.Structured</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Structured.html#structuredDecodeOrFailIO"><span class="hs-identifier">structuredDecodeOrFailIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Structured.html#structuredEncode"><span class="hs-identifier">structuredEncode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html"><span class="hs-identifier">System.Directory</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#canonicalizePath"><span class="hs-identifier">canonicalizePath</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#createDirectoryIfMissing"><span class="hs-identifier">createDirectoryIfMissing</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesFileExist"><span class="hs-identifier">doesFileExist</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#getTemporaryDirectory"><span class="hs-identifier">getTemporaryDirectory</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#removeFile"><span class="hs-identifier">removeFile</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.html"><span class="hs-identifier">System.FilePath</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.Posix.html#isAbsolute"><span class="hs-identifier">isAbsolute</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">hClose</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hPutStrLn</span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.Info.html"><span class="hs-identifier">System.Info</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.Info.html#compilerName"><span class="hs-identifier">compilerName</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/System.Info.html#compilerVersion"><span class="hs-identifier">compilerVersion</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.html"><span class="hs-identifier">Text.PrettyPrint</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#Doc"><span class="hs-identifier">Doc</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#char"><span class="hs-identifier">char</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#hsep"><span class="hs-identifier">hsep</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#quotes"><span class="hs-identifier">quotes</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#renderStyle"><span class="hs-identifier">renderStyle</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier">text</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%24%2B%24"><span class="hs-operator">($+$)</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-182"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-183"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.NonEmptySet.html"><span class="hs-identifier">Distribution.Compat.NonEmptySet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NES</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">type</span><span> </span><span id="UseExternalInternalDeps"><span class="annot"><a href="Distribution.Simple.Configure.html#UseExternalInternalDeps"><span class="hs-identifier hs-var">UseExternalInternalDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><span class="hs-comment">-- | The errors that can be thrown when reading the @setup-config@ file.</span></span><span>
</span><span id="line-188"></span><span class="hs-keyword">data</span><span> </span><span id="ConfigStateFileError"><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileError"><span class="hs-identifier hs-var">ConfigStateFileError</span></a></span></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | No header found.</span></span><span>
</span><span id="line-190"></span><span>    </span><span id="ConfigStateFileNoHeader"><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileNoHeader"><span class="hs-identifier hs-var">ConfigStateFileNoHeader</span></a></span></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Incorrect header.</span></span><span>
</span><span id="line-192"></span><span>    </span><span id="ConfigStateFileBadHeader"><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileBadHeader"><span class="hs-identifier hs-var">ConfigStateFileBadHeader</span></a></span></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Cannot parse file contents.</span></span><span>
</span><span id="line-194"></span><span>    </span><span id="ConfigStateFileNoParse"><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileNoParse"><span class="hs-identifier hs-var">ConfigStateFileNoParse</span></a></span></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | No file!</span></span><span>
</span><span id="line-196"></span><span>    </span><span id="ConfigStateFileMissing"><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileMissing"><span class="hs-identifier hs-var">ConfigStateFileMissing</span></a></span></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="cfgStateFileErrorCwd"><span class="annot"><span class="annottext">ConfigStateFileError -&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.Configure.html#cfgStateFileErrorCwd"><span class="hs-identifier hs-var hs-var">cfgStateFileErrorCwd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="cfgStateFileErrorFile"><span class="annot"><span class="annottext">ConfigStateFileError -&gt; SymbolicPath Pkg 'File
</span><a href="Distribution.Simple.Configure.html#cfgStateFileErrorFile"><span class="hs-identifier hs-var hs-var">cfgStateFileErrorFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Mismatched version.</span></span><span>
</span><span id="line-201"></span><span>    </span><span id="ConfigStateFileBadVersion"><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileBadVersion"><span class="hs-identifier hs-var">ConfigStateFileBadVersion</span></a></span></span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-type">PackageIdentifier</span></a></span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-type">PackageIdentifier</span></a></span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileError"><span class="hs-identifier hs-type">ConfigStateFileError</span></a></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><span class="hs-comment">-- | Format a 'ConfigStateFileError' as a user-facing error message.</span></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Distribution.Simple.Configure.html#dispConfigStateFileError"><span class="hs-identifier hs-type">dispConfigStateFileError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileError"><span class="hs-identifier hs-type">ConfigStateFileError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#Doc"><span class="hs-identifier hs-type">Doc</span></a></span><span>
</span><span id="line-209"></span><span id="dispConfigStateFileError"><span class="annot"><span class="annottext">dispConfigStateFileError :: ConfigStateFileError -&gt; Doc
</span><a href="Distribution.Simple.Configure.html#dispConfigStateFileError"><span class="hs-identifier hs-var hs-var">dispConfigStateFileError</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError
</span><a href="Distribution.Simple.Configure.html#ConfigStateFileNoHeader"><span class="hs-identifier hs-var">ConfigStateFileNoHeader</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Saved package config file header is missing.&quot;</span></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Re-run the 'Setup configure' command.&quot;</span></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Distribution.Simple.Configure.html#dispConfigStateFileError"><span class="hs-identifier hs-var">dispConfigStateFileError</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError
</span><a href="Distribution.Simple.Configure.html#ConfigStateFileBadHeader"><span class="hs-identifier hs-var">ConfigStateFileBadHeader</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Saved package config file header is corrupt.&quot;</span></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Re-run the 'Setup configure' command.&quot;</span></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Distribution.Simple.Configure.html#dispConfigStateFileError"><span class="hs-identifier hs-var">dispConfigStateFileError</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError
</span><a href="Distribution.Simple.Configure.html#ConfigStateFileNoParse"><span class="hs-identifier hs-var">ConfigStateFileNoParse</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Saved package config file is corrupt.&quot;</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Re-run the 'Setup configure' command.&quot;</span></span><span>
</span><span id="line-218"></span><span class="annot"><a href="Distribution.Simple.Configure.html#dispConfigStateFileError"><span class="hs-identifier hs-var">dispConfigStateFileError</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileMissing"><span class="hs-identifier hs-type">ConfigStateFileMissing</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Run the 'Setup configure' command first.&quot;</span></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Distribution.Simple.Configure.html#dispConfigStateFileError"><span class="hs-identifier hs-var">dispConfigStateFileError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileBadVersion"><span class="hs-identifier hs-type">ConfigStateFileBadVersion</span></a></span><span> </span><span id="local-6989586621679564832"><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564832"><span class="hs-identifier hs-var">oldCabal</span></a></span></span><span> </span><span id="local-6989586621679564833"><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564833"><span class="hs-identifier hs-var">oldCompiler</span></a></span></span><span> </span><span class="annot"><span class="annottext">Either ConfigStateFileError LocalBuildInfo
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Saved package config file is outdated:&quot;</span></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679564834"><span class="hs-identifier hs-var">badCabal</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621679564835"><span class="hs-identifier hs-var">badCompiler</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%24%2B%24"><span class="hs-operator hs-var">$+$</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Re-run the 'Setup configure' command.&quot;</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679564834"><span class="annot"><span class="annottext">badCabal :: Doc
</span><a href="#local-6989586621679564834"><span class="hs-identifier hs-var hs-var">badCabal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;&#8226; the Cabal version changed from&quot;</span></span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564832"><span class="hs-identifier hs-var">oldCabal</span></a></span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;to&quot;</span></span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="Distribution.Simple.Configure.html#currentCabalId"><span class="hs-identifier hs-var">currentCabalId</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679564835"><span class="annot"><span class="annottext">badCompiler :: Doc
</span><a href="#local-6989586621679564835"><span class="hs-identifier hs-var hs-var">badCompiler</span></a></span></span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564833"><span class="hs-identifier hs-var">oldCompiler</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; PackageIdentifier -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="Distribution.Simple.Configure.html#currentCompilerId"><span class="hs-identifier hs-var">currentCompilerId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;&#8226; the compiler changed from&quot;</span></span><span>
</span><span id="line-235"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564833"><span class="hs-identifier hs-var">oldCompiler</span></a></span><span>
</span><span id="line-236"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;to&quot;</span></span><span>
</span><span id="line-237"></span><span>            </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="Distribution.Simple.Configure.html#currentCompilerId"><span class="hs-identifier hs-var">currentCompilerId</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679564850"><span id="local-6989586621679564855"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileError"><span class="hs-identifier hs-type">ConfigStateFileError</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679564858"><span class="annot"><span class="annottext">show :: ConfigStateFileError -&gt; ProgArg
</span><a href="#local-6989586621679564858"><span class="hs-identifier hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Style -&gt; Doc -&gt; ProgArg
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#renderStyle"><span class="hs-identifier hs-var">renderStyle</span></a></span><span> </span><span class="annot"><span class="annottext">Style
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#defaultStyle"><span class="hs-identifier hs-var">defaultStyle</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ProgArg)
-&gt; (ConfigStateFileError -&gt; Doc) -&gt; ConfigStateFileError -&gt; ProgArg
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError -&gt; Doc
</span><a href="Distribution.Simple.Configure.html#dispConfigStateFileError"><span class="hs-identifier hs-var">dispConfigStateFileError</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679564866"><span id="local-6989586621679564869"><span id="local-6989586621679564872"><span id="local-6989586621679564875"><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileError"><span class="hs-identifier hs-type">ConfigStateFileError</span></a></span></span></span></span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Read the 'localBuildInfoFile'.  Throw an exception if the file is</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- missing, if the file cannot be read, or if the file was created by an older</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- version of Cabal.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="Distribution.Simple.Configure.html#getConfigStateFile"><span class="hs-identifier hs-type">getConfigStateFile</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The file path of the @setup-config@ file.</span></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-252"></span><span id="getConfigStateFile"><span class="annot"><span class="annottext">getConfigStateFile :: Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg 'File -&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#getConfigStateFile"><span class="hs-identifier hs-var hs-var">getConfigStateFile</span></a></span></span><span> </span><span id="local-6989586621679564878"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564878"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span id="local-6989586621679564879"><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679564879"><span class="hs-identifier hs-var">setupConfigFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679564880"><span class="annot"><span class="annottext">filename :: ProgArg
</span><a href="#local-6989586621679564880"><span class="hs-identifier hs-var hs-var hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg 'File -&gt; ProgArg
forall from (allowAbsolute :: AllowAbsolute) (to :: FileOrDir).
Maybe (SymbolicPath CWD ('Dir from))
-&gt; SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#interpretSymbolicPath"><span class="hs-identifier hs-var">interpretSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564878"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679564879"><span class="hs-identifier hs-var">setupConfigFile</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679564882"><span class="annot"><a href="#local-6989586621679564882"><span class="hs-identifier hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; IO Bool
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679564880"><span class="hs-identifier hs-var">filename</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="annot"><a href="#local-6989586621679564882"><span class="hs-identifier hs-type">exists</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">throwIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileMissing"><span class="hs-identifier hs-type">ConfigStateFileMissing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564878"><span class="hs-identifier hs-type">mbWorkDir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564879"><span class="hs-identifier hs-type">setupConfigFile</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-comment">-- Read the config file into a strict ByteString to avoid problems with</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-comment">-- lazy I/O, then convert to lazy because the binary package needs that.</span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679564885"><span class="annot"><a href="#local-6989586621679564885"><span class="hs-identifier hs-var">contents</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#readFile"><span class="hs-identifier hs-type">BS.readFile</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564880"><span class="hs-identifier hs-type">filename</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679564888"><span class="annot"><a href="#local-6989586621679564888"><span class="hs-identifier hs-var">header</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679564889"><span class="annot"><a href="#local-6989586621679564889"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#span"><span class="hs-identifier hs-type">BLC8.span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">/=</span></span><span> </span><span class="annot"><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.html#fromChunks"><span class="hs-identifier hs-type">BLC8.fromChunks</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679564885"><span class="hs-identifier hs-type">contents</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679564893"><span class="annot"><a href="#local-6989586621679564893"><span class="hs-identifier hs-var">cabalId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679564894"><span class="annot"><a href="#local-6989586621679564894"><span class="hs-identifier hs-var">compId</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#parseHeader"><span class="hs-identifier hs-type">parseHeader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564888"><span class="hs-identifier hs-type">header</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679564906"><span class="annot"><a href="#local-6989586621679564906"><span class="hs-identifier hs-var hs-var">getStoredValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>        </span><span id="local-6989586621679564907"><span class="annot"><a href="#local-6989586621679564907"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO (Either ProgArg LocalBuildInfo)
forall a.
(Binary a, Structured a) =&gt;
ByteString -&gt; IO (Either ProgArg a)
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Structured.html#structuredDecodeOrFailIO"><span class="hs-identifier hs-var">structuredDecodeOrFailIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; ByteString -&gt; ByteString
ByteString -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.html#tail"><span class="hs-identifier hs-var">BLC8.tail</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679564889"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679564907"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-266"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError -&gt; IO LocalBuildInfo
forall e a. (HasCallStack, Exception e) =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError
</span><a href="Distribution.Simple.Configure.html#ConfigStateFileNoParse"><span class="hs-identifier hs-var">ConfigStateFileNoParse</span></a></span><span>
</span><span id="line-267"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679564909"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679564909"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; IO LocalBuildInfo
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679564909"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span id="local-6989586621679564916"><span class="annot"><a href="#local-6989586621679564916"><span class="hs-identifier hs-var hs-var">deferErrorIfBadVersion</span></a></span></span><span> </span><span id="local-6989586621679564917"><span class="annot"><span class="annottext">IO LocalBuildInfo
</span><a href="#local-6989586621679564917"><span class="hs-identifier hs-var">act</span></a></span></span><span>
</span><span id="line-269"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564893"><span class="hs-identifier hs-var">cabalId</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; PackageIdentifier -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="Distribution.Simple.Configure.html#currentCabalId"><span class="hs-identifier hs-var">currentCabalId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>            </span><span id="local-6989586621679564918"><span class="annot"><a href="#local-6989586621679564918"><span class="hs-identifier hs-var">eResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO LocalBuildInfo
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">IO LocalBuildInfo
</span><a href="#local-6989586621679564917"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-271"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">throwIO</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileBadVersion"><span class="hs-identifier hs-type">ConfigStateFileBadVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564893"><span class="hs-identifier hs-type">cabalId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564894"><span class="hs-identifier hs-type">compId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564918"><span class="hs-identifier hs-type">eResult</span></a></span><span>
</span><span id="line-272"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO LocalBuildInfo
</span><a href="#local-6989586621679564917"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><a href="#local-6989586621679564916"><span class="hs-identifier hs-type">deferErrorIfBadVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564906"><span class="hs-identifier hs-type">getStoredValue</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">CallStack
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallStack
HasCallStack =&gt; CallStack
</span><span class="hs-identifier hs-var">callStack</span></span><span> </span><span class="hs-comment">-- TODO: attach call stack to exception</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | Read the 'localBuildInfoFile', returning either an error or the local build</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- info.</span><span>
</span><span id="line-279"></span><span class="annot"><a href="Distribution.Simple.Configure.html#tryGetConfigStateFile"><span class="hs-identifier hs-type">tryGetConfigStateFile</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Working directory.</span></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The file path of the @setup-config@ file.</span></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileError"><span class="hs-identifier hs-type">ConfigStateFileError</span></a></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span id="tryGetConfigStateFile"><span class="annot"><span class="annottext">tryGetConfigStateFile :: Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg 'File
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
</span><a href="Distribution.Simple.Configure.html#tryGetConfigStateFile"><span class="hs-identifier hs-var hs-var">tryGetConfigStateFile</span></a></span></span><span> </span><span id="local-6989586621679564922"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564922"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO LocalBuildInfo
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(IO LocalBuildInfo
 -&gt; IO (Either ConfigStateFileError LocalBuildInfo))
-&gt; (SymbolicPath Pkg 'File -&gt; IO LocalBuildInfo)
-&gt; SymbolicPath Pkg 'File
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg 'File -&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#getConfigStateFile"><span class="hs-identifier hs-var">getConfigStateFile</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564922"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><span class="hs-comment">-- | Try to read the 'localBuildInfoFile'.</span></span><span>
</span><span id="line-288"></span><span class="annot"><a href="Distribution.Simple.Configure.html#tryGetPersistBuildConfig"><span class="hs-identifier hs-type">tryGetPersistBuildConfig</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Working directory.</span></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The @dist@ directory path.</span></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ConfigStateFileError"><span class="hs-identifier hs-type">ConfigStateFileError</span></a></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span id="tryGetPersistBuildConfig"><span class="annot"><span class="annottext">tryGetPersistBuildConfig :: Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir Dist)
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
</span><a href="Distribution.Simple.Configure.html#tryGetPersistBuildConfig"><span class="hs-identifier hs-var hs-var">tryGetPersistBuildConfig</span></a></span></span><span> </span><span id="local-6989586621679564923"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564923"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO LocalBuildInfo
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(IO LocalBuildInfo
 -&gt; IO (Either ConfigStateFileError LocalBuildInfo))
-&gt; (SymbolicPath Pkg ('Dir Dist) -&gt; IO LocalBuildInfo)
-&gt; SymbolicPath Pkg ('Dir Dist)
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir Dist) -&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#getPersistBuildConfig"><span class="hs-identifier hs-var">getPersistBuildConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564923"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-comment">-- | Read the 'localBuildInfoFile'. Throw an exception if the file is</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- missing, if the file cannot be read, or if the file was created by an older</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- version of Cabal.</span><span>
</span><span id="line-299"></span><span class="annot"><a href="Distribution.Simple.Configure.html#getPersistBuildConfig"><span class="hs-identifier hs-type">getPersistBuildConfig</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Working directory.</span></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The @dist@ directory path.</span></span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-305"></span><span id="getPersistBuildConfig"><span class="annot"><span class="annottext">getPersistBuildConfig :: Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir Dist) -&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#getPersistBuildConfig"><span class="hs-identifier hs-var hs-var">getPersistBuildConfig</span></a></span></span><span> </span><span id="local-6989586621679564924"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564924"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span id="local-6989586621679564925"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564925"><span class="hs-identifier hs-var">distPref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg 'File -&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#getConfigStateFile"><span class="hs-identifier hs-var">getConfigStateFile</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564924"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolicPath Pkg 'File -&gt; IO LocalBuildInfo)
-&gt; SymbolicPath Pkg 'File -&gt; IO LocalBuildInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist) -&gt; SymbolicPath Pkg 'File
</span><a href="Distribution.Simple.Configure.html#localBuildInfoFile"><span class="hs-identifier hs-var">localBuildInfoFile</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564925"><span class="hs-identifier hs-var">distPref</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><span class="hs-comment">-- | Try to read the 'localBuildInfoFile'.</span></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Distribution.Simple.Configure.html#maybeGetPersistBuildConfig"><span class="hs-identifier hs-type">maybeGetPersistBuildConfig</span></a></span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Working directory.</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The @dist@ directory path.</span></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span id="maybeGetPersistBuildConfig"><span class="annot"><span class="annottext">maybeGetPersistBuildConfig :: Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir Dist) -&gt; IO (Maybe LocalBuildInfo)
</span><a href="Distribution.Simple.Configure.html#maybeGetPersistBuildConfig"><span class="hs-identifier hs-var hs-var">maybeGetPersistBuildConfig</span></a></span></span><span> </span><span id="local-6989586621679564926"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564926"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="annottext">(Either ConfigStateFileError LocalBuildInfo
 -&gt; Maybe LocalBuildInfo)
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
-&gt; IO (Maybe LocalBuildInfo)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConfigStateFileError -&gt; Maybe LocalBuildInfo)
-&gt; (LocalBuildInfo -&gt; Maybe LocalBuildInfo)
-&gt; Either ConfigStateFileError LocalBuildInfo
-&gt; Maybe LocalBuildInfo
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe LocalBuildInfo
-&gt; ConfigStateFileError -&gt; Maybe LocalBuildInfo
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe LocalBuildInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Maybe LocalBuildInfo
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO (Either ConfigStateFileError LocalBuildInfo)
 -&gt; IO (Maybe LocalBuildInfo))
-&gt; (SymbolicPath Pkg ('Dir Dist)
    -&gt; IO (Either ConfigStateFileError LocalBuildInfo))
-&gt; SymbolicPath Pkg ('Dir Dist)
-&gt; IO (Maybe LocalBuildInfo)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir Dist)
-&gt; IO (Either ConfigStateFileError LocalBuildInfo)
</span><a href="Distribution.Simple.Configure.html#tryGetPersistBuildConfig"><span class="hs-identifier hs-var">tryGetPersistBuildConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564926"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- | After running configure, output the 'LocalBuildInfo' to the</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- 'localBuildInfoFile'.</span><span>
</span><span id="line-320"></span><span class="annot"><a href="Distribution.Simple.Configure.html#writePersistBuildConfig"><span class="hs-identifier hs-type">writePersistBuildConfig</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Working directory</span></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The @dist@ directory path.</span></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The 'LocalBuildInfo' to write.</span></span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span id="writePersistBuildConfig"><span class="annot"><span class="annottext">writePersistBuildConfig :: Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir Dist) -&gt; LocalBuildInfo -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#writePersistBuildConfig"><span class="hs-identifier hs-var hs-var">writePersistBuildConfig</span></a></span></span><span> </span><span id="local-6989586621679564930"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564930"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span id="local-6989586621679564931"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564931"><span class="hs-identifier hs-var">distPref</span></a></span></span><span> </span><span id="local-6989586621679564932"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679564932"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ProgArg -&gt; IO ()
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#createDirectoryIfMissing"><span class="hs-identifier hs-var">createDirectoryIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist) -&gt; ProgArg
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679564933"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564931"><span class="hs-identifier hs-var">distPref</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><span class="annottext">ProgArg -&gt; ByteString -&gt; IO ()
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#writeFileAtomic"><span class="hs-identifier hs-var">writeFileAtomic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File -&gt; ProgArg
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679564933"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolicPath Pkg 'File -&gt; ProgArg)
-&gt; SymbolicPath Pkg 'File -&gt; ProgArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist) -&gt; SymbolicPath Pkg 'File
</span><a href="Distribution.Simple.Configure.html#localBuildInfoFile"><span class="hs-identifier hs-var">localBuildInfoFile</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564931"><span class="hs-identifier hs-var">distPref</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; ByteString -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#unlines"><span class="hs-identifier hs-var">BLC8.unlines</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PackageIdentifier -&gt; ByteString
</span><a href="Distribution.Simple.Configure.html#showHeader"><span class="hs-identifier hs-var">showHeader</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564937"><span class="hs-identifier hs-var">pkgId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ByteString
forall a. (Binary a, Structured a) =&gt; a -&gt; ByteString
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Structured.html#structuredEncode"><span class="hs-identifier hs-var">structuredEncode</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679564932"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679564933"><span class="annot"><span class="annottext">i :: SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679564933"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
forall from (allowAbsolute :: AllowAbsolute) (to :: FileOrDir).
Maybe (SymbolicPath CWD ('Dir from))
-&gt; SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#interpretSymbolicPath"><span class="hs-identifier hs-var">interpretSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564930"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="hs-comment">-- See Note [Symbolic paths] in Distribution.Utils.Path</span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621679564937"><span class="annot"><span class="annottext">pkgId :: PackageIdentifier
</span><a href="#local-6989586621679564937"><span class="hs-identifier hs-var hs-var">pkgId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; PackageIdentifier
</span><a href="Distribution.Types.LocalBuildInfo.html#localPackage"><span class="hs-identifier hs-var">localPackage</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679564932"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><span class="hs-comment">-- | Identifier of the current Cabal package.</span></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Distribution.Simple.Configure.html#currentCabalId"><span class="hs-identifier hs-type">currentCabalId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-type">PackageIdentifier</span></a></span><span>
</span><span id="line-338"></span><span id="currentCabalId"><span class="annot"><span class="annottext">currentCabalId :: PackageIdentifier
</span><a href="Distribution.Simple.Configure.html#currentCabalId"><span class="hs-identifier hs-var hs-var">currentCabalId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageName -&gt; Version -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-var">PackageIdentifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg -&gt; PackageName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#mkPackageName"><span class="hs-identifier hs-var">mkPackageName</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Cabal&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="Distribution.Simple.Utils.html#cabalVersion"><span class="hs-identifier hs-var">cabalVersion</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><span class="hs-comment">-- | Identifier of the current compiler package.</span></span><span>
</span><span id="line-341"></span><span class="annot"><a href="Distribution.Simple.Configure.html#currentCompilerId"><span class="hs-identifier hs-type">currentCompilerId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-type">PackageIdentifier</span></a></span><span>
</span><span id="line-342"></span><span id="currentCompilerId"><span class="annot"><span class="annottext">currentCompilerId :: PackageIdentifier
</span><a href="Distribution.Simple.Configure.html#currentCompilerId"><span class="hs-identifier hs-var hs-var">currentCompilerId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><span class="annottext">PackageName -&gt; Version -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-var">PackageIdentifier</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg -&gt; PackageName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#mkPackageName"><span class="hs-identifier hs-var">mkPackageName</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="../../base-4.21.0.0-ae91/src/System.Info.html#compilerName"><span class="hs-identifier hs-var">System.Info.compilerName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion%27"><span class="hs-identifier hs-var">mkVersion'</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="../../base-4.21.0.0-ae91/src/System.Info.html#compilerVersion"><span class="hs-identifier hs-var">System.Info.compilerVersion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- | Parse the @setup-config@ file header, returning the package identifiers</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- for Cabal and the compiler.</span><span>
</span><span id="line-349"></span><span class="annot"><a href="Distribution.Simple.Configure.html#parseHeader"><span class="hs-identifier hs-type">parseHeader</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The file contents.</span></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-type">PackageIdentifier</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-type">PackageIdentifier</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span id="parseHeader"><span class="annot"><span class="annottext">parseHeader :: ByteString -&gt; IO (PackageIdentifier, PackageIdentifier)
</span><a href="Distribution.Simple.Configure.html#parseHeader"><span class="hs-identifier hs-var hs-var">parseHeader</span></a></span></span><span> </span><span id="local-6989586621679564943"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679564943"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#words"><span class="hs-identifier hs-var">BLC8.words</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679564943"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Saved&quot;</span></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;package&quot;</span></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;config&quot;</span></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;for&quot;</span></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679564945"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679564945"><span class="hs-identifier hs-var">pkgId</span></a></span></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;written&quot;</span></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;by&quot;</span></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679564946"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679564946"><span class="hs-identifier hs-var">cabalId</span></a></span></span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;using&quot;</span></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679564947"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679564947"><span class="hs-identifier hs-var">compId</span></a></span></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">IO (PackageIdentifier, PackageIdentifier)
-&gt; ((PackageIdentifier, PackageIdentifier)
    -&gt; IO (PackageIdentifier, PackageIdentifier))
-&gt; Maybe (PackageIdentifier, PackageIdentifier)
-&gt; IO (PackageIdentifier, PackageIdentifier)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigStateFileError -&gt; IO (PackageIdentifier, PackageIdentifier)
forall e a. (HasCallStack, Exception e) =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError
</span><a href="Distribution.Simple.Configure.html#ConfigStateFileBadHeader"><span class="hs-identifier hs-var">ConfigStateFileBadHeader</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PackageIdentifier, PackageIdentifier)
-&gt; IO (PackageIdentifier, PackageIdentifier)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (PackageIdentifier, PackageIdentifier)
 -&gt; IO (PackageIdentifier, PackageIdentifier))
-&gt; Maybe (PackageIdentifier, PackageIdentifier)
-&gt; IO (PackageIdentifier, PackageIdentifier)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Maybe PackageIdentifier
forall a. Parsec a =&gt; ProgArg -&gt; Maybe a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Parsec.html#simpleParsec"><span class="hs-identifier hs-var">simpleParsec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#fromUTF8LBS"><span class="hs-identifier hs-var">fromUTF8LBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679564945"><span class="hs-identifier hs-var">pkgId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-type">PackageIdentifier</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span id="local-6989586621679564950"><span class="annot"><a href="#local-6989586621679564950"><span class="hs-identifier hs-var">cabalId'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Parsec.html#simpleParsec"><span class="hs-identifier hs-type">simpleParsec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#unpack"><span class="hs-identifier hs-type">BLC8.unpack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564946"><span class="hs-identifier hs-type">cabalId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>        </span><span id="local-6989586621679564952"><span class="annot"><a href="#local-6989586621679564952"><span class="hs-identifier hs-var">compId'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Parsec.html#simpleParsec"><span class="hs-identifier hs-type">simpleParsec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#unpack"><span class="hs-identifier hs-type">BLC8.unpack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564947"><span class="hs-identifier hs-type">compId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679564950"><span class="hs-identifier hs-type">cabalId'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679564952"><span class="hs-identifier hs-type">compId'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><span class="annottext">[ByteString]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError -&gt; IO (PackageIdentifier, PackageIdentifier)
forall e a. (HasCallStack, Exception e) =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">ConfigStateFileError
</span><a href="Distribution.Simple.Configure.html#ConfigStateFileNoHeader"><span class="hs-identifier hs-var">ConfigStateFileNoHeader</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="annot"><span class="hs-comment">-- | Generate the @setup-config@ file header.</span></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Distribution.Simple.Configure.html#showHeader"><span class="hs-identifier hs-type">showHeader</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-type">PackageIdentifier</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The processed package.</span></span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Internal.html#ByteString"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-377"></span><span id="showHeader"><span class="annot"><span class="annottext">showHeader :: PackageIdentifier -&gt; ByteString
</span><a href="Distribution.Simple.Configure.html#showHeader"><span class="hs-identifier hs-var hs-var">showHeader</span></a></span></span><span> </span><span id="local-6989586621679564953"><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564953"><span class="hs-identifier hs-var">pkgId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#unwords"><span class="hs-identifier hs-var">BLC8.unwords</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Saved&quot;</span></span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;package&quot;</span></span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;config&quot;</span></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;for&quot;</span></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ByteString
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#toUTF8LBS"><span class="hs-identifier hs-var">toUTF8LBS</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; ByteString) -&gt; ProgArg -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679564953"><span class="hs-identifier hs-var">pkgId</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;written&quot;</span></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;by&quot;</span></span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#pack"><span class="hs-identifier hs-var">BLC8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; ByteString) -&gt; ProgArg -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="Distribution.Simple.Configure.html#currentCabalId"><span class="hs-identifier hs-var">currentCabalId</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;using&quot;</span></span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Lazy.Char8.html#pack"><span class="hs-identifier hs-var">BLC8.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; ByteString) -&gt; ProgArg -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="Distribution.Simple.Configure.html#currentCompilerId"><span class="hs-identifier hs-var">currentCompilerId</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Check that localBuildInfoFile is up-to-date with respect to the</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- .cabal file.</span><span>
</span><span id="line-393"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkPersistBuildConfigOutdated"><span class="hs-identifier hs-type">checkPersistBuildConfigOutdated</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-398"></span><span id="checkPersistBuildConfigOutdated"><span class="annot"><span class="annottext">checkPersistBuildConfigOutdated :: Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir Dist)
-&gt; SymbolicPath Pkg 'File
-&gt; IO Bool
</span><a href="Distribution.Simple.Configure.html#checkPersistBuildConfigOutdated"><span class="hs-identifier hs-var hs-var">checkPersistBuildConfigOutdated</span></a></span></span><span> </span><span id="local-6989586621679564957"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564957"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span id="local-6989586621679564958"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564958"><span class="hs-identifier hs-var">distPref</span></a></span></span><span> </span><span id="local-6989586621679564959"><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679564959"><span class="hs-identifier hs-var">pkg_descr_file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File -&gt; ProgArg
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679564960"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679564959"><span class="hs-identifier hs-var">pkg_descr_file</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; IO Bool
</span><a href="Distribution.Simple.Utils.html#moreRecentFile"><span class="hs-operator hs-var">`moreRecentFile`</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File -&gt; ProgArg
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679564960"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist) -&gt; SymbolicPath Pkg 'File
</span><a href="Distribution.Simple.Configure.html#localBuildInfoFile"><span class="hs-identifier hs-var">localBuildInfoFile</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564958"><span class="hs-identifier hs-var">distPref</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679564960"><span class="annot"><span class="annottext">i :: SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679564960"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
forall from (allowAbsolute :: AllowAbsolute) (to :: FileOrDir).
Maybe (SymbolicPath CWD ('Dir from))
-&gt; SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#interpretSymbolicPath"><span class="hs-identifier hs-var">interpretSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564957"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="hs-comment">-- See Note [Symbolic paths] in Distribution.Utils.Path</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><span class="hs-comment">-- | Get the path of @dist\/setup-config@.</span></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Distribution.Simple.Configure.html#localBuildInfoFile"><span class="hs-identifier hs-type">localBuildInfoFile</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The @dist@ directory path.</span></span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#File"><span class="hs-identifier hs-type">File</span></a></span><span>
</span><span id="line-408"></span><span id="localBuildInfoFile"><span class="annot"><span class="annottext">localBuildInfoFile :: SymbolicPath Pkg ('Dir Dist) -&gt; SymbolicPath Pkg 'File
</span><a href="Distribution.Simple.Configure.html#localBuildInfoFile"><span class="hs-identifier hs-var hs-var">localBuildInfoFile</span></a></span></span><span> </span><span id="local-6989586621679564962"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564962"><span class="hs-identifier hs-var">distPref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564962"><span class="hs-identifier hs-var">distPref</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
-&gt; RelativePath Dist 'File -&gt; SymbolicPath Pkg 'File
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; RelativePath Dist 'File
forall from (to :: FileOrDir).
HasCallStack =&gt;
ProgArg -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;setup-config&quot;</span></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><span class="hs-comment">-- * Configuration</span></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-comment">-- | Return the \&quot;dist/\&quot; prefix, or the default prefix. The prefix is taken</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- from (in order of highest to lowest preference) the override prefix, the</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- \&quot;CABAL_BUILDDIR\&quot; environment variable, or the default prefix.</span><span>
</span><span id="line-419"></span><span class="annot"><a href="Distribution.Simple.Configure.html#findDistPref"><span class="hs-identifier hs-type">findDistPref</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ default \&quot;dist\&quot; prefix</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#Flag"><span class="hs-identifier hs-type">Setup.Flag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ override \&quot;dist\&quot; prefix</span></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span id="findDistPref"><span class="annot"><span class="annottext">findDistPref :: SymbolicPath Pkg ('Dir Dist)
-&gt; Flag (SymbolicPath Pkg ('Dir Dist))
-&gt; IO (SymbolicPath Pkg ('Dir Dist))
</span><a href="Distribution.Simple.Configure.html#findDistPref"><span class="hs-identifier hs-var hs-var">findDistPref</span></a></span></span><span> </span><span id="local-6989586621679564965"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564965"><span class="hs-identifier hs-var">defDistPref</span></a></span></span><span> </span><span id="local-6989586621679564966"><span class="annot"><span class="annottext">Flag (SymbolicPath Pkg ('Dir Dist))
</span><a href="#local-6989586621679564966"><span class="hs-identifier hs-var">overrideDistPref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621679564967"><span class="annot"><a href="#local-6989586621679564967"><span class="hs-identifier hs-var">envDistPref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Maybe ProgArg -&gt; Flag (SymbolicPath Pkg ('Dir Dist)))
-&gt; IO (Maybe ProgArg) -&gt; IO (Flag (SymbolicPath Pkg ('Dir Dist)))
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg -&gt; Flag (SymbolicPath Pkg ('Dir Dist))
forall {from} {to :: FileOrDir}.
Maybe ProgArg -&gt; Flag (SymbolicPath from to)
</span><a href="#local-6989586621679564968"><span class="hs-identifier hs-var">parseEnvDistPref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg -&gt; IO (Maybe ProgArg)
</span><span class="hs-identifier hs-var">lookupEnv</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;CABAL_BUILDDIR&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-type">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564965"><span class="hs-identifier hs-type">defDistPref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">mappend</span></span><span> </span><span class="annot"><a href="#local-6989586621679564967"><span class="hs-identifier hs-type">envDistPref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564966"><span class="hs-identifier hs-type">overrideDistPref</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679564968"><span class="annot"><span class="annottext">parseEnvDistPref :: Maybe ProgArg -&gt; Flag (SymbolicPath from to)
</span><a href="#local-6989586621679564968"><span class="hs-identifier hs-var hs-var">parseEnvDistPref</span></a></span></span><span> </span><span id="local-6989586621679564971"><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679564971"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679564971"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679564972"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679564972"><span class="hs-identifier hs-var">distPref</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679564972"><span class="hs-identifier hs-var">distPref</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SymbolicPath from to -&gt; Flag (SymbolicPath from to)
forall a. a -&gt; Flag a
</span><a href="Distribution.Simple.Flag.html#toFlag"><span class="hs-identifier hs-var">toFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolicPath from to -&gt; Flag (SymbolicPath from to))
-&gt; SymbolicPath from to -&gt; Flag (SymbolicPath from to)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; SymbolicPath from to
forall from (to :: FileOrDir). ProgArg -&gt; SymbolicPath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeSymbolicPath"><span class="hs-identifier hs-var">makeSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679564972"><span class="hs-identifier hs-var">distPref</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Flag (SymbolicPath from to)
forall a. Flag a
</span><a href="Distribution.Simple.Flag.html#NoFlag"><span class="hs-identifier hs-var">NoFlag</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-comment">-- | Return the \&quot;dist/\&quot; prefix, or the default prefix. The prefix is taken</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- from (in order of highest to lowest preference) the override prefix, the</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- \&quot;CABAL_BUILDDIR\&quot; environment variable, or 'defaultDistPref' is used. Call</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- this function to resolve a @*DistPref@ flag whenever it is not known to be</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- set. (The @*DistPref@ flags are always set to a definite value before</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- invoking 'UserHooks'.)</span><span>
</span><span id="line-440"></span><span class="annot"><a href="Distribution.Simple.Configure.html#findDistPrefOrDefault"><span class="hs-identifier hs-type">findDistPrefOrDefault</span></a></span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#Flag"><span class="hs-identifier hs-type">Setup.Flag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ override \&quot;dist\&quot; prefix</span></span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dist"><span class="hs-identifier hs-type">Dist</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span id="findDistPrefOrDefault"><span class="annot"><span class="annottext">findDistPrefOrDefault :: Flag (SymbolicPath Pkg ('Dir Dist))
-&gt; IO (SymbolicPath Pkg ('Dir Dist))
</span><a href="Distribution.Simple.Configure.html#findDistPrefOrDefault"><span class="hs-identifier hs-var hs-var">findDistPrefOrDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
-&gt; Flag (SymbolicPath Pkg ('Dir Dist))
-&gt; IO (SymbolicPath Pkg ('Dir Dist))
</span><a href="Distribution.Simple.Configure.html#findDistPref"><span class="hs-identifier hs-var">findDistPref</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Dist)
</span><a href="Distribution.Simple.Setup.Common.html#defaultDistPref"><span class="hs-identifier hs-var">defaultDistPref</span></a></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | Perform the \&quot;@.\/setup configure@\&quot; action.</span><span>
</span><span id="line-447"></span><span class="hs-comment">--  Returns the @.setup-config@ file.</span><span>
</span><span id="line-448"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configure"><span class="hs-identifier hs-type">configure</span></a></span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.HookedBuildInfo.html#HookedBuildInfo"><span class="hs-identifier hs-type">HookedBuildInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-452"></span><span id="configure"><span class="annot"><span class="annottext">configure :: (GenericPackageDescription, HookedBuildInfo)
-&gt; ConfigFlags -&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#configure"><span class="hs-identifier hs-var hs-var">configure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigureHooks
-&gt; (GenericPackageDescription, HookedBuildInfo)
-&gt; ConfigFlags
-&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#configure_setupHooks"><span class="hs-identifier hs-var">configure_setupHooks</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigureHooks
</span><a href="Distribution.Simple.SetupHooks.Internal.html#noConfigureHooks"><span class="hs-identifier hs-var">noConfigureHooks</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configure_setupHooks"><span class="hs-identifier hs-type">configure_setupHooks</span></a></span><span>
</span><span id="line-455"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#ConfigureHooks"><span class="hs-identifier hs-type">ConfigureHooks</span></a></span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.HookedBuildInfo.html#HookedBuildInfo"><span class="hs-identifier hs-type">HookedBuildInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-459"></span><span id="configure_setupHooks"><span class="annot"><span class="annottext">configure_setupHooks :: ConfigureHooks
-&gt; (GenericPackageDescription, HookedBuildInfo)
-&gt; ConfigFlags
-&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#configure_setupHooks"><span class="hs-identifier hs-var hs-var">configure_setupHooks</span></a></span></span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#ConfigureHooks"><span class="hs-identifier hs-type">ConfigureHooks</span></a></span><span class="hs-special">{</span><span id="local-6989586621679564980"><span class="annot"><span class="annottext">Maybe PreConfPackageHook
preConfPackageHook :: Maybe PreConfPackageHook
preConfPackageHook :: ConfigureHooks -&gt; Maybe PreConfPackageHook
</span><a href="#local-6989586621679564980"><span class="hs-identifier hs-var hs-var">preConfPackageHook</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679564982"><span class="annot"><span class="annottext">Maybe PostConfPackageHook
postConfPackageHook :: Maybe PostConfPackageHook
postConfPackageHook :: ConfigureHooks -&gt; Maybe PostConfPackageHook
</span><a href="#local-6989586621679564982"><span class="hs-identifier hs-var hs-var">postConfPackageHook</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679564984"><span class="annot"><span class="annottext">Maybe PreConfComponentHook
preConfComponentHook :: Maybe PreConfComponentHook
preConfComponentHook :: ConfigureHooks -&gt; Maybe PreConfComponentHook
</span><a href="#local-6989586621679564984"><span class="hs-identifier hs-var hs-var">preConfComponentHook</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679564986"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679564986"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679564987"><span class="annot"><span class="annottext">HookedBuildInfo
</span><a href="#local-6989586621679564987"><span class="hs-identifier hs-var">hookedBuildInfo</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span id="local-6989586621679564988"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679564988"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-comment">-- Cabal pre-configure</span><span>
</span><span id="line-464"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679564991"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679564991"><span class="hs-identifier hs-var hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Config.html#configVerbosity"><span class="hs-identifier hs-var">configVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679564988"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>        </span><span id="local-6989586621679564996"><span class="annot"><span class="annottext">distPref :: SymbolicPath Pkg ('Dir Dist)
</span><a href="#local-6989586621679564996"><span class="hs-identifier hs-var hs-var hs-var">distPref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag (SymbolicPath Pkg ('Dir Dist)) -&gt; SymbolicPath Pkg ('Dir Dist)
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag (SymbolicPath Pkg ('Dir Dist))
 -&gt; SymbolicPath Pkg ('Dir Dist))
-&gt; Flag (SymbolicPath Pkg ('Dir Dist))
-&gt; SymbolicPath Pkg ('Dir Dist)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag (SymbolicPath Pkg ('Dir Dist))
</span><a href="Distribution.Simple.Setup.Config.html#configDistPref"><span class="hs-identifier hs-var">configDistPref</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679564988"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-466"></span><span>        </span><span id="local-6989586621679564998"><span class="annot"><span class="annottext">mbWorkDir :: Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679564998"><span class="hs-identifier hs-var hs-var hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag (SymbolicPath CWD ('Dir Pkg))
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
forall a. Flag a -&gt; Maybe a
</span><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-var">flagToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag (SymbolicPath CWD ('Dir Pkg))
 -&gt; Maybe (SymbolicPath CWD ('Dir Pkg)))
-&gt; Flag (SymbolicPath CWD ('Dir Pkg))
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.Setup.Config.html#configWorkingDir"><span class="hs-identifier hs-var">configWorkingDir</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679564988"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679565001"><span class="annot"><a href="#local-6989586621679565001"><span class="hs-identifier hs-var">lbc0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565002"><span class="annot"><a href="#local-6989586621679565002"><span class="hs-identifier hs-var">comp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565003"><span class="annot"><a href="#local-6989586621679565003"><span class="hs-identifier hs-var">platform</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565004"><span class="annot"><a href="#local-6989586621679565004"><span class="hs-identifier hs-var">enabledComps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConfigFlags
-&gt; GenericPackageDescription
-&gt; IO
     (LocalBuildConfig, Compiler, Platform, ComponentRequestedSpec)
</span><a href="Distribution.Simple.Configure.html#preConfigurePackage"><span class="hs-identifier hs-var">preConfigurePackage</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679564988"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679564986"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-comment">-- Package-wide pre-configure hook</span><span>
</span><span id="line-470"></span><span>    </span><span id="local-6989586621679565006"><span class="annot"><a href="#local-6989586621679565006"><span class="hs-identifier hs-var">lbc1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679564980"><span class="hs-identifier hs-type">preConfPackageHook</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-472"></span><span>        </span><span class="annot"><span class="annottext">Maybe PreConfPackageHook
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig -&gt; IO LocalBuildConfig
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565001"><span class="hs-identifier hs-var">lbc0</span></a></span><span>
</span><span id="line-473"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565007"><span class="annot"><span class="annottext">PreConfPackageHook
</span><a href="#local-6989586621679565007"><span class="hs-identifier hs-var">pre_conf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-474"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565008"><span class="annot"><span class="annottext">programDb0 :: ProgramDb
</span><a href="#local-6989586621679565008"><span class="hs-identifier hs-var hs-var hs-var">programDb0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig -&gt; ProgramDb
</span><a href="Distribution.Types.LocalBuildConfig.html#withPrograms"><span class="hs-identifier hs-var">LBC.withPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565001"><span class="hs-identifier hs-var">lbc0</span></a></span><span>
</span><span id="line-475"></span><span>              </span><span id="local-6989586621679565010"><span class="annot"><span class="annottext">programDb0' :: ProgramDb
</span><a href="#local-6989586621679565010"><span class="hs-identifier hs-var hs-var hs-var">programDb0'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565008"><span class="hs-identifier hs-var">programDb0</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.Simple.Program.Db.html#unconfiguredProgs"><span class="hs-identifier hs-var">unconfiguredProgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-type">Map.empty</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-476"></span><span>              </span><span id="local-6989586621679565013"><span class="annot"><span class="annottext">input :: PreConfPackageInputs
</span><a href="#local-6989586621679565013"><span class="hs-identifier hs-var hs-var hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>                </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#PreConfPackageInputs"><span class="hs-identifier hs-type">SetupHooks.PreConfPackageInputs</span></a></span><span>
</span><span id="line-478"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">configFlags :: ConfigFlags
</span><a href="Distribution.Simple.SetupHooks.Internal.html#configFlags"><span class="hs-identifier hs-var">SetupHooks.configFlags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679564988"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-479"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">localBuildConfig :: LocalBuildConfig
</span><a href="Distribution.Simple.SetupHooks.Internal.html#localBuildConfig"><span class="hs-identifier hs-var">SetupHooks.localBuildConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565001"><span class="hs-identifier hs-var">lbc0</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withPrograms"><span class="hs-identifier hs-var">LBC.withPrograms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565010"><span class="hs-identifier hs-type">programDb0'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-480"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Unconfigured programs are not supplied to the hook,</span><span>
</span><span id="line-481"></span><span>                    </span><span class="hs-comment">-- as these cannot be passed over a serialisation boundary</span><span>
</span><span id="line-482"></span><span>                    </span><span class="hs-comment">-- (see the &quot;Binary ProgramDb&quot; instance).</span><span>
</span><span id="line-483"></span><span>                    </span><span class="annot"><span class="annottext">compiler :: Compiler
</span><a href="Distribution.Simple.SetupHooks.Internal.html#compiler"><span class="hs-identifier hs-var">SetupHooks.compiler</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565002"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-484"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">platform :: Platform
</span><a href="Distribution.Simple.SetupHooks.Internal.html#platform"><span class="hs-identifier hs-var">SetupHooks.platform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565003"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-485"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-486"></span><span>          </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#PreConfPackageOutputs"><span class="hs-identifier hs-type">SetupHooks.PreConfPackageOutputs</span></a></span><span>
</span><span id="line-487"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#buildOptions"><span class="hs-identifier hs-var">SetupHooks.buildOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565021"><span class="annot"><a href="#local-6989586621679565021"><span class="hs-identifier hs-var">opts1</span></a></span></span><span>
</span><span id="line-488"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#extraConfiguredProgs"><span class="hs-identifier hs-var">SetupHooks.extraConfiguredProgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565023"><span class="annot"><a href="#local-6989586621679565023"><span class="hs-identifier hs-var">progs1</span></a></span></span><span>
</span><span id="line-489"></span><span>            </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-490"></span><span>            </span><span class="annot"><span class="annottext">PreConfPackageHook
</span><a href="#local-6989586621679565007"><span class="hs-identifier hs-var">pre_conf</span></a></span><span> </span><span class="annot"><span class="annottext">PreConfPackageInputs
</span><a href="#local-6989586621679565013"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-491"></span><span>          </span><span class="hs-comment">-- The package-wide pre-configure hook returns BuildOptions that</span><span>
</span><span id="line-492"></span><span>          </span><span class="hs-comment">-- overrides the one it was passed in, as well as an update to</span><span>
</span><span id="line-493"></span><span>          </span><span class="hs-comment">-- the ProgramDb in the form of new configured programs to add</span><span>
</span><span id="line-494"></span><span>          </span><span class="hs-comment">-- to the program database.</span><span>
</span><span id="line-495"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-496"></span><span>            </span><span class="annot"><a href="#local-6989586621679565001"><span class="hs-identifier hs-type">lbc0</span></a></span><span>
</span><span id="line-497"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withBuildOptions"><span class="hs-identifier hs-var">LBC.withBuildOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565021"><span class="hs-identifier hs-type">opts1</span></a></span><span>
</span><span id="line-498"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withPrograms"><span class="hs-identifier hs-var">LBC.withPrograms</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-499"></span><span>                  </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#updateConfiguredProgs"><span class="hs-identifier hs-type">updateConfiguredProgs</span></a></span><span>
</span><span id="line-500"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">`Map.union`</span></span><span> </span><span class="annot"><span class="hs-identifier">progs1</span></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>                    </span><span class="annot"><a href="#local-6989586621679565008"><span class="hs-identifier hs-type">programDb0</span></a></span><span>
</span><span id="line-502"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-comment">-- Cabal package-wide configure</span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679565026"><span class="annot"><a href="#local-6989586621679565026"><span class="hs-identifier hs-var">lbc2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565027"><span class="annot"><a href="#local-6989586621679565027"><span class="hs-identifier hs-var">pbd2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565028"><span class="annot"><a href="#local-6989586621679565028"><span class="hs-identifier hs-var">pkg_info</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-506"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Configure.html#finalizeAndConfigurePackage"><span class="hs-identifier hs-type">finalizeAndConfigurePackage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564988"><span class="hs-identifier hs-type">cfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565006"><span class="hs-identifier hs-type">lbc1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564986"><span class="hs-identifier hs-type">g_pkg_descr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565002"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565003"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565004"><span class="hs-identifier hs-type">enabledComps</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-comment">-- Package-wide post-configure hook</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">for_</span></span><span> </span><span class="annot"><a href="#local-6989586621679564982"><span class="hs-identifier hs-type">postConfPackageHook</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565031"><span class="annot"><span class="annottext">PostConfPackageHook
</span><a href="#local-6989586621679565031"><span class="hs-identifier hs-var">postConfPkg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-510"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565032"><span class="annot"><span class="annottext">input :: PostConfPackageInputs
</span><a href="#local-6989586621679565032"><span class="hs-identifier hs-var hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-511"></span><span>            </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#PostConfPackageInputs"><span class="hs-identifier hs-type">SetupHooks.PostConfPackageInputs</span></a></span><span>
</span><span id="line-512"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">localBuildConfig :: LocalBuildConfig
</span><a href="Distribution.Simple.SetupHooks.Internal.html#localBuildConfig"><span class="hs-identifier hs-var">SetupHooks.localBuildConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565026"><span class="hs-identifier hs-var">lbc2</span></a></span><span>
</span><span id="line-513"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">packageBuildDescr :: PackageBuildDescr
</span><a href="Distribution.Simple.SetupHooks.Internal.html#packageBuildDescr"><span class="hs-identifier hs-var">SetupHooks.packageBuildDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageBuildDescr
</span><a href="#local-6989586621679565027"><span class="hs-identifier hs-var">pbd2</span></a></span><span>
</span><span id="line-514"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-515"></span><span>      </span><span class="annot"><span class="annottext">PostConfPackageHook
</span><a href="#local-6989586621679565031"><span class="hs-identifier hs-var">postConfPkg</span></a></span><span> </span><span class="annot"><span class="annottext">PostConfPackageInputs
</span><a href="#local-6989586621679565032"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-comment">-- Per-component pre-configure hook</span><span>
</span><span id="line-518"></span><span>    </span><span id="local-6989586621679565036"><span class="annot"><a href="#local-6989586621679565036"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-519"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565037"><span class="annot"><a href="#local-6989586621679565037"><span class="hs-identifier hs-var hs-var">pkg_descr2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageBuildDescr -&gt; PackageDescription
</span><a href="Distribution.Types.LocalBuildConfig.html#localPkgDescr"><span class="hs-identifier hs-var">LBC.localPkgDescr</span></a></span><span> </span><span class="annot"><span class="annottext">PackageBuildDescr
</span><a href="#local-6989586621679565027"><span class="hs-identifier hs-var">pbd2</span></a></span><span>
</span><span id="line-520"></span><span>      </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#applyComponentDiffs"><span class="hs-identifier hs-type">applyComponentDiffs</span></a></span><span>
</span><span id="line-521"></span><span>        </span><span class="annot"><a href="#local-6989586621679564991"><span class="hs-identifier hs-type">verbosity</span></a></span><span>
</span><span id="line-522"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565039"><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621679565039"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PreConfComponentHook
-&gt; (PreConfComponentHook -&gt; IO ComponentDiff)
-&gt; IO (Maybe ComponentDiff)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">Maybe PreConfComponentHook
</span><a href="#local-6989586621679564984"><span class="hs-identifier hs-var">preConfComponentHook</span></a></span><span> </span><span class="annot"><span class="annottext">((PreConfComponentHook -&gt; IO ComponentDiff)
 -&gt; IO (Maybe ComponentDiff))
-&gt; (PreConfComponentHook -&gt; IO ComponentDiff)
-&gt; IO (Maybe ComponentDiff)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565041"><span class="annot"><span class="annottext">PreConfComponentHook
</span><a href="#local-6989586621679565041"><span class="hs-identifier hs-var">computeDiff</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-523"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565042"><span class="annot"><span class="annottext">input :: PreConfComponentInputs
</span><a href="#local-6989586621679565042"><span class="hs-identifier hs-var hs-var hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-524"></span><span>                  </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#PreConfComponentInputs"><span class="hs-identifier hs-type">SetupHooks.PreConfComponentInputs</span></a></span><span>
</span><span id="line-525"></span><span>                    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">localBuildConfig :: LocalBuildConfig
</span><a href="Distribution.Simple.SetupHooks.Internal.html#localBuildConfig"><span class="hs-identifier hs-var">SetupHooks.localBuildConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565026"><span class="hs-identifier hs-var">lbc2</span></a></span><span>
</span><span id="line-526"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">packageBuildDescr :: PackageBuildDescr
</span><a href="Distribution.Simple.SetupHooks.Internal.html#packageBuildDescr"><span class="hs-identifier hs-var">SetupHooks.packageBuildDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageBuildDescr
</span><a href="#local-6989586621679565027"><span class="hs-identifier hs-var">pbd2</span></a></span><span>
</span><span id="line-527"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">component :: Component
</span><a href="Distribution.Simple.SetupHooks.Internal.html#component"><span class="hs-identifier hs-var">SetupHooks.component</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Component
</span><a href="#local-6989586621679565039"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-528"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-529"></span><span>            </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#PreConfComponentOutputs"><span class="hs-identifier hs-type">SetupHooks.PreConfComponentOutputs</span></a></span><span>
</span><span id="line-530"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Simple.SetupHooks.Internal.html#componentDiff"><span class="hs-identifier hs-var">SetupHooks.componentDiff</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565049"><span class="annot"><a href="#local-6989586621679565049"><span class="hs-identifier hs-var">diff</span></a></span></span><span>
</span><span id="line-531"></span><span>              </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-532"></span><span>              </span><span class="annot"><span class="annottext">PreConfComponentHook
</span><a href="#local-6989586621679565041"><span class="hs-identifier hs-var">computeDiff</span></a></span><span> </span><span class="annot"><span class="annottext">PreConfComponentInputs
</span><a href="#local-6989586621679565042"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-533"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679565049"><span class="hs-identifier hs-type">diff</span></a></span><span>
</span><span id="line-534"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>        </span><span class="annot"><a href="#local-6989586621679565037"><span class="hs-identifier hs-type">pkg_descr2</span></a></span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565050"><span class="annot"><a href="#local-6989586621679565050"><span class="hs-identifier hs-var hs-var">pbd3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageBuildDescr
</span><a href="#local-6989586621679565027"><span class="hs-identifier hs-var">pbd2</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#localPkgDescr"><span class="hs-identifier hs-var">LBC.localPkgDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565036"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-comment">-- Cabal per-component configure</span><span>
</span><span id="line-539"></span><span>    </span><span id="local-6989586621679565051"><span class="annot"><a href="#local-6989586621679565051"><span class="hs-identifier hs-var">externalPkgDeps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#finalCheckPackage"><span class="hs-identifier hs-type">finalCheckPackage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564986"><span class="hs-identifier hs-type">g_pkg_descr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565050"><span class="hs-identifier hs-type">pbd3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564987"><span class="hs-identifier hs-type">hookedBuildInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565028"><span class="hs-identifier hs-type">pkg_info</span></a></span><span>
</span><span id="line-540"></span><span>    </span><span id="local-6989586621679565053"><span class="annot"><a href="#local-6989586621679565053"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#configureComponents"><span class="hs-identifier hs-type">configureComponents</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565026"><span class="hs-identifier hs-type">lbc2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565050"><span class="hs-identifier hs-type">pbd3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565028"><span class="hs-identifier hs-type">pkg_info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565051"><span class="hs-identifier hs-type">externalPkgDeps</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Configure.html#writePersistBuildConfig"><span class="hs-identifier hs-type">writePersistBuildConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564998"><span class="hs-identifier hs-type">mbWorkDir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564996"><span class="hs-identifier hs-type">distPref</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565053"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679565053"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="annot"><a href="Distribution.Simple.Configure.html#preConfigurePackage"><span class="hs-identifier hs-type">preConfigurePackage</span></a></span><span>
</span><span id="line-547"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span id="preConfigurePackage"><span class="annot"><span class="annottext">preConfigurePackage :: ConfigFlags
-&gt; GenericPackageDescription
-&gt; IO
     (LocalBuildConfig, Compiler, Platform, ComponentRequestedSpec)
</span><a href="Distribution.Simple.Configure.html#preConfigurePackage"><span class="hs-identifier hs-var hs-var">preConfigurePackage</span></a></span></span><span> </span><span id="local-6989586621679565055"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565055"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679565056"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565056"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-551"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565059"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679565059"><span class="hs-identifier hs-var hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Verbosity -&gt; Verbosity) -&gt; Flag Verbosity -&gt; Verbosity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Config.html#configVerbosity"><span class="hs-identifier hs-var">configVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565055"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-comment">-- Determine the component we are configuring, if a user specified</span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-comment">-- one on the command line.  We use a fake, flattened version of</span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-comment">-- the package since at this point, we're not really sure what</span><span>
</span><span id="line-556"></span><span>  </span><span class="hs-comment">-- components we *can* configure.  @Nothing@ means that we should</span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-comment">-- configure everything (the old behavior).</span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679565060"><span class="annot"><a href="#local-6989586621679565060"><span class="hs-identifier hs-var">mb_cname</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier">ComponentName</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565061"><span class="annot"><span class="annottext">flat_pkg_descr :: PackageDescription
</span><a href="#local-6989586621679565061"><span class="hs-identifier hs-var hs-var hs-var">flat_pkg_descr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; PackageDescription
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.Configuration.html#flattenPackageDescription"><span class="hs-identifier hs-var">flattenPackageDescription</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565056"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span><span>
</span><span id="line-560"></span><span>        </span><span id="local-6989586621679565063"><span class="annot"><span class="annottext">targets0 :: [ProgArg]
</span><a href="#local-6989586621679565063"><span class="hs-identifier hs-var hs-var hs-var">targets0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; [ProgArg]
</span><a href="Distribution.Simple.Setup.Config.html#configTargets"><span class="hs-identifier hs-var">configTargets</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565055"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621679565065"><span class="annot"><a href="#local-6989586621679565065"><span class="hs-identifier hs-var">targets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; PackageDescription -&gt; [ProgArg] -&gt; IO [BuildTarget]
</span><a href="Distribution.Simple.BuildTarget.html#readBuildTargets"><span class="hs-identifier hs-var">readBuildTargets</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565059"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565061"><span class="hs-identifier hs-var">flat_pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679565063"><span class="hs-identifier hs-var">targets0</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-comment">-- TODO: bleat if you use the module/file syntax</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565067"><span class="annot"><a href="#local-6989586621679565067"><span class="hs-identifier hs-var hs-var">targets'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565068"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Distribution.Simple.BuildTarget.html#BuildTargetComponent"><span class="hs-identifier hs-type">BuildTargetComponent</span></a></span><span> </span><span id="local-6989586621679565068"><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565068"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[BuildTarget]
</span><a href="#local-6989586621679565065"><span class="hs-identifier hs-var">targets</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679565067"><span class="hs-identifier hs-type">targets'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-565"></span><span>      </span><span class="annot"><span class="annottext">[ComponentName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679565063"><span class="hs-identifier hs-var">targets0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ComponentName -&gt; IO (Maybe ComponentName)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe ComponentName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-566"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679565070"><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565070"><span class="hs-identifier hs-var">cname</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ComponentName -&gt; IO (Maybe ComponentName)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentName -&gt; Maybe ComponentName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565070"><span class="hs-identifier hs-var">cname</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO (Maybe ComponentName)
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565059"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#NoValidComponent"><span class="hs-identifier hs-var">NoValidComponent</span></a></span><span>
</span><span id="line-568"></span><span>      </span><span class="annot"><span class="annottext">[ComponentName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO (Maybe ComponentName)
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565059"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#ConfigureEitherSingleOrAll"><span class="hs-identifier hs-var">ConfigureEitherSingleOrAll</span></a></span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679565060"><span class="hs-identifier hs-type">mb_cname</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-571"></span><span>    </span><span class="annot"><span class="annottext">Maybe ComponentName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; PackageIdentifier -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#setupMessage"><span class="hs-identifier hs-var">setupMessage</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565059"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Configuring&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; PackageIdentifier
forall pkg. Package pkg =&gt; pkg -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageId"><span class="hs-identifier hs-var">packageId</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565056"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565076"><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565076"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-573"></span><span>      </span><span class="annot"><span class="annottext">Verbosity
-&gt; ProgArg
-&gt; PackageIdentifier
-&gt; ComponentName
-&gt; Maybe [(ModuleName, Module)]
-&gt; IO ()
forall a.
Pretty a =&gt;
Verbosity
-&gt; ProgArg
-&gt; PackageIdentifier
-&gt; ComponentName
-&gt; Maybe [(ModuleName, a)]
-&gt; IO ()
</span><a href="Distribution.Backpack.DescribeUnitId.html#setupMessage%27"><span class="hs-identifier hs-var">setupMessage'</span></a></span><span>
</span><span id="line-574"></span><span>        </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565059"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-575"></span><span>        </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Configuring&quot;</span></span><span>
</span><span id="line-576"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; PackageIdentifier
forall pkg. Package pkg =&gt; pkg -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageId"><span class="hs-identifier hs-var">packageId</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565056"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>        </span><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565076"><span class="hs-identifier hs-var">cname</span></a></span><span>
</span><span id="line-578"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ModuleName, Module)] -&gt; Maybe [(ModuleName, Module)]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; [(ModuleName, Module)]
</span><a href="Distribution.Simple.Setup.Config.html#configInstantiateWith"><span class="hs-identifier hs-var">configInstantiateWith</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565055"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-comment">-- configCID is only valid for per-component configure</span><span>
</span><span id="line-581"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-type">flagToMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configCID"><span class="hs-identifier hs-var">configCID</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">isNothing</span></span><span> </span><span class="annot"><a href="#local-6989586621679565060"><span class="hs-identifier hs-type">mb_cname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-582"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-type">dieWithException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565059"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#ConfigCIDValidForPreComponent"><span class="hs-identifier hs-type">ConfigCIDValidForPreComponent</span></a></span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-comment">-- Make a data structure describing what components are enabled.</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679565085"><span class="hs-identifier hs-type">enabled</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span>
</span><span id="line-586"></span><span>      </span><span id="local-6989586621679565085"><span class="annot"><a href="#local-6989586621679565085"><span class="hs-identifier hs-var hs-var">enabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ComponentName
</span><a href="#local-6989586621679565060"><span class="hs-identifier hs-var">mb_cname</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-587"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565086"><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565086"><span class="hs-identifier hs-var">cname</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ComponentName -&gt; ComponentRequestedSpec
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#OneComponentRequestedSpec"><span class="hs-identifier hs-var">OneComponentRequestedSpec</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565086"><span class="hs-identifier hs-var">cname</span></a></span><span>
</span><span id="line-588"></span><span>        </span><span class="annot"><span class="annottext">Maybe ComponentName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-589"></span><span>          </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span>
</span><span id="line-590"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- The flag name (@--enable-tests@) is a</span><span>
</span><span id="line-591"></span><span>              </span><span class="hs-comment">-- little bit of a misnomer, because</span><span>
</span><span id="line-592"></span><span>              </span><span class="hs-comment">-- just passing this flag won't</span><span>
</span><span id="line-593"></span><span>              </span><span class="hs-comment">-- &quot;enable&quot;, in our internal</span><span>
</span><span id="line-594"></span><span>              </span><span class="hs-comment">-- nomenclature; it's just a request; a</span><span>
</span><span id="line-595"></span><span>              </span><span class="hs-comment">-- @buildable: False@ might make it</span><span>
</span><span id="line-596"></span><span>              </span><span class="hs-comment">-- not possible to enable.</span><span>
</span><span id="line-597"></span><span>              </span><span class="annot"><span class="annottext">testsRequested :: Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#testsRequested"><span class="hs-identifier hs-var">testsRequested</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configTests"><span class="hs-identifier hs-var">configTests</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565055"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">benchmarksRequested :: Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#benchmarksRequested"><span class="hs-identifier hs-var">benchmarksRequested</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-599"></span><span>                </span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configBenchmarks"><span class="hs-identifier hs-var">configBenchmarks</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565055"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-comment">-- Some sanity checks related to enabling components.</span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span>
</span><span id="line-603"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">isJust</span></span><span> </span><span class="annot"><a href="#local-6989586621679565060"><span class="hs-identifier hs-type">mb_cname</span></a></span><span>
</span><span id="line-604"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-type">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configTests"><span class="hs-identifier hs-var">configTests</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-type">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configBenchmarks"><span class="hs-identifier hs-var">configBenchmarks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-type">dieWithException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565059"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#SanityCheckForEnableComponents"><span class="hs-identifier hs-type">SanityCheckForEnableComponents</span></a></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span>  </span><span class="annot"><a href="Distribution.Simple.Configure.html#checkDeprecatedFlags"><span class="hs-identifier hs-type">checkDeprecatedFlags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565059"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span>
</span><span id="line-609"></span><span>  </span><span class="annot"><a href="Distribution.Simple.Configure.html#checkExactConfiguration"><span class="hs-identifier hs-type">checkExactConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565059"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565056"><span class="hs-identifier hs-type">g_pkg_descr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621679565097"><span class="annot"><a href="#local-6989586621679565097"><span class="hs-identifier hs-var">programDbPre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#mkProgramDb"><span class="hs-identifier hs-type">mkProgramDb</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configPrograms"><span class="hs-identifier hs-type">configPrograms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-comment">-- comp:            the compiler we're building with</span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-comment">-- compPlatform:    the platform we're building for</span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-comment">-- programDb:  location and args of all programs we're</span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-comment">--                  building with</span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679565100"><span class="annot"><a href="#local-6989586621679565100"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Compiler</span></span><span>
</span><span id="line-617"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565101"><span class="annot"><a href="#local-6989586621679565101"><span class="hs-identifier hs-var">compPlatform</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Platform</span></span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565102"><span class="annot"><a href="#local-6989586621679565102"><span class="hs-identifier hs-var">programDb00</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">ProgramDb</span></span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Configure.html#configCompilerEx"><span class="hs-identifier hs-type">configCompilerEx</span></a></span><span>
</span><span id="line-621"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-type">flagToMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configHcFlavor"><span class="hs-identifier hs-var">configHcFlavor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-type">flagToMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configHcPath"><span class="hs-identifier hs-var">configHcPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-type">flagToMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configHcPkg"><span class="hs-identifier hs-var">configHcPkg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>      </span><span class="annot"><a href="#local-6989586621679565097"><span class="hs-identifier hs-type">programDbPre</span></a></span><span>
</span><span id="line-625"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Verbosity.html#lessVerbose"><span class="hs-identifier hs-type">lessVerbose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565059"><span class="hs-identifier hs-type">verbosity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span>  </span><span class="hs-comment">-- Where to build the package</span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679565107"><span class="hs-identifier hs-type">builddir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Build"><span class="hs-identifier hs-type">Build</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- e.g. dist/build</span><span>
</span><span id="line-629"></span><span>      </span><span id="local-6989586621679565107"><span class="annot"><a href="#local-6989586621679565107"><span class="hs-identifier hs-var hs-var">builddir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; SymbolicPath Pkg ('Dir Build)
</span><a href="Distribution.Types.LocalBuildInfo.html#setupFlagsBuildDir"><span class="hs-identifier hs-var">setupFlagsBuildDir</span></a></span><span> </span><span class="annot"><span class="annottext">(CommonSetupFlags -&gt; SymbolicPath Pkg ('Dir Build))
-&gt; CommonSetupFlags -&gt; SymbolicPath Pkg ('Dir Build)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565055"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-630"></span><span>      </span><span id="local-6989586621679565110"><span class="annot"><a href="#local-6989586621679565110"><span class="hs-identifier hs-var hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag (SymbolicPath CWD ('Dir Pkg))
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
forall a. Flag a -&gt; Maybe a
</span><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-var">flagToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag (SymbolicPath CWD ('Dir Pkg))
 -&gt; Maybe (SymbolicPath CWD ('Dir Pkg)))
-&gt; Flag (SymbolicPath CWD ('Dir Pkg))
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.Setup.Config.html#configWorkingDir"><span class="hs-identifier hs-var">configWorkingDir</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565055"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="hs-comment">-- NB: create this directory now so that all configure hooks get</span><span>
</span><span id="line-632"></span><span>  </span><span class="hs-comment">-- to see it. (In practice, the Configure build-type needs it before</span><span>
</span><span id="line-633"></span><span>  </span><span class="hs-comment">-- the postConfPackageHook runs.)</span><span>
</span><span id="line-634"></span><span>  </span><span class="annot"><a href="Distribution.Simple.Utils.html#createDirectoryIfMissingVerbose"><span class="hs-identifier hs-type">createDirectoryIfMissingVerbose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Verbosity.html#lessVerbose"><span class="hs-identifier hs-type">lessVerbose</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565059"><span class="hs-identifier hs-type">verbosity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-635"></span><span>    </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#interpretSymbolicPath"><span class="hs-identifier hs-type">interpretSymbolicPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565110"><span class="hs-identifier hs-type">mbWorkDir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565107"><span class="hs-identifier hs-type">builddir</span></a></span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span>  </span><span id="local-6989586621679565112"><span class="annot"><a href="#local-6989586621679565112"><span class="hs-identifier hs-var">lbc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#computeLocalBuildConfig"><span class="hs-identifier hs-type">computeLocalBuildConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565055"><span class="hs-identifier hs-type">cfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565100"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565102"><span class="hs-identifier hs-type">programDb00</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679565112"><span class="hs-identifier hs-type">lbc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679565100"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679565101"><span class="hs-identifier hs-type">compPlatform</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679565085"><span class="hs-identifier hs-type">enabled</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="annot"><a href="Distribution.Simple.Configure.html#computeLocalBuildConfig"><span class="hs-identifier hs-type">computeLocalBuildConfig</span></a></span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-642"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span>
</span><span id="line-645"></span><span id="computeLocalBuildConfig"><span class="annot"><span class="annottext">computeLocalBuildConfig :: ConfigFlags -&gt; Compiler -&gt; ProgramDb -&gt; IO LocalBuildConfig
</span><a href="Distribution.Simple.Configure.html#computeLocalBuildConfig"><span class="hs-identifier hs-var hs-var">computeLocalBuildConfig</span></a></span></span><span> </span><span id="local-6989586621679565114"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679565115"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679565116"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565116"><span class="hs-identifier hs-var">programDb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565117"><span class="annot"><span class="annottext">common :: CommonSetupFlags
</span><a href="#local-6989586621679565117"><span class="hs-identifier hs-var hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-647"></span><span>      </span><span id="local-6989586621679565120"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679565120"><span class="hs-identifier hs-var hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Verbosity -&gt; Verbosity) -&gt; Flag Verbosity -&gt; Verbosity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Common.html#setupVerbosity"><span class="hs-identifier hs-var">setupVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679565117"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-comment">-- Decide if we're going to compile with split sections.</span><span>
</span><span id="line-649"></span><span>  </span><span id="local-6989586621679565122"><span class="annot"><a href="#local-6989586621679565122"><span class="hs-identifier hs-var">split_sections</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Bool</span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-650"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Bool -&gt; Bool) -&gt; Flag Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configSplitSections"><span class="hs-identifier hs-var">configSplitSections</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-652"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; CompilerFlavor
</span><a href="Distribution.Simple.Compiler.html#compilerFlavor"><span class="hs-identifier hs-var">compilerFlavor</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-653"></span><span>        </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span>
</span><span id="line-654"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Version
</span><a href="Distribution.Simple.Compiler.html#compilerVersion"><span class="hs-identifier hs-var">compilerVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-var">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-655"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-656"></span><span>        </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHCJS"><span class="hs-identifier hs-var">GHCJS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-657"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-658"></span><span>        </span><span class="annot"><span class="annottext">CompilerFlavor
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-659"></span><span>          </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-660"></span><span>            </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565120"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-661"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;this compiler does not support &quot;</span></span><span>
</span><span id="line-662"></span><span>                </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;--enable-split-sections; ignoring&quot;</span></span><span>
</span><span id="line-663"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-comment">-- Decide if we're going to compile with split objects.</span><span>
</span><span id="line-667"></span><span>  </span><span id="local-6989586621679565130"><span class="annot"><a href="#local-6989586621679565130"><span class="hs-identifier hs-var">split_objs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Bool</span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-type">fromFlag</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configSplitObjs"><span class="hs-identifier hs-var">configSplitObjs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565114"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-670"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#compilerFlavor"><span class="hs-identifier hs-type">compilerFlavor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565115"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-671"></span><span>        </span><span class="annot"><span class="annottext">CompilerFlavor
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565122"><span class="hs-identifier hs-var">split_sections</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-672"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-673"></span><span>            </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-674"></span><span>              </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565120"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-675"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;--enable-split-sections and &quot;</span></span><span>
</span><span id="line-676"></span><span>                  </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;--enable-split-objs are mutually &quot;</span></span><span>
</span><span id="line-677"></span><span>                  </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;exclusive; ignoring the latter&quot;</span></span><span>
</span><span id="line-678"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-680"></span><span>        </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-681"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-682"></span><span>        </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHCJS"><span class="hs-identifier hs-var">GHCJS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-683"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-684"></span><span>        </span><span class="annot"><span class="annottext">CompilerFlavor
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-685"></span><span>          </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-686"></span><span>            </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565120"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-687"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;this compiler does not support &quot;</span></span><span>
</span><span id="line-688"></span><span>                </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;--enable-split-objs; ignoring&quot;</span></span><span>
</span><span id="line-689"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-691"></span><span>
</span><span id="line-692"></span><span>  </span><span class="hs-comment">-- Basically yes/no/unknown.</span><span>
</span><span id="line-693"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679565132"><span class="hs-identifier hs-type">linkerSupportsRelocations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-694"></span><span>      </span><span id="local-6989586621679565132"><span class="annot"><a href="#local-6989586621679565132"><span class="hs-identifier hs-var hs-var">linkerSupportsRelocations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-695"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgramDb -&gt; Maybe ConfiguredProgram
</span><a href="Distribution.Simple.Program.Db.html#lookupProgramByName"><span class="hs-identifier hs-var">lookupProgramByName</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;ld&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565116"><span class="hs-identifier hs-var">programDb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-696"></span><span>          </span><span class="annot"><span class="annottext">Maybe ConfiguredProgram
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-697"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565133"><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565133"><span class="hs-identifier hs-var">ld</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-698"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Map ProgArg ProgArg -&gt; Maybe ProgArg
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Supports relocatable output&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Map ProgArg ProgArg -&gt; Maybe ProgArg)
-&gt; Map ProgArg ProgArg -&gt; Maybe ProgArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; Map ProgArg ProgArg
</span><a href="Distribution.Simple.Program.Types.html#programProperties"><span class="hs-identifier hs-var">programProperties</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565133"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-699"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;YES&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-700"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;NO&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-701"></span><span>              </span><span id="local-6989586621679565136"><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679565136"><span class="hs-identifier hs-var">_other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565140"><span class="annot"><a href="#local-6989586621679565140"><span class="hs-identifier hs-var hs-var">ghciLibByDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-703"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; CompilerId
</span><a href="Distribution.Simple.Compiler.html#compilerId"><span class="hs-identifier hs-var">compilerId</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-704"></span><span>          </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#CompilerId"><span class="hs-identifier hs-type">CompilerId</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-705"></span><span>            </span><span class="hs-comment">-- If ghc is non-dynamic, then ghci needs object files,</span><span>
</span><span id="line-706"></span><span>            </span><span class="hs-comment">-- so we build one by default.</span><span>
</span><span id="line-707"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-708"></span><span>            </span><span class="hs-comment">-- Technically, archive files should be sufficient for ghci,</span><span>
</span><span id="line-709"></span><span>            </span><span class="hs-comment">-- but because of GHC bug #8942, it has never been safe to</span><span>
</span><span id="line-710"></span><span>            </span><span class="hs-comment">-- rely on them. By the time that bug was fixed, ghci had</span><span>
</span><span id="line-711"></span><span>            </span><span class="hs-comment">-- been changed to read shared libraries instead of archive</span><span>
</span><span id="line-712"></span><span>            </span><span class="hs-comment">-- files (see next code block).</span><span>
</span><span id="line-713"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; BuildWay
</span><a href="Distribution.Simple.GHC.Build.Utils.html#compilerBuildWay"><span class="hs-identifier hs-var">GHC.compilerBuildWay</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay -&gt; [BuildWay] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#DynWay"><span class="hs-identifier hs-var">DynWay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#ProfDynWay"><span class="hs-identifier hs-var">ProfDynWay</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span>          </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#CompilerId"><span class="hs-identifier hs-type">CompilerId</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHCJS"><span class="hs-identifier hs-var">GHCJS</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-715"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.GHCJS.html#isDynamic"><span class="hs-identifier hs-var">GHCJS.isDynamic</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>          </span><span class="annot"><span class="annottext">CompilerId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-717"></span><span>
</span><span id="line-718"></span><span>  </span><span id="local-6989586621679565148"><span class="annot"><a href="#local-6989586621679565148"><span class="hs-identifier hs-var">withGHCiLib_</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-719"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-type">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565140"><span class="hs-identifier hs-type">ghciLibByDefault</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configGHCiLib"><span class="hs-identifier hs-var">configGHCiLib</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565114"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-720"></span><span>      </span><span class="hs-comment">-- NOTE: If linkerSupportsRelocations is Nothing this may still fail if the</span><span>
</span><span id="line-721"></span><span>      </span><span class="hs-comment">-- linker does not support -r.</span><span>
</span><span id="line-722"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool -&gt; Bool
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679565132"><span class="hs-identifier hs-var">linkerSupportsRelocations</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-723"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565120"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; IO ()) -&gt; ProgArg -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-724"></span><span>          </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;--enable-library-for-ghci is not supported with the current&quot;</span></span><span>
</span><span id="line-725"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;  linker; ignoring...&quot;</span></span><span>
</span><span id="line-726"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-727"></span><span>      </span><span id="local-6989586621679565151"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565151"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565151"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565155"><span class="annot"><a href="#local-6989586621679565155"><span class="hs-identifier hs-var hs-var">sharedLibsByDefault</span></a></span></span><span>
</span><span id="line-730"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configDynExe"><span class="hs-identifier hs-var">configDynExe</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-731"></span><span>            </span><span class="hs-comment">-- build a shared library if dynamically-linked</span><span>
</span><span id="line-732"></span><span>            </span><span class="hs-comment">-- executables are requested</span><span>
</span><span id="line-733"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-734"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; CompilerId
</span><a href="Distribution.Simple.Compiler.html#compilerId"><span class="hs-identifier hs-var">compilerId</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-735"></span><span>            </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#CompilerId"><span class="hs-identifier hs-type">CompilerId</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-736"></span><span>              </span><span class="hs-comment">-- if ghc is dynamic, then ghci needs a shared</span><span>
</span><span id="line-737"></span><span>              </span><span class="hs-comment">-- library, so we build one by default.</span><span>
</span><span id="line-738"></span><span>              </span><span class="annot"><span class="annottext">Compiler -&gt; BuildWay
</span><a href="Distribution.Simple.GHC.Build.Utils.html#compilerBuildWay"><span class="hs-identifier hs-var">GHC.compilerBuildWay</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">BuildWay -&gt; BuildWay -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BuildWay
</span><a href="Distribution.Simple.BuildWay.html#DynWay"><span class="hs-identifier hs-var">DynWay</span></a></span><span>
</span><span id="line-739"></span><span>            </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#CompilerId"><span class="hs-identifier hs-type">CompilerId</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHCJS"><span class="hs-identifier hs-var">GHCJS</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-740"></span><span>              </span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.GHCJS.html#isDynamic"><span class="hs-identifier hs-var">GHCJS.isDynamic</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565115"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-741"></span><span>            </span><span class="annot"><span class="annottext">CompilerId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-742"></span><span>      </span><span id="local-6989586621679565157"><span class="annot"><a href="#local-6989586621679565157"><span class="hs-identifier hs-var hs-var">withSharedLib_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-743"></span><span>        </span><span class="hs-comment">-- build shared libraries if required by GHC or by the</span><span>
</span><span id="line-744"></span><span>        </span><span class="hs-comment">-- executable linking mode, but allow the user to force</span><span>
</span><span id="line-745"></span><span>        </span><span class="hs-comment">-- building only static library archives with</span><span>
</span><span id="line-746"></span><span>        </span><span class="hs-comment">-- --disable-shared.</span><span>
</span><span id="line-747"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565155"><span class="hs-identifier hs-var">sharedLibsByDefault</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Bool -&gt; Bool) -&gt; Flag Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configSharedLib"><span class="hs-identifier hs-var">configSharedLib</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-748"></span><span>
</span><span id="line-749"></span><span>      </span><span id="local-6989586621679565159"><span class="annot"><a href="#local-6989586621679565159"><span class="hs-identifier hs-var hs-var">withStaticLib_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-750"></span><span>        </span><span class="hs-comment">-- build a static library (all dependent libraries rolled</span><span>
</span><span id="line-751"></span><span>        </span><span class="hs-comment">-- into a huge .a archive) via GHCs -staticlib flag.</span><span>
</span><span id="line-752"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">(Flag Bool -&gt; Bool) -&gt; Flag Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configStaticLib"><span class="hs-identifier hs-var">configStaticLib</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-753"></span><span>
</span><span id="line-754"></span><span>      </span><span id="local-6989586621679565163"><span class="annot"><a href="#local-6989586621679565163"><span class="hs-identifier hs-var hs-var">withDynExe_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Bool -&gt; Bool) -&gt; Flag Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configDynExe"><span class="hs-identifier hs-var">configDynExe</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span>      </span><span id="local-6989586621679565166"><span class="annot"><a href="#local-6989586621679565166"><span class="hs-identifier hs-var hs-var">withFullyStaticExe_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Bool -&gt; Bool) -&gt; Flag Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configFullyStaticExe"><span class="hs-identifier hs-var">configFullyStaticExe</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span>  </span><span id="local-6989586621679565168"><span class="annot"><a href="#local-6989586621679565168"><span class="hs-identifier hs-var">setProfiling</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#configureProfiling"><span class="hs-identifier hs-type">configureProfiling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565120"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565114"><span class="hs-identifier hs-type">cfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565115"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span>  </span><span id="local-6989586621679565170"><span class="annot"><a href="#local-6989586621679565170"><span class="hs-identifier hs-var">setCoverage</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#configureCoverage"><span class="hs-identifier hs-type">configureCoverage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565120"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565114"><span class="hs-identifier hs-type">cfg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565115"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span>  </span><span class="hs-comment">-- Turn off library and executable stripping when `debug-info` is set</span><span>
</span><span id="line-763"></span><span>  </span><span class="hs-comment">-- to anything other than zero.</span><span>
</span><span id="line-764"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-765"></span><span>    </span><span id="local-6989586621679565180"><span class="annot"><a href="#local-6989586621679565180"><span class="hs-identifier hs-var hs-var">strip_libexe</span></a></span></span><span> </span><span id="local-6989586621679565181"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565181"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679565182"><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="#local-6989586621679565182"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-766"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565183"><span class="annot"><span class="annottext">defaultStrip :: Bool
</span><a href="#local-6989586621679565183"><span class="hs-identifier hs-var hs-var">defaultStrip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="#local-6989586621679565182"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Flag DebugInfoLevel -&gt; DebugInfoLevel
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag DebugInfoLevel
</span><a href="Distribution.Simple.Setup.Config.html#configDebugInfo"><span class="hs-identifier hs-var">configDebugInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-768"></span><span>            </span><span class="annot"><span class="annottext">DebugInfoLevel
</span><a href="Distribution.Simple.Compiler.html#NoDebugInfo"><span class="hs-identifier hs-var">NoDebugInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565183"><span class="hs-identifier hs-var">defaultStrip</span></a></span><span>
</span><span id="line-769"></span><span>            </span><span class="annot"><span class="annottext">DebugInfoLevel
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="#local-6989586621679565182"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-770"></span><span>              </span><span class="annot"><a href="Distribution.Simple.Flag.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-771"></span><span>                </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565120"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; IO ()) -&gt; ProgArg -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-772"></span><span>                  </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Setting debug-info implies &quot;</span></span><span>
</span><span id="line-773"></span><span>                    </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565181"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-774"></span><span>                    </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-stripping: False&quot;</span></span><span>
</span><span id="line-775"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-776"></span><span>              </span><span class="annot"><span class="annottext">Flag Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span>  </span><span id="local-6989586621679565187"><span class="annot"><a href="#local-6989586621679565187"><span class="hs-identifier hs-var">strip_lib</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679565180"><span class="hs-identifier hs-type">strip_libexe</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;library&quot;</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configStripLibs"><span class="hs-identifier hs-var">configStripLibs</span></a></span><span>
</span><span id="line-779"></span><span>  </span><span id="local-6989586621679565189"><span class="annot"><a href="#local-6989586621679565189"><span class="hs-identifier hs-var">strip_exe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679565180"><span class="hs-identifier hs-type">strip_libexe</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;executable&quot;</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configStripExes"><span class="hs-identifier hs-var">configStripExes</span></a></span><span>
</span><span id="line-780"></span><span>
</span><span id="line-781"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565197"><span class="annot"><a href="#local-6989586621679565197"><span class="hs-identifier hs-var hs-var">buildOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-782"></span><span>        </span><span class="annot"><span class="annottext">BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565170"><span class="hs-identifier hs-var">setCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">(BuildOptions -&gt; BuildOptions)
-&gt; (BuildOptions -&gt; BuildOptions) -&gt; BuildOptions -&gt; BuildOptions
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565168"><span class="hs-identifier hs-var">setProfiling</span></a></span><span> </span><span class="annot"><span class="annottext">(BuildOptions -&gt; BuildOptions) -&gt; BuildOptions -&gt; BuildOptions
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-783"></span><span>          </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#BuildOptions"><span class="hs-identifier hs-type">LBC.BuildOptions</span></a></span><span>
</span><span id="line-784"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">withVanillaLib :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withVanillaLib"><span class="hs-identifier hs-var">withVanillaLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Bool -&gt; Bool) -&gt; Flag Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configVanillaLib"><span class="hs-identifier hs-var">configVanillaLib</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-785"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withSharedLib :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withSharedLib"><span class="hs-identifier hs-var">withSharedLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565157"><span class="hs-identifier hs-var">withSharedLib_</span></a></span><span>
</span><span id="line-786"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withStaticLib :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withStaticLib"><span class="hs-identifier hs-var">withStaticLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565159"><span class="hs-identifier hs-var">withStaticLib_</span></a></span><span>
</span><span id="line-787"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withDynExe :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withDynExe"><span class="hs-identifier hs-var">withDynExe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565163"><span class="hs-identifier hs-var">withDynExe_</span></a></span><span>
</span><span id="line-788"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withFullyStaticExe :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withFullyStaticExe"><span class="hs-identifier hs-var">withFullyStaticExe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565166"><span class="hs-identifier hs-var">withFullyStaticExe_</span></a></span><span>
</span><span id="line-789"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withProfLib :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withProfLib"><span class="hs-identifier hs-var">withProfLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-790"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withProfLibShared :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withProfLibShared"><span class="hs-identifier hs-var">withProfLibShared</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-791"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withProfLibDetail :: ProfDetailLevel
</span><a href="Distribution.Types.LocalBuildConfig.html#withProfLibDetail"><span class="hs-identifier hs-var">withProfLibDetail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfDetailLevel
</span><a href="Distribution.Simple.Compiler.html#ProfDetailNone"><span class="hs-identifier hs-var">ProfDetailNone</span></a></span><span>
</span><span id="line-792"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withProfExe :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withProfExe"><span class="hs-identifier hs-var">withProfExe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-793"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withProfExeDetail :: ProfDetailLevel
</span><a href="Distribution.Types.LocalBuildConfig.html#withProfExeDetail"><span class="hs-identifier hs-var">withProfExeDetail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfDetailLevel
</span><a href="Distribution.Simple.Compiler.html#ProfDetailNone"><span class="hs-identifier hs-var">ProfDetailNone</span></a></span><span>
</span><span id="line-794"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withOptimization :: OptimisationLevel
</span><a href="Distribution.Types.LocalBuildConfig.html#withOptimization"><span class="hs-identifier hs-var">withOptimization</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag OptimisationLevel -&gt; OptimisationLevel
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag OptimisationLevel -&gt; OptimisationLevel)
-&gt; Flag OptimisationLevel -&gt; OptimisationLevel
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag OptimisationLevel
</span><a href="Distribution.Simple.Setup.Config.html#configOptimization"><span class="hs-identifier hs-var">configOptimization</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-795"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withDebugInfo :: DebugInfoLevel
</span><a href="Distribution.Types.LocalBuildConfig.html#withDebugInfo"><span class="hs-identifier hs-var">withDebugInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag DebugInfoLevel -&gt; DebugInfoLevel
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag DebugInfoLevel -&gt; DebugInfoLevel)
-&gt; Flag DebugInfoLevel -&gt; DebugInfoLevel
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag DebugInfoLevel
</span><a href="Distribution.Simple.Setup.Config.html#configDebugInfo"><span class="hs-identifier hs-var">configDebugInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-796"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withGHCiLib :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#withGHCiLib"><span class="hs-identifier hs-var">withGHCiLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565148"><span class="hs-identifier hs-var">withGHCiLib_</span></a></span><span>
</span><span id="line-797"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">splitSections :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#splitSections"><span class="hs-identifier hs-var">splitSections</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565122"><span class="hs-identifier hs-var">split_sections</span></a></span><span>
</span><span id="line-798"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">splitObjs :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#splitObjs"><span class="hs-identifier hs-var">splitObjs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565130"><span class="hs-identifier hs-var">split_objs</span></a></span><span>
</span><span id="line-799"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stripExes :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#stripExes"><span class="hs-identifier hs-var">stripExes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565189"><span class="hs-identifier hs-var">strip_exe</span></a></span><span>
</span><span id="line-800"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stripLibs :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#stripLibs"><span class="hs-identifier hs-var">stripLibs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565187"><span class="hs-identifier hs-var">strip_lib</span></a></span><span>
</span><span id="line-801"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">exeCoverage :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#exeCoverage"><span class="hs-identifier hs-var">exeCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-802"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">libCoverage :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#libCoverage"><span class="hs-identifier hs-var">libCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-803"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">relocatable :: Bool
</span><a href="Distribution.Types.LocalBuildConfig.html#relocatable"><span class="hs-identifier hs-var">relocatable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">(Flag Bool -&gt; Bool) -&gt; Flag Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configRelocatable"><span class="hs-identifier hs-var">configRelocatable</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565114"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-804"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span>  </span><span class="hs-comment">-- Dynamic executable, but no shared vanilla libraries</span><span>
</span><span id="line-807"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withDynExe"><span class="hs-identifier hs-var">LBC.withDynExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565197"><span class="hs-identifier hs-type">buildOptions</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfExe"><span class="hs-identifier hs-var">LBC.withProfExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565197"><span class="hs-identifier hs-type">buildOptions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withSharedLib"><span class="hs-identifier hs-var">LBC.withSharedLib</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565197"><span class="hs-identifier hs-type">buildOptions</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-808"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-type">warn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565120"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-809"></span><span>      </span><span class="annot"><span class="hs-string">&quot;Executables will use dynamic linking, but a shared library &quot;</span></span><span>
</span><span id="line-810"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;is not being built. Linking will fail if any executables &quot;</span></span><span>
</span><span id="line-811"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;depend on the library.&quot;</span></span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span>  </span><span class="hs-comment">-- Profiled dynamic executable, but no shared profiling libraries</span><span>
</span><span id="line-814"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withDynExe"><span class="hs-identifier hs-var">LBC.withDynExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565197"><span class="hs-identifier hs-type">buildOptions</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfExe"><span class="hs-identifier hs-var">LBC.withProfExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565197"><span class="hs-identifier hs-type">buildOptions</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLibShared"><span class="hs-identifier hs-var">LBC.withProfLibShared</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565197"><span class="hs-identifier hs-type">buildOptions</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-815"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-type">warn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565120"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-816"></span><span>      </span><span class="annot"><span class="hs-string">&quot;Executables will use profiled dynamic linking, but a profiled shared library &quot;</span></span><span>
</span><span id="line-817"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;is not being built. Linking will fail if any executables &quot;</span></span><span>
</span><span id="line-818"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;depend on the library.&quot;</span></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-821"></span><span>    </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span>
</span><span id="line-822"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#extraConfigArgs"><span class="hs-identifier hs-var">extraConfigArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Currently configure does not</span><span>
</span><span id="line-823"></span><span>      </span><span class="hs-comment">-- take extra args, but if it</span><span>
</span><span id="line-824"></span><span>      </span><span class="hs-comment">-- did they would go here.</span><span>
</span><span id="line-825"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withPrograms"><span class="hs-identifier hs-var">withPrograms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565116"><span class="hs-identifier hs-type">programDb</span></a></span><span>
</span><span id="line-826"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withBuildOptions"><span class="hs-identifier hs-var">withBuildOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565197"><span class="hs-identifier hs-type">buildOptions</span></a></span><span>
</span><span id="line-827"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span class="hs-keyword">data</span><span> </span><span id="PackageInfo"><span class="annot"><a href="Distribution.Simple.Configure.html#PackageInfo"><span class="hs-identifier hs-var">PackageInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PackageInfo"><span class="annot"><a href="Distribution.Simple.Configure.html#PackageInfo"><span class="hs-identifier hs-var">PackageInfo</span></a></span></span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="internalPackageSet"><span class="annot"><span class="annottext">PackageInfo -&gt; Set LibraryName
</span><a href="Distribution.Simple.Configure.html#internalPackageSet"><span class="hs-identifier hs-var hs-var">internalPackageSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LibraryName"><span class="hs-identifier hs-type">LibraryName</span></a></span><span>
</span><span id="line-831"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="promisedDepsSet"><span class="annot"><span class="annottext">PackageInfo -&gt; Map (PackageName, ComponentName) PromisedComponent
</span><a href="Distribution.Simple.Configure.html#promisedDepsSet"><span class="hs-identifier hs-var hs-var">promisedDepsSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Distribution.Types.GivenComponent.html#PromisedComponent"><span class="hs-identifier hs-type">PromisedComponent</span></a></span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="installedPackageSet"><span class="annot"><span class="annottext">PackageInfo -&gt; InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#installedPackageSet"><span class="hs-identifier hs-var hs-var">installedPackageSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#InstalledPackageIndex"><span class="hs-identifier hs-type">InstalledPackageIndex</span></a></span><span>
</span><span id="line-833"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="requiredDepsMap"><span class="annot"><span class="annottext">PackageInfo
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="Distribution.Simple.Configure.html#requiredDepsMap"><span class="hs-identifier hs-var hs-var">requiredDepsMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span>
</span><span id="line-834"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-835"></span><span>
</span><span id="line-836"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configurePackage"><span class="hs-identifier hs-type">configurePackage</span></a></span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-838"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span>
</span><span id="line-839"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span>
</span><span id="line-840"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#FlagAssignment"><span class="hs-identifier hs-type">FlagAssignment</span></a></span><span>
</span><span id="line-841"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span>
</span><span id="line-842"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-843"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-844"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-845"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#PackageDBStack"><span class="hs-identifier hs-type">PackageDBStack</span></a></span><span>
</span><span id="line-846"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#PackageBuildDescr"><span class="hs-identifier hs-type">LBC.PackageBuildDescr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-847"></span><span id="configurePackage"><span class="annot"><span class="annottext">configurePackage :: ConfigFlags
-&gt; LocalBuildConfig
-&gt; PackageDescription
-&gt; FlagAssignment
-&gt; ComponentRequestedSpec
-&gt; Compiler
-&gt; Platform
-&gt; ProgramDb
-&gt; PackageDBStack
-&gt; IO (LocalBuildConfig, PackageBuildDescr)
</span><a href="Distribution.Simple.Configure.html#configurePackage"><span class="hs-identifier hs-var hs-var">configurePackage</span></a></span></span><span> </span><span id="local-6989586621679565231"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565231"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679565232"><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565232"><span class="hs-identifier hs-var">lbc0</span></a></span></span><span> </span><span id="local-6989586621679565233"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565233"><span class="hs-identifier hs-var">pkg_descr00</span></a></span></span><span> </span><span id="local-6989586621679565234"><span class="annot"><span class="annottext">FlagAssignment
</span><a href="#local-6989586621679565234"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span id="local-6989586621679565235"><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565235"><span class="hs-identifier hs-var">enabled</span></a></span></span><span> </span><span id="local-6989586621679565236"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565236"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679565237"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565237"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621679565238"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565238"><span class="hs-identifier hs-var">programDb0</span></a></span></span><span> </span><span id="local-6989586621679565239"><span class="annot"><span class="annottext">PackageDBStack
</span><a href="#local-6989586621679565239"><span class="hs-identifier hs-var">packageDbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-848"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565240"><span class="annot"><span class="annottext">common :: CommonSetupFlags
</span><a href="#local-6989586621679565240"><span class="hs-identifier hs-var hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565231"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-849"></span><span>      </span><span id="local-6989586621679565243"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679565243"><span class="hs-identifier hs-var hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Verbosity -&gt; Verbosity) -&gt; Flag Verbosity -&gt; Verbosity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Common.html#setupVerbosity"><span class="hs-identifier hs-var">setupVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679565240"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span>      </span><span class="hs-comment">-- add extra include/lib dirs as specified in cfg</span><span>
</span><span id="line-852"></span><span>      </span><span id="local-6989586621679565244"><span class="annot"><span class="annottext">pkg_descr0 :: PackageDescription
</span><a href="#local-6989586621679565244"><span class="hs-identifier hs-var hs-var hs-var">pkg_descr0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageDescription -&gt; ConfigFlags -&gt; PackageDescription
</span><a href="Distribution.Simple.Configure.html#addExtraIncludeLibDirsFromConfigFlags"><span class="hs-identifier hs-var">addExtraIncludeLibDirsFromConfigFlags</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565233"><span class="hs-identifier hs-var">pkg_descr00</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565231"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-853"></span><span>  </span><span class="hs-comment">-- TODO: it is not clear whether this adding these dirs is necessary</span><span>
</span><span id="line-854"></span><span>  </span><span class="hs-comment">-- when we are directly stating from a PackageDescription (e.g. when</span><span>
</span><span id="line-855"></span><span>  </span><span class="hs-comment">-- cabal-install has determined a PackageDescription, instead of rediscovering</span><span>
</span><span id="line-856"></span><span>  </span><span class="hs-comment">-- when working with a GenericPackageDescription).</span><span>
</span><span id="line-857"></span><span>  </span><span class="hs-comment">-- Could this function call be moved to the end of finalizeAndConfigurePackage</span><span>
</span><span id="line-858"></span><span>  </span><span class="hs-comment">-- right before calling configurePackage?</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-comment">-- Configure certain external build tools, see below for which ones.</span><span>
</span><span id="line-861"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565248"><span class="annot"><span class="annottext">requiredBuildTools :: [LegacyExeDependency]
</span><a href="#local-6989586621679565248"><span class="hs-identifier hs-var hs-var hs-var">requiredBuildTools</span></a></span></span><span>
</span><span id="line-862"></span><span>        </span><span class="hs-comment">-- If --ignore-build-tools is set, no build tool is required:</span><span>
</span><span id="line-863"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">(Flag Bool -&gt; Bool) -&gt; Flag Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configIgnoreBuildTools"><span class="hs-identifier hs-var">configIgnoreBuildTools</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565231"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-864"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-865"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-866"></span><span>            </span><span id="local-6989586621679565250"><span class="annot"><a href="#local-6989586621679565250"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PackageDescription -&gt; ComponentRequestedSpec -&gt; [BuildInfo]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#enabledBuildInfos"><span class="hs-identifier hs-var">enabledBuildInfos</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565244"><span class="hs-identifier hs-var">pkg_descr0</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565235"><span class="hs-identifier hs-var">enabled</span></a></span><span>
</span><span id="line-867"></span><span>            </span><span class="hs-comment">-- First, we collect any tool dep that we know is external. This is,</span><span>
</span><span id="line-868"></span><span>            </span><span class="hs-comment">-- in practice:</span><span>
</span><span id="line-869"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-870"></span><span>            </span><span class="hs-comment">-- 1. `build-tools` entries on the whitelist</span><span>
</span><span id="line-871"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-872"></span><span>            </span><span class="hs-comment">-- 2. `build-tool-depends` that aren't from the current package.</span><span>
</span><span id="line-873"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565252"><span class="annot"><a href="#local-6989586621679565252"><span class="hs-identifier hs-var hs-var">externBuildToolDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-874"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; VersionRange -&gt; LegacyExeDependency
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LegacyExeDependency.html#LegacyExeDependency"><span class="hs-identifier hs-var">LegacyExeDependency</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnqualComponentName -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnqualComponentName.html#unUnqualComponentName"><span class="hs-identifier hs-var">unUnqualComponentName</span></a></span><span> </span><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679565255"><span class="hs-identifier hs-var">eName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565256"><span class="hs-identifier hs-var">versionRange</span></a></span><span>
</span><span id="line-875"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679565257"><span class="annot"><span class="annottext">buildTool :: ExeDependency
</span><a href="#local-6989586621679565257"><span class="hs-identifier hs-var">buildTool</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ExeDependency.html#ExeDependency"><span class="hs-identifier hs-type">ExeDependency</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679565255"><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679565255"><span class="hs-identifier hs-var">eName</span></a></span></span><span> </span><span id="local-6989586621679565256"><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565256"><span class="hs-identifier hs-var">versionRange</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-876"></span><span>                      </span><span class="annot"><span class="annottext">PackageDescription -&gt; BuildInfo -&gt; [ExeDependency]
</span><a href="Distribution.Simple.BuildToolDepends.html#getAllToolDependencies"><span class="hs-identifier hs-var">getAllToolDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565244"><span class="hs-identifier hs-var">pkg_descr0</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679565250"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-877"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PackageDescription -&gt; ExeDependency -&gt; Bool
</span><a href="Distribution.Simple.BuildToolDepends.html#isInternal"><span class="hs-identifier hs-var">isInternal</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565244"><span class="hs-identifier hs-var">pkg_descr0</span></a></span><span> </span><span class="annot"><span class="annottext">ExeDependency
</span><a href="#local-6989586621679565257"><span class="hs-identifier hs-var">buildTool</span></a></span><span>
</span><span id="line-878"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-879"></span><span>            </span><span class="hs-comment">-- Second, we collect any build-tools entry we don't know how to</span><span>
</span><span id="line-880"></span><span>            </span><span class="hs-comment">-- desugar. We'll never have any idea how to build them, so we just</span><span>
</span><span id="line-881"></span><span>            </span><span class="hs-comment">-- hope they are already on the PATH.</span><span>
</span><span id="line-882"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565265"><span class="annot"><a href="#local-6989586621679565265"><span class="hs-identifier hs-var hs-var">unknownBuildTools</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-883"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LegacyExeDependency
</span><a href="#local-6989586621679565266"><span class="hs-identifier hs-var">buildTool</span></a></span><span>
</span><span id="line-884"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679565266"><span class="annot"><span class="annottext">LegacyExeDependency
</span><a href="#local-6989586621679565266"><span class="hs-identifier hs-var">buildTool</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [LegacyExeDependency]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#buildTools"><span class="hs-identifier hs-var">buildTools</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679565250"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-885"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe ExeDependency
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe ExeDependency -&gt; Maybe ExeDependency -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PackageDescription -&gt; LegacyExeDependency -&gt; Maybe ExeDependency
</span><a href="Distribution.Simple.BuildToolDepends.html#desugarBuildTool"><span class="hs-identifier hs-var">desugarBuildTool</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565244"><span class="hs-identifier hs-var">pkg_descr0</span></a></span><span> </span><span class="annot"><span class="annottext">LegacyExeDependency
</span><a href="#local-6989586621679565266"><span class="hs-identifier hs-var">buildTool</span></a></span><span>
</span><span id="line-886"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-887"></span><span>            </span><span class="annot"><a href="#local-6989586621679565252"><span class="hs-identifier hs-type">externBuildToolDeps</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621679565265"><span class="hs-identifier hs-type">unknownBuildTools</span></a></span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span>  </span><span id="local-6989586621679565269"><span class="annot"><a href="#local-6989586621679565269"><span class="hs-identifier hs-var">programDb1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-890"></span><span>    </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgramDb -&gt; IO ProgramDb
</span><a href="Distribution.Simple.Program.Db.html#configureAllKnownPrograms"><span class="hs-identifier hs-var">configureAllKnownPrograms</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Verbosity -&gt; Verbosity
</span><a href="Distribution.Verbosity.html#lessVerbose"><span class="hs-identifier hs-var">lessVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565243"><span class="hs-identifier hs-var">verbosity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565238"><span class="hs-identifier hs-var">programDb0</span></a></span><span>
</span><span id="line-891"></span><span>      </span><span class="annot"><span class="annottext">IO ProgramDb -&gt; (ProgramDb -&gt; IO ProgramDb) -&gt; IO ProgramDb
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; [LegacyExeDependency] -&gt; ProgramDb -&gt; IO ProgramDb
</span><a href="Distribution.Simple.Configure.html#configureRequiredPrograms"><span class="hs-identifier hs-var">configureRequiredPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565243"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">[LegacyExeDependency]
</span><a href="#local-6989586621679565248"><span class="hs-identifier hs-var">requiredBuildTools</span></a></span><span>
</span><span id="line-892"></span><span>
</span><span id="line-893"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679565272"><span class="annot"><a href="#local-6989586621679565272"><span class="hs-identifier hs-var">pkg_descr2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565273"><span class="annot"><a href="#local-6989586621679565273"><span class="hs-identifier hs-var">programDb2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-894"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Configure.html#configurePkgconfigPackages"><span class="hs-identifier hs-type">configurePkgconfigPackages</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565243"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565244"><span class="hs-identifier hs-type">pkg_descr0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565269"><span class="hs-identifier hs-type">programDb1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565235"><span class="hs-identifier hs-type">enabled</span></a></span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565275"><span class="annot"><a href="#local-6989586621679565275"><span class="hs-identifier hs-var hs-var">use_external_internal_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-897"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565235"><span class="hs-identifier hs-var">enabled</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-898"></span><span>          </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#OneComponentRequestedSpec"><span class="hs-identifier hs-type">OneComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-899"></span><span>          </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-900"></span><span>
</span><span id="line-901"></span><span>  </span><span class="hs-comment">-- Compute installation directory templates, based on user</span><span>
</span><span id="line-902"></span><span>  </span><span class="hs-comment">-- configuration.</span><span>
</span><span id="line-903"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-904"></span><span>  </span><span class="hs-comment">-- TODO: Move this into a helper function.</span><span>
</span><span id="line-905"></span><span>  </span><span id="local-6989586621679565276"><span class="annot"><a href="#local-6989586621679565276"><span class="hs-identifier hs-var">defaultDirs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">InstallDirTemplates</span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-906"></span><span>    </span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#defaultInstallDirs%27"><span class="hs-identifier hs-type">defaultInstallDirs'</span></a></span><span>
</span><span id="line-907"></span><span>      </span><span class="annot"><a href="#local-6989586621679565275"><span class="hs-identifier hs-type">use_external_internal_deps</span></a></span><span>
</span><span id="line-908"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Compiler.html#compilerFlavor"><span class="hs-identifier hs-type">compilerFlavor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565236"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-type">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configUserInstall"><span class="hs-identifier hs-var">configUserInstall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565231"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-910"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#hasLibs"><span class="hs-identifier hs-type">hasLibs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565272"><span class="hs-identifier hs-type">pkg_descr2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-911"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-912"></span><span>    </span><span id="local-6989586621679565280"><span class="annot"><a href="#local-6989586621679565280"><span class="hs-identifier hs-var hs-var">installDirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-913"></span><span>      </span><span class="annot"><span class="annottext">(PathTemplate -&gt; Flag PathTemplate -&gt; PathTemplate)
-&gt; InstallDirTemplates
-&gt; InstallDirs (Flag PathTemplate)
-&gt; InstallDirTemplates
forall a b c.
(a -&gt; b -&gt; c) -&gt; InstallDirs a -&gt; InstallDirs b -&gt; InstallDirs c
</span><a href="Distribution.Simple.InstallDirs.html#combineInstallDirs"><span class="hs-identifier hs-var">combineInstallDirs</span></a></span><span>
</span><span id="line-914"></span><span>        </span><span class="annot"><span class="annottext">PathTemplate -&gt; Flag PathTemplate -&gt; PathTemplate
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span>
</span><span id="line-915"></span><span>        </span><span class="annot"><span class="annottext">InstallDirTemplates
</span><a href="#local-6989586621679565276"><span class="hs-identifier hs-var">defaultDirs</span></a></span><span>
</span><span id="line-916"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; InstallDirs (Flag PathTemplate)
</span><a href="Distribution.Simple.Setup.Config.html#configInstallDirs"><span class="hs-identifier hs-var">configInstallDirs</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565231"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>    </span><span id="local-6989586621679565283"><span class="annot"><a href="#local-6989586621679565283"><span class="hs-identifier hs-var hs-var">lbc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565232"><span class="hs-identifier hs-var">lbc0</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withPrograms"><span class="hs-identifier hs-var">LBC.withPrograms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565273"><span class="hs-identifier hs-type">programDb2</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-918"></span><span>    </span><span id="local-6989586621679565284"><span class="annot"><a href="#local-6989586621679565284"><span class="hs-identifier hs-var hs-var">pbd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-919"></span><span>      </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#PackageBuildDescr"><span class="hs-identifier hs-type">LBC.PackageBuildDescr</span></a></span><span>
</span><span id="line-920"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">configFlags :: ConfigFlags
</span><a href="Distribution.Types.LocalBuildConfig.html#configFlags"><span class="hs-identifier hs-var">configFlags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565231"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-921"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagAssignment :: FlagAssignment
</span><a href="Distribution.Types.LocalBuildConfig.html#flagAssignment"><span class="hs-identifier hs-var">flagAssignment</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FlagAssignment
</span><a href="#local-6989586621679565234"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-922"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">componentEnabledSpec :: ComponentRequestedSpec
</span><a href="Distribution.Types.LocalBuildConfig.html#componentEnabledSpec"><span class="hs-identifier hs-var">componentEnabledSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565235"><span class="hs-identifier hs-var">enabled</span></a></span><span>
</span><span id="line-923"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compiler :: Compiler
</span><a href="Distribution.Types.LocalBuildConfig.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565236"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-924"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hostPlatform :: Platform
</span><a href="Distribution.Types.LocalBuildConfig.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565237"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-925"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">localPkgDescr :: PackageDescription
</span><a href="Distribution.Types.LocalBuildConfig.html#localPkgDescr"><span class="hs-identifier hs-var">localPkgDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565272"><span class="hs-identifier hs-var">pkg_descr2</span></a></span><span>
</span><span id="line-926"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">installDirTemplates :: InstallDirTemplates
</span><a href="Distribution.Types.LocalBuildConfig.html#installDirTemplates"><span class="hs-identifier hs-var">installDirTemplates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstallDirTemplates
</span><a href="#local-6989586621679565280"><span class="hs-identifier hs-var">installDirs</span></a></span><span>
</span><span id="line-927"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withPackageDB :: PackageDBStack
</span><a href="Distribution.Types.LocalBuildConfig.html#withPackageDB"><span class="hs-identifier hs-var">withPackageDB</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageDBStack
</span><a href="#local-6989586621679565239"><span class="hs-identifier hs-var">packageDbs</span></a></span><span>
</span><span id="line-928"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pkgDescrFile :: Maybe (SymbolicPath Pkg 'File)
</span><a href="Distribution.Types.LocalBuildConfig.html#pkgDescrFile"><span class="hs-identifier hs-var">pkgDescrFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath Pkg 'File)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-929"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">extraCoverageFor :: [UnitId]
</span><a href="Distribution.Types.LocalBuildConfig.html#extraCoverageFor"><span class="hs-identifier hs-var">extraCoverageFor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-930"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-931"></span><span>
</span><span id="line-932"></span><span>  </span><span class="annot"><a href="Distribution.Simple.Utils.html#debug"><span class="hs-identifier hs-type">debug</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565243"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-933"></span><span>    </span><span class="annot"><span class="hs-string">&quot;Finalized package description:\n&quot;</span></span><span>
</span><span id="line-934"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.PrettyPrint.html#showPackageDescription"><span class="hs-identifier hs-type">showPackageDescription</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565272"><span class="hs-identifier hs-type">pkg_descr2</span></a></span><span>
</span><span id="line-935"></span><span>
</span><span id="line-936"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679565283"><span class="hs-identifier hs-type">lbc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679565284"><span class="hs-identifier hs-type">pbd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>
</span><span id="line-938"></span><span class="annot"><a href="Distribution.Simple.Configure.html#finalizeAndConfigurePackage"><span class="hs-identifier hs-type">finalizeAndConfigurePackage</span></a></span><span>
</span><span id="line-939"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-940"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span>
</span><span id="line-941"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span>
</span><span id="line-942"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-943"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-944"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span>
</span><span id="line-945"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#PackageBuildDescr"><span class="hs-identifier hs-type">LBC.PackageBuildDescr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#PackageInfo"><span class="hs-identifier hs-type">PackageInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-946"></span><span id="finalizeAndConfigurePackage"><span class="annot"><span class="annottext">finalizeAndConfigurePackage :: ConfigFlags
-&gt; LocalBuildConfig
-&gt; GenericPackageDescription
-&gt; Compiler
-&gt; Platform
-&gt; ComponentRequestedSpec
-&gt; IO (LocalBuildConfig, PackageBuildDescr, PackageInfo)
</span><a href="Distribution.Simple.Configure.html#finalizeAndConfigurePackage"><span class="hs-identifier hs-var hs-var">finalizeAndConfigurePackage</span></a></span></span><span> </span><span id="local-6989586621679565297"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565297"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679565298"><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565298"><span class="hs-identifier hs-var">lbc0</span></a></span></span><span> </span><span id="local-6989586621679565299"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565299"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span></span><span> </span><span id="local-6989586621679565300"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565300"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679565301"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565301"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621679565302"><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565302"><span class="hs-identifier hs-var">enabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-947"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565303"><span class="annot"><span class="annottext">common :: CommonSetupFlags
</span><a href="#local-6989586621679565303"><span class="hs-identifier hs-var hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565297"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-948"></span><span>      </span><span id="local-6989586621679565306"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679565306"><span class="hs-identifier hs-var hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Verbosity -&gt; Verbosity) -&gt; Flag Verbosity -&gt; Verbosity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Common.html#setupVerbosity"><span class="hs-identifier hs-var">setupVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679565303"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-949"></span><span>      </span><span id="local-6989586621679565307"><span class="annot"><span class="annottext">mbWorkDir :: Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679565307"><span class="hs-identifier hs-var hs-var hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag (SymbolicPath CWD ('Dir Pkg))
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
forall a. Flag a -&gt; Maybe a
</span><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-var">flagToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag (SymbolicPath CWD ('Dir Pkg))
 -&gt; Maybe (SymbolicPath CWD ('Dir Pkg)))
-&gt; Flag (SymbolicPath CWD ('Dir Pkg))
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.Setup.Common.html#setupWorkingDir"><span class="hs-identifier hs-var">setupWorkingDir</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679565303"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-950"></span><span>
</span><span id="line-951"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565309"><span class="annot"><span class="annottext">programDb0 :: ProgramDb
</span><a href="#local-6989586621679565309"><span class="hs-identifier hs-var hs-var hs-var">programDb0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig -&gt; ProgramDb
</span><a href="Distribution.Types.LocalBuildConfig.html#withPrograms"><span class="hs-identifier hs-var">LBC.withPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565298"><span class="hs-identifier hs-var">lbc0</span></a></span><span>
</span><span id="line-952"></span><span>      </span><span class="hs-comment">-- What package database(s) to use</span><span>
</span><span id="line-953"></span><span>      </span><span class="annot"><a href="#local-6989586621679565310"><span class="hs-identifier hs-type">packageDbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#PackageDBStack"><span class="hs-identifier hs-type">PackageDBStack</span></a></span><span>
</span><span id="line-954"></span><span>      </span><span id="local-6989586621679565310"><span class="annot"><span class="annottext">packageDbs :: PackageDBStack
</span><a href="#local-6989586621679565310"><span class="hs-identifier hs-var hs-var hs-var">packageDbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-955"></span><span>        </span><span class="annot"><span class="annottext">Bool
-&gt; [Maybe (PackageDBX (SymbolicPath Pkg ('Dir PkgDB)))]
-&gt; PackageDBStack
forall fp. Bool -&gt; [Maybe (PackageDBX fp)] -&gt; PackageDBStackX fp
</span><a href="Distribution.Simple.Configure.html#interpretPackageDbFlags"><span class="hs-identifier hs-var">interpretPackageDbFlags</span></a></span><span>
</span><span id="line-956"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configUserInstall"><span class="hs-identifier hs-var">configUserInstall</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565297"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; [Maybe (PackageDBX (SymbolicPath Pkg ('Dir PkgDB)))]
</span><a href="Distribution.Simple.Setup.Config.html#configPackageDBs"><span class="hs-identifier hs-var">configPackageDBs</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565297"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span>  </span><span class="hs-comment">-- The InstalledPackageIndex of all installed packages</span><span>
</span><span id="line-960"></span><span>  </span><span id="local-6989586621679565312"><span class="annot"><a href="#local-6989586621679565312"><span class="hs-identifier hs-var">installedPackageSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">InstalledPackageIndex</span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-961"></span><span>    </span><span class="annot"><span class="annottext">Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; PackageDBStack
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#getInstalledPackages"><span class="hs-identifier hs-var">getInstalledPackages</span></a></span><span>
</span><span id="line-962"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Verbosity -&gt; Verbosity
</span><a href="Distribution.Verbosity.html#lessVerbose"><span class="hs-identifier hs-var">lessVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565306"><span class="hs-identifier hs-var">verbosity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-963"></span><span>      </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565300"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-964"></span><span>      </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679565307"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span>
</span><span id="line-965"></span><span>      </span><span class="annot"><span class="annottext">PackageDBStack
</span><a href="#local-6989586621679565310"><span class="hs-identifier hs-var">packageDbs</span></a></span><span>
</span><span id="line-966"></span><span>      </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565309"><span class="hs-identifier hs-var">programDb0</span></a></span><span>
</span><span id="line-967"></span><span>
</span><span id="line-968"></span><span>  </span><span class="hs-comment">-- The set of package names which are &quot;shadowed&quot; by internal</span><span>
</span><span id="line-969"></span><span>  </span><span class="hs-comment">-- packages, and which component they map to</span><span>
</span><span id="line-970"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679565313"><span class="hs-identifier hs-type">internalPackageSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LibraryName"><span class="hs-identifier hs-type">LibraryName</span></a></span><span>
</span><span id="line-971"></span><span>      </span><span id="local-6989586621679565313"><span class="annot"><a href="#local-6989586621679565313"><span class="hs-identifier hs-var hs-var">internalPackageSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; Set LibraryName
</span><a href="Distribution.Simple.Configure.html#getInternalLibraries"><span class="hs-identifier hs-var">getInternalLibraries</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565299"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span><span>
</span><span id="line-972"></span><span>
</span><span id="line-973"></span><span>  </span><span class="hs-comment">-- Some sanity checks related to dynamic/static linking.</span><span>
</span><span id="line-974"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-type">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configDynExe"><span class="hs-identifier hs-var">configDynExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565297"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-type">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configFullyStaticExe"><span class="hs-identifier hs-var">configFullyStaticExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565297"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-975"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-type">dieWithException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565306"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#SanityCheckForDynamicStaticLinking"><span class="hs-identifier hs-type">SanityCheckForDynamicStaticLinking</span></a></span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span>  </span><span class="hs-comment">-- allConstraints:  The set of all 'Dependency's we have.  Used ONLY</span><span>
</span><span id="line-978"></span><span>  </span><span class="hs-comment">--                  to 'configureFinalizedPackage'.</span><span>
</span><span id="line-979"></span><span>  </span><span class="hs-comment">-- requiredDepsMap: A map from 'PackageName' to the specifically</span><span>
</span><span id="line-980"></span><span>  </span><span class="hs-comment">--                  required 'InstalledPackageInfo', due to --dependency</span><span>
</span><span id="line-981"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-982"></span><span>  </span><span class="hs-comment">-- NB: These constraints are to be applied to ALL components of</span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-comment">-- a package.  Thus, it's not an error if allConstraints contains</span><span>
</span><span id="line-984"></span><span>  </span><span class="hs-comment">-- more constraints than is necessary for a component (another</span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-comment">-- component might need it.)</span><span>
</span><span id="line-986"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-987"></span><span>  </span><span class="hs-comment">-- NB: The fact that we bundle all the constraints together means</span><span>
</span><span id="line-988"></span><span>  </span><span class="hs-comment">-- that is not possible to configure a test-suite to use one</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-comment">-- version of a dependency, and the executable to use another.</span><span>
</span><span id="line-990"></span><span>  </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679565315"><span class="annot"><a href="#local-6989586621679565315"><span class="hs-identifier hs-var">allConstraints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier">PackageVersionConstraint</span></span><span class="hs-special">]</span><span>
</span><span id="line-991"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565316"><span class="annot"><a href="#local-6989586621679565316"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">PackageName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ComponentName</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">InstalledPackageInfo</span></span><span>
</span><span id="line-992"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-993"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-type">dieWithException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565306"><span class="hs-identifier hs-type">verbosity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-994"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Configure.html#combinedConstraints"><span class="hs-identifier hs-type">combinedConstraints</span></a></span><span>
</span><span id="line-995"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configConstraints"><span class="hs-identifier hs-var">configConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565297"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-996"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configDependencies"><span class="hs-identifier hs-var">configDependencies</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565297"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-997"></span><span>        </span><span class="annot"><a href="#local-6989586621679565312"><span class="hs-identifier hs-type">installedPackageSet</span></a></span><span>
</span><span id="line-998"></span><span>
</span><span id="line-999"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-1000"></span><span>    </span><span id="local-6989586621679565320"><span class="annot"><a href="#local-6989586621679565320"><span class="hs-identifier hs-var hs-var">promisedDepsSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PromisedComponent]
-&gt; Map (PackageName, ComponentName) PromisedComponent
</span><a href="Distribution.Simple.Configure.html#mkPromisedDepsSet"><span class="hs-identifier hs-var">mkPromisedDepsSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; [PromisedComponent]
</span><a href="Distribution.Simple.Setup.Config.html#configPromisedDependencies"><span class="hs-identifier hs-var">configPromisedDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565297"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1001"></span><span>    </span><span id="local-6989586621679565323"><span class="annot"><a href="#local-6989586621679565323"><span class="hs-identifier hs-var hs-var">pkg_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1002"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Configure.html#PackageInfo"><span class="hs-identifier hs-type">PackageInfo</span></a></span><span>
</span><span id="line-1003"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Set LibraryName
internalPackageSet :: Set LibraryName
internalPackageSet :: Set LibraryName
</span><a href="Distribution.Simple.Configure.html#internalPackageSet"><span class="hs-identifier hs-var hs-var">internalPackageSet</span></a></span><span>
</span><span id="line-1004"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
promisedDepsSet :: Map (PackageName, ComponentName) PromisedComponent
promisedDepsSet :: Map (PackageName, ComponentName) PromisedComponent
</span><a href="Distribution.Simple.Configure.html#promisedDepsSet"><span class="hs-identifier hs-var hs-var">promisedDepsSet</span></a></span><span>
</span><span id="line-1005"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
installedPackageSet :: InstalledPackageIndex
installedPackageSet :: InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#installedPackageSet"><span class="hs-identifier hs-var hs-var">installedPackageSet</span></a></span><span>
</span><span id="line-1006"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
requiredDepsMap :: Map (PackageName, ComponentName) InstalledPackageInfo
requiredDepsMap :: Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="Distribution.Simple.Configure.html#requiredDepsMap"><span class="hs-identifier hs-var hs-var">requiredDepsMap</span></a></span><span>
</span><span id="line-1007"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span>  </span><span class="hs-comment">-- pkg_descr:   The resolved package description, that does not contain any</span><span>
</span><span id="line-1010"></span><span>  </span><span class="hs-comment">--              conditionals, because we have an assignment for</span><span>
</span><span id="line-1011"></span><span>  </span><span class="hs-comment">--              every flag, either picking them ourselves using a</span><span>
</span><span id="line-1012"></span><span>  </span><span class="hs-comment">--              simple naive algorithm, or having them be passed to</span><span>
</span><span id="line-1013"></span><span>  </span><span class="hs-comment">--              us by 'configConfigurationsFlags')</span><span>
</span><span id="line-1014"></span><span>  </span><span class="hs-comment">-- flags:       The 'FlagAssignment' that the conditionals were</span><span>
</span><span id="line-1015"></span><span>  </span><span class="hs-comment">--              resolved with.</span><span>
</span><span id="line-1016"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1017"></span><span>  </span><span class="hs-comment">-- NB: Why doesn't finalizing a package also tell us what the</span><span>
</span><span id="line-1018"></span><span>  </span><span class="hs-comment">-- dependencies are (e.g. when we run the naive algorithm,</span><span>
</span><span id="line-1019"></span><span>  </span><span class="hs-comment">-- we are checking if dependencies are satisfiable)?  The</span><span>
</span><span id="line-1020"></span><span>  </span><span class="hs-comment">-- primary reason is that we may NOT have done any solving:</span><span>
</span><span id="line-1021"></span><span>  </span><span class="hs-comment">-- if the flags are all chosen for us, this step is a simple</span><span>
</span><span id="line-1022"></span><span>  </span><span class="hs-comment">-- matter of flattening according to that assignment.  It's</span><span>
</span><span id="line-1023"></span><span>  </span><span class="hs-comment">-- cleaner to then configure the dependencies afterwards.</span><span>
</span><span id="line-1024"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565324"><span class="annot"><a href="#local-6989586621679565324"><span class="hs-identifier hs-var hs-var">use_external_internal_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565302"><span class="hs-identifier hs-var">enabled</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1025"></span><span>        </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#OneComponentRequestedSpec"><span class="hs-identifier hs-type">OneComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1026"></span><span>        </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1027"></span><span>  </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679565325"><span class="annot"><a href="#local-6989586621679565325"><span class="hs-identifier hs-var">pkg_descr0</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">PackageDescription</span></span><span>
</span><span id="line-1028"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565326"><span class="annot"><a href="#local-6989586621679565326"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">FlagAssignment</span></span><span>
</span><span id="line-1029"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1030"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Configure.html#configureFinalizedPackage"><span class="hs-identifier hs-type">configureFinalizedPackage</span></a></span><span>
</span><span id="line-1031"></span><span>      </span><span class="annot"><a href="#local-6989586621679565306"><span class="hs-identifier hs-type">verbosity</span></a></span><span>
</span><span id="line-1032"></span><span>      </span><span class="annot"><a href="#local-6989586621679565297"><span class="hs-identifier hs-type">cfg</span></a></span><span>
</span><span id="line-1033"></span><span>      </span><span class="annot"><a href="#local-6989586621679565302"><span class="hs-identifier hs-type">enabled</span></a></span><span>
</span><span id="line-1034"></span><span>      </span><span class="annot"><a href="#local-6989586621679565315"><span class="hs-identifier hs-type">allConstraints</span></a></span><span>
</span><span id="line-1035"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#dependencySatisfiable"><span class="hs-identifier hs-type">dependencySatisfiable</span></a></span><span>
</span><span id="line-1036"></span><span>          </span><span class="annot"><a href="#local-6989586621679565324"><span class="hs-identifier hs-type">use_external_internal_deps</span></a></span><span>
</span><span id="line-1037"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-type">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configExactConfiguration"><span class="hs-identifier hs-var">configExactConfiguration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565297"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1038"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-type">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configAllowDependingOnPrivateLibs"><span class="hs-identifier hs-var">configAllowDependingOnPrivateLibs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565297"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageName"><span class="hs-identifier hs-type">packageName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565299"><span class="hs-identifier hs-type">g_pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>          </span><span class="annot"><a href="#local-6989586621679565312"><span class="hs-identifier hs-type">installedPackageSet</span></a></span><span>
</span><span id="line-1041"></span><span>          </span><span class="annot"><a href="#local-6989586621679565313"><span class="hs-identifier hs-type">internalPackageSet</span></a></span><span>
</span><span id="line-1042"></span><span>          </span><span class="annot"><a href="#local-6989586621679565320"><span class="hs-identifier hs-type">promisedDepsSet</span></a></span><span>
</span><span id="line-1043"></span><span>          </span><span class="annot"><a href="#local-6989586621679565316"><span class="hs-identifier hs-type">requiredDepsMap</span></a></span><span>
</span><span id="line-1044"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1045"></span><span>      </span><span class="annot"><a href="#local-6989586621679565300"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-1046"></span><span>      </span><span class="annot"><a href="#local-6989586621679565301"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-1047"></span><span>      </span><span class="annot"><a href="#local-6989586621679565299"><span class="hs-identifier hs-type">g_pkg_descr</span></a></span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679565332"><span class="annot"><a href="#local-6989586621679565332"><span class="hs-identifier hs-var">lbc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565333"><span class="annot"><a href="#local-6989586621679565333"><span class="hs-identifier hs-var">pbd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1050"></span><span>    </span><span class="annot"><a href="Distribution.Simple.Configure.html#configurePackage"><span class="hs-identifier hs-type">configurePackage</span></a></span><span>
</span><span id="line-1051"></span><span>      </span><span class="annot"><a href="#local-6989586621679565297"><span class="hs-identifier hs-type">cfg</span></a></span><span>
</span><span id="line-1052"></span><span>      </span><span class="annot"><a href="#local-6989586621679565298"><span class="hs-identifier hs-type">lbc0</span></a></span><span>
</span><span id="line-1053"></span><span>      </span><span class="annot"><a href="#local-6989586621679565325"><span class="hs-identifier hs-type">pkg_descr0</span></a></span><span>
</span><span id="line-1054"></span><span>      </span><span class="annot"><a href="#local-6989586621679565326"><span class="hs-identifier hs-type">flags</span></a></span><span>
</span><span id="line-1055"></span><span>      </span><span class="annot"><a href="#local-6989586621679565302"><span class="hs-identifier hs-type">enabled</span></a></span><span>
</span><span id="line-1056"></span><span>      </span><span class="annot"><a href="#local-6989586621679565300"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-1057"></span><span>      </span><span class="annot"><a href="#local-6989586621679565301"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-1058"></span><span>      </span><span class="annot"><a href="#local-6989586621679565309"><span class="hs-identifier hs-type">programDb0</span></a></span><span>
</span><span id="line-1059"></span><span>      </span><span class="annot"><a href="#local-6989586621679565310"><span class="hs-identifier hs-type">packageDbs</span></a></span><span>
</span><span id="line-1060"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679565332"><span class="hs-identifier hs-type">lbc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679565333"><span class="hs-identifier hs-type">pbd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679565323"><span class="hs-identifier hs-type">pkg_info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1061"></span><span>
</span><span id="line-1062"></span><span class="annot"><a href="Distribution.Simple.Configure.html#addExtraIncludeLibDirsFromConfigFlags"><span class="hs-identifier hs-type">addExtraIncludeLibDirsFromConfigFlags</span></a></span><span>
</span><span id="line-1063"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span>
</span><span id="line-1064"></span><span id="addExtraIncludeLibDirsFromConfigFlags"><span class="annot"><span class="annottext">addExtraIncludeLibDirsFromConfigFlags :: PackageDescription -&gt; ConfigFlags -&gt; PackageDescription
</span><a href="Distribution.Simple.Configure.html#addExtraIncludeLibDirsFromConfigFlags"><span class="hs-identifier hs-var hs-var">addExtraIncludeLibDirsFromConfigFlags</span></a></span></span><span> </span><span id="local-6989586621679565334"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565334"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span> </span><span id="local-6989586621679565335"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565335"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1065"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565337"><span class="annot"><span class="annottext">extraBi :: BuildInfo
</span><a href="#local-6989586621679565337"><span class="hs-identifier hs-var hs-var">extraBi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1066"></span><span>        </span><span class="annot"><span class="annottext">BuildInfo
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1067"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirs"><span class="hs-identifier hs-var">extraLibDirs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configExtraLibDirs"><span class="hs-identifier hs-var">configExtraLibDirs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565335"><span class="hs-identifier hs-type">cfg</span></a></span><span>
</span><span id="line-1068"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirsStatic"><span class="hs-identifier hs-var">extraLibDirsStatic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configExtraLibDirsStatic"><span class="hs-identifier hs-var">configExtraLibDirsStatic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565335"><span class="hs-identifier hs-type">cfg</span></a></span><span>
</span><span id="line-1069"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraFrameworkDirs"><span class="hs-identifier hs-var">extraFrameworkDirs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configExtraFrameworkDirs"><span class="hs-identifier hs-var">configExtraFrameworkDirs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565335"><span class="hs-identifier hs-type">cfg</span></a></span><span>
</span><span id="line-1070"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#includeDirs"><span class="hs-identifier hs-var">includeDirs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configExtraIncludeDirs"><span class="hs-identifier hs-var">configExtraIncludeDirs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565335"><span class="hs-identifier hs-type">cfg</span></a></span><span>
</span><span id="line-1071"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1072"></span><span>      </span><span id="local-6989586621679565347"><span class="annot"><span class="annottext">modifyLib :: Library -&gt; Library
</span><a href="#local-6989586621679565347"><span class="hs-identifier hs-var hs-var">modifyLib</span></a></span></span><span> </span><span id="local-6989586621679565348"><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679565348"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1073"></span><span>        </span><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679565348"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1074"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#libBuildInfo"><span class="hs-identifier hs-var">libBuildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1075"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#libBuildInfo"><span class="hs-identifier hs-var">libBuildInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565348"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-1076"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">`mappend`</span></span><span> </span><span class="annot"><a href="#local-6989586621679565337"><span class="hs-identifier hs-type">extraBi</span></a></span><span>
</span><span id="line-1077"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1078"></span><span>      </span><span id="local-6989586621679565351"><span class="annot"><span class="annottext">modifyExecutable :: Executable -&gt; Executable
</span><a href="#local-6989586621679565351"><span class="hs-identifier hs-var hs-var">modifyExecutable</span></a></span></span><span> </span><span id="local-6989586621679565352"><span class="annot"><span class="annottext">Executable
</span><a href="#local-6989586621679565352"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1079"></span><span>        </span><span class="annot"><span class="annottext">Executable
</span><a href="#local-6989586621679565352"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1080"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Executable.html#buildInfo"><span class="hs-identifier hs-var">buildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1081"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Executable.html#buildInfo"><span class="hs-identifier hs-var">buildInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565352"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1082"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">`mappend`</span></span><span> </span><span class="annot"><a href="#local-6989586621679565337"><span class="hs-identifier hs-type">extraBi</span></a></span><span>
</span><span id="line-1083"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1084"></span><span>      </span><span id="local-6989586621679565355"><span class="annot"><span class="annottext">modifyForeignLib :: ForeignLib -&gt; ForeignLib
</span><a href="#local-6989586621679565355"><span class="hs-identifier hs-var hs-var">modifyForeignLib</span></a></span></span><span> </span><span id="local-6989586621679565356"><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679565356"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1085"></span><span>        </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679565356"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1086"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibBuildInfo"><span class="hs-identifier hs-var">foreignLibBuildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1087"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibBuildInfo"><span class="hs-identifier hs-var">foreignLibBuildInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565356"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-1088"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">`mappend`</span></span><span> </span><span class="annot"><a href="#local-6989586621679565337"><span class="hs-identifier hs-type">extraBi</span></a></span><span>
</span><span id="line-1089"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1090"></span><span>      </span><span id="local-6989586621679565359"><span class="annot"><span class="annottext">modifyTestsuite :: TestSuite -&gt; TestSuite
</span><a href="#local-6989586621679565359"><span class="hs-identifier hs-var hs-var">modifyTestsuite</span></a></span></span><span> </span><span id="local-6989586621679565360"><span class="annot"><span class="annottext">TestSuite
</span><a href="#local-6989586621679565360"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1091"></span><span>        </span><span class="annot"><span class="annottext">TestSuite
</span><a href="#local-6989586621679565360"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1092"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.TestSuite.html#testBuildInfo"><span class="hs-identifier hs-var">testBuildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1093"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.TestSuite.html#testBuildInfo"><span class="hs-identifier hs-var">testBuildInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565360"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-1094"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">`mappend`</span></span><span> </span><span class="annot"><a href="#local-6989586621679565337"><span class="hs-identifier hs-type">extraBi</span></a></span><span>
</span><span id="line-1095"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1096"></span><span>      </span><span id="local-6989586621679565363"><span class="annot"><span class="annottext">modifyBenchmark :: Benchmark -&gt; Benchmark
</span><a href="#local-6989586621679565363"><span class="hs-identifier hs-var hs-var">modifyBenchmark</span></a></span></span><span> </span><span id="local-6989586621679565364"><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621679565364"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1097"></span><span>        </span><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621679565364"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1098"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Benchmark.html#benchmarkBuildInfo"><span class="hs-identifier hs-var">benchmarkBuildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1099"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Benchmark.html#benchmarkBuildInfo"><span class="hs-identifier hs-var">benchmarkBuildInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565364"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1100"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">`mappend`</span></span><span> </span><span class="annot"><a href="#local-6989586621679565337"><span class="hs-identifier hs-type">extraBi</span></a></span><span>
</span><span id="line-1101"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1102"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565334"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span>
</span><span id="line-1103"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#library"><span class="hs-identifier hs-var">library</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565347"><span class="hs-identifier hs-type">modifyLib</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`fmap`</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#library"><span class="hs-identifier hs-var">library</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565334"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span>
</span><span id="line-1104"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#subLibraries"><span class="hs-identifier hs-var">subLibraries</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565347"><span class="hs-identifier hs-type">modifyLib</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`map`</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#subLibraries"><span class="hs-identifier hs-var">subLibraries</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565334"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span>
</span><span id="line-1105"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#executables"><span class="hs-identifier hs-var">executables</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565351"><span class="hs-identifier hs-type">modifyExecutable</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`map`</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#executables"><span class="hs-identifier hs-var">executables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565334"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span>
</span><span id="line-1106"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#foreignLibs"><span class="hs-identifier hs-var">foreignLibs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565355"><span class="hs-identifier hs-type">modifyForeignLib</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`map`</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#foreignLibs"><span class="hs-identifier hs-var">foreignLibs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565334"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span>
</span><span id="line-1107"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#testSuites"><span class="hs-identifier hs-var">testSuites</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565359"><span class="hs-identifier hs-type">modifyTestsuite</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`map`</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#testSuites"><span class="hs-identifier hs-var">testSuites</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565334"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span>
</span><span id="line-1108"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#benchmarks"><span class="hs-identifier hs-var">benchmarks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565363"><span class="hs-identifier hs-type">modifyBenchmark</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`map`</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#benchmarks"><span class="hs-identifier hs-var">benchmarks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565334"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span>
</span><span id="line-1109"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1110"></span><span>
</span><span id="line-1111"></span><span class="annot"><a href="Distribution.Simple.Configure.html#finalCheckPackage"><span class="hs-identifier hs-type">finalCheckPackage</span></a></span><span>
</span><span id="line-1112"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span>
</span><span id="line-1113"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#PackageBuildDescr"><span class="hs-identifier hs-type">LBC.PackageBuildDescr</span></a></span><span>
</span><span id="line-1114"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.HookedBuildInfo.html#HookedBuildInfo"><span class="hs-identifier hs-type">HookedBuildInfo</span></a></span><span>
</span><span id="line-1115"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#PackageInfo"><span class="hs-identifier hs-type">PackageInfo</span></a></span><span>
</span><span id="line-1116"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#PreExistingComponent"><span class="hs-identifier hs-type">PreExistingComponent</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#ConfiguredPromisedComponent"><span class="hs-identifier hs-type">ConfiguredPromisedComponent</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1117"></span><span id="finalCheckPackage"><span class="annot"><span class="annottext">finalCheckPackage :: GenericPackageDescription
-&gt; PackageBuildDescr
-&gt; HookedBuildInfo
-&gt; PackageInfo
-&gt; IO ([PreExistingComponent], [ConfiguredPromisedComponent])
</span><a href="Distribution.Simple.Configure.html#finalCheckPackage"><span class="hs-identifier hs-var hs-var">finalCheckPackage</span></a></span></span><span>
</span><span id="line-1118"></span><span>  </span><span id="local-6989586621679565372"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565372"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span></span><span>
</span><span id="line-1119"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#PackageBuildDescr"><span class="hs-identifier hs-type">LBC.PackageBuildDescr</span></a></span><span>
</span><span id="line-1120"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">configFlags :: PackageBuildDescr -&gt; ConfigFlags
</span><a href="Distribution.Types.LocalBuildConfig.html#configFlags"><span class="hs-identifier hs-var">configFlags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565373"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565373"><span class="hs-identifier hs-var">cfg</span></a></span></span><span>
</span><span id="line-1121"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">localPkgDescr :: PackageBuildDescr -&gt; PackageDescription
</span><a href="Distribution.Types.LocalBuildConfig.html#localPkgDescr"><span class="hs-identifier hs-var">localPkgDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565374"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565374"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span>
</span><span id="line-1122"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compiler :: PackageBuildDescr -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildConfig.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565375"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565375"><span class="hs-identifier hs-var">comp</span></a></span></span><span>
</span><span id="line-1123"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hostPlatform :: PackageBuildDescr -&gt; Platform
</span><a href="Distribution.Types.LocalBuildConfig.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565376"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565376"><span class="hs-identifier hs-var">compPlatform</span></a></span></span><span>
</span><span id="line-1124"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">componentEnabledSpec :: PackageBuildDescr -&gt; ComponentRequestedSpec
</span><a href="Distribution.Types.LocalBuildConfig.html#componentEnabledSpec"><span class="hs-identifier hs-var">componentEnabledSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565377"><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565377"><span class="hs-identifier hs-var">enabled</span></a></span></span><span>
</span><span id="line-1125"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-1126"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span>  </span><span id="local-6989586621679565378"><span class="annot"><span class="annottext">HookedBuildInfo
</span><a href="#local-6989586621679565378"><span class="hs-identifier hs-var">hookedBuildInfo</span></a></span></span><span>
</span><span id="line-1128"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Configure.html#PackageInfo"><span class="hs-identifier hs-type">PackageInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679565379"><span class="annot"><span class="annottext">Set LibraryName
internalPackageSet :: PackageInfo -&gt; Set LibraryName
internalPackageSet :: Set LibraryName
</span><a href="Distribution.Simple.Configure.html#internalPackageSet"><span class="hs-identifier hs-var hs-var">internalPackageSet</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565380"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
promisedDepsSet :: PackageInfo -&gt; Map (PackageName, ComponentName) PromisedComponent
promisedDepsSet :: Map (PackageName, ComponentName) PromisedComponent
</span><a href="Distribution.Simple.Configure.html#promisedDepsSet"><span class="hs-identifier hs-var hs-var">promisedDepsSet</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565381"><span class="annot"><span class="annottext">InstalledPackageIndex
installedPackageSet :: PackageInfo -&gt; InstalledPackageIndex
installedPackageSet :: InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#installedPackageSet"><span class="hs-identifier hs-var hs-var">installedPackageSet</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565382"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
requiredDepsMap :: PackageInfo
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
requiredDepsMap :: Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="Distribution.Simple.Configure.html#requiredDepsMap"><span class="hs-identifier hs-var hs-var">requiredDepsMap</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1129"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-1130"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565383"><span class="annot"><span class="annottext">common :: CommonSetupFlags
</span><a href="#local-6989586621679565383"><span class="hs-identifier hs-var hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565373"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-1131"></span><span>          </span><span id="local-6989586621679565386"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679565386"><span class="hs-identifier hs-var hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Verbosity -&gt; Verbosity) -&gt; Flag Verbosity -&gt; Verbosity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Common.html#setupVerbosity"><span class="hs-identifier hs-var">setupVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679565383"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-1132"></span><span>          </span><span id="local-6989586621679565387"><span class="annot"><span class="annottext">cabalFileDir :: ProgArg
</span><a href="#local-6989586621679565387"><span class="hs-identifier hs-var hs-var hs-var">cabalFileDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; ProgArg
</span><a href="Distribution.Types.LocalBuildInfo.html#packageRoot"><span class="hs-identifier hs-var">packageRoot</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679565383"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-1133"></span><span>          </span><span id="local-6989586621679565389"><span class="annot"><span class="annottext">use_external_internal_deps :: Bool
</span><a href="#local-6989586621679565389"><span class="hs-identifier hs-var hs-var hs-var">use_external_internal_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1134"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565377"><span class="hs-identifier hs-var">enabled</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1135"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#OneComponentRequestedSpec"><span class="hs-identifier hs-type">OneComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1136"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1137"></span><span>
</span><span id="line-1138"></span><span>      </span><span class="annot"><span class="annottext">Verbosity
-&gt; Compiler
-&gt; PackageDescription
-&gt; ComponentRequestedSpec
-&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkCompilerProblems"><span class="hs-identifier hs-var">checkCompilerProblems</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565386"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565375"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565374"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565377"><span class="hs-identifier hs-var">enabled</span></a></span><span>
</span><span id="line-1139"></span><span>      </span><span class="annot"><span class="annottext">Verbosity
-&gt; ProgArg
-&gt; GenericPackageDescription
-&gt; PackageDescription
-&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkPackageProblems"><span class="hs-identifier hs-var">checkPackageProblems</span></a></span><span>
</span><span id="line-1140"></span><span>        </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565386"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1141"></span><span>        </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565387"><span class="hs-identifier hs-var">cabalFileDir</span></a></span><span>
</span><span id="line-1142"></span><span>        </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565372"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span><span>
</span><span id="line-1143"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HookedBuildInfo -&gt; PackageDescription -&gt; PackageDescription
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#updatePackageDescription"><span class="hs-identifier hs-var">updatePackageDescription</span></a></span><span> </span><span class="annot"><span class="annottext">HookedBuildInfo
</span><a href="#local-6989586621679565378"><span class="hs-identifier hs-var">hookedBuildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565374"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1144"></span><span>      </span><span class="hs-comment">-- NB: we apply the HookedBuildInfo to check it is valid,</span><span>
</span><span id="line-1145"></span><span>      </span><span class="hs-comment">-- but we don't propagate it.</span><span>
</span><span id="line-1146"></span><span>      </span><span class="hs-comment">-- Other UserHooks must separately return it again, and we</span><span>
</span><span id="line-1147"></span><span>      </span><span class="hs-comment">-- will re-apply it each time.</span><span>
</span><span id="line-1148"></span><span>
</span><span id="line-1149"></span><span>      </span><span class="hs-comment">-- Check languages and extensions</span><span>
</span><span id="line-1150"></span><span>      </span><span class="hs-comment">-- TODO: Move this into a helper function.</span><span>
</span><span id="line-1151"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565395"><span class="annot"><span class="annottext">langlist :: [Language]
</span><a href="#local-6989586621679565395"><span class="hs-identifier hs-var hs-var hs-var">langlist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1152"></span><span>            </span><span class="annot"><span class="annottext">[Language] -&gt; [Language]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">([Language] -&gt; [Language]) -&gt; [Language] -&gt; [Language]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1153"></span><span>              </span><span class="annot"><span class="annottext">[Maybe Language] -&gt; [Language]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe Language] -&gt; [Language]) -&gt; [Maybe Language] -&gt; [Language]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1154"></span><span>                </span><span class="annot"><span class="annottext">(BuildInfo -&gt; Maybe Language) -&gt; [BuildInfo] -&gt; [Maybe Language]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-1155"></span><span>                  </span><span class="annot"><span class="annottext">BuildInfo -&gt; Maybe Language
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#defaultLanguage"><span class="hs-identifier hs-var">defaultLanguage</span></a></span><span>
</span><span id="line-1156"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; ComponentRequestedSpec -&gt; [BuildInfo]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#enabledBuildInfos"><span class="hs-identifier hs-var">enabledBuildInfos</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565374"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565377"><span class="hs-identifier hs-var">enabled</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565399"><span class="annot"><span class="annottext">langs :: [Language]
</span><a href="#local-6989586621679565399"><span class="hs-identifier hs-var hs-var hs-var">langs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; [Language] -&gt; [Language]
</span><a href="Distribution.Simple.Compiler.html#unsupportedLanguages"><span class="hs-identifier hs-var">unsupportedLanguages</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565375"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">[Language]
</span><a href="#local-6989586621679565395"><span class="hs-identifier hs-var">langlist</span></a></span><span>
</span><span id="line-1158"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Language] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Language]
</span><a href="#local-6989586621679565399"><span class="hs-identifier hs-var">langs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1159"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565386"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1160"></span><span>          </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; CompilerId -&gt; [ProgArg] -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#UnsupportedLanguages"><span class="hs-identifier hs-var">UnsupportedLanguages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; PackageIdentifier
forall pkg. Package pkg =&gt; pkg -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageId"><span class="hs-identifier hs-var">packageId</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565372"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; CompilerId
</span><a href="Distribution.Simple.Compiler.html#compilerId"><span class="hs-identifier hs-var">compilerId</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565375"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Language -&gt; ProgArg) -&gt; [Language] -&gt; [ProgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Language -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">[Language]
</span><a href="#local-6989586621679565399"><span class="hs-identifier hs-var">langs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1161"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565405"><span class="annot"><span class="annottext">extlist :: [Extension]
</span><a href="#local-6989586621679565405"><span class="hs-identifier hs-var hs-var hs-var">extlist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1162"></span><span>            </span><span class="annot"><span class="annottext">[Extension] -&gt; [Extension]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">([Extension] -&gt; [Extension]) -&gt; [Extension] -&gt; [Extension]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1163"></span><span>              </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [Extension]) -&gt; [BuildInfo] -&gt; [Extension]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span>
</span><span id="line-1164"></span><span>                </span><span class="annot"><span class="annottext">BuildInfo -&gt; [Extension]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#allExtensions"><span class="hs-identifier hs-var">allExtensions</span></a></span><span>
</span><span id="line-1165"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; ComponentRequestedSpec -&gt; [BuildInfo]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#enabledBuildInfos"><span class="hs-identifier hs-var">enabledBuildInfos</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565374"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565377"><span class="hs-identifier hs-var">enabled</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1166"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565408"><span class="annot"><span class="annottext">exts :: [Extension]
</span><a href="#local-6989586621679565408"><span class="hs-identifier hs-var hs-var hs-var">exts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; [Extension] -&gt; [Extension]
</span><a href="Distribution.Simple.Compiler.html#unsupportedExtensions"><span class="hs-identifier hs-var">unsupportedExtensions</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565375"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">[Extension]
</span><a href="#local-6989586621679565405"><span class="hs-identifier hs-var">extlist</span></a></span><span>
</span><span id="line-1167"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Extension] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Extension]
</span><a href="#local-6989586621679565408"><span class="hs-identifier hs-var">exts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1168"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565386"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1169"></span><span>          </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; CompilerId -&gt; [ProgArg] -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#UnsupportedLanguageExtension"><span class="hs-identifier hs-var">UnsupportedLanguageExtension</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; PackageIdentifier
forall pkg. Package pkg =&gt; pkg -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageId"><span class="hs-identifier hs-var">packageId</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565372"><span class="hs-identifier hs-var">g_pkg_descr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; CompilerId
</span><a href="Distribution.Simple.Compiler.html#compilerId"><span class="hs-identifier hs-var">compilerId</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565375"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Extension -&gt; ProgArg) -&gt; [Extension] -&gt; [ProgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Extension -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">[Extension]
</span><a href="#local-6989586621679565408"><span class="hs-identifier hs-var">exts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1170"></span><span>
</span><span id="line-1171"></span><span>      </span><span class="hs-comment">-- Check foreign library build requirements</span><span>
</span><span id="line-1172"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565411"><span class="annot"><span class="annottext">flibs :: [ForeignLib]
</span><a href="#local-6989586621679565411"><span class="hs-identifier hs-var hs-var hs-var">flibs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679565412"><span class="hs-identifier hs-var">flib</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Component.html#CFLib"><span class="hs-identifier hs-type">CFLib</span></a></span><span> </span><span id="local-6989586621679565412"><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679565412"><span class="hs-identifier hs-var">flib</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PackageDescription -&gt; ComponentRequestedSpec -&gt; [Component]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#enabledComponents"><span class="hs-identifier hs-var">enabledComponents</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565374"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565377"><span class="hs-identifier hs-var">enabled</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1173"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565415"><span class="annot"><span class="annottext">unsupportedFLibs :: [ProgArg]
</span><a href="#local-6989586621679565415"><span class="hs-identifier hs-var hs-var hs-var">unsupportedFLibs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Platform -&gt; [ForeignLib] -&gt; [ProgArg]
</span><a href="Distribution.Simple.Configure.html#unsupportedForeignLibs"><span class="hs-identifier hs-var">unsupportedForeignLibs</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565375"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565376"><span class="hs-identifier hs-var">compPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">[ForeignLib]
</span><a href="#local-6989586621679565411"><span class="hs-identifier hs-var">flibs</span></a></span><span>
</span><span id="line-1174"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProgArg] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679565415"><span class="hs-identifier hs-var">unsupportedFLibs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1175"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565386"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1176"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#CantFindForeignLibraries"><span class="hs-identifier hs-var">CantFindForeignLibraries</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679565415"><span class="hs-identifier hs-var">unsupportedFLibs</span></a></span><span>
</span><span id="line-1177"></span><span>
</span><span id="line-1178"></span><span>      </span><span class="hs-comment">-- The list of 'InstalledPackageInfo' recording the selected</span><span>
</span><span id="line-1179"></span><span>      </span><span class="hs-comment">-- dependencies on external packages.</span><span>
</span><span id="line-1180"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1181"></span><span>      </span><span class="hs-comment">-- Invariant: For any package name, there is at most one package</span><span>
</span><span id="line-1182"></span><span>      </span><span class="hs-comment">-- in externalPackageDeps which has that name.</span><span>
</span><span id="line-1183"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1184"></span><span>      </span><span class="hs-comment">-- NB: The dependency selection is global over ALL components</span><span>
</span><span id="line-1185"></span><span>      </span><span class="hs-comment">-- in the package (similar to how allConstraints and</span><span>
</span><span id="line-1186"></span><span>      </span><span class="hs-comment">-- requiredDepsMap are global over all components).  In particular,</span><span>
</span><span id="line-1187"></span><span>      </span><span class="hs-comment">-- if *any* component (post-flag resolution) has an unsatisfiable</span><span>
</span><span id="line-1188"></span><span>      </span><span class="hs-comment">-- dependency, we will fail.  This can sometimes be undesirable</span><span>
</span><span id="line-1189"></span><span>      </span><span class="hs-comment">-- for users, see #1786 (benchmark conflicts with executable),</span><span>
</span><span id="line-1190"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1191"></span><span>      </span><span class="hs-comment">-- In the presence of Backpack, these package dependencies are</span><span>
</span><span id="line-1192"></span><span>      </span><span class="hs-comment">-- NOT complete: they only ever include the INDEFINITE</span><span>
</span><span id="line-1193"></span><span>      </span><span class="hs-comment">-- dependencies.  After we apply an instantiation, we'll get</span><span>
</span><span id="line-1194"></span><span>      </span><span class="hs-comment">-- definite references which constitute extra dependencies.</span><span>
</span><span id="line-1195"></span><span>      </span><span class="hs-comment">-- (Why not have cabal-install pass these in explicitly?</span><span>
</span><span id="line-1196"></span><span>      </span><span class="hs-comment">-- For one it's deterministic; for two, we need to associate</span><span>
</span><span id="line-1197"></span><span>      </span><span class="hs-comment">-- them with renamings which would require a far more complicated</span><span>
</span><span id="line-1198"></span><span>      </span><span class="hs-comment">-- input scheme than what we have today.)</span><span>
</span><span id="line-1199"></span><span>      </span><span class="annot"><span class="annottext">Verbosity
-&gt; Bool
-&gt; Set LibraryName
-&gt; Map (PackageName, ComponentName) PromisedComponent
-&gt; InstalledPackageIndex
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
-&gt; PackageDescription
-&gt; ComponentRequestedSpec
-&gt; IO ([PreExistingComponent], [ConfiguredPromisedComponent])
</span><a href="Distribution.Simple.Configure.html#configureDependencies"><span class="hs-identifier hs-var">configureDependencies</span></a></span><span>
</span><span id="line-1200"></span><span>        </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565386"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1201"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565389"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span><span>
</span><span id="line-1202"></span><span>        </span><span class="annot"><span class="annottext">Set LibraryName
</span><a href="#local-6989586621679565379"><span class="hs-identifier hs-var">internalPackageSet</span></a></span><span>
</span><span id="line-1203"></span><span>        </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565380"><span class="hs-identifier hs-var">promisedDepsSet</span></a></span><span>
</span><span id="line-1204"></span><span>        </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565381"><span class="hs-identifier hs-var">installedPackageSet</span></a></span><span>
</span><span id="line-1205"></span><span>        </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565382"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span><span>
</span><span id="line-1206"></span><span>        </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565374"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span>
</span><span id="line-1207"></span><span>        </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565377"><span class="hs-identifier hs-var">enabled</span></a></span><span>
</span><span id="line-1208"></span><span>
</span><span id="line-1209"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configureComponents"><span class="hs-identifier hs-type">configureComponents</span></a></span><span>
</span><span id="line-1210"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span>
</span><span id="line-1211"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#PackageBuildDescr"><span class="hs-identifier hs-type">LBC.PackageBuildDescr</span></a></span><span>
</span><span id="line-1212"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#PackageInfo"><span class="hs-identifier hs-type">PackageInfo</span></a></span><span>
</span><span id="line-1213"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#PreExistingComponent"><span class="hs-identifier hs-type">PreExistingComponent</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#ConfiguredPromisedComponent"><span class="hs-identifier hs-type">ConfiguredPromisedComponent</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1214"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-1215"></span><span id="configureComponents"><span class="annot"><span class="annottext">configureComponents :: LocalBuildConfig
-&gt; PackageBuildDescr
-&gt; PackageInfo
-&gt; ([PreExistingComponent], [ConfiguredPromisedComponent])
-&gt; IO LocalBuildInfo
</span><a href="Distribution.Simple.Configure.html#configureComponents"><span class="hs-identifier hs-var hs-var">configureComponents</span></a></span></span><span>
</span><span id="line-1216"></span><span>  </span><span id="local-6989586621679565419"><span class="annot"><span class="annottext">lbc :: LocalBuildConfig
</span><a href="#local-6989586621679565419"><span class="hs-identifier hs-var">lbc</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildConfig"><span class="hs-identifier hs-type">LBC.LocalBuildConfig</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">withPrograms :: LocalBuildConfig -&gt; ProgramDb
</span><a href="Distribution.Types.LocalBuildConfig.html#withPrograms"><span class="hs-identifier hs-var">withPrograms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565420"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565420"><span class="hs-identifier hs-var">programDb</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1217"></span><span>  </span><span id="local-6989586621679565421"><span class="annot"><span class="annottext">pbd0 :: PackageBuildDescr
</span><a href="#local-6989586621679565421"><span class="hs-identifier hs-var">pbd0</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#PackageBuildDescr"><span class="hs-identifier hs-type">LBC.PackageBuildDescr</span></a></span><span>
</span><span id="line-1218"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">configFlags :: PackageBuildDescr -&gt; ConfigFlags
</span><a href="Distribution.Types.LocalBuildConfig.html#configFlags"><span class="hs-identifier hs-var">configFlags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565422"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565422"><span class="hs-identifier hs-var">cfg</span></a></span></span><span>
</span><span id="line-1219"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">localPkgDescr :: PackageBuildDescr -&gt; PackageDescription
</span><a href="Distribution.Types.LocalBuildConfig.html#localPkgDescr"><span class="hs-identifier hs-var">localPkgDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565423"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565423"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span>
</span><span id="line-1220"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compiler :: PackageBuildDescr -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildConfig.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565424"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565424"><span class="hs-identifier hs-var">comp</span></a></span></span><span>
</span><span id="line-1221"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">componentEnabledSpec :: PackageBuildDescr -&gt; ComponentRequestedSpec
</span><a href="Distribution.Types.LocalBuildConfig.html#componentEnabledSpec"><span class="hs-identifier hs-var">componentEnabledSpec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565425"><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565425"><span class="hs-identifier hs-var">enabled</span></a></span></span><span>
</span><span id="line-1222"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-1223"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-1224"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Configure.html#PackageInfo"><span class="hs-identifier hs-type">PackageInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679565426"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
promisedDepsSet :: PackageInfo -&gt; Map (PackageName, ComponentName) PromisedComponent
promisedDepsSet :: Map (PackageName, ComponentName) PromisedComponent
</span><a href="Distribution.Simple.Configure.html#promisedDepsSet"><span class="hs-identifier hs-var hs-var">promisedDepsSet</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565427"><span class="annot"><span class="annottext">InstalledPackageIndex
installedPackageSet :: PackageInfo -&gt; InstalledPackageIndex
installedPackageSet :: InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#installedPackageSet"><span class="hs-identifier hs-var hs-var">installedPackageSet</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1225"></span><span>  </span><span id="local-6989586621679565428"><span class="annot"><span class="annottext">([PreExistingComponent], [ConfiguredPromisedComponent])
</span><a href="#local-6989586621679565428"><span class="hs-identifier hs-var">externalPkgDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1226"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-1227"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565429"><span class="annot"><span class="annottext">common :: CommonSetupFlags
</span><a href="#local-6989586621679565429"><span class="hs-identifier hs-var hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565422"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-1228"></span><span>          </span><span id="local-6989586621679565432"><span class="annot"><span class="annottext">verbosity :: Verbosity
</span><a href="#local-6989586621679565432"><span class="hs-identifier hs-var hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Verbosity -&gt; Verbosity) -&gt; Flag Verbosity -&gt; Verbosity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Common.html#setupVerbosity"><span class="hs-identifier hs-var">setupVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679565429"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-1229"></span><span>          </span><span id="local-6989586621679565433"><span class="annot"><span class="annottext">use_external_internal_deps :: Bool
</span><a href="#local-6989586621679565433"><span class="hs-identifier hs-var hs-var hs-var">use_external_internal_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1230"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565425"><span class="hs-identifier hs-var">enabled</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1231"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#OneComponentRequestedSpec"><span class="hs-identifier hs-type">OneComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1232"></span><span>              </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1233"></span><span>
</span><span id="line-1234"></span><span>      </span><span class="hs-comment">-- Compute internal component graph</span><span>
</span><span id="line-1235"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1236"></span><span>      </span><span class="hs-comment">-- The general idea is that we take a look at all the source level</span><span>
</span><span id="line-1237"></span><span>      </span><span class="hs-comment">-- components (which may build-depends on each other) and form a graph.</span><span>
</span><span id="line-1238"></span><span>      </span><span class="hs-comment">-- From there, we build a ComponentLocalBuildInfo for each of the</span><span>
</span><span id="line-1239"></span><span>      </span><span class="hs-comment">-- components, which lets us actually build each component.</span><span>
</span><span id="line-1240"></span><span>      </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679565434"><span class="annot"><a href="#local-6989586621679565434"><span class="hs-identifier hs-var">buildComponents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier">ComponentLocalBuildInfo</span></span><span class="hs-special">]</span><span>
</span><span id="line-1241"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565435"><span class="annot"><a href="#local-6989586621679565435"><span class="hs-identifier hs-var">packageDependsIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">InstalledPackageIndex</span></span><span>
</span><span id="line-1242"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1243"></span><span>        </span><span class="annot"><span class="annottext">Verbosity
-&gt; LogProgress ([ComponentLocalBuildInfo], InstalledPackageIndex)
-&gt; IO ([ComponentLocalBuildInfo], InstalledPackageIndex)
forall a. Verbosity -&gt; LogProgress a -&gt; IO a
</span><a href="Distribution.Utils.LogProgress.html#runLogProgress"><span class="hs-identifier hs-var">runLogProgress</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565432"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(LogProgress ([ComponentLocalBuildInfo], InstalledPackageIndex)
 -&gt; IO ([ComponentLocalBuildInfo], InstalledPackageIndex))
-&gt; LogProgress ([ComponentLocalBuildInfo], InstalledPackageIndex)
-&gt; IO ([ComponentLocalBuildInfo], InstalledPackageIndex)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1244"></span><span>          </span><span class="annot"><span class="annottext">Verbosity
-&gt; Bool
-&gt; ComponentRequestedSpec
-&gt; Bool
-&gt; Flag ProgArg
-&gt; Flag ComponentId
-&gt; PackageDescription
-&gt; ([PreExistingComponent], [ConfiguredPromisedComponent])
-&gt; FlagAssignment
-&gt; [(ModuleName, Module)]
-&gt; InstalledPackageIndex
-&gt; Compiler
-&gt; LogProgress ([ComponentLocalBuildInfo], InstalledPackageIndex)
</span><a href="Distribution.Backpack.Configure.html#configureComponentLocalBuildInfos"><span class="hs-identifier hs-var">configureComponentLocalBuildInfos</span></a></span><span>
</span><span id="line-1245"></span><span>            </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565432"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1246"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565433"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span><span>
</span><span id="line-1247"></span><span>            </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565425"><span class="hs-identifier hs-var">enabled</span></a></span><span>
</span><span id="line-1248"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configDeterministic"><span class="hs-identifier hs-var">configDeterministic</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565422"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1249"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag ProgArg
</span><a href="Distribution.Simple.Setup.Config.html#configIPID"><span class="hs-identifier hs-var">configIPID</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565422"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1250"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag ComponentId
</span><a href="Distribution.Simple.Setup.Config.html#configCID"><span class="hs-identifier hs-var">configCID</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565422"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1251"></span><span>            </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565423"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span>
</span><span id="line-1252"></span><span>            </span><span class="annot"><span class="annottext">([PreExistingComponent], [ConfiguredPromisedComponent])
</span><a href="#local-6989586621679565428"><span class="hs-identifier hs-var">externalPkgDeps</span></a></span><span>
</span><span id="line-1253"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; FlagAssignment
</span><a href="Distribution.Simple.Setup.Config.html#configConfigurationsFlags"><span class="hs-identifier hs-var">configConfigurationsFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565422"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1254"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; [(ModuleName, Module)]
</span><a href="Distribution.Simple.Setup.Config.html#configInstantiateWith"><span class="hs-identifier hs-var">configInstantiateWith</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565422"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1255"></span><span>            </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565427"><span class="hs-identifier hs-var">installedPackageSet</span></a></span><span>
</span><span id="line-1256"></span><span>            </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565424"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1257"></span><span>
</span><span id="line-1258"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565443"><span class="annot"><a href="#local-6989586621679565443"><span class="hs-identifier hs-var hs-var">buildComponentsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1259"></span><span>            </span><span class="annot"><span class="annottext">(Map ComponentName [ComponentLocalBuildInfo]
 -&gt; ComponentLocalBuildInfo
 -&gt; Map ComponentName [ComponentLocalBuildInfo])
-&gt; Map ComponentName [ComponentLocalBuildInfo]
-&gt; [ComponentLocalBuildInfo]
-&gt; Map ComponentName [ComponentLocalBuildInfo]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span>
</span><span id="line-1260"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565445"><span class="annot"><span class="annottext">Map ComponentName [ComponentLocalBuildInfo]
</span><a href="#local-6989586621679565445"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679565446"><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679565446"><span class="hs-identifier hs-var">clbi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1261"></span><span>                  </span><span class="annot"><span class="annottext">([ComponentLocalBuildInfo]
 -&gt; [ComponentLocalBuildInfo] -&gt; [ComponentLocalBuildInfo])
-&gt; ComponentName
-&gt; [ComponentLocalBuildInfo]
-&gt; Map ComponentName [ComponentLocalBuildInfo]
-&gt; Map ComponentName [ComponentLocalBuildInfo]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span>
</span><span id="line-1262"></span><span>                    </span><span class="annot"><span class="annottext">[ComponentLocalBuildInfo]
-&gt; [ComponentLocalBuildInfo] -&gt; [ComponentLocalBuildInfo]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span>
</span><span id="line-1263"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComponentLocalBuildInfo -&gt; ComponentName
</span><a href="Distribution.Types.ComponentLocalBuildInfo.html#componentLocalName"><span class="hs-identifier hs-var">componentLocalName</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679565446"><span class="hs-identifier hs-var">clbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1264"></span><span>                    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><a href="#local-6989586621679565446"><span class="hs-identifier hs-var">clbi</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1265"></span><span>                    </span><span class="annot"><span class="annottext">Map ComponentName [ComponentLocalBuildInfo]
</span><a href="#local-6989586621679565445"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1266"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-1267"></span><span>              </span><span class="annot"><span class="annottext">Map ComponentName [ComponentLocalBuildInfo]
forall k a. Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-1268"></span><span>              </span><span class="annot"><span class="annottext">[ComponentLocalBuildInfo]
</span><a href="#local-6989586621679565434"><span class="hs-identifier hs-var">buildComponents</span></a></span><span>
</span><span id="line-1269"></span><span>
</span><span id="line-1270"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565454"><span class="annot"><a href="#local-6989586621679565454"><span class="hs-identifier hs-var hs-var">cbd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1271"></span><span>            </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#ComponentBuildDescr"><span class="hs-identifier hs-type">LBC.ComponentBuildDescr</span></a></span><span>
</span><span id="line-1272"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">componentGraph :: Graph ComponentLocalBuildInfo
</span><a href="Distribution.Types.LocalBuildConfig.html#componentGraph"><span class="hs-identifier hs-var">componentGraph</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ComponentLocalBuildInfo] -&gt; Graph ComponentLocalBuildInfo
forall a. (IsNode a, Show (Key a)) =&gt; [a] -&gt; Graph a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Graph.html#fromDistinctList"><span class="hs-identifier hs-var">Graph.fromDistinctList</span></a></span><span> </span><span class="annot"><span class="annottext">[ComponentLocalBuildInfo]
</span><a href="#local-6989586621679565434"><span class="hs-identifier hs-var">buildComponents</span></a></span><span>
</span><span id="line-1273"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">componentNameMap :: Map ComponentName [ComponentLocalBuildInfo]
</span><a href="Distribution.Types.LocalBuildConfig.html#componentNameMap"><span class="hs-identifier hs-var">componentNameMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ComponentName [ComponentLocalBuildInfo]
</span><a href="#local-6989586621679565443"><span class="hs-identifier hs-var">buildComponentsMap</span></a></span><span>
</span><span id="line-1274"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">promisedPkgs :: Map (PackageName, ComponentName) PromisedComponent
</span><a href="Distribution.Types.LocalBuildConfig.html#promisedPkgs"><span class="hs-identifier hs-var">promisedPkgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565426"><span class="hs-identifier hs-var">promisedDepsSet</span></a></span><span>
</span><span id="line-1275"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">installedPkgs :: InstalledPackageIndex
</span><a href="Distribution.Types.LocalBuildConfig.html#installedPkgs"><span class="hs-identifier hs-var">installedPkgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565435"><span class="hs-identifier hs-var">packageDependsIndex</span></a></span><span>
</span><span id="line-1276"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-1277"></span><span>
</span><span id="line-1278"></span><span>          </span><span class="hs-comment">-- For whole-package configure, we determine the</span><span>
</span><span id="line-1279"></span><span>          </span><span class="hs-comment">-- extraCoverageFor of the main lib and sub libs here.</span><span>
</span><span id="line-1280"></span><span>          </span><span id="local-6989586621679565461"><span class="annot"><a href="#local-6989586621679565461"><span class="hs-identifier hs-var hs-var">extraCoverageUnitIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565425"><span class="hs-identifier hs-var">enabled</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1281"></span><span>            </span><span class="hs-comment">-- Whole package configure, add package libs</span><span>
</span><span id="line-1282"></span><span>            </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ComponentLocalBuildInfo -&gt; Maybe UnitId)
-&gt; [ComponentLocalBuildInfo] -&gt; [UnitId]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo -&gt; Maybe UnitId
</span><a href="#local-6989586621679565463"><span class="hs-identifier hs-var">mbCompUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">[ComponentLocalBuildInfo]
</span><a href="#local-6989586621679565434"><span class="hs-identifier hs-var">buildComponents</span></a></span><span>
</span><span id="line-1283"></span><span>            </span><span class="hs-comment">-- Component configure, no need to do anything since</span><span>
</span><span id="line-1284"></span><span>            </span><span class="hs-comment">-- extra-coverage-for will be passed for all other components that</span><span>
</span><span id="line-1285"></span><span>            </span><span class="hs-comment">-- should be covered.</span><span>
</span><span id="line-1286"></span><span>            </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#OneComponentRequestedSpec"><span class="hs-identifier hs-type">OneComponentRequestedSpec</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1287"></span><span>          </span><span id="local-6989586621679565463"><span class="annot"><a href="#local-6989586621679565463"><span class="hs-identifier hs-var hs-var">mbCompUnitId</span></a></span></span><span> </span><span class="annot"><a href="Distribution.Types.ComponentLocalBuildInfo.html#LibComponentLocalBuildInfo"><span class="hs-identifier hs-type">LibComponentLocalBuildInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621679565465"><span class="annot"><span class="annottext">UnitId
componentUnitId :: UnitId
componentUnitId :: ComponentLocalBuildInfo -&gt; UnitId
</span><a href="#local-6989586621679565465"><span class="hs-identifier hs-var hs-var">componentUnitId</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitId -&gt; Maybe UnitId
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679565465"><span class="hs-identifier hs-var">componentUnitId</span></a></span><span>
</span><span id="line-1288"></span><span>          </span><span class="annot"><a href="#local-6989586621679565463"><span class="hs-identifier hs-var">mbCompUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentLocalBuildInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe UnitId
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span>          </span><span id="local-6989586621679565467"><span class="annot"><a href="#local-6989586621679565467"><span class="hs-identifier hs-var hs-var">pbd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1291"></span><span>            </span><span class="annot"><span class="annottext">PackageBuildDescr
</span><a href="#local-6989586621679565421"><span class="hs-identifier hs-var">pbd0</span></a></span><span>
</span><span id="line-1292"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#extraCoverageFor"><span class="hs-identifier hs-var">LBC.extraCoverageFor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565461"><span class="hs-identifier hs-type">extraCoverageUnitIds</span></a></span><span>
</span><span id="line-1293"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-1294"></span><span>
</span><span id="line-1295"></span><span>          </span><span id="local-6989586621679565468"><span class="annot"><a href="#local-6989586621679565468"><span class="hs-identifier hs-var hs-var">lbd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1296"></span><span>            </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#LocalBuildDescr"><span class="hs-identifier hs-type">LBC.LocalBuildDescr</span></a></span><span>
</span><span id="line-1297"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">packageBuildDescr :: PackageBuildDescr
</span><a href="Distribution.Types.LocalBuildConfig.html#packageBuildDescr"><span class="hs-identifier hs-var">packageBuildDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageBuildDescr
</span><a href="#local-6989586621679565467"><span class="hs-identifier hs-var">pbd</span></a></span><span>
</span><span id="line-1298"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">componentBuildDescr :: ComponentBuildDescr
</span><a href="Distribution.Types.LocalBuildConfig.html#componentBuildDescr"><span class="hs-identifier hs-var">componentBuildDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ComponentBuildDescr
</span><a href="#local-6989586621679565454"><span class="hs-identifier hs-var">cbd</span></a></span><span>
</span><span id="line-1299"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-1300"></span><span>
</span><span id="line-1301"></span><span>          </span><span id="local-6989586621679565472"><span class="annot"><a href="#local-6989586621679565472"><span class="hs-identifier hs-var hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1302"></span><span>            </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#NewLocalBuildInfo"><span class="hs-identifier hs-type">NewLocalBuildInfo</span></a></span><span>
</span><span id="line-1303"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">localBuildDescr :: LocalBuildDescr
</span><a href="Distribution.Types.LocalBuildInfo.html#localBuildDescr"><span class="hs-identifier hs-var">localBuildDescr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildDescr
</span><a href="#local-6989586621679565468"><span class="hs-identifier hs-var">lbd</span></a></span><span>
</span><span id="line-1304"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">localBuildConfig :: LocalBuildConfig
</span><a href="Distribution.Types.LocalBuildInfo.html#localBuildConfig"><span class="hs-identifier hs-var">localBuildConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildConfig
</span><a href="#local-6989586621679565419"><span class="hs-identifier hs-var">lbc</span></a></span><span>
</span><span id="line-1305"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-1306"></span><span>
</span><span id="line-1307"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#relocatable"><span class="hs-identifier hs-var">LBC.relocatable</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withBuildOptions"><span class="hs-identifier hs-var">LBC.withBuildOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565419"><span class="hs-identifier hs-type">lbc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1308"></span><span>        </span><span class="annot"><a href="Distribution.Simple.Configure.html#checkRelocatable"><span class="hs-identifier hs-type">checkRelocatable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565432"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565423"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565472"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-1309"></span><span>
</span><span id="line-1310"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withDynExe"><span class="hs-identifier hs-var">LBC.withDynExe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withBuildOptions"><span class="hs-identifier hs-var">LBC.withBuildOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565419"><span class="hs-identifier hs-type">lbc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1311"></span><span>        </span><span class="annot"><a href="Distribution.Simple.Configure.html#checkSharedExes"><span class="hs-identifier hs-type">checkSharedExes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565432"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565472"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-1312"></span><span>
</span><span id="line-1313"></span><span>      </span><span class="hs-comment">-- TODO: This is not entirely correct, because the dirs may vary</span><span>
</span><span id="line-1314"></span><span>      </span><span class="hs-comment">-- across libraries/executables</span><span>
</span><span id="line-1315"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565478"><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-var hs-var">dirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageDescription
-&gt; LocalBuildInfo -&gt; CopyDest -&gt; InstallDirs ProgArg
</span><a href="Distribution.Simple.LocalBuildInfo.html#absoluteInstallDirs"><span class="hs-identifier hs-var">absoluteInstallDirs</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565423"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679565472"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">CopyDest
</span><a href="Distribution.Simple.InstallDirs.html#NoCopyDest"><span class="hs-identifier hs-var">NoCopyDest</span></a></span><span>
</span><span id="line-1316"></span><span>          </span><span id="local-6989586621679565483"><span class="annot"><a href="#local-6989586621679565483"><span class="hs-identifier hs-var hs-var">relative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; LocalBuildInfo -&gt; InstallDirs (Maybe ProgArg)
</span><a href="Distribution.Simple.LocalBuildInfo.html#prefixRelativeInstallDirs"><span class="hs-identifier hs-var">prefixRelativeInstallDirs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; PackageIdentifier
forall pkg. Package pkg =&gt; pkg -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageId"><span class="hs-identifier hs-var">packageId</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565423"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679565472"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-1317"></span><span>
</span><span id="line-1318"></span><span>      </span><span class="hs-comment">-- PKGROOT: allowing ${pkgroot} to be passed as --prefix to</span><span>
</span><span id="line-1319"></span><span>      </span><span class="hs-comment">-- cabal configure, is only a hidden option. It allows packages</span><span>
</span><span id="line-1320"></span><span>      </span><span class="hs-comment">-- to be relocatable with their package database.  This however</span><span>
</span><span id="line-1321"></span><span>      </span><span class="hs-comment">-- breaks when the Paths_* or other includes are used that</span><span>
</span><span id="line-1322"></span><span>      </span><span class="hs-comment">-- contain hard coded paths. This is still an open TODO.</span><span>
</span><span id="line-1323"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1324"></span><span>      </span><span class="hs-comment">-- Allowing ${pkgroot} here, however requires less custom hooks</span><span>
</span><span id="line-1325"></span><span>      </span><span class="hs-comment">-- in scripts that *really* want ${pkgroot}. See haskell/cabal/#4872</span><span>
</span><span id="line-1326"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span>
</span><span id="line-1327"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.Posix.html#isAbsolute"><span class="hs-identifier hs-type">isAbsolute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1328"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><span class="hs-string">&quot;${pkgroot}&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`isPrefixOf`</span></span><span> </span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span>
</span><span id="line-1329"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-1330"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-type">dieWithException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565432"><span class="hs-identifier hs-type">verbosity</span></a></span><span>
</span><span id="line-1331"></span><span>        </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#ExpectedAbsoluteDirectory"><span class="hs-identifier hs-type">ExpectedAbsoluteDirectory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1332"></span><span>
</span><span id="line-1333"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;${pkgroot}&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">`isPrefixOf`</span></span><span> </span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1334"></span><span>        </span><span class="annot"><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-type">warn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565432"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1335"></span><span>          </span><span class="annot"><span class="hs-string">&quot;Using ${pkgroot} in prefix &quot;</span></span><span>
</span><span id="line-1336"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span>
</span><span id="line-1337"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; will not work if you rely on the Path_* module &quot;</span></span><span>
</span><span id="line-1338"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; or other hard coded paths.  Cabal does not yet &quot;</span></span><span>
</span><span id="line-1339"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; support fully relocatable builds! &quot;</span></span><span>
</span><span id="line-1340"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; See #462 #2302 #2994 #3305 #3473 #3586 #3909&quot;</span></span><span>
</span><span id="line-1341"></span><span>            </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; #4097 #4291 #4872&quot;</span></span><span>
</span><span id="line-1342"></span><span>
</span><span id="line-1343"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565432"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1344"></span><span>        </span><span class="annot"><span class="hs-string">&quot;Using &quot;</span></span><span>
</span><span id="line-1345"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-type">prettyShow</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#currentCabalId"><span class="hs-identifier hs-type">currentCabalId</span></a></span><span>
</span><span id="line-1346"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; compiled by &quot;</span></span><span>
</span><span id="line-1347"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-type">prettyShow</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#currentCompilerId"><span class="hs-identifier hs-type">currentCompilerId</span></a></span><span>
</span><span id="line-1348"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565432"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Using compiler: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#showCompilerId"><span class="hs-identifier hs-type">showCompilerId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565424"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-1349"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565432"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Using install prefix: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span>
</span><span id="line-1350"></span><span>
</span><span id="line-1351"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565492"><span class="annot"><a href="#local-6989586621679565492"><span class="hs-identifier hs-var hs-var">dirinfo</span></a></span></span><span> </span><span id="local-6989586621679565493"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565493"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679565494"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565494"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679565495"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679565495"><span class="hs-identifier hs-var">isPrefixRelative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1352"></span><span>            </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565432"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; IO ()) -&gt; ProgArg -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565493"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; installed in: &quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565494"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565496"><span class="hs-identifier hs-var">relNote</span></a></span><span>
</span><span id="line-1353"></span><span>            </span><span class="hs-keyword">where</span><span>
</span><span id="line-1354"></span><span>              </span><span id="local-6989586621679565496"><span class="annot"><span class="annottext">relNote :: ProgArg
</span><a href="#local-6989586621679565496"><span class="hs-identifier hs-var hs-var">relNote</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#buildOS"><span class="hs-identifier hs-var">buildOS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1355"></span><span>                </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Windows"><span class="hs-identifier hs-var">Windows</span></a></span><span>
</span><span id="line-1356"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#hasLibs"><span class="hs-identifier hs-var">hasLibs</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565423"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1357"></span><span>                      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679565495"><span class="hs-identifier hs-var">isPrefixRelative</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1358"></span><span>                      </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;  (fixed location)&quot;</span></span><span>
</span><span id="line-1359"></span><span>                </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-1360"></span><span>
</span><span id="line-1361"></span><span>      </span><span class="annot"><a href="#local-6989586621679565492"><span class="hs-identifier hs-type">dirinfo</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Executables&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#bindir"><span class="hs-identifier hs-var">bindir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#bindir"><span class="hs-identifier hs-var">bindir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565483"><span class="hs-identifier hs-type">relative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1362"></span><span>      </span><span class="annot"><a href="#local-6989586621679565492"><span class="hs-identifier hs-type">dirinfo</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Libraries&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#libdir"><span class="hs-identifier hs-var">libdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#libdir"><span class="hs-identifier hs-var">libdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565483"><span class="hs-identifier hs-type">relative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1363"></span><span>      </span><span class="annot"><a href="#local-6989586621679565492"><span class="hs-identifier hs-type">dirinfo</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Dynamic Libraries&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#dynlibdir"><span class="hs-identifier hs-var">dynlibdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#dynlibdir"><span class="hs-identifier hs-var">dynlibdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565483"><span class="hs-identifier hs-type">relative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1364"></span><span>      </span><span class="annot"><a href="#local-6989586621679565492"><span class="hs-identifier hs-type">dirinfo</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Private executables&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#libexecdir"><span class="hs-identifier hs-var">libexecdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#libexecdir"><span class="hs-identifier hs-var">libexecdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565483"><span class="hs-identifier hs-type">relative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1365"></span><span>      </span><span class="annot"><a href="#local-6989586621679565492"><span class="hs-identifier hs-type">dirinfo</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Data files&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#datadir"><span class="hs-identifier hs-var">datadir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#datadir"><span class="hs-identifier hs-var">datadir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565483"><span class="hs-identifier hs-type">relative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1366"></span><span>      </span><span class="annot"><a href="#local-6989586621679565492"><span class="hs-identifier hs-type">dirinfo</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Documentation&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#docdir"><span class="hs-identifier hs-var">docdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#docdir"><span class="hs-identifier hs-var">docdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565483"><span class="hs-identifier hs-type">relative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1367"></span><span>      </span><span class="annot"><a href="#local-6989586621679565492"><span class="hs-identifier hs-type">dirinfo</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Configuration files&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#sysconfdir"><span class="hs-identifier hs-var">sysconfdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565478"><span class="hs-identifier hs-type">dirs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#sysconfdir"><span class="hs-identifier hs-var">sysconfdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565483"><span class="hs-identifier hs-type">relative</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1368"></span><span>
</span><span id="line-1369"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">sequence_</span></span><span>
</span><span id="line-1370"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#reportProgram"><span class="hs-identifier hs-type">reportProgram</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565432"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565510"><span class="hs-identifier hs-type">prog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565511"><span class="hs-identifier hs-type">configuredProg</span></a></span><span>
</span><span id="line-1371"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565510"><span class="annot"><a href="#local-6989586621679565510"><span class="hs-identifier hs-var">prog</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565511"><span class="annot"><a href="#local-6989586621679565511"><span class="hs-identifier hs-var">configuredProg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#knownPrograms"><span class="hs-identifier hs-type">knownPrograms</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565420"><span class="hs-identifier hs-type">programDb</span></a></span><span>
</span><span id="line-1372"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1373"></span><span>
</span><span id="line-1374"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679565472"><span class="hs-identifier hs-type">lbi</span></a></span><span>
</span><span id="line-1375"></span><span>
</span><span id="line-1376"></span><span class="annot"><a href="Distribution.Simple.Configure.html#mkPromisedDepsSet"><span class="hs-identifier hs-type">mkPromisedDepsSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Types.GivenComponent.html#PromisedComponent"><span class="hs-identifier hs-type">PromisedComponent</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Distribution.Types.GivenComponent.html#PromisedComponent"><span class="hs-identifier hs-type">PromisedComponent</span></a></span><span>
</span><span id="line-1377"></span><span id="mkPromisedDepsSet"><span class="annot"><span class="annottext">mkPromisedDepsSet :: [PromisedComponent]
-&gt; Map (PackageName, ComponentName) PromisedComponent
</span><a href="Distribution.Simple.Configure.html#mkPromisedDepsSet"><span class="hs-identifier hs-var hs-var">mkPromisedDepsSet</span></a></span></span><span> </span><span id="local-6989586621679565513"><span class="annot"><span class="annottext">[PromisedComponent]
</span><a href="#local-6989586621679565513"><span class="hs-identifier hs-var">comps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((PackageName, ComponentName), PromisedComponent)]
-&gt; Map (PackageName, ComponentName) PromisedComponent
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageIdentifier -&gt; PackageName
forall pkg. Package pkg =&gt; pkg -&gt; PackageName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageName"><span class="hs-identifier hs-var">packageName</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565515"><span class="hs-identifier hs-var">pn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565517"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PromisedComponent
</span><a href="#local-6989586621679565518"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679565518"><span class="annot"><span class="annottext">p :: PromisedComponent
</span><a href="#local-6989586621679565518"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.GivenComponent.html#PromisedComponent"><span class="hs-identifier hs-type">PromisedComponent</span></a></span><span> </span><span id="local-6989586621679565515"><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565515"><span class="hs-identifier hs-var">pn</span></a></span></span><span> </span><span id="local-6989586621679565517"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565517"><span class="hs-identifier hs-var">ln</span></a></span></span><span> </span><span class="annot"><span class="annottext">ComponentId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PromisedComponent]
</span><a href="#local-6989586621679565513"><span class="hs-identifier hs-var">comps</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1378"></span><span>
</span><span id="line-1379"></span><span class="hs-comment">-- | Adds the extra program paths from the flags provided to @configure@ as</span><span>
</span><span id="line-1380"></span><span class="hs-comment">-- well as specified locations for certain known programs and their default</span><span>
</span><span id="line-1381"></span><span class="hs-comment">-- arguments.</span><span>
</span><span id="line-1382"></span><span class="annot"><a href="Distribution.Simple.Configure.html#mkProgramDb"><span class="hs-identifier hs-type">mkProgramDb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-1383"></span><span id="mkProgramDb"><span class="annot"><span class="annottext">mkProgramDb :: ConfigFlags -&gt; ProgramDb -&gt; IO ProgramDb
</span><a href="Distribution.Simple.Configure.html#mkProgramDb"><span class="hs-identifier hs-var hs-var">mkProgramDb</span></a></span></span><span> </span><span id="local-6989586621679565520"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565520"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679565521"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565521"><span class="hs-identifier hs-var">initialProgramDb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1384"></span><span>  </span><span id="local-6989586621679565522"><span class="annot"><a href="#local-6989586621679565522"><span class="hs-identifier hs-var">programDb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1385"></span><span>    </span><span class="annot"><span class="annottext">(ProgramSearchPath -&gt; ProgramSearchPath) -&gt; ProgramDb -&gt; ProgramDb
</span><a href="Distribution.Simple.Program.Db.html#modifyProgramSearchPath"><span class="hs-identifier hs-var">modifyProgramSearchPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgramDb -&gt; ProgramSearchPath
</span><a href="Distribution.Simple.Program.Db.html#getProgramSearchPath"><span class="hs-identifier hs-var">getProgramSearchPath</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565521"><span class="hs-identifier hs-var">initialProgramDb</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramSearchPath -&gt; ProgramSearchPath -&gt; ProgramSearchPath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- We need to have the paths to programs installed by build-tool-depends before all other paths</span><span>
</span><span id="line-1386"></span><span>      </span><span class="annot"><span class="annottext">(ProgramDb -&gt; ProgramDb) -&gt; IO ProgramDb -&gt; IO ProgramDb
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; [ProgArg]
-&gt; [(ProgArg, Maybe ProgArg)]
-&gt; ProgramDb
-&gt; IO ProgramDb
</span><a href="Distribution.Simple.Program.Db.html#prependProgramSearchPath"><span class="hs-identifier hs-var">prependProgramSearchPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Verbosity -&gt; Flag Verbosity -&gt; Verbosity
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="Distribution.Verbosity.html#normal"><span class="hs-identifier hs-var">normal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Config.html#configVerbosity"><span class="hs-identifier hs-var">configVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565520"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679565526"><span class="hs-identifier hs-var">searchpath</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565521"><span class="hs-identifier hs-var">initialProgramDb</span></a></span><span>
</span><span id="line-1387"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span>
</span><span id="line-1388"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#userSpecifyArgss"><span class="hs-identifier hs-type">userSpecifyArgss</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configProgramArgs"><span class="hs-identifier hs-var">configProgramArgs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565520"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1389"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#userSpecifyPaths"><span class="hs-identifier hs-type">userSpecifyPaths</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configProgramPaths"><span class="hs-identifier hs-var">configProgramPaths</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565520"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1390"></span><span>    </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679565522"><span class="hs-identifier hs-type">programDb</span></a></span><span>
</span><span id="line-1391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1392"></span><span>    </span><span id="local-6989586621679565526"><span class="annot"><span class="annottext">searchpath :: [ProgArg]
</span><a href="#local-6989586621679565526"><span class="hs-identifier hs-var hs-var">searchpath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NubList ProgArg -&gt; [ProgArg]
forall a. NubList a -&gt; [a]
</span><a href="Distribution.Utils.NubList.html#fromNubList"><span class="hs-identifier hs-var">fromNubList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; NubList ProgArg
</span><a href="Distribution.Simple.Setup.Config.html#configProgramPathExtra"><span class="hs-identifier hs-var">configProgramPathExtra</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565520"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1393"></span><span>
</span><span id="line-1394"></span><span class="hs-comment">-- Note. We try as much as possible to _prepend_ rather than postpend the extra-prog-path</span><span>
</span><span id="line-1395"></span><span class="hs-comment">-- so that we can override the system path. However, in a v2-build, at this point, the &quot;system&quot; path</span><span>
</span><span id="line-1396"></span><span class="hs-comment">-- has already been extended by both the built-tools-depends paths, as well as the program-path-extra</span><span>
</span><span id="line-1397"></span><span class="hs-comment">-- so for v2 builds adding it again is entirely unnecessary. However, it needs to get added again _anyway_</span><span>
</span><span id="line-1398"></span><span class="hs-comment">-- so as to take effect for v1 builds or standalone calls to Setup.hs</span><span>
</span><span id="line-1399"></span><span class="hs-comment">-- In this instance, the lesser evil is to not allow it to override the system path.</span><span>
</span><span id="line-1400"></span><span>
</span><span id="line-1401"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1402"></span><span class="hs-comment">-- Helper functions for configure</span><span>
</span><span id="line-1403"></span><span>
</span><span id="line-1404"></span><span class="annot"><span class="hs-comment">-- | Check if the user used any deprecated flags.</span></span><span>
</span><span id="line-1405"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkDeprecatedFlags"><span class="hs-identifier hs-type">checkDeprecatedFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1406"></span><span id="checkDeprecatedFlags"><span class="annot"><span class="annottext">checkDeprecatedFlags :: Verbosity -&gt; ConfigFlags -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkDeprecatedFlags"><span class="hs-identifier hs-var hs-var">checkDeprecatedFlags</span></a></span></span><span> </span><span id="local-6989586621679565533"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565533"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565534"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1407"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configProfExe"><span class="hs-identifier hs-var">configProfExe</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Flag Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Flag Bool
forall a. Flag a
</span><a href="Distribution.Simple.Flag.html#NoFlag"><span class="hs-identifier hs-var">NoFlag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1408"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565540"><span class="annot"><span class="annottext">enable :: ProgArg
</span><a href="#local-6989586621679565540"><span class="hs-identifier hs-var hs-var">enable</span></a></span></span><span>
</span><span id="line-1409"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configProfExe"><span class="hs-identifier hs-var">configProfExe</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;enable&quot;</span></span><span>
</span><span id="line-1410"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;disable&quot;</span></span><span>
</span><span id="line-1411"></span><span>    </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-1412"></span><span>      </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565533"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1413"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;The flag --&quot;</span></span><span>
</span><span id="line-1414"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565540"><span class="hs-identifier hs-var">enable</span></a></span><span>
</span><span id="line-1415"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-executable-profiling is deprecated. &quot;</span></span><span>
</span><span id="line-1416"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Please use --&quot;</span></span><span>
</span><span id="line-1417"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565540"><span class="hs-identifier hs-var">enable</span></a></span><span>
</span><span id="line-1418"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-profiling instead.&quot;</span></span><span>
</span><span id="line-1419"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1420"></span><span>
</span><span id="line-1421"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configLibCoverage"><span class="hs-identifier hs-var">configLibCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Flag Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Flag Bool
forall a. Flag a
</span><a href="Distribution.Simple.Flag.html#NoFlag"><span class="hs-identifier hs-var">NoFlag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1422"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565546"><span class="annot"><span class="annottext">enable :: ProgArg
</span><a href="#local-6989586621679565546"><span class="hs-identifier hs-var hs-var">enable</span></a></span></span><span>
</span><span id="line-1423"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Flag Bool -&gt; Bool
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configLibCoverage"><span class="hs-identifier hs-var">configLibCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;enable&quot;</span></span><span>
</span><span id="line-1424"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;disable&quot;</span></span><span>
</span><span id="line-1425"></span><span>    </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-1426"></span><span>      </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565533"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1427"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;The flag --&quot;</span></span><span>
</span><span id="line-1428"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565546"><span class="hs-identifier hs-var">enable</span></a></span><span>
</span><span id="line-1429"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-library-coverage is deprecated. &quot;</span></span><span>
</span><span id="line-1430"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Please use --&quot;</span></span><span>
</span><span id="line-1431"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565546"><span class="hs-identifier hs-var">enable</span></a></span><span>
</span><span id="line-1432"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-coverage instead.&quot;</span></span><span>
</span><span id="line-1433"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1434"></span><span>
</span><span id="line-1435"></span><span class="hs-comment">-- | Sanity check: if '--exact-configuration' was given, ensure that the</span><span>
</span><span id="line-1436"></span><span class="hs-comment">-- complete flag assignment was specified on the command line.</span><span>
</span><span id="line-1437"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkExactConfiguration"><span class="hs-identifier hs-type">checkExactConfiguration</span></a></span><span>
</span><span id="line-1438"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1439"></span><span id="checkExactConfiguration"><span class="annot"><span class="annottext">checkExactConfiguration :: Verbosity -&gt; GenericPackageDescription -&gt; ConfigFlags -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkExactConfiguration"><span class="hs-identifier hs-var hs-var">checkExactConfiguration</span></a></span></span><span> </span><span id="local-6989586621679565547"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565547"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565548"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565548"><span class="hs-identifier hs-var">pkg_descr0</span></a></span></span><span> </span><span id="local-6989586621679565549"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565549"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1440"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configExactConfiguration"><span class="hs-identifier hs-var">configExactConfiguration</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565549"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1441"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565550"><span class="annot"><span class="annottext">cmdlineFlags :: [FlagName]
</span><a href="#local-6989586621679565550"><span class="hs-identifier hs-var hs-var">cmdlineFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FlagName, Bool) -&gt; FlagName) -&gt; [(FlagName, Bool)] -&gt; [FlagName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(FlagName, Bool) -&gt; FlagName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlagAssignment -&gt; [(FlagName, Bool)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#unFlagAssignment"><span class="hs-identifier hs-var">unFlagAssignment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; FlagAssignment
</span><a href="Distribution.Simple.Setup.Config.html#configConfigurationsFlags"><span class="hs-identifier hs-var">configConfigurationsFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565549"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1442"></span><span>        </span><span id="local-6989586621679565553"><span class="annot"><span class="annottext">allFlags :: [FlagName]
</span><a href="#local-6989586621679565553"><span class="hs-identifier hs-var hs-var">allFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PackageFlag -&gt; FlagName) -&gt; [PackageFlag] -&gt; [FlagName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">PackageFlag -&gt; FlagName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#flagName"><span class="hs-identifier hs-var">flagName</span></a></span><span> </span><span class="annot"><span class="annottext">([PackageFlag] -&gt; [FlagName])
-&gt; (GenericPackageDescription -&gt; [PackageFlag])
-&gt; GenericPackageDescription
-&gt; [FlagName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; [PackageFlag]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#genPackageFlags"><span class="hs-identifier hs-var">genPackageFlags</span></a></span><span> </span><span class="annot"><span class="annottext">(GenericPackageDescription -&gt; [FlagName])
-&gt; GenericPackageDescription -&gt; [FlagName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565548"><span class="hs-identifier hs-var">pkg_descr0</span></a></span><span>
</span><span id="line-1443"></span><span>        </span><span id="local-6989586621679565558"><span class="annot"><span class="annottext">diffFlags :: [FlagName]
</span><a href="#local-6989586621679565558"><span class="hs-identifier hs-var hs-var">diffFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FlagName]
</span><a href="#local-6989586621679565553"><span class="hs-identifier hs-var">allFlags</span></a></span><span> </span><span class="annot"><span class="annottext">[FlagName] -&gt; [FlagName] -&gt; [FlagName]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="annot"><span class="annottext">[FlagName]
</span><a href="#local-6989586621679565550"><span class="hs-identifier hs-var">cmdlineFlags</span></a></span><span>
</span><span id="line-1444"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([FlagName] -&gt; Bool) -&gt; [FlagName] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[FlagName] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([FlagName] -&gt; Bool) -&gt; [FlagName] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FlagName]
</span><a href="#local-6989586621679565558"><span class="hs-identifier hs-var">diffFlags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1445"></span><span>      </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565547"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1446"></span><span>        </span><span class="annot"><span class="annottext">[FlagName] -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#FlagsNotSpecified"><span class="hs-identifier hs-var">FlagsNotSpecified</span></a></span><span> </span><span class="annot"><span class="annottext">[FlagName]
</span><a href="#local-6989586621679565558"><span class="hs-identifier hs-var">diffFlags</span></a></span><span>
</span><span id="line-1447"></span><span>
</span><span id="line-1448"></span><span class="hs-comment">-- | Create a PackageIndex that makes *any libraries that might be*</span><span>
</span><span id="line-1449"></span><span class="hs-comment">-- defined internally to this package look like installed packages, in</span><span>
</span><span id="line-1450"></span><span class="hs-comment">-- case an executable should refer to any of them as dependencies.</span><span>
</span><span id="line-1451"></span><span class="hs-comment">--</span><span>
</span><span id="line-1452"></span><span class="hs-comment">-- It must be *any libraries that might be* defined rather than the</span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- actual definitions, because these depend on conditionals in the .cabal</span><span>
</span><span id="line-1454"></span><span class="hs-comment">-- file, and we haven't resolved them yet.  finalizePD</span><span>
</span><span id="line-1455"></span><span class="hs-comment">-- does the resolution of conditionals, and it takes internalPackageSet</span><span>
</span><span id="line-1456"></span><span class="hs-comment">-- as part of its input.</span><span>
</span><span id="line-1457"></span><span class="annot"><a href="Distribution.Simple.Configure.html#getInternalLibraries"><span class="hs-identifier hs-type">getInternalLibraries</span></a></span><span>
</span><span id="line-1458"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span>
</span><span id="line-1459"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LibraryName"><span class="hs-identifier hs-type">LibraryName</span></a></span><span>
</span><span id="line-1460"></span><span id="getInternalLibraries"><span class="annot"><span class="annottext">getInternalLibraries :: GenericPackageDescription -&gt; Set LibraryName
</span><a href="Distribution.Simple.Configure.html#getInternalLibraries"><span class="hs-identifier hs-var hs-var">getInternalLibraries</span></a></span></span><span> </span><span id="local-6989586621679565560"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565560"><span class="hs-identifier hs-var">pkg_descr0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1461"></span><span>  </span><span class="hs-comment">-- TODO: some day, executables will be fair game here too!</span><span>
</span><span id="line-1462"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565561"><span class="annot"><span class="annottext">pkg_descr :: PackageDescription
</span><a href="#local-6989586621679565561"><span class="hs-identifier hs-var hs-var">pkg_descr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; PackageDescription
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.Configuration.html#flattenPackageDescription"><span class="hs-identifier hs-var">flattenPackageDescription</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565560"><span class="hs-identifier hs-var">pkg_descr0</span></a></span><span>
</span><span id="line-1463"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[LibraryName] -&gt; Set LibraryName
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Library -&gt; LibraryName) -&gt; [Library] -&gt; [LibraryName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Library -&gt; LibraryName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#libName"><span class="hs-identifier hs-var">libName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; [Library]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#allLibraries"><span class="hs-identifier hs-var">allLibraries</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565561"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1464"></span><span>
</span><span id="line-1465"></span><span class="hs-comment">-- | Returns true if a dependency is satisfiable.  This function may</span><span>
</span><span id="line-1466"></span><span class="hs-comment">-- report a dependency satisfiable even when it is not, but not vice</span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- versa. This is to be passed to finalize</span><span>
</span><span id="line-1468"></span><span class="annot"><a href="Distribution.Simple.Configure.html#dependencySatisfiable"><span class="hs-identifier hs-type">dependencySatisfiable</span></a></span><span>
</span><span id="line-1469"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1470"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ use external internal deps?</span></span><span>
</span><span id="line-1471"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1472"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ exact configuration?</span></span><span>
</span><span id="line-1473"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1474"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ allow depending on private libs?</span></span><span>
</span><span id="line-1475"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span>
</span><span id="line-1476"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#InstalledPackageIndex"><span class="hs-identifier hs-type">InstalledPackageIndex</span></a></span><span>
</span><span id="line-1477"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ installed set</span></span><span>
</span><span id="line-1478"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LibraryName"><span class="hs-identifier hs-type">LibraryName</span></a></span><span>
</span><span id="line-1479"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ library components</span></span><span>
</span><span id="line-1480"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Distribution.Types.GivenComponent.html#PromisedComponent"><span class="hs-identifier hs-type">PromisedComponent</span></a></span><span>
</span><span id="line-1481"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span>
</span><span id="line-1482"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ required dependencies</span></span><span>
</span><span id="line-1483"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1484"></span><span id="dependencySatisfiable"><span class="annot"><span class="annottext">dependencySatisfiable :: Bool
-&gt; Bool
-&gt; Bool
-&gt; PackageName
-&gt; InstalledPackageIndex
-&gt; Set LibraryName
-&gt; Map (PackageName, ComponentName) PromisedComponent
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
-&gt; Dependency
-&gt; Bool
</span><a href="Distribution.Simple.Configure.html#dependencySatisfiable"><span class="hs-identifier hs-var hs-var">dependencySatisfiable</span></a></span></span><span>
</span><span id="line-1485"></span><span>  </span><span id="local-6989586621679565565"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565565"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span></span><span>
</span><span id="line-1486"></span><span>  </span><span id="local-6989586621679565566"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565566"><span class="hs-identifier hs-var">exact_config</span></a></span></span><span>
</span><span id="line-1487"></span><span>  </span><span id="local-6989586621679565567"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565567"><span class="hs-identifier hs-var">allow_private_deps</span></a></span></span><span>
</span><span id="line-1488"></span><span>  </span><span id="local-6989586621679565568"><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565568"><span class="hs-identifier hs-var">pn</span></a></span></span><span>
</span><span id="line-1489"></span><span>  </span><span id="local-6989586621679565569"><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565569"><span class="hs-identifier hs-var">installedPackageSet</span></a></span></span><span>
</span><span id="line-1490"></span><span>  </span><span id="local-6989586621679565570"><span class="annot"><span class="annottext">Set LibraryName
</span><a href="#local-6989586621679565570"><span class="hs-identifier hs-var">packageLibraries</span></a></span></span><span>
</span><span id="line-1491"></span><span>  </span><span id="local-6989586621679565571"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565571"><span class="hs-identifier hs-var">promisedDeps</span></a></span></span><span>
</span><span id="line-1492"></span><span>  </span><span id="local-6989586621679565572"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565572"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span></span><span>
</span><span id="line-1493"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span> </span><span id="local-6989586621679565574"><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565574"><span class="hs-identifier hs-var">depName</span></a></span></span><span> </span><span id="local-6989586621679565575"><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565575"><span class="hs-identifier hs-var">vr</span></a></span></span><span> </span><span id="local-6989586621679565576"><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565576"><span class="hs-identifier hs-var">sublibs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1494"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565566"><span class="hs-identifier hs-var">exact_config</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1495"></span><span>        </span><span class="hs-comment">-- When we're given '--exact-configuration', we assume that all</span><span>
</span><span id="line-1496"></span><span>        </span><span class="hs-comment">-- dependencies and flags are exactly specified on the command</span><span>
</span><span id="line-1497"></span><span>        </span><span class="hs-comment">-- line. Thus we only consult the 'requiredDepsMap'. Note that</span><span>
</span><span id="line-1498"></span><span>        </span><span class="hs-comment">-- we're not doing the version range check, so if there's some</span><span>
</span><span id="line-1499"></span><span>        </span><span class="hs-comment">-- dependency that wasn't specified on the command line,</span><span>
</span><span id="line-1500"></span><span>        </span><span class="hs-comment">-- 'finalizePD' will fail.</span><span>
</span><span id="line-1501"></span><span>        </span><span class="hs-comment">-- TODO: mention '--exact-configuration' in the error message</span><span>
</span><span id="line-1502"></span><span>        </span><span class="hs-comment">-- when this fails?</span><span>
</span><span id="line-1503"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565577"><span class="hs-identifier hs-var">isInternalDep</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565565"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span><span>
</span><span id="line-1504"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- Except for internal deps, when we're NOT per-component mode;</span><span>
</span><span id="line-1505"></span><span>          </span><span class="hs-comment">-- those are just True.</span><span>
</span><span id="line-1506"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565578"><span class="hs-identifier hs-var">internalDepSatisfiable</span></a></span><span>
</span><span id="line-1507"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- Backward compatibility for the old sublibrary syntax</span><span>
</span><span id="line-1508"></span><span>
</span><span id="line-1509"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565576"><span class="hs-identifier hs-var">sublibs</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName -&gt; NonEmptySet LibraryName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#mainLibSet"><span class="hs-identifier hs-var">mainLibSet</span></a></span><span>
</span><span id="line-1510"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(PackageName, ComponentName)
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#member"><span class="hs-identifier hs-var">Map.member</span></a></span><span>
</span><span id="line-1511"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565568"><span class="hs-identifier hs-var">pn</span></a></span><span>
</span><span id="line-1512"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">(LibraryName -&gt; ComponentName) -&gt; LibraryName -&gt; ComponentName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1513"></span><span>                      </span><span class="annot"><span class="annottext">UnqualComponentName -&gt; LibraryName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LSubLibName"><span class="hs-identifier hs-var">LSubLibName</span></a></span><span> </span><span class="annot"><span class="annottext">(UnqualComponentName -&gt; LibraryName)
-&gt; UnqualComponentName -&gt; LibraryName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1514"></span><span>                        </span><span class="annot"><span class="annottext">PackageName -&gt; UnqualComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnqualComponentName.html#packageNameToUnqualComponentName"><span class="hs-identifier hs-var">packageNameToUnqualComponentName</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565574"><span class="hs-identifier hs-var">depName</span></a></span><span>
</span><span id="line-1515"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-1516"></span><span>                  </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565572"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span><span>
</span><span id="line-1517"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-1518"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(LibraryName -&gt; Bool) -&gt; NonEmptySet LibraryName -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; Bool
</span><a href="#local-6989586621679565584"><span class="hs-identifier hs-var">visible</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565576"><span class="hs-identifier hs-var">sublibs</span></a></span><span>
</span><span id="line-1519"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565577"><span class="hs-identifier hs-var">isInternalDep</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1520"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565565"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span><span>
</span><span id="line-1521"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- When we are doing per-component configure, we now need to</span><span>
</span><span id="line-1522"></span><span>          </span><span class="hs-comment">-- test if the internal dependency is in the index.  This has</span><span>
</span><span id="line-1523"></span><span>          </span><span class="hs-comment">-- DIFFERENT semantics from normal dependency satisfiability.</span><span>
</span><span id="line-1524"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565585"><span class="hs-identifier hs-var">internalDepSatisfiableExternally</span></a></span><span>
</span><span id="line-1525"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- If a 'PackageName' is defined by an internal component, the dep is</span><span>
</span><span id="line-1526"></span><span>          </span><span class="hs-comment">-- satisfiable (we're going to build it ourselves)</span><span>
</span><span id="line-1527"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565578"><span class="hs-identifier hs-var">internalDepSatisfiable</span></a></span><span>
</span><span id="line-1528"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1529"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565586"><span class="hs-identifier hs-var">depSatisfiable</span></a></span><span>
</span><span id="line-1530"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1531"></span><span>      </span><span class="hs-comment">-- Internal dependency is when dependency is the same as package.</span><span>
</span><span id="line-1532"></span><span>      </span><span id="local-6989586621679565577"><span class="annot"><span class="annottext">isInternalDep :: Bool
</span><a href="#local-6989586621679565577"><span class="hs-identifier hs-var hs-var">isInternalDep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565568"><span class="hs-identifier hs-var">pn</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName -&gt; PackageName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565574"><span class="hs-identifier hs-var">depName</span></a></span><span>
</span><span id="line-1533"></span><span>
</span><span id="line-1534"></span><span>      </span><span id="local-6989586621679565586"><span class="annot"><span class="annottext">depSatisfiable :: Bool
</span><a href="#local-6989586621679565586"><span class="hs-identifier hs-var hs-var">depSatisfiable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1535"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ([(Version, [InstalledPackageInfo])] -&gt; Bool)
-&gt; [(Version, [InstalledPackageInfo])]
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Version, [InstalledPackageInfo])] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([(Version, [InstalledPackageInfo])] -&gt; Bool)
-&gt; [(Version, [InstalledPackageInfo])] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
-&gt; PackageName
-&gt; VersionRange
-&gt; [(Version, [InstalledPackageInfo])]
</span><a href="Distribution.Simple.PackageIndex.html#lookupDependency"><span class="hs-identifier hs-var">PackageIndex.lookupDependency</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565569"><span class="hs-identifier hs-var">installedPackageSet</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565574"><span class="hs-identifier hs-var">depName</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565575"><span class="hs-identifier hs-var">vr</span></a></span><span>
</span><span id="line-1536"></span><span>
</span><span id="line-1537"></span><span>      </span><span id="local-6989586621679565578"><span class="annot"><span class="annottext">internalDepSatisfiable :: Bool
</span><a href="#local-6989586621679565578"><span class="hs-identifier hs-var hs-var">internalDepSatisfiable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1538"></span><span>        </span><span class="annot"><span class="annottext">Set LibraryName -&gt; Set LibraryName -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#isSubsetOf"><span class="hs-identifier hs-var">Set.isSubsetOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmptySet LibraryName -&gt; Set LibraryName
forall a. NonEmptySet a -&gt; Set a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.NonEmptySet.html#toSet"><span class="hs-identifier hs-var">NES.toSet</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565576"><span class="hs-identifier hs-var">sublibs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set LibraryName
</span><a href="#local-6989586621679565570"><span class="hs-identifier hs-var">packageLibraries</span></a></span><span>
</span><span id="line-1539"></span><span>      </span><span id="local-6989586621679565585"><span class="annot"><span class="annottext">internalDepSatisfiableExternally :: Bool
</span><a href="#local-6989586621679565585"><span class="hs-identifier hs-var hs-var">internalDepSatisfiableExternally</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1540"></span><span>        </span><span class="annot"><span class="annottext">(LibraryName -&gt; Bool) -&gt; NonEmptySet LibraryName -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679565595"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565595"><span class="hs-identifier hs-var">ln</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Version, [InstalledPackageInfo])] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([(Version, [InstalledPackageInfo])] -&gt; Bool)
-&gt; [(Version, [InstalledPackageInfo])] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
-&gt; PackageName
-&gt; VersionRange
-&gt; LibraryName
-&gt; [(Version, [InstalledPackageInfo])]
</span><a href="Distribution.Simple.PackageIndex.html#lookupInternalDependency"><span class="hs-identifier hs-var">PackageIndex.lookupInternalDependency</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565569"><span class="hs-identifier hs-var">installedPackageSet</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565568"><span class="hs-identifier hs-var">pn</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565575"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565595"><span class="hs-identifier hs-var">ln</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565576"><span class="hs-identifier hs-var">sublibs</span></a></span><span>
</span><span id="line-1541"></span><span>
</span><span id="line-1542"></span><span>      </span><span class="hs-comment">-- Check whether a library exists and is visible.</span><span>
</span><span id="line-1543"></span><span>      </span><span class="hs-comment">-- We don't disambiguate between dependency on non-existent or private</span><span>
</span><span id="line-1544"></span><span>      </span><span class="hs-comment">-- library yet, so we just return a bool and later report a generic error.</span><span>
</span><span id="line-1545"></span><span>      </span><span id="local-6989586621679565584"><span class="annot"><span class="annottext">visible :: LibraryName -&gt; Bool
</span><a href="#local-6989586621679565584"><span class="hs-identifier hs-var hs-var">visible</span></a></span></span><span> </span><span id="local-6989586621679565600"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565600"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1546"></span><span>        </span><span class="annot"><span class="annottext">Bool
-&gt; (InstalledPackageInfo -&gt; Bool)
-&gt; Maybe InstalledPackageInfo
-&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-1547"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- Does not even exist (wasn't in the depsMap)</span><span>
</span><span id="line-1548"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565601"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565601"><span class="hs-identifier hs-var">ipi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1549"></span><span>              </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; LibraryVisibility
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#libVisibility"><span class="hs-identifier hs-var">IPI.libVisibility</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565601"><span class="hs-identifier hs-var">ipi</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryVisibility -&gt; LibraryVisibility -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LibraryVisibility
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryVisibility.html#LibraryVisibilityPublic"><span class="hs-identifier hs-var">LibraryVisibilityPublic</span></a></span><span>
</span><span id="line-1550"></span><span>                </span><span class="hs-comment">-- If the override is enabled, the visibility does</span><span>
</span><span id="line-1551"></span><span>                </span><span class="hs-comment">-- not matter (it's handled externally)</span><span>
</span><span id="line-1552"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565567"><span class="hs-identifier hs-var">allow_private_deps</span></a></span><span>
</span><span id="line-1553"></span><span>                </span><span class="hs-comment">-- If it's a library of the same package then it's</span><span>
</span><span id="line-1554"></span><span>                </span><span class="hs-comment">-- always visible.</span><span>
</span><span id="line-1555"></span><span>                </span><span class="hs-comment">-- This is only triggered when passing a component</span><span>
</span><span id="line-1556"></span><span>                </span><span class="hs-comment">-- of the same package as --dependency, such as in:</span><span>
</span><span id="line-1557"></span><span>                </span><span class="hs-comment">-- cabal-testsuite/PackageTests/ConfigureComponent/SubLib/setup-explicit.test.hs</span><span>
</span><span id="line-1558"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; PackageName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#pkgName"><span class="hs-identifier hs-var">pkgName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#sourcePackageId"><span class="hs-identifier hs-var">IPI.sourcePackageId</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565601"><span class="hs-identifier hs-var">ipi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PackageName -&gt; PackageName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565568"><span class="hs-identifier hs-var">pn</span></a></span><span>
</span><span id="line-1559"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1560"></span><span>          </span><span class="annot"><span class="annottext">Maybe InstalledPackageInfo
</span><a href="#local-6989586621679565606"><span class="hs-identifier hs-var">maybeIPI</span></a></span><span>
</span><span id="line-1561"></span><span>          </span><span class="hs-comment">-- Don't check if it's visible, we promise to build it before we need it.</span><span>
</span><span id="line-1562"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565607"><span class="hs-identifier hs-var">promised</span></a></span><span>
</span><span id="line-1563"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1564"></span><span>          </span><span id="local-6989586621679565606"><span class="annot"><span class="annottext">maybeIPI :: Maybe InstalledPackageInfo
</span><a href="#local-6989586621679565606"><span class="hs-identifier hs-var hs-var">maybeIPI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PackageName, ComponentName)
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
-&gt; Maybe InstalledPackageInfo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565574"><span class="hs-identifier hs-var">depName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565600"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565572"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span><span>
</span><span id="line-1565"></span><span>          </span><span id="local-6989586621679565607"><span class="annot"><span class="annottext">promised :: Bool
</span><a href="#local-6989586621679565607"><span class="hs-identifier hs-var hs-var">promised</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PromisedComponent -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe PromisedComponent -&gt; Bool)
-&gt; Maybe PromisedComponent -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PackageName, ComponentName)
-&gt; Map (PackageName, ComponentName) PromisedComponent
-&gt; Maybe PromisedComponent
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565574"><span class="hs-identifier hs-var">depName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565600"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565571"><span class="hs-identifier hs-var">promisedDeps</span></a></span><span>
</span><span id="line-1566"></span><span>
</span><span id="line-1567"></span><span class="hs-comment">-- | Finalize a generic package description.</span><span>
</span><span id="line-1568"></span><span class="hs-comment">--</span><span>
</span><span id="line-1569"></span><span class="hs-comment">-- The workhorse is 'finalizePD'.</span><span>
</span><span id="line-1570"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configureFinalizedPackage"><span class="hs-identifier hs-type">configureFinalizedPackage</span></a></span><span>
</span><span id="line-1571"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-1572"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-1573"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span>
</span><span id="line-1574"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageVersionConstraint.html#PackageVersionConstraint"><span class="hs-identifier hs-type">PackageVersionConstraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1575"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1576"></span><span>  </span><span class="hs-comment">-- ^ tests if a dependency is satisfiable.</span><span>
</span><span id="line-1577"></span><span>  </span><span class="hs-comment">-- Might say it's satisfiable even when not.</span><span>
</span><span id="line-1578"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-1579"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-1580"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span>
</span><span id="line-1581"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#FlagAssignment"><span class="hs-identifier hs-type">FlagAssignment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1582"></span><span id="configureFinalizedPackage"><span class="annot"><span class="annottext">configureFinalizedPackage :: Verbosity
-&gt; ConfigFlags
-&gt; ComponentRequestedSpec
-&gt; [PackageVersionConstraint]
-&gt; (Dependency -&gt; Bool)
-&gt; Compiler
-&gt; Platform
-&gt; GenericPackageDescription
-&gt; IO (PackageDescription, FlagAssignment)
</span><a href="Distribution.Simple.Configure.html#configureFinalizedPackage"><span class="hs-identifier hs-var hs-var">configureFinalizedPackage</span></a></span></span><span>
</span><span id="line-1583"></span><span>  </span><span id="local-6989586621679565615"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565615"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span>
</span><span id="line-1584"></span><span>  </span><span id="local-6989586621679565616"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565616"><span class="hs-identifier hs-var">cfg</span></a></span></span><span>
</span><span id="line-1585"></span><span>  </span><span id="local-6989586621679565617"><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565617"><span class="hs-identifier hs-var">enabled</span></a></span></span><span>
</span><span id="line-1586"></span><span>  </span><span id="local-6989586621679565618"><span class="annot"><span class="annottext">[PackageVersionConstraint]
</span><a href="#local-6989586621679565618"><span class="hs-identifier hs-var">allConstraints</span></a></span></span><span>
</span><span id="line-1587"></span><span>  </span><span id="local-6989586621679565619"><span class="annot"><span class="annottext">Dependency -&gt; Bool
</span><a href="#local-6989586621679565619"><span class="hs-identifier hs-var">satisfies</span></a></span></span><span>
</span><span id="line-1588"></span><span>  </span><span id="local-6989586621679565620"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565620"><span class="hs-identifier hs-var">comp</span></a></span></span><span>
</span><span id="line-1589"></span><span>  </span><span id="local-6989586621679565621"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565621"><span class="hs-identifier hs-var">compPlatform</span></a></span></span><span>
</span><span id="line-1590"></span><span>  </span><span id="local-6989586621679565622"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565622"><span class="hs-identifier hs-var">pkg_descr0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1591"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679565623"><span class="annot"><a href="#local-6989586621679565623"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565624"><span class="annot"><a href="#local-6989586621679565624"><span class="hs-identifier hs-var">flags</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1592"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FlagAssignment
-&gt; ComponentRequestedSpec
-&gt; (Dependency -&gt; Bool)
-&gt; Platform
-&gt; CompilerInfo
-&gt; [PackageVersionConstraint]
-&gt; GenericPackageDescription
-&gt; Either [Dependency] (PackageDescription, FlagAssignment)
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.PackageDescription.Configuration.html#finalizePD"><span class="hs-identifier hs-var">finalizePD</span></a></span><span>
</span><span id="line-1593"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; FlagAssignment
</span><a href="Distribution.Simple.Setup.Config.html#configConfigurationsFlags"><span class="hs-identifier hs-var">configConfigurationsFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565616"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1594"></span><span>        </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565617"><span class="hs-identifier hs-var">enabled</span></a></span><span>
</span><span id="line-1595"></span><span>        </span><span class="annot"><span class="annottext">Dependency -&gt; Bool
</span><a href="#local-6989586621679565619"><span class="hs-identifier hs-var">satisfies</span></a></span><span>
</span><span id="line-1596"></span><span>        </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565621"><span class="hs-identifier hs-var">compPlatform</span></a></span><span>
</span><span id="line-1597"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; CompilerInfo
</span><a href="Distribution.Simple.Compiler.html#compilerInfo"><span class="hs-identifier hs-var">compilerInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565620"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1598"></span><span>        </span><span class="annot"><span class="annottext">[PackageVersionConstraint]
</span><a href="#local-6989586621679565618"><span class="hs-identifier hs-var">allConstraints</span></a></span><span>
</span><span id="line-1599"></span><span>        </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679565622"><span class="hs-identifier hs-var">pkg_descr0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1600"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679565626"><span class="annot"><span class="annottext">(PackageDescription, FlagAssignment)
</span><a href="#local-6989586621679565626"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PackageDescription, FlagAssignment)
-&gt; IO (PackageDescription, FlagAssignment)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(PackageDescription, FlagAssignment)
</span><a href="#local-6989586621679565626"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-1601"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679565627"><span class="annot"><span class="annottext">[Dependency]
</span><a href="#local-6989586621679565627"><span class="hs-identifier hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1602"></span><span>          </span><span class="annot"><span class="annottext">Verbosity
-&gt; CabalException -&gt; IO (PackageDescription, FlagAssignment)
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565615"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO (PackageDescription, FlagAssignment))
-&gt; CabalException -&gt; IO (PackageDescription, FlagAssignment)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Dependency] -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#EncounteredMissingDependency"><span class="hs-identifier hs-var">EncounteredMissingDependency</span></a></span><span> </span><span class="annot"><span class="annottext">[Dependency]
</span><a href="#local-6989586621679565627"><span class="hs-identifier hs-var">missing</span></a></span><span>
</span><span id="line-1603"></span><span>
</span><span id="line-1604"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#nullFlagAssignment"><span class="hs-identifier hs-type">nullFlagAssignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565624"><span class="hs-identifier hs-type">flags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1605"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565615"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1606"></span><span>        </span><span class="annot"><span class="hs-string">&quot;Flags chosen: &quot;</span></span><span>
</span><span id="line-1607"></span><span>          </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">intercalate</span></span><span>
</span><span id="line-1608"></span><span>            </span><span class="annot"><span class="hs-string">&quot;, &quot;</span></span><span>
</span><span id="line-1609"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#unFlagName"><span class="hs-identifier hs-type">unFlagName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565632"><span class="hs-identifier hs-type">fn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-type">prettyShow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565633"><span class="hs-identifier hs-type">value</span></a></span><span>
</span><span id="line-1610"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565632"><span class="annot"><a href="#local-6989586621679565632"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565633"><span class="annot"><a href="#local-6989586621679565633"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Flag.html#unFlagAssignment"><span class="hs-identifier hs-type">unFlagAssignment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565624"><span class="hs-identifier hs-type">flags</span></a></span><span>
</span><span id="line-1611"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1612"></span><span>
</span><span id="line-1613"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679565623"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679565624"><span class="hs-identifier hs-type">flags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1614"></span><span>
</span><span id="line-1615"></span><span class="annot"><span class="hs-comment">-- | Check for use of Cabal features which require compiler support</span></span><span>
</span><span id="line-1616"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkCompilerProblems"><span class="hs-identifier hs-type">checkCompilerProblems</span></a></span><span>
</span><span id="line-1617"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1618"></span><span id="checkCompilerProblems"><span class="annot"><span class="annottext">checkCompilerProblems :: Verbosity
-&gt; Compiler
-&gt; PackageDescription
-&gt; ComponentRequestedSpec
-&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkCompilerProblems"><span class="hs-identifier hs-var hs-var">checkCompilerProblems</span></a></span></span><span> </span><span id="local-6989586621679565634"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565634"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565635"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565635"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679565636"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565636"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span> </span><span id="local-6989586621679565637"><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565637"><span class="hs-identifier hs-var">enabled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1619"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-1620"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.Compiler.html#renamingPackageFlagsSupported"><span class="hs-identifier hs-var">renamingPackageFlagsSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565635"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1621"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(BuildInfo -&gt; Bool) -&gt; [BuildInfo] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span>
</span><span id="line-1622"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Mixin -&gt; Bool) -&gt; [Mixin] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IncludeRenaming -&gt; Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.IncludeRenaming.html#isDefaultIncludeRenaming"><span class="hs-identifier hs-var">isDefaultIncludeRenaming</span></a></span><span> </span><span class="annot"><span class="annottext">(IncludeRenaming -&gt; Bool)
-&gt; (Mixin -&gt; IncludeRenaming) -&gt; Mixin -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Mixin -&gt; IncludeRenaming
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Mixin.html#mixinIncludeRenaming"><span class="hs-identifier hs-var">mixinIncludeRenaming</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Mixin] -&gt; Bool) -&gt; (BuildInfo -&gt; [Mixin]) -&gt; BuildInfo -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [Mixin]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#mixins"><span class="hs-identifier hs-var">mixins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1623"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; ComponentRequestedSpec -&gt; [BuildInfo]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#enabledBuildInfos"><span class="hs-identifier hs-var">enabledBuildInfos</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565636"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565637"><span class="hs-identifier hs-var">enabled</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1624"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1625"></span><span>    </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565634"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#CompilerDoesn%27tSupportThinning"><span class="hs-identifier hs-var">CompilerDoesn'tSupportThinning</span></a></span><span>
</span><span id="line-1626"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-1627"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(Library -&gt; Bool) -&gt; [Library] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Library -&gt; Bool) -&gt; Library -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ModuleReexport] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([ModuleReexport] -&gt; Bool)
-&gt; (Library -&gt; [ModuleReexport]) -&gt; Library -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Library -&gt; [ModuleReexport]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#reexportedModules"><span class="hs-identifier hs-var">reexportedModules</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; [Library]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#allLibraries"><span class="hs-identifier hs-var">allLibraries</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565636"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1628"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.Compiler.html#reexportedModulesSupported"><span class="hs-identifier hs-var">reexportedModulesSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565635"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1629"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1630"></span><span>    </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565634"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#CompilerDoesn%27tSupportReexports"><span class="hs-identifier hs-var">CompilerDoesn'tSupportReexports</span></a></span><span>
</span><span id="line-1631"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-1632"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(Library -&gt; Bool) -&gt; [Library] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Library -&gt; Bool) -&gt; Library -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; Bool)
-&gt; (Library -&gt; [ModuleName]) -&gt; Library -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Library -&gt; [ModuleName]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#signatures"><span class="hs-identifier hs-var">signatures</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; [Library]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#allLibraries"><span class="hs-identifier hs-var">allLibraries</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565636"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1633"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.Compiler.html#backpackSupported"><span class="hs-identifier hs-var">backpackSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565635"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1634"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1635"></span><span>    </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565634"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#CompilerDoesn%27tSupportBackpack"><span class="hs-identifier hs-var">CompilerDoesn'tSupportBackpack</span></a></span><span>
</span><span id="line-1636"></span><span>
</span><span id="line-1637"></span><span class="annot"><span class="hs-comment">-- | Select dependencies for the package.</span></span><span>
</span><span id="line-1638"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configureDependencies"><span class="hs-identifier hs-type">configureDependencies</span></a></span><span>
</span><span id="line-1639"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-1640"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#UseExternalInternalDeps"><span class="hs-identifier hs-type">UseExternalInternalDeps</span></a></span><span>
</span><span id="line-1641"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LibraryName"><span class="hs-identifier hs-type">LibraryName</span></a></span><span>
</span><span id="line-1642"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Distribution.Types.GivenComponent.html#PromisedComponent"><span class="hs-identifier hs-type">PromisedComponent</span></a></span><span>
</span><span id="line-1643"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#InstalledPackageIndex"><span class="hs-identifier hs-type">InstalledPackageIndex</span></a></span><span>
</span><span id="line-1644"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ installed packages</span></span><span>
</span><span id="line-1645"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span>
</span><span id="line-1646"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ required deps</span></span><span>
</span><span id="line-1647"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span>
</span><span id="line-1648"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span>
</span><span id="line-1649"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#PreExistingComponent"><span class="hs-identifier hs-type">PreExistingComponent</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#ConfiguredPromisedComponent"><span class="hs-identifier hs-type">ConfiguredPromisedComponent</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span id="configureDependencies"><span class="annot"><span class="annottext">configureDependencies :: Verbosity
-&gt; Bool
-&gt; Set LibraryName
-&gt; Map (PackageName, ComponentName) PromisedComponent
-&gt; InstalledPackageIndex
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
-&gt; PackageDescription
-&gt; ComponentRequestedSpec
-&gt; IO ([PreExistingComponent], [ConfiguredPromisedComponent])
</span><a href="Distribution.Simple.Configure.html#configureDependencies"><span class="hs-identifier hs-var hs-var">configureDependencies</span></a></span></span><span>
</span><span id="line-1651"></span><span>  </span><span id="local-6989586621679565650"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565650"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span>
</span><span id="line-1652"></span><span>  </span><span id="local-6989586621679565651"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565651"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span></span><span>
</span><span id="line-1653"></span><span>  </span><span id="local-6989586621679565652"><span class="annot"><span class="annottext">Set LibraryName
</span><a href="#local-6989586621679565652"><span class="hs-identifier hs-var">packageLibraries</span></a></span></span><span>
</span><span id="line-1654"></span><span>  </span><span id="local-6989586621679565653"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565653"><span class="hs-identifier hs-var">promisedDeps</span></a></span></span><span>
</span><span id="line-1655"></span><span>  </span><span id="local-6989586621679565654"><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565654"><span class="hs-identifier hs-var">installedPackageSet</span></a></span></span><span>
</span><span id="line-1656"></span><span>  </span><span id="local-6989586621679565655"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565655"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span></span><span>
</span><span id="line-1657"></span><span>  </span><span id="local-6989586621679565656"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565656"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span>
</span><span id="line-1658"></span><span>  </span><span id="local-6989586621679565657"><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565657"><span class="hs-identifier hs-var">enableSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1659"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679565658"><span class="hs-identifier hs-type">failedDeps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Simple.Errors.html#FailedDependency"><span class="hs-identifier hs-type">FailedDependency</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1660"></span><span>        </span><span class="annot"><a href="#local-6989586621679565659"><span class="hs-identifier hs-type">allPkgDeps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Simple.Configure.html#ResolvedDependency"><span class="hs-identifier hs-type">ResolvedDependency</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1661"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679565658"><span class="annot"><span class="annottext">[FailedDependency]
</span><a href="#local-6989586621679565658"><span class="hs-identifier hs-var hs-var">failedDeps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565659"><span class="annot"><span class="annottext">[ResolvedDependency]
</span><a href="#local-6989586621679565659"><span class="hs-identifier hs-var hs-var">allPkgDeps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1662"></span><span>          </span><span class="annot"><span class="annottext">[Either FailedDependency ResolvedDependency]
-&gt; ([FailedDependency], [ResolvedDependency])
forall a b. [Either a b] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">partitionEithers</span></span><span> </span><span class="annot"><span class="annottext">([Either FailedDependency ResolvedDependency]
 -&gt; ([FailedDependency], [ResolvedDependency]))
-&gt; [Either FailedDependency ResolvedDependency]
-&gt; ([FailedDependency], [ResolvedDependency])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1663"></span><span>            </span><span class="annot"><span class="annottext">[[Either FailedDependency ResolvedDependency]]
-&gt; [Either FailedDependency ResolvedDependency]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-1664"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(DependencyResolution -&gt; ResolvedDependency)
-&gt; Either FailedDependency DependencyResolution
-&gt; Either FailedDependency ResolvedDependency
forall a b.
(a -&gt; b) -&gt; Either FailedDependency a -&gt; Either FailedDependency b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679565666"><span class="annot"><span class="annottext">DependencyResolution
</span><a href="#local-6989586621679565666"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dependency
</span><a href="#local-6989586621679565667"><span class="hs-identifier hs-var">dep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DependencyResolution
</span><a href="#local-6989586621679565666"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either FailedDependency DependencyResolution
 -&gt; Either FailedDependency ResolvedDependency)
-&gt; [Either FailedDependency DependencyResolution]
-&gt; [Either FailedDependency ResolvedDependency]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Either FailedDependency DependencyResolution]
</span><a href="#local-6989586621679565668"><span class="hs-identifier hs-var">status</span></a></span><span>
</span><span id="line-1665"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679565667"><span class="annot"><span class="annottext">Dependency
</span><a href="#local-6989586621679565667"><span class="hs-identifier hs-var">dep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PackageDescription -&gt; ComponentRequestedSpec -&gt; [Dependency]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#enabledBuildDepends"><span class="hs-identifier hs-var">enabledBuildDepends</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565656"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679565657"><span class="hs-identifier hs-var">enableSpec</span></a></span><span>
</span><span id="line-1666"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565668"><span class="annot"><span class="annottext">status :: [Either FailedDependency DependencyResolution]
</span><a href="#local-6989586621679565668"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1667"></span><span>                      </span><span class="annot"><span class="annottext">PackageIdentifier
-&gt; Set LibraryName
-&gt; Map (PackageName, ComponentName) PromisedComponent
-&gt; InstalledPackageIndex
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
-&gt; Bool
-&gt; Dependency
-&gt; [Either FailedDependency DependencyResolution]
</span><a href="Distribution.Simple.Configure.html#selectDependency"><span class="hs-identifier hs-var">selectDependency</span></a></span><span>
</span><span id="line-1668"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#package"><span class="hs-identifier hs-var">package</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565656"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1669"></span><span>                        </span><span class="annot"><span class="annottext">Set LibraryName
</span><a href="#local-6989586621679565652"><span class="hs-identifier hs-var">packageLibraries</span></a></span><span>
</span><span id="line-1670"></span><span>                        </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565653"><span class="hs-identifier hs-var">promisedDeps</span></a></span><span>
</span><span id="line-1671"></span><span>                        </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565654"><span class="hs-identifier hs-var">installedPackageSet</span></a></span><span>
</span><span id="line-1672"></span><span>                        </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565655"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span><span>
</span><span id="line-1673"></span><span>                        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565651"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span><span>
</span><span id="line-1674"></span><span>                        </span><span class="annot"><span class="annottext">Dependency
</span><a href="#local-6989586621679565667"><span class="hs-identifier hs-var">dep</span></a></span><span>
</span><span id="line-1675"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-1676"></span><span>
</span><span id="line-1677"></span><span>        </span><span id="local-6989586621679565672"><span class="annot"><span class="annottext">internalPkgDeps :: [PackageIdentifier]
</span><a href="#local-6989586621679565672"><span class="hs-identifier hs-var hs-var hs-var">internalPkgDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1678"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565673"><span class="hs-identifier hs-var">pkgid</span></a></span><span>
</span><span id="line-1679"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dependency
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#InternalDependency"><span class="hs-identifier hs-type">InternalDependency</span></a></span><span> </span><span id="local-6989586621679565673"><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565673"><span class="hs-identifier hs-var">pkgid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedDependency]
</span><a href="#local-6989586621679565659"><span class="hs-identifier hs-var">allPkgDeps</span></a></span><span>
</span><span id="line-1680"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1681"></span><span>        </span><span class="hs-comment">-- NB: we have to SAVE the package name, because this is the only</span><span>
</span><span id="line-1682"></span><span>        </span><span class="hs-comment">-- way we can be able to resolve package names in the package</span><span>
</span><span id="line-1683"></span><span>        </span><span class="hs-comment">-- description.</span><span>
</span><span id="line-1684"></span><span>        </span><span id="local-6989586621679565675"><span class="annot"><span class="annottext">externalPkgDeps :: [PreExistingComponent]
</span><a href="#local-6989586621679565675"><span class="hs-identifier hs-var hs-var hs-var">externalPkgDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1685"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PreExistingComponent
</span><a href="#local-6989586621679565676"><span class="hs-identifier hs-var">pec</span></a></span><span>
</span><span id="line-1686"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dependency
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ExternalDependency"><span class="hs-identifier hs-type">ExternalDependency</span></a></span><span> </span><span id="local-6989586621679565676"><span class="annot"><span class="annottext">PreExistingComponent
</span><a href="#local-6989586621679565676"><span class="hs-identifier hs-var">pec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedDependency]
</span><a href="#local-6989586621679565659"><span class="hs-identifier hs-var">allPkgDeps</span></a></span><span>
</span><span id="line-1687"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1688"></span><span>
</span><span id="line-1689"></span><span>        </span><span id="local-6989586621679565678"><span class="annot"><span class="annottext">promisedPkgDeps :: [ConfiguredPromisedComponent]
</span><a href="#local-6989586621679565678"><span class="hs-identifier hs-var hs-var hs-var">promisedPkgDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1690"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConfiguredPromisedComponent
</span><a href="#local-6989586621679565679"><span class="hs-identifier hs-var">fpec</span></a></span><span>
</span><span id="line-1691"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dependency
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#PromisedDependency"><span class="hs-identifier hs-type">PromisedDependency</span></a></span><span> </span><span id="local-6989586621679565679"><span class="annot"><span class="annottext">ConfiguredPromisedComponent
</span><a href="#local-6989586621679565679"><span class="hs-identifier hs-var">fpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedDependency]
</span><a href="#local-6989586621679565659"><span class="hs-identifier hs-var">allPkgDeps</span></a></span><span>
</span><span id="line-1692"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-1693"></span><span>
</span><span id="line-1694"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-1695"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PackageIdentifier] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PackageIdentifier]
</span><a href="#local-6989586621679565672"><span class="hs-identifier hs-var">internalPkgDeps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1696"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; Bool
</span><a href="Distribution.Backpack.ConfiguredComponent.html#newPackageDepsBehaviour"><span class="hs-identifier hs-var">newPackageDepsBehaviour</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679565656"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1698"></span><span>      </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565650"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1699"></span><span>      </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PackageIdentifier] -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#LibraryWithinSamePackage"><span class="hs-identifier hs-var">LibraryWithinSamePackage</span></a></span><span> </span><span class="annot"><span class="annottext">[PackageIdentifier]
</span><a href="#local-6989586621679565672"><span class="hs-identifier hs-var">internalPkgDeps</span></a></span><span>
</span><span id="line-1700"></span><span>    </span><span class="annot"><span class="annottext">Verbosity -&gt; [FailedDependency] -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#reportFailedDependencies"><span class="hs-identifier hs-var">reportFailedDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565650"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">[FailedDependency]
</span><a href="#local-6989586621679565658"><span class="hs-identifier hs-var">failedDeps</span></a></span><span>
</span><span id="line-1701"></span><span>    </span><span class="annot"><span class="annottext">Verbosity -&gt; [ResolvedDependency] -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#reportSelectedDependencies"><span class="hs-identifier hs-var">reportSelectedDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565650"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">[ResolvedDependency]
</span><a href="#local-6989586621679565659"><span class="hs-identifier hs-var">allPkgDeps</span></a></span><span>
</span><span id="line-1702"></span><span>
</span><span id="line-1703"></span><span>    </span><span class="annot"><span class="annottext">([PreExistingComponent], [ConfiguredPromisedComponent])
-&gt; IO ([PreExistingComponent], [ConfiguredPromisedComponent])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PreExistingComponent]
</span><a href="#local-6989586621679565675"><span class="hs-identifier hs-var">externalPkgDeps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConfiguredPromisedComponent]
</span><a href="#local-6989586621679565678"><span class="hs-identifier hs-var">promisedPkgDeps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1704"></span><span>
</span><span id="line-1705"></span><span class="hs-comment">-- | Select and apply coverage settings for the build based on the</span><span>
</span><span id="line-1706"></span><span class="hs-comment">-- 'ConfigFlags' and 'Compiler'.</span><span>
</span><span id="line-1707"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configureCoverage"><span class="hs-identifier hs-type">configureCoverage</span></a></span><span>
</span><span id="line-1708"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-1709"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-1710"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-1711"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#BuildOptions"><span class="hs-identifier hs-type">LBC.BuildOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#BuildOptions"><span class="hs-identifier hs-type">LBC.BuildOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1712"></span><span id="configureCoverage"><span class="annot"><span class="annottext">configureCoverage :: Verbosity
-&gt; ConfigFlags -&gt; Compiler -&gt; IO (BuildOptions -&gt; BuildOptions)
</span><a href="Distribution.Simple.Configure.html#configureCoverage"><span class="hs-identifier hs-var hs-var">configureCoverage</span></a></span></span><span> </span><span id="local-6989586621679565686"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565686"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565687"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565687"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679565688"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565688"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1713"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565689"><span class="annot"><span class="annottext">tryExeCoverage :: Bool
</span><a href="#local-6989586621679565689"><span class="hs-identifier hs-var hs-var">tryExeCoverage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configCoverage"><span class="hs-identifier hs-var">configCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565687"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1714"></span><span>      </span><span id="local-6989586621679565692"><span class="annot"><span class="annottext">tryLibCoverage :: Bool
</span><a href="#local-6989586621679565692"><span class="hs-identifier hs-var hs-var">tryLibCoverage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1715"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span>
</span><span id="line-1716"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565689"><span class="hs-identifier hs-var">tryExeCoverage</span></a></span><span>
</span><span id="line-1717"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag Bool -&gt; Flag Bool -&gt; Flag Bool
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configCoverage"><span class="hs-identifier hs-var">configCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565687"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configLibCoverage"><span class="hs-identifier hs-var">configLibCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565687"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1718"></span><span>  </span><span class="hs-comment">-- TODO: Should we also enforce something here on that --coverage-for cannot</span><span>
</span><span id="line-1719"></span><span>  </span><span class="hs-comment">-- include indefinite components or instantiations?</span><span>
</span><span id="line-1720"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.Compiler.html#coverageSupported"><span class="hs-identifier hs-var">coverageSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565688"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1721"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1722"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565694"><span class="annot"><span class="annottext">apply :: BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565694"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679565695"><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565695"><span class="hs-identifier hs-var">buildOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1723"></span><span>            </span><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565695"><span class="hs-identifier hs-var">buildOptions</span></a></span><span>
</span><span id="line-1724"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#libCoverage"><span class="hs-identifier hs-var">LBC.libCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565692"><span class="hs-identifier hs-type">tryLibCoverage</span></a></span><span>
</span><span id="line-1725"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#exeCoverage"><span class="hs-identifier hs-var">LBC.exeCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565689"><span class="hs-identifier hs-type">tryExeCoverage</span></a></span><span>
</span><span id="line-1726"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-1727"></span><span>      </span><span class="annot"><span class="annottext">(BuildOptions -&gt; BuildOptions) -&gt; IO (BuildOptions -&gt; BuildOptions)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565694"><span class="hs-identifier hs-var">apply</span></a></span><span>
</span><span id="line-1728"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1729"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565696"><span class="annot"><span class="annottext">apply :: BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565696"><span class="hs-identifier hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679565697"><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565697"><span class="hs-identifier hs-var">buildOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1730"></span><span>            </span><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565697"><span class="hs-identifier hs-var">buildOptions</span></a></span><span>
</span><span id="line-1731"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#libCoverage"><span class="hs-identifier hs-var">LBC.libCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-1732"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#exeCoverage"><span class="hs-identifier hs-var">LBC.exeCoverage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-1733"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-1734"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565689"><span class="hs-identifier hs-var">tryExeCoverage</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565692"><span class="hs-identifier hs-var">tryLibCoverage</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1735"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-1736"></span><span>          </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565686"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1737"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;The compiler &quot;</span></span><span>
</span><span id="line-1738"></span><span>              </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; ProgArg
</span><a href="Distribution.Simple.Compiler.html#showCompilerId"><span class="hs-identifier hs-var">showCompilerId</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565688"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1739"></span><span>              </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; does not support &quot;</span></span><span>
</span><span id="line-1740"></span><span>              </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;program coverage. Program coverage has been disabled.&quot;</span></span><span>
</span><span id="line-1741"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1742"></span><span>      </span><span class="annot"><span class="annottext">(BuildOptions -&gt; BuildOptions) -&gt; IO (BuildOptions -&gt; BuildOptions)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565696"><span class="hs-identifier hs-var">apply</span></a></span><span>
</span><span id="line-1743"></span><span>
</span><span id="line-1744"></span><span class="hs-comment">-- | Compute the effective value of the profiling flags</span><span>
</span><span id="line-1745"></span><span class="hs-comment">-- @--enable-library-profiling@ and @--enable-executable-profiling@</span><span>
</span><span id="line-1746"></span><span class="hs-comment">-- from the specified 'ConfigFlags'.  This may be useful for</span><span>
</span><span id="line-1747"></span><span class="hs-comment">-- external Cabal tools which need to interact with Setup in</span><span>
</span><span id="line-1748"></span><span class="hs-comment">-- a backwards-compatible way: the most predictable mechanism</span><span>
</span><span id="line-1749"></span><span class="hs-comment">-- for enabling profiling across many legacy versions is to</span><span>
</span><span id="line-1750"></span><span class="hs-comment">-- NOT use @--enable-profiling@ and use those two flags instead.</span><span>
</span><span id="line-1751"></span><span class="hs-comment">--</span><span>
</span><span id="line-1752"></span><span class="hs-comment">-- Note that @--enable-executable-profiling@ also affects profiling</span><span>
</span><span id="line-1753"></span><span class="hs-comment">-- of benchmarks and (non-detailed) test suites.</span><span>
</span><span id="line-1754"></span><span class="annot"><a href="Distribution.Simple.Configure.html#computeEffectiveProfiling"><span class="hs-identifier hs-type">computeEffectiveProfiling</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">{- lib vanilla-}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">{- lib shared -}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">{- exe -}</span><span class="hs-special">)</span><span>
</span><span id="line-1755"></span><span id="computeEffectiveProfiling"><span class="annot"><span class="annottext">computeEffectiveProfiling :: ConfigFlags -&gt; (Bool, Bool, Bool)
</span><a href="Distribution.Simple.Configure.html#computeEffectiveProfiling"><span class="hs-identifier hs-var hs-var">computeEffectiveProfiling</span></a></span></span><span> </span><span id="local-6989586621679565698"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565698"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1756"></span><span>  </span><span class="hs-comment">-- The --profiling flag sets the default for both libs and exes,</span><span>
</span><span id="line-1757"></span><span>  </span><span class="hs-comment">-- but can be overridden by --library-profiling, or the old deprecated</span><span>
</span><span id="line-1758"></span><span>  </span><span class="hs-comment">-- --executable-profiling flag.</span><span>
</span><span id="line-1759"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-1760"></span><span>  </span><span class="hs-comment">-- The --profiling-detail and --library-profiling-detail flags behave</span><span>
</span><span id="line-1761"></span><span>  </span><span class="hs-comment">-- similarly</span><span>
</span><span id="line-1762"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565699"><span class="annot"><span class="annottext">dynamicExe :: Bool
</span><a href="#local-6989586621679565699"><span class="hs-identifier hs-var hs-var">dynamicExe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configDynExe"><span class="hs-identifier hs-var">configDynExe</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565698"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1763"></span><span>      </span><span id="local-6989586621679565701"><span class="annot"><span class="annottext">tryExeProfiling :: Bool
</span><a href="#local-6989586621679565701"><span class="hs-identifier hs-var hs-var">tryExeProfiling</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1764"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span>
</span><span id="line-1765"></span><span>          </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1766"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag Bool -&gt; Flag Bool -&gt; Flag Bool
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configProf"><span class="hs-identifier hs-var">configProf</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565698"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configProfExe"><span class="hs-identifier hs-var">configProfExe</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565698"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1767"></span><span>      </span><span id="local-6989586621679565703"><span class="annot"><span class="annottext">tryLibProfiling :: Bool
</span><a href="#local-6989586621679565703"><span class="hs-identifier hs-var hs-var">tryLibProfiling</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1768"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span>
</span><span id="line-1769"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565701"><span class="hs-identifier hs-var">tryExeProfiling</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565699"><span class="hs-identifier hs-var">dynamicExe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1770"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configProfLib"><span class="hs-identifier hs-var">configProfLib</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565698"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1771"></span><span>      </span><span id="local-6989586621679565705"><span class="annot"><span class="annottext">tryLibProfilingShared :: Bool
</span><a href="#local-6989586621679565705"><span class="hs-identifier hs-var hs-var">tryLibProfilingShared</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1772"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Flag Bool -&gt; Bool
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span>
</span><span id="line-1773"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565701"><span class="hs-identifier hs-var">tryExeProfiling</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565699"><span class="hs-identifier hs-var">dynamicExe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1774"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag Bool
</span><a href="Distribution.Simple.Setup.Config.html#configProfShared"><span class="hs-identifier hs-var">configProfShared</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565698"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1775"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565703"><span class="hs-identifier hs-var">tryLibProfiling</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565705"><span class="hs-identifier hs-var">tryLibProfilingShared</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565701"><span class="hs-identifier hs-var">tryExeProfiling</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1776"></span><span>
</span><span id="line-1777"></span><span class="hs-comment">-- | Select and apply profiling settings for the build based on the</span><span>
</span><span id="line-1778"></span><span class="hs-comment">-- 'ConfigFlags' and 'Compiler'.</span><span>
</span><span id="line-1779"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configureProfiling"><span class="hs-identifier hs-type">configureProfiling</span></a></span><span>
</span><span id="line-1780"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-1781"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-1782"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-1783"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#BuildOptions"><span class="hs-identifier hs-type">LBC.BuildOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#BuildOptions"><span class="hs-identifier hs-type">LBC.BuildOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1784"></span><span id="configureProfiling"><span class="annot"><span class="annottext">configureProfiling :: Verbosity
-&gt; ConfigFlags -&gt; Compiler -&gt; IO (BuildOptions -&gt; BuildOptions)
</span><a href="Distribution.Simple.Configure.html#configureProfiling"><span class="hs-identifier hs-var hs-var">configureProfiling</span></a></span></span><span> </span><span id="local-6989586621679565707"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565707"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565708"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565708"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621679565709"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565709"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1785"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565710"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565710"><span class="hs-identifier hs-var hs-var">tryLibProfiling</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565711"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565711"><span class="hs-identifier hs-var hs-var">tryLibProfilingShared</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565712"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565712"><span class="hs-identifier hs-var hs-var">tryExeProfiling</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; (Bool, Bool, Bool)
</span><a href="Distribution.Simple.Configure.html#computeEffectiveProfiling"><span class="hs-identifier hs-var">computeEffectiveProfiling</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565708"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-1786"></span><span>
</span><span id="line-1787"></span><span>      </span><span id="local-6989586621679565713"><span class="annot"><span class="annottext">tryExeProfileLevel :: ProfDetailLevel
</span><a href="#local-6989586621679565713"><span class="hs-identifier hs-var hs-var hs-var">tryExeProfileLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1788"></span><span>        </span><span class="annot"><span class="annottext">ProfDetailLevel -&gt; Flag ProfDetailLevel -&gt; ProfDetailLevel
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span>
</span><span id="line-1789"></span><span>          </span><span class="annot"><span class="annottext">ProfDetailLevel
</span><a href="Distribution.Simple.Compiler.html#ProfDetailDefault"><span class="hs-identifier hs-var">ProfDetailDefault</span></a></span><span>
</span><span id="line-1790"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag ProfDetailLevel
</span><a href="Distribution.Simple.Setup.Config.html#configProfDetail"><span class="hs-identifier hs-var">configProfDetail</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565708"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1791"></span><span>      </span><span id="local-6989586621679565717"><span class="annot"><span class="annottext">tryLibProfileLevel :: ProfDetailLevel
</span><a href="#local-6989586621679565717"><span class="hs-identifier hs-var hs-var hs-var">tryLibProfileLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1792"></span><span>        </span><span class="annot"><span class="annottext">ProfDetailLevel -&gt; Flag ProfDetailLevel -&gt; ProfDetailLevel
forall a. a -&gt; Flag a -&gt; a
</span><a href="Distribution.Simple.Flag.html#fromFlagOrDefault"><span class="hs-identifier hs-var">fromFlagOrDefault</span></a></span><span>
</span><span id="line-1793"></span><span>          </span><span class="annot"><span class="annottext">ProfDetailLevel
</span><a href="Distribution.Simple.Compiler.html#ProfDetailDefault"><span class="hs-identifier hs-var">ProfDetailDefault</span></a></span><span>
</span><span id="line-1794"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Flag ProfDetailLevel
-&gt; Flag ProfDetailLevel -&gt; Flag ProfDetailLevel
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span>
</span><span id="line-1795"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag ProfDetailLevel
</span><a href="Distribution.Simple.Setup.Config.html#configProfDetail"><span class="hs-identifier hs-var">configProfDetail</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565708"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1796"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfigFlags -&gt; Flag ProfDetailLevel
</span><a href="Distribution.Simple.Setup.Config.html#configProfLibDetail"><span class="hs-identifier hs-var">configProfLibDetail</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679565708"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1797"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1798"></span><span>
</span><span id="line-1799"></span><span>      </span><span id="local-6989586621679565726"><span class="annot"><span class="annottext">checkProfileLevel :: ProfDetailLevel -&gt; IO ProfDetailLevel
</span><a href="#local-6989586621679565726"><span class="hs-identifier hs-var hs-var hs-var">checkProfileLevel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Compiler.html#ProfDetailOther"><span class="hs-identifier hs-type">ProfDetailOther</span></a></span><span> </span><span id="local-6989586621679565728"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565728"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1800"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-1801"></span><span>          </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565707"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1802"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Unknown profiling detail level '&quot;</span></span><span>
</span><span id="line-1803"></span><span>              </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565728"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-1804"></span><span>              </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;', using default.\nThe profiling detail levels are: &quot;</span></span><span>
</span><span id="line-1805"></span><span>              </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; ProgArg
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span>
</span><span id="line-1806"></span><span>                </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;, &quot;</span></span><span>
</span><span id="line-1807"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565729"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565729"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565729"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProfDetailLevel
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(ProgArg, [ProgArg], ProfDetailLevel)]
</span><a href="Distribution.Simple.Compiler.html#knownProfDetailLevels"><span class="hs-identifier hs-var">knownProfDetailLevels</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1808"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1809"></span><span>        </span><span class="annot"><span class="annottext">ProfDetailLevel -&gt; IO ProfDetailLevel
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ProfDetailLevel
</span><a href="Distribution.Simple.Compiler.html#ProfDetailDefault"><span class="hs-identifier hs-var">ProfDetailDefault</span></a></span><span>
</span><span id="line-1810"></span><span>      </span><span class="annot"><a href="#local-6989586621679565726"><span class="hs-identifier hs-var">checkProfileLevel</span></a></span><span> </span><span id="local-6989586621679565731"><span class="annot"><span class="annottext">ProfDetailLevel
</span><a href="#local-6989586621679565731"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfDetailLevel -&gt; IO ProfDetailLevel
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ProfDetailLevel
</span><a href="#local-6989586621679565731"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-1811"></span><span>
</span><span id="line-1812"></span><span>  </span><span id="local-6989586621679565732"><span class="annot"><a href="#local-6989586621679565732"><span class="hs-identifier hs-var">applyProfiling</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1813"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.Compiler.html#profilingSupported"><span class="hs-identifier hs-var">profilingSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565709"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.Compiler.html#profilingVanillaSupportedOrUnknown"><span class="hs-identifier hs-var">profilingVanillaSupportedOrUnknown</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565709"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.Compiler.html#profilingDynamicSupportedOrUnknown"><span class="hs-identifier hs-var">profilingDynamicSupportedOrUnknown</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565709"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1814"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1815"></span><span>        </span><span id="local-6989586621679565736"><span class="annot"><a href="#local-6989586621679565736"><span class="hs-identifier hs-var">exeLevel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProfDetailLevel -&gt; IO ProfDetailLevel
</span><a href="#local-6989586621679565726"><span class="hs-identifier hs-var">checkProfileLevel</span></a></span><span> </span><span class="annot"><span class="annottext">ProfDetailLevel
</span><a href="#local-6989586621679565713"><span class="hs-identifier hs-var">tryExeProfileLevel</span></a></span><span>
</span><span id="line-1816"></span><span>        </span><span id="local-6989586621679565737"><span class="annot"><a href="#local-6989586621679565737"><span class="hs-identifier hs-var">libLevel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679565726"><span class="hs-identifier hs-type">checkProfileLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565717"><span class="hs-identifier hs-type">tryLibProfileLevel</span></a></span><span>
</span><span id="line-1817"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565738"><span class="annot"><a href="#local-6989586621679565738"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679565739"><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565739"><span class="hs-identifier hs-var">buildOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1818"></span><span>              </span><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565739"><span class="hs-identifier hs-var">buildOptions</span></a></span><span>
</span><span id="line-1819"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLib"><span class="hs-identifier hs-var">LBC.withProfLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565710"><span class="hs-identifier hs-type">tryLibProfiling</span></a></span><span>
</span><span id="line-1820"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLibDetail"><span class="hs-identifier hs-var">LBC.withProfLibDetail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565737"><span class="hs-identifier hs-type">libLevel</span></a></span><span>
</span><span id="line-1821"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfExe"><span class="hs-identifier hs-var">LBC.withProfExe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565712"><span class="hs-identifier hs-type">tryExeProfiling</span></a></span><span>
</span><span id="line-1822"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfExeDetail"><span class="hs-identifier hs-var">LBC.withProfExeDetail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565736"><span class="hs-identifier hs-type">exeLevel</span></a></span><span>
</span><span id="line-1823"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-1824"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565740"><span class="annot"><a href="#local-6989586621679565740"><span class="hs-identifier hs-var hs-var">compilerSupportsProfilingDynamic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Bool
</span><a href="Distribution.Simple.Compiler.html#profilingDynamicSupportedOrUnknown"><span class="hs-identifier hs-var">profilingDynamicSupportedOrUnknown</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565709"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1825"></span><span>        </span><span id="local-6989586621679565741"><span class="annot"><a href="#local-6989586621679565741"><span class="hs-identifier hs-var">apply2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1826"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679565740"><span class="hs-identifier hs-type">compilerSupportsProfilingDynamic</span></a></span><span>
</span><span id="line-1827"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- Case 1: We support profiled shared libraries so turn on shared profiling</span><span>
</span><span id="line-1828"></span><span>            </span><span class="hs-comment">-- libraries if the user asked for it.</span><span>
</span><span id="line-1829"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565742"><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565742"><span class="hs-identifier hs-var">buildOptions</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565738"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565742"><span class="hs-identifier hs-var">buildOptions</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLibShared"><span class="hs-identifier hs-var">LBC.withProfLibShared</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679565711"><span class="hs-identifier hs-type">tryLibProfilingShared</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1830"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- Case 2: Compiler doesn't support profiling shared so turn them off</span><span>
</span><span id="line-1831"></span><span>            </span><span class="hs-keyword">do</span><span>
</span><span id="line-1832"></span><span>              </span><span class="hs-comment">-- If we wanted to enable profiling shared libraries.. tell the</span><span>
</span><span id="line-1833"></span><span>              </span><span class="hs-comment">-- user we couldn't.</span><span>
</span><span id="line-1834"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Compiler.html#profilingVanillaSupportedOrUnknown"><span class="hs-identifier hs-type">profilingVanillaSupportedOrUnknown</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565709"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621679565711"><span class="hs-identifier hs-type">tryLibProfilingShared</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1835"></span><span>                </span><span class="annot"><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-type">warn</span></a></span><span>
</span><span id="line-1836"></span><span>                  </span><span class="annot"><a href="#local-6989586621679565707"><span class="hs-identifier hs-type">verbosity</span></a></span><span>
</span><span id="line-1837"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-string">&quot;The compiler &quot;</span></span><span>
</span><span id="line-1838"></span><span>                      </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#showCompilerId"><span class="hs-identifier hs-type">showCompilerId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565709"><span class="hs-identifier hs-type">comp</span></a></span><span>
</span><span id="line-1839"></span><span>                      </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; does not support &quot;</span></span><span>
</span><span id="line-1840"></span><span>                      </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;profiling shared objects. Static profiled objects &quot;</span></span><span>
</span><span id="line-1841"></span><span>                      </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;will be built.&quot;</span></span><span>
</span><span id="line-1842"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-1843"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565743"><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565743"><span class="hs-identifier hs-var">buildOptions</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1844"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565744"><span class="annot"><span class="annottext">original_options :: BuildOptions
</span><a href="#local-6989586621679565744"><span class="hs-identifier hs-var hs-var">original_options</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565738"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565743"><span class="hs-identifier hs-var">buildOptions</span></a></span><span>
</span><span id="line-1845"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565744"><span class="hs-identifier hs-var">original_options</span></a></span><span>
</span><span id="line-1846"></span><span>                      </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLibShared"><span class="hs-identifier hs-var">LBC.withProfLibShared</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-1847"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLib"><span class="hs-identifier hs-var">LBC.withProfLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#profilingVanillaSupportedOrUnknown"><span class="hs-identifier hs-type">profilingVanillaSupportedOrUnknown</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565709"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679565711"><span class="hs-identifier hs-type">tryLibProfilingShared</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLib"><span class="hs-identifier hs-var">LBC.withProfLib</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565744"><span class="hs-identifier hs-type">original_options</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1848"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withDynExe"><span class="hs-identifier hs-var">LBC.withDynExe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfExe"><span class="hs-identifier hs-var">LBC.withProfExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565744"><span class="hs-identifier hs-type">original_options</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withDynExe"><span class="hs-identifier hs-var">LBC.withDynExe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565744"><span class="hs-identifier hs-type">original_options</span></a></span><span>
</span><span id="line-1849"></span><span>                      </span><span class="hs-special">}</span><span>
</span><span id="line-1850"></span><span>
</span><span id="line-1851"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679565712"><span class="hs-identifier hs-type">tryExeProfiling</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679565710"><span class="hs-identifier hs-type">tryLibProfiling</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621679565711"><span class="hs-identifier hs-type">tryLibProfilingShared</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1852"></span><span>          </span><span class="annot"><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-type">warn</span></a></span><span>
</span><span id="line-1853"></span><span>            </span><span class="annot"><a href="#local-6989586621679565707"><span class="hs-identifier hs-type">verbosity</span></a></span><span>
</span><span id="line-1854"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-string">&quot;Executables will be built with profiling, but library &quot;</span></span><span>
</span><span id="line-1855"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;profiling is disabled. Linking will fail if any executables &quot;</span></span><span>
</span><span id="line-1856"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;depend on the library.&quot;</span></span><span>
</span><span id="line-1857"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-1858"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679565741"><span class="hs-identifier hs-type">apply2</span></a></span><span>
</span><span id="line-1859"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1860"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565745"><span class="annot"><span class="annottext">apply :: BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565745"><span class="hs-identifier hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679565746"><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565746"><span class="hs-identifier hs-var">buildOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1861"></span><span>              </span><span class="annot"><span class="annottext">BuildOptions
</span><a href="#local-6989586621679565746"><span class="hs-identifier hs-var">buildOptions</span></a></span><span>
</span><span id="line-1862"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLib"><span class="hs-identifier hs-var">LBC.withProfLib</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-1863"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLibShared"><span class="hs-identifier hs-var">LBC.withProfLibShared</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-1864"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfLibDetail"><span class="hs-identifier hs-var">LBC.withProfLibDetail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#ProfDetailNone"><span class="hs-identifier hs-type">ProfDetailNone</span></a></span><span>
</span><span id="line-1865"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfExe"><span class="hs-identifier hs-var">LBC.withProfExe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-1866"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildConfig.html#withProfExeDetail"><span class="hs-identifier hs-var">LBC.withProfExeDetail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#ProfDetailNone"><span class="hs-identifier hs-type">ProfDetailNone</span></a></span><span>
</span><span id="line-1867"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-1868"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565712"><span class="hs-identifier hs-var">tryExeProfiling</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565710"><span class="hs-identifier hs-var">tryLibProfiling</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1869"></span><span>          </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span>
</span><span id="line-1870"></span><span>            </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565707"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-1871"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;The compiler &quot;</span></span><span>
</span><span id="line-1872"></span><span>                </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; ProgArg
</span><a href="Distribution.Simple.Compiler.html#showCompilerId"><span class="hs-identifier hs-var">showCompilerId</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565709"><span class="hs-identifier hs-var">comp</span></a></span><span>
</span><span id="line-1873"></span><span>                </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; does not support &quot;</span></span><span>
</span><span id="line-1874"></span><span>                </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;profiling. Profiling has been disabled.&quot;</span></span><span>
</span><span id="line-1875"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-1876"></span><span>        </span><span class="annot"><span class="annottext">(BuildOptions -&gt; BuildOptions) -&gt; IO (BuildOptions -&gt; BuildOptions)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BuildOptions -&gt; BuildOptions
</span><a href="#local-6989586621679565745"><span class="hs-identifier hs-var">apply</span></a></span><span>
</span><span id="line-1877"></span><span>
</span><span id="line-1878"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679565732"><span class="hs-identifier hs-type">applyProfiling</span></a></span><span>
</span><span id="line-1879"></span><span>
</span><span id="line-1880"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-1881"></span><span class="hs-comment">-- Configuring package dependencies</span><span>
</span><span id="line-1882"></span><span>
</span><span id="line-1883"></span><span class="annot"><a href="Distribution.Simple.Configure.html#reportProgram"><span class="hs-identifier hs-type">reportProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Types.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Types.html#ConfiguredProgram"><span class="hs-identifier hs-type">ConfiguredProgram</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1884"></span><span id="reportProgram"><span class="annot"><span class="annottext">reportProgram :: Verbosity -&gt; Program -&gt; Maybe ConfiguredProgram -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#reportProgram"><span class="hs-identifier hs-var hs-var">reportProgram</span></a></span></span><span> </span><span id="local-6989586621679565747"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565747"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565748"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679565748"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe ConfiguredProgram
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1885"></span><span>  </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565747"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; IO ()) -&gt; ProgArg -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;No &quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Program -&gt; ProgArg
</span><a href="Distribution.Simple.Program.Types.html#programName"><span class="hs-identifier hs-var">programName</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679565748"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; found&quot;</span></span><span>
</span><span id="line-1886"></span><span class="annot"><a href="Distribution.Simple.Configure.html#reportProgram"><span class="hs-identifier hs-var">reportProgram</span></a></span><span> </span><span id="local-6989586621679565750"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565750"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565751"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679565751"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565752"><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565752"><span class="hs-identifier hs-var">configuredProg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1887"></span><span>  </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565750"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; IO ()) -&gt; ProgArg -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Using &quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Program -&gt; ProgArg
</span><a href="Distribution.Simple.Program.Types.html#programName"><span class="hs-identifier hs-var">programName</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679565751"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565753"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565754"><span class="hs-identifier hs-var">location</span></a></span><span>
</span><span id="line-1888"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1889"></span><span>    </span><span id="local-6989586621679565754"><span class="annot"><span class="annottext">location :: ProgArg
</span><a href="#local-6989586621679565754"><span class="hs-identifier hs-var hs-var">location</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; ProgramLocation
</span><a href="Distribution.Simple.Program.Types.html#programLocation"><span class="hs-identifier hs-var">programLocation</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565752"><span class="hs-identifier hs-var">configuredProg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1890"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Program.Types.html#FoundOnSystem"><span class="hs-identifier hs-type">FoundOnSystem</span></a></span><span> </span><span id="local-6989586621679565760"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565760"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; found on system at: &quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565760"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1891"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Program.Types.html#UserSpecified"><span class="hs-identifier hs-type">UserSpecified</span></a></span><span> </span><span id="local-6989586621679565762"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565762"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; given by user at: &quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565762"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1892"></span><span>    </span><span id="local-6989586621679565753"><span class="annot"><span class="annottext">version :: ProgArg
</span><a href="#local-6989586621679565753"><span class="hs-identifier hs-var hs-var">version</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; Maybe Version
</span><a href="Distribution.Simple.Program.Types.html#programVersion"><span class="hs-identifier hs-var">programVersion</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565752"><span class="hs-identifier hs-var">configuredProg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1893"></span><span>      </span><span class="annot"><span class="annottext">Maybe Version
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-1894"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565769"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679565769"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; version &quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Version -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679565769"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1895"></span><span>
</span><span id="line-1896"></span><span class="annot"><a href="Distribution.Simple.Configure.html#hackageUrl"><span class="hs-identifier hs-type">hackageUrl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-1897"></span><span id="hackageUrl"><span class="annot"><span class="annottext">hackageUrl :: ProgArg
</span><a href="Distribution.Simple.Configure.html#hackageUrl"><span class="hs-identifier hs-var hs-var">hackageUrl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;http://hackage.haskell.org/package/&quot;</span></span><span>
</span><span id="line-1898"></span><span>
</span><span id="line-1899"></span><span class="hs-keyword">type</span><span> </span><span id="ResolvedDependency"><span class="annot"><a href="Distribution.Simple.Configure.html#ResolvedDependency"><span class="hs-identifier hs-var">ResolvedDependency</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#DependencyResolution"><span class="hs-identifier hs-type">DependencyResolution</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1900"></span><span>
</span><span id="line-1901"></span><span class="hs-keyword">data</span><span> </span><span id="DependencyResolution"><span class="annot"><a href="Distribution.Simple.Configure.html#DependencyResolution"><span class="hs-identifier hs-var">DependencyResolution</span></a></span></span><span>
</span><span id="line-1902"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | An external dependency from the package database, OR an</span><span>
</span><span id="line-1903"></span><span>    </span><span class="hs-comment">-- internal dependency which we are getting from the package</span><span>
</span><span id="line-1904"></span><span>    </span><span class="hs-comment">-- database.</span><span>
</span><span id="line-1905"></span><span>    </span><span id="ExternalDependency"><span class="annot"><a href="Distribution.Simple.Configure.html#ExternalDependency"><span class="hs-identifier hs-var">ExternalDependency</span></a></span></span><span> </span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#PreExistingComponent"><span class="hs-identifier hs-type">PreExistingComponent</span></a></span><span>
</span><span id="line-1906"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | A promised dependency, which doesn't yet exist, but should be provided</span><span>
</span><span id="line-1907"></span><span>    </span><span class="hs-comment">-- at the build time.</span><span>
</span><span id="line-1908"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1909"></span><span>    </span><span class="hs-comment">-- We have these such that we can configure components without actually</span><span>
</span><span id="line-1910"></span><span>    </span><span class="hs-comment">-- building its dependencies, if these dependencies need to be built later</span><span>
</span><span id="line-1911"></span><span>    </span><span class="hs-comment">-- again. For example, when launching a multi-repl,</span><span>
</span><span id="line-1912"></span><span>    </span><span class="hs-comment">-- we need to build packages in the interactive ghci session, no matter</span><span>
</span><span id="line-1913"></span><span>    </span><span class="hs-comment">-- whether they have been built before.</span><span>
</span><span id="line-1914"></span><span>    </span><span class="hs-comment">-- Building them in the configure phase is then redundant and costs time.</span><span>
</span><span id="line-1915"></span><span>    </span><span id="PromisedDependency"><span class="annot"><a href="Distribution.Simple.Configure.html#PromisedDependency"><span class="hs-identifier hs-var">PromisedDependency</span></a></span></span><span> </span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#ConfiguredPromisedComponent"><span class="hs-identifier hs-type">ConfiguredPromisedComponent</span></a></span><span>
</span><span id="line-1916"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | An internal dependency ('PackageId' should be a library name)</span><span>
</span><span id="line-1917"></span><span>    </span><span class="hs-comment">-- which we are going to have to build.  (The</span><span>
</span><span id="line-1918"></span><span>    </span><span class="hs-comment">-- 'PackageId' here is a hack to get a modest amount of</span><span>
</span><span id="line-1919"></span><span>    </span><span class="hs-comment">-- polymorphism out of the Pkg' typeclass.)</span><span>
</span><span id="line-1920"></span><span>    </span><span id="InternalDependency"><span class="annot"><a href="Distribution.Simple.Configure.html#InternalDependency"><span class="hs-identifier hs-var">InternalDependency</span></a></span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageId"><span class="hs-identifier hs-type">PackageId</span></a></span><span>
</span><span id="line-1921"></span><span>
</span><span id="line-1922"></span><span class="annot"><span class="hs-comment">-- | Test for a package dependency and record the version we have installed.</span></span><span>
</span><span id="line-1923"></span><span class="annot"><a href="Distribution.Simple.Configure.html#selectDependency"><span class="hs-identifier hs-type">selectDependency</span></a></span><span>
</span><span id="line-1924"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageId"><span class="hs-identifier hs-type">PackageId</span></a></span><span>
</span><span id="line-1925"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Package id of current package</span></span><span>
</span><span id="line-1926"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LibraryName"><span class="hs-identifier hs-type">LibraryName</span></a></span><span>
</span><span id="line-1927"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ package libraries</span></span><span>
</span><span id="line-1928"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Distribution.Types.GivenComponent.html#PromisedComponent"><span class="hs-identifier hs-type">PromisedComponent</span></a></span><span>
</span><span id="line-1929"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Set of components that are promised, i.e. are not installed already. See 'PromisedDependency' for more details.</span></span><span>
</span><span id="line-1930"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#InstalledPackageIndex"><span class="hs-identifier hs-type">InstalledPackageIndex</span></a></span><span>
</span><span id="line-1931"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Installed packages</span></span><span>
</span><span id="line-1932"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span>
</span><span id="line-1933"></span><span>  </span><span class="hs-comment">-- ^ Packages for which we have been given specific deps to</span><span>
</span><span id="line-1934"></span><span>  </span><span class="hs-comment">-- use</span><span>
</span><span id="line-1935"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#UseExternalInternalDeps"><span class="hs-identifier hs-type">UseExternalInternalDeps</span></a></span><span>
</span><span id="line-1936"></span><span>  </span><span class="hs-comment">-- ^ Are we configuring a</span><span>
</span><span id="line-1937"></span><span>  </span><span class="hs-comment">-- single component?</span><span>
</span><span id="line-1938"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span>
</span><span id="line-1939"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#FailedDependency"><span class="hs-identifier hs-type">FailedDependency</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#DependencyResolution"><span class="hs-identifier hs-type">DependencyResolution</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1940"></span><span id="selectDependency"><span class="annot"><span class="annottext">selectDependency :: PackageIdentifier
-&gt; Set LibraryName
-&gt; Map (PackageName, ComponentName) PromisedComponent
-&gt; InstalledPackageIndex
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
-&gt; Bool
-&gt; Dependency
-&gt; [Either FailedDependency DependencyResolution]
</span><a href="Distribution.Simple.Configure.html#selectDependency"><span class="hs-identifier hs-var hs-var">selectDependency</span></a></span></span><span>
</span><span id="line-1941"></span><span>  </span><span id="local-6989586621679565772"><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565772"><span class="hs-identifier hs-var">pkgid</span></a></span></span><span>
</span><span id="line-1942"></span><span>  </span><span id="local-6989586621679565773"><span class="annot"><span class="annottext">Set LibraryName
</span><a href="#local-6989586621679565773"><span class="hs-identifier hs-var">internalIndex</span></a></span></span><span>
</span><span id="line-1943"></span><span>  </span><span id="local-6989586621679565774"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565774"><span class="hs-identifier hs-var">promisedIndex</span></a></span></span><span>
</span><span id="line-1944"></span><span>  </span><span id="local-6989586621679565775"><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565775"><span class="hs-identifier hs-var">installedIndex</span></a></span></span><span>
</span><span id="line-1945"></span><span>  </span><span id="local-6989586621679565776"><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565776"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span></span><span>
</span><span id="line-1946"></span><span>  </span><span id="local-6989586621679565777"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565777"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span></span><span>
</span><span id="line-1947"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#Dependency"><span class="hs-identifier hs-type">Dependency</span></a></span><span> </span><span id="local-6989586621679565778"><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span></span><span> </span><span id="local-6989586621679565779"><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565779"><span class="hs-identifier hs-var">vr</span></a></span></span><span> </span><span id="local-6989586621679565780"><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565780"><span class="hs-identifier hs-var">libs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1948"></span><span>    </span><span class="hs-comment">-- If the dependency specification matches anything in the internal package</span><span>
</span><span id="line-1949"></span><span>    </span><span class="hs-comment">-- index, then we prefer that match to anything in the second.</span><span>
</span><span id="line-1950"></span><span>    </span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-1951"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1952"></span><span>    </span><span class="hs-comment">-- Name: MyLibrary</span><span>
</span><span id="line-1953"></span><span>    </span><span class="hs-comment">-- Version: 0.1</span><span>
</span><span id="line-1954"></span><span>    </span><span class="hs-comment">-- Library</span><span>
</span><span id="line-1955"></span><span>    </span><span class="hs-comment">--     ..</span><span>
</span><span id="line-1956"></span><span>    </span><span class="hs-comment">-- Executable my-exec</span><span>
</span><span id="line-1957"></span><span>    </span><span class="hs-comment">--     build-depends: MyLibrary</span><span>
</span><span id="line-1958"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1959"></span><span>    </span><span class="hs-comment">-- We want &quot;build-depends: MyLibrary&quot; always to match the internal library</span><span>
</span><span id="line-1960"></span><span>    </span><span class="hs-comment">-- even if there is a newer installed library &quot;MyLibrary-0.2&quot;.</span><span>
</span><span id="line-1961"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName -&gt; PackageName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565781"><span class="hs-identifier hs-var">pn</span></a></span><span>
</span><span id="line-1962"></span><span>      </span><span class="hs-keyword">then</span><span>
</span><span id="line-1963"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565777"><span class="hs-identifier hs-var">use_external_internal_deps</span></a></span><span>
</span><span id="line-1964"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; Either FailedDependency DependencyResolution
</span><a href="#local-6989586621679565782"><span class="hs-identifier hs-var">do_external_internal</span></a></span><span> </span><span class="annot"><span class="annottext">(LibraryName -&gt; Either FailedDependency DependencyResolution)
-&gt; [LibraryName] -&gt; [Either FailedDependency DependencyResolution]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName -&gt; [LibraryName]
forall a. NonEmptySet a -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.NonEmptySet.html#toList"><span class="hs-identifier hs-var">NES.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565780"><span class="hs-identifier hs-var">libs</span></a></span><span>
</span><span id="line-1965"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; Either FailedDependency DependencyResolution
</span><a href="#local-6989586621679565784"><span class="hs-identifier hs-var">do_internal</span></a></span><span> </span><span class="annot"><span class="annottext">(LibraryName -&gt; Either FailedDependency DependencyResolution)
-&gt; [LibraryName] -&gt; [Either FailedDependency DependencyResolution]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName -&gt; [LibraryName]
forall a. NonEmptySet a -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.NonEmptySet.html#toList"><span class="hs-identifier hs-var">NES.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565780"><span class="hs-identifier hs-var">libs</span></a></span><span>
</span><span id="line-1966"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; Either FailedDependency DependencyResolution
</span><a href="#local-6989586621679565785"><span class="hs-identifier hs-var">do_external_external</span></a></span><span> </span><span class="annot"><span class="annottext">(LibraryName -&gt; Either FailedDependency DependencyResolution)
-&gt; [LibraryName] -&gt; [Either FailedDependency DependencyResolution]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName -&gt; [LibraryName]
forall a. NonEmptySet a -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.NonEmptySet.html#toList"><span class="hs-identifier hs-var">NES.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptySet LibraryName
</span><a href="#local-6989586621679565780"><span class="hs-identifier hs-var">libs</span></a></span><span>
</span><span id="line-1967"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1968"></span><span>      </span><span id="local-6989586621679565781"><span class="annot"><span class="annottext">pn :: PackageName
</span><a href="#local-6989586621679565781"><span class="hs-identifier hs-var hs-var">pn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; PackageName
forall pkg. Package pkg =&gt; pkg -&gt; PackageName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageName"><span class="hs-identifier hs-var">packageName</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565772"><span class="hs-identifier hs-var">pkgid</span></a></span><span>
</span><span id="line-1969"></span><span>
</span><span id="line-1970"></span><span>      </span><span class="hs-comment">-- It's an internal library, and we're not per-component build</span><span>
</span><span id="line-1971"></span><span>      </span><span id="local-6989586621679565784"><span class="annot"><span class="annottext">do_internal :: LibraryName -&gt; Either FailedDependency DependencyResolution
</span><a href="#local-6989586621679565784"><span class="hs-identifier hs-var hs-var">do_internal</span></a></span></span><span> </span><span id="local-6989586621679565789"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565789"><span class="hs-identifier hs-var">lib</span></a></span></span><span>
</span><span id="line-1972"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; Set LibraryName -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565789"><span class="hs-identifier hs-var">lib</span></a></span><span> </span><span class="annot"><span class="annottext">Set LibraryName
</span><a href="#local-6989586621679565773"><span class="hs-identifier hs-var">internalIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1973"></span><span>            </span><span class="annot"><span class="annottext">DependencyResolution
-&gt; Either FailedDependency DependencyResolution
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(DependencyResolution
 -&gt; Either FailedDependency DependencyResolution)
-&gt; DependencyResolution
-&gt; Either FailedDependency DependencyResolution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; DependencyResolution
</span><a href="Distribution.Simple.Configure.html#InternalDependency"><span class="hs-identifier hs-var">InternalDependency</span></a></span><span> </span><span class="annot"><span class="annottext">(PackageIdentifier -&gt; DependencyResolution)
-&gt; PackageIdentifier -&gt; DependencyResolution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PackageName -&gt; Version -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageId.html#PackageIdentifier"><span class="hs-identifier hs-var">PackageIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span> </span><span class="annot"><span class="annottext">(Version -&gt; PackageIdentifier) -&gt; Version -&gt; PackageIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; Version
forall pkg. Package pkg =&gt; pkg -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageVersion"><span class="hs-identifier hs-var">packageVersion</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565772"><span class="hs-identifier hs-var">pkgid</span></a></span><span>
</span><span id="line-1974"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1975"></span><span>            </span><span class="annot"><span class="annottext">FailedDependency -&gt; Either FailedDependency DependencyResolution
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(FailedDependency -&gt; Either FailedDependency DependencyResolution)
-&gt; FailedDependency -&gt; Either FailedDependency DependencyResolution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PackageName -&gt; LibraryName -&gt; FailedDependency
</span><a href="Distribution.Simple.Errors.html#DependencyMissingInternal"><span class="hs-identifier hs-var">DependencyMissingInternal</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565789"><span class="hs-identifier hs-var">lib</span></a></span><span>
</span><span id="line-1976"></span><span>
</span><span id="line-1977"></span><span>      </span><span class="hs-comment">-- We have to look it up externally</span><span>
</span><span id="line-1978"></span><span>      </span><span class="annot"><a href="#local-6989586621679565785"><span class="hs-identifier hs-type">do_external_external</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LibraryName"><span class="hs-identifier hs-type">LibraryName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#FailedDependency"><span class="hs-identifier hs-type">FailedDependency</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#DependencyResolution"><span class="hs-identifier hs-type">DependencyResolution</span></a></span><span>
</span><span id="line-1979"></span><span>      </span><span id="local-6989586621679565785"><span class="annot"><span class="annottext">do_external_external :: LibraryName -&gt; Either FailedDependency DependencyResolution
</span><a href="#local-6989586621679565785"><span class="hs-identifier hs-var hs-var">do_external_external</span></a></span></span><span> </span><span id="local-6989586621679565793"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565793"><span class="hs-identifier hs-var">lib</span></a></span></span><span>
</span><span id="line-1980"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565794"><span class="annot"><span class="annottext">PromisedComponent
</span><a href="#local-6989586621679565794"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PackageName, ComponentName)
-&gt; Map (PackageName, ComponentName) PromisedComponent
-&gt; Maybe PromisedComponent
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565793"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565774"><span class="hs-identifier hs-var">promisedIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1981"></span><span>            </span><span class="annot"><span class="annottext">DependencyResolution
-&gt; Either FailedDependency DependencyResolution
forall a. a -&gt; Either FailedDependency a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DependencyResolution
 -&gt; Either FailedDependency DependencyResolution)
-&gt; DependencyResolution
-&gt; Either FailedDependency DependencyResolution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfiguredPromisedComponent -&gt; DependencyResolution
</span><a href="Distribution.Simple.Configure.html#PromisedDependency"><span class="hs-identifier hs-var">PromisedDependency</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
-&gt; AnnotatedId ComponentId -&gt; ConfiguredPromisedComponent
</span><a href="Distribution.Backpack.PreExistingComponent.html#ConfiguredPromisedComponent"><span class="hs-identifier hs-var">ConfiguredPromisedComponent</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageIdentifier
-&gt; ComponentName -&gt; ComponentId -&gt; AnnotatedId ComponentId
forall id.
PackageIdentifier -&gt; ComponentName -&gt; id -&gt; AnnotatedId id
</span><a href="Distribution.Types.AnnotatedId.html#AnnotatedId"><span class="hs-identifier hs-var">AnnotatedId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PromisedComponent -&gt; PackageIdentifier
</span><a href="Distribution.Types.GivenComponent.html#promisedComponentPackage"><span class="hs-identifier hs-var">promisedComponentPackage</span></a></span><span> </span><span class="annot"><span class="annottext">PromisedComponent
</span><a href="#local-6989586621679565794"><span class="hs-identifier hs-var">pc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565793"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PromisedComponent -&gt; ComponentId
</span><a href="Distribution.Types.GivenComponent.html#promisedComponentId"><span class="hs-identifier hs-var">promisedComponentId</span></a></span><span> </span><span class="annot"><span class="annottext">PromisedComponent
</span><a href="#local-6989586621679565794"><span class="hs-identifier hs-var">pc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1982"></span><span>      </span><span class="annot"><a href="#local-6989586621679565785"><span class="hs-identifier hs-var">do_external_external</span></a></span><span> </span><span id="local-6989586621679565799"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565799"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1983"></span><span>        </span><span id="local-6989586621679565800"><span class="annot"><a href="#local-6989586621679565800"><span class="hs-identifier hs-var">ipi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(PackageName, ComponentName)
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
-&gt; Maybe InstalledPackageInfo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565799"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565776"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1984"></span><span>          </span><span class="hs-comment">-- If we know the exact pkg to use, then use it.</span><span>
</span><span id="line-1985"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565801"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565801"><span class="hs-identifier hs-var">pkginstance</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
-&gt; Either FailedDependency InstalledPackageInfo
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565801"><span class="hs-identifier hs-var">pkginstance</span></a></span><span>
</span><span id="line-1986"></span><span>          </span><span class="hs-comment">-- Otherwise we just pick an arbitrary instance of the latest version.</span><span>
</span><span id="line-1987"></span><span>          </span><span class="annot"><span class="annottext">Maybe InstalledPackageInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Version, [InstalledPackageInfo])] -&gt; Maybe InstalledPackageInfo
</span><a href="#local-6989586621679565802"><span class="hs-identifier hs-var">pickLastIPI</span></a></span><span> </span><span class="annot"><span class="annottext">([(Version, [InstalledPackageInfo])] -&gt; Maybe InstalledPackageInfo)
-&gt; [(Version, [InstalledPackageInfo])]
-&gt; Maybe InstalledPackageInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
-&gt; PackageName
-&gt; VersionRange
-&gt; LibraryName
-&gt; [(Version, [InstalledPackageInfo])]
</span><a href="Distribution.Simple.PackageIndex.html#lookupInternalDependency"><span class="hs-identifier hs-var">PackageIndex.lookupInternalDependency</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565775"><span class="hs-identifier hs-var">installedIndex</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565779"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565799"><span class="hs-identifier hs-var">lib</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1988"></span><span>            </span><span class="annot"><span class="annottext">Maybe InstalledPackageInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FailedDependency -&gt; Either FailedDependency InstalledPackageInfo
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName -&gt; FailedDependency
</span><a href="Distribution.Simple.Errors.html#DependencyNotExists"><span class="hs-identifier hs-var">DependencyNotExists</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1989"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565804"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565804"><span class="hs-identifier hs-var">pkg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
-&gt; Either FailedDependency InstalledPackageInfo
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565804"><span class="hs-identifier hs-var">pkg</span></a></span><span>
</span><span id="line-1990"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ExternalDependency"><span class="hs-identifier hs-type">ExternalDependency</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#ipiToPreExistingComponent"><span class="hs-identifier hs-type">ipiToPreExistingComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565800"><span class="hs-identifier hs-type">ipi</span></a></span><span>
</span><span id="line-1991"></span><span>
</span><span id="line-1992"></span><span>      </span><span class="annot"><a href="#local-6989586621679565782"><span class="hs-identifier hs-type">do_external_internal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LibraryName"><span class="hs-identifier hs-type">LibraryName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#FailedDependency"><span class="hs-identifier hs-type">FailedDependency</span></a></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#DependencyResolution"><span class="hs-identifier hs-type">DependencyResolution</span></a></span><span>
</span><span id="line-1993"></span><span>      </span><span id="local-6989586621679565782"><span class="annot"><span class="annottext">do_external_internal :: LibraryName -&gt; Either FailedDependency DependencyResolution
</span><a href="#local-6989586621679565782"><span class="hs-identifier hs-var hs-var">do_external_internal</span></a></span></span><span> </span><span id="local-6989586621679565806"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565806"><span class="hs-identifier hs-var">lib</span></a></span></span><span>
</span><span id="line-1994"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565807"><span class="annot"><span class="annottext">PromisedComponent
</span><a href="#local-6989586621679565807"><span class="hs-identifier hs-var">pc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PackageName, ComponentName)
-&gt; Map (PackageName, ComponentName) PromisedComponent
-&gt; Maybe PromisedComponent
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565806"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) PromisedComponent
</span><a href="#local-6989586621679565774"><span class="hs-identifier hs-var">promisedIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1995"></span><span>            </span><span class="annot"><span class="annottext">DependencyResolution
-&gt; Either FailedDependency DependencyResolution
forall a. a -&gt; Either FailedDependency a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DependencyResolution
 -&gt; Either FailedDependency DependencyResolution)
-&gt; DependencyResolution
-&gt; Either FailedDependency DependencyResolution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfiguredPromisedComponent -&gt; DependencyResolution
</span><a href="Distribution.Simple.Configure.html#PromisedDependency"><span class="hs-identifier hs-var">PromisedDependency</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
-&gt; AnnotatedId ComponentId -&gt; ConfiguredPromisedComponent
</span><a href="Distribution.Backpack.PreExistingComponent.html#ConfiguredPromisedComponent"><span class="hs-identifier hs-var">ConfiguredPromisedComponent</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageIdentifier
-&gt; ComponentName -&gt; ComponentId -&gt; AnnotatedId ComponentId
forall id.
PackageIdentifier -&gt; ComponentName -&gt; id -&gt; AnnotatedId id
</span><a href="Distribution.Types.AnnotatedId.html#AnnotatedId"><span class="hs-identifier hs-var">AnnotatedId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PromisedComponent -&gt; PackageIdentifier
</span><a href="Distribution.Types.GivenComponent.html#promisedComponentPackage"><span class="hs-identifier hs-var">promisedComponentPackage</span></a></span><span> </span><span class="annot"><span class="annottext">PromisedComponent
</span><a href="#local-6989586621679565807"><span class="hs-identifier hs-var">pc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565806"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PromisedComponent -&gt; ComponentId
</span><a href="Distribution.Types.GivenComponent.html#promisedComponentId"><span class="hs-identifier hs-var">promisedComponentId</span></a></span><span> </span><span class="annot"><span class="annottext">PromisedComponent
</span><a href="#local-6989586621679565807"><span class="hs-identifier hs-var">pc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1996"></span><span>      </span><span class="annot"><a href="#local-6989586621679565782"><span class="hs-identifier hs-var">do_external_internal</span></a></span><span> </span><span id="local-6989586621679565808"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565808"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1997"></span><span>        </span><span id="local-6989586621679565809"><span class="annot"><a href="#local-6989586621679565809"><span class="hs-identifier hs-var">ipi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(PackageName, ComponentName)
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
-&gt; Maybe InstalledPackageInfo
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565808"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565776"><span class="hs-identifier hs-var">requiredDepsMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1998"></span><span>          </span><span class="hs-comment">-- If we know the exact pkg to use, then use it.</span><span>
</span><span id="line-1999"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565810"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565810"><span class="hs-identifier hs-var">pkginstance</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
-&gt; Either FailedDependency InstalledPackageInfo
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565810"><span class="hs-identifier hs-var">pkginstance</span></a></span><span>
</span><span id="line-2000"></span><span>          </span><span class="annot"><span class="annottext">Maybe InstalledPackageInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Version, [InstalledPackageInfo])] -&gt; Maybe InstalledPackageInfo
</span><a href="#local-6989586621679565802"><span class="hs-identifier hs-var">pickLastIPI</span></a></span><span> </span><span class="annot"><span class="annottext">([(Version, [InstalledPackageInfo])] -&gt; Maybe InstalledPackageInfo)
-&gt; [(Version, [InstalledPackageInfo])]
-&gt; Maybe InstalledPackageInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
-&gt; PackageName
-&gt; VersionRange
-&gt; LibraryName
-&gt; [(Version, [InstalledPackageInfo])]
</span><a href="Distribution.Simple.PackageIndex.html#lookupInternalDependency"><span class="hs-identifier hs-var">PackageIndex.lookupInternalDependency</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565775"><span class="hs-identifier hs-var">installedIndex</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565781"><span class="hs-identifier hs-var">pn</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565779"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565808"><span class="hs-identifier hs-var">lib</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2001"></span><span>            </span><span class="hs-comment">-- It's an internal library, being looked up externally</span><span>
</span><span id="line-2002"></span><span>            </span><span class="annot"><span class="annottext">Maybe InstalledPackageInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FailedDependency -&gt; Either FailedDependency InstalledPackageInfo
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName -&gt; LibraryName -&gt; FailedDependency
</span><a href="Distribution.Simple.Errors.html#DependencyMissingInternal"><span class="hs-identifier hs-var">DependencyMissingInternal</span></a></span><span> </span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565778"><span class="hs-identifier hs-var">dep_pkgname</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565808"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2003"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565811"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565811"><span class="hs-identifier hs-var">pkg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
-&gt; Either FailedDependency InstalledPackageInfo
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565811"><span class="hs-identifier hs-var">pkg</span></a></span><span>
</span><span id="line-2004"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Configure.html#ExternalDependency"><span class="hs-identifier hs-type">ExternalDependency</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Backpack.PreExistingComponent.html#ipiToPreExistingComponent"><span class="hs-identifier hs-type">ipiToPreExistingComponent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565809"><span class="hs-identifier hs-type">ipi</span></a></span><span>
</span><span id="line-2005"></span><span>
</span><span id="line-2006"></span><span>      </span><span class="annot"><a href="#local-6989586621679565802"><span class="hs-identifier hs-type">pickLastIPI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#Version"><span class="hs-identifier hs-type">Version</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span>
</span><span id="line-2007"></span><span>      </span><span id="local-6989586621679565802"><span class="annot"><span class="annottext">pickLastIPI :: [(Version, [InstalledPackageInfo])] -&gt; Maybe InstalledPackageInfo
</span><a href="#local-6989586621679565802"><span class="hs-identifier hs-var hs-var">pickLastIPI</span></a></span></span><span> </span><span id="local-6989586621679565812"><span class="annot"><span class="annottext">[(Version, [InstalledPackageInfo])]
</span><a href="#local-6989586621679565812"><span class="hs-identifier hs-var">pkgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[InstalledPackageInfo] -&gt; Maybe InstalledPackageInfo
forall a. [a] -&gt; Maybe a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#safeHead"><span class="hs-identifier hs-var">safeHead</span></a></span><span> </span><span class="annot"><span class="annottext">([InstalledPackageInfo] -&gt; Maybe InstalledPackageInfo)
-&gt; (NonEmpty (Version, [InstalledPackageInfo])
    -&gt; [InstalledPackageInfo])
-&gt; NonEmpty (Version, [InstalledPackageInfo])
-&gt; Maybe InstalledPackageInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Version, [InstalledPackageInfo]) -&gt; [InstalledPackageInfo]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Version, [InstalledPackageInfo]) -&gt; [InstalledPackageInfo])
-&gt; (NonEmpty (Version, [InstalledPackageInfo])
    -&gt; (Version, [InstalledPackageInfo]))
-&gt; NonEmpty (Version, [InstalledPackageInfo])
-&gt; [InstalledPackageInfo]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Version, [InstalledPackageInfo])
-&gt; (Version, [InstalledPackageInfo])
forall a. NonEmpty a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Version, [InstalledPackageInfo])
 -&gt; Maybe InstalledPackageInfo)
-&gt; Maybe (NonEmpty (Version, [InstalledPackageInfo]))
-&gt; Maybe InstalledPackageInfo
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">[(Version, [InstalledPackageInfo])]
-&gt; Maybe (NonEmpty (Version, [InstalledPackageInfo]))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#nonEmpty"><span class="hs-identifier hs-var">nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[(Version, [InstalledPackageInfo])]
</span><a href="#local-6989586621679565812"><span class="hs-identifier hs-var">pkgs</span></a></span><span>
</span><span id="line-2008"></span><span>
</span><span id="line-2009"></span><span class="annot"><a href="Distribution.Simple.Configure.html#reportSelectedDependencies"><span class="hs-identifier hs-type">reportSelectedDependencies</span></a></span><span>
</span><span id="line-2010"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2011"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Simple.Configure.html#ResolvedDependency"><span class="hs-identifier hs-type">ResolvedDependency</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2012"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2013"></span><span id="reportSelectedDependencies"><span class="annot"><span class="annottext">reportSelectedDependencies :: Verbosity -&gt; [ResolvedDependency] -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#reportSelectedDependencies"><span class="hs-identifier hs-var hs-var">reportSelectedDependencies</span></a></span></span><span> </span><span id="local-6989586621679565818"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565818"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565819"><span class="annot"><span class="annottext">[ResolvedDependency]
</span><a href="#local-6989586621679565819"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2014"></span><span>  </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565818"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; IO ()) -&gt; ProgArg -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2015"></span><span>    </span><span class="annot"><span class="annottext">[ProgArg] -&gt; ProgArg
</span><span class="hs-identifier hs-var">unlines</span></span><span>
</span><span id="line-2016"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Dependency &quot;</span></span><span>
</span><span id="line-2017"></span><span>        </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Dependency -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dependency -&gt; Dependency
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Dependency.html#simplifyDependency"><span class="hs-identifier hs-var">simplifyDependency</span></a></span><span> </span><span class="annot"><span class="annottext">Dependency
</span><a href="#local-6989586621679565822"><span class="hs-identifier hs-var">dep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2018"></span><span>        </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;: using &quot;</span></span><span>
</span><span id="line-2019"></span><span>        </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565823"><span class="hs-identifier hs-var">pkgid</span></a></span><span>
</span><span id="line-2020"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565822"><span class="annot"><span class="annottext">Dependency
</span><a href="#local-6989586621679565822"><span class="hs-identifier hs-var">dep</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565824"><span class="annot"><span class="annottext">DependencyResolution
</span><a href="#local-6989586621679565824"><span class="hs-identifier hs-var">resolution</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ResolvedDependency]
</span><a href="#local-6989586621679565819"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-2021"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565823"><span class="annot"><span class="annottext">pkgid :: PackageIdentifier
</span><a href="#local-6989586621679565823"><span class="hs-identifier hs-var hs-var">pkgid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DependencyResolution
</span><a href="#local-6989586621679565824"><span class="hs-identifier hs-var">resolution</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2022"></span><span>              </span><span class="annot"><a href="Distribution.Simple.Configure.html#ExternalDependency"><span class="hs-identifier hs-type">ExternalDependency</span></a></span><span> </span><span id="local-6989586621679565829"><span class="annot"><span class="annottext">PreExistingComponent
</span><a href="#local-6989586621679565829"><span class="hs-identifier hs-var">pkg'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PreExistingComponent -&gt; PackageIdentifier
forall pkg. Package pkg =&gt; pkg -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageId"><span class="hs-identifier hs-var">packageId</span></a></span><span> </span><span class="annot"><span class="annottext">PreExistingComponent
</span><a href="#local-6989586621679565829"><span class="hs-identifier hs-var">pkg'</span></a></span><span>
</span><span id="line-2023"></span><span>              </span><span class="annot"><a href="Distribution.Simple.Configure.html#InternalDependency"><span class="hs-identifier hs-type">InternalDependency</span></a></span><span> </span><span id="local-6989586621679565830"><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565830"><span class="hs-identifier hs-var">pkgid'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PackageIdentifier
</span><a href="#local-6989586621679565830"><span class="hs-identifier hs-var">pkgid'</span></a></span><span>
</span><span id="line-2024"></span><span>              </span><span class="annot"><a href="Distribution.Simple.Configure.html#PromisedDependency"><span class="hs-identifier hs-type">PromisedDependency</span></a></span><span> </span><span id="local-6989586621679565831"><span class="annot"><span class="annottext">ConfiguredPromisedComponent
</span><a href="#local-6989586621679565831"><span class="hs-identifier hs-var">promisedComp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConfiguredPromisedComponent -&gt; PackageIdentifier
forall pkg. Package pkg =&gt; pkg -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageId"><span class="hs-identifier hs-var">packageId</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredPromisedComponent
</span><a href="#local-6989586621679565831"><span class="hs-identifier hs-var">promisedComp</span></a></span><span>
</span><span id="line-2025"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-2026"></span><span>
</span><span id="line-2027"></span><span class="annot"><a href="Distribution.Simple.Configure.html#reportFailedDependencies"><span class="hs-identifier hs-type">reportFailedDependencies</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Simple.Errors.html#FailedDependency"><span class="hs-identifier hs-type">FailedDependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2028"></span><span id="reportFailedDependencies"><span class="annot"><span class="annottext">reportFailedDependencies :: Verbosity -&gt; [FailedDependency] -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#reportFailedDependencies"><span class="hs-identifier hs-var hs-var">reportFailedDependencies</span></a></span></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2029"></span><span class="annot"><a href="Distribution.Simple.Configure.html#reportFailedDependencies"><span class="hs-identifier hs-var">reportFailedDependencies</span></a></span><span> </span><span id="local-6989586621679565832"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565832"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565833"><span class="annot"><span class="annottext">[FailedDependency]
</span><a href="#local-6989586621679565833"><span class="hs-identifier hs-var">failed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2030"></span><span>  </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565832"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FailedDependency] -&gt; ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#ReportFailedDependencies"><span class="hs-identifier hs-var">ReportFailedDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">[FailedDependency]
</span><a href="#local-6989586621679565833"><span class="hs-identifier hs-var">failed</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="Distribution.Simple.Configure.html#hackageUrl"><span class="hs-identifier hs-var">hackageUrl</span></a></span><span>
</span><span id="line-2031"></span><span>
</span><span id="line-2032"></span><span class="hs-comment">-- | List all installed packages in the given package databases.</span><span>
</span><span id="line-2033"></span><span class="hs-comment">-- Non-existent package databases do not cause errors, they just get skipped</span><span>
</span><span id="line-2034"></span><span class="hs-comment">-- with a warning and treated as empty ones, since technically they do not</span><span>
</span><span id="line-2035"></span><span class="hs-comment">-- contain any package.</span><span>
</span><span id="line-2036"></span><span id="local-6989586621679563965"><span class="annot"><a href="Distribution.Simple.Configure.html#getInstalledPackages"><span class="hs-identifier hs-type">getInstalledPackages</span></a></span><span>
</span><span id="line-2037"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2038"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-2039"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679563965"><span class="hs-identifier hs-type">from</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2040"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#PackageDBStackX"><span class="hs-identifier hs-type">PackageDBStackX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679563965"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#PkgDB"><span class="hs-identifier hs-type">PkgDB</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2041"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The stack of package databases.</span></span><span>
</span><span id="line-2042"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2043"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#InstalledPackageIndex"><span class="hs-identifier hs-type">InstalledPackageIndex</span></a></span></span><span>
</span><span id="line-2044"></span><span id="getInstalledPackages"><span class="annot"><span class="annottext">getInstalledPackages :: forall from.
Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#getInstalledPackages"><span class="hs-identifier hs-var hs-var">getInstalledPackages</span></a></span></span><span> </span><span id="local-6989586621679565851"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565851"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565852"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565852"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679565853"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir from))
</span><a href="#local-6989586621679565853"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span id="local-6989586621679565854"><span class="annot"><span class="annottext">PackageDBStackX (SymbolicPath from ('Dir PkgDB))
</span><a href="#local-6989586621679565854"><span class="hs-identifier hs-var">packageDBs</span></a></span></span><span> </span><span id="local-6989586621679565855"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565855"><span class="hs-identifier hs-var">progdb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2045"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDBStackX (SymbolicPath from ('Dir PkgDB)) -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">PackageDBStackX (SymbolicPath from ('Dir PkgDB))
</span><a href="#local-6989586621679565854"><span class="hs-identifier hs-var">packageDBs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2046"></span><span>    </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565851"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#NoPackageDatabaseSpecified"><span class="hs-identifier hs-var">NoPackageDatabaseSpecified</span></a></span><span>
</span><span id="line-2047"></span><span>
</span><span id="line-2048"></span><span>  </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565851"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Reading installed packages...&quot;</span></span><span>
</span><span id="line-2049"></span><span>  </span><span class="hs-comment">-- do not check empty packagedbs (ghc-pkg would error out)</span><span>
</span><span id="line-2050"></span><span>  </span><span id="local-6989586621679565857"><span class="annot"><a href="#local-6989586621679565857"><span class="hs-identifier hs-var">packageDBs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(PackageDBX (SymbolicPath from ('Dir PkgDB)) -&gt; IO Bool)
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; IO (PackageDBStackX (SymbolicPath from ('Dir PkgDB)))
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="annot"><span class="annottext">PackageDBX (SymbolicPath from ('Dir PkgDB)) -&gt; IO Bool
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
PackageDBX (SymbolicPathX allowAbsolute from to) -&gt; IO Bool
</span><a href="#local-6989586621679565859"><span class="hs-identifier hs-var">packageDBExists</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBStackX (SymbolicPath from ('Dir PkgDB))
</span><a href="#local-6989586621679565854"><span class="hs-identifier hs-var">packageDBs</span></a></span><span>
</span><span id="line-2051"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#compilerFlavor"><span class="hs-identifier hs-type">compilerFlavor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565852"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2052"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.GHC.html#getInstalledPackages"><span class="hs-identifier hs-var">GHC.getInstalledPackages</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565851"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565852"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir from))
</span><a href="#local-6989586621679565853"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBStackX (SymbolicPath from ('Dir PkgDB))
</span><a href="#local-6989586621679565857"><span class="hs-identifier hs-var">packageDBs'</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565855"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2053"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHCJS"><span class="hs-identifier hs-var">GHCJS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.GHCJS.html#getInstalledPackages"><span class="hs-identifier hs-var">GHCJS.getInstalledPackages</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565851"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir from))
</span><a href="#local-6989586621679565853"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBStackX (SymbolicPath from ('Dir PkgDB))
</span><a href="#local-6989586621679565857"><span class="hs-identifier hs-var">packageDBs'</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565855"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2054"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#UHC"><span class="hs-identifier hs-var">UHC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.UHC.html#getInstalledPackages"><span class="hs-identifier hs-var">UHC.getInstalledPackages</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565851"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565852"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir from))
</span><a href="#local-6989586621679565853"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBStackX (SymbolicPath from ('Dir PkgDB))
</span><a href="#local-6989586621679565857"><span class="hs-identifier hs-var">packageDBs'</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565855"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2055"></span><span>    </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#HaskellSuite"><span class="hs-identifier hs-type">HaskellSuite</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2056"></span><span>      </span><span class="annot"><span class="annottext">Verbosity
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.HaskellSuite.html#getInstalledPackages"><span class="hs-identifier hs-var">HaskellSuite.getInstalledPackages</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565851"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBStackX (SymbolicPath from ('Dir PkgDB))
</span><a href="#local-6989586621679565857"><span class="hs-identifier hs-var">packageDBs'</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565855"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2057"></span><span>    </span><span id="local-6989586621679565866"><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="#local-6989586621679565866"><span class="hs-identifier hs-var">flv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2058"></span><span>      </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO InstalledPackageIndex
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565851"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO InstalledPackageIndex)
-&gt; CabalException -&gt; IO InstalledPackageIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#HowToFindInstalledPackages"><span class="hs-identifier hs-var">HowToFindInstalledPackages</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="#local-6989586621679565866"><span class="hs-identifier hs-var">flv</span></a></span><span>
</span><span id="line-2059"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2060"></span><span>    </span><span id="local-6989586621679565859"><span class="annot"><span class="annottext">packageDBExists :: PackageDBX (SymbolicPathX allowAbsolute from to) -&gt; IO Bool
</span><a href="#local-6989586621679565859"><span class="hs-identifier hs-var hs-var">packageDBExists</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Compiler.html#SpecificPackageDB"><span class="hs-identifier hs-type">SpecificPackageDB</span></a></span><span> </span><span id="local-6989586621679565880"><span class="annot"><span class="annottext">SymbolicPathX allowAbsolute from to
</span><a href="#local-6989586621679565880"><span class="hs-identifier hs-var">path0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2061"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565881"><span class="annot"><span class="annottext">path :: ProgArg
</span><a href="#local-6989586621679565881"><span class="hs-identifier hs-var hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir from))
-&gt; SymbolicPathX allowAbsolute from to -&gt; ProgArg
forall from (allowAbsolute :: AllowAbsolute) (to :: FileOrDir).
Maybe (SymbolicPath CWD ('Dir from))
-&gt; SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#interpretSymbolicPath"><span class="hs-identifier hs-var">interpretSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir from))
</span><a href="#local-6989586621679565853"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX allowAbsolute from to
</span><a href="#local-6989586621679565880"><span class="hs-identifier hs-var">path0</span></a></span><span>
</span><span id="line-2062"></span><span>      </span><span id="local-6989586621679565882"><span class="annot"><a href="#local-6989586621679565882"><span class="hs-identifier hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; IO Bool
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#doesPathExist"><span class="hs-identifier hs-var">doesPathExist</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565881"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-2063"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="annot"><a href="#local-6989586621679565882"><span class="hs-identifier hs-type">exists</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2064"></span><span>        </span><span class="annot"><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-type">warn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679565851"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2065"></span><span>          </span><span class="annot"><span class="hs-string">&quot;Package db &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679565881"><span class="hs-identifier hs-type">path</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; does not exist yet&quot;</span></span><span>
</span><span id="line-2066"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679565882"><span class="hs-identifier hs-type">exists</span></a></span><span>
</span><span id="line-2067"></span><span>    </span><span class="hs-comment">-- Checking the user and global package dbs is more complicated and needs</span><span>
</span><span id="line-2068"></span><span>    </span><span class="hs-comment">-- way more data. Also ghc-pkg won't error out unless the user/global</span><span>
</span><span id="line-2069"></span><span>    </span><span class="hs-comment">-- pkgdb is overridden with an empty one, so we just don't check for them.</span><span>
</span><span id="line-2070"></span><span>    </span><span class="annot"><a href="#local-6989586621679565859"><span class="hs-identifier hs-var">packageDBExists</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBX (SymbolicPathX allowAbsolute from to)
</span><a href="Distribution.Simple.Compiler.html#UserPackageDB"><span class="hs-identifier hs-var">UserPackageDB</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2071"></span><span>    </span><span class="annot"><a href="#local-6989586621679565859"><span class="hs-identifier hs-var">packageDBExists</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBX (SymbolicPathX allowAbsolute from to)
</span><a href="Distribution.Simple.Compiler.html#GlobalPackageDB"><span class="hs-identifier hs-var">GlobalPackageDB</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2072"></span><span>
</span><span id="line-2073"></span><span class="hs-comment">-- | Like 'getInstalledPackages', but for a single package DB.</span><span>
</span><span id="line-2074"></span><span class="hs-comment">--</span><span>
</span><span id="line-2075"></span><span class="hs-comment">-- NB: Why isn't this always a fall through to 'getInstalledPackages'?</span><span>
</span><span id="line-2076"></span><span class="hs-comment">-- That is because 'getInstalledPackages' performs some sanity checks</span><span>
</span><span id="line-2077"></span><span class="hs-comment">-- on the package database stack in question.  However, when sandboxes</span><span>
</span><span id="line-2078"></span><span class="hs-comment">-- are involved these sanity checks are not desirable.</span><span>
</span><span id="line-2079"></span><span class="annot"><a href="Distribution.Simple.Configure.html#getPackageDBContents"><span class="hs-identifier hs-type">getPackageDBContents</span></a></span><span>
</span><span id="line-2080"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2081"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-2082"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Pkg"><span class="hs-identifier hs-type">Pkg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2083"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#PackageDB"><span class="hs-identifier hs-type">PackageDB</span></a></span><span>
</span><span id="line-2084"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2085"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#InstalledPackageIndex"><span class="hs-identifier hs-type">InstalledPackageIndex</span></a></span><span>
</span><span id="line-2086"></span><span id="getPackageDBContents"><span class="annot"><span class="annottext">getPackageDBContents :: Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#getPackageDBContents"><span class="hs-identifier hs-var hs-var">getPackageDBContents</span></a></span></span><span> </span><span id="local-6989586621679565886"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565886"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565887"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565887"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679565888"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679565888"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span id="local-6989586621679565889"><span class="annot"><span class="annottext">PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
</span><a href="#local-6989586621679565889"><span class="hs-identifier hs-var">packageDB</span></a></span></span><span> </span><span id="local-6989586621679565890"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565890"><span class="hs-identifier hs-var">progdb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2087"></span><span>  </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565886"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Reading installed packages...&quot;</span></span><span>
</span><span id="line-2088"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; CompilerFlavor
</span><a href="Distribution.Simple.Compiler.html#compilerFlavor"><span class="hs-identifier hs-var">compilerFlavor</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565887"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2089"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.GHC.html#getPackageDBContents"><span class="hs-identifier hs-var">GHC.getPackageDBContents</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565886"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679565888"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
</span><a href="#local-6989586621679565889"><span class="hs-identifier hs-var">packageDB</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565890"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2090"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHCJS"><span class="hs-identifier hs-var">GHCJS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.GHCJS.html#getPackageDBContents"><span class="hs-identifier hs-var">GHCJS.getPackageDBContents</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565886"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679565888"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
</span><a href="#local-6989586621679565889"><span class="hs-identifier hs-var">packageDB</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565890"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2091"></span><span>    </span><span class="hs-comment">-- For other compilers, try to fall back on 'getInstalledPackages'.</span><span>
</span><span id="line-2092"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; PackageDBStack
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#getInstalledPackages"><span class="hs-identifier hs-var">getInstalledPackages</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565886"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565887"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679565888"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
</span><a href="#local-6989586621679565889"><span class="hs-identifier hs-var">packageDB</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565890"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2093"></span><span>
</span><span id="line-2094"></span><span class="hs-comment">-- | A set of files (or directories) that can be monitored to detect when</span><span>
</span><span id="line-2095"></span><span class="hs-comment">-- there might have been a change in the installed packages.</span><span>
</span><span id="line-2096"></span><span id="local-6989586621679564071"><span class="annot"><a href="Distribution.Simple.Configure.html#getInstalledPackagesMonitorFiles"><span class="hs-identifier hs-type">getInstalledPackagesMonitorFiles</span></a></span><span>
</span><span id="line-2097"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2098"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span>
</span><span id="line-2099"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#SymbolicPath"><span class="hs-identifier hs-type">SymbolicPath</span></a></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#CWD"><span class="hs-identifier hs-type">CWD</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#Dir"><span class="hs-identifier hs-type">Dir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564071"><span class="hs-identifier hs-type">from</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2100"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#PackageDBStackS"><span class="hs-identifier hs-type">PackageDBStackS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564071"><span class="hs-identifier hs-type">from</span></a></span><span>
</span><span id="line-2101"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2102"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-2103"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-2104"></span><span id="getInstalledPackagesMonitorFiles"><span class="annot"><span class="annottext">getInstalledPackagesMonitorFiles :: forall from.
Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackS from
-&gt; ProgramDb
-&gt; Platform
-&gt; IO [ProgArg]
</span><a href="Distribution.Simple.Configure.html#getInstalledPackagesMonitorFiles"><span class="hs-identifier hs-var hs-var">getInstalledPackagesMonitorFiles</span></a></span></span><span> </span><span id="local-6989586621679565899"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565899"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565900"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565900"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679565901"><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir from))
</span><a href="#local-6989586621679565901"><span class="hs-identifier hs-var">mbWorkDir</span></a></span></span><span> </span><span id="local-6989586621679565902"><span class="annot"><span class="annottext">PackageDBStackS from
</span><a href="#local-6989586621679565902"><span class="hs-identifier hs-var">packageDBs</span></a></span></span><span> </span><span id="local-6989586621679565903"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565903"><span class="hs-identifier hs-var">progdb</span></a></span></span><span> </span><span id="local-6989586621679565904"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565904"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2105"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; CompilerFlavor
</span><a href="Distribution.Simple.Compiler.html#compilerFlavor"><span class="hs-identifier hs-var">compilerFlavor</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565900"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2106"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2107"></span><span>      </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; Platform
-&gt; ProgramDb
-&gt; PackageDBStackS from
-&gt; IO [ProgArg]
forall from.
Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; Platform
-&gt; ProgramDb
-&gt; [PackageDBS from]
-&gt; IO [ProgArg]
</span><a href="Distribution.Simple.GHC.html#getInstalledPackagesMonitorFiles"><span class="hs-identifier hs-var">GHC.getInstalledPackagesMonitorFiles</span></a></span><span>
</span><span id="line-2108"></span><span>        </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565899"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-2109"></span><span>        </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir from))
</span><a href="#local-6989586621679565901"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span>
</span><span id="line-2110"></span><span>        </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679565904"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-2111"></span><span>        </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565903"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2112"></span><span>        </span><span class="annot"><span class="annottext">PackageDBStackS from
</span><a href="#local-6989586621679565902"><span class="hs-identifier hs-var">packageDBs</span></a></span><span>
</span><span id="line-2113"></span><span>    </span><span id="local-6989586621679565906"><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="#local-6989586621679565906"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2114"></span><span>      </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565899"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; IO ()) -&gt; ProgArg -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2115"></span><span>        </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;don't know how to find change monitoring files for &quot;</span></span><span>
</span><span id="line-2116"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;the installed package databases for &quot;</span></span><span>
</span><span id="line-2117"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="#local-6989586621679565906"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-2118"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg] -&gt; IO [ProgArg]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2119"></span><span>
</span><span id="line-2120"></span><span class="hs-comment">-- | Looks up the 'InstalledPackageInfo' of the given 'UnitId's from the</span><span>
</span><span id="line-2121"></span><span class="hs-comment">-- 'PackageDBStack' in the 'LocalBuildInfo'.</span><span>
</span><span id="line-2122"></span><span id="local-6989586621679564076"><span class="annot"><a href="Distribution.Simple.Configure.html#getInstalledPackagesById"><span class="hs-identifier hs-type">getInstalledPackagesById</span></a></span><span>
</span><span id="line-2123"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Utils.html#VerboseException"><span class="hs-identifier hs-type">VerboseException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679564076"><span class="hs-identifier hs-type">exception</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679564076"><span class="hs-identifier hs-type">exception</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679564076"><span class="hs-identifier hs-type">exception</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2124"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2125"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-2126"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnitId.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679564076"><span class="hs-identifier hs-type">exception</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2127"></span><span>  </span><span class="hs-comment">-- ^ Construct an exception that is thrown if a</span><span>
</span><span id="line-2128"></span><span>  </span><span class="hs-comment">-- unit-id is not found in the installed packages,</span><span>
</span><span id="line-2129"></span><span>  </span><span class="hs-comment">-- from the unit-id that is missing.</span><span>
</span><span id="line-2130"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.UnitId.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2131"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The unit ids to lookup in the installed packages</span></span><span>
</span><span id="line-2132"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-2133"></span><span id="getInstalledPackagesById"><span class="annot"><span class="annottext">getInstalledPackagesById :: forall exception.
(Exception (VerboseException exception), Show exception,
 Typeable exception) =&gt;
Verbosity
-&gt; LocalBuildInfo
-&gt; (UnitId -&gt; exception)
-&gt; [UnitId]
-&gt; IO [InstalledPackageInfo]
</span><a href="Distribution.Simple.Configure.html#getInstalledPackagesById"><span class="hs-identifier hs-var hs-var">getInstalledPackagesById</span></a></span></span><span> </span><span id="local-6989586621679565919"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565919"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565920"><span class="annot"><span class="annottext">lbi :: LocalBuildInfo
</span><a href="#local-6989586621679565920"><span class="hs-identifier hs-var">lbi</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">compiler :: LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565922"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565922"><span class="hs-identifier hs-var">comp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withPackageDB :: LocalBuildInfo -&gt; PackageDBStack
</span><a href="Distribution.Types.LocalBuildInfo.html#withPackageDB"><span class="hs-identifier hs-var">withPackageDB</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565924"><span class="annot"><span class="annottext">PackageDBStack
</span><a href="#local-6989586621679565924"><span class="hs-identifier hs-var">pkgDb</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">withPrograms :: LocalBuildInfo -&gt; ProgramDb
</span><a href="Distribution.Types.LocalBuildInfo.html#withPrograms"><span class="hs-identifier hs-var">withPrograms</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679565926"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565926"><span class="hs-identifier hs-var">progDb</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679565927"><span class="annot"><span class="annottext">UnitId -&gt; exception
</span><a href="#local-6989586621679565927"><span class="hs-identifier hs-var">mkException</span></a></span></span><span> </span><span id="local-6989586621679565928"><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621679565928"><span class="hs-identifier hs-var">unitids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2134"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565929"><span class="annot"><span class="annottext">mbWorkDir :: Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679565929"><span class="hs-identifier hs-var hs-var hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.LocalBuildInfo.html#mbWorkDirLBI"><span class="hs-identifier hs-var">mbWorkDirLBI</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679565920"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2135"></span><span>  </span><span id="local-6989586621679565931"><span class="annot"><a href="#local-6989586621679565931"><span class="hs-identifier hs-var">ipindex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; PackageDBStack
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
forall from.
Verbosity
-&gt; Compiler
-&gt; Maybe (SymbolicPath CWD ('Dir from))
-&gt; PackageDBStackX (SymbolicPath from ('Dir PkgDB))
-&gt; ProgramDb
-&gt; IO InstalledPackageIndex
</span><a href="Distribution.Simple.Configure.html#getInstalledPackages"><span class="hs-identifier hs-var">getInstalledPackages</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565919"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679565922"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679565929"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDBStack
</span><a href="#local-6989586621679565924"><span class="hs-identifier hs-var">pkgDb</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565926"><span class="hs-identifier hs-var">progDb</span></a></span><span>
</span><span id="line-2136"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span>
</span><span id="line-2137"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565933"><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679565933"><span class="hs-identifier hs-var">uid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex -&gt; UnitId -&gt; Maybe InstalledPackageInfo
forall a. PackageIndex a -&gt; UnitId -&gt; Maybe a
</span><a href="Distribution.Simple.PackageIndex.html#lookupUnitId"><span class="hs-identifier hs-var">lookupUnitId</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565931"><span class="hs-identifier hs-var">ipindex</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679565933"><span class="hs-identifier hs-var">uid</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2138"></span><span>        </span><span class="annot"><span class="annottext">Maybe InstalledPackageInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; exception -&gt; IO InstalledPackageInfo
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565919"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitId -&gt; exception
</span><a href="#local-6989586621679565927"><span class="hs-identifier hs-var">mkException</span></a></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="#local-6989586621679565933"><span class="hs-identifier hs-var">uid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2139"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565934"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565934"><span class="hs-identifier hs-var">ipkg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; IO InstalledPackageInfo
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565934"><span class="hs-identifier hs-var">ipkg</span></a></span><span>
</span><span id="line-2140"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-2141"></span><span>    </span><span class="annot"><a href="#local-6989586621679565928"><span class="hs-identifier hs-type">unitids</span></a></span><span>
</span><span id="line-2142"></span><span>
</span><span id="line-2143"></span><span class="hs-comment">-- | The user interface specifies the package dbs to use with a combination of</span><span>
</span><span id="line-2144"></span><span class="hs-comment">-- @--global@, @--user@ and @--package-db=global|user|clear|$file@.</span><span>
</span><span id="line-2145"></span><span class="hs-comment">-- This function combines the global/user flag and interprets the package-db</span><span>
</span><span id="line-2146"></span><span class="hs-comment">-- flag into a single package db stack.</span><span>
</span><span id="line-2147"></span><span id="local-6989586621679563963"><span class="annot"><a href="Distribution.Simple.Configure.html#interpretPackageDbFlags"><span class="hs-identifier hs-type">interpretPackageDbFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Compiler.html#PackageDBX"><span class="hs-identifier hs-type">PackageDBX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679563963"><span class="hs-identifier hs-type">fp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#PackageDBStackX"><span class="hs-identifier hs-type">PackageDBStackX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679563963"><span class="hs-identifier hs-type">fp</span></a></span></span><span>
</span><span id="line-2148"></span><span id="interpretPackageDbFlags"><span class="annot"><span class="annottext">interpretPackageDbFlags :: forall fp. Bool -&gt; [Maybe (PackageDBX fp)] -&gt; PackageDBStackX fp
</span><a href="Distribution.Simple.Configure.html#interpretPackageDbFlags"><span class="hs-identifier hs-var hs-var">interpretPackageDbFlags</span></a></span></span><span> </span><span id="local-6989586621679565935"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565935"><span class="hs-identifier hs-var">userInstall</span></a></span></span><span> </span><span id="local-6989586621679565936"><span class="annot"><span class="annottext">[Maybe (PackageDBX fp)]
</span><a href="#local-6989586621679565936"><span class="hs-identifier hs-var">specificDBs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2149"></span><span>  </span><span class="annot"><span class="annottext">[PackageDBX fp] -&gt; [Maybe (PackageDBX fp)] -&gt; [PackageDBX fp]
forall {a}. [a] -&gt; [Maybe a] -&gt; [a]
</span><a href="#local-6989586621679565937"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">[PackageDBX fp]
forall {fp}. [PackageDBX fp]
</span><a href="#local-6989586621679565938"><span class="hs-identifier hs-var">initialStack</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe (PackageDBX fp)]
</span><a href="#local-6989586621679565936"><span class="hs-identifier hs-var">specificDBs</span></a></span><span>
</span><span id="line-2150"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2151"></span><span>    </span><span id="local-6989586621679565938"><span class="annot"><span class="annottext">initialStack :: [PackageDBX fp]
</span><a href="#local-6989586621679565938"><span class="hs-identifier hs-var hs-var">initialStack</span></a></span></span><span>
</span><span id="line-2152"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679565935"><span class="hs-identifier hs-var">userInstall</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PackageDBX fp
forall fp. PackageDBX fp
</span><a href="Distribution.Simple.Compiler.html#GlobalPackageDB"><span class="hs-identifier hs-var">GlobalPackageDB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PackageDBX fp
forall fp. PackageDBX fp
</span><a href="Distribution.Simple.Compiler.html#UserPackageDB"><span class="hs-identifier hs-var">UserPackageDB</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2153"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PackageDBX fp
forall fp. PackageDBX fp
</span><a href="Distribution.Simple.Compiler.html#GlobalPackageDB"><span class="hs-identifier hs-var">GlobalPackageDB</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2154"></span><span>
</span><span id="line-2155"></span><span>    </span><span id="local-6989586621679565937"><span class="annot"><span class="annottext">extra :: [a] -&gt; [Maybe a] -&gt; [a]
</span><a href="#local-6989586621679565937"><span class="hs-identifier hs-var hs-var">extra</span></a></span></span><span> </span><span id="local-6989586621679565939"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679565939"><span class="hs-identifier hs-var">dbs'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679565939"><span class="hs-identifier hs-var">dbs'</span></a></span><span>
</span><span id="line-2156"></span><span>    </span><span class="annot"><a href="#local-6989586621679565937"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679565940"><span class="annot"><span class="annottext">[Maybe a]
</span><a href="#local-6989586621679565940"><span class="hs-identifier hs-var">dbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [Maybe a] -&gt; [a]
</span><a href="#local-6989586621679565937"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Maybe a]
</span><a href="#local-6989586621679565940"><span class="hs-identifier hs-var">dbs</span></a></span><span>
</span><span id="line-2157"></span><span>    </span><span class="annot"><a href="#local-6989586621679565937"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span id="local-6989586621679565941"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679565941"><span class="hs-identifier hs-var">dbs'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565942"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679565942"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679565943"><span class="annot"><span class="annottext">[Maybe a]
</span><a href="#local-6989586621679565943"><span class="hs-identifier hs-var">dbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [Maybe a] -&gt; [a]
</span><a href="#local-6989586621679565937"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679565941"><span class="hs-identifier hs-var">dbs'</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679565942"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe a]
</span><a href="#local-6989586621679565943"><span class="hs-identifier hs-var">dbs</span></a></span><span>
</span><span id="line-2158"></span><span>
</span><span id="line-2159"></span><span class="hs-comment">-- We are given both --constraint=&quot;foo &lt; 2.0&quot; style constraints and also</span><span>
</span><span id="line-2160"></span><span class="hs-comment">-- specific packages to pick via --dependency=&quot;foo=foo-2.0-177d5cdf20962d0581&quot;.</span><span>
</span><span id="line-2161"></span><span class="hs-comment">--</span><span>
</span><span id="line-2162"></span><span class="hs-comment">-- When finalising the package we have to take into account the specific</span><span>
</span><span id="line-2163"></span><span class="hs-comment">-- installed deps we've been given, and the finalise function expects</span><span>
</span><span id="line-2164"></span><span class="hs-comment">-- constraints, so we have to translate these deps into version constraints.</span><span>
</span><span id="line-2165"></span><span class="hs-comment">--</span><span>
</span><span id="line-2166"></span><span class="hs-comment">-- But after finalising we then have to make sure we pick the right specific</span><span>
</span><span id="line-2167"></span><span class="hs-comment">-- deps in the end. So we still need to remember which installed packages to</span><span>
</span><span id="line-2168"></span><span class="hs-comment">-- pick.</span><span>
</span><span id="line-2169"></span><span class="annot"><a href="Distribution.Simple.Configure.html#combinedConstraints"><span class="hs-identifier hs-type">combinedConstraints</span></a></span><span>
</span><span id="line-2170"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageVersionConstraint.html#PackageVersionConstraint"><span class="hs-identifier hs-type">PackageVersionConstraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2171"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Types.GivenComponent.html#GivenComponent"><span class="hs-identifier hs-type">GivenComponent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2172"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ installed dependencies</span></span><span>
</span><span id="line-2173"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.PackageIndex.html#InstalledPackageIndex"><span class="hs-identifier hs-type">InstalledPackageIndex</span></a></span><span>
</span><span id="line-2174"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span>
</span><span id="line-2175"></span><span>      </span><span class="annot"><a href="Distribution.Simple.Errors.html#CabalException"><span class="hs-identifier hs-type">CabalException</span></a></span><span>
</span><span id="line-2176"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageVersionConstraint.html#PackageVersionConstraint"><span class="hs-identifier hs-type">PackageVersionConstraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2177"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span>
</span><span id="line-2178"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-2179"></span><span id="combinedConstraints"><span class="annot"><span class="annottext">combinedConstraints :: [PackageVersionConstraint]
-&gt; [GivenComponent]
-&gt; InstalledPackageIndex
-&gt; Either
     CabalException
     ([PackageVersionConstraint],
      Map (PackageName, ComponentName) InstalledPackageInfo)
</span><a href="Distribution.Simple.Configure.html#combinedConstraints"><span class="hs-identifier hs-var hs-var">combinedConstraints</span></a></span></span><span> </span><span id="local-6989586621679565944"><span class="annot"><span class="annottext">[PackageVersionConstraint]
</span><a href="#local-6989586621679565944"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679565945"><span class="annot"><span class="annottext">[GivenComponent]
</span><a href="#local-6989586621679565945"><span class="hs-identifier hs-var">dependencies</span></a></span></span><span> </span><span id="local-6989586621679565946"><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565946"><span class="hs-identifier hs-var">installedPackages</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2180"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Either CabalException () -&gt; Either CabalException ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(PackageName, ComponentName, ComponentId)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(PackageName, ComponentName, ComponentId)]
</span><a href="#local-6989586621679565947"><span class="hs-identifier hs-var">badComponentIds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either CabalException () -&gt; Either CabalException ())
-&gt; Either CabalException () -&gt; Either CabalException ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2181"></span><span>    </span><span class="annot"><span class="annottext">CabalException -&gt; Either CabalException ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; Either CabalException ())
-&gt; CabalException -&gt; Either CabalException ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2182"></span><span>      </span><span class="annot"><span class="annottext">Doc -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#CombinedConstraints"><span class="hs-identifier hs-var">CombinedConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(PackageName, ComponentName, ComponentId)] -&gt; Doc
forall {a} {a}.
(Pretty a, Pretty a) =&gt;
[(a, ComponentName, a)] -&gt; Doc
</span><a href="#local-6989586621679565949"><span class="hs-identifier hs-var">dispDependencies</span></a></span><span> </span><span class="annot"><span class="annottext">[(PackageName, ComponentName, ComponentId)]
</span><a href="#local-6989586621679565947"><span class="hs-identifier hs-var">badComponentIds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2183"></span><span>
</span><span id="line-2184"></span><span>  </span><span class="hs-comment">-- TODO: we don't check that all dependencies are used!</span><span>
</span><span id="line-2185"></span><span>
</span><span id="line-2186"></span><span>  </span><span class="annot"><span class="annottext">([PackageVersionConstraint],
 Map (PackageName, ComponentName) InstalledPackageInfo)
-&gt; Either
     CabalException
     ([PackageVersionConstraint],
      Map (PackageName, ComponentName) InstalledPackageInfo)
forall a. a -&gt; Either CabalException a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[PackageVersionConstraint]
</span><a href="#local-6989586621679565950"><span class="hs-identifier hs-var">allConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565951"><span class="hs-identifier hs-var">idConstraintMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2187"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2188"></span><span>    </span><span class="annot"><a href="#local-6989586621679565950"><span class="hs-identifier hs-type">allConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageVersionConstraint.html#PackageVersionConstraint"><span class="hs-identifier hs-type">PackageVersionConstraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2189"></span><span>    </span><span id="local-6989586621679565950"><span class="annot"><span class="annottext">allConstraints :: [PackageVersionConstraint]
</span><a href="#local-6989586621679565950"><span class="hs-identifier hs-var hs-var">allConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2190"></span><span>      </span><span class="annot"><span class="annottext">[PackageVersionConstraint]
</span><a href="#local-6989586621679565944"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-2191"></span><span>        </span><span class="annot"><span class="annottext">[PackageVersionConstraint]
-&gt; [PackageVersionConstraint] -&gt; [PackageVersionConstraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PackageIdentifier -&gt; PackageVersionConstraint
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageVersionConstraint.html#thisPackageVersionConstraint"><span class="hs-identifier hs-var">thisPackageVersionConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; PackageIdentifier
forall pkg. Package pkg =&gt; pkg -&gt; PackageIdentifier
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Package.html#packageId"><span class="hs-identifier hs-var">packageId</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565953"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2192"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565953"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565953"><span class="hs-identifier hs-var">pkg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(PackageName, ComponentName, ComponentId,
  Maybe InstalledPackageInfo)]
</span><a href="#local-6989586621679565954"><span class="hs-identifier hs-var">dependenciesPkgInfo</span></a></span><span>
</span><span id="line-2193"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-2194"></span><span>
</span><span id="line-2195"></span><span>    </span><span class="annot"><a href="#local-6989586621679565951"><span class="hs-identifier hs-type">idConstraintMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span>
</span><span id="line-2196"></span><span>    </span><span id="local-6989586621679565951"><span class="annot"><span class="annottext">idConstraintMap :: Map (PackageName, ComponentName) InstalledPackageInfo
</span><a href="#local-6989586621679565951"><span class="hs-identifier hs-var hs-var">idConstraintMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2197"></span><span>      </span><span class="annot"><span class="annottext">[((PackageName, ComponentName), InstalledPackageInfo)]
-&gt; Map (PackageName, ComponentName) InstalledPackageInfo
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span>
</span><span id="line-2198"></span><span>        </span><span class="hs-comment">-- NB: do NOT use the packageName from</span><span>
</span><span id="line-2199"></span><span>        </span><span class="hs-comment">-- dependenciesPkgInfo!</span><span>
</span><span id="line-2200"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565955"><span class="hs-identifier hs-var">pn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565956"><span class="hs-identifier hs-var">cname</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565957"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2201"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565955"><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565955"><span class="hs-identifier hs-var">pn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565956"><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565956"><span class="hs-identifier hs-var">cname</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentId
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565957"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679565957"><span class="hs-identifier hs-var">pkg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(PackageName, ComponentName, ComponentId,
  Maybe InstalledPackageInfo)]
</span><a href="#local-6989586621679565954"><span class="hs-identifier hs-var">dependenciesPkgInfo</span></a></span><span>
</span><span id="line-2202"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2203"></span><span>
</span><span id="line-2204"></span><span>    </span><span class="hs-comment">-- The dependencies along with the installed package info, if it exists</span><span>
</span><span id="line-2205"></span><span>    </span><span class="annot"><a href="#local-6989586621679565954"><span class="hs-identifier hs-type">dependenciesPkgInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageName.html#PackageName"><span class="hs-identifier hs-type">PackageName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#ComponentName"><span class="hs-identifier hs-type">ComponentName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentId.html#ComponentId"><span class="hs-identifier hs-type">ComponentId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#InstalledPackageInfo"><span class="hs-identifier hs-type">InstalledPackageInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2206"></span><span>    </span><span id="local-6989586621679565954"><span class="annot"><span class="annottext">dependenciesPkgInfo :: [(PackageName, ComponentName, ComponentId,
  Maybe InstalledPackageInfo)]
</span><a href="#local-6989586621679565954"><span class="hs-identifier hs-var hs-var">dependenciesPkgInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2207"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565958"><span class="hs-identifier hs-var">pkgname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LibraryName -&gt; ComponentName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-var">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565959"><span class="hs-identifier hs-var">lname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentId
</span><a href="#local-6989586621679565960"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe InstalledPackageInfo
</span><a href="#local-6989586621679565961"><span class="hs-identifier hs-var">mpkg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2208"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Distribution.Types.GivenComponent.html#GivenComponent"><span class="hs-identifier hs-type">GivenComponent</span></a></span><span> </span><span id="local-6989586621679565958"><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565958"><span class="hs-identifier hs-var">pkgname</span></a></span></span><span> </span><span id="local-6989586621679565959"><span class="annot"><span class="annottext">LibraryName
</span><a href="#local-6989586621679565959"><span class="hs-identifier hs-var">lname</span></a></span></span><span> </span><span id="local-6989586621679565960"><span class="annot"><span class="annottext">ComponentId
</span><a href="#local-6989586621679565960"><span class="hs-identifier hs-var">cid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[GivenComponent]
</span><a href="#local-6989586621679565945"><span class="hs-identifier hs-var">dependencies</span></a></span><span>
</span><span id="line-2209"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565961"><span class="annot"><span class="annottext">mpkg :: Maybe InstalledPackageInfo
</span><a href="#local-6989586621679565961"><span class="hs-identifier hs-var hs-var">mpkg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2210"></span><span>              </span><span class="annot"><span class="annottext">InstalledPackageIndex -&gt; ComponentId -&gt; Maybe InstalledPackageInfo
forall a. PackageIndex a -&gt; ComponentId -&gt; Maybe a
</span><a href="Distribution.Simple.PackageIndex.html#lookupComponentId"><span class="hs-identifier hs-var">PackageIndex.lookupComponentId</span></a></span><span>
</span><span id="line-2211"></span><span>                </span><span class="annot"><span class="annottext">InstalledPackageIndex
</span><a href="#local-6989586621679565946"><span class="hs-identifier hs-var">installedPackages</span></a></span><span>
</span><span id="line-2212"></span><span>                </span><span class="annot"><span class="annottext">ComponentId
</span><a href="#local-6989586621679565960"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-2213"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-2214"></span><span>
</span><span id="line-2215"></span><span>    </span><span class="hs-comment">-- If we looked up a package specified by an installed package id</span><span>
</span><span id="line-2216"></span><span>    </span><span class="hs-comment">-- (i.e. someone has written a hash) and didn't find it then it's</span><span>
</span><span id="line-2217"></span><span>    </span><span class="hs-comment">-- an error.</span><span>
</span><span id="line-2218"></span><span>    </span><span id="local-6989586621679565947"><span class="annot"><span class="annottext">badComponentIds :: [(PackageName, ComponentName, ComponentId)]
</span><a href="#local-6989586621679565947"><span class="hs-identifier hs-var hs-var">badComponentIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2219"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565964"><span class="hs-identifier hs-var">pkgname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565965"><span class="hs-identifier hs-var">cname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ComponentId
</span><a href="#local-6989586621679565966"><span class="hs-identifier hs-var">cid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2220"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565964"><span class="annot"><span class="annottext">PackageName
</span><a href="#local-6989586621679565964"><span class="hs-identifier hs-var">pkgname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565965"><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565965"><span class="hs-identifier hs-var">cname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565966"><span class="annot"><span class="annottext">ComponentId
</span><a href="#local-6989586621679565966"><span class="hs-identifier hs-var">cid</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe InstalledPackageInfo
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(PackageName, ComponentName, ComponentId,
  Maybe InstalledPackageInfo)]
</span><a href="#local-6989586621679565954"><span class="hs-identifier hs-var">dependenciesPkgInfo</span></a></span><span>
</span><span id="line-2221"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-2222"></span><span>
</span><span id="line-2223"></span><span>    </span><span id="local-6989586621679565949"><span class="annot"><span class="annottext">dispDependencies :: [(a, ComponentName, a)] -&gt; Doc
</span><a href="#local-6989586621679565949"><span class="hs-identifier hs-var hs-var">dispDependencies</span></a></span></span><span> </span><span id="local-6989586621679565978"><span class="annot"><span class="annottext">[(a, ComponentName, a)]
</span><a href="#local-6989586621679565978"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2224"></span><span>      </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span>
</span><span id="line-2225"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;--dependency=&quot;</span></span><span>
</span><span id="line-2226"></span><span>          </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html#%3C%3C%3E%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#quotes"><span class="hs-identifier hs-var">quotes</span></a></span><span>
</span><span id="line-2227"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679565980"><span class="hs-identifier hs-var">pkgname</span></a></span><span>
</span><span id="line-2228"></span><span>                </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html#%3C%3C%3E%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;&gt;</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565981"><span class="hs-identifier hs-var">cname</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2229"></span><span>                  </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-type">CLibName</span></a></span><span> </span><span class="annot"><span class="annottext">LibraryName
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LMainLibName"><span class="hs-identifier hs-var">LMainLibName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-2230"></span><span>                  </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentName.html#CLibName"><span class="hs-identifier hs-type">CLibName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LibraryName.html#LSubLibName"><span class="hs-identifier hs-type">LSubLibName</span></a></span><span> </span><span id="local-6989586621679565983"><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679565983"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html#%3C%3C%3E%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">UnqualComponentName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">UnqualComponentName
</span><a href="#local-6989586621679565983"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2231"></span><span>                  </span><span class="annot"><span class="annottext">ComponentName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html#%3C%3C%3E%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565981"><span class="hs-identifier hs-var">cname</span></a></span><span>
</span><span id="line-2232"></span><span>                </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html#%3C%3C%3E%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Doc
</span><a href="../../pretty-1.1.3.6-fe44/src/Text.PrettyPrint.HughesPJ.html#char"><span class="hs-identifier hs-var">char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span>
</span><span id="line-2233"></span><span>                </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Prelude.html#%3C%3C%3E%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679565984"><span class="hs-identifier hs-var">cid</span></a></span><span>
</span><span id="line-2234"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-2235"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565980"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679565980"><span class="hs-identifier hs-var">pkgname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565981"><span class="annot"><span class="annottext">ComponentName
</span><a href="#local-6989586621679565981"><span class="hs-identifier hs-var">cname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565984"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679565984"><span class="hs-identifier hs-var">cid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(a, ComponentName, a)]
</span><a href="#local-6989586621679565978"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-2236"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2237"></span><span>
</span><span id="line-2238"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2239"></span><span class="hs-comment">-- Configuring program dependencies</span><span>
</span><span id="line-2240"></span><span>
</span><span id="line-2241"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configureRequiredPrograms"><span class="hs-identifier hs-type">configureRequiredPrograms</span></a></span><span>
</span><span id="line-2242"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2243"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LegacyExeDependency.html#LegacyExeDependency"><span class="hs-identifier hs-type">LegacyExeDependency</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2244"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2245"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2246"></span><span id="configureRequiredPrograms"><span class="annot"><span class="annottext">configureRequiredPrograms :: Verbosity -&gt; [LegacyExeDependency] -&gt; ProgramDb -&gt; IO ProgramDb
</span><a href="Distribution.Simple.Configure.html#configureRequiredPrograms"><span class="hs-identifier hs-var hs-var">configureRequiredPrograms</span></a></span></span><span> </span><span id="local-6989586621679565985"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565985"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679565986"><span class="annot"><span class="annottext">[LegacyExeDependency]
</span><a href="#local-6989586621679565986"><span class="hs-identifier hs-var">deps</span></a></span></span><span> </span><span id="local-6989586621679565987"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565987"><span class="hs-identifier hs-var">progdb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2247"></span><span>  </span><span class="annot"><span class="annottext">(ProgramDb -&gt; LegacyExeDependency -&gt; IO ProgramDb)
-&gt; ProgramDb -&gt; [LegacyExeDependency] -&gt; IO ProgramDb
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Verbosity -&gt; ProgramDb -&gt; LegacyExeDependency -&gt; IO ProgramDb
</span><a href="Distribution.Simple.Configure.html#configureRequiredProgram"><span class="hs-identifier hs-var">configureRequiredProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565985"><span class="hs-identifier hs-var">verbosity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565987"><span class="hs-identifier hs-var">progdb</span></a></span><span> </span><span class="annot"><span class="annottext">[LegacyExeDependency]
</span><a href="#local-6989586621679565986"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-2248"></span><span>
</span><span id="line-2249"></span><span class="hs-comment">-- | Configure a required program, ensuring that it exists in the PATH</span><span>
</span><span id="line-2250"></span><span class="hs-comment">-- (or where the user has specified the program must live) and making it</span><span>
</span><span id="line-2251"></span><span class="hs-comment">-- available for use via the 'ProgramDb' interface.  If the program is</span><span>
</span><span id="line-2252"></span><span class="hs-comment">-- known (exists in the input 'ProgramDb'), we will make sure that the</span><span>
</span><span id="line-2253"></span><span class="hs-comment">-- program matches the required version; otherwise we will accept</span><span>
</span><span id="line-2254"></span><span class="hs-comment">-- any version of the program and assume that it is a simpleProgram.</span><span>
</span><span id="line-2255"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configureRequiredProgram"><span class="hs-identifier hs-type">configureRequiredProgram</span></a></span><span>
</span><span id="line-2256"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2257"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2258"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LegacyExeDependency.html#LegacyExeDependency"><span class="hs-identifier hs-type">LegacyExeDependency</span></a></span><span>
</span><span id="line-2259"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2260"></span><span id="configureRequiredProgram"><span class="annot"><span class="annottext">configureRequiredProgram :: Verbosity -&gt; ProgramDb -&gt; LegacyExeDependency -&gt; IO ProgramDb
</span><a href="Distribution.Simple.Configure.html#configureRequiredProgram"><span class="hs-identifier hs-var hs-var">configureRequiredProgram</span></a></span></span><span>
</span><span id="line-2261"></span><span>  </span><span id="local-6989586621679565991"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565991"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span>
</span><span id="line-2262"></span><span>  </span><span id="local-6989586621679565992"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565992"><span class="hs-identifier hs-var">progdb</span></a></span></span><span>
</span><span id="line-2263"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.LegacyExeDependency.html#LegacyExeDependency"><span class="hs-identifier hs-type">LegacyExeDependency</span></a></span><span> </span><span id="local-6989586621679565993"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565993"><span class="hs-identifier hs-var">progName</span></a></span></span><span> </span><span id="local-6989586621679565994"><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565994"><span class="hs-identifier hs-var">verRange</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2264"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgramDb -&gt; Maybe ConfiguredProgram
</span><a href="Distribution.Simple.Program.Db.html#lookupProgramByName"><span class="hs-identifier hs-var">lookupProgramByName</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565993"><span class="hs-identifier hs-var">progName</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565992"><span class="hs-identifier hs-var">progdb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2265"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565995"><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565995"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2266"></span><span>        </span><span class="hs-comment">-- If the program has already been configured, use it</span><span>
</span><span id="line-2267"></span><span>        </span><span class="hs-comment">-- (as long as the version is compatible).</span><span>
</span><span id="line-2268"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-2269"></span><span>        </span><span class="hs-comment">-- Not doing so means falling back to the &quot;simpleProgram&quot; path below,</span><span>
</span><span id="line-2270"></span><span>        </span><span class="hs-comment">-- which might fail if the program has custom logic to find a version</span><span>
</span><span id="line-2271"></span><span>        </span><span class="hs-comment">-- (such as hsc2hs).</span><span>
</span><span id="line-2272"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565996"><span class="annot"><span class="annottext">loc :: ProgArg
</span><a href="#local-6989586621679565996"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgramLocation -&gt; ProgArg
</span><a href="Distribution.Simple.Program.Types.html#locationPath"><span class="hs-identifier hs-var">locationPath</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgramLocation -&gt; ProgArg) -&gt; ProgramLocation -&gt; ProgArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; ProgramLocation
</span><a href="Distribution.Simple.Program.Types.html#programLocation"><span class="hs-identifier hs-var">programLocation</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565995"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-2273"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; Maybe Version
</span><a href="Distribution.Simple.Program.Types.html#programVersion"><span class="hs-identifier hs-var">programVersion</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565995"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2274"></span><span>              </span><span class="annot"><span class="annottext">Maybe Version
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2275"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565994"><span class="hs-identifier hs-var">verRange</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange -&gt; VersionRange -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.VersionRange.Internal.html#anyVersion"><span class="hs-identifier hs-var">anyVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2276"></span><span>                    </span><span class="annot"><span class="annottext">ProgramDb -&gt; IO ProgramDb
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565992"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2277"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2278"></span><span>                    </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ProgramDb
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565991"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ProgramDb) -&gt; CabalException -&gt; IO ProgramDb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span>
</span><span id="line-2279"></span><span>                      </span><span class="annot"><span class="annottext">ProgArg -&gt; VersionRange -&gt; ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#UnknownVersionDb"><span class="hs-identifier hs-var">UnknownVersionDb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; ProgArg
</span><a href="Distribution.Simple.Program.Types.html#programId"><span class="hs-identifier hs-var">programId</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565995"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565994"><span class="hs-identifier hs-var">verRange</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565996"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-2280"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679566002"><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679566002"><span class="hs-identifier hs-var">version</span></a></span></span><span>
</span><span id="line-2281"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Version -&gt; VersionRange -&gt; Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.VersionRange.html#withinRange"><span class="hs-identifier hs-var">withinRange</span></a></span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679566002"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565994"><span class="hs-identifier hs-var">verRange</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2282"></span><span>                    </span><span class="annot"><span class="annottext">ProgramDb -&gt; IO ProgramDb
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565992"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2283"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2284"></span><span>                    </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ProgramDb
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565991"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ProgramDb) -&gt; CabalException -&gt; IO ProgramDb
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span>
</span><span id="line-2285"></span><span>                      </span><span class="annot"><span class="annottext">ProgArg -&gt; Version -&gt; VersionRange -&gt; ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#BadVersionDb"><span class="hs-identifier hs-var">BadVersionDb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConfiguredProgram -&gt; ProgArg
</span><a href="Distribution.Simple.Program.Types.html#programId"><span class="hs-identifier hs-var">programId</span></a></span><span> </span><span class="annot"><span class="annottext">ConfiguredProgram
</span><a href="#local-6989586621679565995"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Version
</span><a href="#local-6989586621679566002"><span class="hs-identifier hs-var">version</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565994"><span class="hs-identifier hs-var">verRange</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565996"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-2286"></span><span>      </span><span class="annot"><span class="annottext">Maybe ConfiguredProgram
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2287"></span><span>        </span><span class="hs-comment">-- Otherwise, try to configure it as a 'simpleProgram' automatically</span><span>
</span><span id="line-2288"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgramDb -&gt; Maybe Program
</span><a href="Distribution.Simple.Program.Db.html#lookupKnownProgram"><span class="hs-identifier hs-var">lookupKnownProgram</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565993"><span class="hs-identifier hs-var">progName</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565992"><span class="hs-identifier hs-var">progdb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2289"></span><span>          </span><span class="annot"><span class="annottext">Maybe Program
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2290"></span><span>            </span><span class="hs-comment">-- There's a bit of a story behind this line.  In old versions</span><span>
</span><span id="line-2291"></span><span>            </span><span class="hs-comment">-- of Cabal, there were only internal build-tools dependencies.  So the</span><span>
</span><span id="line-2292"></span><span>            </span><span class="hs-comment">-- behavior in this case was:</span><span>
</span><span id="line-2293"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-2294"></span><span>            </span><span class="hs-comment">--    - If a build-tool dependency was internal, don't do</span><span>
</span><span id="line-2295"></span><span>            </span><span class="hs-comment">--      any checking.</span><span>
</span><span id="line-2296"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-2297"></span><span>            </span><span class="hs-comment">--    - If it was external, call 'configureRequiredProgram' to</span><span>
</span><span id="line-2298"></span><span>            </span><span class="hs-comment">--      &quot;configure&quot; the executable.  In particular, if</span><span>
</span><span id="line-2299"></span><span>            </span><span class="hs-comment">--      the program was not &quot;known&quot; (present in 'ProgramDb'),</span><span>
</span><span id="line-2300"></span><span>            </span><span class="hs-comment">--      then we would just error.  This was fine, because</span><span>
</span><span id="line-2301"></span><span>            </span><span class="hs-comment">--      the only way a program could be executed from 'ProgramDb'</span><span>
</span><span id="line-2302"></span><span>            </span><span class="hs-comment">--      is if some library code from Cabal actually called it,</span><span>
</span><span id="line-2303"></span><span>            </span><span class="hs-comment">--      and the pre-existing Cabal code only calls known</span><span>
</span><span id="line-2304"></span><span>            </span><span class="hs-comment">--      programs from 'defaultProgramDb', and so if it</span><span>
</span><span id="line-2305"></span><span>            </span><span class="hs-comment">--      is calling something else, you have a Custom setup</span><span>
</span><span id="line-2306"></span><span>            </span><span class="hs-comment">--      script, and in that case you are expected to register</span><span>
</span><span id="line-2307"></span><span>            </span><span class="hs-comment">--      the program you want to call in the ProgramDb.</span><span>
</span><span id="line-2308"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-2309"></span><span>            </span><span class="hs-comment">-- OK, so that was fine, until I (ezyang, in 2016) refactored</span><span>
</span><span id="line-2310"></span><span>            </span><span class="hs-comment">-- Cabal to support per-component builds.  In this case, what</span><span>
</span><span id="line-2311"></span><span>            </span><span class="hs-comment">-- was previously an internal build-tool dependency now became</span><span>
</span><span id="line-2312"></span><span>            </span><span class="hs-comment">-- an external one, and now previously &quot;internal&quot; dependencies</span><span>
</span><span id="line-2313"></span><span>            </span><span class="hs-comment">-- are now external.  But these are permitted to exist even</span><span>
</span><span id="line-2314"></span><span>            </span><span class="hs-comment">-- when they are not previously configured (something that</span><span>
</span><span id="line-2315"></span><span>            </span><span class="hs-comment">-- can only occur by a Custom script.)</span><span>
</span><span id="line-2316"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-2317"></span><span>            </span><span class="hs-comment">-- So, I decided, &quot;Fine, let's just accept these in any</span><span>
</span><span id="line-2318"></span><span>            </span><span class="hs-comment">-- case.&quot;  Thus this line.  The alternative would have been to</span><span>
</span><span id="line-2319"></span><span>            </span><span class="hs-comment">-- somehow detect when a build-tools dependency was &quot;internal&quot; (by</span><span>
</span><span id="line-2320"></span><span>            </span><span class="hs-comment">-- looking at the unflattened package description) but this</span><span>
</span><span id="line-2321"></span><span>            </span><span class="hs-comment">-- would also be incompatible with future work to support</span><span>
</span><span id="line-2322"></span><span>            </span><span class="hs-comment">-- external executable dependencies: we definitely cannot</span><span>
</span><span id="line-2323"></span><span>            </span><span class="hs-comment">-- assume they will be preinitialized in the 'ProgramDb'.</span><span>
</span><span id="line-2324"></span><span>            </span><span class="annot"><span class="annottext">Verbosity -&gt; Program -&gt; ProgramDb -&gt; IO ProgramDb
</span><a href="Distribution.Simple.Program.Db.html#configureProgram"><span class="hs-identifier hs-var">configureProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565991"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg -&gt; Program
</span><a href="Distribution.Simple.Program.Find.html#simpleProgram"><span class="hs-identifier hs-var">simpleProgram</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679565993"><span class="hs-identifier hs-var">progName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565992"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2325"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679566008"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679566008"><span class="hs-identifier hs-var">prog</span></a></span></span><span>
</span><span id="line-2326"></span><span>            </span><span class="hs-comment">-- requireProgramVersion always requires the program have a version</span><span>
</span><span id="line-2327"></span><span>            </span><span class="hs-comment">-- but if the user says &quot;build-depends: foo&quot; ie no version constraint</span><span>
</span><span id="line-2328"></span><span>            </span><span class="hs-comment">-- then we should not fail if we cannot discover the program version.</span><span>
</span><span id="line-2329"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565994"><span class="hs-identifier hs-var">verRange</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange -&gt; VersionRange -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.VersionRange.Internal.html#anyVersion"><span class="hs-identifier hs-var">anyVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2330"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566009"><span class="annot"><a href="#local-6989586621679566009"><span class="hs-identifier hs-var">progdb'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Program -&gt; ProgramDb -&gt; IO (ConfiguredProgram, ProgramDb)
</span><a href="Distribution.Simple.Program.Db.html#requireProgram"><span class="hs-identifier hs-var">requireProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565991"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679566008"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565992"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2331"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679566009"><span class="hs-identifier hs-type">progdb'</span></a></span><span>
</span><span id="line-2332"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2333"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566011"><span class="annot"><a href="#local-6989586621679566011"><span class="hs-identifier hs-var">progdb'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Program
-&gt; VersionRange
-&gt; ProgramDb
-&gt; IO (ConfiguredProgram, Version, ProgramDb)
</span><a href="Distribution.Simple.Program.Db.html#requireProgramVersion"><span class="hs-identifier hs-var">requireProgramVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679565991"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679566008"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">VersionRange
</span><a href="#local-6989586621679565994"><span class="hs-identifier hs-var">verRange</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679565992"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2334"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679566011"><span class="hs-identifier hs-type">progdb'</span></a></span><span>
</span><span id="line-2335"></span><span>
</span><span id="line-2336"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2337"></span><span class="hs-comment">-- Configuring pkg-config package dependencies</span><span>
</span><span id="line-2338"></span><span>
</span><span id="line-2339"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configurePkgconfigPackages"><span class="hs-identifier hs-type">configurePkgconfigPackages</span></a></span><span>
</span><span id="line-2340"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2341"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span>
</span><span id="line-2342"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2343"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ComponentRequestedSpec.html#ComponentRequestedSpec"><span class="hs-identifier hs-type">ComponentRequestedSpec</span></a></span><span>
</span><span id="line-2344"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2345"></span><span id="configurePkgconfigPackages"><span class="annot"><span class="annottext">configurePkgconfigPackages :: Verbosity
-&gt; PackageDescription
-&gt; ProgramDb
-&gt; ComponentRequestedSpec
-&gt; IO (PackageDescription, ProgramDb)
</span><a href="Distribution.Simple.Configure.html#configurePkgconfigPackages"><span class="hs-identifier hs-var hs-var">configurePkgconfigPackages</span></a></span></span><span> </span><span id="local-6989586621679566013"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566013"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679566014"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566014"><span class="hs-identifier hs-var">pkg_descr</span></a></span></span><span> </span><span id="local-6989586621679566015"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566015"><span class="hs-identifier hs-var">progdb</span></a></span></span><span> </span><span id="local-6989586621679566016"><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679566016"><span class="hs-identifier hs-var">enabled</span></a></span></span><span>
</span><span id="line-2346"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[PkgconfigDependency] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[PkgconfigDependency]
</span><a href="#local-6989586621679566017"><span class="hs-identifier hs-var">allpkgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PackageDescription, ProgramDb)
-&gt; IO (PackageDescription, ProgramDb)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566014"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566015"><span class="hs-identifier hs-var">progdb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2347"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2348"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566018"><span class="annot"><a href="#local-6989586621679566018"><span class="hs-identifier hs-var">progdb'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2349"></span><span>        </span><span class="annot"><span class="annottext">Verbosity
-&gt; Program
-&gt; VersionRange
-&gt; ProgramDb
-&gt; IO (ConfiguredProgram, Version, ProgramDb)
</span><a href="Distribution.Simple.Program.Db.html#requireProgramVersion"><span class="hs-identifier hs-var">requireProgramVersion</span></a></span><span>
</span><span id="line-2350"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Verbosity -&gt; Verbosity
</span><a href="Distribution.Verbosity.html#lessVerbose"><span class="hs-identifier hs-var">lessVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566013"><span class="hs-identifier hs-var">verbosity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2351"></span><span>          </span><span class="annot"><span class="annottext">Program
</span><a href="Distribution.Simple.Program.Builtin.html#pkgConfigProgram"><span class="hs-identifier hs-var">pkgConfigProgram</span></a></span><span>
</span><span id="line-2352"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Version -&gt; VersionRange
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.VersionRange.Internal.html#orLaterVersion"><span class="hs-identifier hs-var">orLaterVersion</span></a></span><span> </span><span class="annot"><span class="annottext">(Version -&gt; VersionRange) -&gt; Version -&gt; VersionRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-var">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2353"></span><span>          </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566015"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2354"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">traverse_</span></span><span> </span><span class="annot"><a href="#local-6989586621679566022"><span class="hs-identifier hs-type">requirePkg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566017"><span class="hs-identifier hs-type">allpkgs</span></a></span><span>
</span><span id="line-2355"></span><span>      </span><span id="local-6989586621679566023"><span class="annot"><a href="#local-6989586621679566023"><span class="hs-identifier hs-var">mlib'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="#local-6989586621679566025"><span class="hs-identifier hs-type">addPkgConfigBILib</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#library"><span class="hs-identifier hs-var">library</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566014"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2356"></span><span>      </span><span id="local-6989586621679566026"><span class="annot"><a href="#local-6989586621679566026"><span class="hs-identifier hs-var">libs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="#local-6989586621679566025"><span class="hs-identifier hs-type">addPkgConfigBILib</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#subLibraries"><span class="hs-identifier hs-var">subLibraries</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566014"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2357"></span><span>      </span><span id="local-6989586621679566027"><span class="annot"><a href="#local-6989586621679566027"><span class="hs-identifier hs-var">exes'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="#local-6989586621679566028"><span class="hs-identifier hs-type">addPkgConfigBIExe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#executables"><span class="hs-identifier hs-var">executables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566014"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2358"></span><span>      </span><span id="local-6989586621679566029"><span class="annot"><a href="#local-6989586621679566029"><span class="hs-identifier hs-var">tests'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="#local-6989586621679566030"><span class="hs-identifier hs-type">addPkgConfigBITest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#testSuites"><span class="hs-identifier hs-var">testSuites</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566014"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2359"></span><span>      </span><span id="local-6989586621679566031"><span class="annot"><a href="#local-6989586621679566031"><span class="hs-identifier hs-var">benches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="#local-6989586621679566032"><span class="hs-identifier hs-type">addPkgConfigBIBench</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#benchmarks"><span class="hs-identifier hs-var">benchmarks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566014"><span class="hs-identifier hs-type">pkg_descr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2360"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566033"><span class="annot"><a href="#local-6989586621679566033"><span class="hs-identifier hs-var hs-var">pkg_descr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2361"></span><span>            </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566014"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span>
</span><span id="line-2362"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#library"><span class="hs-identifier hs-var">library</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566023"><span class="hs-identifier hs-type">mlib'</span></a></span><span>
</span><span id="line-2363"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#subLibraries"><span class="hs-identifier hs-var">subLibraries</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566026"><span class="hs-identifier hs-type">libs'</span></a></span><span>
</span><span id="line-2364"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#executables"><span class="hs-identifier hs-var">executables</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566027"><span class="hs-identifier hs-type">exes'</span></a></span><span>
</span><span id="line-2365"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#testSuites"><span class="hs-identifier hs-var">testSuites</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566029"><span class="hs-identifier hs-type">tests'</span></a></span><span>
</span><span id="line-2366"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#benchmarks"><span class="hs-identifier hs-var">benchmarks</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566031"><span class="hs-identifier hs-type">benches'</span></a></span><span>
</span><span id="line-2367"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-2368"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679566033"><span class="hs-identifier hs-type">pkg_descr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679566018"><span class="hs-identifier hs-type">progdb'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2369"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2370"></span><span>    </span><span id="local-6989586621679566017"><span class="annot"><span class="annottext">allpkgs :: [PkgconfigDependency]
</span><a href="#local-6989586621679566017"><span class="hs-identifier hs-var hs-var">allpkgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [PkgconfigDependency])
-&gt; [BuildInfo] -&gt; [PkgconfigDependency]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [PkgconfigDependency]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#pkgconfigDepends"><span class="hs-identifier hs-var">pkgconfigDepends</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDescription -&gt; ComponentRequestedSpec -&gt; [BuildInfo]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#enabledBuildInfos"><span class="hs-identifier hs-var">enabledBuildInfos</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566014"><span class="hs-identifier hs-var">pkg_descr</span></a></span><span> </span><span class="annot"><span class="annottext">ComponentRequestedSpec
</span><a href="#local-6989586621679566016"><span class="hs-identifier hs-var">enabled</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2371"></span><span>    </span><span id="local-6989586621679566036"><span class="annot"><span class="annottext">pkgconfig :: [ProgArg] -&gt; IO ProgArg
</span><a href="#local-6989586621679566036"><span class="hs-identifier hs-var hs-var">pkgconfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2372"></span><span>      </span><span class="annot"><span class="annottext">Verbosity -&gt; Program -&gt; ProgramDb -&gt; [ProgArg] -&gt; IO ProgArg
</span><a href="Distribution.Simple.Program.html#getDbProgramOutput"><span class="hs-identifier hs-var">getDbProgramOutput</span></a></span><span>
</span><span id="line-2373"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Verbosity -&gt; Verbosity
</span><a href="Distribution.Verbosity.html#lessVerbose"><span class="hs-identifier hs-var">lessVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566013"><span class="hs-identifier hs-var">verbosity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2374"></span><span>        </span><span class="annot"><span class="annottext">Program
</span><a href="Distribution.Simple.Program.Builtin.html#pkgConfigProgram"><span class="hs-identifier hs-var">pkgConfigProgram</span></a></span><span>
</span><span id="line-2375"></span><span>        </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566015"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2376"></span><span>
</span><span id="line-2377"></span><span>    </span><span id="local-6989586621679566022"><span class="annot"><span class="annottext">requirePkg :: PkgconfigDependency -&gt; IO ()
</span><a href="#local-6989586621679566022"><span class="hs-identifier hs-var hs-var">requirePkg</span></a></span></span><span> </span><span id="local-6989586621679566056"><span class="annot"><span class="annottext">dep :: PkgconfigDependency
</span><a href="#local-6989586621679566056"><span class="hs-identifier hs-var">dep</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PkgconfigDependency.html#PkgconfigDependency"><span class="hs-identifier hs-type">PkgconfigDependency</span></a></span><span> </span><span id="local-6989586621679566058"><span class="annot"><span class="annottext">PkgconfigName
</span><a href="#local-6989586621679566058"><span class="hs-identifier hs-var">pkgn</span></a></span></span><span> </span><span id="local-6989586621679566059"><span class="annot"><span class="annottext">PkgconfigVersionRange
</span><a href="#local-6989586621679566059"><span class="hs-identifier hs-var">range</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2378"></span><span>      </span><span id="local-6989586621679566060"><span class="annot"><a href="#local-6989586621679566060"><span class="hs-identifier hs-var">version</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2379"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; IO ProgArg
</span><a href="#local-6989586621679566036"><span class="hs-identifier hs-var">pkgconfig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;--modversion&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566061"><span class="hs-identifier hs-var">pkg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2380"></span><span>          </span><span class="annot"><span class="annottext">IO ProgArg -&gt; (IOException -&gt; IO ProgArg) -&gt; IO ProgArg
forall a. IO a -&gt; (IOException -&gt; IO a) -&gt; IO a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Exception.html#catchIO"><span class="hs-operator hs-var">`catchIO`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ProgArg
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566013"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ProgArg) -&gt; CabalException -&gt; IO ProgArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#PkgConfigNotFound"><span class="hs-identifier hs-var">PkgConfigNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566061"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566064"><span class="hs-identifier hs-var">versionRequirement</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2381"></span><span>          </span><span class="annot"><span class="annottext">IO ProgArg -&gt; (ExitCode -&gt; IO ProgArg) -&gt; IO ProgArg
forall a. IO a -&gt; (ExitCode -&gt; IO a) -&gt; IO a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Exception.html#catchExit"><span class="hs-operator hs-var">`catchExit`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">ExitCode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ProgArg
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566013"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ProgArg) -&gt; CabalException -&gt; IO ProgArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#PkgConfigNotFound"><span class="hs-identifier hs-var">PkgConfigNotFound</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566061"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566064"><span class="hs-identifier hs-var">versionRequirement</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2382"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566066"><span class="annot"><a href="#local-6989586621679566066"><span class="hs-identifier hs-var hs-var">trim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ShowS
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhileEnd</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-2383"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566070"><span class="annot"><a href="#local-6989586621679566070"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PkgconfigVersion
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PkgconfigVersion.html#PkgconfigVersion"><span class="hs-identifier hs-var">PkgconfigVersion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg -&gt; ByteString
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#toUTF8BS"><span class="hs-identifier hs-var">toUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; ByteString) -&gt; ProgArg -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679566066"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566060"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2384"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PkgconfigVersionRange.html#withinPkgconfigVersionRange"><span class="hs-identifier hs-type">withinPkgconfigVersionRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566070"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566059"><span class="hs-identifier hs-type">range</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2385"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-type">dieWithException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566013"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#BadVersion"><span class="hs-identifier hs-type">BadVersion</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566061"><span class="hs-identifier hs-type">pkg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566064"><span class="hs-identifier hs-type">versionRequirement</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566070"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-2386"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="Distribution.Simple.Utils.html#info"><span class="hs-identifier hs-type">info</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566013"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679566075"><span class="hs-identifier hs-type">depSatisfied</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566070"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2387"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2388"></span><span>        </span><span id="local-6989586621679566075"><span class="annot"><span class="annottext">depSatisfied :: a -&gt; ProgArg
</span><a href="#local-6989586621679566075"><span class="hs-identifier hs-var hs-var">depSatisfied</span></a></span></span><span> </span><span id="local-6989586621679566083"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566083"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2389"></span><span>          </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Dependency &quot;</span></span><span>
</span><span id="line-2390"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PkgconfigDependency -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">PkgconfigDependency
</span><a href="#local-6989586621679566056"><span class="hs-identifier hs-var">dep</span></a></span><span>
</span><span id="line-2391"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;: using version &quot;</span></span><span>
</span><span id="line-2392"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679566083"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-2393"></span><span>
</span><span id="line-2394"></span><span>        </span><span id="local-6989586621679566064"><span class="annot"><span class="annottext">versionRequirement :: ProgArg
</span><a href="#local-6989586621679566064"><span class="hs-identifier hs-var hs-var">versionRequirement</span></a></span></span><span>
</span><span id="line-2395"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PkgconfigVersionRange -&gt; Bool
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PkgconfigVersionRange.html#isAnyPkgconfigVersion"><span class="hs-identifier hs-var">isAnyPkgconfigVersion</span></a></span><span> </span><span class="annot"><span class="annottext">PkgconfigVersionRange
</span><a href="#local-6989586621679566059"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-2396"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; version &quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">PkgconfigVersionRange -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">PkgconfigVersionRange
</span><a href="#local-6989586621679566059"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-2397"></span><span>
</span><span id="line-2398"></span><span>        </span><span id="local-6989586621679566061"><span class="annot"><span class="annottext">pkg :: ProgArg
</span><a href="#local-6989586621679566061"><span class="hs-identifier hs-var hs-var">pkg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PkgconfigName -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PkgconfigName.html#unPkgconfigName"><span class="hs-identifier hs-var">unPkgconfigName</span></a></span><span> </span><span class="annot"><span class="annottext">PkgconfigName
</span><a href="#local-6989586621679566058"><span class="hs-identifier hs-var">pkgn</span></a></span><span>
</span><span id="line-2399"></span><span>
</span><span id="line-2400"></span><span>    </span><span class="hs-comment">-- Adds pkgconfig dependencies to the build info for a component</span><span>
</span><span id="line-2401"></span><span>    </span><span id="local-6989586621679566094"><span class="annot"><span class="annottext">addPkgConfigBI :: (t -&gt; BuildInfo) -&gt; (t -&gt; BuildInfo -&gt; b) -&gt; t -&gt; IO b
</span><a href="#local-6989586621679566094"><span class="hs-identifier hs-var hs-var">addPkgConfigBI</span></a></span></span><span> </span><span id="local-6989586621679566095"><span class="annot"><span class="annottext">t -&gt; BuildInfo
</span><a href="#local-6989586621679566095"><span class="hs-identifier hs-var">compBI</span></a></span></span><span> </span><span id="local-6989586621679566096"><span class="annot"><span class="annottext">t -&gt; BuildInfo -&gt; b
</span><a href="#local-6989586621679566096"><span class="hs-identifier hs-var">setCompBI</span></a></span></span><span> </span><span id="local-6989586621679566097"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679566097"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2402"></span><span>      </span><span id="local-6989586621679566098"><span class="annot"><a href="#local-6989586621679566098"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PkgconfigDependency] -&gt; IO BuildInfo
</span><a href="#local-6989586621679566099"><span class="hs-identifier hs-var">pkgconfigBuildInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildInfo -&gt; [PkgconfigDependency]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#pkgconfigDepends"><span class="hs-identifier hs-var">pkgconfigDepends</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; BuildInfo
</span><a href="#local-6989586621679566095"><span class="hs-identifier hs-var">compBI</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679566097"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2403"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679566096"><span class="hs-identifier hs-type">setCompBI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566097"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679566095"><span class="hs-identifier hs-type">compBI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566097"><span class="hs-identifier hs-type">comp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`mappend`</span></span><span> </span><span class="annot"><a href="#local-6989586621679566098"><span class="hs-identifier hs-type">bi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2404"></span><span>
</span><span id="line-2405"></span><span>    </span><span class="hs-comment">-- Adds pkgconfig dependencies to the build info for a library</span><span>
</span><span id="line-2406"></span><span>    </span><span id="local-6989586621679566025"><span class="annot"><span class="annottext">addPkgConfigBILib :: Library -&gt; IO Library
</span><a href="#local-6989586621679566025"><span class="hs-identifier hs-var hs-var">addPkgConfigBILib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Library -&gt; BuildInfo)
-&gt; (Library -&gt; BuildInfo -&gt; Library) -&gt; Library -&gt; IO Library
forall {t} {b}.
(t -&gt; BuildInfo) -&gt; (t -&gt; BuildInfo -&gt; b) -&gt; t -&gt; IO b
</span><a href="#local-6989586621679566094"><span class="hs-identifier hs-var">addPkgConfigBI</span></a></span><span> </span><span class="annot"><span class="annottext">Library -&gt; BuildInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#libBuildInfo"><span class="hs-identifier hs-var">libBuildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">((Library -&gt; BuildInfo -&gt; Library) -&gt; Library -&gt; IO Library)
-&gt; (Library -&gt; BuildInfo -&gt; Library) -&gt; Library -&gt; IO Library
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2407"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679566100"><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679566100"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span id="local-6989586621679566101"><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679566101"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Library
</span><a href="#local-6989586621679566100"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">{</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Library.html#libBuildInfo"><span class="hs-identifier hs-var">libBuildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566101"><span class="hs-identifier hs-type">bi</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-2408"></span><span>
</span><span id="line-2409"></span><span>    </span><span class="hs-comment">-- Adds pkgconfig dependencies to the build info for an executable</span><span>
</span><span id="line-2410"></span><span>    </span><span id="local-6989586621679566028"><span class="annot"><span class="annottext">addPkgConfigBIExe :: Executable -&gt; IO Executable
</span><a href="#local-6989586621679566028"><span class="hs-identifier hs-var hs-var">addPkgConfigBIExe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Executable -&gt; BuildInfo)
-&gt; (Executable -&gt; BuildInfo -&gt; Executable)
-&gt; Executable
-&gt; IO Executable
forall {t} {b}.
(t -&gt; BuildInfo) -&gt; (t -&gt; BuildInfo -&gt; b) -&gt; t -&gt; IO b
</span><a href="#local-6989586621679566094"><span class="hs-identifier hs-var">addPkgConfigBI</span></a></span><span> </span><span class="annot"><span class="annottext">Executable -&gt; BuildInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Executable.html#buildInfo"><span class="hs-identifier hs-var">buildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">((Executable -&gt; BuildInfo -&gt; Executable)
 -&gt; Executable -&gt; IO Executable)
-&gt; (Executable -&gt; BuildInfo -&gt; Executable)
-&gt; Executable
-&gt; IO Executable
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2411"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679566102"><span class="annot"><span class="annottext">Executable
</span><a href="#local-6989586621679566102"><span class="hs-identifier hs-var">exe</span></a></span></span><span> </span><span id="local-6989586621679566103"><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679566103"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Executable
</span><a href="#local-6989586621679566102"><span class="hs-identifier hs-var">exe</span></a></span><span class="hs-special">{</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Executable.html#buildInfo"><span class="hs-identifier hs-var">buildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566103"><span class="hs-identifier hs-type">bi</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-2412"></span><span>
</span><span id="line-2413"></span><span>    </span><span class="hs-comment">-- Adds pkgconfig dependencies to the build info for a test suite</span><span>
</span><span id="line-2414"></span><span>    </span><span id="local-6989586621679566030"><span class="annot"><span class="annottext">addPkgConfigBITest :: TestSuite -&gt; IO TestSuite
</span><a href="#local-6989586621679566030"><span class="hs-identifier hs-var hs-var">addPkgConfigBITest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TestSuite -&gt; BuildInfo)
-&gt; (TestSuite -&gt; BuildInfo -&gt; TestSuite)
-&gt; TestSuite
-&gt; IO TestSuite
forall {t} {b}.
(t -&gt; BuildInfo) -&gt; (t -&gt; BuildInfo -&gt; b) -&gt; t -&gt; IO b
</span><a href="#local-6989586621679566094"><span class="hs-identifier hs-var">addPkgConfigBI</span></a></span><span> </span><span class="annot"><span class="annottext">TestSuite -&gt; BuildInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.TestSuite.html#testBuildInfo"><span class="hs-identifier hs-var">testBuildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">((TestSuite -&gt; BuildInfo -&gt; TestSuite)
 -&gt; TestSuite -&gt; IO TestSuite)
-&gt; (TestSuite -&gt; BuildInfo -&gt; TestSuite)
-&gt; TestSuite
-&gt; IO TestSuite
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2415"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679566104"><span class="annot"><span class="annottext">TestSuite
</span><a href="#local-6989586621679566104"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679566105"><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679566105"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestSuite
</span><a href="#local-6989586621679566104"><span class="hs-identifier hs-var">test</span></a></span><span class="hs-special">{</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.TestSuite.html#testBuildInfo"><span class="hs-identifier hs-var">testBuildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566105"><span class="hs-identifier hs-type">bi</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-2416"></span><span>
</span><span id="line-2417"></span><span>    </span><span class="hs-comment">-- Adds pkgconfig dependencies to the build info for a benchmark</span><span>
</span><span id="line-2418"></span><span>    </span><span id="local-6989586621679566032"><span class="annot"><span class="annottext">addPkgConfigBIBench :: Benchmark -&gt; IO Benchmark
</span><a href="#local-6989586621679566032"><span class="hs-identifier hs-var hs-var">addPkgConfigBIBench</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Benchmark -&gt; BuildInfo)
-&gt; (Benchmark -&gt; BuildInfo -&gt; Benchmark)
-&gt; Benchmark
-&gt; IO Benchmark
forall {t} {b}.
(t -&gt; BuildInfo) -&gt; (t -&gt; BuildInfo -&gt; b) -&gt; t -&gt; IO b
</span><a href="#local-6989586621679566094"><span class="hs-identifier hs-var">addPkgConfigBI</span></a></span><span> </span><span class="annot"><span class="annottext">Benchmark -&gt; BuildInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Benchmark.html#benchmarkBuildInfo"><span class="hs-identifier hs-var">benchmarkBuildInfo</span></a></span><span> </span><span class="annot"><span class="annottext">((Benchmark -&gt; BuildInfo -&gt; Benchmark)
 -&gt; Benchmark -&gt; IO Benchmark)
-&gt; (Benchmark -&gt; BuildInfo -&gt; Benchmark)
-&gt; Benchmark
-&gt; IO Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2419"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679566106"><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621679566106"><span class="hs-identifier hs-var">bench</span></a></span></span><span> </span><span id="local-6989586621679566107"><span class="annot"><span class="annottext">BuildInfo
</span><a href="#local-6989586621679566107"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621679566106"><span class="hs-identifier hs-var">bench</span></a></span><span class="hs-special">{</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Benchmark.html#benchmarkBuildInfo"><span class="hs-identifier hs-var">benchmarkBuildInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566107"><span class="hs-identifier hs-type">bi</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-2420"></span><span>
</span><span id="line-2421"></span><span>    </span><span class="annot"><a href="#local-6989586621679566099"><span class="hs-identifier hs-type">pkgconfigBuildInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PkgconfigDependency.html#PkgconfigDependency"><span class="hs-identifier hs-type">PkgconfigDependency</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#BuildInfo"><span class="hs-identifier hs-type">BuildInfo</span></a></span><span>
</span><span id="line-2422"></span><span>    </span><span id="local-6989586621679566099"><span class="annot"><span class="annottext">pkgconfigBuildInfo :: [PkgconfigDependency] -&gt; IO BuildInfo
</span><a href="#local-6989586621679566099"><span class="hs-identifier hs-var hs-var">pkgconfigBuildInfo</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; IO BuildInfo
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">BuildInfo
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-2423"></span><span>    </span><span class="annot"><a href="#local-6989586621679566099"><span class="hs-identifier hs-var">pkgconfigBuildInfo</span></a></span><span> </span><span id="local-6989586621679566108"><span class="annot"><span class="annottext">[PkgconfigDependency]
</span><a href="#local-6989586621679566108"><span class="hs-identifier hs-var">pkgdeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2424"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566113"><span class="annot"><span class="annottext">pkgs :: [ProgArg]
</span><a href="#local-6989586621679566113"><span class="hs-identifier hs-var hs-var hs-var">pkgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PkgconfigName -&gt; ProgArg
forall a. Pretty a =&gt; a -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">PkgconfigName
</span><a href="#local-6989586621679566114"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PkgconfigDependency.html#PkgconfigDependency"><span class="hs-identifier hs-type">PkgconfigDependency</span></a></span><span> </span><span id="local-6989586621679566114"><span class="annot"><span class="annottext">PkgconfigName
</span><a href="#local-6989586621679566114"><span class="hs-identifier hs-var">pkg</span></a></span></span><span> </span><span class="annot"><span class="annottext">PkgconfigVersionRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PkgconfigDependency]
</span><a href="#local-6989586621679566108"><span class="hs-identifier hs-var">pkgdeps</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2425"></span><span>      </span><span id="local-6989586621679566115"><span class="annot"><a href="#local-6989586621679566115"><span class="hs-identifier hs-var">ccflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; IO ProgArg
</span><a href="#local-6989586621679566036"><span class="hs-identifier hs-var">pkgconfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;--cflags&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; [ProgArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566113"><span class="hs-identifier hs-var">pkgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2426"></span><span>      </span><span id="local-6989586621679566116"><span class="annot"><a href="#local-6989586621679566116"><span class="hs-identifier hs-var">ldflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679566036"><span class="hs-identifier hs-type">pkgconfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;--libs&quot;</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679566113"><span class="hs-identifier hs-type">pkgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2427"></span><span>      </span><span id="local-6989586621679566117"><span class="annot"><a href="#local-6989586621679566117"><span class="hs-identifier hs-var">ldflags_static</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679566036"><span class="hs-identifier hs-type">pkgconfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;--libs&quot;</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;--static&quot;</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679566113"><span class="hs-identifier hs-type">pkgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2428"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Configure.html#ccLdOptionsBuildInfo"><span class="hs-identifier hs-type">ccLdOptionsBuildInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">words</span></span><span> </span><span class="annot"><a href="#local-6989586621679566115"><span class="hs-identifier hs-type">ccflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">words</span></span><span> </span><span class="annot"><a href="#local-6989586621679566116"><span class="hs-identifier hs-type">ldflags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">words</span></span><span> </span><span class="annot"><a href="#local-6989586621679566117"><span class="hs-identifier hs-type">ldflags_static</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2429"></span><span>
</span><span id="line-2430"></span><span class="hs-comment">-- | Makes a 'BuildInfo' from C compiler and linker flags.</span><span>
</span><span id="line-2431"></span><span class="hs-comment">--</span><span>
</span><span id="line-2432"></span><span class="hs-comment">-- This can be used with the output from configuration programs like pkg-config</span><span>
</span><span id="line-2433"></span><span class="hs-comment">-- and similar package-specific programs like mysql-config, freealut-config etc.</span><span>
</span><span id="line-2434"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-2435"></span><span class="hs-comment">--</span><span>
</span><span id="line-2436"></span><span class="hs-comment">-- &gt; ccflags &lt;- getDbProgramOutput verbosity prog progdb [&quot;--cflags&quot;]</span><span>
</span><span id="line-2437"></span><span class="hs-comment">-- &gt; ldflags &lt;- getDbProgramOutput verbosity prog progdb [&quot;--libs&quot;]</span><span>
</span><span id="line-2438"></span><span class="hs-comment">-- &gt; ldflags_static &lt;- getDbProgramOutput verbosity prog progdb [&quot;--libs&quot;, &quot;--static&quot;]</span><span>
</span><span id="line-2439"></span><span class="hs-comment">-- &gt; return (ccldOptionsBuildInfo (words ccflags) (words ldflags) (words ldflags_static))</span><span>
</span><span id="line-2440"></span><span class="annot"><a href="Distribution.Simple.Configure.html#ccLdOptionsBuildInfo"><span class="hs-identifier hs-type">ccLdOptionsBuildInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#BuildInfo"><span class="hs-identifier hs-type">BuildInfo</span></a></span><span>
</span><span id="line-2441"></span><span id="ccLdOptionsBuildInfo"><span class="annot"><span class="annottext">ccLdOptionsBuildInfo :: [ProgArg] -&gt; [ProgArg] -&gt; [ProgArg] -&gt; BuildInfo
</span><a href="Distribution.Simple.Configure.html#ccLdOptionsBuildInfo"><span class="hs-identifier hs-var hs-var">ccLdOptionsBuildInfo</span></a></span></span><span> </span><span id="local-6989586621679566119"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566119"><span class="hs-identifier hs-var">cflags</span></a></span></span><span> </span><span id="local-6989586621679566120"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566120"><span class="hs-identifier hs-var">ldflags</span></a></span></span><span> </span><span id="local-6989586621679566121"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566121"><span class="hs-identifier hs-var">ldflags_static</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2442"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679566125"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566125"><span class="hs-identifier hs-var">includeDirs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566126"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566126"><span class="hs-identifier hs-var">cflags'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Bool) -&gt; [ProgArg] -&gt; ([ProgArg], [ProgArg])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-I&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566119"><span class="hs-identifier hs-var">cflags</span></a></span><span>
</span><span id="line-2443"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679566131"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566131"><span class="hs-identifier hs-var">extraLibs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566132"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566132"><span class="hs-identifier hs-var">ldflags'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Bool) -&gt; [ProgArg] -&gt; ([ProgArg], [ProgArg])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-l&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566120"><span class="hs-identifier hs-var">ldflags</span></a></span><span>
</span><span id="line-2444"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679566136"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566136"><span class="hs-identifier hs-var">extraLibDirs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566137"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566137"><span class="hs-identifier hs-var">ldflags''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Bool) -&gt; [ProgArg] -&gt; ([ProgArg], [ProgArg])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-L&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566132"><span class="hs-identifier hs-var">ldflags'</span></a></span><span>
</span><span id="line-2445"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679566141"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566141"><span class="hs-identifier hs-var">extraLibsStatic'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Bool) -&gt; [ProgArg] -&gt; [ProgArg]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-l&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566121"><span class="hs-identifier hs-var">ldflags_static</span></a></span><span>
</span><span id="line-2446"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679566145"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566145"><span class="hs-identifier hs-var">extraLibDirsStatic'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Bool) -&gt; [ProgArg] -&gt; [ProgArg]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-L&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566121"><span class="hs-identifier hs-var">ldflags_static</span></a></span><span>
</span><span id="line-2447"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">BuildInfo
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-2448"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#includeDirs"><span class="hs-identifier hs-var">includeDirs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeSymbolicPath"><span class="hs-identifier hs-type">makeSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679566125"><span class="hs-identifier hs-type">includeDirs'</span></a></span><span>
</span><span id="line-2449"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibs"><span class="hs-identifier hs-var">extraLibs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679566131"><span class="hs-identifier hs-type">extraLibs'</span></a></span><span>
</span><span id="line-2450"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirs"><span class="hs-identifier hs-var">extraLibDirs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeSymbolicPath"><span class="hs-identifier hs-type">makeSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679566136"><span class="hs-identifier hs-type">extraLibDirs'</span></a></span><span>
</span><span id="line-2451"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibsStatic"><span class="hs-identifier hs-var">extraLibsStatic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679566141"><span class="hs-identifier hs-type">extraLibsStatic'</span></a></span><span>
</span><span id="line-2452"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirsStatic"><span class="hs-identifier hs-var">extraLibDirsStatic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeSymbolicPath"><span class="hs-identifier hs-type">makeSymbolicPath</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">drop</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679566145"><span class="hs-identifier hs-type">extraLibDirsStatic'</span></a></span><span>
</span><span id="line-2453"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#ccOptions"><span class="hs-identifier hs-var">ccOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566126"><span class="hs-identifier hs-type">cflags'</span></a></span><span>
</span><span id="line-2454"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#ldOptions"><span class="hs-identifier hs-var">ldOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679566137"><span class="hs-identifier hs-type">ldflags''</span></a></span><span>
</span><span id="line-2455"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-2456"></span><span>
</span><span id="line-2457"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2458"></span><span class="hs-comment">-- Determining the compiler details</span><span>
</span><span id="line-2459"></span><span>
</span><span id="line-2460"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configCompilerAuxEx"><span class="hs-identifier hs-type">configCompilerAuxEx</span></a></span><span>
</span><span id="line-2461"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#ConfigFlags"><span class="hs-identifier hs-type">ConfigFlags</span></a></span><span>
</span><span id="line-2462"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2463"></span><span id="configCompilerAuxEx"><span class="annot"><span class="annottext">configCompilerAuxEx :: ConfigFlags -&gt; IO (Compiler, Platform, ProgramDb)
</span><a href="Distribution.Simple.Configure.html#configCompilerAuxEx"><span class="hs-identifier hs-var hs-var">configCompilerAuxEx</span></a></span></span><span> </span><span id="local-6989586621679566151"><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679566151"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2464"></span><span>  </span><span id="local-6989586621679566152"><span class="annot"><a href="#local-6989586621679566152"><span class="hs-identifier hs-var">programDb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; ProgramDb -&gt; IO ProgramDb
</span><a href="Distribution.Simple.Configure.html#mkProgramDb"><span class="hs-identifier hs-var">mkProgramDb</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679566151"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="Distribution.Simple.Program.Db.html#defaultProgramDb"><span class="hs-identifier hs-var">defaultProgramDb</span></a></span><span>
</span><span id="line-2465"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566154"><span class="annot"><a href="#local-6989586621679566154"><span class="hs-identifier hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigFlags
</span><a href="#local-6989586621679566151"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-2466"></span><span>      </span><span id="local-6989586621679566157"><span class="annot"><a href="#local-6989586621679566157"><span class="hs-identifier hs-var hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Flag Verbosity -&gt; Verbosity
forall a. WithCallStack (Flag a -&gt; a)
</span><a href="Distribution.Simple.Flag.html#fromFlag"><span class="hs-identifier hs-var">fromFlag</span></a></span><span> </span><span class="annot"><span class="annottext">(Flag Verbosity -&gt; Verbosity) -&gt; Flag Verbosity -&gt; Verbosity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; Flag Verbosity
</span><a href="Distribution.Simple.Setup.Common.html#setupVerbosity"><span class="hs-identifier hs-var">setupVerbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679566154"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-2467"></span><span>  </span><span class="annot"><a href="Distribution.Simple.Configure.html#configCompilerEx"><span class="hs-identifier hs-type">configCompilerEx</span></a></span><span>
</span><span id="line-2468"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-type">flagToMaybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configHcFlavor"><span class="hs-identifier hs-var">configHcFlavor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566151"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2469"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-type">flagToMaybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configHcPath"><span class="hs-identifier hs-var">configHcPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566151"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2470"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Flag.html#flagToMaybe"><span class="hs-identifier hs-type">flagToMaybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Setup.Config.html#configHcPkg"><span class="hs-identifier hs-var">configHcPkg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566151"><span class="hs-identifier hs-type">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2471"></span><span>    </span><span class="annot"><a href="#local-6989586621679566152"><span class="hs-identifier hs-type">programDb</span></a></span><span>
</span><span id="line-2472"></span><span>    </span><span class="annot"><a href="#local-6989586621679566157"><span class="hs-identifier hs-type">verbosity</span></a></span><span>
</span><span id="line-2473"></span><span>
</span><span id="line-2474"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configCompilerEx"><span class="hs-identifier hs-type">configCompilerEx</span></a></span><span>
</span><span id="line-2475"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#CompilerFlavor"><span class="hs-identifier hs-type">CompilerFlavor</span></a></span><span>
</span><span id="line-2476"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-2477"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-2478"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span>
</span><span id="line-2479"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2480"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Simple.Program.Db.html#ProgramDb"><span class="hs-identifier hs-type">ProgramDb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2481"></span><span id="configCompilerEx"><span class="annot"><span class="annottext">configCompilerEx :: Maybe CompilerFlavor
-&gt; Maybe ProgArg
-&gt; Maybe ProgArg
-&gt; ProgramDb
-&gt; Verbosity
-&gt; IO (Compiler, Platform, ProgramDb)
</span><a href="Distribution.Simple.Configure.html#configCompilerEx"><span class="hs-identifier hs-var hs-var">configCompilerEx</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe CompilerFlavor
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566158"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566158"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO (Compiler, Platform, ProgramDb)
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566158"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#UnknownCompilerException"><span class="hs-identifier hs-var">UnknownCompilerException</span></a></span><span>
</span><span id="line-2482"></span><span class="annot"><a href="Distribution.Simple.Configure.html#configCompilerEx"><span class="hs-identifier hs-var">configCompilerEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679566160"><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="#local-6989586621679566160"><span class="hs-identifier hs-var">hcFlavor</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679566161"><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566161"><span class="hs-identifier hs-var">hcPath</span></a></span></span><span> </span><span id="local-6989586621679566162"><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566162"><span class="hs-identifier hs-var">hcPkg</span></a></span></span><span> </span><span id="local-6989586621679566163"><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566163"><span class="hs-identifier hs-var">progdb</span></a></span></span><span> </span><span id="local-6989586621679566164"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566164"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2483"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679566165"><span class="annot"><a href="#local-6989586621679566165"><span class="hs-identifier hs-var">comp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566166"><span class="annot"><a href="#local-6989586621679566166"><span class="hs-identifier hs-var">maybePlatform</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566167"><span class="annot"><a href="#local-6989586621679566167"><span class="hs-identifier hs-var">programDb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="#local-6989586621679566160"><span class="hs-identifier hs-var">hcFlavor</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2484"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe ProgArg
-&gt; Maybe ProgArg
-&gt; ProgramDb
-&gt; IO (Compiler, Maybe Platform, ProgramDb)
</span><a href="Distribution.Simple.GHC.html#configure"><span class="hs-identifier hs-var">GHC.configure</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566164"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566161"><span class="hs-identifier hs-var">hcPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566162"><span class="hs-identifier hs-var">hcPkg</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566163"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2485"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHCJS"><span class="hs-identifier hs-var">GHCJS</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe ProgArg
-&gt; Maybe ProgArg
-&gt; ProgramDb
-&gt; IO (Compiler, Maybe Platform, ProgramDb)
</span><a href="Distribution.Simple.GHCJS.html#configure"><span class="hs-identifier hs-var">GHCJS.configure</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566164"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566161"><span class="hs-identifier hs-var">hcPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566162"><span class="hs-identifier hs-var">hcPkg</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566163"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2486"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#UHC"><span class="hs-identifier hs-var">UHC</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe ProgArg
-&gt; Maybe ProgArg
-&gt; ProgramDb
-&gt; IO (Compiler, Maybe Platform, ProgramDb)
</span><a href="Distribution.Simple.UHC.html#configure"><span class="hs-identifier hs-var">UHC.configure</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566164"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566161"><span class="hs-identifier hs-var">hcPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566162"><span class="hs-identifier hs-var">hcPkg</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566163"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2487"></span><span>    </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#HaskellSuite"><span class="hs-identifier hs-type">HaskellSuite</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe ProgArg
-&gt; Maybe ProgArg
-&gt; ProgramDb
-&gt; IO (Compiler, Maybe Platform, ProgramDb)
</span><a href="Distribution.Simple.HaskellSuite.html#configure"><span class="hs-identifier hs-var">HaskellSuite.configure</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566164"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566161"><span class="hs-identifier hs-var">hcPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ProgArg
</span><a href="#local-6989586621679566162"><span class="hs-identifier hs-var">hcPkg</span></a></span><span> </span><span class="annot"><span class="annottext">ProgramDb
</span><a href="#local-6989586621679566163"><span class="hs-identifier hs-var">progdb</span></a></span><span>
</span><span id="line-2488"></span><span>    </span><span class="annot"><span class="annottext">CompilerFlavor
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; CabalException -&gt; IO (Compiler, Maybe Platform, ProgramDb)
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566164"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#UnknownCompilerException"><span class="hs-identifier hs-var">UnknownCompilerException</span></a></span><span>
</span><span id="line-2489"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679566165"><span class="hs-identifier hs-type">comp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromMaybe</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#buildPlatform"><span class="hs-identifier hs-type">buildPlatform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566166"><span class="hs-identifier hs-type">maybePlatform</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679566167"><span class="hs-identifier hs-type">programDb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2490"></span><span>
</span><span id="line-2491"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2492"></span><span class="hs-comment">-- Testing C lib and header dependencies</span><span>
</span><span id="line-2493"></span><span>
</span><span id="line-2494"></span><span class="hs-comment">-- Try to build a test C program which includes every header and links every</span><span>
</span><span id="line-2495"></span><span class="hs-comment">-- lib. If that fails, try to narrow it down by preprocessing (only) and linking</span><span>
</span><span id="line-2496"></span><span class="hs-comment">-- with individual headers and libs.  If none is the obvious culprit then give a</span><span>
</span><span id="line-2497"></span><span class="hs-comment">-- generic error message.</span><span>
</span><span id="line-2498"></span><span class="hs-comment">-- TODO: produce a log file from the compiler errors, if any.</span><span>
</span><span id="line-2499"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkForeignDeps"><span class="hs-identifier hs-type">checkForeignDeps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2500"></span><span id="checkForeignDeps"><span class="annot"><span class="annottext">checkForeignDeps :: PackageDescription -&gt; LocalBuildInfo -&gt; Verbosity -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkForeignDeps"><span class="hs-identifier hs-var hs-var">checkForeignDeps</span></a></span></span><span> </span><span id="local-6989586621679566173"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566173"><span class="hs-identifier hs-var">pkg</span></a></span></span><span> </span><span id="local-6989586621679566174"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span id="local-6989586621679566175"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566175"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2501"></span><span>  </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; IO () -&gt; IO () -&gt; IO ()
forall {b}. [ProgArg] -&gt; [ProgArg] -&gt; IO b -&gt; IO b -&gt; IO b
</span><a href="#local-6989586621679566176"><span class="hs-identifier hs-var">ifBuildsWith</span></a></span><span>
</span><span id="line-2502"></span><span>    </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566177"><span class="hs-identifier hs-var">allHeaders</span></a></span><span>
</span><span id="line-2503"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566178"><span class="hs-identifier hs-var">commonCcArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg]
</span><a href="#local-6989586621679566179"><span class="hs-identifier hs-var">makeLdArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566180"><span class="hs-identifier hs-var">allLibs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- I'm feeling lucky</span><span>
</span><span id="line-2504"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2505"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2506"></span><span>        </span><span id="local-6989586621679566181"><span class="annot"><a href="#local-6989586621679566181"><span class="hs-identifier hs-var">missingLibs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [ProgArg]
</span><a href="#local-6989586621679566182"><span class="hs-identifier hs-var">findMissingLibs</span></a></span><span>
</span><span id="line-2507"></span><span>        </span><span id="local-6989586621679566183"><span class="annot"><a href="#local-6989586621679566183"><span class="hs-identifier hs-var">missingHdr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679566184"><span class="hs-identifier hs-type">findOffendingHdr</span></a></span><span>
</span><span id="line-2508"></span><span>        </span><span class="annot"><a href="#local-6989586621679566185"><span class="hs-identifier hs-type">explainErrors</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566183"><span class="hs-identifier hs-type">missingHdr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566181"><span class="hs-identifier hs-type">missingLibs</span></a></span><span>
</span><span id="line-2509"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-2510"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2511"></span><span>    </span><span id="local-6989586621679566177"><span class="annot"><span class="annottext">allHeaders :: [ProgArg]
</span><a href="#local-6989586621679566177"><span class="hs-identifier hs-var hs-var">allHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SymbolicPathX 'AllowAbsolute Include 'File -&gt; ProgArg)
-&gt; [SymbolicPathX 'AllowAbsolute Include 'File] -&gt; [ProgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'AllowAbsolute Include 'File -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">([SymbolicPathX 'AllowAbsolute Include 'File] -&gt; [ProgArg])
-&gt; (BuildInfo -&gt; [SymbolicPathX 'AllowAbsolute Include 'File])
-&gt; BuildInfo
-&gt; [ProgArg]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPathX 'AllowAbsolute Include 'File]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#includes"><span class="hs-identifier hs-var">includes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2512"></span><span>    </span><span id="local-6989586621679566180"><span class="annot"><span class="annottext">allLibs :: [ProgArg]
</span><a href="#local-6989586621679566180"><span class="hs-identifier hs-var hs-var">allLibs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2513"></span><span>      </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="annot"><span class="annottext">((BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg])
-&gt; (BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2514"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.LocalBuildInfo.html#withFullyStaticExe"><span class="hs-identifier hs-var">withFullyStaticExe</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2515"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibsStatic"><span class="hs-identifier hs-var">extraLibsStatic</span></a></span><span>
</span><span id="line-2516"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibs"><span class="hs-identifier hs-var">extraLibs</span></a></span><span>
</span><span id="line-2517"></span><span>
</span><span id="line-2518"></span><span>    </span><span id="local-6989586621679566176"><span class="annot"><span class="annottext">ifBuildsWith :: [ProgArg] -&gt; [ProgArg] -&gt; IO b -&gt; IO b -&gt; IO b
</span><a href="#local-6989586621679566176"><span class="hs-identifier hs-var hs-var">ifBuildsWith</span></a></span></span><span> </span><span id="local-6989586621679566193"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566193"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621679566194"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566194"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679566195"><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621679566195"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679566196"><span class="annot"><span class="annottext">IO b
</span><a href="#local-6989586621679566196"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2519"></span><span>      </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679566197"><span class="hs-identifier hs-var">checkDuplicateHeaders</span></a></span><span>
</span><span id="line-2520"></span><span>      </span><span id="local-6989586621679566198"><span class="annot"><a href="#local-6989586621679566198"><span class="hs-identifier hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; IO Bool
</span><a href="#local-6989586621679566199"><span class="hs-identifier hs-var">builds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProgArg] -&gt; ProgArg
</span><a href="#local-6989586621679566200"><span class="hs-identifier hs-var">makeProgram</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566193"><span class="hs-identifier hs-var">headers</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566194"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2521"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679566198"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621679566195"><span class="hs-identifier hs-type">success</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621679566196"><span class="hs-identifier hs-type">failure</span></a></span><span>
</span><span id="line-2522"></span><span>
</span><span id="line-2523"></span><span>    </span><span class="hs-comment">-- Ensure that there is only one header with a given name</span><span>
</span><span id="line-2524"></span><span>    </span><span class="hs-comment">-- in either the generated (most likely by `configure`)</span><span>
</span><span id="line-2525"></span><span>    </span><span class="hs-comment">-- build directory (e.g. `dist/build`) or in the source directory.</span><span>
</span><span id="line-2526"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2527"></span><span>    </span><span class="hs-comment">-- If it exists in both, we'll remove the one in the source</span><span>
</span><span id="line-2528"></span><span>    </span><span class="hs-comment">-- directory, as the generated should take precedence.</span><span>
</span><span id="line-2529"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2530"></span><span>    </span><span class="hs-comment">-- C compilers like to prefer source local relative includes,</span><span>
</span><span id="line-2531"></span><span>    </span><span class="hs-comment">-- so the search paths provided to the compiler via -I are</span><span>
</span><span id="line-2532"></span><span>    </span><span class="hs-comment">-- ignored if the included file can be found relative to the</span><span>
</span><span id="line-2533"></span><span>    </span><span class="hs-comment">-- including file.  As such we need to take drastic measures</span><span>
</span><span id="line-2534"></span><span>    </span><span class="hs-comment">-- and delete the offending file in the source directory.</span><span>
</span><span id="line-2535"></span><span>    </span><span id="local-6989586621679566197"><span class="annot"><span class="annottext">checkDuplicateHeaders :: IO ()
</span><a href="#local-6989586621679566197"><span class="hs-identifier hs-var hs-var">checkDuplicateHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2536"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566229"><span class="annot"><span class="annottext">relIncDirs :: [ProgArg]
</span><a href="#local-6989586621679566229"><span class="hs-identifier hs-var hs-var hs-var">relIncDirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Bool) -&gt; [ProgArg] -&gt; [ProgArg]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (ProgArg -&gt; Bool) -&gt; ProgArg -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Bool
</span><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.Posix.html#isAbsolute"><span class="hs-identifier hs-var">isAbsolute</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SymbolicPath Pkg ('Dir Include) -&gt; ProgArg)
-&gt; [SymbolicPath Pkg ('Dir Include)] -&gt; [ProgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Include) -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">([SymbolicPath Pkg ('Dir Include)] -&gt; [ProgArg])
-&gt; (BuildInfo -&gt; [SymbolicPath Pkg ('Dir Include)])
-&gt; BuildInfo
-&gt; [ProgArg]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPath Pkg ('Dir Include)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#includeDirs"><span class="hs-identifier hs-var">includeDirs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2537"></span><span>          </span><span id="local-6989586621679566233"><span class="annot"><span class="annottext">isHeader :: ProgArg -&gt; Bool
</span><a href="#local-6989586621679566233"><span class="hs-identifier hs-var hs-var hs-var">isHeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isSuffixOf</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;.h&quot;</span></span><span>
</span><span id="line-2538"></span><span>      </span><span id="local-6989586621679566235"><span class="annot"><a href="#local-6989586621679566235"><span class="hs-identifier hs-var">genHeaders</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; (ProgArg -&gt; IO [ProgArg]) -&gt; IO [[ProgArg]]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566229"><span class="hs-identifier hs-var">relIncDirs</span></a></span><span> </span><span class="annot"><span class="annottext">((ProgArg -&gt; IO [ProgArg]) -&gt; IO [[ProgArg]])
-&gt; (ProgArg -&gt; IO [ProgArg]) -&gt; IO [[ProgArg]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679566236"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566236"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2539"></span><span>        </span><span class="annot"><span class="annottext">ShowS -&gt; [ProgArg] -&gt; [ProgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566236"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ProgArg] -&gt; [ProgArg])
-&gt; ([ProgArg] -&gt; [ProgArg]) -&gt; [ProgArg] -&gt; [ProgArg]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Bool) -&gt; [ProgArg] -&gt; [ProgArg]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Bool
</span><a href="#local-6989586621679566233"><span class="hs-identifier hs-var">isHeader</span></a></span><span>
</span><span id="line-2540"></span><span>          </span><span class="annot"><span class="annottext">([ProgArg] -&gt; [ProgArg]) -&gt; IO [ProgArg] -&gt; IO [ProgArg]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; IO [ProgArg]
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#listDirectory"><span class="hs-identifier hs-var">listDirectory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build) -&gt; ProgArg
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679566237"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; SymbolicPath Pkg ('Dir Build)
</span><a href="Distribution.Types.LocalBuildInfo.html#buildDir"><span class="hs-identifier hs-var">buildDir</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566236"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO [ProgArg] -&gt; (IOException -&gt; IO [ProgArg]) -&gt; IO [ProgArg]
forall a. IO a -&gt; (IOException -&gt; IO a) -&gt; IO a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Exception.html#catchIO"><span class="hs-operator hs-var">`catchIO`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; IO [ProgArg]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2541"></span><span>      </span><span id="local-6989586621679566239"><span class="annot"><a href="#local-6989586621679566239"><span class="hs-identifier hs-var">srcHeaders</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">for</span></span><span> </span><span class="annot"><a href="#local-6989586621679566229"><span class="hs-identifier hs-type">relIncDirs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679566240"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566240"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2542"></span><span>        </span><span class="annot"><span class="annottext">ShowS -&gt; [ProgArg] -&gt; [ProgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566240"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ProgArg] -&gt; [ProgArg])
-&gt; ([ProgArg] -&gt; [ProgArg]) -&gt; [ProgArg] -&gt; [ProgArg]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Bool) -&gt; [ProgArg] -&gt; [ProgArg]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Bool
</span><a href="#local-6989586621679566233"><span class="hs-identifier hs-var">isHeader</span></a></span><span>
</span><span id="line-2543"></span><span>          </span><span class="annot"><span class="annottext">([ProgArg] -&gt; [ProgArg]) -&gt; IO [ProgArg] -&gt; IO [ProgArg]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; IO [ProgArg]
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#listDirectory"><span class="hs-identifier hs-var">listDirectory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566241"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566240"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO [ProgArg] -&gt; (IOException -&gt; IO [ProgArg]) -&gt; IO [ProgArg]
forall a. IO a -&gt; (IOException -&gt; IO a) -&gt; IO a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Exception.html#catchIO"><span class="hs-operator hs-var">`catchIO`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; IO [ProgArg]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2544"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566246"><span class="annot"><a href="#local-6989586621679566246"><span class="hs-identifier hs-var hs-var">commonHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[ProgArg]] -&gt; [ProgArg]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[ProgArg]]
</span><a href="#local-6989586621679566235"><span class="hs-identifier hs-var">genHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">[[ProgArg]] -&gt; [ProgArg]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[ProgArg]]
</span><a href="#local-6989586621679566239"><span class="hs-identifier hs-var">srcHeaders</span></a></span><span>
</span><span id="line-2545"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">for_</span></span><span> </span><span class="annot"><a href="#local-6989586621679566246"><span class="hs-identifier hs-type">commonHeaders</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679566247"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566247"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2546"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; ProgArg -&gt; IO ()
</span><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-var">warn</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566175"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; IO ()) -&gt; ProgArg -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2547"></span><span>          </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Duplicate header found in &quot;</span></span><span>
</span><span id="line-2548"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build) -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; SymbolicPath Pkg ('Dir Build)
</span><a href="Distribution.Types.LocalBuildInfo.html#buildDir"><span class="hs-identifier hs-var">buildDir</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566247"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2549"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot; and &quot;</span></span><span>
</span><span id="line-2550"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566241"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566247"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2551"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;; removing &quot;</span></span><span>
</span><span id="line-2552"></span><span>            </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566241"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566247"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2553"></span><span>        </span><span class="annot"><span class="annottext">ProgArg -&gt; IO ()
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#removeFile"><span class="hs-identifier hs-var">removeFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566241"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566247"><span class="hs-identifier hs-var">hdr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2554"></span><span>
</span><span id="line-2555"></span><span>    </span><span id="local-6989586621679566184"><span class="annot"><span class="annottext">findOffendingHdr :: IO (Maybe (Either ProgArg ProgArg))
</span><a href="#local-6989586621679566184"><span class="hs-identifier hs-var hs-var">findOffendingHdr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2556"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg]
-&gt; [ProgArg]
-&gt; IO (Maybe (Either ProgArg ProgArg))
-&gt; IO (Maybe (Either ProgArg ProgArg))
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall {b}. [ProgArg] -&gt; [ProgArg] -&gt; IO b -&gt; IO b -&gt; IO b
</span><a href="#local-6989586621679566176"><span class="hs-identifier hs-var">ifBuildsWith</span></a></span><span>
</span><span id="line-2557"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566177"><span class="hs-identifier hs-var">allHeaders</span></a></span><span>
</span><span id="line-2558"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566250"><span class="hs-identifier hs-var">ccArgs</span></a></span><span>
</span><span id="line-2559"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-2560"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[ProgArg]] -&gt; IO (Maybe (Either ProgArg ProgArg))
</span><a href="#local-6989586621679566251"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([[ProgArg]] -&gt; IO (Maybe (Either ProgArg ProgArg)))
-&gt; ([ProgArg] -&gt; [[ProgArg]])
-&gt; [ProgArg]
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty [ProgArg] -&gt; [[ProgArg]]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#tail"><span class="hs-identifier hs-var">tail</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty [ProgArg] -&gt; [[ProgArg]])
-&gt; ([ProgArg] -&gt; NonEmpty [ProgArg]) -&gt; [ProgArg] -&gt; [[ProgArg]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; NonEmpty [ProgArg]
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; NonEmpty [a]
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#inits"><span class="hs-identifier hs-var">NEL.inits</span></a></span><span> </span><span class="annot"><span class="annottext">([ProgArg] -&gt; IO (Maybe (Either ProgArg ProgArg)))
-&gt; [ProgArg] -&gt; IO (Maybe (Either ProgArg ProgArg))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566177"><span class="hs-identifier hs-var">allHeaders</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2561"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2562"></span><span>        </span><span id="local-6989586621679566251"><span class="annot"><span class="annottext">go :: [[ProgArg]] -&gt; IO (Maybe (Either ProgArg ProgArg))
</span><a href="#local-6989586621679566251"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- cannot happen</span><span>
</span><span id="line-2563"></span><span>        </span><span class="annot"><a href="#local-6989586621679566251"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679566259"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566259"><span class="hs-identifier hs-var">hdrs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679566260"><span class="annot"><span class="annottext">[[ProgArg]]
</span><a href="#local-6989586621679566260"><span class="hs-identifier hs-var">hdrsInits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2564"></span><span>          </span><span class="hs-comment">-- Try just preprocessing first</span><span>
</span><span id="line-2565"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg]
-&gt; [ProgArg]
-&gt; IO (Maybe (Either ProgArg ProgArg))
-&gt; IO (Maybe (Either ProgArg ProgArg))
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall {b}. [ProgArg] -&gt; [ProgArg] -&gt; IO b -&gt; IO b -&gt; IO b
</span><a href="#local-6989586621679566176"><span class="hs-identifier hs-var">ifBuildsWith</span></a></span><span>
</span><span id="line-2566"></span><span>            </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566259"><span class="hs-identifier hs-var">hdrs</span></a></span><span>
</span><span id="line-2567"></span><span>            </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566261"><span class="hs-identifier hs-var">cppArgs</span></a></span><span>
</span><span id="line-2568"></span><span>            </span><span class="hs-comment">-- If that works, try compiling too</span><span>
</span><span id="line-2569"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
-&gt; [ProgArg]
-&gt; IO (Maybe (Either ProgArg ProgArg))
-&gt; IO (Maybe (Either ProgArg ProgArg))
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall {b}. [ProgArg] -&gt; [ProgArg] -&gt; IO b -&gt; IO b -&gt; IO b
</span><a href="#local-6989586621679566176"><span class="hs-identifier hs-var">ifBuildsWith</span></a></span><span>
</span><span id="line-2570"></span><span>                </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566259"><span class="hs-identifier hs-var">hdrs</span></a></span><span>
</span><span id="line-2571"></span><span>                </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566250"><span class="hs-identifier hs-var">ccArgs</span></a></span><span>
</span><span id="line-2572"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[ProgArg]] -&gt; IO (Maybe (Either ProgArg ProgArg))
</span><a href="#local-6989586621679566251"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[[ProgArg]]
</span><a href="#local-6989586621679566260"><span class="hs-identifier hs-var">hdrsInits</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2573"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either ProgArg ProgArg)
 -&gt; IO (Maybe (Either ProgArg ProgArg)))
-&gt; ([ProgArg] -&gt; Maybe (Either ProgArg ProgArg))
-&gt; [ProgArg]
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Either ProgArg ProgArg)
-&gt; Maybe ProgArg -&gt; Maybe (Either ProgArg ProgArg)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Either ProgArg ProgArg
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ProgArg -&gt; Maybe (Either ProgArg ProgArg))
-&gt; ([ProgArg] -&gt; Maybe ProgArg)
-&gt; [ProgArg]
-&gt; Maybe (Either ProgArg ProgArg)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
forall a. [a] -&gt; Maybe a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#safeLast"><span class="hs-identifier hs-var">safeLast</span></a></span><span> </span><span class="annot"><span class="annottext">([ProgArg] -&gt; IO (Maybe (Either ProgArg ProgArg)))
-&gt; [ProgArg] -&gt; IO (Maybe (Either ProgArg ProgArg))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566259"><span class="hs-identifier hs-var">hdrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2574"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-2575"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either ProgArg ProgArg)
 -&gt; IO (Maybe (Either ProgArg ProgArg)))
-&gt; ([ProgArg] -&gt; Maybe (Either ProgArg ProgArg))
-&gt; [ProgArg]
-&gt; IO (Maybe (Either ProgArg ProgArg))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Either ProgArg ProgArg)
-&gt; Maybe ProgArg -&gt; Maybe (Either ProgArg ProgArg)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Either ProgArg ProgArg
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ProgArg -&gt; Maybe (Either ProgArg ProgArg))
-&gt; ([ProgArg] -&gt; Maybe ProgArg)
-&gt; [ProgArg]
-&gt; Maybe (Either ProgArg ProgArg)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
forall a. [a] -&gt; Maybe a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#safeLast"><span class="hs-identifier hs-var">safeLast</span></a></span><span> </span><span class="annot"><span class="annottext">([ProgArg] -&gt; IO (Maybe (Either ProgArg ProgArg)))
-&gt; [ProgArg] -&gt; IO (Maybe (Either ProgArg ProgArg))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566259"><span class="hs-identifier hs-var">hdrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2576"></span><span>
</span><span id="line-2577"></span><span>        </span><span id="local-6989586621679566261"><span class="annot"><span class="annottext">cppArgs :: [ProgArg]
</span><a href="#local-6989586621679566261"><span class="hs-identifier hs-var hs-var">cppArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-E&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; [ProgArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566265"><span class="hs-identifier hs-var">commonCppArgs</span></a></span><span> </span><span class="hs-comment">-- preprocess only</span><span>
</span><span id="line-2578"></span><span>        </span><span id="local-6989586621679566250"><span class="annot"><span class="annottext">ccArgs :: [ProgArg]
</span><a href="#local-6989586621679566250"><span class="hs-identifier hs-var hs-var">ccArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-c&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; [ProgArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566178"><span class="hs-identifier hs-var">commonCcArgs</span></a></span><span> </span><span class="hs-comment">-- don't try to link</span><span>
</span><span id="line-2579"></span><span>    </span><span id="local-6989586621679566182"><span class="annot"><span class="annottext">findMissingLibs :: IO [ProgArg]
</span><a href="#local-6989586621679566182"><span class="hs-identifier hs-var hs-var">findMissingLibs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2580"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg]
-&gt; [ProgArg] -&gt; IO [ProgArg] -&gt; IO [ProgArg] -&gt; IO [ProgArg]
forall {b}. [ProgArg] -&gt; [ProgArg] -&gt; IO b -&gt; IO b -&gt; IO b
</span><a href="#local-6989586621679566176"><span class="hs-identifier hs-var">ifBuildsWith</span></a></span><span>
</span><span id="line-2581"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2582"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg]
</span><a href="#local-6989586621679566179"><span class="hs-identifier hs-var">makeLdArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566180"><span class="hs-identifier hs-var">allLibs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2583"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProgArg] -&gt; IO [ProgArg]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2584"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ProgArg -&gt; IO Bool) -&gt; [ProgArg] -&gt; IO [ProgArg]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; IO Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; IO Bool) -&gt; (ProgArg -&gt; IO Bool) -&gt; ProgArg -&gt; IO Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; IO Bool
</span><a href="#local-6989586621679566271"><span class="hs-identifier hs-var">libExists</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566180"><span class="hs-identifier hs-var">allLibs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2585"></span><span>
</span><span id="line-2586"></span><span>    </span><span id="local-6989586621679566271"><span class="annot"><span class="annottext">libExists :: ProgArg -&gt; IO Bool
</span><a href="#local-6989586621679566271"><span class="hs-identifier hs-var hs-var">libExists</span></a></span></span><span> </span><span id="local-6989586621679566272"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566272"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; IO Bool
</span><a href="#local-6989586621679566199"><span class="hs-identifier hs-var">builds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProgArg] -&gt; ProgArg
</span><a href="#local-6989586621679566200"><span class="hs-identifier hs-var">makeProgram</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg]
</span><a href="#local-6989586621679566179"><span class="hs-identifier hs-var">makeLdArgs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566272"><span class="hs-identifier hs-var">lib</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2587"></span><span>
</span><span id="line-2588"></span><span>    </span><span id="local-6989586621679566273"><span class="annot"><span class="annottext">common :: CommonSetupFlags
</span><a href="#local-6989586621679566273"><span class="hs-identifier hs-var hs-var">common</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigFlags -&gt; CommonSetupFlags
</span><a href="Distribution.Simple.Setup.Config.html#configCommonFlags"><span class="hs-identifier hs-var">configCommonFlags</span></a></span><span> </span><span class="annot"><span class="annottext">(ConfigFlags -&gt; CommonSetupFlags)
-&gt; ConfigFlags -&gt; CommonSetupFlags
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ConfigFlags
</span><a href="Distribution.Types.LocalBuildInfo.html#configFlags"><span class="hs-identifier hs-var">configFlags</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2589"></span><span>    </span><span id="local-6989586621679566241"><span class="annot"><span class="annottext">baseDir :: ProgArg
</span><a href="#local-6989586621679566241"><span class="hs-identifier hs-var hs-var">baseDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags -&gt; ProgArg
</span><a href="Distribution.Types.LocalBuildInfo.html#packageRoot"><span class="hs-identifier hs-var">packageRoot</span></a></span><span> </span><span class="annot"><span class="annottext">CommonSetupFlags
</span><a href="#local-6989586621679566273"><span class="hs-identifier hs-var">common</span></a></span><span>
</span><span id="line-2590"></span><span>
</span><span id="line-2591"></span><span>    </span><span class="hs-comment">-- See Note [Symbolic paths] in Distribution.Utils.Path</span><span>
</span><span id="line-2592"></span><span>    </span><span id="local-6989586621679566237"><span class="annot"><span class="annottext">i :: SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679566237"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) (to :: FileOrDir).
LocalBuildInfo -&gt; SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="Distribution.Simple.LocalBuildInfo.html#interpretSymbolicPathLBI"><span class="hs-identifier hs-var">interpretSymbolicPathLBI</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2593"></span><span>    </span><span id="local-6989586621679566276"><span class="annot"><span class="annottext">mbWorkDir :: Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679566276"><span class="hs-identifier hs-var hs-var">mbWorkDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.LocalBuildInfo.html#mbWorkDirLBI"><span class="hs-identifier hs-var">mbWorkDirLBI</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2594"></span><span>
</span><span id="line-2595"></span><span>    </span><span id="local-6989586621679566265"><span class="annot"><span class="annottext">commonCppArgs :: [ProgArg]
</span><a href="#local-6989586621679566265"><span class="hs-identifier hs-var hs-var">commonCppArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2596"></span><span>      </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; [ProgArg]
</span><a href="Distribution.Simple.PreProcess.html#platformDefines"><span class="hs-identifier hs-var">platformDefines</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2597"></span><span>        </span><span class="hs-comment">-- TODO: This is a massive hack, to work around the</span><span>
</span><span id="line-2598"></span><span>        </span><span class="hs-comment">-- fact that the test performed here should be</span><span>
</span><span id="line-2599"></span><span>        </span><span class="hs-comment">-- PER-component (c.f. the &quot;I'm Feeling Lucky&quot;; we</span><span>
</span><span id="line-2600"></span><span>        </span><span class="hs-comment">-- should NOT be glomming everything together.)</span><span>
</span><span id="line-2601"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-I&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'AllowAbsolute Pkg (ZonkAny 1) -&gt; ProgArg
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679566237"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; SymbolicPath Pkg ('Dir Build)
</span><a href="Distribution.Types.LocalBuildInfo.html#buildDir"><span class="hs-identifier hs-var">buildDir</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
-&gt; RelativePath Build (ZonkAny 1)
-&gt; SymbolicPathX 'AllowAbsolute Pkg (ZonkAny 1)
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; RelativePath Build (ZonkAny 1)
forall from (to :: FileOrDir).
HasCallStack =&gt;
ProgArg -&gt; RelativePath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeRelativePathEx"><span class="hs-identifier hs-var">makeRelativePathEx</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;autogen&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2602"></span><span>        </span><span class="hs-comment">-- `configure' may generate headers in the build directory</span><span>
</span><span id="line-2603"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-I&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'AllowAbsolute Pkg (ZonkAny 2) -&gt; ProgArg
forall {allowAbsolute :: AllowAbsolute} {to :: FileOrDir}.
SymbolicPathX allowAbsolute Pkg to -&gt; ProgArg
</span><a href="#local-6989586621679566237"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; SymbolicPath Pkg ('Dir Build)
</span><a href="Distribution.Types.LocalBuildInfo.html#buildDir"><span class="hs-identifier hs-var">buildDir</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Build)
-&gt; SymbolicPathX 'OnlyRelative Build (ZonkAny 2)
-&gt; SymbolicPathX 'AllowAbsolute Pkg (ZonkAny 2)
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'OnlyRelative Pkg ('Dir Include)
-&gt; SymbolicPathX 'OnlyRelative Build (ZonkAny 2)
forall (allowAbsolute :: AllowAbsolute) from1 (to1 :: FileOrDir)
       from2 (to2 :: FileOrDir).
SymbolicPathX allowAbsolute from1 to1
-&gt; SymbolicPathX allowAbsolute from2 to2
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#unsafeCoerceSymbolicPath"><span class="hs-identifier hs-var">unsafeCoerceSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'OnlyRelative Pkg ('Dir Include)
</span><a href="#local-6989586621679566305"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2604"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566305"><span class="annot"><span class="annottext">SymbolicPathX 'OnlyRelative Pkg ('Dir Include)
</span><a href="#local-6989586621679566305"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SymbolicPath Pkg ('Dir Include)
 -&gt; Maybe (SymbolicPathX 'OnlyRelative Pkg ('Dir Include)))
-&gt; [SymbolicPath Pkg ('Dir Include)]
-&gt; [SymbolicPathX 'OnlyRelative Pkg ('Dir Include)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Include)
-&gt; Maybe (SymbolicPathX 'OnlyRelative Pkg ('Dir Include))
forall from (to :: FileOrDir).
SymbolicPath from to -&gt; Maybe (RelativePath from to)
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#symbolicPathRelative_maybe"><span class="hs-identifier hs-var">symbolicPathRelative_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">([SymbolicPath Pkg ('Dir Include)]
 -&gt; [SymbolicPathX 'OnlyRelative Pkg ('Dir Include)])
-&gt; [SymbolicPath Pkg ('Dir Include)]
-&gt; [SymbolicPathX 'OnlyRelative Pkg ('Dir Include)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg ('Dir Include)]
-&gt; [SymbolicPath Pkg ('Dir Include)]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#ordNub"><span class="hs-identifier hs-var">ordNub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BuildInfo -&gt; [SymbolicPath Pkg ('Dir Include)])
-&gt; [SymbolicPath Pkg ('Dir Include)]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPath Pkg ('Dir Include)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#includeDirs"><span class="hs-identifier hs-var">includeDirs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2605"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-2606"></span><span>        </span><span class="hs-comment">-- we might also reference headers from the</span><span>
</span><span id="line-2607"></span><span>        </span><span class="hs-comment">-- packages directory.</span><span>
</span><span id="line-2608"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-I&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566241"><span class="hs-identifier hs-var">baseDir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall p q r. PathLike p q r =&gt; p -&gt; q -&gt; r
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'OnlyRelative Pkg ('Dir Include) -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPathX 'OnlyRelative Pkg ('Dir Include)
</span><a href="#local-6989586621679566308"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2609"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566308"><span class="annot"><span class="annottext">SymbolicPathX 'OnlyRelative Pkg ('Dir Include)
</span><a href="#local-6989586621679566308"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SymbolicPath Pkg ('Dir Include)
 -&gt; Maybe (SymbolicPathX 'OnlyRelative Pkg ('Dir Include)))
-&gt; [SymbolicPath Pkg ('Dir Include)]
-&gt; [SymbolicPathX 'OnlyRelative Pkg ('Dir Include)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Include)
-&gt; Maybe (SymbolicPathX 'OnlyRelative Pkg ('Dir Include))
forall from (to :: FileOrDir).
SymbolicPath from to -&gt; Maybe (RelativePath from to)
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#symbolicPathRelative_maybe"><span class="hs-identifier hs-var">symbolicPathRelative_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">([SymbolicPath Pkg ('Dir Include)]
 -&gt; [SymbolicPathX 'OnlyRelative Pkg ('Dir Include)])
-&gt; [SymbolicPath Pkg ('Dir Include)]
-&gt; [SymbolicPathX 'OnlyRelative Pkg ('Dir Include)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SymbolicPath Pkg ('Dir Include)]
-&gt; [SymbolicPath Pkg ('Dir Include)]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#ordNub"><span class="hs-identifier hs-var">ordNub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BuildInfo -&gt; [SymbolicPath Pkg ('Dir Include)])
-&gt; [SymbolicPath Pkg ('Dir Include)]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPath Pkg ('Dir Include)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#includeDirs"><span class="hs-identifier hs-var">includeDirs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2610"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-2611"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-I&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566309"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2612"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566309"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566309"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#ordNub"><span class="hs-identifier hs-var">ordNub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SymbolicPath Pkg ('Dir Include) -&gt; ProgArg)
-&gt; [SymbolicPath Pkg ('Dir Include)] -&gt; [ProgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Include) -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">([SymbolicPath Pkg ('Dir Include)] -&gt; [ProgArg])
-&gt; (BuildInfo -&gt; [SymbolicPath Pkg ('Dir Include)])
-&gt; BuildInfo
-&gt; [ProgArg]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPath Pkg ('Dir Include)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#includeDirs"><span class="hs-identifier hs-var">includeDirs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2613"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Bool
</span><a href="../../filepath-1.5.4.0-e69b/src/System.FilePath.Posix.html#isAbsolute"><span class="hs-identifier hs-var">isAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566309"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2614"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-2615"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-I&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566241"><span class="hs-identifier hs-var">baseDir</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2616"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#cppOptions"><span class="hs-identifier hs-var">cppOptions</span></a></span><span>
</span><span id="line-2617"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#ccOptions"><span class="hs-identifier hs-var">ccOptions</span></a></span><span>
</span><span id="line-2618"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-I&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566311"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2619"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566311"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566311"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2620"></span><span>              </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#ordNub"><span class="hs-identifier hs-var">ordNub</span></a></span><span>
</span><span id="line-2621"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566312"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2622"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566313"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566313"><span class="hs-identifier hs-var">dep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[InstalledPackageInfo]
</span><a href="#local-6989586621679566314"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-2623"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566312"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566312"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#includeDirs"><span class="hs-identifier hs-var">IPI.includeDirs</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566313"><span class="hs-identifier hs-var">dep</span></a></span><span>
</span><span id="line-2624"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-2625"></span><span>                </span><span class="hs-comment">-- dedupe include dirs of dependencies</span><span>
</span><span id="line-2626"></span><span>                </span><span class="hs-comment">-- to prevent quadratic blow-up</span><span>
</span><span id="line-2627"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-2628"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566316"><span class="hs-identifier hs-var">opt</span></a></span><span>
</span><span id="line-2629"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566317"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566317"><span class="hs-identifier hs-var">dep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[InstalledPackageInfo]
</span><a href="#local-6989586621679566314"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-2630"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566316"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566316"><span class="hs-identifier hs-var">opt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#ccOptions"><span class="hs-identifier hs-var">IPI.ccOptions</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566317"><span class="hs-identifier hs-var">dep</span></a></span><span>
</span><span id="line-2631"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-2632"></span><span>
</span><span id="line-2633"></span><span>    </span><span id="local-6989586621679566178"><span class="annot"><span class="annottext">commonCcArgs :: [ProgArg]
</span><a href="#local-6989586621679566178"><span class="hs-identifier hs-var hs-var">commonCcArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2634"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566265"><span class="hs-identifier hs-var">commonCppArgs</span></a></span><span>
</span><span id="line-2635"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#ccOptions"><span class="hs-identifier hs-var">ccOptions</span></a></span><span>
</span><span id="line-2636"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566319"><span class="hs-identifier hs-var">opt</span></a></span><span>
</span><span id="line-2637"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566320"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566320"><span class="hs-identifier hs-var">dep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[InstalledPackageInfo]
</span><a href="#local-6989586621679566314"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-2638"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566319"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566319"><span class="hs-identifier hs-var">opt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#ccOptions"><span class="hs-identifier hs-var">IPI.ccOptions</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566320"><span class="hs-identifier hs-var">dep</span></a></span><span>
</span><span id="line-2639"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-2640"></span><span>
</span><span id="line-2641"></span><span>    </span><span id="local-6989586621679566327"><span class="annot"><span class="annottext">commonLdArgs :: [ProgArg]
</span><a href="#local-6989586621679566327"><span class="hs-identifier hs-var hs-var">commonLdArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2642"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-L&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Lib) -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Lib)
</span><a href="#local-6989586621679566328"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2643"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566328"><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir Lib)
</span><a href="#local-6989586621679566328"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2644"></span><span>          </span><span class="annot"><span class="annottext">[SymbolicPath Pkg ('Dir Lib)] -&gt; [SymbolicPath Pkg ('Dir Lib)]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#ordNub"><span class="hs-identifier hs-var">ordNub</span></a></span><span> </span><span class="annot"><span class="annottext">([SymbolicPath Pkg ('Dir Lib)] -&gt; [SymbolicPath Pkg ('Dir Lib)])
-&gt; [SymbolicPath Pkg ('Dir Lib)] -&gt; [SymbolicPath Pkg ('Dir Lib)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2645"></span><span>            </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [SymbolicPath Pkg ('Dir Lib)])
-&gt; [SymbolicPath Pkg ('Dir Lib)]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span>
</span><span id="line-2646"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.LocalBuildInfo.html#withFullyStaticExe"><span class="hs-identifier hs-var">withFullyStaticExe</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2647"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPath Pkg ('Dir Lib)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirsStatic"><span class="hs-identifier hs-var">extraLibDirsStatic</span></a></span><span>
</span><span id="line-2648"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [SymbolicPath Pkg ('Dir Lib)]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#extraLibDirs"><span class="hs-identifier hs-var">extraLibDirs</span></a></span><span>
</span><span id="line-2649"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-2650"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-2651"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [ProgArg]) -&gt; [ProgArg]
forall {b}. (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var">collectField</span></a></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.BuildInfo.html#ldOptions"><span class="hs-identifier hs-var">ldOptions</span></a></span><span>
</span><span id="line-2652"></span><span>        </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-L&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566329"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2653"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566329"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566329"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2654"></span><span>              </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Generic.html#ordNub"><span class="hs-identifier hs-var">ordNub</span></a></span><span>
</span><span id="line-2655"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566330"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2656"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566331"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566331"><span class="hs-identifier hs-var">dep</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[InstalledPackageInfo]
</span><a href="#local-6989586621679566314"><span class="hs-identifier hs-var">deps</span></a></span><span>
</span><span id="line-2657"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566330"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566330"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2658"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Bool
</span><a href="Distribution.Types.LocalBuildInfo.html#withFullyStaticExe"><span class="hs-identifier hs-var">withFullyStaticExe</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2659"></span><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#libraryDirsStatic"><span class="hs-identifier hs-var">IPI.libraryDirsStatic</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566331"><span class="hs-identifier hs-var">dep</span></a></span><span>
</span><span id="line-2660"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#libraryDirs"><span class="hs-identifier hs-var">IPI.libraryDirs</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566331"><span class="hs-identifier hs-var">dep</span></a></span><span>
</span><span id="line-2661"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-2662"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-2663"></span><span>    </span><span class="hs-comment">-- TODO: do we also need dependent packages' ld options?</span><span>
</span><span id="line-2664"></span><span>    </span><span id="local-6989586621679566179"><span class="annot"><span class="annottext">makeLdArgs :: [ProgArg] -&gt; [ProgArg]
</span><a href="#local-6989586621679566179"><span class="hs-identifier hs-var hs-var">makeLdArgs</span></a></span></span><span> </span><span id="local-6989586621679566336"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566336"><span class="hs-identifier hs-var">libs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-l&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566337"><span class="hs-identifier hs-var">lib</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566337"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566337"><span class="hs-identifier hs-var">lib</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566336"><span class="hs-identifier hs-var">libs</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566327"><span class="hs-identifier hs-var">commonLdArgs</span></a></span><span>
</span><span id="line-2665"></span><span>
</span><span id="line-2666"></span><span>    </span><span id="local-6989586621679566200"><span class="annot"><span class="annottext">makeProgram :: [ProgArg] -&gt; ProgArg
</span><a href="#local-6989586621679566200"><span class="hs-identifier hs-var hs-var">makeProgram</span></a></span></span><span> </span><span id="local-6989586621679566341"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566341"><span class="hs-identifier hs-var">hdrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2667"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg] -&gt; ProgArg
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([ProgArg] -&gt; ProgArg) -&gt; [ProgArg] -&gt; ProgArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2668"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;#include \&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566342"><span class="hs-identifier hs-var">hdr</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679566342"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566342"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566341"><span class="hs-identifier hs-var">hdrs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2669"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; [ProgArg] -&gt; [ProgArg]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;int main(int argc, char** argv) { return 0; }&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-2670"></span><span>
</span><span id="line-2671"></span><span>    </span><span id="local-6989586621679566187"><span class="annot"><span class="annottext">collectField :: (BuildInfo -&gt; [b]) -&gt; [b]
</span><a href="#local-6989586621679566187"><span class="hs-identifier hs-var hs-var">collectField</span></a></span></span><span> </span><span id="local-6989586621679566344"><span class="annot"><span class="annottext">BuildInfo -&gt; [b]
</span><a href="#local-6989586621679566344"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(BuildInfo -&gt; [b]) -&gt; [BuildInfo] -&gt; [b]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">BuildInfo -&gt; [b]
</span><a href="#local-6989586621679566344"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[BuildInfo]
</span><a href="#local-6989586621679566345"><span class="hs-identifier hs-var">allBi</span></a></span><span>
</span><span id="line-2672"></span><span>    </span><span id="local-6989586621679566345"><span class="annot"><span class="annottext">allBi :: [BuildInfo]
</span><a href="#local-6989586621679566345"><span class="hs-identifier hs-var hs-var">allBi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageDescription -&gt; ComponentRequestedSpec -&gt; [BuildInfo]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#enabledBuildInfos"><span class="hs-identifier hs-var">enabledBuildInfos</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566173"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ComponentRequestedSpec
</span><a href="Distribution.Types.LocalBuildInfo.html#componentEnabledSpec"><span class="hs-identifier hs-var">componentEnabledSpec</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2673"></span><span>    </span><span id="local-6989586621679566314"><span class="annot"><span class="annottext">deps :: [InstalledPackageInfo]
</span><a href="#local-6989586621679566314"><span class="hs-identifier hs-var hs-var">deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex -&gt; [InstalledPackageInfo]
forall a. PackageInstalled a =&gt; PackageIndex a -&gt; [a]
</span><a href="Distribution.Simple.PackageIndex.html#topologicalOrder"><span class="hs-identifier hs-var">PackageIndex.topologicalOrder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; InstalledPackageIndex
</span><a href="Distribution.Types.LocalBuildInfo.html#installedPkgs"><span class="hs-identifier hs-var">installedPkgs</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2674"></span><span>
</span><span id="line-2675"></span><span>    </span><span class="annot"><a href="#local-6989586621679566199"><span class="hs-identifier hs-type">builds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Simple.Program.Types.html#ProgArg"><span class="hs-identifier hs-type">ProgArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2676"></span><span>    </span><span id="local-6989586621679566199"><span class="annot"><span class="annottext">builds :: ProgArg -&gt; [ProgArg] -&gt; IO Bool
</span><a href="#local-6989586621679566199"><span class="hs-identifier hs-var hs-var">builds</span></a></span></span><span> </span><span id="local-6989586621679566351"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566351"><span class="hs-identifier hs-var">program</span></a></span></span><span> </span><span id="local-6989586621679566352"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566352"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2677"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-2678"></span><span>        </span><span id="local-6989586621679566353"><span class="annot"><a href="#local-6989586621679566353"><span class="hs-identifier hs-var">tempDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; SymbolicPath Pkg ('Dir (ZonkAny 0))
forall from (to :: FileOrDir). ProgArg -&gt; SymbolicPath from to
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#makeSymbolicPath"><span class="hs-identifier hs-var">makeSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; SymbolicPath Pkg ('Dir (ZonkAny 0)))
-&gt; IO ProgArg -&gt; IO (SymbolicPath Pkg ('Dir (ZonkAny 0)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO ProgArg
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#getTemporaryDirectory"><span class="hs-identifier hs-var">getTemporaryDirectory</span></a></span><span>
</span><span id="line-2679"></span><span>        </span><span class="annot"><a href="Distribution.Simple.Utils.html#withTempFileCwd"><span class="hs-identifier hs-type">withTempFileCwd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566276"><span class="hs-identifier hs-type">mbWorkDir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566353"><span class="hs-identifier hs-type">tempDir</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;.c&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679566355"><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679566355"><span class="hs-identifier hs-var">cName</span></a></span></span><span> </span><span id="local-6989586621679566356"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679566356"><span class="hs-identifier hs-var">cHnd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2680"></span><span>          </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir (ZonkAny 0))
-&gt; ProgArg
-&gt; (SymbolicPath Pkg 'File -&gt; Handle -&gt; IO Bool)
-&gt; IO Bool
forall tmpDir a.
Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; SymbolicPath Pkg ('Dir tmpDir)
-&gt; ProgArg
-&gt; (SymbolicPath Pkg 'File -&gt; Handle -&gt; IO a)
-&gt; IO a
</span><a href="Distribution.Simple.Utils.html#withTempFileCwd"><span class="hs-identifier hs-var">withTempFileCwd</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679566276"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg ('Dir (ZonkAny 0))
</span><a href="#local-6989586621679566353"><span class="hs-identifier hs-var">tempDir</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">((SymbolicPath Pkg 'File -&gt; Handle -&gt; IO Bool) -&gt; IO Bool)
-&gt; (SymbolicPath Pkg 'File -&gt; Handle -&gt; IO Bool) -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679566357"><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679566357"><span class="hs-identifier hs-var">oNname</span></a></span></span><span> </span><span id="local-6989586621679566358"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679566358"><span class="hs-identifier hs-var">oHnd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2681"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; ProgArg -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679566356"><span class="hs-identifier hs-var">cHnd</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566351"><span class="hs-identifier hs-var">program</span></a></span><span>
</span><span id="line-2682"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679566356"><span class="hs-identifier hs-var">cHnd</span></a></span><span>
</span><span id="line-2683"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679566358"><span class="hs-identifier hs-var">oHnd</span></a></span><span>
</span><span id="line-2684"></span><span>            </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-2685"></span><span>              </span><span class="annot"><span class="annottext">Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir Pkg))
-&gt; Program
-&gt; ProgramDb
-&gt; [ProgArg]
-&gt; IO ProgArg
forall to.
Verbosity
-&gt; Maybe (SymbolicPath CWD ('Dir to))
-&gt; Program
-&gt; ProgramDb
-&gt; [ProgArg]
-&gt; IO ProgArg
</span><a href="Distribution.Simple.Program.html#getDbProgramOutputCwd"><span class="hs-identifier hs-var">getDbProgramOutputCwd</span></a></span><span>
</span><span id="line-2686"></span><span>                </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566175"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-2687"></span><span>                </span><span class="annot"><span class="annottext">Maybe (SymbolicPath CWD ('Dir Pkg))
</span><a href="#local-6989586621679566276"><span class="hs-identifier hs-var">mbWorkDir</span></a></span><span>
</span><span id="line-2688"></span><span>                </span><span class="annot"><span class="annottext">Program
</span><a href="Distribution.Simple.Program.Builtin.html#gccProgram"><span class="hs-identifier hs-var">gccProgram</span></a></span><span>
</span><span id="line-2689"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ProgramDb
</span><a href="Distribution.Types.LocalBuildInfo.html#withPrograms"><span class="hs-identifier hs-var">withPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2690"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679566355"><span class="hs-identifier hs-var">cName</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; [ProgArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;-o&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; [ProgArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File -&gt; ProgArg
forall (allowAbsolute :: AllowAbsolute) from (to :: FileOrDir).
SymbolicPathX allowAbsolute from to -&gt; ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-var">getSymbolicPath</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolicPath Pkg 'File
</span><a href="#local-6989586621679566357"><span class="hs-identifier hs-var">oNname</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; [ProgArg] -&gt; [ProgArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566352"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2691"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-2692"></span><span>        </span><span class="annot"><span class="annottext">IO Bool -&gt; (IOException -&gt; IO Bool) -&gt; IO Bool
forall a. IO a -&gt; (IOException -&gt; IO a) -&gt; IO a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Exception.html#catchIO"><span class="hs-operator hs-var">`catchIO`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-2693"></span><span>        </span><span class="annot"><span class="annottext">IO Bool -&gt; (ExitCode -&gt; IO Bool) -&gt; IO Bool
forall a. IO a -&gt; (ExitCode -&gt; IO a) -&gt; IO a
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compat.Exception.html#catchExit"><span class="hs-operator hs-var">`catchExit`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">ExitCode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-2694"></span><span>
</span><span id="line-2695"></span><span>    </span><span id="local-6989586621679566185"><span class="annot"><span class="annottext">explainErrors :: Maybe (Either ProgArg ProgArg) -&gt; [ProgArg] -&gt; IO ()
</span><a href="#local-6989586621679566185"><span class="hs-identifier hs-var hs-var">explainErrors</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- should be impossible!</span><span>
</span><span id="line-2696"></span><span>    </span><span class="annot"><a href="#local-6989586621679566185"><span class="hs-identifier hs-var">explainErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-2697"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe ConfiguredProgram -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ConfiguredProgram -&gt; Bool)
-&gt; (LocalBuildInfo -&gt; Maybe ConfiguredProgram)
-&gt; LocalBuildInfo
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Program -&gt; ProgramDb -&gt; Maybe ConfiguredProgram
</span><a href="Distribution.Simple.Program.Db.html#lookupProgram"><span class="hs-identifier hs-var">lookupProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="Distribution.Simple.Program.Builtin.html#gccProgram"><span class="hs-identifier hs-var">gccProgram</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgramDb -&gt; Maybe ConfiguredProgram)
-&gt; (LocalBuildInfo -&gt; ProgramDb)
-&gt; LocalBuildInfo
-&gt; Maybe ConfiguredProgram
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; ProgramDb
</span><a href="Distribution.Types.LocalBuildInfo.html#withPrograms"><span class="hs-identifier hs-var">withPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">(LocalBuildInfo -&gt; Bool) -&gt; LocalBuildInfo -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566174"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2698"></span><span>          </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566175"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">CabalException
</span><a href="Distribution.Simple.Errors.html#NoWorkingGcc"><span class="hs-identifier hs-var">NoWorkingGcc</span></a></span><span>
</span><span id="line-2699"></span><span>    </span><span class="annot"><a href="#local-6989586621679566185"><span class="hs-identifier hs-var">explainErrors</span></a></span><span> </span><span id="local-6989586621679566374"><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
</span><a href="#local-6989586621679566374"><span class="hs-identifier hs-var">hdr</span></a></span></span><span> </span><span id="local-6989586621679566375"><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566375"><span class="hs-identifier hs-var">libs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2700"></span><span>      </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566175"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg) -&gt; [ProgArg] -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#ExplainErrors"><span class="hs-identifier hs-var">ExplainErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Either ProgArg ProgArg)
</span><a href="#local-6989586621679566374"><span class="hs-identifier hs-var">hdr</span></a></span><span> </span><span class="annot"><span class="annottext">[ProgArg]
</span><a href="#local-6989586621679566375"><span class="hs-identifier hs-var">libs</span></a></span><span>
</span><span id="line-2701"></span><span>
</span><span id="line-2702"></span><span class="annot"><span class="hs-comment">-- | Output package check warnings and errors. Exit if any errors.</span></span><span>
</span><span id="line-2703"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkPackageProblems"><span class="hs-identifier hs-type">checkPackageProblems</span></a></span><span>
</span><span id="line-2704"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2705"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-2706"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Path to the @.cabal@ file's directory</span></span><span>
</span><span id="line-2707"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.GenericPackageDescription.html#GenericPackageDescription"><span class="hs-identifier hs-type">GenericPackageDescription</span></a></span><span>
</span><span id="line-2708"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span>
</span><span id="line-2709"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2710"></span><span id="checkPackageProblems"><span class="annot"><span class="annottext">checkPackageProblems :: Verbosity
-&gt; ProgArg
-&gt; GenericPackageDescription
-&gt; PackageDescription
-&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkPackageProblems"><span class="hs-identifier hs-var hs-var">checkPackageProblems</span></a></span></span><span> </span><span id="local-6989586621679566377"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566377"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679566378"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566378"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679566379"><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679566379"><span class="hs-identifier hs-var">gpkg</span></a></span></span><span> </span><span id="local-6989586621679566380"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566380"><span class="hs-identifier hs-var">pkg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2711"></span><span>  </span><span id="local-6989586621679566381"><span class="annot"><a href="#local-6989586621679566381"><span class="hs-identifier hs-var">ioChecks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Verbosity -&gt; PackageDescription -&gt; ProgArg -&gt; IO [PackageCheck]
</span><a href="Distribution.PackageDescription.Check.html#checkPackageFiles"><span class="hs-identifier hs-var">checkPackageFiles</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566377"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566380"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566378"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-2712"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679566383"><span class="annot"><a href="#local-6989586621679566383"><span class="hs-identifier hs-var hs-var">pureChecks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription -&gt; [PackageCheck]
</span><a href="Distribution.PackageDescription.Check.html#checkPackage"><span class="hs-identifier hs-var">checkPackage</span></a></span><span> </span><span class="annot"><span class="annottext">GenericPackageDescription
</span><a href="#local-6989586621679566379"><span class="hs-identifier hs-var">gpkg</span></a></span><span>
</span><span id="line-2713"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679566385"><span class="annot"><a href="#local-6989586621679566385"><span class="hs-identifier hs-var">errors</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679566386"><span class="annot"><a href="#local-6989586621679566386"><span class="hs-identifier hs-var">warnings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2714"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">partitionEithers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.mapMaybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679566387"><span class="hs-identifier hs-type">classEW</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679566383"><span class="hs-identifier hs-type">pureChecks</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621679566381"><span class="hs-identifier hs-type">ioChecks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2715"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621679566385"><span class="hs-identifier hs-type">errors</span></a></span><span>
</span><span id="line-2716"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.Utils.html#warn"><span class="hs-identifier hs-type">warn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566377"><span class="hs-identifier hs-type">verbosity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#ppPackageCheck"><span class="hs-identifier hs-type">ppPackageCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566386"><span class="hs-identifier hs-type">warnings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2717"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-type">dieWithException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566377"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Distribution.Simple.Errors.html#CheckPackageProblems"><span class="hs-identifier hs-type">CheckPackageProblems</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#ppPackageCheck"><span class="hs-identifier hs-type">ppPackageCheck</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566385"><span class="hs-identifier hs-type">errors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2718"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2719"></span><span>    </span><span class="hs-comment">-- Classify error/warnings. Left: error, Right: warning.</span><span>
</span><span id="line-2720"></span><span>    </span><span class="annot"><a href="#local-6989586621679566387"><span class="hs-identifier hs-type">classEW</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageCheck"><span class="hs-identifier hs-type">PackageCheck</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageCheck"><span class="hs-identifier hs-type">PackageCheck</span></a></span><span> </span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageCheck"><span class="hs-identifier hs-type">PackageCheck</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2721"></span><span>    </span><span id="local-6989586621679566387"><span class="annot"><span class="annottext">classEW :: PackageCheck -&gt; Maybe (Either PackageCheck PackageCheck)
</span><a href="#local-6989586621679566387"><span class="hs-identifier hs-var hs-var">classEW</span></a></span></span><span> </span><span id="local-6989586621679566390"><span class="annot"><span class="annottext">e :: PackageCheck
</span><a href="#local-6989586621679566390"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageBuildImpossible"><span class="hs-identifier hs-type">PackageBuildImpossible</span></a></span><span> </span><span class="annot"><span class="annottext">CheckExplanation
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either PackageCheck PackageCheck
-&gt; Maybe (Either PackageCheck PackageCheck)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageCheck -&gt; Either PackageCheck PackageCheck
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">PackageCheck
</span><a href="#local-6989586621679566390"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2722"></span><span>    </span><span class="annot"><a href="#local-6989586621679566387"><span class="hs-identifier hs-var">classEW</span></a></span><span> </span><span id="local-6989586621679566392"><span class="annot"><span class="annottext">w :: PackageCheck
</span><a href="#local-6989586621679566392"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageBuildWarning"><span class="hs-identifier hs-type">PackageBuildWarning</span></a></span><span> </span><span class="annot"><span class="annottext">CheckExplanation
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either PackageCheck PackageCheck
-&gt; Maybe (Either PackageCheck PackageCheck)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageCheck -&gt; Either PackageCheck PackageCheck
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">PackageCheck
</span><a href="#local-6989586621679566392"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2723"></span><span>    </span><span class="annot"><a href="#local-6989586621679566387"><span class="hs-identifier hs-var">classEW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageDistSuspicious"><span class="hs-identifier hs-type">PackageDistSuspicious</span></a></span><span> </span><span class="annot"><span class="annottext">CheckExplanation
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either PackageCheck PackageCheck)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2724"></span><span>    </span><span class="annot"><a href="#local-6989586621679566387"><span class="hs-identifier hs-var">classEW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageDistSuspiciousWarn"><span class="hs-identifier hs-type">PackageDistSuspiciousWarn</span></a></span><span> </span><span class="annot"><span class="annottext">CheckExplanation
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either PackageCheck PackageCheck)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2725"></span><span>    </span><span class="annot"><a href="#local-6989586621679566387"><span class="hs-identifier hs-var">classEW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.PackageDescription.Check.Warning.html#PackageDistInexcusable"><span class="hs-identifier hs-type">PackageDistInexcusable</span></a></span><span> </span><span class="annot"><span class="annottext">CheckExplanation
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either PackageCheck PackageCheck)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2726"></span><span>
</span><span id="line-2727"></span><span class="annot"><span class="hs-comment">-- | Perform checks if a shared executable can be built</span></span><span>
</span><span id="line-2728"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkSharedExes"><span class="hs-identifier hs-type">checkSharedExes</span></a></span><span>
</span><span id="line-2729"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2730"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-2731"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2732"></span><span id="checkSharedExes"><span class="annot"><span class="annottext">checkSharedExes :: Verbosity -&gt; LocalBuildInfo -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkSharedExes"><span class="hs-identifier hs-var hs-var">checkSharedExes</span></a></span></span><span> </span><span id="local-6989586621679566397"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566397"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679566398"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566398"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2733"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679566399"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Windows"><span class="hs-identifier hs-var">Windows</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2734"></span><span>    </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566397"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2735"></span><span>      </span><span class="annot"><span class="annottext">OS -&gt; ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#NoOSSupport"><span class="hs-identifier hs-var">NoOSSupport</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679566399"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;shared executables&quot;</span></span><span>
</span><span id="line-2736"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2737"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="annot"><span class="annottext">Arch
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566399"><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679566399"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566398"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2738"></span><span>
</span><span id="line-2739"></span><span class="annot"><span class="hs-comment">-- | Preform checks if a relocatable build is allowed</span></span><span>
</span><span id="line-2740"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkRelocatable"><span class="hs-identifier hs-type">checkRelocatable</span></a></span><span>
</span><span id="line-2741"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Verbosity.html#Verbosity"><span class="hs-identifier hs-type">Verbosity</span></a></span><span>
</span><span id="line-2742"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.PackageDescription.html#PackageDescription"><span class="hs-identifier hs-type">PackageDescription</span></a></span><span>
</span><span id="line-2743"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Types.LocalBuildInfo.html#LocalBuildInfo"><span class="hs-identifier hs-type">LocalBuildInfo</span></a></span><span>
</span><span id="line-2744"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2745"></span><span id="checkRelocatable"><span class="annot"><span class="annottext">checkRelocatable :: Verbosity -&gt; PackageDescription -&gt; LocalBuildInfo -&gt; IO ()
</span><a href="Distribution.Simple.Configure.html#checkRelocatable"><span class="hs-identifier hs-var hs-var">checkRelocatable</span></a></span></span><span> </span><span id="local-6989586621679566403"><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566403"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span id="local-6989586621679566404"><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566404"><span class="hs-identifier hs-var">pkg</span></a></span></span><span> </span><span id="local-6989586621679566405"><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566405"><span class="hs-identifier hs-var">lbi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2746"></span><span>  </span><span class="annot"><span class="annottext">[IO ()] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span>
</span><span id="line-2747"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679566406"><span class="hs-identifier hs-var">checkOS</span></a></span><span>
</span><span id="line-2748"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679566407"><span class="hs-identifier hs-var">checkCompiler</span></a></span><span>
</span><span id="line-2749"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679566408"><span class="hs-identifier hs-var">packagePrefixRelative</span></a></span><span>
</span><span id="line-2750"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679566409"><span class="hs-identifier hs-var">depsPrefixRelative</span></a></span><span>
</span><span id="line-2751"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-2752"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2753"></span><span>    </span><span class="hs-comment">-- Check if the OS support relocatable builds.</span><span>
</span><span id="line-2754"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-2755"></span><span>    </span><span class="hs-comment">-- If you add new OS' to this list, and your OS supports dynamic libraries</span><span>
</span><span id="line-2756"></span><span>    </span><span class="hs-comment">-- and RPATH, make sure you add your OS to RPATH-support list of:</span><span>
</span><span id="line-2757"></span><span>    </span><span class="hs-comment">-- Distribution.Simple.GHC.getRPaths</span><span>
</span><span id="line-2758"></span><span>    </span><span id="local-6989586621679566406"><span class="annot"><span class="annottext">checkOS :: IO ()
</span><a href="#local-6989586621679566406"><span class="hs-identifier hs-var hs-var">checkOS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2759"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679566418"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; [OS] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OSX"><span class="hs-identifier hs-var">OSX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Linux"><span class="hs-identifier hs-var">Linux</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2760"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566403"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2761"></span><span>          </span><span class="annot"><span class="annottext">OS -&gt; ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#NoOSSupport"><span class="hs-identifier hs-var">NoOSSupport</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679566418"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;relocatable builds&quot;</span></span><span>
</span><span id="line-2762"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2763"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="annot"><span class="annottext">Arch
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679566418"><span class="annot"><span class="annottext">OS
</span><a href="#local-6989586621679566418"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Platform
</span><a href="Distribution.Types.LocalBuildInfo.html#hostPlatform"><span class="hs-identifier hs-var">hostPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566405"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2764"></span><span>
</span><span id="line-2765"></span><span>    </span><span class="hs-comment">-- Check if the Compiler support relocatable builds</span><span>
</span><span id="line-2766"></span><span>    </span><span id="local-6989586621679566407"><span class="annot"><span class="annottext">checkCompiler :: IO ()
</span><a href="#local-6989586621679566407"><span class="hs-identifier hs-var hs-var">checkCompiler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2767"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; CompilerFlavor
</span><a href="Distribution.Simple.Compiler.html#compilerFlavor"><span class="hs-identifier hs-var">compilerFlavor</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679566432"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor -&gt; [CompilerFlavor] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2768"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566403"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2769"></span><span>          </span><span class="annot"><span class="annottext">ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#NoCompilerSupport"><span class="hs-identifier hs-var">NoCompilerSupport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; ProgArg
forall a. Show a =&gt; a -&gt; ProgArg
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679566432"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2770"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2771"></span><span>        </span><span id="local-6989586621679566432"><span class="annot"><span class="annottext">comp :: Compiler
</span><a href="#local-6989586621679566432"><span class="hs-identifier hs-var hs-var">comp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; Compiler
</span><a href="Distribution.Types.LocalBuildInfo.html#compiler"><span class="hs-identifier hs-var">compiler</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566405"><span class="hs-identifier hs-var">lbi</span></a></span><span>
</span><span id="line-2772"></span><span>
</span><span id="line-2773"></span><span>    </span><span class="hs-comment">-- Check if all the install dirs are relative to same prefix</span><span>
</span><span id="line-2774"></span><span>    </span><span id="local-6989586621679566408"><span class="annot"><span class="annottext">packagePrefixRelative :: IO ()
</span><a href="#local-6989586621679566408"><span class="hs-identifier hs-var hs-var">packagePrefixRelative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2775"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstallDirs ProgArg -&gt; Bool
</span><a href="#local-6989586621679566440"><span class="hs-identifier hs-var">relativeInstallDirs</span></a></span><span> </span><span class="annot"><span class="annottext">InstallDirs ProgArg
</span><a href="#local-6989586621679566441"><span class="hs-identifier hs-var">installDirs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2776"></span><span>        </span><span class="annot"><span class="annottext">Verbosity -&gt; CabalException -&gt; IO ()
forall a1 a.
(HasCallStack, Show a1, Typeable a1,
 Exception (VerboseException a1)) =&gt;
Verbosity -&gt; a1 -&gt; IO a
</span><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-var">dieWithException</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566403"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">(CabalException -&gt; IO ()) -&gt; CabalException -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2777"></span><span>          </span><span class="annot"><span class="annottext">InstallDirs ProgArg -&gt; CabalException
</span><a href="Distribution.Simple.Errors.html#InstallDirsNotPrefixRelative"><span class="hs-identifier hs-var">InstallDirsNotPrefixRelative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstallDirs ProgArg
</span><a href="#local-6989586621679566441"><span class="hs-identifier hs-var">installDirs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2778"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2779"></span><span>        </span><span class="hs-comment">-- NB: should be good enough to check this against the default</span><span>
</span><span id="line-2780"></span><span>        </span><span class="hs-comment">-- component ID, but if we wanted to be strictly correct we'd</span><span>
</span><span id="line-2781"></span><span>        </span><span class="hs-comment">-- check for each ComponentId.</span><span>
</span><span id="line-2782"></span><span>        </span><span id="local-6989586621679566441"><span class="annot"><span class="annottext">installDirs :: InstallDirs ProgArg
</span><a href="#local-6989586621679566441"><span class="hs-identifier hs-var hs-var">installDirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageDescription
-&gt; LocalBuildInfo -&gt; CopyDest -&gt; InstallDirs ProgArg
</span><a href="Distribution.Simple.LocalBuildInfo.html#absoluteInstallDirs"><span class="hs-identifier hs-var">absoluteInstallDirs</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566404"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566405"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">CopyDest
</span><a href="Distribution.Simple.InstallDirs.html#NoCopyDest"><span class="hs-identifier hs-var">NoCopyDest</span></a></span><span>
</span><span id="line-2783"></span><span>        </span><span id="local-6989586621679566443"><span class="annot"><span class="annottext">p :: ProgArg
</span><a href="#local-6989586621679566443"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstallDirs ProgArg -&gt; ProgArg
forall dir. InstallDirs dir -&gt; dir
</span><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">InstallDirs ProgArg
</span><a href="#local-6989586621679566441"><span class="hs-identifier hs-var">installDirs</span></a></span><span>
</span><span id="line-2784"></span><span>        </span><span id="local-6989586621679566440"><span class="annot"><span class="annottext">relativeInstallDirs :: InstallDirs ProgArg -&gt; Bool
</span><a href="#local-6989586621679566440"><span class="hs-identifier hs-var hs-var">relativeInstallDirs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Simple.InstallDirs.html#InstallDirs"><span class="hs-identifier hs-type">InstallDirs</span></a></span><span class="hs-special">{</span><span id="local-6989586621679566448"><span id="local-6989586621679566449"><span id="local-6989586621679566450"><span id="local-6989586621679566451"><span id="local-6989586621679566452"><span id="local-6989586621679566453"><span id="local-6989586621679566454"><span id="local-6989586621679566455"><span id="local-6989586621679566456"><span id="local-6989586621679566457"><span id="local-6989586621679566458"><span id="local-6989586621679566459"><span id="local-6989586621679566460"><span id="local-6989586621679566461"><span id="local-6989586621679566462"><span id="local-6989586621679566463"><span class="annot"><span class="annottext">ProgArg
prefix :: forall dir. InstallDirs dir -&gt; dir
bindir :: forall dir. InstallDirs dir -&gt; dir
libdir :: forall dir. InstallDirs dir -&gt; dir
dynlibdir :: forall dir. InstallDirs dir -&gt; dir
libexecdir :: forall dir. InstallDirs dir -&gt; dir
datadir :: forall dir. InstallDirs dir -&gt; dir
docdir :: forall dir. InstallDirs dir -&gt; dir
sysconfdir :: forall dir. InstallDirs dir -&gt; dir
prefix :: ProgArg
bindir :: ProgArg
libdir :: ProgArg
libsubdir :: ProgArg
dynlibdir :: ProgArg
flibdir :: ProgArg
libexecdir :: ProgArg
libexecsubdir :: ProgArg
includedir :: ProgArg
datadir :: ProgArg
datasubdir :: ProgArg
docdir :: ProgArg
mandir :: ProgArg
htmldir :: ProgArg
haddockdir :: ProgArg
sysconfdir :: ProgArg
haddockdir :: forall dir. InstallDirs dir -&gt; dir
htmldir :: forall dir. InstallDirs dir -&gt; dir
mandir :: forall dir. InstallDirs dir -&gt; dir
datasubdir :: forall dir. InstallDirs dir -&gt; dir
includedir :: forall dir. InstallDirs dir -&gt; dir
libexecsubdir :: forall dir. InstallDirs dir -&gt; dir
flibdir :: forall dir. InstallDirs dir -&gt; dir
libsubdir :: forall dir. InstallDirs dir -&gt; dir
</span><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2785"></span><span>          </span><span class="annot"><span class="annottext">(Maybe ProgArg -&gt; Bool) -&gt; [Maybe ProgArg] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span>
</span><span id="line-2786"></span><span>            </span><span class="annot"><span class="annottext">Maybe ProgArg -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span>
</span><span id="line-2787"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Maybe ProgArg) -&gt; [ProgArg] -&gt; [Maybe ProgArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-2788"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; Maybe ProgArg
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><span class="hs-identifier hs-var">stripPrefix</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566443"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2789"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566449"><span class="hs-identifier hs-var">bindir</span></a></span><span>
</span><span id="line-2790"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566450"><span class="hs-identifier hs-var">libdir</span></a></span><span>
</span><span id="line-2791"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566452"><span class="hs-identifier hs-var">dynlibdir</span></a></span><span>
</span><span id="line-2792"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566454"><span class="hs-identifier hs-var">libexecdir</span></a></span><span>
</span><span id="line-2793"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566456"><span class="hs-identifier hs-var">includedir</span></a></span><span>
</span><span id="line-2794"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566457"><span class="hs-identifier hs-var">datadir</span></a></span><span>
</span><span id="line-2795"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566459"><span class="hs-identifier hs-var">docdir</span></a></span><span>
</span><span id="line-2796"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566460"><span class="hs-identifier hs-var">mandir</span></a></span><span>
</span><span id="line-2797"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566461"><span class="hs-identifier hs-var">htmldir</span></a></span><span>
</span><span id="line-2798"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566462"><span class="hs-identifier hs-var">haddockdir</span></a></span><span>
</span><span id="line-2799"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566463"><span class="hs-identifier hs-var">sysconfdir</span></a></span><span>
</span><span id="line-2800"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-2801"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-2802"></span><span>
</span><span id="line-2803"></span><span>    </span><span class="hs-comment">-- Check if the library dirs of the dependencies that are in the package</span><span>
</span><span id="line-2804"></span><span>    </span><span class="hs-comment">-- database to which the package is installed are relative to the</span><span>
</span><span id="line-2805"></span><span>    </span><span class="hs-comment">-- prefix of the package</span><span>
</span><span id="line-2806"></span><span>    </span><span id="local-6989586621679566409"><span class="annot"><span class="annottext">depsPrefixRelative :: IO ()
</span><a href="#local-6989586621679566409"><span class="hs-identifier hs-var hs-var">depsPrefixRelative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2807"></span><span>      </span><span id="local-6989586621679566475"><span class="annot"><a href="#local-6989586621679566475"><span class="hs-identifier hs-var">pkgr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Verbosity
-&gt; LocalBuildInfo
-&gt; PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
-&gt; IO (SymbolicPath CWD ('Dir Pkg))
</span><a href="Distribution.Simple.GHC.html#pkgRoot"><span class="hs-identifier hs-var">GHC.pkgRoot</span></a></span><span> </span><span class="annot"><span class="annottext">Verbosity
</span><a href="#local-6989586621679566403"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566405"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PackageDBStack -&gt; PackageDBX (SymbolicPath Pkg ('Dir PkgDB))
forall from. PackageDBStackX from -&gt; PackageDBX from
</span><a href="Distribution.Simple.Compiler.html#registrationPackageDB"><span class="hs-identifier hs-var">registrationPackageDB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; PackageDBStack
</span><a href="Distribution.Types.LocalBuildInfo.html#withPackageDB"><span class="hs-identifier hs-var">withPackageDB</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566405"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2808"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">traverse_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679566478"><span class="hs-identifier hs-type">doCheck</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Utils.Path.html#getSymbolicPath"><span class="hs-identifier hs-type">getSymbolicPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566475"><span class="hs-identifier hs-type">pkgr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679566479"><span class="hs-identifier hs-type">ipkgs</span></a></span><span>
</span><span id="line-2809"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-2810"></span><span>        </span><span id="local-6989586621679566478"><span class="annot"><span class="annottext">doCheck :: ProgArg -&gt; InstalledPackageInfo -&gt; IO ()
</span><a href="#local-6989586621679566478"><span class="hs-identifier hs-var hs-var">doCheck</span></a></span></span><span> </span><span id="local-6989586621679566494"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566494"><span class="hs-identifier hs-var">pkgr</span></a></span></span><span> </span><span id="local-6989586621679566495"><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566495"><span class="hs-identifier hs-var">ipkg</span></a></span></span><span>
</span><span id="line-2811"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (ProgArg -&gt; Bool) -&gt; Maybe ProgArg -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgArg -&gt; ProgArg -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566494"><span class="hs-identifier hs-var">pkgr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; Maybe ProgArg
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#pkgRoot"><span class="hs-identifier hs-var">IPI.pkgRoot</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566495"><span class="hs-identifier hs-var">ipkg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2812"></span><span>              </span><span class="annot"><span class="annottext">[ProgArg] -&gt; (ProgArg -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstalledPackageInfo -&gt; [ProgArg]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.InstalledPackageInfo.html#libraryDirs"><span class="hs-identifier hs-var">IPI.libraryDirs</span></a></span><span> </span><span class="annot"><span class="annottext">InstalledPackageInfo
</span><a href="#local-6989586621679566495"><span class="hs-identifier hs-var">ipkg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ProgArg -&gt; IO ()) -&gt; IO ()) -&gt; (ProgArg -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679566497"><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566497"><span class="hs-identifier hs-var">libdir</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2813"></span><span>                </span><span class="hs-comment">-- When @prefix@ is not under @pkgroot@,</span><span>
</span><span id="line-2814"></span><span>                </span><span class="hs-comment">-- @shortRelativePath prefix pkgroot@ will return a path with</span><span>
</span><span id="line-2815"></span><span>                </span><span class="hs-comment">-- @..@s and following check will fail without @canonicalizePath@.</span><span>
</span><span id="line-2816"></span><span>                </span><span id="local-6989586621679566498"><span class="annot"><a href="#local-6989586621679566498"><span class="hs-identifier hs-var">canonicalized</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; IO ProgArg
</span><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#canonicalizePath"><span class="hs-identifier hs-var">canonicalizePath</span></a></span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><a href="#local-6989586621679566497"><span class="hs-identifier hs-var">libdir</span></a></span><span>
</span><span id="line-2817"></span><span>                </span><span class="hs-comment">-- The @prefix@ itself must also be canonicalized because</span><span>
</span><span id="line-2818"></span><span>                </span><span class="hs-comment">-- canonicalizing @libdir@ may expand symlinks which would make</span><span>
</span><span id="line-2819"></span><span>                </span><span class="hs-comment">-- @prefix@ no longer being a prefix of @canonical libdir@,</span><span>
</span><span id="line-2820"></span><span>                </span><span class="hs-comment">-- while @canonical p@ could be a prefix of @canonical libdir@</span><span>
</span><span id="line-2821"></span><span>                </span><span id="local-6989586621679566499"><span class="annot"><a href="#local-6989586621679566499"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="../../directory-1.3.9.0-af18/src/System.Directory.html#canonicalizePath"><span class="hs-identifier hs-type">canonicalizePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566500"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-2822"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679566499"><span class="hs-identifier hs-type">p'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`isPrefixOf`</span></span><span> </span><span class="annot"><a href="#local-6989586621679566498"><span class="hs-identifier hs-type">canonicalized</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2823"></span><span>                  </span><span class="annot"><a href="Distribution.Simple.Utils.html#dieWithException"><span class="hs-identifier hs-type">dieWithException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566403"><span class="hs-identifier hs-type">verbosity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-2824"></span><span>                    </span><span class="annot"><a href="Distribution.Simple.Errors.html#LibDirDepsPrefixNotRelative"><span class="hs-identifier hs-type">LibDirDepsPrefixNotRelative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566497"><span class="hs-identifier hs-type">libdir</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679566500"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-2825"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2826"></span><span>              </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-2827"></span><span>        </span><span class="hs-comment">-- NB: should be good enough to check this against the default</span><span>
</span><span id="line-2828"></span><span>        </span><span class="hs-comment">-- component ID, but if we wanted to be strictly correct we'd</span><span>
</span><span id="line-2829"></span><span>        </span><span class="hs-comment">-- check for each ComponentId.</span><span>
</span><span id="line-2830"></span><span>        </span><span id="local-6989586621679566502"><span class="annot"><span class="annottext">installDirs :: InstallDirs ProgArg
</span><a href="#local-6989586621679566502"><span class="hs-identifier hs-var hs-var">installDirs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PackageDescription
-&gt; LocalBuildInfo -&gt; CopyDest -&gt; InstallDirs ProgArg
</span><a href="Distribution.Simple.LocalBuildInfo.html#absoluteInstallDirs"><span class="hs-identifier hs-var">absoluteInstallDirs</span></a></span><span> </span><span class="annot"><span class="annottext">PackageDescription
</span><a href="#local-6989586621679566404"><span class="hs-identifier hs-var">pkg</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566405"><span class="hs-identifier hs-var">lbi</span></a></span><span> </span><span class="annot"><span class="annottext">CopyDest
</span><a href="Distribution.Simple.InstallDirs.html#NoCopyDest"><span class="hs-identifier hs-var">NoCopyDest</span></a></span><span>
</span><span id="line-2831"></span><span>        </span><span id="local-6989586621679566500"><span class="annot"><span class="annottext">p :: ProgArg
</span><a href="#local-6989586621679566500"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstallDirs ProgArg -&gt; ProgArg
forall dir. InstallDirs dir -&gt; dir
</span><a href="Distribution.Simple.InstallDirs.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">InstallDirs ProgArg
</span><a href="#local-6989586621679566502"><span class="hs-identifier hs-var">installDirs</span></a></span><span>
</span><span id="line-2832"></span><span>        </span><span id="local-6989586621679566479"><span class="annot"><span class="annottext">ipkgs :: [InstalledPackageInfo]
</span><a href="#local-6989586621679566479"><span class="hs-identifier hs-var hs-var">ipkgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstalledPackageIndex -&gt; [InstalledPackageInfo]
forall a. PackageIndex a -&gt; [a]
</span><a href="Distribution.Simple.PackageIndex.html#allPackages"><span class="hs-identifier hs-var">PackageIndex.allPackages</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocalBuildInfo -&gt; InstalledPackageIndex
</span><a href="Distribution.Types.LocalBuildInfo.html#installedPkgs"><span class="hs-identifier hs-var">installedPkgs</span></a></span><span> </span><span class="annot"><span class="annottext">LocalBuildInfo
</span><a href="#local-6989586621679566405"><span class="hs-identifier hs-var">lbi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2833"></span><span>
</span><span id="line-2834"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-2835"></span><span class="hs-comment">-- Testing foreign library requirements</span><span>
</span><span id="line-2836"></span><span>
</span><span id="line-2837"></span><span class="annot"><a href="Distribution.Simple.Configure.html#unsupportedForeignLibs"><span class="hs-identifier hs-type">unsupportedForeignLibs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#ForeignLib"><span class="hs-identifier hs-type">ForeignLib</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-2838"></span><span id="unsupportedForeignLibs"><span class="annot"><span class="annottext">unsupportedForeignLibs :: Compiler -&gt; Platform -&gt; [ForeignLib] -&gt; [ProgArg]
</span><a href="Distribution.Simple.Configure.html#unsupportedForeignLibs"><span class="hs-identifier hs-var hs-var">unsupportedForeignLibs</span></a></span></span><span> </span><span id="local-6989586621679566504"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679566504"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679566505"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679566505"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2839"></span><span>  </span><span class="annot"><span class="annottext">(ForeignLib -&gt; Maybe ProgArg) -&gt; [ForeignLib] -&gt; [ProgArg]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; Platform -&gt; ForeignLib -&gt; Maybe ProgArg
</span><a href="Distribution.Simple.Configure.html#checkForeignLibSupported"><span class="hs-identifier hs-var">checkForeignLibSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679566504"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679566505"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2840"></span><span>
</span><span id="line-2841"></span><span class="annot"><a href="Distribution.Simple.Configure.html#checkForeignLibSupported"><span class="hs-identifier hs-type">checkForeignLibSupported</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Simple.Compiler.html#Compiler"><span class="hs-identifier hs-type">Compiler</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#ForeignLib"><span class="hs-identifier hs-type">ForeignLib</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-2842"></span><span id="checkForeignLibSupported"><span class="annot"><span class="annottext">checkForeignLibSupported :: Compiler -&gt; Platform -&gt; ForeignLib -&gt; Maybe ProgArg
</span><a href="Distribution.Simple.Configure.html#checkForeignLibSupported"><span class="hs-identifier hs-var hs-var">checkForeignLibSupported</span></a></span></span><span> </span><span id="local-6989586621679566507"><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679566507"><span class="hs-identifier hs-var">comp</span></a></span></span><span> </span><span id="local-6989586621679566508"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679566508"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621679566509"><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompilerFlavor -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566510"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Compiler -&gt; CompilerFlavor
</span><a href="Distribution.Simple.Compiler.html#compilerFlavor"><span class="hs-identifier hs-var">compilerFlavor</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679566507"><span class="hs-identifier hs-var">comp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2843"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2844"></span><span>    </span><span class="annot"><a href="#local-6989586621679566510"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#CompilerFlavor"><span class="hs-identifier hs-type">CompilerFlavor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-2845"></span><span>    </span><span id="local-6989586621679566510"><span class="annot"><span class="annottext">go :: CompilerFlavor -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566510"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Compiler.html#GHC"><span class="hs-identifier hs-var">GHC</span></a></span><span>
</span><span id="line-2846"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Compiler -&gt; Version
</span><a href="Distribution.Simple.Compiler.html#compilerVersion"><span class="hs-identifier hs-var">compilerVersion</span></a></span><span> </span><span class="annot"><span class="annottext">Compiler
</span><a href="#local-6989586621679566507"><span class="hs-identifier hs-var">comp</span></a></span><span> </span><span class="annot"><span class="annottext">Version -&gt; Version -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.Version.html#mkVersion"><span class="hs-identifier hs-var">mkVersion</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2847"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2848"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Building foreign libraries is only supported with GHC &gt;= 7.8&quot;</span></span><span>
</span><span id="line-2849"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2850"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566513"><span class="hs-identifier hs-var">goGhcPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621679566508"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-2851"></span><span>    </span><span class="annot"><a href="#local-6989586621679566510"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CompilerFlavor
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2852"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2853"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Building foreign libraries is currently only supported with ghc&quot;</span></span><span>
</span><span id="line-2854"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2855"></span><span>
</span><span id="line-2856"></span><span>    </span><span class="annot"><a href="#local-6989586621679566513"><span class="hs-identifier hs-type">goGhcPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-2857"></span><span>    </span><span id="local-6989586621679566513"><span class="annot"><span class="annottext">goGhcPlatform :: Platform -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566513"><span class="hs-identifier hs-var hs-var">goGhcPlatform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="annot"><span class="annottext">Arch
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#OSX"><span class="hs-identifier hs-var">OSX</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignLibType -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566514"><span class="hs-identifier hs-var">goGhcOsx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibType"><span class="hs-identifier hs-var">foreignLibType</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2858"></span><span>    </span><span class="annot"><a href="#local-6989586621679566513"><span class="hs-identifier hs-var">goGhcPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="annot"><span class="annottext">Arch
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Linux"><span class="hs-identifier hs-var">Linux</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignLibType -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566516"><span class="hs-identifier hs-var">goGhcLinux</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibType"><span class="hs-identifier hs-var">foreignLibType</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2859"></span><span>    </span><span class="annot"><a href="#local-6989586621679566513"><span class="hs-identifier hs-var">goGhcPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="annot"><span class="annottext">Arch
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#I386"><span class="hs-identifier hs-var">I386</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Windows"><span class="hs-identifier hs-var">Windows</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignLibType -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566518"><span class="hs-identifier hs-var">goGhcWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibType"><span class="hs-identifier hs-var">foreignLibType</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2860"></span><span>    </span><span class="annot"><a href="#local-6989586621679566513"><span class="hs-identifier hs-var">goGhcPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="annot"><span class="annottext">Arch
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#X86_64"><span class="hs-identifier hs-var">X86_64</span></a></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.System.html#Windows"><span class="hs-identifier hs-var">Windows</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignLibType -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566518"><span class="hs-identifier hs-var">goGhcWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibType"><span class="hs-identifier hs-var">foreignLibType</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2861"></span><span>    </span><span class="annot"><a href="#local-6989586621679566513"><span class="hs-identifier hs-var">goGhcPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2862"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2863"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Building foreign libraries is currently only supported on Mac OS, &quot;</span></span><span>
</span><span id="line-2864"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Linux and Windows&quot;</span></span><span>
</span><span id="line-2865"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2866"></span><span>
</span><span id="line-2867"></span><span>    </span><span class="annot"><a href="#local-6989586621679566514"><span class="hs-identifier hs-type">goGhcOsx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibType"><span class="hs-identifier hs-type">ForeignLibType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-2868"></span><span>    </span><span id="local-6989586621679566514"><span class="annot"><span class="annottext">goGhcOsx :: ForeignLibType -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566514"><span class="hs-identifier hs-var hs-var">goGhcOsx</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibNativeShared"><span class="hs-identifier hs-var">ForeignLibNativeShared</span></a></span><span>
</span><span id="line-2869"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RelativePath Source 'File] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; [RelativePath Source 'File]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibModDefFile"><span class="hs-identifier hs-var">foreignLibModDefFile</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2870"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2871"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Module definition file not supported on OSX&quot;</span></span><span>
</span><span id="line-2872"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2873"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe LibVersionInfo -&gt; Bool
forall a. Maybe a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; Maybe LibVersionInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibVersionInfo"><span class="hs-identifier hs-var">foreignLibVersionInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2874"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2875"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Foreign library versioning not currently supported on OSX&quot;</span></span><span>
</span><span id="line-2876"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2877"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2878"></span><span>          </span><span class="annot"><span class="annottext">Maybe ProgArg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2879"></span><span>    </span><span class="annot"><a href="#local-6989586621679566514"><span class="hs-identifier hs-var">goGhcOsx</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLibType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2880"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2881"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;We can currently only build shared foreign libraries on OSX&quot;</span></span><span>
</span><span id="line-2882"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2883"></span><span>
</span><span id="line-2884"></span><span>    </span><span class="annot"><a href="#local-6989586621679566516"><span class="hs-identifier hs-type">goGhcLinux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibType"><span class="hs-identifier hs-type">ForeignLibType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-2885"></span><span>    </span><span id="local-6989586621679566516"><span class="annot"><span class="annottext">goGhcLinux :: ForeignLibType -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566516"><span class="hs-identifier hs-var hs-var">goGhcLinux</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibNativeShared"><span class="hs-identifier hs-var">ForeignLibNativeShared</span></a></span><span>
</span><span id="line-2886"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RelativePath Source 'File] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; [RelativePath Source 'File]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibModDefFile"><span class="hs-identifier hs-var">foreignLibModDefFile</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2887"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2888"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Module definition file not supported on Linux&quot;</span></span><span>
</span><span id="line-2889"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2890"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe LibVersionInfo -&gt; Bool
forall a. Maybe a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; Maybe LibVersionInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibVersionInfo"><span class="hs-identifier hs-var">foreignLibVersionInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2891"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Version -&gt; Bool
forall a. Maybe a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; Maybe Version
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibVersionLinux"><span class="hs-identifier hs-var">foreignLibVersionLinux</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2892"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2893"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;You must not specify both lib-version-info and lib-version-linux&quot;</span></span><span>
</span><span id="line-2894"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2895"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2896"></span><span>          </span><span class="annot"><span class="annottext">Maybe ProgArg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2897"></span><span>    </span><span class="annot"><a href="#local-6989586621679566516"><span class="hs-identifier hs-var">goGhcLinux</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLibType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2898"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2899"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;We can currently only build shared foreign libraries on Linux&quot;</span></span><span>
</span><span id="line-2900"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2901"></span><span>
</span><span id="line-2902"></span><span>    </span><span class="annot"><a href="#local-6989586621679566518"><span class="hs-identifier hs-type">goGhcWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibType"><span class="hs-identifier hs-type">ForeignLibType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-2903"></span><span>    </span><span id="local-6989586621679566518"><span class="annot"><span class="annottext">goGhcWindows :: ForeignLibType -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566518"><span class="hs-identifier hs-var hs-var">goGhcWindows</span></a></span></span><span> </span><span class="annot"><span class="annottext">ForeignLibType
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibType.html#ForeignLibNativeShared"><span class="hs-identifier hs-var">ForeignLibNativeShared</span></a></span><span>
</span><span id="line-2904"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679566524"><span class="hs-identifier hs-var">standalone</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2905"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2906"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;We can currently only build standalone libraries on Windows. Use\n&quot;</span></span><span>
</span><span id="line-2907"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;  if os(Windows)\n&quot;</span></span><span>
</span><span id="line-2908"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;    options: standalone\n&quot;</span></span><span>
</span><span id="line-2909"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;in your foreign-library stanza.&quot;</span></span><span>
</span><span id="line-2910"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2911"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe LibVersionInfo -&gt; Bool
forall a. Maybe a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ForeignLib -&gt; Maybe LibVersionInfo
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibVersionInfo"><span class="hs-identifier hs-var">foreignLibVersionInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2912"></span><span>          </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2913"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;Foreign library versioning not currently supported on Windows.\n&quot;</span></span><span>
</span><span id="line-2914"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;You can specify module definition files in the mod-def-file field.&quot;</span></span><span>
</span><span id="line-2915"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-2916"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2917"></span><span>          </span><span class="annot"><span class="annottext">Maybe ProgArg
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2918"></span><span>    </span><span class="annot"><a href="#local-6989586621679566518"><span class="hs-identifier hs-var">goGhcWindows</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLibType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2919"></span><span>      </span><span class="annot"><span class="annottext">[ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var">unsupported</span></a></span><span>
</span><span id="line-2920"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ProgArg
</span><span class="hs-string">&quot;We can currently only build shared foreign libraries on Windows&quot;</span></span><span>
</span><span id="line-2921"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2922"></span><span>
</span><span id="line-2923"></span><span>    </span><span class="annot"><a href="#local-6989586621679566524"><span class="hs-identifier hs-type">standalone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-2924"></span><span>    </span><span id="local-6989586621679566524"><span class="annot"><span class="annottext">standalone :: Bool
</span><a href="#local-6989586621679566524"><span class="hs-identifier hs-var hs-var">standalone</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignLibOption
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLibOption.html#ForeignLibStandalone"><span class="hs-identifier hs-var">ForeignLibStandalone</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLibOption -&gt; [ForeignLibOption] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">ForeignLib -&gt; [ForeignLibOption]
</span><a href="../../Cabal-syntax-3.14.1.0-ebb2/src/Distribution.Types.ForeignLib.html#foreignLibOptions"><span class="hs-identifier hs-var">foreignLibOptions</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignLib
</span><a href="#local-6989586621679566509"><span class="hs-identifier hs-var">flib</span></a></span><span>
</span><span id="line-2925"></span><span>
</span><span id="line-2926"></span><span>    </span><span class="annot"><a href="#local-6989586621679566512"><span class="hs-identifier hs-type">unsupported</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-2927"></span><span>    </span><span id="local-6989586621679566512"><span class="annot"><span class="annottext">unsupported :: [ProgArg] -&gt; Maybe ProgArg
</span><a href="#local-6989586621679566512"><span class="hs-identifier hs-var hs-var">unsupported</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgArg -&gt; Maybe ProgArg
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ProgArg -&gt; Maybe ProgArg)
-&gt; ([ProgArg] -&gt; ProgArg) -&gt; [ProgArg] -&gt; Maybe ProgArg
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ProgArg] -&gt; ProgArg
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-2928"></span></pre></body></html>