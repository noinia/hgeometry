<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>System.Timeout</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">base-4.21.0.0: Core data structures and operations</span><ul class="links" id="page-menu"><li><a href="src/System.Timeout.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) The University of Glasgow 2007</td></tr><tr><th>License</th><td>BSD-style (see the file libraries/base/LICENSE)</td></tr><tr><th>Maintainer</th><td>libraries@haskell.org</td></tr><tr><th>Stability</th><td>stable</td></tr><tr><th>Portability</th><td>non-portable</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">System.Timeout</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Attach a timeout event to arbitrary <code><a href="Prelude.html#t:IO" title="Prelude">IO</a></code> computations.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Timeout">Timeout</a></li><li class="src short"><a href="#v:timeout">timeout</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Prelude.html#t:IO" title="Prelude">IO</a> a -&gt; <a href="Prelude.html#t:IO" title="Prelude">IO</a> (<a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a)</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Timeout" class="def">Timeout</a> <a href="src/System.Timeout.html#Timeout" class="link">Source</a> <a href="#t:Timeout" class="selflink">#</a></p><div class="doc"><p>An exception thrown to a thread by <code><a href="System-Timeout.html#v:timeout" title="System.Timeout">timeout</a></code> to interrupt a timed-out
 computation.</p><p><em>Since: base-4.0</em></p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Timeout">Instances</h4><details id="i:Timeout" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Timeout:Exception:1"></span> <a href="Control-Exception.html#t:Exception" title="Control.Exception">Exception</a> <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a></span> <a href="src/System.Timeout.html#line-54" class="link">Source</a> <a href="#t:Timeout" class="selflink">#</a></td><td class="doc"><p><em>Since: base-4.7.0.0</em></p></td></tr><tr><td colspan="2"><details id="i:id:Timeout:Exception:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Timeout.html">System.Timeout</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toException">toException</a> :: <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="Control-Exception.html#t:SomeException" title="Control.Exception">SomeException</a> <a href="../ghc-internal-9.1202.0-1465/src/GHC.Internal.Exception.Type.html#toException" class="link">Source</a> <a href="#v:toException" class="selflink">#</a></p><p class="src"><a href="#v:fromException">fromException</a> :: <a href="Control-Exception.html#t:SomeException" title="Control.Exception">SomeException</a> -&gt; <a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> <a href="../ghc-internal-9.1202.0-1465/src/GHC.Internal.Exception.Type.html#fromException" class="link">Source</a> <a href="#v:fromException" class="selflink">#</a></p><p class="src"><a href="#v:displayException">displayException</a> :: <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="Data-String.html#t:String" title="Data.String">String</a> <a href="../ghc-internal-9.1202.0-1465/src/GHC.Internal.Exception.Type.html#displayException" class="link">Source</a> <a href="#v:displayException" class="selflink">#</a></p><p class="src"><a href="#v:backtraceDesired">backtraceDesired</a> :: <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-internal-9.1202.0-1465/src/GHC.Internal.Exception.Type.html#backtraceDesired" class="link">Source</a> <a href="#v:backtraceDesired" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Timeout:Show:2"></span> <a href="Prelude.html#t:Show" title="Prelude">Show</a> <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a></span> <a href="src/System.Timeout.html#line-49" class="link">Source</a> <a href="#t:Timeout" class="selflink">#</a></td><td class="doc"><p><em>Since: base-4.0</em></p></td></tr><tr><td colspan="2"><details id="i:id:Timeout:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Timeout.html">System.Timeout</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="Prelude.html#t:ShowS" title="Prelude">ShowS</a> <a href="../ghc-internal-9.1202.0-1465/src/GHC.Internal.Show.html#showsPrec" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="Data-String.html#t:String" title="Data.String">String</a> <a href="../ghc-internal-9.1202.0-1465/src/GHC.Internal.Show.html#show" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a>] -&gt; <a href="Prelude.html#t:ShowS" title="Prelude">ShowS</a> <a href="../ghc-internal-9.1202.0-1465/src/GHC.Internal.Show.html#showList" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Timeout:Eq:3"></span> <a href="Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a></span> <a href="src/System.Timeout.html#line-46" class="link">Source</a> <a href="#t:Timeout" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Timeout:Eq:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Timeout.html">System.Timeout</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%3D%3D" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a> -&gt; <a href="Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../ghc-prim-0.13.0-e168/src/GHC.Classes.html#%2F%3D" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:timeout" class="def">timeout</a> :: <a href="Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Prelude.html#t:IO" title="Prelude">IO</a> a -&gt; <a href="Prelude.html#t:IO" title="Prelude">IO</a> (<a href="Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> a) <a href="src/System.Timeout.html#timeout" class="link">Source</a> <a href="#v:timeout" class="selflink">#</a></p><div class="doc"><p>Wrap an <code><a href="Prelude.html#t:IO" title="Prelude">IO</a></code> computation to time out and return <code class="inline-code">Nothing</code> in case no result
 is available within <code class="inline-code">n</code> microseconds (<code class="inline-code">1/10^6</code> seconds). In case a result
 is available before the timeout expires, <code class="inline-code">Just a</code> is returned. A negative
 timeout interval means &quot;wait indefinitely&quot;. When specifying long timeouts,
 be careful not to exceed <code class="inline-code">maxBound :: Int</code>, which on 32-bit machines is only
 2147483647 &#956;s, less than 36 minutes.
 Consider using <code class="inline-code">Control.Concurrent.Timeout.timeout</code> from <code class="inline-code">unbounded-delays</code> package.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>timeout 1000000 (threadDelay 1000 *&gt; pure &quot;finished on time&quot;)
</code></strong>Just &quot;finished on time&quot;
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>timeout 10000 (threadDelay 100000 *&gt; pure &quot;finished on time&quot;)
</code></strong>Nothing
</pre><p>The design of this combinator was guided by the objective that <code class="inline-code">timeout n f</code>
 should behave exactly the same as <code class="inline-code">f</code> as long as <code class="inline-code">f</code> doesn't time out. This
 means that <code class="inline-code">f</code> has the same <code><a href="Control-Concurrent.html#v:myThreadId" title="Control.Concurrent">myThreadId</a></code> it would have without the timeout
 wrapper. Any exceptions <code class="inline-code">f</code> might throw cancel the timeout and propagate
 further up. It also possible for <code class="inline-code">f</code> to receive exceptions thrown to it by
 another thread.</p><p>A tricky implementation detail is the question of how to abort an <code class="inline-code">IO</code>
 computation. This combinator relies on asynchronous exceptions internally
 (namely throwing the computation the <code><a href="System-Timeout.html#t:Timeout" title="System.Timeout">Timeout</a></code> exception).  The technique
 works very well for computations executing inside of the Haskell runtime
 system, but it doesn't work at all for non-Haskell code.  Foreign function
 calls, for example, cannot be timed out with this combinator simply because
 an arbitrary C function cannot receive asynchronous exceptions. When
 <code class="inline-code">timeout</code> is used to wrap an FFI call that blocks, no timeout event can be
 delivered until the FFI call returns, which pretty much negates the purpose
 of the combinator. In practice, however, this limitation is less severe than
 it may sound. Standard I/O functions like <code><a href="../ghc-internal-9.1202.0-1465/GHC-Internal-System-IO.html#v:hGetBuf" title="GHC.Internal.System.IO">hGetBuf</a></code>,
 <code><a href="../ghc-internal-9.1202.0-1465/GHC-Internal-System-IO.html#v:hPutBuf" title="GHC.Internal.System.IO">hPutBuf</a></code>, Network.Socket.accept, or <code><a href="../ghc-internal-9.1202.0-1465/GHC-Internal-System-IO.html#v:hWaitForInput" title="GHC.Internal.System.IO">hWaitForInput</a></code>
 appear to be blocking, but they really don't because the runtime system uses
 scheduling mechanisms like <code class="inline-code">select(2)</code> to perform asynchronous I/O, so it
 is possible to interrupt standard socket I/O or file I/O using this
 combinator.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.30.0</p></div></body></html>