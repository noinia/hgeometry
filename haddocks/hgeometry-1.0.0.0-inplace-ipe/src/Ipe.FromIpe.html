<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  Ipe.FromIpe</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Functions that help reading geometric values from ipe images.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Ipe.FromIpe</span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Individual readers</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Ipe.FromIpe.html#_asPoint"><span class="hs-identifier">_asPoint</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#_asLineSegment"><span class="hs-identifier">_asLineSegment</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#_asClosedLineSegment"><span class="hs-identifier">_asClosedLineSegment</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#_asRectangle"><span class="hs-identifier">_asRectangle</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#_asTriangle"><span class="hs-identifier">_asTriangle</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#_asPolyLine"><span class="hs-identifier">_asPolyLine</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#_asSimplePolygon"><span class="hs-identifier">_asSimplePolygon</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#_asConvexPolygon"><span class="hs-identifier">_asConvexPolygon</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-comment">-- , _asSomePolygon, _asSimplePolygon, _asMultiPolygon</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Dealing with Attributes</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier">_withAttrs</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Default readers</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier">HasDefaultFromIpe</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Reading all elements of a particular type</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#readAll"><span class="hs-identifier">readAll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#readAllFrom"><span class="hs-identifier">readAllFrom</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Simple"><span class="hs-identifier">Simple</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ball.html"><span class="hs-identifier">HGeometry.Ball</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.html"><span class="hs-identifier">HGeometry.Box</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.html"><span class="hs-identifier">HGeometry.Box</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Box</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ellipse.html"><span class="hs-identifier">HGeometry.Ellipse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ellipse.html#Ellipse"><span class="hs-identifier">Ellipse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ellipse.html#_EllipseCircle"><span class="hs-identifier">_EllipseCircle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.LineSegment.html"><span class="hs-identifier">HGeometry.LineSegment</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Number.Radical.html"><span class="hs-identifier">HGeometry.Number.Radical</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html"><span class="hs-identifier">HGeometry.Point</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.PolyLine.html"><span class="hs-identifier">HGeometry.PolyLine</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PolyLine</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Class.html"><span class="hs-identifier">HGeometry.Polygon.Class</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Convex.html"><span class="hs-identifier">HGeometry.Polygon.Convex</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.html"><span class="hs-identifier">HGeometry.Polygon.Simple</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html"><span class="hs-identifier">HGeometry.Properties</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Triangle.html"><span class="hs-identifier">HGeometry.Triangle</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ipe.Path.html"><span class="hs-identifier">Ipe.Path</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ipe.Reader.html"><span class="hs-identifier">Ipe.Reader</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Ipe.Types.html"><span class="hs-identifier">Ipe.Types</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.OsPath</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- import qualified Data.List.NonEmpty as NonEmpty</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- import Ipe.Attributes</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- import Ipe.Color(IpeColor(..))</span><span>
</span><span id="line-64"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- &gt;&gt;&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- &gt;&gt;&gt; import Ipe.Attributes</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- &gt;&gt;&gt; import Ipe.Color(IpeColor(..))</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- &gt;&gt;&gt; import qualified Data.List.NonEmpty as NonEmpty</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- &gt;&gt;&gt; :{</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- let testPath :: Path Int</span><span>
</span><span id="line-72"></span><span class="hs-comment">--     testPath = Path . fromSingleton  . PolyLineSegment</span><span>
</span><span id="line-73"></span><span class="hs-comment">--              . PolyLine.polyLineFromPoints . NonEmpty.fromList</span><span>
</span><span id="line-74"></span><span class="hs-comment">--              $ [ origin, Point2 10 10, Point2 200 100 ]</span><span>
</span><span id="line-75"></span><span class="hs-comment">--     testPathAttrs :: IpeAttributes Path Int</span><span>
</span><span id="line-76"></span><span class="hs-comment">--     testPathAttrs = attr SStroke (IpeColor &quot;red&quot;)</span><span>
</span><span id="line-77"></span><span class="hs-comment">--     testObject :: IpeObject Int</span><span>
</span><span id="line-78"></span><span class="hs-comment">--     testObject = IpePath (testPath :+ testPathAttrs)</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- :}</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- testPath :: Path Int</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- testPath = Path . fromSingleton  . PolyLineSegment</span><span>
</span><span id="line-83"></span><span class="hs-comment">--              . PolyLine.polyLineFromPoints . NonEmpty.fromList</span><span>
</span><span id="line-84"></span><span class="hs-comment">--              $ [ origin, Point2 10 10, Point2 200 100 ]</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- testPathAttrs :: IpeAttributes Path Int</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- testPathAttrs = attr SStroke (IpeColor &quot;red&quot;)</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- testObject :: IpeObject Int</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- testObject = IpePath (testPath :+ testPathAttrs)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Extracts the point from a Symbol. When creating a symbol this</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- creates a disk that supports a stroke color.</span><span>
</span><span id="line-94"></span><span id="local-6989586621679397731"><span class="annot"><a href="Ipe.FromIpe.html#_asPoint"><span class="hs-identifier hs-type">_asPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Content.html#IpeSymbol"><span class="hs-identifier hs-type">IpeSymbol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397731"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397731"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-95"></span><span id="_asPoint"><span class="annot"><span class="annottext">_asPoint :: forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (Point 2 r) (f (Point 2 r)) -&gt; p (IpeSymbol r) (f (IpeSymbol r))
</span><a href="Ipe.FromIpe.html#_asPoint"><span class="hs-identifier hs-var hs-var">_asPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; IpeSymbol r)
-&gt; (IpeSymbol r -&gt; Maybe (Point 2 r))
-&gt; Prism (IpeSymbol r) (IpeSymbol r) (Point 2 r) (Point 2 r)
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Prism.html#prism%27"><span class="hs-identifier hs-var">prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; Text -&gt; IpeSymbol r)
-&gt; Text -&gt; Point 2 r -&gt; IpeSymbol r
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Text -&gt; IpeSymbol r
forall r. Point 2 r -&gt; Text -&gt; IpeSymbol r
</span><a href="Ipe.Content.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;mark/disk(sx)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Maybe (Point 2 r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Maybe (Point 2 r))
-&gt; (IpeSymbol r -&gt; Point 2 r) -&gt; IpeSymbol r -&gt; Maybe (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) (IpeSymbol r) (Point 2 r)
-&gt; IpeSymbol r -&gt; Point 2 r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) (IpeSymbol r) (Point 2 r)
forall r1 r2 (f :: * -&gt; *).
Functor f =&gt;
(Point 2 r1 -&gt; f (Point 2 r2)) -&gt; IpeSymbol r1 -&gt; f (IpeSymbol r2)
</span><a href="Ipe.Content.html#symbolPoint"><span class="hs-identifier hs-var">symbolPoint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | Try to convert a path into a line segment, fails if the path is not a line</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- segment or a polyline with more than two points.</span><span>
</span><span id="line-99"></span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span id="local-6989586621679397762"><span class="annot"><a href="Ipe.FromIpe.html#_asLineSegment"><span class="hs-identifier hs-type">_asLineSegment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397762"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Interval.EndPoint.html#AnEndPoint"><span class="hs-identifier hs-type">AnEndPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397762"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-102"></span><span id="_asLineSegment"><span class="annot"><span class="annottext">_asLineSegment :: forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (LineSegment AnEndPoint (Point 2 r))
  (f (LineSegment AnEndPoint (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asLineSegment"><span class="hs-identifier hs-var hs-var">_asLineSegment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asPolyLine"><span class="hs-identifier hs-var">_asPolyLine</span></a></span><span class="annot"><span class="annottext">(p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
 -&gt; p (Path r) (f (Path r)))
-&gt; (p (LineSegment AnEndPoint (Point 2 r))
      (f (LineSegment AnEndPoint (Point 2 r)))
    -&gt; p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r))))
-&gt; p (LineSegment AnEndPoint (Point 2 r))
     (f (LineSegment AnEndPoint (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">p (LineSegment AnEndPoint (Point 2 r))
  (f (LineSegment AnEndPoint (Point 2 r)))
-&gt; p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
forall lineSegment point polyLine.
(LineSegment_ lineSegment point, PolyLine_ polyLine point) =&gt;
Prism' polyLine lineSegment
Prism' (PolyLine (Point 2 r)) (LineSegment AnEndPoint (Point 2 r))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.PolyLine.Class.html#_PolyLineLineSegment"><span class="hs-identifier hs-var">PolyLine._PolyLineLineSegment</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Try to convert a path into a line segment, fails if the path is not a line</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- segment or a polyline with more than two points.</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span id="local-6989586621679397814"><span class="annot"><a href="Ipe.FromIpe.html#_asClosedLineSegment"><span class="hs-identifier hs-type">_asClosedLineSegment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397814"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.LineSegment.Internal.html#ClosedLineSegment"><span class="hs-identifier hs-type">ClosedLineSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397814"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-109"></span><span id="_asClosedLineSegment"><span class="annot"><span class="annottext">_asClosedLineSegment :: forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (ClosedLineSegment (Point 2 r))
  (f (ClosedLineSegment (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asClosedLineSegment"><span class="hs-identifier hs-var hs-var">_asClosedLineSegment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asPolyLine"><span class="hs-identifier hs-var">_asPolyLine</span></a></span><span class="annot"><span class="annottext">(p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
 -&gt; p (Path r) (f (Path r)))
-&gt; (p (ClosedLineSegment (Point 2 r))
      (f (ClosedLineSegment (Point 2 r)))
    -&gt; p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r))))
-&gt; p (ClosedLineSegment (Point 2 r))
     (f (ClosedLineSegment (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">p (ClosedLineSegment (Point 2 r))
  (f (ClosedLineSegment (Point 2 r)))
-&gt; p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
forall lineSegment point polyLine.
(LineSegment_ lineSegment point, PolyLine_ polyLine point) =&gt;
Prism' polyLine lineSegment
Prism' (PolyLine (Point 2 r)) (ClosedLineSegment (Point 2 r))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.PolyLine.Class.html#_PolyLineLineSegment"><span class="hs-identifier hs-var">PolyLine._PolyLineLineSegment</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Convert to a polyline. Ignores all non-polyline parts</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt;&gt;&gt; testPath ^? _asPolyLine</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- Just (PolyLine [Point2 0 0,Point2 10 10,Point2 200 100])</span><span>
</span><span id="line-115"></span><span id="local-6989586621679397809"><span class="annot"><a href="Ipe.FromIpe.html#_asPolyLine"><span class="hs-identifier hs-type">_asPolyLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397809"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.PolyLine.html#PolyLine"><span class="hs-identifier hs-type">PolyLine.PolyLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397809"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-116"></span><span id="_asPolyLine"><span class="annot"><span class="annottext">_asPolyLine :: forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asPolyLine"><span class="hs-identifier hs-var hs-var">_asPolyLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PolyLine (Point 2 r) -&gt; Path r)
-&gt; (Path r -&gt; Maybe (PolyLine (Point 2 r)))
-&gt; Prism
     (Path r) (Path r) (PolyLine (Point 2 r)) (PolyLine (Point 2 r))
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Prism.html#prism%27"><span class="hs-identifier hs-var">prism'</span></a></span><span> </span><span class="annot"><span class="annottext">PolyLine (Point 2 r) -&gt; Path r
forall {r}. PolyLine (Point 2 r) -&gt; Path r
</span><a href="#local-6989586621679398331"><span class="hs-identifier hs-var">poly2path</span></a></span><span> </span><span class="annot"><span class="annottext">Path r -&gt; Maybe (PolyLine (Point 2 r))
</span><a href="#local-6989586621679398332"><span class="hs-identifier hs-var">path2poly</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679398331"><span class="annot"><span class="annottext">poly2path :: PolyLine (Point 2 r) -&gt; Path r
</span><a href="#local-6989586621679398331"><span class="hs-identifier hs-var hs-var">poly2path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (PathSegment r) -&gt; Path r
forall r. Seq (PathSegment r) -&gt; Path r
</span><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (PathSegment r) -&gt; Path r)
-&gt; (PolyLine (Point 2 r) -&gt; Seq (PathSegment r))
-&gt; PolyLine (Point 2 r)
-&gt; Path r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PathSegment r -&gt; Seq (PathSegment r)
forall a. a -&gt; Seq a
</span><a href="Ipe.FromIpe.html#fromSingleton"><span class="hs-identifier hs-var">fromSingleton</span></a></span><span>  </span><span class="annot"><span class="annottext">(PathSegment r -&gt; Seq (PathSegment r))
-&gt; (PolyLine (Point 2 r) -&gt; PathSegment r)
-&gt; PolyLine (Point 2 r)
-&gt; Seq (PathSegment r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PolyLine (Point 2 r) -&gt; PathSegment r
forall r. PolyLine (Point 2 r) -&gt; PathSegment r
</span><a href="Ipe.Path.html#PolyLineSegment"><span class="hs-identifier hs-var">PolyLineSegment</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679398332"><span class="annot"><span class="annottext">path2poly :: Path r -&gt; Maybe (PolyLine (Point 2 r))
</span><a href="#local-6989586621679398332"><span class="hs-identifier hs-var hs-var">path2poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting
  (First (PolyLine (Point 2 r))) (Path r) (PolyLine (Point 2 r))
-&gt; Path r -&gt; Maybe (PolyLine (Point 2 r))
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#preview"><span class="hs-identifier hs-var">preview</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Seq (PathSegment r)
 -&gt; Const (First (PolyLine (Point 2 r))) (Seq (PathSegment r)))
-&gt; Path r -&gt; Const (First (PolyLine (Point 2 r))) (Path r)
forall r1 r2 (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Seq (PathSegment r1)) (f (Seq (PathSegment r2)))
-&gt; p (Path r1) (f (Path r2))
</span><a href="Ipe.Path.html#pathSegments"><span class="hs-identifier hs-var">pathSegments</span></a></span><span class="annot"><span class="annottext">((Seq (PathSegment r)
  -&gt; Const (First (PolyLine (Point 2 r))) (Seq (PathSegment r)))
 -&gt; Path r -&gt; Const (First (PolyLine (Point 2 r))) (Path r))
-&gt; ((PolyLine (Point 2 r)
     -&gt; Const (First (PolyLine (Point 2 r))) (PolyLine (Point 2 r)))
    -&gt; Seq (PathSegment r)
    -&gt; Const (First (PolyLine (Point 2 r))) (Seq (PathSegment r)))
-&gt; Getting
     (First (PolyLine (Point 2 r))) (Path r) (PolyLine (Point 2 r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(PathSegment r
 -&gt; Const (First (PolyLine (Point 2 r))) (PathSegment r))
-&gt; Seq (PathSegment r)
-&gt; Const (First (PolyLine (Point 2 r))) (Seq (PathSegment r))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((PathSegment r
  -&gt; Const (First (PolyLine (Point 2 r))) (PathSegment r))
 -&gt; Seq (PathSegment r)
 -&gt; Const (First (PolyLine (Point 2 r))) (Seq (PathSegment r)))
-&gt; ((PolyLine (Point 2 r)
     -&gt; Const (First (PolyLine (Point 2 r))) (PolyLine (Point 2 r)))
    -&gt; PathSegment r
    -&gt; Const (First (PolyLine (Point 2 r))) (PathSegment r))
-&gt; (PolyLine (Point 2 r)
    -&gt; Const (First (PolyLine (Point 2 r))) (PolyLine (Point 2 r)))
-&gt; Seq (PathSegment r)
-&gt; Const (First (PolyLine (Point 2 r))) (Seq (PathSegment r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(PolyLine (Point 2 r)
 -&gt; Const (First (PolyLine (Point 2 r))) (PolyLine (Point 2 r)))
-&gt; PathSegment r
-&gt; Const (First (PolyLine (Point 2 r))) (PathSegment r)
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (PathSegment r) (f (PathSegment r))
</span><a href="Ipe.Path.html#_PolyLineSegment"><span class="hs-identifier hs-var">_PolyLineSegment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">-- TODO: Check that the path actually is a polyline, rather</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">-- than ignoring everything that does not fit</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">-- | Convert to a simple polygon</span></span><span>
</span><span id="line-124"></span><span id="local-6989586621679397852"><span class="annot"><a href="Ipe.FromIpe.html#_asSimplePolygon"><span class="hs-identifier hs-type">_asSimplePolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397852"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397852"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-125"></span><span id="_asSimplePolygon"><span class="annot"><span class="annottext">_asSimplePolygon :: forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asSimplePolygon"><span class="hs-identifier hs-var hs-var">_asSimplePolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SimplePolygon (Point 2 r) -&gt; Path r)
-&gt; (Path r -&gt; Maybe (SimplePolygon (Point 2 r)))
-&gt; Prism
     (Path r)
     (Path r)
     (SimplePolygon (Point 2 r))
     (SimplePolygon (Point 2 r))
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Prism.html#prism%27"><span class="hs-identifier hs-var">prism'</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Point 2 r) -&gt; Path r
forall r. SimplePolygon (Point 2 r) -&gt; Path r
</span><a href="Ipe.FromIpe.html#polygonToPath"><span class="hs-identifier hs-var">polygonToPath</span></a></span><span> </span><span class="annot"><span class="annottext">Path r -&gt; Maybe (SimplePolygon (Point 2 r))
forall r. Path r -&gt; Maybe (SimplePolygon (Point 2 r))
</span><a href="Ipe.FromIpe.html#pathToPolygon"><span class="hs-identifier hs-var">pathToPolygon</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><span class="hs-comment">-- | Convert to a convex polygon</span></span><span>
</span><span id="line-128"></span><span id="local-6989586621679397859"><span class="annot"><a href="Ipe.FromIpe.html#_asConvexPolygon"><span class="hs-identifier hs-type">_asConvexPolygon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679397859"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679397859"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397859"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Convex.Implementation.html#ConvexPolygon"><span class="hs-identifier hs-type">ConvexPolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397859"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-129"></span><span id="_asConvexPolygon"><span class="annot"><span class="annottext">_asConvexPolygon :: forall r.
(Num r, Ord r) =&gt;
Prism' (Path r) (ConvexPolygon (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asConvexPolygon"><span class="hs-identifier hs-var hs-var">_asConvexPolygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asSimplePolygon"><span class="hs-identifier hs-var">_asSimplePolygon</span></a></span><span class="annot"><span class="annottext">(p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
 -&gt; p (Path r) (f (Path r)))
-&gt; (p (ConvexPolygon (Point 2 r)) (f (ConvexPolygon (Point 2 r)))
    -&gt; p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r))))
-&gt; p (ConvexPolygon (Point 2 r)) (f (ConvexPolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">p (ConvexPolygon (Point 2 r)) (f (ConvexPolygon (Point 2 r)))
-&gt; p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
forall (f :: * -&gt; *) point r.
(Num r, Ord r, Point_ point 2 r, VertexContainer f point) =&gt;
Prism' (SimplePolygonF f point) (ConvexPolygonF f point)
Prism' (SimplePolygon (Point 2 r)) (ConvexPolygon (Point 2 r))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Convex.Implementation.html#_ConvexPolygon"><span class="hs-identifier hs-var">_ConvexPolygon</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><span class="hs-comment">-- | Tries to convert a path into a rectangle.</span></span><span>
</span><span id="line-132"></span><span class="annot"><a href="Ipe.FromIpe.html#_asRectangle"><span class="hs-identifier hs-type">_asRectangle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679397883"><span class="annot"><a href="#local-6989586621679397883"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679397883"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679397883"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397883"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397883"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span id="_asRectangle"><span class="annot"><span class="annottext">_asRectangle :: forall r. (Num r, Ord r) =&gt; Prism' (Path r) (Rectangle (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asRectangle"><span class="hs-identifier hs-var hs-var">_asRectangle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rectangle (Point 2 r) -&gt; Path r)
-&gt; (Path r -&gt; Maybe (Rectangle (Point 2 r)))
-&gt; Prism
     (Path r) (Path r) (Rectangle (Point 2 r)) (Rectangle (Point 2 r))
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Prism.html#prism%27"><span class="hs-identifier hs-var">prism'</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle (Point 2 r) -&gt; Path r
Rectangle (Point 2 r) -&gt; Path (NumType (Rectangle (Point 2 r)))
forall {rectangle}.
(Dimension rectangle ~ 2,
 Box_ rectangle (PointF (Vector 2 (NumType rectangle))),
 Num (NumType rectangle)) =&gt;
rectangle -&gt; Path (NumType rectangle)
</span><a href="#local-6989586621679398642"><span class="hs-identifier hs-var">rectToPath</span></a></span><span> </span><span class="annot"><span class="annottext">Path r -&gt; Maybe (Rectangle (Point 2 r))
</span><a href="#local-6989586621679398643"><span class="hs-identifier hs-var">pathToRect</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679398642"><span class="annot"><span class="annottext">rectToPath :: rectangle -&gt; Path (NumType rectangle)
</span><a href="#local-6989586621679398642"><span class="hs-identifier hs-var hs-var">rectToPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">rectangle -&gt; Corners (PointF (Vector 2 (NumType rectangle)))
forall r rectangle point.
(Num r, Rectangle_ rectangle point, Point_ point 2 r) =&gt;
rectangle -&gt; Corners point
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Corners.html#corners"><span class="hs-identifier hs-var">Box.corners</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Corners.html#Corners"><span class="hs-identifier hs-type">Corners</span></a></span><span> </span><span id="local-6989586621679398924"><span class="annot"><span class="annottext">PointF (Vector 2 (NumType rectangle))
</span><a href="#local-6989586621679398924"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679398925"><span class="annot"><span class="annottext">PointF (Vector 2 (NumType rectangle))
</span><a href="#local-6989586621679398925"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679398926"><span class="annot"><span class="annottext">PointF (Vector 2 (NumType rectangle))
</span><a href="#local-6989586621679398926"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679398927"><span class="annot"><span class="annottext">PointF (Vector 2 (NumType rectangle))
</span><a href="#local-6989586621679398927"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>      </span><span class="annot"><span class="annottext">AReview
  (Path (NumType rectangle))
  (SimplePolygon (PointF (Vector 2 (NumType rectangle))))
-&gt; SimplePolygon (PointF (Vector 2 (NumType rectangle)))
-&gt; Path (NumType rectangle)
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Review.html#review"><span class="hs-identifier hs-var">review</span></a></span><span> </span><span class="annot"><span class="annottext">AReview
  (Path (NumType rectangle))
  (SimplePolygon (PointF (Vector 2 (NumType rectangle))))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asSimplePolygon"><span class="hs-identifier hs-var">_asSimplePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(SimplePolygon (PointF (Vector 2 (NumType rectangle)))
 -&gt; Path (NumType rectangle))
-&gt; ([PointF (Vector 2 (NumType rectangle))]
    -&gt; SimplePolygon (PointF (Vector 2 (NumType rectangle))))
-&gt; [PointF (Vector 2 (NumType rectangle))]
-&gt; Path (NumType rectangle)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[PointF (Vector 2 (NumType rectangle))]
-&gt; SimplePolygon (PointF (Vector 2 (NumType rectangle)))
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable f) =&gt;
f point -&gt; simplePolygon
forall (f :: * -&gt; *).
Foldable f =&gt;
f (PointF (Vector 2 (NumType rectangle)))
-&gt; SimplePolygon (PointF (Vector 2 (NumType rectangle)))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.Class.html#uncheckedFromCCWPoints"><span class="hs-identifier hs-var">uncheckedFromCCWPoints</span></a></span><span> </span><span class="annot"><span class="annottext">([PointF (Vector 2 (NumType rectangle))]
 -&gt; Path (NumType rectangle))
-&gt; [PointF (Vector 2 (NumType rectangle))]
-&gt; Path (NumType rectangle)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PointF (Vector 2 (NumType rectangle))
</span><a href="#local-6989586621679398924"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PointF (Vector 2 (NumType rectangle))
</span><a href="#local-6989586621679398925"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PointF (Vector 2 (NumType rectangle))
</span><a href="#local-6989586621679398926"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PointF (Vector 2 (NumType rectangle))
</span><a href="#local-6989586621679398927"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679398643"><span class="annot"><span class="annottext">pathToRect :: Path r -&gt; Maybe (Rectangle (Point 2 r))
</span><a href="#local-6989586621679398643"><span class="hs-identifier hs-var hs-var">pathToRect</span></a></span></span><span> </span><span id="local-6989586621679398930"><span class="annot"><span class="annottext">Path r
</span><a href="#local-6989586621679398930"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path r
</span><a href="#local-6989586621679398930"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Path r
-&gt; Getting
     (First (SimplePolygon (Point 2 r)))
     (Path r)
     (SimplePolygon (Point 2 r))
-&gt; Maybe (SimplePolygon (Point 2 r))
forall s a. s -&gt; Getting (First a) s a -&gt; Maybe a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#%5E%3F"><span class="hs-operator hs-var">^?</span></a></span><span class="annot"><span class="annottext">Getting
  (First (SimplePolygon (Point 2 r)))
  (Path r)
  (SimplePolygon (Point 2 r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asSimplePolygon"><span class="hs-identifier hs-var">_asSimplePolygon</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SimplePolygon (Point 2 r))
-&gt; (SimplePolygon (Point 2 r) -&gt; Maybe (Rectangle (Point 2 r)))
-&gt; Maybe (Rectangle (Point 2 r))
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Point 2 r) -&gt; Maybe (Rectangle (Point 2 r))
</span><a href="#local-6989586621679398932"><span class="hs-identifier hs-var">asRect</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="#local-6989586621679398932"><span class="hs-identifier hs-type">asRect</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>  </span><span class="annot"><a href="#local-6989586621679397883"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397883"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679398932"><span class="annot"><span class="annottext">asRect :: SimplePolygon (Point 2 r) -&gt; Maybe (Rectangle (Point 2 r))
</span><a href="#local-6989586621679398932"><span class="hs-identifier hs-var hs-var">asRect</span></a></span></span><span> </span><span id="local-6989586621679398933"><span class="annot"><span class="annottext">SimplePolygon (Point 2 r)
</span><a href="#local-6989586621679398933"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Point 2 r)
</span><a href="#local-6989586621679398933"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">SimplePolygon (Point 2 r)
-&gt; Getting
     (Endo [Point 2 r]) (SimplePolygon (Point 2 r)) (Point 2 r)
-&gt; [Point 2 r]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">(Vertex (SimplePolygon (Point 2 r))
 -&gt; Const (Endo [Point 2 r]) (Vertex (SimplePolygon (Point 2 r))))
-&gt; SimplePolygon (Point 2 r)
-&gt; Const (Endo [Point 2 r]) (SimplePolygon (Point 2 r))
Getting (Endo [Point 2 r]) (SimplePolygon (Point 2 r)) (Point 2 r)
forall polygon.
HasOuterBoundary polygon =&gt;
IndexedTraversal1' (VertexIx polygon) polygon (Vertex polygon)
IndexedTraversal1'
  (VertexIx (SimplePolygon (Point 2 r)))
  (SimplePolygon (Point 2 r))
  (Vertex (SimplePolygon (Point 2 r)))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Class.html#outerBoundary"><span class="hs-identifier hs-var">outerBoundary</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679398936"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679398937"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679398938"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398938"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679398939"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398939"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall {s} {s}.
(NumType s ~ NumType s,
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Eq (NumType s), Point_ s (Dimension s) (NumType s),
 Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398940"><span class="hs-identifier hs-var">isH</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall {s} {s}.
(NumType s ~ NumType s,
 Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Eq (NumType s), Point_ s (Dimension s) (NumType s),
 Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398942"><span class="hs-identifier hs-var">isV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398938"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall {s} {s}.
(NumType s ~ NumType s,
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Eq (NumType s), Point_ s (Dimension s) (NumType s),
 Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398940"><span class="hs-identifier hs-var">isH</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398938"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398939"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall {s} {s}.
(NumType s ~ NumType s,
 Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Eq (NumType s), Point_ s (Dimension s) (NumType s),
 Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398942"><span class="hs-identifier hs-var">isV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398939"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Point 2 r -&gt; Getting r (Point 2 r) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r (Point 2 r) r
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 r) r
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#xCoord"><span class="hs-identifier hs-var">xCoord</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Point 2 r -&gt; Getting r (Point 2 r) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r (Point 2 r) r
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 r) r
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#xCoord"><span class="hs-identifier hs-var">xCoord</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Rectangle (Point 2 r) -&gt; Maybe (Rectangle (Point 2 r))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Rectangle (Point 2 r)
forall point. (Dimension point ~ 2) =&gt; point -&gt; point -&gt; Box point
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-var">Rectangle</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398938"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>                                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Rectangle (Point 2 r) -&gt; Maybe (Rectangle (Point 2 r))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Rectangle (Point 2 r)
forall point. (Dimension point ~ 2) =&gt; point -&gt; point -&gt; Box point
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-var">Rectangle</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398938"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall {s} {s}.
(NumType s ~ NumType s,
 Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Eq (NumType s), Point_ s (Dimension s) (NumType s),
 Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398942"><span class="hs-identifier hs-var">isV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall {s} {s}.
(NumType s ~ NumType s,
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Eq (NumType s), Point_ s (Dimension s) (NumType s),
 Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398940"><span class="hs-identifier hs-var">isH</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398938"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall {s} {s}.
(NumType s ~ NumType s,
 Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Eq (NumType s), Point_ s (Dimension s) (NumType s),
 Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398942"><span class="hs-identifier hs-var">isV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398938"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398939"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall {s} {s}.
(NumType s ~ NumType s,
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Eq (NumType s), Point_ s (Dimension s) (NumType s),
 Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398940"><span class="hs-identifier hs-var">isH</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398939"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398936"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Point 2 r -&gt; Getting r (Point 2 r) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r (Point 2 r) r
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 r) r
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#yCoord"><span class="hs-identifier hs-var">yCoord</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Point 2 r -&gt; Getting r (Point 2 r) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r (Point 2 r) r
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 r) r
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#yCoord"><span class="hs-identifier hs-var">yCoord</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Rectangle (Point 2 r) -&gt; Maybe (Rectangle (Point 2 r))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Rectangle (Point 2 r)
forall point. (Dimension point ~ 2) =&gt; point -&gt; point -&gt; Box point
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-var">Rectangle</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398939"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>                                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Rectangle (Point 2 r) -&gt; Maybe (Rectangle (Point 2 r))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Rectangle (Point 2 r)
forall point. (Dimension point ~ 2) =&gt; point -&gt; point -&gt; Box point
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-var">Rectangle</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398937"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679398939"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">[Point 2 r]
</span><span class="hs-identifier">_</span></span><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Rectangle (Point 2 r))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679398940"><span class="annot"><span class="annottext">isH :: s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398940"><span class="hs-identifier hs-var hs-var">isH</span></a></span></span><span> </span><span id="local-6989586621679399067"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679399067"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679399068"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679399068"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679399067"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (NumType s) s (NumType s) -&gt; NumType s
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType s) s (NumType s)
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int s (NumType s)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#yCoord"><span class="hs-identifier hs-var">yCoord</span></a></span><span> </span><span class="annot"><span class="annottext">NumType s -&gt; NumType s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679399068"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (NumType s) s (NumType s) -&gt; NumType s
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType s) s (NumType s)
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int s (NumType s)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#yCoord"><span class="hs-identifier hs-var">yCoord</span></a></span><span> </span><span class="hs-comment">-- edge pq is horizontal</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679398942"><span class="annot"><span class="annottext">isV :: s -&gt; s -&gt; Bool
</span><a href="#local-6989586621679398942"><span class="hs-identifier hs-var hs-var">isV</span></a></span></span><span> </span><span id="local-6989586621679399181"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679399181"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679399182"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679399182"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679399181"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (NumType s) s (NumType s) -&gt; NumType s
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType s) s (NumType s)
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int s (NumType s)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#xCoord"><span class="hs-identifier hs-var">xCoord</span></a></span><span> </span><span class="annot"><span class="annottext">NumType s -&gt; NumType s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679399182"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (NumType s) s (NumType s) -&gt; NumType s
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType s) s (NumType s)
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int s (NumType s)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.Class.html#xCoord"><span class="hs-identifier hs-var">xCoord</span></a></span><span> </span><span class="hs-comment">-- edge pq is vertical</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">-- | Convert to a triangle</span></span><span>
</span><span id="line-157"></span><span id="local-6989586621679398003"><span class="annot"><a href="Ipe.FromIpe.html#_asTriangle"><span class="hs-identifier hs-type">_asTriangle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398003"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Triangle.html#Triangle"><span class="hs-identifier hs-type">Triangle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398003"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-158"></span><span id="_asTriangle"><span class="annot"><span class="annottext">_asTriangle :: forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (Triangle (Point 2 r)) (f (Triangle (Point 2 r)))
-&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asTriangle"><span class="hs-identifier hs-var hs-var">_asTriangle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Triangle (Point 2 r) -&gt; Path r)
-&gt; (Path r -&gt; Maybe (Triangle (Point 2 r)))
-&gt; Prism
     (Path r) (Path r) (Triangle (Point 2 r)) (Triangle (Point 2 r))
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Prism.html#prism%27"><span class="hs-identifier hs-var">prism'</span></a></span><span> </span><span class="annot"><span class="annottext">Triangle (Point 2 r) -&gt; Path r
forall {r}. Triangle (PointF (Vector 2 r)) -&gt; Path r
</span><a href="#local-6989586621679399187"><span class="hs-identifier hs-var">triToPath</span></a></span><span> </span><span class="annot"><span class="annottext">Path r -&gt; Maybe (Triangle (Point 2 r))
forall {r2}. Path r2 -&gt; Maybe (Triangle (PointF (Vector 2 r2)))
</span><a href="#local-6989586621679399188"><span class="hs-identifier hs-var">path2tri</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>    </span><span id="local-6989586621679399187"><span class="annot"><span class="annottext">triToPath :: Triangle (PointF (Vector 2 r)) -&gt; Path r
</span><a href="#local-6989586621679399187"><span class="hs-identifier hs-var hs-var">triToPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Triangle.html#Triangle"><span class="hs-identifier hs-type">Triangle</span></a></span><span> </span><span id="local-6989586621679399367"><span class="annot"><span class="annottext">PointF (Vector 2 r)
</span><a href="#local-6989586621679399367"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679399368"><span class="annot"><span class="annottext">PointF (Vector 2 r)
</span><a href="#local-6989586621679399368"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679399369"><span class="annot"><span class="annottext">PointF (Vector 2 r)
</span><a href="#local-6989586621679399369"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimplePolygon (PointF (Vector 2 r)) -&gt; Path r
forall r. SimplePolygon (Point 2 r) -&gt; Path r
</span><a href="Ipe.FromIpe.html#polygonToPath"><span class="hs-identifier hs-var">polygonToPath</span></a></span><span> </span><span class="annot"><span class="annottext">(SimplePolygon (PointF (Vector 2 r)) -&gt; Path r)
-&gt; SimplePolygon (PointF (Vector 2 r)) -&gt; Path r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[PointF (Vector 2 r)] -&gt; SimplePolygon (PointF (Vector 2 r))
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable f) =&gt;
f point -&gt; simplePolygon
forall (f :: * -&gt; *).
Foldable f =&gt;
f (PointF (Vector 2 r)) -&gt; SimplePolygon (PointF (Vector 2 r))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.Class.html#uncheckedFromCCWPoints"><span class="hs-identifier hs-var">uncheckedFromCCWPoints</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PointF (Vector 2 r)
</span><a href="#local-6989586621679399367"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PointF (Vector 2 r)
</span><a href="#local-6989586621679399368"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PointF (Vector 2 r)
</span><a href="#local-6989586621679399369"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679399188"><span class="annot"><span class="annottext">path2tri :: Path r2 -&gt; Maybe (Triangle (PointF (Vector 2 r2)))
</span><a href="#local-6989586621679399188"><span class="hs-identifier hs-var hs-var">path2tri</span></a></span></span><span> </span><span id="local-6989586621679399398"><span class="annot"><span class="annottext">Path r2
</span><a href="#local-6989586621679399398"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path r2
</span><a href="#local-6989586621679399398"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Path r2
-&gt; Getting
     (Endo [SimplePolygon (PointF (Vector 2 r2))])
     (Path r2)
     (SimplePolygon (PointF (Vector 2 r2)))
-&gt; [SimplePolygon (PointF (Vector 2 r2))]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">(Seq (PathSegment r2)
 -&gt; Const
      (Endo [SimplePolygon (PointF (Vector 2 r2))])
      (Seq (PathSegment r2)))
-&gt; Path r2
-&gt; Const (Endo [SimplePolygon (PointF (Vector 2 r2))]) (Path r2)
forall r1 r2 (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Seq (PathSegment r1)) (f (Seq (PathSegment r2)))
-&gt; p (Path r1) (f (Path r2))
</span><a href="Ipe.Path.html#pathSegments"><span class="hs-identifier hs-var">pathSegments</span></a></span><span class="annot"><span class="annottext">((Seq (PathSegment r2)
  -&gt; Const
       (Endo [SimplePolygon (PointF (Vector 2 r2))])
       (Seq (PathSegment r2)))
 -&gt; Path r2
 -&gt; Const (Endo [SimplePolygon (PointF (Vector 2 r2))]) (Path r2))
-&gt; ((SimplePolygon (PointF (Vector 2 r2))
     -&gt; Const
          (Endo [SimplePolygon (PointF (Vector 2 r2))])
          (SimplePolygon (PointF (Vector 2 r2))))
    -&gt; Seq (PathSegment r2)
    -&gt; Const
         (Endo [SimplePolygon (PointF (Vector 2 r2))])
         (Seq (PathSegment r2)))
-&gt; Getting
     (Endo [SimplePolygon (PointF (Vector 2 r2))])
     (Path r2)
     (SimplePolygon (PointF (Vector 2 r2)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(PathSegment r2
 -&gt; Const
      (Endo [SimplePolygon (PointF (Vector 2 r2))]) (PathSegment r2))
-&gt; Seq (PathSegment r2)
-&gt; Const
     (Endo [SimplePolygon (PointF (Vector 2 r2))])
     (Seq (PathSegment r2))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((PathSegment r2
  -&gt; Const
       (Endo [SimplePolygon (PointF (Vector 2 r2))]) (PathSegment r2))
 -&gt; Seq (PathSegment r2)
 -&gt; Const
      (Endo [SimplePolygon (PointF (Vector 2 r2))])
      (Seq (PathSegment r2)))
-&gt; ((SimplePolygon (PointF (Vector 2 r2))
     -&gt; Const
          (Endo [SimplePolygon (PointF (Vector 2 r2))])
          (SimplePolygon (PointF (Vector 2 r2))))
    -&gt; PathSegment r2
    -&gt; Const
         (Endo [SimplePolygon (PointF (Vector 2 r2))]) (PathSegment r2))
-&gt; (SimplePolygon (PointF (Vector 2 r2))
    -&gt; Const
         (Endo [SimplePolygon (PointF (Vector 2 r2))])
         (SimplePolygon (PointF (Vector 2 r2))))
-&gt; Seq (PathSegment r2)
-&gt; Const
     (Endo [SimplePolygon (PointF (Vector 2 r2))])
     (Seq (PathSegment r2))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(SimplePolygon (PointF (Vector 2 r2))
 -&gt; Const
      (Endo [SimplePolygon (PointF (Vector 2 r2))])
      (SimplePolygon (PointF (Vector 2 r2))))
-&gt; PathSegment r2
-&gt; Const
     (Endo [SimplePolygon (PointF (Vector 2 r2))]) (PathSegment r2)
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (PathSegment r) (f (PathSegment r))
</span><a href="Ipe.Path.html#_PolygonPath"><span class="hs-identifier hs-var">_PolygonPath</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Triangle (PointF (Vector 2 r2)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-163"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621679399400"><span class="annot"><span class="annottext">SimplePolygon (PointF (Vector 2 r2))
</span><a href="#local-6989586621679399400"><span class="hs-identifier hs-var">pg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SimplePolygon (PointF (Vector 2 r2))
</span><a href="#local-6989586621679399400"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">SimplePolygon (PointF (Vector 2 r2))
-&gt; Getting
     (Endo [PointF (Vector 2 r2)])
     (SimplePolygon (PointF (Vector 2 r2)))
     (PointF (Vector 2 r2))
-&gt; [PointF (Vector 2 r2)]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">(Vertex (SimplePolygon (PointF (Vector 2 r2)))
 -&gt; Const
      (Endo [PointF (Vector 2 r2)])
      (Vertex (SimplePolygon (PointF (Vector 2 r2)))))
-&gt; SimplePolygon (PointF (Vector 2 r2))
-&gt; Const
     (Endo [PointF (Vector 2 r2)])
     (SimplePolygon (PointF (Vector 2 r2)))
Getting
  (Endo [PointF (Vector 2 r2)])
  (SimplePolygon (PointF (Vector 2 r2)))
  (PointF (Vector 2 r2))
forall graph graph'.
HasVertices graph graph' =&gt;
IndexedTraversal
  (VertexIx graph) graph graph' (Vertex graph) (Vertex graph')
IndexedTraversal
  (VertexIx (SimplePolygon (PointF (Vector 2 r2))))
  (SimplePolygon (PointF (Vector 2 r2)))
  (SimplePolygon (PointF (Vector 2 r2)))
  (Vertex (SimplePolygon (PointF (Vector 2 r2))))
  (Vertex (SimplePolygon (PointF (Vector 2 r2))))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>                              </span><span class="hs-special">[</span><span id="local-6989586621679399402"><span class="annot"><span class="annottext">PointF (Vector 2 r2)
</span><a href="#local-6989586621679399402"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679399403"><span class="annot"><span class="annottext">PointF (Vector 2 r2)
</span><a href="#local-6989586621679399403"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679399404"><span class="annot"><span class="annottext">PointF (Vector 2 r2)
</span><a href="#local-6989586621679399404"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Triangle (PointF (Vector 2 r2))
-&gt; Maybe (Triangle (PointF (Vector 2 r2)))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Triangle (PointF (Vector 2 r2))
 -&gt; Maybe (Triangle (PointF (Vector 2 r2))))
-&gt; Triangle (PointF (Vector 2 r2))
-&gt; Maybe (Triangle (PointF (Vector 2 r2)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PointF (Vector 2 r2)
-&gt; PointF (Vector 2 r2)
-&gt; PointF (Vector 2 r2)
-&gt; Triangle (PointF (Vector 2 r2))
forall point. point -&gt; point -&gt; point -&gt; Triangle point
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Triangle.html#Triangle"><span class="hs-identifier hs-var">Triangle</span></a></span><span> </span><span class="annot"><span class="annottext">PointF (Vector 2 r2)
</span><a href="#local-6989586621679399402"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PointF (Vector 2 r2)
</span><a href="#local-6989586621679399403"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PointF (Vector 2 r2)
</span><a href="#local-6989586621679399404"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-165"></span><span>                              </span><span class="annot"><span class="annottext">[PointF (Vector 2 r2)]
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Triangle (PointF (Vector 2 r2)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-166"></span><span>                    </span><span class="annot"><span class="annottext">[SimplePolygon (PointF (Vector 2 r2))]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Triangle (PointF (Vector 2 r2)))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-comment">-- an ellipse is an affine transformation of the unit disk</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- (Disk origin 1) (Vector2 1 1)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621679398018"><span class="annot"><a href="Ipe.FromIpe.html#_asEllipse"><span class="hs-identifier hs-type">_asEllipse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398018"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ellipse.html#Ellipse"><span class="hs-identifier hs-type">Ellipse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398018"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-175"></span><span id="_asEllipse"><span class="annot"><span class="annottext">_asEllipse :: forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (Ellipse r) (f (Ellipse r)) -&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asEllipse"><span class="hs-identifier hs-var hs-var">_asEllipse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ellipse r -&gt; Path r)
-&gt; (Path r -&gt; Maybe (Ellipse r))
-&gt; Prism (Path r) (Path r) (Ellipse r) (Ellipse r)
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Prism.html#prism%27"><span class="hs-identifier hs-var">prism'</span></a></span><span> </span><span class="annot"><span class="annottext">Ellipse r -&gt; Path r
forall {r}. Ellipse r -&gt; Path r
</span><a href="#local-6989586621679399410"><span class="hs-identifier hs-var">toPath</span></a></span><span> </span><span class="annot"><span class="annottext">Path r -&gt; Maybe (Ellipse r)
forall {r2}. Path r2 -&gt; Maybe (Ellipse r2)
</span><a href="#local-6989586621679399411"><span class="hs-identifier hs-var">toEllipse</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679399410"><span class="annot"><span class="annottext">toPath :: Ellipse r -&gt; Path r
</span><a href="#local-6989586621679399410"><span class="hs-identifier hs-var hs-var">toPath</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (PathSegment r) -&gt; Path r
forall r. Seq (PathSegment r) -&gt; Path r
</span><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (PathSegment r) -&gt; Path r)
-&gt; (Ellipse r -&gt; Seq (PathSegment r)) -&gt; Ellipse r -&gt; Path r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PathSegment r -&gt; Seq (PathSegment r)
forall a. a -&gt; Seq a
</span><a href="Ipe.FromIpe.html#fromSingleton"><span class="hs-identifier hs-var">fromSingleton</span></a></span><span>  </span><span class="annot"><span class="annottext">(PathSegment r -&gt; Seq (PathSegment r))
-&gt; (Ellipse r -&gt; PathSegment r) -&gt; Ellipse r -&gt; Seq (PathSegment r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ellipse r -&gt; PathSegment r
forall r. Ellipse r -&gt; PathSegment r
</span><a href="Ipe.Path.html#EllipseSegment"><span class="hs-identifier hs-var">EllipseSegment</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679399411"><span class="annot"><span class="annottext">toEllipse :: Path r2 -&gt; Maybe (Ellipse r2)
</span><a href="#local-6989586621679399411"><span class="hs-identifier hs-var hs-var">toEllipse</span></a></span></span><span> </span><span id="local-6989586621679399420"><span class="annot"><span class="annottext">Path r2
</span><a href="#local-6989586621679399420"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path r2
</span><a href="#local-6989586621679399420"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Path r2
-&gt; Getting (Endo [Ellipse r2]) (Path r2) (Ellipse r2)
-&gt; [Ellipse r2]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">(Seq (PathSegment r2)
 -&gt; Const (Endo [Ellipse r2]) (Seq (PathSegment r2)))
-&gt; Path r2 -&gt; Const (Endo [Ellipse r2]) (Path r2)
forall r1 r2 (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Seq (PathSegment r1)) (f (Seq (PathSegment r2)))
-&gt; p (Path r1) (f (Path r2))
</span><a href="Ipe.Path.html#pathSegments"><span class="hs-identifier hs-var">pathSegments</span></a></span><span class="annot"><span class="annottext">((Seq (PathSegment r2)
  -&gt; Const (Endo [Ellipse r2]) (Seq (PathSegment r2)))
 -&gt; Path r2 -&gt; Const (Endo [Ellipse r2]) (Path r2))
-&gt; ((Ellipse r2 -&gt; Const (Endo [Ellipse r2]) (Ellipse r2))
    -&gt; Seq (PathSegment r2)
    -&gt; Const (Endo [Ellipse r2]) (Seq (PathSegment r2)))
-&gt; Getting (Endo [Ellipse r2]) (Path r2) (Ellipse r2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(PathSegment r2 -&gt; Const (Endo [Ellipse r2]) (PathSegment r2))
-&gt; Seq (PathSegment r2)
-&gt; Const (Endo [Ellipse r2]) (Seq (PathSegment r2))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((PathSegment r2 -&gt; Const (Endo [Ellipse r2]) (PathSegment r2))
 -&gt; Seq (PathSegment r2)
 -&gt; Const (Endo [Ellipse r2]) (Seq (PathSegment r2)))
-&gt; ((Ellipse r2 -&gt; Const (Endo [Ellipse r2]) (Ellipse r2))
    -&gt; PathSegment r2 -&gt; Const (Endo [Ellipse r2]) (PathSegment r2))
-&gt; (Ellipse r2 -&gt; Const (Endo [Ellipse r2]) (Ellipse r2))
-&gt; Seq (PathSegment r2)
-&gt; Const (Endo [Ellipse r2]) (Seq (PathSegment r2))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Ellipse r2 -&gt; Const (Endo [Ellipse r2]) (Ellipse r2))
-&gt; PathSegment r2 -&gt; Const (Endo [Ellipse r2]) (PathSegment r2)
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (Ellipse r) (f (Ellipse r))
-&gt; p (PathSegment r) (f (PathSegment r))
</span><a href="Ipe.Path.html#_EllipseSegment"><span class="hs-identifier hs-var">_EllipseSegment</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-179"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621679399422"><span class="annot"><span class="annottext">Ellipse r2
</span><a href="#local-6989586621679399422"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ellipse r2 -&gt; Maybe (Ellipse r2)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Ellipse r2
</span><a href="#local-6989586621679399422"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-180"></span><span>                    </span><span class="annot"><span class="annottext">[Ellipse r2]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Ellipse r2)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679398028"><span class="annot"><a href="Ipe.FromIpe.html#_asCircle"><span class="hs-identifier hs-type">_asCircle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Number.Radical.html#Radical"><span class="hs-identifier hs-type">Radical</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398028"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679398028"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398028"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ball.CenterAndRadius.html#Circle"><span class="hs-identifier hs-type">Circle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398028"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-183"></span><span id="_asCircle"><span class="annot"><span class="annottext">_asCircle :: forall r. (Radical r, Eq r) =&gt; Prism' (Path r) (Circle (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asCircle"><span class="hs-identifier hs-var hs-var">_asCircle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p (Ellipse r) (f (Ellipse r)) -&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (Ellipse r) (f (Ellipse r)) -&gt; p (Path r) (f (Path r))
</span><a href="Ipe.FromIpe.html#_asEllipse"><span class="hs-identifier hs-var">_asEllipse</span></a></span><span class="annot"><span class="annottext">(p (Ellipse r) (f (Ellipse r)) -&gt; p (Path r) (f (Path r)))
-&gt; (p (Circle (Point 2 r)) (f (Circle (Point 2 r)))
    -&gt; p (Ellipse r) (f (Ellipse r)))
-&gt; p (Circle (Point 2 r)) (f (Circle (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">p (Circle (Point 2 r)) (f (Circle (Point 2 r)))
-&gt; p (Ellipse r) (f (Ellipse r))
forall r.
(Radical r, Eq r) =&gt;
Prism' (Ellipse r) (Circle (Point 2 r))
Prism' (Ellipse r) (Circle (Point 2 r))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ellipse.html#_EllipseCircle"><span class="hs-identifier hs-var">_EllipseCircle</span></a></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- FIXME: For reading we should not need the Radical constraint!</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span id="local-6989586621679398035"><span class="annot"><a href="Ipe.FromIpe.html#_asDisk"><span class="hs-identifier hs-type">_asDisk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Number.Radical.html#Radical"><span class="hs-identifier hs-type">Radical</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679398035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ball.CenterAndRadius.html#Disk"><span class="hs-identifier hs-type">Disk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398035"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-187"></span><span id="_asDisk"><span class="annot"><span class="annottext">_asDisk :: forall r. (Radical r, Eq r) =&gt; Prism' (Path r) (Disk (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asDisk"><span class="hs-identifier hs-var hs-var">_asDisk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p (Circle (Point 2 r)) (f (Circle (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r. (Radical r, Eq r) =&gt; Prism' (Path r) (Circle (Point 2 r))
Prism' (Path r) (Circle (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asCircle"><span class="hs-identifier hs-var">_asCircle</span></a></span><span class="annot"><span class="annottext">(p (Circle (Point 2 r)) (f (Circle (Point 2 r)))
 -&gt; p (Path r) (f (Path r)))
-&gt; (p (Disk (Point 2 r)) (f (Disk (Point 2 r)))
    -&gt; p (Circle (Point 2 r)) (f (Circle (Point 2 r))))
-&gt; p (Disk (Point 2 r)) (f (Disk (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">AnIso
  (Disk (Point 2 r))
  (Disk (Point 2 r))
  (Circle (Point 2 r))
  (Circle (Point 2 r))
-&gt; Iso
     (Circle (Point 2 r))
     (Circle (Point 2 r))
     (Disk (Point 2 r))
     (Disk (Point 2 r))
forall s t a b. AnIso s t a b -&gt; Iso b a t s
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Iso.html#from"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="annot"><span class="annottext">AnIso
  (Disk (Point 2 r))
  (Disk (Point 2 r))
  (Circle (Point 2 r))
  (Circle (Point 2 r))
forall point point' (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Circle point) (f (Circle point'))
-&gt; p (Disk point) (f (Disk point'))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ball.CenterAndRadius.html#_DiskCircle"><span class="hs-identifier hs-var">_DiskCircle</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- -- | Convert to a multipolygon</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- _asMultiPolygon :: Prism' (Path r) (MultiPolygon () r)</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- _asMultiPolygon = _asSomePolygon._Right</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- _asPolygon :: Prism' (Path r) (forall t. Polygon t () r)</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- _asPolygon = prism' polygonToPath (fmap (either id id) . pathToPolygon)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- _asSomePolygon :: Prism' (Path r) (SomePolygon () r)</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- _asSomePolygon = prism' embed pathToPolygon</span><span>
</span><span id="line-199"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-200"></span><span class="hs-comment">--     embed     = either polygonToPath polygonToPath</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span id="local-6989586621679397857"><span class="annot"><a href="Ipe.FromIpe.html#polygonToPath"><span class="hs-identifier hs-type">polygonToPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397857"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397857"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-204"></span><span id="polygonToPath"><span class="annot"><span class="annottext">polygonToPath :: forall r. SimplePolygon (Point 2 r) -&gt; Path r
</span><a href="Ipe.FromIpe.html#polygonToPath"><span class="hs-identifier hs-var hs-var">polygonToPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq (PathSegment r) -&gt; Path r
forall r. Seq (PathSegment r) -&gt; Path r
</span><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (PathSegment r) -&gt; Path r)
-&gt; (SimplePolygon (Point 2 r) -&gt; Seq (PathSegment r))
-&gt; SimplePolygon (Point 2 r)
-&gt; Path r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PathSegment r -&gt; Seq (PathSegment r)
forall a. a -&gt; Seq a
</span><a href="Ipe.FromIpe.html#fromSingleton"><span class="hs-identifier hs-var">fromSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">(PathSegment r -&gt; Seq (PathSegment r))
-&gt; (SimplePolygon (Point 2 r) -&gt; PathSegment r)
-&gt; SimplePolygon (Point 2 r)
-&gt; Seq (PathSegment r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Point 2 r) -&gt; PathSegment r
forall r. SimplePolygon (Point 2 r) -&gt; PathSegment r
</span><a href="Ipe.Path.html#PolygonPath"><span class="hs-identifier hs-var">PolygonPath</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- polygonToPath (MultiPolygon vs hs) = Path . LSeq.fromNonEmpty . fmap PolygonPath</span><span>
</span><span id="line-208"></span><span class="hs-comment">--                                    $ vs :| hs</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span id="local-6989586621679397858"><span class="annot"><a href="Ipe.FromIpe.html#pathToPolygon"><span class="hs-identifier hs-type">pathToPolygon</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679397858"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679397858"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-211"></span><span id="pathToPolygon"><span class="annot"><span class="annottext">pathToPolygon :: forall r. Path r -&gt; Maybe (SimplePolygon (Point 2 r))
</span><a href="Ipe.FromIpe.html#pathToPolygon"><span class="hs-identifier hs-var hs-var">pathToPolygon</span></a></span></span><span> </span><span id="local-6989586621679399463"><span class="annot"><span class="annottext">Path r
</span><a href="#local-6989586621679399463"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path r
</span><a href="#local-6989586621679399463"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">Path r
-&gt; Getting
     (Endo [SimplePolygon (Point 2 r)])
     (Path r)
     (SimplePolygon (Point 2 r))
-&gt; [SimplePolygon (Point 2 r)]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">(Seq (PathSegment r)
 -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (Seq (PathSegment r)))
-&gt; Path r -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (Path r)
forall r1 r2 (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Seq (PathSegment r1)) (f (Seq (PathSegment r2)))
-&gt; p (Path r1) (f (Path r2))
</span><a href="Ipe.Path.html#pathSegments"><span class="hs-identifier hs-var">pathSegments</span></a></span><span class="annot"><span class="annottext">((Seq (PathSegment r)
  -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (Seq (PathSegment r)))
 -&gt; Path r -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (Path r))
-&gt; ((SimplePolygon (Point 2 r)
     -&gt; Const
          (Endo [SimplePolygon (Point 2 r)]) (SimplePolygon (Point 2 r)))
    -&gt; Seq (PathSegment r)
    -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (Seq (PathSegment r)))
-&gt; Getting
     (Endo [SimplePolygon (Point 2 r)])
     (Path r)
     (SimplePolygon (Point 2 r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(PathSegment r
 -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (PathSegment r))
-&gt; Seq (PathSegment r)
-&gt; Const (Endo [SimplePolygon (Point 2 r)]) (Seq (PathSegment r))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Seq a -&gt; f (Seq b)
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((PathSegment r
  -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (PathSegment r))
 -&gt; Seq (PathSegment r)
 -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (Seq (PathSegment r)))
-&gt; ((SimplePolygon (Point 2 r)
     -&gt; Const
          (Endo [SimplePolygon (Point 2 r)]) (SimplePolygon (Point 2 r)))
    -&gt; PathSegment r
    -&gt; Const (Endo [SimplePolygon (Point 2 r)]) (PathSegment r))
-&gt; (SimplePolygon (Point 2 r)
    -&gt; Const
         (Endo [SimplePolygon (Point 2 r)]) (SimplePolygon (Point 2 r)))
-&gt; Seq (PathSegment r)
-&gt; Const (Endo [SimplePolygon (Point 2 r)]) (Seq (PathSegment r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(SimplePolygon (Point 2 r)
 -&gt; Const
      (Endo [SimplePolygon (Point 2 r)]) (SimplePolygon (Point 2 r)))
-&gt; PathSegment r
-&gt; Const (Endo [SimplePolygon (Point 2 r)]) (PathSegment r)
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (PathSegment r) (f (PathSegment r))
</span><a href="Ipe.Path.html#_PolygonPath"><span class="hs-identifier hs-var">_PolygonPath</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621679399464"><span class="annot"><span class="annottext">SimplePolygon (Point 2 r)
</span><a href="#local-6989586621679399464"><span class="hs-identifier hs-var">pg</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Point 2 r) -&gt; Maybe (SimplePolygon (Point 2 r))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon (Point 2 r)
</span><a href="#local-6989586621679399464"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-213"></span><span>                    </span><span class="annot"><span class="annottext">[SimplePolygon (Point 2 r)]
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (SimplePolygon (Point 2 r))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-214"></span><span>                    </span><span class="hs-comment">-- vs:hs -&gt; Just . Right $ MultiPolygon vs hs</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Use the first prism to select the ipe object to depicle with, and the second</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- how to select the geometry object from there on. Then we can select the geometry</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- object, directly with its attributes here.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- &gt;&gt;&gt; testObject ^? _withAttrs _IpePath _asPolyLine</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- Just (PolyLine [Point2 0 0,Point2 10 10,Point2 200 100] :+ Attrs {NoAttr, NoAttr, NoAttr, NoAttr, Attr IpeColor (Named &quot;red&quot;), NoAttr, NoAttr, NoAttr, NoAttr, NoAttr, NoAttr, NoAttr, NoAttr, NoAttr, NoAttr, NoAttr, NoAttr})</span><span>
</span><span id="line-229"></span><span id="local-6989586621679398057"><span id="local-6989586621679398059"><span id="local-6989586621679398062"><span class="annot"><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-type">_withAttrs</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Content.html#IpeObject"><span class="hs-identifier hs-type">IpeObject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398057"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398059"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398057"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="Ipe.Content.html#IpeAttributes"><span class="hs-identifier hs-type">IpeAttributes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398059"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398057"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398059"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398057"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679398062"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-230"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Content.html#IpeObject"><span class="hs-identifier hs-type">IpeObject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398057"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398062"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="Ipe.Content.html#IpeAttributes"><span class="hs-identifier hs-type">IpeAttributes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398059"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398057"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-231"></span><span id="_withAttrs"><span class="annot"><span class="annottext">_withAttrs :: forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var hs-var">_withAttrs</span></a></span></span><span> </span><span id="local-6989586621679399493"><span class="annot"><span class="annottext">Prism' (IpeObject r) (i r :+ Attributes' r (AttributesOf i))
</span><a href="#local-6989586621679399493"><span class="hs-identifier hs-var">po</span></a></span></span><span> </span><span id="local-6989586621679399494"><span class="annot"><span class="annottext">Prism' (i r) g
</span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((g :+ Attributes' r (AttributesOf i)) -&gt; IpeObject r)
-&gt; (IpeObject r -&gt; Maybe (g :+ Attributes' r (AttributesOf i)))
-&gt; Prism
     (IpeObject r)
     (IpeObject r)
     (g :+ Attributes' r (AttributesOf i))
     (g :+ Attributes' r (AttributesOf i))
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Prism.html#prism%27"><span class="hs-identifier hs-var">prism'</span></a></span><span> </span><span class="annot"><span class="annottext">(g :+ Attributes' r (AttributesOf i)) -&gt; IpeObject r
</span><a href="#local-6989586621679399495"><span class="hs-identifier hs-var">g2o</span></a></span><span> </span><span class="annot"><span class="annottext">IpeObject r -&gt; Maybe (g :+ Attributes' r (AttributesOf i))
</span><a href="#local-6989586621679399496"><span class="hs-identifier hs-var">o2g</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621679399495"><span class="annot"><span class="annottext">g2o :: (g :+ Attributes' r (AttributesOf i)) -&gt; IpeObject r
</span><a href="#local-6989586621679399495"><span class="hs-identifier hs-var hs-var">g2o</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AReview (IpeObject r) (i r :+ Attributes' r (AttributesOf i))
-&gt; (i r :+ Attributes' r (AttributesOf i)) -&gt; IpeObject r
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Review.html#review"><span class="hs-identifier hs-var">review</span></a></span><span> </span><span class="annot"><span class="annottext">AReview (IpeObject r) (i r :+ Attributes' r (AttributesOf i))
Prism' (IpeObject r) (i r :+ Attributes' r (AttributesOf i))
</span><a href="#local-6989586621679399493"><span class="hs-identifier hs-var">po</span></a></span><span> </span><span class="annot"><span class="annottext">((i r :+ Attributes' r (AttributesOf i)) -&gt; IpeObject r)
-&gt; ((g :+ Attributes' r (AttributesOf i))
    -&gt; i r :+ Attributes' r (AttributesOf i))
-&gt; (g :+ Attributes' r (AttributesOf i))
-&gt; IpeObject r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASetter
  (g :+ Attributes' r (AttributesOf i))
  (i r :+ Attributes' r (AttributesOf i))
  g
  (i r)
-&gt; (g -&gt; i r)
-&gt; (g :+ Attributes' r (AttributesOf i))
-&gt; i r :+ Attributes' r (AttributesOf i)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Setter.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter
  (g :+ Attributes' r (AttributesOf i))
  (i r :+ Attributes' r (AttributesOf i))
  g
  (i r)
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AReview (i r) g -&gt; g -&gt; i r
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Review.html#review"><span class="hs-identifier hs-var">review</span></a></span><span> </span><span class="annot"><span class="annottext">AReview (i r) g
Prism' (i r) g
</span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">pg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679399496"><span class="annot"><span class="annottext">o2g :: IpeObject r -&gt; Maybe (g :+ Attributes' r (AttributesOf i))
</span><a href="#local-6989586621679399496"><span class="hs-identifier hs-var hs-var">o2g</span></a></span></span><span> </span><span id="local-6989586621679399499"><span class="annot"><span class="annottext">IpeObject r
</span><a href="#local-6989586621679399499"><span class="hs-identifier hs-var">o</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting
  (First (i r :+ Attributes' r (AttributesOf i)))
  (IpeObject r)
  (i r :+ Attributes' r (AttributesOf i))
-&gt; IpeObject r -&gt; Maybe (i r :+ Attributes' r (AttributesOf i))
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#preview"><span class="hs-identifier hs-var">preview</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (First (i r :+ Attributes' r (AttributesOf i)))
  (IpeObject r)
  (i r :+ Attributes' r (AttributesOf i))
Prism' (IpeObject r) (i r :+ Attributes' r (AttributesOf i))
</span><a href="#local-6989586621679399493"><span class="hs-identifier hs-var">po</span></a></span><span> </span><span class="annot"><span class="annottext">IpeObject r
</span><a href="#local-6989586621679399499"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (i r :+ Attributes' r (AttributesOf i))
-&gt; ((i r :+ Attributes' r (AttributesOf i))
    -&gt; Maybe (g :+ Attributes' r (AttributesOf i)))
-&gt; Maybe (g :+ Attributes' r (AttributesOf i))
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679399500"><span class="annot"><span class="annottext">i r
</span><a href="#local-6989586621679399500"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679399502"><span class="annot"><span class="annottext">Attributes' r (AttributesOf i)
</span><a href="#local-6989586621679399502"><span class="hs-identifier hs-var">ats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g
-&gt; Attributes' r (AttributesOf i)
-&gt; g :+ Attributes' r (AttributesOf i)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">Attributes' r (AttributesOf i)
</span><a href="#local-6989586621679399502"><span class="hs-identifier hs-var">ats</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(g -&gt; g :+ Attributes' r (AttributesOf i))
-&gt; Maybe g -&gt; Maybe (g :+ Attributes' r (AttributesOf i))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Getting (First g) (i r) g -&gt; i r -&gt; Maybe g
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#preview"><span class="hs-identifier hs-var">preview</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (First g) (i r) g
Prism' (i r) g
</span><a href="#local-6989586621679399494"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">i r
</span><a href="#local-6989586621679399500"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- instance HasDefaultIpeObject Path where</span><span>
</span><span id="line-241"></span><span class="hs-comment">--   defaultIpeObject' = _IpePath</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-keyword">class</span><span> </span><span id="HasDefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-var">HasDefaultFromIpe</span></a></span></span><span> </span><span id="local-6989586621679398088"><span class="annot"><a href="#local-6989586621679398088"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span id="local-6989586621679398088"><span class="annot"><a href="#local-6989586621679398088"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-248"></span><span>  </span><span id="defaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-type">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679398084"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398084"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html#NumType"><span class="hs-identifier hs-type">NumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398088"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Type.html#Prism%27"><span class="hs-identifier hs-type">Prism'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.Content.html#IpeObject"><span class="hs-identifier hs-type">IpeObject</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398084"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679398088"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="Ipe.Content.html#IpeAttributes"><span class="hs-identifier hs-type">IpeAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-type">DefaultFromIpe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398088"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679398084"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398089"><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398089"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398089"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Content.html#IpeSymbol"><span class="hs-identifier hs-type">IpeSymbol</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679399515"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (Point 2 r)) =&gt;
Prism'
  (IpeObject r)
  (Point 2 r :+ IpeAttributes (DefaultFromIpe (Point 2 r)) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (IpeSymbol r :+ IpeAttributes IpeSymbol r)
-&gt; Prism' (IpeSymbol r) (Point 2 r)
-&gt; Prism' (IpeObject r) (Point 2 r :+ IpeAttributes IpeSymbol r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (IpeSymbol r :+ IpeAttributes IpeSymbol r)
  (f (IpeSymbol r :+ IpeAttributes IpeSymbol r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' IpeSymbol r) (f (IpeObject' IpeSymbol r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (IpeSymbol r :+ IpeAttributes IpeSymbol r)
</span><a href="Ipe.Content.html#_IpeUse"><span class="hs-identifier hs-var">_IpeUse</span></a></span><span> </span><span class="annot"><span class="annottext">p (Point 2 r) (f (Point 2 r)) -&gt; p (IpeSymbol r) (f (IpeSymbol r))
p (Point 2 r) (f (Point 2 r)) -&gt; p (IpeSymbol r) (f (IpeSymbol r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (Point 2 r) (f (Point 2 r)) -&gt; p (IpeSymbol r) (f (IpeSymbol r))
Prism' (IpeSymbol r) (Point 2 r)
</span><a href="Ipe.FromIpe.html#_asPoint"><span class="hs-identifier hs-var">_asPoint</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398105"><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.LineSegment.Internal.html#ClosedLineSegment"><span class="hs-identifier hs-type">ClosedLineSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398105"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.LineSegment.Internal.html#ClosedLineSegment"><span class="hs-identifier hs-type">ClosedLineSegment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398105"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679399534"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (ClosedLineSegment (Point 2 r))) =&gt;
Prism'
  (IpeObject r)
  (ClosedLineSegment (Point 2 r)
   :+ IpeAttributes
        (DefaultFromIpe (ClosedLineSegment (Point 2 r))) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
-&gt; Prism' (Path r) (ClosedLineSegment (Point 2 r))
-&gt; Prism'
     (IpeObject r)
     (ClosedLineSegment (Point 2 r) :+ IpeAttributes Path r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (Path r :+ IpeAttributes Path r)
  (f (Path r :+ IpeAttributes Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' Path r) (f (IpeObject' Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
</span><a href="Ipe.Content.html#_IpePath"><span class="hs-identifier hs-var">_IpePath</span></a></span><span> </span><span class="annot"><span class="annottext">p (ClosedLineSegment (Point 2 r))
  (f (ClosedLineSegment (Point 2 r)))
-&gt; p (Path r) (f (Path r))
p (ClosedLineSegment (Point 2 r))
  (f (ClosedLineSegment (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (ClosedLineSegment (Point 2 r))
  (f (ClosedLineSegment (Point 2 r)))
-&gt; p (Path r) (f (Path r))
Prism' (Path r) (ClosedLineSegment (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asClosedLineSegment"><span class="hs-identifier hs-var">_asClosedLineSegment</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398117"><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Interval.EndPoint.html#AnEndPoint"><span class="hs-identifier hs-type">AnEndPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398117"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.LineSegment.Internal.html#LineSegment"><span class="hs-identifier hs-type">LineSegment</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Interval.EndPoint.html#AnEndPoint"><span class="hs-identifier hs-type">AnEndPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398117"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679399553"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (LineSegment AnEndPoint (Point 2 r))) =&gt;
Prism'
  (IpeObject r)
  (LineSegment AnEndPoint (Point 2 r)
   :+ IpeAttributes
        (DefaultFromIpe (LineSegment AnEndPoint (Point 2 r))) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
-&gt; Prism' (Path r) (LineSegment AnEndPoint (Point 2 r))
-&gt; Prism'
     (IpeObject r)
     (LineSegment AnEndPoint (Point 2 r) :+ IpeAttributes Path r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (Path r :+ IpeAttributes Path r)
  (f (Path r :+ IpeAttributes Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' Path r) (f (IpeObject' Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
</span><a href="Ipe.Content.html#_IpePath"><span class="hs-identifier hs-var">_IpePath</span></a></span><span> </span><span class="annot"><span class="annottext">p (LineSegment AnEndPoint (Point 2 r))
  (f (LineSegment AnEndPoint (Point 2 r)))
-&gt; p (Path r) (f (Path r))
p (LineSegment AnEndPoint (Point 2 r))
  (f (LineSegment AnEndPoint (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (LineSegment AnEndPoint (Point 2 r))
  (f (LineSegment AnEndPoint (Point 2 r)))
-&gt; p (Path r) (f (Path r))
Prism' (Path r) (LineSegment AnEndPoint (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asLineSegment"><span class="hs-identifier hs-var">_asLineSegment</span></a></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398126"><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ellipse.html#Ellipse"><span class="hs-identifier hs-type">Ellipse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398126"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ellipse.html#Ellipse"><span class="hs-identifier hs-type">Ellipse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398126"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679399571"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (Ellipse r)) =&gt;
Prism'
  (IpeObject r)
  (Ellipse r :+ IpeAttributes (DefaultFromIpe (Ellipse r)) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
-&gt; Prism' (Path r) (Ellipse r)
-&gt; Prism' (IpeObject r) (Ellipse r :+ IpeAttributes Path r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (Path r :+ IpeAttributes Path r)
  (f (Path r :+ IpeAttributes Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' Path r) (f (IpeObject' Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
</span><a href="Ipe.Content.html#_IpePath"><span class="hs-identifier hs-var">_IpePath</span></a></span><span> </span><span class="annot"><span class="annottext">p (Ellipse r) (f (Ellipse r)) -&gt; p (Path r) (f (Path r))
p (Ellipse r) (f (Ellipse r)) -&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (Ellipse r) (f (Ellipse r)) -&gt; p (Path r) (f (Path r))
Prism' (Path r) (Ellipse r)
</span><a href="Ipe.FromIpe.html#_asEllipse"><span class="hs-identifier hs-var">_asEllipse</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398135"><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Number.Radical.html#Radical"><span class="hs-identifier hs-type">Radical</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398135"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679398135"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ball.CenterAndRadius.html#Circle"><span class="hs-identifier hs-type">Circle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398135"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ball.CenterAndRadius.html#Circle"><span class="hs-identifier hs-type">Circle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398135"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679399591"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (Circle (Point 2 r))) =&gt;
Prism'
  (IpeObject r)
  (Circle (Point 2 r)
   :+ IpeAttributes (DefaultFromIpe (Circle (Point 2 r))) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
-&gt; Prism' (Path r) (Circle (Point 2 r))
-&gt; Prism'
     (IpeObject r) (Circle (Point 2 r) :+ IpeAttributes Path r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (Path r :+ IpeAttributes Path r)
  (f (Path r :+ IpeAttributes Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' Path r) (f (IpeObject' Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
</span><a href="Ipe.Content.html#_IpePath"><span class="hs-identifier hs-var">_IpePath</span></a></span><span> </span><span class="annot"><span class="annottext">p (Circle (Point 2 r)) (f (Circle (Point 2 r)))
-&gt; p (Path r) (f (Path r))
p (Circle (Point 2 r)) (f (Circle (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r. (Radical r, Eq r) =&gt; Prism' (Path r) (Circle (Point 2 r))
Prism' (Path r) (Circle (Point 2 r))
Prism' (Path r) (Circle (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asCircle"><span class="hs-identifier hs-var">_asCircle</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398144"><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Number.Radical.html#Radical"><span class="hs-identifier hs-type">Radical</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398144"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679398144"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ball.CenterAndRadius.html#Disk"><span class="hs-identifier hs-type">Disk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398144"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Ball.CenterAndRadius.html#Disk"><span class="hs-identifier hs-type">Disk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398144"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621679399613"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (Disk (Point 2 r))) =&gt;
Prism'
  (IpeObject r)
  (Disk (Point 2 r)
   :+ IpeAttributes (DefaultFromIpe (Disk (Point 2 r))) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
-&gt; Prism' (Path r) (Disk (Point 2 r))
-&gt; Prism' (IpeObject r) (Disk (Point 2 r) :+ IpeAttributes Path r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (Path r :+ IpeAttributes Path r)
  (f (Path r :+ IpeAttributes Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' Path r) (f (IpeObject' Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
</span><a href="Ipe.Content.html#_IpePath"><span class="hs-identifier hs-var">_IpePath</span></a></span><span> </span><span class="annot"><span class="annottext">p (Disk (Point 2 r)) (f (Disk (Point 2 r)))
-&gt; p (Path r) (f (Path r))
p (Disk (Point 2 r)) (f (Disk (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r. (Radical r, Eq r) =&gt; Prism' (Path r) (Disk (Point 2 r))
Prism' (Path r) (Disk (Point 2 r))
Prism' (Path r) (Disk (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asDisk"><span class="hs-identifier hs-var">_asDisk</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398153"><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.PolyLine.html#PolyLine"><span class="hs-identifier hs-type">PolyLine.PolyLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398153"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.PolyLine.html#PolyLine"><span class="hs-identifier hs-type">PolyLine.PolyLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398153"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679399633"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (PolyLine (Point 2 r))) =&gt;
Prism'
  (IpeObject r)
  (PolyLine (Point 2 r)
   :+ IpeAttributes (DefaultFromIpe (PolyLine (Point 2 r))) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
-&gt; Prism' (Path r) (PolyLine (Point 2 r))
-&gt; Prism'
     (IpeObject r) (PolyLine (Point 2 r) :+ IpeAttributes Path r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (Path r :+ IpeAttributes Path r)
  (f (Path r :+ IpeAttributes Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' Path r) (f (IpeObject' Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
</span><a href="Ipe.Content.html#_IpePath"><span class="hs-identifier hs-var">_IpePath</span></a></span><span> </span><span class="annot"><span class="annottext">p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (Path r) (f (Path r))
p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (PolyLine (Point 2 r)) (f (PolyLine (Point 2 r)))
-&gt; p (Path r) (f (Path r))
Prism' (Path r) (PolyLine (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asPolyLine"><span class="hs-identifier hs-var">_asPolyLine</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398162"><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398162"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.Polygon.Simple.html#SimplePolygon"><span class="hs-identifier hs-type">SimplePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398162"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621679399651"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (SimplePolygon (Point 2 r))) =&gt;
Prism'
  (IpeObject r)
  (SimplePolygon (Point 2 r)
   :+ IpeAttributes (DefaultFromIpe (SimplePolygon (Point 2 r))) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
-&gt; Prism' (Path r) (SimplePolygon (Point 2 r))
-&gt; Prism'
     (IpeObject r) (SimplePolygon (Point 2 r) :+ IpeAttributes Path r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (Path r :+ IpeAttributes Path r)
  (f (Path r :+ IpeAttributes Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' Path r) (f (IpeObject' Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
</span><a href="Ipe.Content.html#_IpePath"><span class="hs-identifier hs-var">_IpePath</span></a></span><span> </span><span class="annot"><span class="annottext">p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (SimplePolygon (Point 2 r)) (f (SimplePolygon (Point 2 r)))
-&gt; p (Path r) (f (Path r))
Prism' (Path r) (SimplePolygon (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asSimplePolygon"><span class="hs-identifier hs-var">_asSimplePolygon</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- instance HasDefaultFromIpe (MultiPolygon () r) where</span><span>
</span><span id="line-285"></span><span class="hs-comment">--   type DefaultFromIpe (MultiPolygon () r) = Path</span><span>
</span><span id="line-286"></span><span class="hs-comment">--   defaultFromIpe = _withAttrs _IpePath _asMultiPolygon</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679398171"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679398171"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679398171"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398171"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DefaultFromIpe"><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-var">DefaultFromIpe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/kernel/doc/html/hgeometry/src/HGeometry.Box.Internal.html#Rectangle"><span class="hs-identifier hs-type">Rectangle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/point/doc/html/hgeometry/src/HGeometry.Point.html#Point"><span class="hs-identifier hs-type">Point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679398171"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Ipe.Path.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679399671"><span class="annot"><span class="annottext">defaultFromIpe :: forall r.
(r ~ NumType (Rectangle (Point 2 r))) =&gt;
Prism'
  (IpeObject r)
  (Rectangle (Point 2 r)
   :+ IpeAttributes (DefaultFromIpe (Rectangle (Point 2 r))) r)
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultFromIpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
-&gt; Prism' (Path r) (Rectangle (Point 2 r))
-&gt; Prism'
     (IpeObject r) (Rectangle (Point 2 r) :+ IpeAttributes Path r)
forall r (i :: * -&gt; *) g.
Prism' (IpeObject r) (i r :+ IpeAttributes i r)
-&gt; Prism' (i r) g -&gt; Prism' (IpeObject r) (g :+ IpeAttributes i r)
</span><a href="Ipe.FromIpe.html#_withAttrs"><span class="hs-identifier hs-var">_withAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">p (Path r :+ IpeAttributes Path r)
  (f (Path r :+ IpeAttributes Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
forall r (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Choice p, Applicative f) =&gt;
p (IpeObject' Path r) (f (IpeObject' Path r))
-&gt; p (IpeObject r) (f (IpeObject r))
Prism' (IpeObject r) (Path r :+ IpeAttributes Path r)
</span><a href="Ipe.Content.html#_IpePath"><span class="hs-identifier hs-var">_IpePath</span></a></span><span> </span><span class="annot"><span class="annottext">p (Rectangle (Point 2 r)) (f (Rectangle (Point 2 r)))
-&gt; p (Path r) (f (Path r))
p (Rectangle (Point 2 r)) (f (Rectangle (Point 2 r)))
-&gt; p (Path r) (f (Path r))
forall r. (Num r, Ord r) =&gt; Prism' (Path r) (Rectangle (Point 2 r))
Prism' (Path r) (Rectangle (Point 2 r))
Prism' (Path r) (Rectangle (Point 2 r))
</span><a href="Ipe.FromIpe.html#_asRectangle"><span class="hs-identifier hs-var">_asRectangle</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><span class="hs-comment">-- | Read all g's from some ipe page(s).</span></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Ipe.FromIpe.html#readAll"><span class="hs-identifier hs-type">readAll</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679398179"><span class="annot"><a href="#local-6989586621679398179"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679398180"><span class="annot"><a href="#local-6989586621679398180"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398179"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398180"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html#NumType"><span class="hs-identifier hs-type">NumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398179"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Ipe.Types.html#IpePage"><span class="hs-identifier hs-type">IpePage</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398180"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398179"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="Ipe.Content.html#IpeAttributes"><span class="hs-identifier hs-type">IpeAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-type">DefaultFromIpe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398179"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679398180"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span id="readAll"><span class="annot"><span class="annottext">readAll :: forall g r.
(HasDefaultFromIpe g, r ~ NumType g) =&gt;
IpePage r -&gt; [g :+ IpeAttributes (DefaultFromIpe g) r]
</span><a href="Ipe.FromIpe.html#readAll"><span class="hs-identifier hs-var hs-var">readAll</span></a></span></span><span> </span><span id="local-6989586621679399695"><span class="annot"><span class="annottext">IpePage r
</span><a href="#local-6989586621679399695"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IpePage r
</span><a href="#local-6989586621679399695"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">IpePage r
-&gt; Getting
     (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
     (IpePage r)
     (g :+ Attributes' r (AttributesOf (DefaultFromIpe g)))
-&gt; [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.6.4/lens-5.2.3-4a4b4b6212e65388c2ef0b20b55f9d73fc2078c39850450f6654fd6d7cc624b5/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">([IpeObject r]
 -&gt; Const
      (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
      [IpeObject r])
-&gt; IpePage r
-&gt; Const
     (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
     (IpePage r)
forall r1 r2 (f :: * -&gt; *).
Functor f =&gt;
([IpeObject r1] -&gt; f [IpeObject r2])
-&gt; IpePage r1 -&gt; f (IpePage r2)
</span><a href="Ipe.Types.html#content"><span class="hs-identifier hs-var">content</span></a></span><span class="annot"><span class="annottext">(([IpeObject r]
  -&gt; Const
       (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
       [IpeObject r])
 -&gt; IpePage r
 -&gt; Const
      (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
      (IpePage r))
-&gt; (((g :+ Attributes' r (AttributesOf (DefaultFromIpe g)))
     -&gt; Const
          (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
          (g :+ Attributes' r (AttributesOf (DefaultFromIpe g))))
    -&gt; [IpeObject r]
    -&gt; Const
         (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
         [IpeObject r])
-&gt; Getting
     (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
     (IpePage r)
     (g :+ Attributes' r (AttributesOf (DefaultFromIpe g)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(IpeObject r
 -&gt; Const
      (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
      (IpeObject r))
-&gt; [IpeObject r]
-&gt; Const
     (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
     [IpeObject r]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span class="annot"><span class="annottext">((IpeObject r
  -&gt; Const
       (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
       (IpeObject r))
 -&gt; [IpeObject r]
 -&gt; Const
      (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
      [IpeObject r])
-&gt; (((g :+ Attributes' r (AttributesOf (DefaultFromIpe g)))
     -&gt; Const
          (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
          (g :+ Attributes' r (AttributesOf (DefaultFromIpe g))))
    -&gt; IpeObject r
    -&gt; Const
         (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
         (IpeObject r))
-&gt; ((g :+ Attributes' r (AttributesOf (DefaultFromIpe g)))
    -&gt; Const
         (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
         (g :+ Attributes' r (AttributesOf (DefaultFromIpe g))))
-&gt; [IpeObject r]
-&gt; Const
     (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
     [IpeObject r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((g :+ Attributes' r (AttributesOf (DefaultFromIpe g)))
 -&gt; Const
      (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
      (g :+ Attributes' r (AttributesOf (DefaultFromIpe g))))
-&gt; IpeObject r
-&gt; Const
     (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
     (IpeObject r)
((g :+ IpeAttributes (DefaultFromIpe g) (NumType g))
 -&gt; Const
      (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
      (g :+ IpeAttributes (DefaultFromIpe g) (NumType g)))
-&gt; IpeObject (NumType g)
-&gt; Const
     (Endo [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
     (IpeObject (NumType g))
forall r.
(r ~ NumType g) =&gt;
Prism' (IpeObject r) (g :+ IpeAttributes (DefaultFromIpe g) r)
forall g r.
(HasDefaultFromIpe g, r ~ NumType g) =&gt;
Prism' (IpeObject r) (g :+ IpeAttributes (DefaultFromIpe g) r)
Prism'
  (IpeObject (NumType g))
  (g :+ IpeAttributes (DefaultFromIpe g) (NumType g))
</span><a href="Ipe.FromIpe.html#defaultFromIpe"><span class="hs-identifier hs-var">defaultFromIpe</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- | Convenience function from reading all g's from an ipe file. If there</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- is an error reading or parsing the file the error is &quot;thrown away&quot;.</span><span>
</span><span id="line-300"></span><span class="annot"><a href="Ipe.FromIpe.html#readAllFrom"><span class="hs-identifier hs-type">readAllFrom</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679398187"><span class="annot"><a href="#local-6989586621679398187"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679398188"><span class="annot"><a href="#local-6989586621679398188"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.FromIpe.html#HasDefaultFromIpe"><span class="hs-identifier hs-type">HasDefaultFromIpe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398187"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679398188"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-1.0.0.0/l/vector/doc/html/hgeometry/src/HGeometry.Properties.html#NumType"><span class="hs-identifier hs-type">NumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398187"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Ipe.PathParser.html#Coordinate"><span class="hs-identifier hs-type">Coordinate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679398188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OsPath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679398187"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.6.4/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="Ipe.Content.html#IpeAttributes"><span class="hs-identifier hs-type">IpeAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Ipe.FromIpe.html#DefaultFromIpe"><span class="hs-identifier hs-type">DefaultFromIpe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679398187"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679398188"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span id="readAllFrom"><span class="annot"><span class="annottext">readAllFrom :: forall g r.
(HasDefaultFromIpe g, r ~ NumType g, Coordinate r, Eq r) =&gt;
OsPath -&gt; IO [g :+ IpeAttributes (DefaultFromIpe g) r]
</span><a href="Ipe.FromIpe.html#readAllFrom"><span class="hs-identifier hs-var hs-var">readAllFrom</span></a></span></span><span> </span><span id="local-6989586621679399713"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679399713"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IpePage (NumType g)
 -&gt; [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
-&gt; Either Text (IpePage (NumType g))
-&gt; [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))]
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Either Text a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">IpePage (NumType g)
-&gt; [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))]
IpePage (NumType g)
-&gt; [g :+ IpeAttributes (DefaultFromIpe g) (NumType g)]
forall g r.
(HasDefaultFromIpe g, r ~ NumType g) =&gt;
IpePage r -&gt; [g :+ IpeAttributes (DefaultFromIpe g) r]
</span><a href="Ipe.FromIpe.html#readAll"><span class="hs-identifier hs-var">readAll</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Text (IpePage (NumType g))
 -&gt; [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))])
-&gt; IO (Either Text (IpePage (NumType g)))
-&gt; IO [g :+ Attributes' r (AttributesOf (DefaultFromIpe g))]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; IO (Either Text (IpePage (NumType g)))
forall r.
(Coordinate r, Eq r) =&gt;
OsPath -&gt; IO (Either Text (IpePage r))
</span><a href="Ipe.Reader.html#readSinglePageFile"><span class="hs-identifier hs-var">readSinglePageFile</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679399713"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span id="local-6989586621679397829"><span class="annot"><a href="Ipe.FromIpe.html#fromSingleton"><span class="hs-identifier hs-type">fromSingleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679397829"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679397829"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-305"></span><span id="fromSingleton"><span class="annot"><span class="annottext">fromSingleton :: forall a. a -&gt; Seq a
</span><a href="Ipe.FromIpe.html#fromSingleton"><span class="hs-identifier hs-var hs-var">fromSingleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Seq a
forall a. a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.singleton</span></span><span>
</span><span id="line-306"></span></pre></body></html>