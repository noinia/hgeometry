<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | This module provides a 'FieldGrammarParser', one way to parse</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- @.cabal@ -like files.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Fields can be specified multiple times in the .cabal files.  The order of</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- such entries is important, but the mutual ordering of different fields is</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- not.Also conditional sections are considered after non-conditional data.</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- The example of this silent-commutation quirk is the fact that</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- buildable: True</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- if os(linux)</span><span>
</span><span id="line-17"></span><span class="hs-comment">--   buildable: False</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- if os(linux)</span><span>
</span><span id="line-24"></span><span class="hs-comment">--   buildable: False</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- buildable: True</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- behave the same! This is the limitation of 'GeneralPackageDescription'</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- structure.</span><span>
</span><span id="line-30"></span><span class="hs-comment">--</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- So we transform the list of fields @['Field' ann]@ into</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- a map of grouped ordinary fields and a list of lists of sections:</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- @'Fields' ann = 'Map' 'FieldName' ['NamelessField' ann]@ and @[['Section' ann]]@.</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- We need list of list of sections, because we need to distinguish situations</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- where there are fields in between. For example</span><span>
</span><span id="line-37"></span><span class="hs-comment">--</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- if flag(bytestring-lt-0_10_4)</span><span>
</span><span id="line-40"></span><span class="hs-comment">--   build-depends: bytestring &lt; 0.10.4</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- default-language: Haskell2020</span><span>
</span><span id="line-43"></span><span class="hs-comment">--</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- else</span><span>
</span><span id="line-45"></span><span class="hs-comment">--   build-depends: bytestring &gt;= 0.10.4</span><span>
</span><span id="line-46"></span><span class="hs-comment">--</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- is obviously invalid specification.</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- We can parse 'Fields' like we parse @aeson@ objects, yet we use</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- slightly higher-level API, so we can process unspecified fields,</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- to report unknown fields and save custom @x-fields@.</span><span>
</span><span id="line-54"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html"><span class="hs-identifier">Distribution.FieldGrammar.Parsec</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFieldGrammar"><span class="hs-identifier">ParsecFieldGrammar</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#parseFieldGrammar"><span class="hs-identifier">parseFieldGrammar</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarKnownFieldList"><span class="hs-identifier">fieldGrammarKnownFieldList</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Auxiliary</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#Fields"><span class="hs-identifier">Fields</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#NamelessField"><span class="hs-identifier">NamelessField</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#namelessFieldAnn"><span class="hs-identifier">namelessFieldAnn</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#Section"><span class="hs-identifier">Section</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser"><span class="hs-identifier">runFieldParser</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser%27"><span class="hs-identifier">runFieldParser'</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldLinesToStream"><span class="hs-identifier">fieldLinesToStream</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Compat.Newtype.html"><span class="hs-identifier">Distribution.Compat.Newtype</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Compat.Prelude.html"><span class="hs-identifier">Distribution.Compat.Prelude</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Utils.Generic.html"><span class="hs-identifier">Distribution.Utils.Generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Utils.Generic.html#fromUTF8BS"><span class="hs-identifier">fromUTF8BS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Utils.String.html"><span class="hs-identifier">Distribution.Utils.String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Utils.String.html#trim"><span class="hs-identifier">trim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Distribution.Utils.ShortText.html"><span class="hs-identifier">Distribution.Utils.ShortText</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ShortText</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.html"><span class="hs-identifier">Text.Parsec</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Error.html"><span class="hs-identifier">Text.Parsec.Error</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.CabalSpecVersion.html"><span class="hs-identifier">Distribution.CabalSpecVersion</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Class.html"><span class="hs-identifier">Distribution.FieldGrammar.Class</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Fields.Field.html"><span class="hs-identifier">Distribution.Fields.Field</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Fields.ParseResult.html"><span class="hs-identifier">Distribution.Fields.ParseResult</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Parsec.html"><span class="hs-identifier">Distribution.Parsec</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Parsec.FieldLineStream.html"><span class="hs-identifier">Distribution.Parsec.FieldLineStream</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html"><span class="hs-identifier">Distribution.Parsec.Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Parsec.Position.html#positionCol"><span class="hs-identifier">positionCol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#positionRow"><span class="hs-identifier">positionRow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- Auxiliary types</span><span>
</span><span id="line-93"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">type</span><span> </span><span id="Fields"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#Fields"><span class="hs-identifier hs-var">Fields</span></a></span></span><span> </span><span id="local-6989586621679550884"><span class="annot"><a href="#local-6989586621679550884"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="Distribution.Fields.Field.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#NamelessField"><span class="hs-identifier hs-type">NamelessField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550884"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><span class="hs-comment">-- | Single field, without name, but with its annotation.</span></span><span>
</span><span id="line-98"></span><span class="hs-keyword">data</span><span> </span><span id="NamelessField"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#NamelessField"><span class="hs-identifier hs-var">NamelessField</span></a></span></span><span> </span><span id="local-6989586621679550885"><span class="annot"><a href="#local-6989586621679550885"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkNamelessField"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-var">MkNamelessField</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679550885"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550885"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679550889"><span id="local-6989586621679550895"><span class="annot"><span class="annottext">NamelessField ann -&gt; NamelessField ann -&gt; Bool
(NamelessField ann -&gt; NamelessField ann -&gt; Bool)
-&gt; (NamelessField ann -&gt; NamelessField ann -&gt; Bool)
-&gt; Eq (NamelessField ann)
forall ann.
Eq ann =&gt;
NamelessField ann -&gt; NamelessField ann -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall ann.
Eq ann =&gt;
NamelessField ann -&gt; NamelessField ann -&gt; Bool
== :: NamelessField ann -&gt; NamelessField ann -&gt; Bool
$c/= :: forall ann.
Eq ann =&gt;
NamelessField ann -&gt; NamelessField ann -&gt; Bool
/= :: NamelessField ann -&gt; NamelessField ann -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679550902"><span id="local-6989586621679550910"><span id="local-6989586621679550914"><span class="annot"><span class="annottext">Int -&gt; NamelessField ann -&gt; ShowS
[NamelessField ann] -&gt; ShowS
NamelessField ann -&gt; [Char]
(Int -&gt; NamelessField ann -&gt; ShowS)
-&gt; (NamelessField ann -&gt; [Char])
-&gt; ([NamelessField ann] -&gt; ShowS)
-&gt; Show (NamelessField ann)
forall ann. Show ann =&gt; Int -&gt; NamelessField ann -&gt; ShowS
forall ann. Show ann =&gt; [NamelessField ann] -&gt; ShowS
forall ann. Show ann =&gt; NamelessField ann -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall ann. Show ann =&gt; Int -&gt; NamelessField ann -&gt; ShowS
showsPrec :: Int -&gt; NamelessField ann -&gt; ShowS
$cshow :: forall ann. Show ann =&gt; NamelessField ann -&gt; [Char]
show :: NamelessField ann -&gt; [Char]
$cshowList :: forall ann. Show ann =&gt; [NamelessField ann] -&gt; ShowS
showList :: [NamelessField ann] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679550920"><span id="local-6989586621679550926"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; NamelessField a -&gt; NamelessField b)
-&gt; (forall a b. a -&gt; NamelessField b -&gt; NamelessField a)
-&gt; Functor NamelessField
forall a b. a -&gt; NamelessField b -&gt; NamelessField a
forall a b. (a -&gt; b) -&gt; NamelessField a -&gt; NamelessField b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; NamelessField a -&gt; NamelessField b
fmap :: forall a b. (a -&gt; b) -&gt; NamelessField a -&gt; NamelessField b
$c&lt;$ :: forall a b. a -&gt; NamelessField b -&gt; NamelessField a
&lt;$ :: forall a b. a -&gt; NamelessField b -&gt; NamelessField a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621679550579"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#namelessFieldAnn"><span class="hs-identifier hs-type">namelessFieldAnn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#NamelessField"><span class="hs-identifier hs-type">NamelessField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550579"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679550579"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-102"></span><span id="namelessFieldAnn"><span class="annot"><span class="annottext">namelessFieldAnn :: forall ann. NamelessField ann -&gt; ann
</span><a href="Distribution.FieldGrammar.Parsec.html#namelessFieldAnn"><span class="hs-identifier hs-var hs-var">namelessFieldAnn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679550932"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621679550932"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FieldLine ann]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621679550932"><span class="hs-identifier hs-var">ann</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><span class="hs-comment">-- | The 'Section' constructor of 'Field'.</span></span><span>
</span><span id="line-105"></span><span class="hs-keyword">data</span><span> </span><span id="Section"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#Section"><span class="hs-identifier hs-var">Section</span></a></span></span><span> </span><span id="local-6989586621679550933"><span class="annot"><a href="#local-6989586621679550933"><span class="hs-identifier hs-type">ann</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MkSection"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkSection"><span class="hs-identifier hs-var">MkSection</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Fields.Field.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550933"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#SectionArg"><span class="hs-identifier hs-type">SectionArg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550933"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#Field"><span class="hs-identifier hs-type">Field</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550933"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679550937"><span id="local-6989586621679550945"><span class="annot"><span class="annottext">Section ann -&gt; Section ann -&gt; Bool
(Section ann -&gt; Section ann -&gt; Bool)
-&gt; (Section ann -&gt; Section ann -&gt; Bool) -&gt; Eq (Section ann)
forall ann. Eq ann =&gt; Section ann -&gt; Section ann -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall ann. Eq ann =&gt; Section ann -&gt; Section ann -&gt; Bool
== :: Section ann -&gt; Section ann -&gt; Bool
$c/= :: forall ann. Eq ann =&gt; Section ann -&gt; Section ann -&gt; Bool
/= :: Section ann -&gt; Section ann -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679550952"><span id="local-6989586621679550961"><span id="local-6989586621679550965"><span class="annot"><span class="annottext">Int -&gt; Section ann -&gt; ShowS
[Section ann] -&gt; ShowS
Section ann -&gt; [Char]
(Int -&gt; Section ann -&gt; ShowS)
-&gt; (Section ann -&gt; [Char])
-&gt; ([Section ann] -&gt; ShowS)
-&gt; Show (Section ann)
forall ann. Show ann =&gt; Int -&gt; Section ann -&gt; ShowS
forall ann. Show ann =&gt; [Section ann] -&gt; ShowS
forall ann. Show ann =&gt; Section ann -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall ann. Show ann =&gt; Int -&gt; Section ann -&gt; ShowS
showsPrec :: Int -&gt; Section ann -&gt; ShowS
$cshow :: forall ann. Show ann =&gt; Section ann -&gt; [Char]
show :: Section ann -&gt; [Char]
$cshowList :: forall ann. Show ann =&gt; [Section ann] -&gt; ShowS
showList :: [Section ann] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679550970"><span id="local-6989586621679550980"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Section a -&gt; Section b)
-&gt; (forall a b. a -&gt; Section b -&gt; Section a) -&gt; Functor Section
forall a b. a -&gt; Section b -&gt; Section a
forall a b. (a -&gt; b) -&gt; Section a -&gt; Section b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Section a -&gt; Section b
fmap :: forall a b. (a -&gt; b) -&gt; Section a -&gt; Section b
$c&lt;$ :: forall a b. a -&gt; Section b -&gt; Section a
&lt;$ :: forall a b. a -&gt; Section b -&gt; Section a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- ParsecFieldGrammar</span><span>
</span><span id="line-110"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">data</span><span> </span><span id="ParsecFieldGrammar"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFieldGrammar"><span class="hs-identifier hs-var">ParsecFieldGrammar</span></a></span></span><span> </span><span id="local-6989586621679550595"><span class="annot"><a href="#local-6989586621679550595"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679550596"><span class="annot"><a href="#local-6989586621679550596"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ParsecFG"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="fieldGrammarKnownFields"><span class="annot"><span class="annottext">forall s a. ParsecFieldGrammar s a -&gt; Set FieldName
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarKnownFields"><span class="hs-identifier hs-var hs-var">fieldGrammarKnownFields</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Distribution.Fields.Field.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fieldGrammarKnownPrefixes"><span class="annot"><span class="annottext">forall s a. ParsecFieldGrammar s a -&gt; Set FieldName
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarKnownPrefixes"><span class="hs-identifier hs-var hs-var">fieldGrammarKnownPrefixes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="Distribution.Fields.Field.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="fieldGrammarParser"><span class="annot"><span class="annottext">forall s a.
ParsecFieldGrammar s a
-&gt; CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarParser"><span class="hs-identifier hs-var hs-var">fieldGrammarParser</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.CabalSpecVersion.html#CabalSpecVersion"><span class="hs-identifier hs-type">CabalSpecVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#Fields"><span class="hs-identifier hs-type">Fields</span></a></span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Fields.ParseResult.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679550992"><span id="local-6989586621679550996"><span class="annot"><span class="annottext">(forall a b.
 (a -&gt; b) -&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s b)
-&gt; (forall a b.
    a -&gt; ParsecFieldGrammar s b -&gt; ParsecFieldGrammar s a)
-&gt; Functor (ParsecFieldGrammar s)
forall a b. a -&gt; ParsecFieldGrammar s b -&gt; ParsecFieldGrammar s a
forall a b.
(a -&gt; b) -&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s b
forall s a b. a -&gt; ParsecFieldGrammar s b -&gt; ParsecFieldGrammar s a
forall s a b.
(a -&gt; b) -&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall s a b.
(a -&gt; b) -&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s b
fmap :: forall a b.
(a -&gt; b) -&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s b
$c&lt;$ :: forall s a b. a -&gt; ParsecFieldGrammar s b -&gt; ParsecFieldGrammar s a
&lt;$ :: forall a b. a -&gt; ParsecFieldGrammar s b -&gt; ParsecFieldGrammar s a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span id="local-6989586621679550610"><span id="local-6989586621679550611"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#parseFieldGrammar"><span class="hs-identifier hs-type">parseFieldGrammar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.CabalSpecVersion.html#CabalSpecVersion"><span class="hs-identifier hs-type">CabalSpecVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#Fields"><span class="hs-identifier hs-type">Fields</span></a></span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFieldGrammar"><span class="hs-identifier hs-type">ParsecFieldGrammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550610"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550611"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Fields.ParseResult.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550611"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-120"></span><span id="parseFieldGrammar"><span class="annot"><span class="annottext">parseFieldGrammar :: forall s a.
CabalSpecVersion
-&gt; Fields Position -&gt; ParsecFieldGrammar s a -&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#parseFieldGrammar"><span class="hs-identifier hs-var hs-var">parseFieldGrammar</span></a></span></span><span> </span><span id="local-6989586621679551006"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551006"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551007"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551007"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679551008"><span class="annot"><span class="annottext">ParsecFieldGrammar s a
</span><a href="#local-6989586621679551008"><span class="hs-identifier hs-var">grammar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">[(FieldName, [NamelessField Position])]
-&gt; ((FieldName, [NamelessField Position]) -&gt; ParseResult ())
-&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fields Position -&gt; [(FieldName, [NamelessField Position])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldName -&gt; [NamelessField Position] -&gt; Bool)
-&gt; Fields Position -&gt; Fields Position
forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#filterWithKey"><span class="hs-identifier hs-var">Map.filterWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [NamelessField Position] -&gt; Bool
forall {p}. FieldName -&gt; p -&gt; Bool
</span><a href="#local-6989586621679551012"><span class="hs-identifier hs-var">isUnknownField</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551007"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((FieldName, [NamelessField Position]) -&gt; ParseResult ())
 -&gt; ParseResult ())
-&gt; ((FieldName, [NamelessField Position]) -&gt; ParseResult ())
-&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679551013"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551013"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551014"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551014"><span class="hs-identifier hs-var">nfields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><span class="annottext">[NamelessField Position]
-&gt; (NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551014"><span class="hs-identifier hs-var">nfields</span></a></span><span> </span><span class="annot"><span class="annottext">((NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ())
-&gt; (NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551015"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551015"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-123"></span><span>      </span><span class="annot"><span class="annottext">Position -&gt; PWarnType -&gt; [Char] -&gt; ParseResult ()
</span><a href="Distribution.Fields.ParseResult.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551015"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">PWarnType
</span><a href="Distribution.Parsec.Warning.html#PWTUnknownField"><span class="hs-identifier hs-var">PWTUnknownField</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult ()) -&gt; [Char] -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unknown field: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551013"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-comment">-- TODO: fields allowed in this section</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">-- parse</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">ParsecFieldGrammar s a
-&gt; CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
forall s a.
ParsecFieldGrammar s a
-&gt; CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarParser"><span class="hs-identifier hs-var">fieldGrammarParser</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecFieldGrammar s a
</span><a href="#local-6989586621679551008"><span class="hs-identifier hs-var">grammar</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551006"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551007"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679551012"><span class="annot"><span class="annottext">isUnknownField :: FieldName -&gt; p -&gt; Bool
</span><a href="#local-6989586621679551012"><span class="hs-identifier hs-var hs-var">isUnknownField</span></a></span></span><span> </span><span id="local-6989586621679551023"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551023"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551023"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#member"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecFieldGrammar s a -&gt; Set FieldName
forall s a. ParsecFieldGrammar s a -&gt; Set FieldName
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarKnownFields"><span class="hs-identifier hs-var">fieldGrammarKnownFields</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecFieldGrammar s a
</span><a href="#local-6989586621679551008"><span class="hs-identifier hs-var">grammar</span></a></span><span>
</span><span id="line-132"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; Bool) -&gt; Set FieldName -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; FieldName -&gt; Bool
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#isPrefixOf"><span class="hs-operator hs-var">`BS.isPrefixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551023"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecFieldGrammar s a -&gt; Set FieldName
forall s a. ParsecFieldGrammar s a -&gt; Set FieldName
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarKnownPrefixes"><span class="hs-identifier hs-var">fieldGrammarKnownPrefixes</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecFieldGrammar s a
</span><a href="#local-6989586621679551008"><span class="hs-identifier hs-var">grammar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621679550633"><span id="local-6989586621679550634"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarKnownFieldList"><span class="hs-identifier hs-type">fieldGrammarKnownFieldList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFieldGrammar"><span class="hs-identifier hs-type">ParsecFieldGrammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550633"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550634"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-135"></span><span id="fieldGrammarKnownFieldList"><span class="annot"><span class="annottext">fieldGrammarKnownFieldList :: forall s a. ParsecFieldGrammar s a -&gt; [FieldName]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarKnownFieldList"><span class="hs-identifier hs-var hs-var">fieldGrammarKnownFieldList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName -&gt; [FieldName]
forall a. Set a -&gt; [a]
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Set FieldName -&gt; [FieldName])
-&gt; (ParsecFieldGrammar s a -&gt; Set FieldName)
-&gt; ParsecFieldGrammar s a
-&gt; [FieldName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ParsecFieldGrammar s a -&gt; Set FieldName
forall s a. ParsecFieldGrammar s a -&gt; Set FieldName
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldGrammarKnownFields"><span class="hs-identifier hs-var">fieldGrammarKnownFields</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679550653"><span id="local-6989586621679551036"><span id="local-6989586621679551040"><span id="local-6989586621679551043"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFieldGrammar"><span class="hs-identifier hs-type">ParsecFieldGrammar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550653"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679551051"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; ParsecFieldGrammar s a
</span><span class="hs-identifier hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621679551052"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551052"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">CabalSpecVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; ParseResult a
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551052"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><span class="hs-pragma hs-type">pure</span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-type">ParsecFG</span></a></span><span> </span><span id="local-6989586621679551057"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551057"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679551058"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551058"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621679551059"><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult (a -&gt; b)
</span><a href="#local-6989586621679551059"><span class="hs-identifier hs-var">f''</span></a></span></span><span> </span><span id="local-6989586621679551060"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b.
ParsecFieldGrammar s (a -&gt; b)
-&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s b
</span><span class="hs-operator hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-type">ParsecFG</span></a></span><span> </span><span id="local-6989586621679551061"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551061"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679551062"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551062"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679551063"><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551063"><span class="hs-identifier hs-var">x''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult b)
-&gt; ParsecFieldGrammar s b
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set FieldName -&gt; Set FieldName -&gt; Set FieldName
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551057"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551061"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set FieldName -&gt; Set FieldName -&gt; Set FieldName
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551058"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551062"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679551064"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551064"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551065"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551065"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult (a -&gt; b)
</span><a href="#local-6989586621679551059"><span class="hs-identifier hs-var">f''</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551064"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551065"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">ParseResult (a -&gt; b) -&gt; ParseResult a -&gt; ParseResult b
forall a b. ParseResult (a -&gt; b) -&gt; ParseResult a -&gt; ParseResult b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551063"><span class="hs-identifier hs-var">x''</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551064"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551065"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;*&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-type">warnMultipleSingularFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Fields.Field.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#NamelessField"><span class="hs-identifier hs-type">NamelessField</span></a></span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Fields.ParseResult.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span id="warnMultipleSingularFields"><span class="annot"><span class="annottext">warnMultipleSingularFields :: FieldName -&gt; [NamelessField Position] -&gt; ParseResult ()
</span><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var hs-var">warnMultipleSingularFields</span></a></span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; ParseResult ()
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var">warnMultipleSingularFields</span></a></span><span> </span><span id="local-6989586621679551067"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551067"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679551068"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551068"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551069"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551069"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551070"><span class="annot"><span class="annottext">pos :: Position
</span><a href="#local-6989586621679551070"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamelessField Position -&gt; Position
forall ann. NamelessField ann -&gt; ann
</span><a href="Distribution.FieldGrammar.Parsec.html#namelessFieldAnn"><span class="hs-identifier hs-var">namelessFieldAnn</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551068"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-152"></span><span>      </span><span id="local-6989586621679551071"><span class="annot"><span class="annottext">poss :: [Position]
</span><a href="#local-6989586621679551071"><span class="hs-identifier hs-var hs-var">poss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; Position)
-&gt; [NamelessField Position] -&gt; [Position]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamelessField Position -&gt; Position
forall ann. NamelessField ann -&gt; ann
</span><a href="Distribution.FieldGrammar.Parsec.html#namelessFieldAnn"><span class="hs-identifier hs-var">namelessFieldAnn</span></a></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551069"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="annot"><span class="annottext">Position -&gt; PWarnType -&gt; [Char] -&gt; ParseResult ()
</span><a href="Distribution.Fields.ParseResult.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551070"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">PWarnType
</span><a href="Distribution.Parsec.Warning.html#PWTMultipleSingularField"><span class="hs-identifier hs-var">PWTMultipleSingularField</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult ()) -&gt; [Char] -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The field &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551067"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is specified more than once at positions &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Position -&gt; [Char]) -&gt; [Position] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; [Char]
</span><a href="Distribution.Parsec.Position.html#showPos"><span class="hs-identifier hs-var">showPos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551070"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; [Position] -&gt; [Position]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679551071"><span class="hs-identifier hs-var">poss</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Class.html#FieldGrammar"><span class="hs-identifier hs-type">FieldGrammar</span></a></span><span> </span><span class="annot"><a href="Distribution.Parsec.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFieldGrammar"><span class="hs-identifier hs-type">ParsecFieldGrammar</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679551111"><span class="annot"><span class="annottext">blurFieldGrammar :: forall a b d.
ALens' a b -&gt; ParsecFieldGrammar b d -&gt; ParsecFieldGrammar a d
</span><a href="#local-6989586621679551111"><span class="hs-identifier hs-var hs-var hs-var">blurFieldGrammar</span></a></span></span><span> </span><span class="annot"><span class="annottext">ALens' a b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-type">ParsecFG</span></a></span><span> </span><span id="local-6989586621679551113"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551113"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679551114"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551114"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span id="local-6989586621679551115"><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult d
</span><a href="#local-6989586621679551115"><span class="hs-identifier hs-var">parser</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult d)
-&gt; ParsecFieldGrammar a d
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551113"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551114"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult d
</span><a href="#local-6989586621679551115"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621679551118"><span class="annot"><span class="annottext">uniqueFieldAla :: forall b a s.
(Parsec b, Newtype a b) =&gt;
FieldName -&gt; (a -&gt; b) -&gt; ALens' s a -&gt; ParsecFieldGrammar s a
</span><a href="#local-6989586621679551118"><span class="hs-identifier hs-var hs-var hs-var">uniqueFieldAla</span></a></span></span><span> </span><span id="local-6989586621679551120"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551120"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679551121"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679551121"><span class="hs-identifier hs-var">_pack</span></a></span></span><span> </span><span id="local-6989586621679551122"><span class="annot"><span class="annottext">ALens' s a
</span><a href="#local-6989586621679551122"><span class="hs-identifier hs-var">_extract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551120"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551125"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>      </span><span id="local-6989586621679551125"><span class="annot"><span class="annottext">parser :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551125"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551134"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551134"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551135"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551135"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Fields Position -&gt; Maybe [NamelessField Position]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551120"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551135"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">Maybe [NamelessField Position]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Position -&gt; [Char] -&gt; ParseResult a
forall a. Position -&gt; [Char] -&gt; ParseResult a
</span><a href="Distribution.Fields.ParseResult.html#parseFatalFailure"><span class="hs-identifier hs-var">parseFatalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="Distribution.Parsec.Position.html#zeroPos"><span class="hs-identifier hs-var">zeroPos</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult a) -&gt; [Char] -&gt; ParseResult a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551120"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; field missing&quot;</span></span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Position -&gt; [Char] -&gt; ParseResult a
forall a. Position -&gt; [Char] -&gt; ParseResult a
</span><a href="Distribution.Fields.ParseResult.html#parseFatalFailure"><span class="hs-identifier hs-var">parseFatalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="Distribution.Parsec.Position.html#zeroPos"><span class="hs-identifier hs-var">zeroPos</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult a) -&gt; [Char] -&gt; ParseResult a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551120"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; field missing&quot;</span></span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679551139"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551139"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551140"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551134"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551139"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679551141"><span class="annot"><span class="annottext">xs :: [NamelessField Position]
</span><a href="#local-6989586621679551141"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551142"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551142"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551143"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551143"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; [NamelessField Position] -&gt; ParseResult ()
</span><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var">warnMultipleSingularFields</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551120"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551141"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-167"></span><span>          </span><span class="annot"><span class="annottext">NonEmpty a -&gt; a
forall a. NonEmpty a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#last"><span class="hs-identifier hs-var">NE.last</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty a -&gt; a) -&gt; ParseResult (NonEmpty a) -&gt; ParseResult a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; ParseResult a)
-&gt; NonEmpty (NamelessField Position) -&gt; ParseResult (NonEmpty a)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551140"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551134"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551142"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
-&gt; [NamelessField Position] -&gt; NonEmpty (NamelessField Position)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551143"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>      </span><span id="local-6989586621679551140"><span class="annot"><span class="annottext">parseOne :: CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551140"><span class="hs-identifier hs-var hs-var">parseOne</span></a></span></span><span> </span><span id="local-6989586621679551153"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551153"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551154"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551154"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551155"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551155"><span class="hs-identifier hs-var">fls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; b -&gt; a
forall o n. Newtype o n =&gt; (o -&gt; n) -&gt; n -&gt; o
</span><a href="Distribution.Compat.Newtype.html#unpack%27"><span class="hs-identifier hs-var">unpack'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679551121"><span class="hs-identifier hs-var">_pack</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; a) -&gt; ParseResult b -&gt; ParseResult a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Position
-&gt; ParsecParser b
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult b
forall a.
Position
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser"><span class="hs-identifier hs-var">runFieldParser</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551154"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecParser b
forall a (m :: * -&gt; *). (Parsec a, CabalParsing m) =&gt; m a
forall (m :: * -&gt; *). CabalParsing m =&gt; m b
</span><a href="Distribution.Parsec.html#parsec"><span class="hs-identifier hs-var">parsec</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551153"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551155"><span class="hs-identifier hs-var">fls</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679551158"><span class="annot"><span class="annottext">booleanFieldDef :: forall s.
FieldName -&gt; ALens' s Bool -&gt; Bool -&gt; ParsecFieldGrammar s Bool
</span><a href="#local-6989586621679551158"><span class="hs-identifier hs-var hs-var hs-var">booleanFieldDef</span></a></span></span><span> </span><span id="local-6989586621679551160"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551160"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679551161"><span class="annot"><span class="annottext">ALens' s Bool
</span><a href="#local-6989586621679551161"><span class="hs-identifier hs-var">_extract</span></a></span></span><span> </span><span id="local-6989586621679551162"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679551162"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult Bool)
-&gt; ParsecFieldGrammar s Bool
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551160"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult Bool
</span><a href="#local-6989586621679551163"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621679551163"><span class="annot"><span class="annottext">parser :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult Bool
</span><a href="#local-6989586621679551163"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551174"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551174"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551175"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551175"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Fields Position -&gt; Maybe [NamelessField Position]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551160"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551175"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">Maybe [NamelessField Position]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ParseResult Bool
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679551162"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ParseResult Bool
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679551162"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679551176"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551176"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult Bool
forall {a}.
Parsec a =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551177"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551174"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551176"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679551178"><span class="annot"><span class="annottext">xs :: [NamelessField Position]
</span><a href="#local-6989586621679551178"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551179"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551179"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551180"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551180"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; [NamelessField Position] -&gt; ParseResult ()
</span><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var">warnMultipleSingularFields</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551160"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551178"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-180"></span><span>          </span><span class="annot"><span class="annottext">NonEmpty Bool -&gt; Bool
forall a. NonEmpty a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#last"><span class="hs-identifier hs-var">NE.last</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Bool -&gt; Bool)
-&gt; ParseResult (NonEmpty Bool) -&gt; ParseResult Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; ParseResult Bool)
-&gt; NonEmpty (NamelessField Position) -&gt; ParseResult (NonEmpty Bool)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult Bool
forall {a}.
Parsec a =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551177"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551174"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551179"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
-&gt; [NamelessField Position] -&gt; NonEmpty (NamelessField Position)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551180"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>      </span><span id="local-6989586621679551177"><span class="annot"><span class="annottext">parseOne :: CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551177"><span class="hs-identifier hs-var hs-var">parseOne</span></a></span></span><span> </span><span id="local-6989586621679551184"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551184"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551185"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551185"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551186"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551186"><span class="hs-identifier hs-var">fls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult a
forall a.
Position
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser"><span class="hs-identifier hs-var">runFieldParser</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551185"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecParser a
forall a (m :: * -&gt; *). (Parsec a, CabalParsing m) =&gt; m a
forall (m :: * -&gt; *). CabalParsing m =&gt; m a
</span><a href="Distribution.Parsec.html#parsec"><span class="hs-identifier hs-var">parsec</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551184"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551186"><span class="hs-identifier hs-var">fls</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679551189"><span class="annot"><span class="annottext">optionalFieldAla :: forall b a s.
(Parsec b, Newtype a b) =&gt;
FieldName
-&gt; (a -&gt; b) -&gt; ALens' s (Maybe a) -&gt; ParsecFieldGrammar s (Maybe a)
</span><a href="#local-6989586621679551189"><span class="hs-identifier hs-var hs-var hs-var">optionalFieldAla</span></a></span></span><span> </span><span id="local-6989586621679551191"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551191"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679551192"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679551192"><span class="hs-identifier hs-var">_pack</span></a></span></span><span> </span><span id="local-6989586621679551193"><span class="annot"><span class="annottext">ALens' s (Maybe a)
</span><a href="#local-6989586621679551193"><span class="hs-identifier hs-var">_extract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult (Maybe a))
-&gt; ParsecFieldGrammar s (Maybe a)
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551191"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult (Maybe a)
</span><a href="#local-6989586621679551194"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>      </span><span id="local-6989586621679551194"><span class="annot"><span class="annottext">parser :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult (Maybe a)
</span><a href="#local-6989586621679551194"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551202"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551202"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551203"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551203"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Fields Position -&gt; Maybe [NamelessField Position]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551191"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551203"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="annottext">Maybe [NamelessField Position]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; ParseResult (Maybe a)
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; ParseResult (Maybe a)
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679551204"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551204"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult (Maybe a)
</span><a href="#local-6989586621679551205"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551202"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551204"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679551206"><span class="annot"><span class="annottext">xs :: [NamelessField Position]
</span><a href="#local-6989586621679551206"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551207"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551207"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551208"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551208"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; [NamelessField Position] -&gt; ParseResult ()
</span><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var">warnMultipleSingularFields</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551191"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551206"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-192"></span><span>          </span><span class="annot"><span class="annottext">NonEmpty (Maybe a) -&gt; Maybe a
forall a. NonEmpty a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#last"><span class="hs-identifier hs-var">NE.last</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Maybe a) -&gt; Maybe a)
-&gt; ParseResult (NonEmpty (Maybe a)) -&gt; ParseResult (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; ParseResult (Maybe a))
-&gt; NonEmpty (NamelessField Position)
-&gt; ParseResult (NonEmpty (Maybe a))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult (Maybe a)
</span><a href="#local-6989586621679551205"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551202"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551207"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
-&gt; [NamelessField Position] -&gt; NonEmpty (NamelessField Position)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551208"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>      </span><span id="local-6989586621679551205"><span class="annot"><span class="annottext">parseOne :: CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult (Maybe a)
</span><a href="#local-6989586621679551205"><span class="hs-identifier hs-var hs-var">parseOne</span></a></span></span><span> </span><span id="local-6989586621679551215"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551215"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551216"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551216"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551217"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551217"><span class="hs-identifier hs-var">fls</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldLine Position] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551217"><span class="hs-identifier hs-var">fls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; ParseResult (Maybe a)
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; (b -&gt; a) -&gt; b -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; b -&gt; a
forall o n. Newtype o n =&gt; (o -&gt; n) -&gt; n -&gt; o
</span><a href="Distribution.Compat.Newtype.html#unpack%27"><span class="hs-identifier hs-var">unpack'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679551192"><span class="hs-identifier hs-var">_pack</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Maybe a) -&gt; ParseResult b -&gt; ParseResult (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Position
-&gt; ParsecParser b
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult b
forall a.
Position
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser"><span class="hs-identifier hs-var">runFieldParser</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551216"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecParser b
forall a (m :: * -&gt; *). (Parsec a, CabalParsing m) =&gt; m a
forall (m :: * -&gt; *). CabalParsing m =&gt; m b
</span><a href="Distribution.Parsec.html#parsec"><span class="hs-identifier hs-var">parsec</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551215"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551217"><span class="hs-identifier hs-var">fls</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679551222"><span class="annot"><span class="annottext">optionalFieldDefAla :: forall b a s.
(Parsec b, Newtype a b, Eq a) =&gt;
FieldName -&gt; (a -&gt; b) -&gt; ALens' s a -&gt; a -&gt; ParsecFieldGrammar s a
</span><a href="#local-6989586621679551222"><span class="hs-identifier hs-var hs-var hs-var">optionalFieldDefAla</span></a></span></span><span> </span><span id="local-6989586621679551224"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551224"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679551225"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679551225"><span class="hs-identifier hs-var">_pack</span></a></span></span><span> </span><span id="local-6989586621679551226"><span class="annot"><span class="annottext">ALens' s a
</span><a href="#local-6989586621679551226"><span class="hs-identifier hs-var">_extract</span></a></span></span><span> </span><span id="local-6989586621679551227"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551227"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551224"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551228"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>      </span><span id="local-6989586621679551228"><span class="annot"><span class="annottext">parser :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551228"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551236"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551236"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551237"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551237"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Fields Position -&gt; Maybe [NamelessField Position]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551224"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551237"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">Maybe [NamelessField Position]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; ParseResult a
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551227"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; ParseResult a
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551227"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679551238"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551238"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551239"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551236"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551238"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679551240"><span class="annot"><span class="annottext">xs :: [NamelessField Position]
</span><a href="#local-6989586621679551240"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551241"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551241"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551242"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551242"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-205"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; [NamelessField Position] -&gt; ParseResult ()
</span><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var">warnMultipleSingularFields</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551224"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551240"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-206"></span><span>          </span><span class="annot"><span class="annottext">NonEmpty a -&gt; a
forall a. NonEmpty a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#last"><span class="hs-identifier hs-var">NE.last</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty a -&gt; a) -&gt; ParseResult (NonEmpty a) -&gt; ParseResult a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; ParseResult a)
-&gt; NonEmpty (NamelessField Position) -&gt; ParseResult (NonEmpty a)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551239"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551236"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551241"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
-&gt; [NamelessField Position] -&gt; NonEmpty (NamelessField Position)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551242"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>      </span><span id="local-6989586621679551239"><span class="annot"><span class="annottext">parseOne :: CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551239"><span class="hs-identifier hs-var hs-var">parseOne</span></a></span></span><span> </span><span id="local-6989586621679551249"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551249"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551250"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551250"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551251"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551251"><span class="hs-identifier hs-var">fls</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldLine Position] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551251"><span class="hs-identifier hs-var">fls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ParseResult a
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551227"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; b -&gt; a
forall o n. Newtype o n =&gt; (o -&gt; n) -&gt; n -&gt; o
</span><a href="Distribution.Compat.Newtype.html#unpack%27"><span class="hs-identifier hs-var">unpack'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679551225"><span class="hs-identifier hs-var">_pack</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; a) -&gt; ParseResult b -&gt; ParseResult a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Position
-&gt; ParsecParser b
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult b
forall a.
Position
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser"><span class="hs-identifier hs-var">runFieldParser</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551250"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecParser b
forall a (m :: * -&gt; *). (Parsec a, CabalParsing m) =&gt; m a
forall (m :: * -&gt; *). CabalParsing m =&gt; m b
</span><a href="Distribution.Parsec.html#parsec"><span class="hs-identifier hs-var">parsec</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551249"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551251"><span class="hs-identifier hs-var">fls</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679551252"><span class="annot"><span class="annottext">freeTextField :: forall s.
FieldName
-&gt; ALens' s (Maybe [Char]) -&gt; ParsecFieldGrammar s (Maybe [Char])
</span><a href="#local-6989586621679551252"><span class="hs-identifier hs-var hs-var hs-var">freeTextField</span></a></span></span><span> </span><span id="local-6989586621679551254"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551254"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="annot"><span class="annottext">ALens' s (Maybe [Char])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion
    -&gt; Fields Position -&gt; ParseResult (Maybe [Char]))
-&gt; ParsecFieldGrammar s (Maybe [Char])
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551254"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult (Maybe [Char])
</span><a href="#local-6989586621679551255"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>      </span><span id="local-6989586621679551255"><span class="annot"><span class="annottext">parser :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult (Maybe [Char])
</span><a href="#local-6989586621679551255"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551265"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551265"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551266"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551266"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Fields Position -&gt; Maybe [NamelessField Position]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551254"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551266"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">Maybe [NamelessField Position]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; ParseResult (Maybe [Char])
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; ParseResult (Maybe [Char])
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679551267"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551267"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
-&gt; NamelessField Position -&gt; ParseResult (Maybe [Char])
forall {f :: * -&gt; *}.
Applicative f =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; f (Maybe [Char])
</span><a href="#local-6989586621679551268"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551265"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551267"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679551269"><span class="annot"><span class="annottext">xs :: [NamelessField Position]
</span><a href="#local-6989586621679551269"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551270"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551270"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551271"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551271"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; [NamelessField Position] -&gt; ParseResult ()
</span><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var">warnMultipleSingularFields</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551254"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551269"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-220"></span><span>          </span><span class="annot"><span class="annottext">NonEmpty (Maybe [Char]) -&gt; Maybe [Char]
forall a. NonEmpty a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#last"><span class="hs-identifier hs-var">NE.last</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Maybe [Char]) -&gt; Maybe [Char])
-&gt; ParseResult (NonEmpty (Maybe [Char]))
-&gt; ParseResult (Maybe [Char])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; ParseResult (Maybe [Char]))
-&gt; NonEmpty (NamelessField Position)
-&gt; ParseResult (NonEmpty (Maybe [Char]))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CabalSpecVersion
-&gt; NamelessField Position -&gt; ParseResult (Maybe [Char])
forall {f :: * -&gt; *}.
Applicative f =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; f (Maybe [Char])
</span><a href="#local-6989586621679551268"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551265"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551270"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
-&gt; [NamelessField Position] -&gt; NonEmpty (NamelessField Position)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551271"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>      </span><span id="local-6989586621679551268"><span class="annot"><span class="annottext">parseOne :: CabalSpecVersion -&gt; NamelessField Position -&gt; f (Maybe [Char])
</span><a href="#local-6989586621679551268"><span class="hs-identifier hs-var hs-var">parseOne</span></a></span></span><span> </span><span id="local-6989586621679551282"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551282"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551283"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551283"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551284"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551284"><span class="hs-identifier hs-var">fls</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldLine Position] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551284"><span class="hs-identifier hs-var">fls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; f (Maybe [Char])
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551282"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; CabalSpecVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="Distribution.CabalSpecVersion.html#CabalSpecV3_0"><span class="hs-identifier hs-var">CabalSpecV3_0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; f (Maybe [Char])
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; [FieldLine Position] -&gt; [Char]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText3"><span class="hs-identifier hs-var">fieldlinesToFreeText3</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551283"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551284"><span class="hs-identifier hs-var">fls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; f (Maybe [Char])
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldLine Position] -&gt; [Char]
forall ann. [FieldLine ann] -&gt; [Char]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText"><span class="hs-identifier hs-var">fieldlinesToFreeText</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551284"><span class="hs-identifier hs-var">fls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679551288"><span class="annot"><span class="annottext">freeTextFieldDef :: forall s.
FieldName -&gt; ALens' s [Char] -&gt; ParsecFieldGrammar s [Char]
</span><a href="#local-6989586621679551288"><span class="hs-identifier hs-var hs-var hs-var">freeTextFieldDef</span></a></span></span><span> </span><span id="local-6989586621679551290"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551290"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="annot"><span class="annottext">ALens' s [Char]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult [Char])
-&gt; ParsecFieldGrammar s [Char]
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551290"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult [Char]
</span><a href="#local-6989586621679551291"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>      </span><span id="local-6989586621679551291"><span class="annot"><span class="annottext">parser :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult [Char]
</span><a href="#local-6989586621679551291"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551304"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551304"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551305"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551305"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Fields Position -&gt; Maybe [NamelessField Position]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551290"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551305"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><span class="annottext">Maybe [NamelessField Position]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ParseResult [Char]
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-231"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ParseResult [Char]
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679551306"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551306"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult [Char]
forall {f :: * -&gt; *}.
Applicative f =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; f [Char]
</span><a href="#local-6989586621679551307"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551304"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551306"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679551308"><span class="annot"><span class="annottext">xs :: [NamelessField Position]
</span><a href="#local-6989586621679551308"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551309"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551309"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551310"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551310"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; [NamelessField Position] -&gt; ParseResult ()
</span><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var">warnMultipleSingularFields</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551290"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551308"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="annottext">NonEmpty [Char] -&gt; [Char]
forall a. NonEmpty a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#last"><span class="hs-identifier hs-var">NE.last</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty [Char] -&gt; [Char])
-&gt; ParseResult (NonEmpty [Char]) -&gt; ParseResult [Char]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; ParseResult [Char])
-&gt; NonEmpty (NamelessField Position)
-&gt; ParseResult (NonEmpty [Char])
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult [Char]
forall {f :: * -&gt; *}.
Applicative f =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; f [Char]
</span><a href="#local-6989586621679551307"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551304"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551309"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
-&gt; [NamelessField Position] -&gt; NonEmpty (NamelessField Position)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551310"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>      </span><span id="local-6989586621679551307"><span class="annot"><span class="annottext">parseOne :: CabalSpecVersion -&gt; NamelessField Position -&gt; f [Char]
</span><a href="#local-6989586621679551307"><span class="hs-identifier hs-var hs-var">parseOne</span></a></span></span><span> </span><span id="local-6989586621679551321"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551321"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551322"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551322"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551323"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551323"><span class="hs-identifier hs-var">fls</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldLine Position] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551323"><span class="hs-identifier hs-var">fls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f [Char]
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551321"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; CabalSpecVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="Distribution.CabalSpecVersion.html#CabalSpecV3_0"><span class="hs-identifier hs-var">CabalSpecV3_0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f [Char]
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; [FieldLine Position] -&gt; [Char]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText3"><span class="hs-identifier hs-var">fieldlinesToFreeText3</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551322"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551323"><span class="hs-identifier hs-var">fls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; f [Char]
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldLine Position] -&gt; [Char]
forall ann. [FieldLine ann] -&gt; [Char]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText"><span class="hs-identifier hs-var">fieldlinesToFreeText</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551323"><span class="hs-identifier hs-var">fls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-comment">-- freeTextFieldDefST = defaultFreeTextFieldDefST</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679551324"><span class="annot"><span class="annottext">freeTextFieldDefST :: forall s.
FieldName -&gt; ALens' s ShortText -&gt; ParsecFieldGrammar s ShortText
</span><a href="#local-6989586621679551324"><span class="hs-identifier hs-var hs-var hs-var">freeTextFieldDefST</span></a></span></span><span> </span><span id="local-6989586621679551326"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551326"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="annot"><span class="annottext">ALens' s ShortText
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult ShortText)
-&gt; ParsecFieldGrammar s ShortText
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551326"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult ShortText
</span><a href="#local-6989586621679551327"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>      </span><span id="local-6989586621679551327"><span class="annot"><span class="annottext">parser :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult ShortText
</span><a href="#local-6989586621679551327"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551340"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551340"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551341"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551341"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Fields Position -&gt; Maybe [NamelessField Position]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551326"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551341"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">Maybe [NamelessField Position]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; ParseResult ShortText
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ShortText
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-247"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; ParseResult ShortText
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ShortText
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679551342"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551342"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult ShortText
forall {f :: * -&gt; *}.
Applicative f =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; f ShortText
</span><a href="#local-6989586621679551343"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551340"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551342"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679551344"><span class="annot"><span class="annottext">xs :: [NamelessField Position]
</span><a href="#local-6989586621679551344"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551345"><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551345"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551346"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551346"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>          </span><span class="annot"><span class="annottext">FieldName -&gt; [NamelessField Position] -&gt; ParseResult ()
</span><a href="Distribution.FieldGrammar.Parsec.html#warnMultipleSingularFields"><span class="hs-identifier hs-var">warnMultipleSingularFields</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551326"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551344"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-251"></span><span>          </span><span class="annot"><span class="annottext">NonEmpty ShortText -&gt; ShortText
forall a. NonEmpty a -&gt; a
</span><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#last"><span class="hs-identifier hs-var">NE.last</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty ShortText -&gt; ShortText)
-&gt; ParseResult (NonEmpty ShortText) -&gt; ParseResult ShortText
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; ParseResult ShortText)
-&gt; NonEmpty (NamelessField Position)
-&gt; ParseResult (NonEmpty ShortText)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult ShortText
forall {f :: * -&gt; *}.
Applicative f =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; f ShortText
</span><a href="#local-6989586621679551343"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551340"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamelessField Position
</span><a href="#local-6989586621679551345"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">NamelessField Position
-&gt; [NamelessField Position] -&gt; NonEmpty (NamelessField Position)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551346"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>      </span><span id="local-6989586621679551343"><span class="annot"><span class="annottext">parseOne :: CabalSpecVersion -&gt; NamelessField Position -&gt; f ShortText
</span><a href="#local-6989586621679551343"><span class="hs-identifier hs-var hs-var">parseOne</span></a></span></span><span> </span><span id="local-6989586621679551356"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551356"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551357"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551357"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551358"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551358"><span class="hs-identifier hs-var">fls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551358"><span class="hs-identifier hs-var">fls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-254"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; f ShortText
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ShortText
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679551360"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551360"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; f ShortText
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; ShortText
</span><a href="Distribution.Utils.ShortText.html#unsafeFromUTF8BS"><span class="hs-identifier hs-var">ShortText.unsafeFromUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551360"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551356"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; CabalSpecVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="Distribution.CabalSpecVersion.html#CabalSpecV3_0"><span class="hs-identifier hs-var">CabalSpecV3_0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; f ShortText
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ShortText
</span><a href="Distribution.Utils.ShortText.html#toShortText"><span class="hs-identifier hs-var">ShortText.toShortText</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ShortText) -&gt; [Char] -&gt; ShortText
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; [FieldLine Position] -&gt; [Char]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText3"><span class="hs-identifier hs-var">fieldlinesToFreeText3</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551357"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551358"><span class="hs-identifier hs-var">fls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ShortText -&gt; f ShortText
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; ShortText
</span><a href="Distribution.Utils.ShortText.html#toShortText"><span class="hs-identifier hs-var">ShortText.toShortText</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ShortText) -&gt; [Char] -&gt; ShortText
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position] -&gt; [Char]
forall ann. [FieldLine ann] -&gt; [Char]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText"><span class="hs-identifier hs-var">fieldlinesToFreeText</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551358"><span class="hs-identifier hs-var">fls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679551370"><span class="annot"><span class="annottext">monoidalFieldAla :: forall b a s.
(Parsec b, Monoid a, Newtype a b) =&gt;
FieldName -&gt; (a -&gt; b) -&gt; ALens' s a -&gt; ParsecFieldGrammar s a
</span><a href="#local-6989586621679551370"><span class="hs-identifier hs-var hs-var hs-var">monoidalFieldAla</span></a></span></span><span> </span><span id="local-6989586621679551372"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551372"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621679551373"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679551373"><span class="hs-identifier hs-var">_pack</span></a></span></span><span> </span><span id="local-6989586621679551374"><span class="annot"><span class="annottext">ALens' s a
</span><a href="#local-6989586621679551374"><span class="hs-identifier hs-var">_extract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551372"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
forall {t :: * -&gt; *}.
Traversable t =&gt;
CabalSpecVersion
-&gt; Map FieldName (t (NamelessField Position)) -&gt; ParseResult a
</span><a href="#local-6989586621679551375"><span class="hs-identifier hs-var">parser</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>      </span><span id="local-6989586621679551375"><span class="annot"><span class="annottext">parser :: CabalSpecVersion
-&gt; Map FieldName (t (NamelessField Position)) -&gt; ParseResult a
</span><a href="#local-6989586621679551375"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551394"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551394"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551395"><span class="annot"><span class="annottext">Map FieldName (t (NamelessField Position))
</span><a href="#local-6989586621679551395"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldName
-&gt; Map FieldName (t (NamelessField Position))
-&gt; Maybe (t (NamelessField Position))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551372"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Map FieldName (t (NamelessField Position))
</span><a href="#local-6989586621679551395"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">Maybe (t (NamelessField Position))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; ParseResult a
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679551396"><span class="annot"><span class="annottext">t (NamelessField Position)
</span><a href="#local-6989586621679551396"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b -&gt; a) -&gt; t b -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; b -&gt; a
forall o n. Newtype o n =&gt; (o -&gt; n) -&gt; n -&gt; o
</span><a href="Distribution.Compat.Newtype.html#unpack%27"><span class="hs-identifier hs-var">unpack'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679551373"><span class="hs-identifier hs-var">_pack</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(t b -&gt; a) -&gt; ParseResult (t b) -&gt; ParseResult a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamelessField Position -&gt; ParseResult b)
-&gt; t (NamelessField Position) -&gt; ParseResult (t b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult b
forall {a}.
Parsec a =&gt;
CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551398"><span class="hs-identifier hs-var">parseOne</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551394"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t (NamelessField Position)
</span><a href="#local-6989586621679551396"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>      </span><span id="local-6989586621679551398"><span class="annot"><span class="annottext">parseOne :: CabalSpecVersion -&gt; NamelessField Position -&gt; ParseResult a
</span><a href="#local-6989586621679551398"><span class="hs-identifier hs-var hs-var">parseOne</span></a></span></span><span> </span><span id="local-6989586621679551402"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551402"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551403"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551403"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551404"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551404"><span class="hs-identifier hs-var">fls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult a
forall a.
Position
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser"><span class="hs-identifier hs-var">runFieldParser</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551403"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecParser a
forall a (m :: * -&gt; *). (Parsec a, CabalParsing m) =&gt; m a
forall (m :: * -&gt; *). CabalParsing m =&gt; m a
</span><a href="Distribution.Parsec.html#parsec"><span class="hs-identifier hs-var">parsec</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551402"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551404"><span class="hs-identifier hs-var">fls</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679551409"><span class="annot"><span class="annottext">prefixedFields :: forall s.
FieldName
-&gt; ALens' s [([Char], [Char])]
-&gt; ParsecFieldGrammar s [([Char], [Char])]
</span><a href="#local-6989586621679551409"><span class="hs-identifier hs-var hs-var hs-var">prefixedFields</span></a></span></span><span> </span><span id="local-6989586621679551411"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551411"><span class="hs-identifier hs-var">fnPfx</span></a></span></span><span> </span><span id="local-6989586621679551412"><span class="annot"><span class="annottext">ALens' s [([Char], [Char])]
</span><a href="#local-6989586621679551412"><span class="hs-identifier hs-var">_extract</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion
    -&gt; Fields Position -&gt; ParseResult [([Char], [Char])])
-&gt; ParsecFieldGrammar s [([Char], [Char])]
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551411"><span class="hs-identifier hs-var">fnPfx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">CabalSpecVersion
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679551413"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551413"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[([Char], [Char])] -&gt; ParseResult [([Char], [Char])]
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fields Position -&gt; [([Char], [Char])]
</span><a href="#local-6989586621679551414"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551413"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><a href="#local-6989586621679551414"><span class="hs-identifier hs-type">parser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#Fields"><span class="hs-identifier hs-type">Fields</span></a></span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-271"></span><span>      </span><span id="local-6989586621679551414"><span class="annot"><span class="annottext">parser :: Fields Position -&gt; [([Char], [Char])]
</span><a href="#local-6989586621679551414"><span class="hs-identifier hs-var hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679551415"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551415"><span class="hs-identifier hs-var">values</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Position, ([Char], [Char]))] -&gt; [([Char], [Char])]
forall {b}. [(Position, b)] -&gt; [b]
</span><a href="#local-6989586621679551416"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">([(Position, ([Char], [Char]))] -&gt; [([Char], [Char])])
-&gt; [(Position, ([Char], [Char]))] -&gt; [([Char], [Char])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((FieldName, [NamelessField Position])
 -&gt; [(Position, ([Char], [Char]))])
-&gt; [(FieldName, [NamelessField Position])]
-&gt; [(Position, ([Char], [Char]))]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, [NamelessField Position])
-&gt; [(Position, ([Char], [Char]))]
forall {ann}.
(FieldName, [NamelessField ann]) -&gt; [(ann, ([Char], [Char]))]
</span><a href="#local-6989586621679551418"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="annot"><span class="annottext">([(FieldName, [NamelessField Position])]
 -&gt; [(Position, ([Char], [Char]))])
-&gt; [(FieldName, [NamelessField Position])]
-&gt; [(Position, ([Char], [Char]))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((FieldName, [NamelessField Position]) -&gt; Bool)
-&gt; [(FieldName, [NamelessField Position])]
-&gt; [(FieldName, [NamelessField Position])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, [NamelessField Position]) -&gt; Bool
forall {b}. (FieldName, b) -&gt; Bool
</span><a href="#local-6989586621679551419"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">([(FieldName, [NamelessField Position])]
 -&gt; [(FieldName, [NamelessField Position])])
-&gt; [(FieldName, [NamelessField Position])]
-&gt; [(FieldName, [NamelessField Position])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Fields Position -&gt; [(FieldName, [NamelessField Position])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551415"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>      </span><span id="local-6989586621679551419"><span class="annot"><span class="annottext">match :: (FieldName, b) -&gt; Bool
</span><a href="#local-6989586621679551419"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679551420"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551420"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551411"><span class="hs-identifier hs-var">fnPfx</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; FieldName -&gt; Bool
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#isPrefixOf"><span class="hs-operator hs-var">`BS.isPrefixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551420"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-274"></span><span>      </span><span id="local-6989586621679551418"><span class="annot"><span class="annottext">convert :: (FieldName, [NamelessField ann]) -&gt; [(ann, ([Char], [Char]))]
</span><a href="#local-6989586621679551418"><span class="hs-identifier hs-var hs-var">convert</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679551421"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551421"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551422"><span class="annot"><span class="annottext">[NamelessField ann]
</span><a href="#local-6989586621679551422"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621679551423"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
</span><a href="Distribution.Utils.Generic.html#fromUTF8BS"><span class="hs-identifier hs-var">fromUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551421"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Distribution.Utils.String.html#trim"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
</span><a href="Distribution.Utils.Generic.html#fromUTF8BS"><span class="hs-identifier hs-var">fromUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; [Char]) -&gt; FieldName -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FieldLine ann] -&gt; FieldName
forall ann. [FieldLine ann] -&gt; FieldName
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToBS"><span class="hs-identifier hs-var">fieldlinesToBS</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine ann]
</span><a href="#local-6989586621679551425"><span class="hs-identifier hs-var">fls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551423"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621679551423"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551425"><span class="annot"><span class="annottext">[FieldLine ann]
</span><a href="#local-6989586621679551425"><span class="hs-identifier hs-var">fls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[NamelessField ann]
</span><a href="#local-6989586621679551422"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>      </span><span class="hs-comment">-- hack: recover the order of prefixed fields</span><span>
</span><span id="line-279"></span><span>      </span><span id="local-6989586621679551416"><span class="annot"><span class="annottext">reorder :: [(Position, b)] -&gt; [b]
</span><a href="#local-6989586621679551416"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Position, b) -&gt; b) -&gt; [(Position, b)] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Position, b) -&gt; b
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([(Position, b)] -&gt; [b])
-&gt; ([(Position, b)] -&gt; [(Position, b)]) -&gt; [(Position, b)] -&gt; [b]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Position, b) -&gt; (Position, b) -&gt; Ordering)
-&gt; [(Position, b)] -&gt; [(Position, b)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Position, b) -&gt; Position)
-&gt; (Position, b) -&gt; (Position, b) -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">(Position, b) -&gt; Position
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679551434"><span class="annot"><span class="annottext">availableSince :: forall a s.
CabalSpecVersion
-&gt; a -&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s a
</span><a href="#local-6989586621679551434"><span class="hs-identifier hs-var hs-var hs-var">availableSince</span></a></span></span><span> </span><span id="local-6989586621679551436"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551436"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679551437"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551437"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-type">ParsecFG</span></a></span><span> </span><span id="local-6989586621679551438"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551438"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621679551439"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551439"><span class="hs-identifier hs-var">prefixes</span></a></span></span><span> </span><span id="local-6989586621679551440"><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551440"><span class="hs-identifier hs-var">parser</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551438"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551439"><span class="hs-identifier hs-var">prefixes</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551441"><span class="hs-identifier hs-var">parser'</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>      </span><span id="local-6989586621679551441"><span class="annot"><span class="annottext">parser' :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551441"><span class="hs-identifier hs-var hs-var">parser'</span></a></span></span><span> </span><span id="local-6989586621679551456"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551456"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551457"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551457"><span class="hs-identifier hs-var">values</span></a></span></span><span>
</span><span id="line-284"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551456"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; CabalSpecVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551436"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551440"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551456"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551457"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-285"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551459"><span class="annot"><span class="annottext">unknownFields :: Fields Position
</span><a href="#local-6989586621679551459"><span class="hs-identifier hs-var hs-var hs-var">unknownFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields Position -&gt; Map FieldName () -&gt; Fields Position
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#intersection"><span class="hs-identifier hs-var">Map.intersection</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551457"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FieldName () -&gt; Fields Position)
-&gt; Map FieldName () -&gt; Fields Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; ()) -&gt; Set FieldName -&gt; Map FieldName ()
forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#fromSet"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; FieldName -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551438"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-287"></span><span>            </span><span class="annot"><span class="annottext">[(FieldName, [NamelessField Position])]
-&gt; ((FieldName, [NamelessField Position]) -&gt; ParseResult ())
-&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fields Position -&gt; [(FieldName, [NamelessField Position])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551459"><span class="hs-identifier hs-var">unknownFields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((FieldName, [NamelessField Position]) -&gt; ParseResult ())
 -&gt; ParseResult ())
-&gt; ((FieldName, [NamelessField Position]) -&gt; ParseResult ())
-&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679551463"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551463"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551464"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551464"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>              </span><span class="annot"><span class="annottext">[NamelessField Position]
-&gt; (NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551464"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">((NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ())
-&gt; (NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551465"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551465"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-289"></span><span>                </span><span class="annot"><span class="annottext">Position -&gt; PWarnType -&gt; [Char] -&gt; ParseResult ()
</span><a href="Distribution.Fields.ParseResult.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551465"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">PWarnType
</span><a href="Distribution.Parsec.Warning.html#PWTUnknownField"><span class="hs-identifier hs-var">PWTUnknownField</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult ()) -&gt; [Char] -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-290"></span><span>                  </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The field &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551463"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is available only since the Cabal specification version &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; [Char]
</span><a href="Distribution.CabalSpecVersion.html#showCabalSpecVersion"><span class="hs-identifier hs-var">showCabalSpecVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551436"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;. This field will be ignored.&quot;</span></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="annottext">a -&gt; ParseResult a
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551437"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679551467"><span class="annot"><span class="annottext">availableSinceWarn :: forall s a.
CabalSpecVersion
-&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s a
</span><a href="#local-6989586621679551467"><span class="hs-identifier hs-var hs-var hs-var">availableSinceWarn</span></a></span></span><span> </span><span id="local-6989586621679551469"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551469"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-type">ParsecFG</span></a></span><span> </span><span id="local-6989586621679551470"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551470"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621679551471"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551471"><span class="hs-identifier hs-var">prefixes</span></a></span></span><span> </span><span id="local-6989586621679551472"><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551472"><span class="hs-identifier hs-var">parser</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551470"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551471"><span class="hs-identifier hs-var">prefixes</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551473"><span class="hs-identifier hs-var">parser'</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>      </span><span id="local-6989586621679551473"><span class="annot"><span class="annottext">parser' :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551473"><span class="hs-identifier hs-var hs-var">parser'</span></a></span></span><span> </span><span id="local-6989586621679551487"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551487"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551488"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551488"><span class="hs-identifier hs-var">values</span></a></span></span><span>
</span><span id="line-297"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551487"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; CabalSpecVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551469"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551472"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551487"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551488"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551490"><span class="annot"><span class="annottext">unknownFields :: Fields Position
</span><a href="#local-6989586621679551490"><span class="hs-identifier hs-var hs-var hs-var">unknownFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields Position -&gt; Map FieldName () -&gt; Fields Position
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#intersection"><span class="hs-identifier hs-var">Map.intersection</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551488"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FieldName () -&gt; Fields Position)
-&gt; Map FieldName () -&gt; Fields Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; ()) -&gt; Set FieldName -&gt; Map FieldName ()
forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#fromSet"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; FieldName -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551470"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-300"></span><span>            </span><span class="annot"><span class="annottext">[(FieldName, [NamelessField Position])]
-&gt; ((FieldName, [NamelessField Position]) -&gt; ParseResult ())
-&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fields Position -&gt; [(FieldName, [NamelessField Position])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551490"><span class="hs-identifier hs-var">unknownFields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((FieldName, [NamelessField Position]) -&gt; ParseResult ())
 -&gt; ParseResult ())
-&gt; ((FieldName, [NamelessField Position]) -&gt; ParseResult ())
-&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679551491"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551491"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551492"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551492"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>              </span><span class="annot"><span class="annottext">[NamelessField Position]
-&gt; (NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551492"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">((NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ())
-&gt; (NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551493"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551493"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-302"></span><span>                </span><span class="annot"><span class="annottext">Position -&gt; PWarnType -&gt; [Char] -&gt; ParseResult ()
</span><a href="Distribution.Fields.ParseResult.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551493"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">PWarnType
</span><a href="Distribution.Parsec.Warning.html#PWTUnknownField"><span class="hs-identifier hs-var">PWTUnknownField</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult ()) -&gt; [Char] -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-303"></span><span>                  </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The field &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551491"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is available only since the Cabal specification version &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; [Char]
</span><a href="Distribution.CabalSpecVersion.html#showCabalSpecVersion"><span class="hs-identifier hs-var">showCabalSpecVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551469"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551472"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551487"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551488"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-comment">-- todo we know about this field</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621679551494"><span class="annot"><span class="annottext">deprecatedSince :: forall s a.
CabalSpecVersion
-&gt; [Char] -&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s a
</span><a href="#local-6989586621679551494"><span class="hs-identifier hs-var hs-var hs-var">deprecatedSince</span></a></span></span><span> </span><span id="local-6989586621679551496"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551496"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679551497"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551497"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-type">ParsecFG</span></a></span><span> </span><span id="local-6989586621679551498"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551498"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621679551499"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551499"><span class="hs-identifier hs-var">prefixes</span></a></span></span><span> </span><span id="local-6989586621679551500"><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551500"><span class="hs-identifier hs-var">parser</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551498"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551499"><span class="hs-identifier hs-var">prefixes</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551501"><span class="hs-identifier hs-var">parser'</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>      </span><span id="local-6989586621679551501"><span class="annot"><span class="annottext">parser' :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551501"><span class="hs-identifier hs-var hs-var">parser'</span></a></span></span><span> </span><span id="local-6989586621679551515"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551515"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551516"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551516"><span class="hs-identifier hs-var">values</span></a></span></span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551515"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; CabalSpecVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551496"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551518"><span class="annot"><span class="annottext">deprecatedFields :: Fields Position
</span><a href="#local-6989586621679551518"><span class="hs-identifier hs-var hs-var hs-var">deprecatedFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields Position -&gt; Map FieldName () -&gt; Fields Position
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#intersection"><span class="hs-identifier hs-var">Map.intersection</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551516"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FieldName () -&gt; Fields Position)
-&gt; Map FieldName () -&gt; Fields Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; ()) -&gt; Set FieldName -&gt; Map FieldName ()
forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#fromSet"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; FieldName -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551498"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-313"></span><span>            </span><span class="annot"><span class="annottext">[(FieldName, [NamelessField Position])]
-&gt; ((FieldName, [NamelessField Position]) -&gt; ParseResult ())
-&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fields Position -&gt; [(FieldName, [NamelessField Position])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551518"><span class="hs-identifier hs-var">deprecatedFields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((FieldName, [NamelessField Position]) -&gt; ParseResult ())
 -&gt; ParseResult ())
-&gt; ((FieldName, [NamelessField Position]) -&gt; ParseResult ())
-&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679551519"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551519"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551520"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551520"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>              </span><span class="annot"><span class="annottext">[NamelessField Position]
-&gt; (NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551520"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">((NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ())
-&gt; (NamelessField Position -&gt; ParseResult ()) -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551521"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551521"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-315"></span><span>                </span><span class="annot"><span class="annottext">Position -&gt; PWarnType -&gt; [Char] -&gt; ParseResult ()
</span><a href="Distribution.Fields.ParseResult.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551521"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">PWarnType
</span><a href="Distribution.Parsec.Warning.html#PWTDeprecatedField"><span class="hs-identifier hs-var">PWTDeprecatedField</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult ()) -&gt; [Char] -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-316"></span><span>                  </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The field &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551519"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is deprecated in the Cabal specification version &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; [Char]
</span><a href="Distribution.CabalSpecVersion.html#showCabalSpecVersion"><span class="hs-identifier hs-var">showCabalSpecVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551496"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;. &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551497"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>            </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551500"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551515"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551516"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551500"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551515"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551516"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679551523"><span class="annot"><span class="annottext">removedIn :: forall s a.
CabalSpecVersion
-&gt; [Char] -&gt; ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s a
</span><a href="#local-6989586621679551523"><span class="hs-identifier hs-var hs-var hs-var">removedIn</span></a></span></span><span> </span><span id="local-6989586621679551525"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551525"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679551526"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551526"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-type">ParsecFG</span></a></span><span> </span><span id="local-6989586621679551527"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551527"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621679551528"><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551528"><span class="hs-identifier hs-var">prefixes</span></a></span></span><span> </span><span id="local-6989586621679551529"><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551529"><span class="hs-identifier hs-var">parser</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551527"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551528"><span class="hs-identifier hs-var">prefixes</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551530"><span class="hs-identifier hs-var">parser'</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>      </span><span id="local-6989586621679551530"><span class="annot"><span class="annottext">parser' :: CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551530"><span class="hs-identifier hs-var hs-var">parser'</span></a></span></span><span> </span><span id="local-6989586621679551540"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551540"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551541"><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551541"><span class="hs-identifier hs-var">values</span></a></span></span><span>
</span><span id="line-324"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551540"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; CabalSpecVersion -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551525"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551545"><span class="annot"><span class="annottext">msg' :: [Char]
</span><a href="#local-6989586621679551545"><span class="hs-identifier hs-var hs-var hs-var">msg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551526"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551526"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-326"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551547"><span class="annot"><span class="annottext">unknownFields :: Fields Position
</span><a href="#local-6989586621679551547"><span class="hs-identifier hs-var hs-var hs-var">unknownFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fields Position -&gt; Map FieldName () -&gt; Fields Position
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#intersection"><span class="hs-identifier hs-var">Map.intersection</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551541"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">(Map FieldName () -&gt; Fields Position)
-&gt; Map FieldName () -&gt; Fields Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; ()) -&gt; Set FieldName -&gt; Map FieldName ()
forall k a. (k -&gt; a) -&gt; Set k -&gt; Map k a
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Strict.Internal.html#fromSet"><span class="hs-identifier hs-var">Map.fromSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; FieldName -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
</span><a href="#local-6989586621679551527"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-327"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551548"><span class="annot"><span class="annottext">namePos :: [(FieldName, Position)]
</span><a href="#local-6989586621679551548"><span class="hs-identifier hs-var hs-var hs-var">namePos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-328"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551549"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551550"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679551549"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551549"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551551"><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551551"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Fields Position -&gt; [(FieldName, [NamelessField Position])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../containers-0.7-5a8f/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551547"><span class="hs-identifier hs-var">unknownFields</span></a></span><span>
</span><span id="line-330"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#MkNamelessField"><span class="hs-identifier hs-type">MkNamelessField</span></a></span><span> </span><span id="local-6989586621679551550"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551550"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[NamelessField Position]
</span><a href="#local-6989586621679551551"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-331"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551560"><span class="annot"><span class="annottext">makeMsg :: a -&gt; [Char]
</span><a href="#local-6989586621679551560"><span class="hs-identifier hs-var hs-var">makeMsg</span></a></span></span><span> </span><span id="local-6989586621679551561"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551561"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The field &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551561"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is removed in the Cabal specification version &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; [Char]
</span><a href="Distribution.CabalSpecVersion.html#showCabalSpecVersion"><span class="hs-identifier hs-var">showCabalSpecVersion</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551525"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551545"><span class="hs-identifier hs-var">msg'</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(FieldName, Position)]
</span><a href="#local-6989586621679551548"><span class="hs-identifier hs-var">namePos</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-336"></span><span>              </span><span class="hs-comment">-- no fields =&gt; proceed (with empty values, to be sure)</span><span>
</span><span id="line-337"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551529"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551540"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-338"></span><span>              </span><span class="hs-comment">-- if there's single field: fail fatally with it</span><span>
</span><span id="line-339"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679551562"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551562"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551563"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551563"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551564"><span class="annot"><span class="annottext">[(FieldName, Position)]
</span><a href="#local-6989586621679551564"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>                </span><span class="annot"><span class="annottext">[(FieldName, Position)]
-&gt; ((FieldName, Position) -&gt; ParseResult ()) -&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[(FieldName, Position)]
</span><a href="#local-6989586621679551564"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">(((FieldName, Position) -&gt; ParseResult ()) -&gt; ParseResult ())
-&gt; ((FieldName, Position) -&gt; ParseResult ()) -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679551565"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551565"><span class="hs-identifier hs-var">name'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551566"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551566"><span class="hs-identifier hs-var">pos'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Position -&gt; [Char] -&gt; ParseResult ()
</span><a href="Distribution.Fields.ParseResult.html#parseFailure"><span class="hs-identifier hs-var">parseFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551566"><span class="hs-identifier hs-var">pos'</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult ()) -&gt; [Char] -&gt; ParseResult ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="#local-6989586621679551560"><span class="hs-identifier hs-var">makeMsg</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551565"><span class="hs-identifier hs-var">name'</span></a></span><span>
</span><span id="line-341"></span><span>                </span><span class="annot"><span class="annottext">Position -&gt; [Char] -&gt; ParseResult a
forall a. Position -&gt; [Char] -&gt; ParseResult a
</span><a href="Distribution.Fields.ParseResult.html#parseFatalFailure"><span class="hs-identifier hs-var">parseFatalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551563"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult a) -&gt; [Char] -&gt; ParseResult a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="#local-6989586621679551560"><span class="hs-identifier hs-var">makeMsg</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551562"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a
</span><a href="#local-6989586621679551529"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551540"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><a href="#local-6989586621679551541"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621679551569"><span class="annot"><span class="annottext">knownField :: forall s. FieldName -&gt; ParsecFieldGrammar s ()
</span><a href="#local-6989586621679551569"><span class="hs-identifier hs-var hs-var hs-var">knownField</span></a></span></span><span> </span><span id="local-6989586621679551571"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551571"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult ())
-&gt; ParsecFieldGrammar s ()
forall s a.
Set FieldName
-&gt; Set FieldName
-&gt; (CabalSpecVersion -&gt; Fields Position -&gt; ParseResult a)
-&gt; ParsecFieldGrammar s a
</span><a href="Distribution.FieldGrammar.Parsec.html#ParsecFG"><span class="hs-identifier hs-var">ParsecFG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Set FieldName
forall a. a -&gt; Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551571"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set FieldName
forall a. Set a
</span><a href="../../containers-0.7-5a8f/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">CabalSpecVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Fields Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ParseResult ()
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621679551572"><span class="annot"><span class="annottext">hiddenField :: forall s a. ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s a
</span><a href="#local-6989586621679551572"><span class="hs-identifier hs-var hs-var hs-var">hiddenField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParsecFieldGrammar s a -&gt; ParsecFieldGrammar s a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- Parsec</span><span>
</span><span id="line-350"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span id="local-6989586621679550796"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser%27"><span class="hs-identifier hs-type">runFieldParser'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Parsec.html#ParsecParser"><span class="hs-identifier hs-type">ParsecParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550796"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.CabalSpecVersion.html#CabalSpecVersion"><span class="hs-identifier hs-type">CabalSpecVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Parsec.FieldLineStream.html#FieldLineStream"><span class="hs-identifier hs-type">FieldLineStream</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Fields.ParseResult.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550796"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-353"></span><span id="runFieldParser%27"><span class="annot"><span class="annottext">runFieldParser' :: forall a.
[Position]
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; FieldLineStream
-&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser%27"><span class="hs-identifier hs-var hs-var">runFieldParser'</span></a></span></span><span> </span><span id="local-6989586621679551583"><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679551583"><span class="hs-identifier hs-var">inputPoss</span></a></span></span><span> </span><span id="local-6989586621679551584"><span class="annot"><span class="annottext">ParsecParser a
</span><a href="#local-6989586621679551584"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679551585"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551585"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551586"><span class="annot"><span class="annottext">FieldLineStream
</span><a href="#local-6989586621679551586"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parsec FieldLineStream [PWarning] (a, [PWarning])
-&gt; [PWarning]
-&gt; [Char]
-&gt; FieldLineStream
-&gt; Either ParseError (a, [PWarning])
forall s t u a.
Stream s Identity t =&gt;
Parsec s u a -&gt; u -&gt; [Char] -&gt; s -&gt; Either ParseError a
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Prim.html#runParser"><span class="hs-identifier hs-var">P.runParser</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec FieldLineStream [PWarning] (a, [PWarning])
</span><a href="#local-6989586621679551588"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&lt;field&gt;&quot;</span></span><span> </span><span class="annot"><span class="annottext">FieldLineStream
</span><a href="#local-6989586621679551586"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679551589"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551589"><span class="hs-identifier hs-var">pok</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551590"><span class="annot"><span class="annottext">[PWarning]
</span><a href="#local-6989586621679551590"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">(PWarning -&gt; ParseResult ()) -&gt; [PWarning] -&gt; ParseResult ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Parsec.Warning.html#PWarning"><span class="hs-identifier hs-type">PWarning</span></a></span><span> </span><span id="local-6989586621679551593"><span class="annot"><span class="annottext">PWarnType
</span><a href="#local-6989586621679551593"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679551594"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551594"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679551595"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551595"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Position -&gt; PWarnType -&gt; [Char] -&gt; ParseResult ()
</span><a href="Distribution.Fields.ParseResult.html#parseWarning"><span class="hs-identifier hs-var">parseWarning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Position
</span><a href="#local-6989586621679551596"><span class="hs-identifier hs-var">mapPosition</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551594"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PWarnType
</span><a href="#local-6989586621679551593"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551595"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PWarning]
</span><a href="#local-6989586621679551590"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><span class="annottext">a -&gt; ParseResult a
forall a. a -&gt; ParseResult a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551589"><span class="hs-identifier hs-var">pok</span></a></span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679551597"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679551597"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551598"><span class="annot"><span class="annottext">ppos :: SourcePos
</span><a href="#local-6989586621679551598"><span class="hs-identifier hs-var hs-var hs-var">ppos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; SourcePos
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Error.html#errorPos"><span class="hs-identifier hs-var">P.errorPos</span></a></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679551597"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551600"><span class="annot"><span class="annottext">epos :: Position
</span><a href="#local-6989586621679551600"><span class="hs-identifier hs-var hs-var hs-var">epos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position
</span><a href="#local-6989586621679551596"><span class="hs-identifier hs-var">mapPosition</span></a></span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Position) -&gt; Position -&gt; Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Position
</span><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos -&gt; Int
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Pos.html#sourceLine"><span class="hs-identifier hs-var">P.sourceLine</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679551598"><span class="hs-identifier hs-var">ppos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos -&gt; Int
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Pos.html#sourceColumn"><span class="hs-identifier hs-var">P.sourceColumn</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679551598"><span class="hs-identifier hs-var">ppos</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679551604"><span class="annot"><span class="annottext">msg :: [Char]
</span><a href="#local-6989586621679551604"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-362"></span><span>          </span><span class="annot"><span class="annottext">[Char]
-&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; [Message] -&gt; [Char]
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Error.html#showErrorMessages"><span class="hs-identifier hs-var">P.showErrorMessages</span></a></span><span>
</span><span id="line-363"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;or&quot;</span></span><span>
</span><span id="line-364"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unknown parse error&quot;</span></span><span>
</span><span id="line-365"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;expecting&quot;</span></span><span>
</span><span id="line-366"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unexpected&quot;</span></span><span>
</span><span id="line-367"></span><span>            </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;end of input&quot;</span></span><span>
</span><span id="line-368"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseError -&gt; [Message]
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Error.html#errorMessages"><span class="hs-identifier hs-var">P.errorMessages</span></a></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679551597"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="annottext">Position -&gt; [Char] -&gt; ParseResult a
forall a. Position -&gt; [Char] -&gt; ParseResult a
</span><a href="Distribution.Fields.ParseResult.html#parseFatalFailure"><span class="hs-identifier hs-var">parseFatalFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551600"><span class="hs-identifier hs-var">epos</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ParseResult a) -&gt; [Char] -&gt; ParseResult a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551604"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621679551588"><span class="annot"><span class="annottext">p' :: Parsec FieldLineStream [PWarning] (a, [PWarning])
</span><a href="#local-6989586621679551588"><span class="hs-identifier hs-var hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; [PWarning] -&gt; (a, [PWarning]))
-&gt; ParsecT FieldLineStream [PWarning] Identity ()
-&gt; ParsecT
     FieldLineStream
     [PWarning]
     Identity
     (a -&gt; [PWarning] -&gt; (a, [PWarning]))
forall a b.
a
-&gt; ParsecT FieldLineStream [PWarning] Identity b
-&gt; ParsecT FieldLineStream [PWarning] Identity a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FieldLineStream [PWarning] Identity ()
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m ()
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Char.html#spaces"><span class="hs-identifier hs-var">P.spaces</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT
  FieldLineStream
  [PWarning]
  Identity
  (a -&gt; [PWarning] -&gt; (a, [PWarning]))
-&gt; ParsecT FieldLineStream [PWarning] Identity a
-&gt; ParsecT
     FieldLineStream [PWarning] Identity ([PWarning] -&gt; (a, [PWarning]))
forall a b.
ParsecT FieldLineStream [PWarning] Identity (a -&gt; b)
-&gt; ParsecT FieldLineStream [PWarning] Identity a
-&gt; ParsecT FieldLineStream [PWarning] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecParser a
-&gt; CabalSpecVersion
-&gt; ParsecT FieldLineStream [PWarning] Identity a
forall a.
ParsecParser a
-&gt; CabalSpecVersion -&gt; Parsec FieldLineStream [PWarning] a
</span><a href="Distribution.Parsec.html#unPP"><span class="hs-identifier hs-var">unPP</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecParser a
</span><a href="#local-6989586621679551584"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551585"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT
  FieldLineStream [PWarning] Identity ([PWarning] -&gt; (a, [PWarning]))
-&gt; ParsecT FieldLineStream [PWarning] Identity ()
-&gt; ParsecT
     FieldLineStream [PWarning] Identity ([PWarning] -&gt; (a, [PWarning]))
forall a b.
ParsecT FieldLineStream [PWarning] Identity a
-&gt; ParsecT FieldLineStream [PWarning] Identity b
-&gt; ParsecT FieldLineStream [PWarning] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FieldLineStream [PWarning] Identity ()
forall s (m :: * -&gt; *) u. Stream s m Char =&gt; ParsecT s u m ()
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Char.html#spaces"><span class="hs-identifier hs-var">P.spaces</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT
  FieldLineStream [PWarning] Identity ([PWarning] -&gt; (a, [PWarning]))
-&gt; ParsecT FieldLineStream [PWarning] Identity ()
-&gt; ParsecT
     FieldLineStream [PWarning] Identity ([PWarning] -&gt; (a, [PWarning]))
forall a b.
ParsecT FieldLineStream [PWarning] Identity a
-&gt; ParsecT FieldLineStream [PWarning] Identity b
-&gt; ParsecT FieldLineStream [PWarning] Identity a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FieldLineStream [PWarning] Identity ()
forall s (m :: * -&gt; *) t u.
(Stream s m t, Show t) =&gt;
ParsecT s u m ()
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Combinator.html#eof"><span class="hs-identifier hs-var">P.eof</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT
  FieldLineStream [PWarning] Identity ([PWarning] -&gt; (a, [PWarning]))
-&gt; ParsecT FieldLineStream [PWarning] Identity [PWarning]
-&gt; Parsec FieldLineStream [PWarning] (a, [PWarning])
forall a b.
ParsecT FieldLineStream [PWarning] Identity (a -&gt; b)
-&gt; ParsecT FieldLineStream [PWarning] Identity a
-&gt; ParsecT FieldLineStream [PWarning] Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT FieldLineStream [PWarning] Identity [PWarning]
forall (m :: * -&gt; *) s u. Monad m =&gt; ParsecT s u m u
</span><a href="../../parsec-3.1.18.0-a894/src/Text.Parsec.Prim.html#getState"><span class="hs-identifier hs-var">P.getState</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-comment">-- Positions start from 1:1, not 0:0</span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679551596"><span class="annot"><span class="annottext">mapPosition :: Position -&gt; Position
</span><a href="#local-6989586621679551596"><span class="hs-identifier hs-var hs-var">mapPosition</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span id="local-6989586621679551630"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551630"><span class="hs-identifier hs-var">prow</span></a></span></span><span> </span><span id="local-6989586621679551631"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551631"><span class="hs-identifier hs-var">pcol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Position] -&gt; Position
forall {t}. (Ord t, Num t) =&gt; t -&gt; [Position] -&gt; Position
</span><a href="#local-6989586621679551632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551630"><span class="hs-identifier hs-var">prow</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679551583"><span class="hs-identifier hs-var">inputPoss</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>        </span><span id="local-6989586621679551632"><span class="annot"><span class="annottext">go :: t -&gt; [Position] -&gt; Position
</span><a href="#local-6989586621679551632"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="Distribution.Parsec.Position.html#zeroPos"><span class="hs-identifier hs-var">zeroPos</span></a></span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><a href="#local-6989586621679551632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span id="local-6989586621679551648"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551648"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span id="local-6989586621679551649"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551649"><span class="hs-identifier hs-var">col</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Position
</span><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551648"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551649"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551631"><span class="hs-identifier hs-var">pcol</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><a href="#local-6989586621679551632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679551651"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679551651"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span id="local-6989586621679551652"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551652"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span id="local-6989586621679551653"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551653"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679551651"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Position
</span><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551652"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551653"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551631"><span class="hs-identifier hs-var">pcol</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><a href="#local-6989586621679551632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679551655"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679551655"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551656"><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679551656"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; [Position] -&gt; Position
</span><a href="#local-6989586621679551632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679551655"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679551656"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span id="local-6989586621679550730"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser"><span class="hs-identifier hs-type">runFieldParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Parsec.html#ParsecParser"><span class="hs-identifier hs-type">ParsecParser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550730"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.CabalSpecVersion.html#CabalSpecVersion"><span class="hs-identifier hs-type">CabalSpecVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Fields.ParseResult.html#ParseResult"><span class="hs-identifier hs-type">ParseResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550730"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-382"></span><span id="runFieldParser"><span class="annot"><span class="annottext">runFieldParser :: forall a.
Position
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; [FieldLine Position]
-&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser"><span class="hs-identifier hs-var hs-var">runFieldParser</span></a></span></span><span> </span><span id="local-6989586621679551657"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551657"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span id="local-6989586621679551658"><span class="annot"><span class="annottext">ParsecParser a
</span><a href="#local-6989586621679551658"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679551659"><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551659"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679551660"><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551660"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Position]
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; FieldLineStream
-&gt; ParseResult a
forall a.
[Position]
-&gt; ParsecParser a
-&gt; CabalSpecVersion
-&gt; FieldLineStream
-&gt; ParseResult a
</span><a href="Distribution.FieldGrammar.Parsec.html#runFieldParser%27"><span class="hs-identifier hs-var">runFieldParser'</span></a></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679551661"><span class="hs-identifier hs-var">poss</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecParser a
</span><a href="#local-6989586621679551658"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">CabalSpecVersion
</span><a href="#local-6989586621679551659"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldLine Position] -&gt; FieldLineStream
forall ann. [FieldLine ann] -&gt; FieldLineStream
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldLinesToStream"><span class="hs-identifier hs-var">fieldLinesToStream</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551660"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621679551661"><span class="annot"><span class="annottext">poss :: [Position]
</span><a href="#local-6989586621679551661"><span class="hs-identifier hs-var hs-var">poss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FieldLine Position -&gt; Position)
-&gt; [FieldLine Position] -&gt; [Position]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span id="local-6989586621679551662"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551662"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551662"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551660"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Position] -&gt; [Position] -&gt; [Position]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551657"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- add &quot;default&quot; position</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span id="local-6989586621679550766"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToBS"><span class="hs-identifier hs-type">fieldlinesToBS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550766"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.Internal.Type.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a></span></span><span>
</span><span id="line-387"></span><span id="fieldlinesToBS"><span class="annot"><span class="annottext">fieldlinesToBS :: forall ann. [FieldLine ann] -&gt; FieldName
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToBS"><span class="hs-identifier hs-var hs-var">fieldlinesToBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [FieldName] -&gt; FieldName
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#intercalate"><span class="hs-identifier hs-var">BS.intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([FieldName] -&gt; FieldName)
-&gt; ([FieldLine ann] -&gt; [FieldName]) -&gt; [FieldLine ann] -&gt; FieldName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FieldLine ann -&gt; FieldName) -&gt; [FieldLine ann] -&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679551667"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551667"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551667"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- Example package with dot lines</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- http://hackage.haskell.org/package/copilot-cbmc-0.1/copilot-cbmc.cabal</span><span>
</span><span id="line-391"></span><span id="local-6989586621679550746"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText"><span class="hs-identifier hs-type">fieldlinesToFreeText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550746"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-392"></span><span id="fieldlinesToFreeText"><span class="annot"><span class="annottext">fieldlinesToFreeText :: forall ann. [FieldLine ann] -&gt; [Char]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText"><span class="hs-identifier hs-var hs-var">fieldlinesToFreeText</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-393"></span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText"><span class="hs-identifier hs-var">fieldlinesToFreeText</span></a></span><span> </span><span id="local-6989586621679551672"><span class="annot"><span class="annottext">[FieldLine ann]
</span><a href="#local-6989586621679551672"><span class="hs-identifier hs-var">fls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldLine ann -&gt; [Char]) -&gt; [FieldLine ann] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FieldLine ann -&gt; [Char]
forall {ann}. FieldLine ann -&gt; [Char]
</span><a href="#local-6989586621679551673"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine ann]
</span><a href="#local-6989586621679551672"><span class="hs-identifier hs-var">fls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621679551673"><span class="annot"><span class="annottext">go :: FieldLine ann -&gt; [Char]
</span><a href="#local-6989586621679551673"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679551680"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551680"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551681"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679551681"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-399"></span><span>        </span><span id="local-6989586621679551681"><span class="annot"><span class="annottext">s :: [Char]
</span><a href="#local-6989586621679551681"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Distribution.Utils.String.html#trim"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
</span><a href="Distribution.Utils.Generic.html#fromUTF8BS"><span class="hs-identifier hs-var">fromUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551680"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText3"><span class="hs-identifier hs-type">fieldlinesToFreeText3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-402"></span><span id="fieldlinesToFreeText3"><span class="annot"><span class="annottext">fieldlinesToFreeText3 :: Position -&gt; [FieldLine Position] -&gt; [Char]
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText3"><span class="hs-identifier hs-var hs-var">fieldlinesToFreeText3</span></a></span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-403"></span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText3"><span class="hs-identifier hs-var">fieldlinesToFreeText3</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679551682"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551682"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
</span><a href="Distribution.Utils.Generic.html#fromUTF8BS"><span class="hs-identifier hs-var">fromUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551682"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-404"></span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldlinesToFreeText3"><span class="hs-identifier hs-var">fieldlinesToFreeText3</span></a></span><span> </span><span id="local-6989586621679551683"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551683"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span id="local-6989586621679551684"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551684"><span class="hs-identifier hs-var">pos1</span></a></span></span><span> </span><span id="local-6989586621679551685"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551685"><span class="hs-identifier hs-var">bs1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551686"><span class="annot"><span class="annottext">fls2 :: [FieldLine Position]
</span><a href="#local-6989586621679551686"><span class="hs-identifier hs-var">fls2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span id="local-6989586621679551687"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551687"><span class="hs-identifier hs-var">pos2</span></a></span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-comment">-- if first line is on the same line with field name:</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-comment">-- the indentation level is either</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-comment">-- 1. the indentation of left most line in rest fields</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-comment">-- 2. the indentation of the first line</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-comment">-- whichever is leftmost</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionRow"><span class="hs-identifier hs-var">positionRow</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551683"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionRow"><span class="hs-identifier hs-var">positionRow</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551684"><span class="hs-identifier hs-var">pos1</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>      </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-412"></span><span>        </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
</span><a href="Distribution.Utils.Generic.html#fromUTF8BS"><span class="hs-identifier hs-var">fromUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551685"><span class="hs-identifier hs-var">bs1</span></a></span><span>
</span><span id="line-413"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [[Char]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Position -&gt; FieldLine Position -&gt; (Position, [Char]))
-&gt; Position -&gt; [FieldLine Position] -&gt; [[Char]]
forall s a b. (s -&gt; a -&gt; (s, b)) -&gt; s -&gt; [a] -&gt; [b]
</span><a href="Distribution.FieldGrammar.Parsec.html#mealy"><span class="hs-identifier hs-var">mealy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Position -&gt; FieldLine Position -&gt; (Position, [Char])
</span><a href="#local-6989586621679551690"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551691"><span class="hs-identifier hs-var">mcol1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551684"><span class="hs-identifier hs-var">pos1</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551686"><span class="hs-identifier hs-var">fls2</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-comment">-- otherwise, also indent the first line</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-417"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; [Char]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionCol"><span class="hs-identifier hs-var">positionCol</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551684"><span class="hs-identifier hs-var">pos1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551693"><span class="hs-identifier hs-var">mcol2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-418"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [[Char]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
</span><a href="Distribution.Utils.Generic.html#fromUTF8BS"><span class="hs-identifier hs-var">fromUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551685"><span class="hs-identifier hs-var">bs1</span></a></span><span>
</span><span id="line-419"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [[Char]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Position -&gt; FieldLine Position -&gt; (Position, [Char]))
-&gt; Position -&gt; [FieldLine Position] -&gt; [[Char]]
forall s a b. (s -&gt; a -&gt; (s, b)) -&gt; s -&gt; [a] -&gt; [b]
</span><a href="Distribution.FieldGrammar.Parsec.html#mealy"><span class="hs-identifier hs-var">mealy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Position -&gt; FieldLine Position -&gt; (Position, [Char])
</span><a href="#local-6989586621679551690"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551693"><span class="hs-identifier hs-var">mcol2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551684"><span class="hs-identifier hs-var">pos1</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551686"><span class="hs-identifier hs-var">fls2</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-421"></span><span>    </span><span id="local-6989586621679551691"><span class="annot"><span class="annottext">mcol1 :: Int
</span><a href="#local-6989586621679551691"><span class="hs-identifier hs-var hs-var">mcol1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FieldLine Position -&gt; Int)
-&gt; Int -&gt; [FieldLine Position] -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679551698"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551698"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679551699"><span class="annot"><span class="annottext">FieldLine Position
</span><a href="#local-6989586621679551699"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551698"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionCol"><span class="hs-identifier hs-var">positionCol</span></a></span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Int) -&gt; Position -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldLine Position -&gt; Position
forall ann. FieldLine ann -&gt; ann
</span><a href="Distribution.Fields.Field.html#fieldLineAnn"><span class="hs-identifier hs-var">fieldLineAnn</span></a></span><span> </span><span class="annot"><span class="annottext">FieldLine Position
</span><a href="#local-6989586621679551699"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionCol"><span class="hs-identifier hs-var">positionCol</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551684"><span class="hs-identifier hs-var">pos1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionCol"><span class="hs-identifier hs-var">positionCol</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551687"><span class="hs-identifier hs-var">pos2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551686"><span class="hs-identifier hs-var">fls2</span></a></span><span>
</span><span id="line-422"></span><span>    </span><span id="local-6989586621679551693"><span class="annot"><span class="annottext">mcol2 :: Int
</span><a href="#local-6989586621679551693"><span class="hs-identifier hs-var hs-var">mcol2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FieldLine Position -&gt; Int)
-&gt; Int -&gt; [FieldLine Position] -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679551704"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551704"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679551705"><span class="annot"><span class="annottext">FieldLine Position
</span><a href="#local-6989586621679551705"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551704"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionCol"><span class="hs-identifier hs-var">positionCol</span></a></span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Int) -&gt; Position -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldLine Position -&gt; Position
forall ann. FieldLine ann -&gt; ann
</span><a href="Distribution.Fields.Field.html#fieldLineAnn"><span class="hs-identifier hs-var">fieldLineAnn</span></a></span><span> </span><span class="annot"><span class="annottext">FieldLine Position
</span><a href="#local-6989586621679551705"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionCol"><span class="hs-identifier hs-var">positionCol</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551684"><span class="hs-identifier hs-var">pos1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldLine Position]
</span><a href="#local-6989586621679551686"><span class="hs-identifier hs-var">fls2</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><a href="#local-6989586621679551690"><span class="hs-identifier hs-type">mk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Parsec.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>    </span><span id="local-6989586621679551690"><span class="annot"><span class="annottext">mk :: Int -&gt; Position -&gt; FieldLine Position -&gt; (Position, [Char])
</span><a href="#local-6989586621679551690"><span class="hs-identifier hs-var hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679551706"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551706"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span id="local-6989586621679551707"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551707"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span id="local-6989586621679551708"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551708"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679551709"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551709"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551708"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-427"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; [Char]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551710"><span class="hs-identifier hs-var">newlines</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span>
</span><span id="line-428"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; [Char]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551711"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-429"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [Char]
</span><a href="Distribution.Utils.Generic.html#fromUTF8BS"><span class="hs-identifier hs-var">fromUTF8BS</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551709"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-432"></span><span>        </span><span id="local-6989586621679551710"><span class="annot"><span class="annottext">newlines :: Int
</span><a href="#local-6989586621679551710"><span class="hs-identifier hs-var hs-var">newlines</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionRow"><span class="hs-identifier hs-var">positionRow</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551708"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionRow"><span class="hs-identifier hs-var">positionRow</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551707"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-433"></span><span>        </span><span id="local-6989586621679551711"><span class="annot"><span class="annottext">indent :: Int
</span><a href="#local-6989586621679551711"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
</span><a href="Distribution.Parsec.Position.html#positionCol"><span class="hs-identifier hs-var">positionCol</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679551708"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679551706"><span class="hs-identifier hs-var">col</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span id="local-6989586621679550842"><span id="local-6989586621679550843"><span id="local-6989586621679550844"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#mealy"><span class="hs-identifier hs-type">mealy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679550842"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679550843"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679550842"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679550844"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679550842"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679550843"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679550844"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-436"></span><span id="mealy"><span class="annot"><span class="annottext">mealy :: forall s a b. (s -&gt; a -&gt; (s, b)) -&gt; s -&gt; [a] -&gt; [b]
</span><a href="Distribution.FieldGrammar.Parsec.html#mealy"><span class="hs-identifier hs-var hs-var">mealy</span></a></span></span><span> </span><span id="local-6989586621679551714"><span class="annot"><span class="annottext">s -&gt; a -&gt; (s, b)
</span><a href="#local-6989586621679551714"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; [a] -&gt; [b]
</span><a href="#local-6989586621679551715"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621679551715"><span class="annot"><span class="annottext">go :: s -&gt; [a] -&gt; [b]
</span><a href="#local-6989586621679551715"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><a href="#local-6989586621679551715"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679551716"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679551716"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679551717"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551717"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551718"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679551718"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span id="local-6989586621679551719"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679551719"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679551720"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679551720"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; a -&gt; (s, b)
</span><a href="#local-6989586621679551714"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679551716"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679551717"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679551720"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; [a] -&gt; [b]
</span><a href="#local-6989586621679551715"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679551719"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679551718"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span id="local-6989586621679550836"><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldLinesToStream"><span class="hs-identifier hs-type">fieldLinesToStream</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679550836"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Distribution.Parsec.FieldLineStream.html#FieldLineStream"><span class="hs-identifier hs-type">FieldLineStream</span></a></span></span><span>
</span><span id="line-442"></span><span id="fieldLinesToStream"><span class="annot"><span class="annottext">fieldLinesToStream :: forall ann. [FieldLine ann] -&gt; FieldLineStream
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldLinesToStream"><span class="hs-identifier hs-var hs-var">fieldLinesToStream</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldLineStream
</span><a href="Distribution.Parsec.FieldLineStream.html#fieldLineStreamEnd"><span class="hs-identifier hs-var">fieldLineStreamEnd</span></a></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldLinesToStream"><span class="hs-identifier hs-var">fieldLinesToStream</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679551722"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551722"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; FieldLineStream
</span><a href="Distribution.Parsec.FieldLineStream.html#FLSLast"><span class="hs-identifier hs-var">FLSLast</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551722"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Distribution.FieldGrammar.Parsec.html#fieldLinesToStream"><span class="hs-identifier hs-var">fieldLinesToStream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Distribution.Fields.Field.html#FieldLine"><span class="hs-identifier hs-type">FieldLine</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679551724"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551724"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679551725"><span class="annot"><span class="annottext">[FieldLine ann]
</span><a href="#local-6989586621679551725"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; FieldLineStream -&gt; FieldLineStream
</span><a href="Distribution.Parsec.FieldLineStream.html#FLSCons"><span class="hs-identifier hs-var">FLSCons</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679551724"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldLine ann] -&gt; FieldLineStream
forall ann. [FieldLine ann] -&gt; FieldLineStream
</span><a href="Distribution.FieldGrammar.Parsec.html#fieldLinesToStream"><span class="hs-identifier hs-var">fieldLinesToStream</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldLine ann]
</span><a href="#local-6989586621679551725"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span></pre></body></html>