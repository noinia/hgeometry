<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Convex.Instances</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Arbitrary instances for the convex polygon types in hgeometry</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Instances.html"><span class="hs-identifier">HGeometry.Polygon.Convex.Instances</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-a899d5c5a01627aaa8ea220757a4162fe451c1e9a71c0227ccef47377048bb9c/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Convex.Unbounded</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.ConvexHull.html"><span class="hs-identifier">HGeometry.ConvexHull</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Triangle</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Kernel.Instances</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.html"><span class="hs-identifier">Test.QuickCheck</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/quickcheck-instances-0.3.33-8b00824e9a40b4835aba8bb3cff3943f36772a6fe079c050c4f7bb9e45880b37/share/doc/html/src/Test.QuickCheck.Instances.html"><span class="hs-identifier">Test.QuickCheck.Instances</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/hspec-core-2.11.14-5d6d642fd96f1bc95cbe2c7bfe11ccadf57fdd755d68783453f112fca58f16f5/share/doc/html/src/NonEmpty.html"><span class="hs-identifier">NonEmpty</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679226511"><span id="local-6989586621679226512"><span id="local-6989586621679226606"><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.Arbitrary.html#Arbitrary"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226511"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679226511"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679226512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679226512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679226512"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679226511"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-31"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.Arbitrary.html#Arbitrary"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConvexPolygon</span></span><span> </span><span class="annot"><a href="#local-6989586621679226511"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>  </span><span id="local-6989586621679226804"><span class="annot"><span class="annottext">arbitrary :: Gen (ConvexPolygon point)
</span><a href="#local-6989586621679226804"><span class="hs-identifier hs-var hs-var hs-var">arbitrary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span id="local-6989586621679226807"><span class="annot"><a href="#local-6989586621679226807"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679226808"><span class="annot"><a href="#local-6989586621679226808"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679226809"><span class="annot"><a href="#local-6989586621679226809"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Triangle point)
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-33"></span><span>                 </span><span id="local-6989586621679226810"><span class="annot"><a href="#local-6989586621679226810"><span class="hs-identifier hs-var">rest</span></a></span></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-type">arbitrary</span></a></span><span>
</span><span id="line-34"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-1.0.0.0/doc/html/hgeometry/src/HGeometry.ConvexHull.GrahamScan.html#convexHull"><span class="hs-identifier hs-type">convexHull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679226807"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><a href="#local-6989586621679226808"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679226809"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679226810"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-comment">-- I guess we may end up having still relatively few vertices on the CH</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679226531"><span id="local-6989586621679226532"><span id="local-6989586621679226820"><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.Arbitrary.html#Arbitrary"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226531"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679226531"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679226532"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679226532"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679226532"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679226531"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-39"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.Arbitrary.html#Arbitrary"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></span><span> </span><span class="annot"><a href="#local-6989586621679226532"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679226531"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679227001"><span class="annot"><span class="annottext">arbitrary :: Gen (UnboundedConvexRegionF r NonEmpty point)
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var hs-var hs-var">arbitrary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen (ConvexPolygon point)
forall a. Arbitrary a =&gt; Gen a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/QuickCheck-2.16.0.0-2595d0c9e167abee34d86676c8986a3c6d55a7901ab85bbe41269e53a88b7029/share/doc/html/src/Test.QuickCheck.Arbitrary.html#arbitrary"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (ConvexPolygon point)
-&gt; (ConvexPolygon point -&gt; UnboundedConvexRegionF r NonEmpty point)
-&gt; Gen (UnboundedConvexRegionF r NonEmpty point)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679227003"><span class="annot"><span class="annottext">ConvexPolygon point
</span><a href="#local-6989586621679227003"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConvexPolygon</span></span><span> </span><span class="annot"><a href="#local-6989586621679226531"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679227004"><span class="annot"><span class="annottext">vs :: NonEmpty (point, (point, point))
</span><a href="#local-6989586621679227004"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679227005"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227005"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227006"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227006"><span class="hs-identifier hs-var">prev'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">point
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">[(point, (point, point))]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting
  (NonEmptyDList (point, (point, point)))
  (ConvexPolygon point)
  (point, (point, point))
-&gt; ConvexPolygon point -&gt; NonEmpty (point, (point, point))
forall a s. Getting (NonEmptyDList a) s a -&gt; s -&gt; NonEmpty a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-a899d5c5a01627aaa8ea220757a4162fe451c1e9a71c0227ccef47377048bb9c/share/doc/html/src/Control.Lens.Fold.html#toNonEmptyOf"><span class="hs-identifier hs-var">toNonEmptyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (NonEmptyDList (point, (point, point)))
  (ConvexPolygon point)
  (point, (point, point))
((Vertex (ConvexPolygon point),
  (Vertex (ConvexPolygon point), Vertex (ConvexPolygon point)))
 -&gt; Const
      (NonEmptyDList (point, (point, point)))
      (Vertex (ConvexPolygon point),
       (Vertex (ConvexPolygon point), Vertex (ConvexPolygon point))))
-&gt; ConvexPolygon point
-&gt; Const
     (NonEmptyDList (point, (point, point))) (ConvexPolygon point)
forall polygon.
(HasOuterBoundary polygon, VertexIx polygon ~ Int) =&gt;
IndexedFold1
  (VertexIx polygon, (VertexIx polygon, VertexIx polygon))
  polygon
  (Vertex polygon, (Vertex polygon, Vertex polygon))
IndexedFold1
  (VertexIx (ConvexPolygon point),
   (VertexIx (ConvexPolygon point), VertexIx (ConvexPolygon point)))
  (ConvexPolygon point)
  (Vertex (ConvexPolygon point),
   (Vertex (ConvexPolygon point), Vertex (ConvexPolygon point)))
</span><span class="hs-identifier hs-var">outerBoundaryWithNeighbours</span></span><span> </span><span class="annot"><span class="annottext">ConvexPolygon point
</span><a href="#local-6989586621679227003"><span class="hs-identifier hs-var">ch</span></a></span><span>
</span><span id="line-42"></span><span>        </span><span id="local-6989586621679227009"><span class="annot"><span class="annottext">v :: Vector 2 r
</span><a href="#local-6989586621679227009"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227005"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Vector 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227006"><span class="hs-identifier hs-var">prev'</span></a></span><span>
</span><span id="line-43"></span><span>        </span><span id="local-6989586621679227011"><span class="annot"><span class="annottext">stillDiverging :: (point, (point, point)) -&gt; Bool
</span><a href="#local-6989586621679227011"><span class="hs-identifier hs-var hs-var">stillDiverging</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227012"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227012"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679227013"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227013"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; point -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227012"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; Vector 2 r -&gt; point
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.-^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679227009"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227012"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227013"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(point, (point, point))]
-&gt; Maybe (NonEmpty (point, (point, point)))
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NonEmpty.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">([(point, (point, point))]
 -&gt; Maybe (NonEmpty (point, (point, point))))
-&gt; [(point, (point, point))]
-&gt; Maybe (NonEmpty (point, (point, point)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((point, (point, point)) -&gt; Bool)
-&gt; NonEmpty (point, (point, point)) -&gt; [(point, (point, point))]
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.takeWhile</span></span><span> </span><span class="annot"><span class="annottext">(point, (point, point)) -&gt; Bool
</span><a href="#local-6989586621679227011"><span class="hs-identifier hs-var">stillDiverging</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (point, (point, point))
</span><a href="#local-6989586621679227004"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-45"></span><span>         </span><span class="annot"><span class="annottext">Maybe (NonEmpty (point, (point, point)))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; UnboundedConvexRegionF r NonEmpty point
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;UnBoundedConvexRegion.arbitrary; this should be impossible&quot;</span></span><span>
</span><span id="line-46"></span><span>                     </span><span class="hs-comment">-- Unbounded    v (p :| [])                      (next' .-. p)</span><span>
</span><span id="line-47"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679227020"><span class="annot"><span class="annottext">NonEmpty (point, (point, point))
</span><a href="#local-6989586621679227020"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679227021"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227021"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679227022"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227022"><span class="hs-identifier hs-var">nextQ</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (point, (point, point)) -&gt; (point, (point, point))
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.last</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (point, (point, point))
</span><a href="#local-6989586621679227020"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-48"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
-&gt; NonEmpty point
-&gt; Vector 2 r
-&gt; UnboundedConvexRegionF r NonEmpty point
forall r (nonEmpty :: * -&gt; *) vertex.
Vector 2 r
-&gt; nonEmpty vertex
-&gt; Vector 2 r
-&gt; UnboundedConvexRegionF r nonEmpty vertex
</span><span class="hs-identifier hs-var">Unbounded</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679227009"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(point, (point, point)) -&gt; point
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((point, (point, point)) -&gt; point)
-&gt; NonEmpty (point, (point, point)) -&gt; NonEmpty point
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (point, (point, point))
</span><a href="#local-6989586621679227020"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227022"><span class="hs-identifier hs-var">nextQ</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Vector 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679227021"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span></pre></body></html>