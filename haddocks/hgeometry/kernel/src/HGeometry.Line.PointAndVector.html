<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  HGeometry.Line.PointAndLine</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- \(d\)-dimensional lines.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html"><span class="hs-identifier">HGeometry.Line.PointAndVector</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier">LinePV</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#anchorPoint"><span class="hs-identifier">anchorPoint</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#HasDirection"><span class="hs-identifier">HasDirection</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#isIdenticalTo"><span class="hs-identifier">isIdenticalTo</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#HasSupportingLine"><span class="hs-identifier">HasSupportingLine</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#fromLinearFunction"><span class="hs-identifier">fromLinearFunction</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#toLinearFunction"><span class="hs-identifier">toLinearFunction</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#SideTestUpDown"><span class="hs-identifier">SideTestUpDown</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#OnSideUpDownTest"><span class="hs-identifier">OnSideUpDownTest</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#liesAbove"><span class="hs-identifier">liesAbove</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#liesBelow"><span class="hs-identifier">liesBelow</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#SideTest"><span class="hs-identifier">SideTest</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#onSide"><span class="hs-identifier">onSide</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#leftHalfPlane"><span class="hs-identifier">leftHalfPlane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#rightHalfPlane"><span class="hs-identifier">rightHalfPlane</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#bisector"><span class="hs-identifier">bisector</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#perpendicularTo"><span class="hs-identifier">perpendicularTo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#isPerpendicularTo"><span class="hs-identifier">isPerpendicularTo</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#cmpSlope"><span class="hs-identifier">cmpSlope</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sign.html/HGeometry.Sign.html"><span class="hs-identifier">HGeometry.Sign</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.HyperPlane.Class.html"><span class="hs-identifier">HGeometry.HyperPlane.Class</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Intersection.html"><span class="hs-identifier">HGeometry.Intersection</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Line.Class.html"><span class="hs-identifier">HGeometry.Line.Class</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Line.Intersection.html"><span class="hs-identifier">HGeometry.Line.Intersection</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Line.LineEQ.html"><span class="hs-identifier">HGeometry.Line.LineEQ</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.HalfSpace.html"><span class="hs-identifier">HGeometry.HalfSpace</span></a></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- import           HGeometry.Point.EuclideanDistance</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- import           HGeometry.Point.Orientation.Degenerate</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Properties</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NumType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Dimension</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-56"></span><span class="annot"><span class="hs-comment">-- * d-dimensional Lines</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | A line is given by an anchor point and a vector indicating the</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- direction.</span><span>
</span><span id="line-60"></span><span class="hs-keyword">data</span><span> </span><span id="LinePV"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span></span><span> </span><span id="local-6989586621679430684"><span class="annot"><a href="#local-6989586621679430684"><span class="hs-identifier hs-type">d</span></a></span></span><span> </span><span id="local-6989586621679430685"><span class="annot"><a href="#local-6989586621679430685"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LinePV"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_anchorPoint"><span class="annot"><span class="annottext">forall (d :: Nat) r. LinePV d r -&gt; Point d r
</span><a href="HGeometry.Line.PointAndVector.html#_anchorPoint"><span class="hs-identifier hs-var hs-var">_anchorPoint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span>  </span><span class="annot"><a href="#local-6989586621679430684"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430685"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="_direction"><span class="annot"><span class="annottext">forall (d :: Nat) r. LinePV d r -&gt; Vector d r
</span><a href="HGeometry.Line.PointAndVector.html#_direction"><span class="hs-identifier hs-var hs-var">_direction</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679430684"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430685"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>                         </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679431109"><span id="local-6989586621679431111"><span class="annot"><span class="annottext">(forall x. LinePV d r -&gt; Rep (LinePV d r) x)
-&gt; (forall x. Rep (LinePV d r) x -&gt; LinePV d r)
-&gt; Generic (LinePV d r)
forall (d :: Nat) r x. Rep (LinePV d r) x -&gt; LinePV d r
forall (d :: Nat) r x. LinePV d r -&gt; Rep (LinePV d r) x
forall x. Rep (LinePV d r) x -&gt; LinePV d r
forall x. LinePV d r -&gt; Rep (LinePV d r) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall (d :: Nat) r x. LinePV d r -&gt; Rep (LinePV d r) x
from :: forall x. LinePV d r -&gt; Rep (LinePV d r) x
$cto :: forall (d :: Nat) r x. Rep (LinePV d r) x -&gt; LinePV d r
to :: forall x. Rep (LinePV d r) x -&gt; LinePV d r
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><span class="hs-identifier hs-var">Dimension</span></span></span><span> </span><span id="local-6989586621679431116"><span id="local-6989586621679431117"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431116"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431117"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679431116"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><span class="hs-identifier hs-var">NumType</span></span></span><span>   </span><span id="local-6989586621679431118"><span id="local-6989586621679431119"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431118"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431119"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679431119"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="annot"><span class="hs-comment">-- | Types that have a Direction field</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">class</span><span> </span><span id="HasDirection"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#HasDirection"><span class="hs-identifier hs-var">HasDirection</span></a></span></span><span> </span><span id="local-6989586621679430708"><span class="annot"><a href="#local-6989586621679430708"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-comment">-- | Lens to access the direction field</span><span>
</span><span id="line-70"></span><span>  </span><span id="direction"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#direction"><span class="hs-identifier hs-type">direction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679430703"><span id="local-6989586621679430705"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="annot"><a href="#local-6989586621679430708"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679430703"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679430708"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679430705"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430708"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679430703"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430705"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430709"><span id="local-6989586621679430710"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#HasDirection"><span class="hs-identifier hs-type">HasDirection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430709"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430710"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679431134"><span class="annot"><span class="annottext">direction :: forall (d :: Nat) r.
(Dimension (LinePV d r) ~ d, NumType (LinePV d r) ~ r) =&gt;
Lens' (LinePV d r) (Vector d r)
</span><a href="HGeometry.Line.PointAndVector.html#direction"><span class="hs-identifier hs-var hs-var hs-var">direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LinePV d r -&gt; Vector d r)
-&gt; (LinePV d r -&gt; Vector d r -&gt; LinePV d r)
-&gt; Lens (LinePV d r) (LinePV d r) (Vector d r) (Vector d r)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV d r -&gt; Vector d r
LinePV d r -&gt; Vector d r
forall (d :: Nat) r. LinePV d r -&gt; Vector d r
</span><a href="HGeometry.Line.PointAndVector.html#_direction"><span class="hs-identifier hs-var">_direction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679431136"><span class="annot"><span class="annottext">LinePV d r
</span><a href="#local-6989586621679431136"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679431137"><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431137"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LinePV d r
</span><a href="#local-6989586621679431136"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#_direction"><span class="hs-identifier hs-var">_direction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679431137"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#direction"><span class="hs-pragma hs-type">direction</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="annot"><span class="hs-comment">-- | Lens to access the anchor point of the line</span></span><span>
</span><span id="line-77"></span><span id="local-6989586621679430723"><span id="local-6989586621679430724"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#anchorPoint"><span class="hs-identifier hs-type">anchorPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430723"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430724"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><a href="#local-6989586621679430723"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430724"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-78"></span><span id="anchorPoint"><span class="annot"><span class="annottext">anchorPoint :: forall (d :: Nat) r (f :: * -&gt; *).
Functor f =&gt;
(Point d r -&gt; f (Point d r)) -&gt; LinePV d r -&gt; f (LinePV d r)
</span><a href="HGeometry.Line.PointAndVector.html#anchorPoint"><span class="hs-identifier hs-var hs-var">anchorPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LinePV d r -&gt; Point d r)
-&gt; (LinePV d r -&gt; Point d r -&gt; LinePV d r)
-&gt; Lens (LinePV d r) (LinePV d r) (Point d r) (Point d r)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV d r -&gt; Point d r
forall (d :: Nat) r. LinePV d r -&gt; Point d r
</span><a href="HGeometry.Line.PointAndVector.html#_anchorPoint"><span class="hs-identifier hs-var">_anchorPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679431140"><span class="annot"><span class="annottext">LinePV d r
</span><a href="#local-6989586621679431140"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679431141"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431141"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LinePV d r
</span><a href="#local-6989586621679431140"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#_anchorPoint"><span class="hs-identifier hs-var">_anchorPoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679431141"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430738"><span id="local-6989586621679430739"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Metric_</span></span><span> </span><span class="annot"><a href="#local-6989586621679430738"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430739"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.Class.html#Line_"><span class="hs-identifier hs-type">Line_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430738"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430739"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679430738"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430739"><span class="hs-identifier hs-type">r</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>  </span><span id="local-6989586621679431162"><span class="annot"><span class="annottext">fromPointAndVec :: forall point.
(Point_ point d r, Line_ (LinePV d r) d r, Num r) =&gt;
point -&gt; Vector d r -&gt; LinePV d r
</span><a href="#local-6989586621679431162"><span class="hs-identifier hs-var hs-var hs-var">fromPointAndVec</span></a></span></span><span> </span><span id="local-6989586621679431164"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431164"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679431165"><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431165"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Vector d r -&gt; LinePV d r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431164"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point d r) point (Point d r) -&gt; Point d r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point d r) point (Point d r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point d r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431165"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Vector d r
-&gt; Getting (Vector d r) (Vector d r) (Vector d r) -&gt; Vector d r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Vector d r) (Vector d r) (Vector d r)
forall vector vector' (d :: Nat) r s.
AsVector_ vector vector' d r s =&gt;
Iso vector vector' (Vector d r) (Vector d s)
Iso (Vector d r) (Vector d r) (Vector d r) (Vector d r)
</span><span class="hs-identifier hs-var">_Vector</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430776"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679430776"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679430776"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-86"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.HyperPlane.Class.html#ConstructableHyperPlane_"><span class="hs-identifier hs-type">ConstructableHyperPlane_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430776"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430776"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="HyperPlaneFromEquationConstraint"><span class="annot"><a href="HGeometry.HyperPlane.Class.html#HyperPlaneFromEquationConstraint"><span class="hs-identifier hs-var">HyperPlaneFromEquationConstraint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430776"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430776"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679430776"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">-- equation: line equation is: c + ax + by = 0</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-comment">-- pre: not all of a b and c are zero</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679431191"><span class="annot"><span class="annottext">hyperPlaneFromEquation :: HyperPlaneFromEquationConstraint (LinePV 2 r) 2 r =&gt;
Vector (2 + 1) r -&gt; LinePV 2 r
</span><a href="#local-6989586621679431191"><span class="hs-identifier hs-var hs-var hs-var">hyperPlaneFromEquation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector3</span></span><span> </span><span id="local-6989586621679431194"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431194"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679431195"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431195"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679431196"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431196"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431196"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Point 2 r
forall r. r -&gt; r -&gt; Point 2 r
</span><span class="hs-identifier hs-var">Point2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431194"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431195"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Vector 2 r
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- if b=0 we are vertical</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Point 2 r
forall r. r -&gt; r -&gt; Point 2 r
</span><span class="hs-identifier hs-var">Point2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431194"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431196"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Vector 2 r
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431194"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431195"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679431205"><span class="annot"><span class="annottext">fromPointAndNormal :: forall point.
(Point_ point 2 r, Num r) =&gt;
point -&gt; Vector 2 r -&gt; LinePV 2 r
</span><a href="#local-6989586621679431205"><span class="hs-identifier hs-var hs-var hs-var">fromPointAndNormal</span></a></span></span><span> </span><span id="local-6989586621679431207"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431207"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679431208"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431208"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span id="local-6989586621679431209"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431209"><span class="hs-identifier hs-var">vy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431207"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point 2 r) point (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Vector 2 r
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431209"><span class="hs-identifier hs-var">vy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431208"><span class="hs-identifier hs-var">vx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430789"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679430789"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.HyperPlane.Class.html#HyperPlaneFromPoints"><span class="hs-identifier hs-type">HyperPlaneFromPoints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430789"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679431235"><span class="annot"><span class="annottext">hyperPlaneThrough :: forall point (d :: Nat) r.
(Point_ point d r, HyperPlane_ (LinePV 2 r) d r, Num r) =&gt;
Vector d point -&gt; LinePV 2 r
</span><a href="#local-6989586621679431235"><span class="hs-identifier hs-var hs-var hs-var">hyperPlaneThrough</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679431237"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431237"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679431238"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431238"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431237"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point 2 r) point (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431238"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Vector 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431237"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679431240"><span id="local-6989586621679431256"><span id="local-6989586621679431266"><span id="local-6989586621679431277"><span id="local-6989586621679431286"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679431240"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679431240"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-104"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.HyperPlane.Class.html#HyperPlane_"><span class="hs-identifier hs-type">HyperPlane_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431240"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431240"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679431307"><span class="annot"><span class="annottext">hyperPlaneEquation :: Num r =&gt; LinePV 2 r -&gt; Vector (2 + 1) r
</span><a href="#local-6989586621679431307"><span class="hs-identifier hs-var hs-var hs-var">hyperPlaneEquation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point2</span></span><span> </span><span id="local-6989586621679431309"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431309"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span id="local-6989586621679431310"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431310"><span class="hs-identifier hs-var">py</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679431311"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431311"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span id="local-6989586621679431312"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431312"><span class="hs-identifier hs-var">vy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431311"><span class="hs-identifier hs-var">vx</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r -&gt; Vector 3 r
forall r. r -&gt; r -&gt; r -&gt; Vector 3 r
</span><span class="hs-identifier hs-var">Vector3</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431309"><span class="hs-identifier hs-var">px</span></a></span><span class="hs-special">)</span><span>         </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- vertical line at px</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r -&gt; Vector 3 r
forall r. r -&gt; r -&gt; r -&gt; Vector 3 r
</span><span class="hs-identifier hs-var">Vector3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431311"><span class="hs-identifier hs-var">vx</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431310"><span class="hs-identifier hs-var">py</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431312"><span class="hs-identifier hs-var">vy</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431309"><span class="hs-identifier hs-var">px</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431312"><span class="hs-identifier hs-var">vy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431311"><span class="hs-identifier hs-var">vx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- we have some non-vertical line: y = a1*x + a0 that goes through p</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">-- so we have: a0 + a1*px + a2*py = 0</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">-- our slope a1 = vy/vx, and our intercept a0 = py-(vy/vx)px, and a2 = (-1)</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-comment">-- multiplying everything by vx gets rid of the fraction, and yields the above equation.</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">{- HLINT ignore toLinearFunction -}</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | get values a,b s.t. the input line is described by y = ax + b.</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- returns Nothing if the line is vertical</span><span>
</span><span id="line-116"></span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#toLinearFunction"><span class="hs-identifier hs-type">toLinearFunction</span></a></span><span>                               </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679430815"><span class="annot"><a href="#local-6989586621679430815"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-117"></span><span>                                                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679430815"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679430815"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-118"></span><span>                                                  </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>                                               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430815"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.LineEQ.html#LineEQ"><span class="hs-identifier hs-type">LineEQ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430815"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span id="toLinearFunction"><span class="annot"><span class="annottext">toLinearFunction :: forall r. (Fractional r, Ord r) =&gt; LinePV 2 r -&gt; Maybe (LineEQ r)
</span><a href="HGeometry.Line.PointAndVector.html#toLinearFunction"><span class="hs-identifier hs-var hs-var">toLinearFunction</span></a></span></span><span> </span><span id="local-6989586621679431326"><span class="annot"><span class="annottext">l :: LinePV 2 r
</span><a href="#local-6989586621679431326"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679431327"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431327"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span id="local-6989586621679431328"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431328"><span class="hs-identifier hs-var">vy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431326"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; LinePV 2 r -&gt; Intersection (LinePV 2 r) (LinePV 2 r)
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><a href="HGeometry.Intersection.html#intersect"><span class="hs-operator hs-var">`intersect`</span></a></span><span> </span><span class="annot"><span class="annottext">forall r line. (Line_ line 2 r, Num r) =&gt; r -&gt; line
</span><a href="HGeometry.Line.Class.html#verticalLine"><span class="hs-identifier hs-var">verticalLine</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679430815"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430815"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><span class="annottext">Maybe (LineLineIntersectionG r (LinePV 2 r))
Intersection (LinePV 2 r) (LinePV 2 r)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (LineEQ r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- l is vertical</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.Intersection.html#Line_x_Line_Point"><span class="hs-identifier hs-type">Line_x_Line_Point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679431332"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431332"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LineEQ r -&gt; Maybe (LineEQ r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LineEQ r -&gt; Maybe (LineEQ r)) -&gt; LineEQ r -&gt; Maybe (LineEQ r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; LineEQ r
forall r. r -&gt; r -&gt; LineEQ r
</span><a href="HGeometry.Line.LineEQ.html#LineEQ"><span class="hs-identifier hs-var">LineEQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431328"><span class="hs-identifier hs-var">vy</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431327"><span class="hs-identifier hs-var">vx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431332"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.Intersection.html#Line_x_Line_Line"><span class="hs-identifier hs-type">Line_x_Line_Line</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (LineEQ r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- l is a vertical line (through x=0)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430837"><span id="local-6989586621679430838"><span id="local-6989586621679431340"><span id="local-6989586621679431344"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679430837"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679430838"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-128"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Additive_</span></span><span> </span><span class="annot"><a href="#local-6989586621679430838"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430837"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-129"></span><span>         </span><span class="hs-comment">-- , OptVector_ d r, OptMetric_ d r</span><span>
</span><span id="line-130"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430838"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430837"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679431389"><span class="annot"><span class="annottext">showsPrec :: Int -&gt; LinePV d r -&gt; ShowS
</span><a href="#local-6989586621679431389"><span class="hs-identifier hs-var hs-var hs-var">showsPrec</span></a></span></span><span> </span><span id="local-6989586621679431391"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679431391"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431392"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431392"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679431393"><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431393"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
</span><span class="hs-identifier hs-var">showParen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679431391"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="HGeometry.Line.PointAndVector.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ShowS -&gt; ShowS) -&gt; ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-132"></span><span>                             </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-identifier hs-var">showString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LinePV &quot;</span></span><span>
</span><span id="line-133"></span><span>                             </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Point d r -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="HGeometry.Line.PointAndVector.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431392"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-134"></span><span>                             </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
</span><span class="hs-identifier hs-var">showChar</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-135"></span><span>                             </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Vector d r -&gt; ShowS
forall a. Show a =&gt; Int -&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showsPrec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="HGeometry.Line.PointAndVector.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431393"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#appPrec"><span class="hs-identifier hs-type">appPrec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-138"></span><span id="appPrec"><span class="annot"><span class="annottext">appPrec :: Int
</span><a href="HGeometry.Line.PointAndVector.html#appPrec"><span class="hs-identifier hs-var hs-var">appPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430855"><span id="local-6989586621679430856"><span id="local-6989586621679431405"><span id="local-6989586621679431409"><span id="local-6989586621679431413"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679430855"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-141"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Additive_</span></span><span> </span><span class="annot"><a href="#local-6989586621679430856"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430855"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-142"></span><span>         </span><span class="hs-comment">-- , OptVector_ d r, OptMetric_ d r</span><span>
</span><span id="line-143"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679430856"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-144"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430856"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430855"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679431457"><span class="annot"><span class="annottext">readPrec :: ReadPrec (LinePV d r)
</span><a href="#local-6989586621679431457"><span class="hs-identifier hs-var hs-var hs-var">readPrec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadPrec (LinePV d r) -&gt; ReadPrec (LinePV d r)
forall a. ReadPrec a -&gt; ReadPrec a
</span><span class="hs-identifier hs-var">parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ReadPrec (LinePV d r) -&gt; ReadPrec (LinePV d r)
forall a. Int -&gt; ReadPrec a -&gt; ReadPrec a
</span><span class="hs-identifier hs-var">prec</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="HGeometry.Line.PointAndVector.html#appPrec"><span class="hs-identifier hs-var">appPrec</span></a></span><span> </span><span class="annot"><span class="annottext">(ReadPrec (LinePV d r) -&gt; ReadPrec (LinePV d r))
-&gt; ReadPrec (LinePV d r) -&gt; ReadPrec (LinePV d r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Ident</span></span><span> </span><span class="annot"><span class="hs-string">&quot;LinePV&quot;</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadPrec Lexeme
</span><span class="hs-identifier hs-var">lexP</span></span><span>
</span><span id="line-147"></span><span>                          </span><span id="local-6989586621679431463"><span class="annot"><a href="#local-6989586621679431463"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">step</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">readPrec</span></span><span>
</span><span id="line-148"></span><span>                          </span><span id="local-6989586621679431465"><span class="annot"><a href="#local-6989586621679431465"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">step</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">readPrec</span></span><span>
</span><span id="line-149"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431463"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431465"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430885"><span id="local-6989586621679430886"><span id="local-6989586621679431468"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679430885"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430886"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430885"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430886"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- deriving instance Arity d             =&gt; Functor       (Line d)</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- deriving instance Arity d             =&gt; F.Foldable    (Line d)</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- deriving instance Arity d             =&gt; T.Traversable (Line d)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- deriving instance (Arity d, Eq r)     =&gt; Eq (LinePV d r)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679430888"><span id="local-6989586621679431490"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679430888"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679430888"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430888"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679431505"><span class="annot"><span class="annottext">l :: LinePV 2 r
</span><a href="#local-6989586621679431505"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431506"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431506"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679431507"><span class="annot"><span class="annottext">== :: LinePV 2 r -&gt; LinePV 2 r -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679431508"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431508"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431505"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; LinePV 2 r -&gt; Bool
forall r. (Eq r, Num r) =&gt; LinePV 2 r -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#isParallelTo2"><span class="hs-operator hs-var">`isParallelTo2`</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431508"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431506"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; LinePV 2 r -&gt; Bool
forall r point.
(Ord r, Num r, Point_ point 2 r) =&gt;
point -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#onLine2"><span class="hs-operator hs-var">`onLine2`</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431508"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- instance (Eq r, Fractional r) =&gt; Eq (LinePV d r) where</span><span>
</span><span id="line-164"></span><span class="hs-comment">--  l@(LinePV p _) == m = l `isParallelTo` m &amp;&amp; p `onLine` m</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430903"><span id="local-6989586621679430904"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Has_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Metric_</span></span><span> </span><span class="annot"><a href="#local-6989586621679430903"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430904"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679430904"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679430903"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430904"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.Class.html#HasOnLine"><span class="hs-identifier hs-type">HasOnLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430903"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430904"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679430903"><span class="hs-identifier hs-type">d</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679431532"><span class="annot"><span class="annottext">onLine :: forall point r.
(Point_ point d r, Num r, Eq r, r ~ NumType (LinePV d r),
 d ~ Dimension (LinePV d r)) =&gt;
point -&gt; LinePV d r -&gt; Bool
</span><a href="#local-6989586621679431532"><span class="hs-identifier hs-var hs-var hs-var">onLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; LinePV d r -&gt; Bool
forall point (d :: Nat) r.
(Point_ point d r, Has_ Metric_ d r, Fractional r, Eq r,
 Eq (Vector d r)) =&gt;
point -&gt; LinePV d r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#onLineD"><span class="hs-identifier hs-var">onLineD</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- | Test if point q lies on line l</span></span><span>
</span><span id="line-170"></span><span id="local-6989586621679430907"><span id="local-6989586621679430908"><span id="local-6989586621679430909"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#onLineD"><span class="hs-identifier hs-type">onLineD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679430907"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430908"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430909"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Metric_</span></span><span> </span><span class="annot"><a href="#local-6989586621679430908"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430909"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-171"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679430909"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679430909"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679430908"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430909"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>           </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679430907"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430908"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430909"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-173"></span><span id="onLineD"><span class="annot"><span class="annottext">onLineD :: forall point (d :: Nat) r.
(Point_ point d r, Has_ Metric_ d r, Fractional r, Eq r,
 Eq (Vector d r)) =&gt;
point -&gt; LinePV d r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#onLineD"><span class="hs-identifier hs-var hs-var">onLineD</span></a></span></span><span> </span><span id="local-6989586621679431583"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431583"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431584"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431584"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679431585"><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431585"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679431586"><span class="annot"><span class="annottext">q' :: Point d r
</span><a href="#local-6989586621679431586"><span class="hs-identifier hs-var hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431583"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point d r) point (Point d r) -&gt; Point d r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point d r) point (Point d r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point d r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span>
</span><span id="line-174"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431584"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431586"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431586"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Vector d r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431584"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector d r -&gt; Vector d r -&gt; Bool
forall r vector (d :: Nat).
(Eq r, Num r, Metric_ vector d r) =&gt;
vector -&gt; vector -&gt; Bool
</span><span class="hs-operator hs-var">`isScalarMultipleOf`</span></span><span> </span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431585"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- instance (Arbitrary r, Arity d, Num r, Eq r) =&gt; Arbitrary (LinePV d r) where</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   arbitrary = do p &lt;- arbitrary @(Point d r)</span><span>
</span><span id="line-179"></span><span class="hs-comment">--                  q &lt;- suchThat arbitrary (/= p)</span><span>
</span><span id="line-180"></span><span class="hs-comment">--                  return $ lineThrough p q</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">-- ** Functions on lines</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Test if two lines are identical, meaning; if they have exactly the same</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- anchor point and directional vector.</span><span>
</span><span id="line-189"></span><span id="local-6989586621679430923"><span id="local-6989586621679430924"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#isIdenticalTo"><span class="hs-identifier hs-type">isIdenticalTo</span></a></span><span>                             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><a href="#local-6989586621679430923"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430924"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430923"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430924"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430923"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430924"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-191"></span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431593"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431593"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679431594"><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431594"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="isIdenticalTo"><span class="annot"><span class="annottext">isIdenticalTo :: forall (d :: Nat) r.
Eq (Vector d r) =&gt;
LinePV d r -&gt; LinePV d r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#isIdenticalTo"><span class="hs-operator hs-var hs-var">`isIdenticalTo`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431595"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431595"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679431596"><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431596"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431593"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431594"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Point d r, Vector d r) -&gt; (Point d r, Vector d r) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679431595"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679431596"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- {-# RULES</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- &quot;isParallelTo/isParallelTo2&quot; [3]</span><span>
</span><span id="line-196"></span><span class="hs-comment">--      forall (l1 :: forall r. LinePV 2 r) l2. isParallelTo l1 l2 = isParallelTo2 l1 l2</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- #-}</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><span class="hs-comment">-- | Check whether two lines are parallel</span></span><span>
</span><span id="line-200"></span><span id="local-6989586621679430893"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#isParallelTo2"><span class="hs-identifier hs-type">isParallelTo2</span></a></span><span>                            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679430893"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679430893"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430893"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430893"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-201"></span><span id="isParallelTo2"><span class="annot"><span class="annottext">isParallelTo2 :: forall r. (Eq r, Num r) =&gt; LinePV 2 r -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#isParallelTo2"><span class="hs-identifier hs-var hs-var">isParallelTo2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679431604"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431604"><span class="hs-identifier hs-var">ux</span></a></span></span><span> </span><span id="local-6989586621679431605"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431605"><span class="hs-identifier hs-var">uy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679431606"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431606"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span id="local-6989586621679431607"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431607"><span class="hs-identifier hs-var">vy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431608"><span class="hs-identifier hs-var">denom</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>      </span><span id="local-6989586621679431608"><span class="annot"><span class="annottext">denom :: r
</span><a href="#local-6989586621679431608"><span class="hs-identifier hs-var hs-var">denom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431607"><span class="hs-identifier hs-var">vy</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431604"><span class="hs-identifier hs-var">ux</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431606"><span class="hs-identifier hs-var">vx</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431605"><span class="hs-identifier hs-var">uy</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679430931"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679430931"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.Class.html#HasOnLine"><span class="hs-identifier hs-type">HasOnLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430931"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">2</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679431624"><span class="annot"><span class="annottext">onLine :: forall point r.
(Point_ point 2 r, Num r, Eq r, r ~ NumType (LinePV 2 r),
 2 ~ Dimension (LinePV 2 r)) =&gt;
point -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.Class.html#onLine"><span class="hs-identifier hs-var hs-var hs-var">onLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; LinePV 2 r -&gt; Bool
forall r point.
(Ord r, Num r, Point_ point 2 r) =&gt;
point -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#onLine2"><span class="hs-identifier hs-var">onLine2</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><span class="hs-comment">-- | Specific 2d version of testing if apoint lies on a line.</span></span><span>
</span><span id="line-210"></span><span id="local-6989586621679430894"><span id="local-6989586621679430895"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#onLine2"><span class="hs-identifier hs-type">onLine2</span></a></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679430894"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679430894"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679430895"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430894"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679430895"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430894"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-211"></span><span id="local-6989586621679431745"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431745"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="onLine2"><span class="annot"><span class="annottext">onLine2 :: forall r point.
(Ord r, Num r, Point_ point 2 r) =&gt;
point -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#onLine2"><span class="hs-operator hs-var hs-var">`onLine2`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431746"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431746"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679431747"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679431747"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679431745"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point 2 r) point (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431746"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431746"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; Point 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679431747"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CoLinear</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- | The intersection of two lines is either: NoIntersection, a point or a line.</span></span><span>
</span><span id="line-214"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Intersection"><span class="annot"><a href="HGeometry.Intersection.html#Intersection"><span class="hs-identifier hs-var">Intersection</span></a></span></span><span> </span><span id="local-6989586621679431751"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431751"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431751"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.Intersection.html#LineLineIntersection"><span class="hs-identifier hs-type">LineLineIntersection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431751"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430946"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679430946"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679430946"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-218"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430946"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="HGeometry.Intersection.html#HasIntersectionWith"><span class="hs-operator hs-type">`HasIntersectionWith`</span></a></span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430946"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621679431766"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431766"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679431767"><span class="annot"><span class="annottext">intersects :: LinePV 2 r -&gt; LinePV 2 r -&gt; Bool
</span><a href="#local-6989586621679431767"><span class="hs-operator hs-var hs-var hs-var">`intersects`</span></a></span></span><span> </span><span id="local-6989586621679431769"><span class="annot"><span class="annottext">l2 :: LinePV 2 r
</span><a href="#local-6989586621679431769"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431770"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431770"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431766"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; LinePV 2 r -&gt; Bool
forall r. (Eq r, Num r) =&gt; LinePV 2 r -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#isParallelTo2"><span class="hs-operator hs-var">`isParallelTo2`</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431769"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431770"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; LinePV 2 r -&gt; Bool
forall r point.
(Ord r, Num r, Point_ point 2 r) =&gt;
point -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#onLine2"><span class="hs-operator hs-var">`onLine2`</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431766"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430820"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679430820"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-224"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679430820"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-225"></span><span>         </span><span class="hs-comment">-- , OptCVector_ 2 r, OptCVector_ 3 r</span><span>
</span><span id="line-226"></span><span>         </span><span class="hs-comment">-- , OptMetric_ 2 r, Eq (VectorFamily 2 r)</span><span>
</span><span id="line-227"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430820"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="HGeometry.Intersection.html#IsIntersectableWith"><span class="hs-operator hs-type">`IsIntersectableWith`</span></a></span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430820"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679431813"><span class="annot"><span class="annottext">l :: LinePV 2 r
</span><a href="#local-6989586621679431813"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431814"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431814"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679431815"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431815"><span class="hs-identifier hs-var">ux</span></a></span></span><span> </span><span id="local-6989586621679431816"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431816"><span class="hs-identifier hs-var">uy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679431817"><span class="annot"><span class="annottext">intersect :: LinePV 2 r -&gt; LinePV 2 r -&gt; Intersection (LinePV 2 r) (LinePV 2 r)
</span><a href="HGeometry.Intersection.html#intersect"><span class="hs-operator hs-var hs-var hs-var">`intersect`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679431818"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431818"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">~</span><span id="local-6989586621679431819"><span class="annot"><span class="annottext">v :: Vector 2 r
</span><a href="#local-6989586621679431819"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679431820"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431820"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span id="local-6989586621679431821"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431821"><span class="hs-identifier hs-var">vy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679431822"><span class="hs-identifier hs-var">areParallel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431818"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; LinePV 2 r -&gt; Bool
forall r point.
(Ord r, Num r, Point_ point 2 r) =&gt;
point -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#onLine2"><span class="hs-operator hs-var">`onLine2`</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431813"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LineLineIntersectionG r (LinePV 2 r)
-&gt; Maybe (LineLineIntersectionG r (LinePV 2 r))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LineLineIntersectionG r (LinePV 2 r)
 -&gt; Maybe (LineLineIntersectionG r (LinePV 2 r)))
-&gt; LineLineIntersectionG r (LinePV 2 r)
-&gt; Maybe (LineLineIntersectionG r (LinePV 2 r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; LineLineIntersectionG r (LinePV 2 r)
forall r line. line -&gt; LineLineIntersectionG r line
</span><a href="HGeometry.Line.Intersection.html#Line_x_Line_Line"><span class="hs-identifier hs-var">Line_x_Line_Line</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679431813"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-230"></span><span>                                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (LineLineIntersectionG r (LinePV 2 r))
Intersection (LinePV 2 r) (LinePV 2 r)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LineLineIntersectionG r (LinePV 2 r)
-&gt; Maybe (LineLineIntersectionG r (LinePV 2 r))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LineLineIntersectionG r (LinePV 2 r)
 -&gt; Maybe (LineLineIntersectionG r (LinePV 2 r)))
-&gt; LineLineIntersectionG r (LinePV 2 r)
-&gt; Maybe (LineLineIntersectionG r (LinePV 2 r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; LineLineIntersectionG r (LinePV 2 r)
forall r line. Point 2 r -&gt; LineLineIntersectionG r line
</span><a href="HGeometry.Line.Intersection.html#Line_x_Line_Point"><span class="hs-identifier hs-var">Line_x_Line_Point</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431823"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>      </span><span id="local-6989586621679431823"><span class="annot"><span class="annottext">r :: Point 2 r
</span><a href="#local-6989586621679431823"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431818"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; Point 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431824"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
r -&gt; vector -&gt; vector
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679431819"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>      </span><span id="local-6989586621679431826"><span class="annot"><span class="annottext">denom :: r
</span><a href="#local-6989586621679431826"><span class="hs-identifier hs-var hs-var">denom</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431821"><span class="hs-identifier hs-var">vy</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431815"><span class="hs-identifier hs-var">ux</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431820"><span class="hs-identifier hs-var">vx</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431816"><span class="hs-identifier hs-var">uy</span></a></span><span>
</span><span id="line-236"></span><span>      </span><span id="local-6989586621679431822"><span class="annot"><span class="annottext">areParallel :: Bool
</span><a href="#local-6989586621679431822"><span class="hs-identifier hs-var hs-var">areParallel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431826"><span class="hs-identifier hs-var">denom</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-comment">-- Instead of using areParallel, we can also use the generic 'isParallelTo' function</span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-comment">-- for lines of arbitrary dimension, but this is a bit more efficient.</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>      </span><span id="local-6989586621679431824"><span class="annot"><span class="annottext">alpha :: r
</span><a href="#local-6989586621679431824"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431815"><span class="hs-identifier hs-var">ux</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431827"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431828"><span class="hs-identifier hs-var">qy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431816"><span class="hs-identifier hs-var">uy</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431829"><span class="hs-identifier hs-var">qx</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431830"><span class="hs-identifier hs-var">px</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431826"><span class="hs-identifier hs-var">denom</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Point2</span></span><span> </span><span id="local-6989586621679431830"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431830"><span class="hs-identifier hs-var">px</span></a></span></span><span> </span><span id="local-6989586621679431827"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431827"><span class="hs-identifier hs-var">py</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431814"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Point2</span></span><span> </span><span id="local-6989586621679431829"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431829"><span class="hs-identifier hs-var">qx</span></a></span></span><span> </span><span id="local-6989586621679431828"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431828"><span class="hs-identifier hs-var">qy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679431818"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-246"></span><span class="annot"><span class="hs-comment">-- * Supporting Lines</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Types for which we can compute a supporting line, i.e. a line</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- that contains the thing of type t.</span><span>
</span><span id="line-250"></span><span class="hs-keyword">class</span><span> </span><span id="HasSupportingLine"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#HasSupportingLine"><span class="hs-identifier hs-var">HasSupportingLine</span></a></span></span><span> </span><span id="local-6989586621679430962"><span class="annot"><a href="#local-6989586621679430962"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>  </span><span id="supportingLine"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#supportingLine"><span class="hs-identifier hs-type">supportingLine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679430962"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="annot"><a href="#local-6989586621679430962"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679430962"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430963"><span id="local-6989586621679430964"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#HasSupportingLine"><span class="hs-identifier hs-type">HasSupportingLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430963"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#HasSupportingLine"><span class="hs-identifier hs-type">HasSupportingLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679430963"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430964"><span class="hs-identifier hs-type">extra</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679431840"><span class="annot"><span class="annottext">supportingLine :: (t :+ extra)
-&gt; LinePV (Dimension (t :+ extra)) (NumType (t :+ extra))
</span><a href="HGeometry.Line.PointAndVector.html#supportingLine"><span class="hs-identifier hs-var hs-var hs-var">supportingLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; LinePV (Dimension t) (NumType t)
forall t.
HasSupportingLine t =&gt;
t -&gt; LinePV (Dimension t) (NumType t)
</span><a href="HGeometry.Line.PointAndVector.html#supportingLine"><span class="hs-identifier hs-var">supportingLine</span></a></span><span> </span><span class="annot"><span class="annottext">(t -&gt; LinePV (Dimension t) (NumType t))
-&gt; ((t :+ extra) -&gt; t)
-&gt; (t :+ extra)
-&gt; LinePV (Dimension t) (NumType t)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting t (t :+ extra) t -&gt; (t :+ extra) -&gt; t
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting t (t :+ extra) t
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679430976"><span id="local-6989586621679430977"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#HasSupportingLine"><span class="hs-identifier hs-type">HasSupportingLine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430976"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679430977"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679431845"><span class="annot"><span class="annottext">supportingLine :: LinePV d r
-&gt; LinePV (Dimension (LinePV d r)) (NumType (LinePV d r))
</span><a href="HGeometry.Line.PointAndVector.html#supportingLine"><span class="hs-identifier hs-var hs-var hs-var">supportingLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV d r -&gt; LinePV d r
LinePV d r
-&gt; LinePV (Dimension (LinePV d r)) (NumType (LinePV d r))
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-260"></span><span class="annot"><span class="hs-comment">-- * Convenience functions on Two dimensional lines</span></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><span class="hs-comment">-- | Create a line from the linear function ax + b</span></span><span>
</span><span id="line-263"></span><span id="local-6989586621679430979"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#fromLinearFunction"><span class="hs-identifier hs-type">fromLinearFunction</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679430979"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679430979"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679430979"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679430979"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-264"></span><span id="fromLinearFunction"><span class="annot"><span class="annottext">fromLinearFunction :: forall r. Num r =&gt; r -&gt; r -&gt; LinePV 2 r
</span><a href="HGeometry.Line.PointAndVector.html#fromLinearFunction"><span class="hs-identifier hs-var hs-var">fromLinearFunction</span></a></span></span><span> </span><span id="local-6989586621679431850"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431850"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679431851"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431851"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Point 2 r
forall r. r -&gt; r -&gt; Point 2 r
</span><span class="hs-identifier hs-var">Point2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431851"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; r -&gt; Vector 2 r
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679431850"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679431001"><span id="local-6989586621679431002"><span id="local-6989586621679431857"><span id="local-6989586621679431875"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679431001"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Metric_</span></span><span> </span><span class="annot"><a href="#local-6989586621679431002"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431001"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-267"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSquaredEuclideanDistance</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431002"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431001"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679432026"><span class="annot"><span class="annottext">pointClosestTo :: forall r (d :: Nat) point.
(r ~ NumType (LinePV d r), d ~ Dimension (LinePV d r), Num r,
 Point_ point d r) =&gt;
point -&gt; LinePV d r -&gt; Point d r
</span><a href="#local-6989586621679432026"><span class="hs-identifier hs-var hs-var hs-var">pointClosestTo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (Point d r) point (Point d r) -&gt; point -&gt; Point d r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Point d r) point (Point d r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point d r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679432028"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679432028"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679432029"><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679432029"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679432030"><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679432030"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point d r
Point d r
</span><a href="#local-6989586621679432029"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Vector d r -&gt; Point d r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679432031"><span class="hs-identifier hs-var">t0</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Vector d r -&gt; Vector d r
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
r -&gt; vector -&gt; vector
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679432030"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-comment">-- see https://web.archive.org/web/20210924073744/https://monkeyproofsolutions.nl/wordpress/how-to-calculate-the-shortest-distance-between-a-point-and-a-line/</span><span>
</span><span id="line-271"></span><span>      </span><span id="local-6989586621679432031"><span class="annot"><span class="annottext">t0 :: r
</span><a href="#local-6989586621679432031"><span class="hs-identifier hs-var hs-var">t0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679432032"><span class="hs-identifier hs-var">numerator</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679432033"><span class="hs-identifier hs-var">divisor</span></a></span><span>
</span><span id="line-272"></span><span>      </span><span id="local-6989586621679432032"><span class="annot"><span class="annottext">numerator :: r
</span><a href="#local-6989586621679432032"><span class="hs-identifier hs-var hs-var">numerator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679432028"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point d r -&gt; Point d r -&gt; Vector d r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">Point d r
</span><a href="#local-6989586621679432029"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector d r -&gt; Vector d r -&gt; r
forall vector (d :: Nat) r.
(Metric_ vector d r, Num r) =&gt;
vector -&gt; vector -&gt; r
</span><span class="hs-operator hs-var">`dot`</span></span><span> </span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679432030"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span id="local-6989586621679432033"><span class="annot"><span class="annottext">divisor :: r
</span><a href="#local-6989586621679432033"><span class="hs-identifier hs-var hs-var">divisor</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679432030"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Vector d r -&gt; Vector d r -&gt; r
forall vector (d :: Nat) r.
(Metric_ vector d r, Num r) =&gt;
vector -&gt; vector -&gt; r
</span><span class="hs-operator hs-var">`dot`</span></span><span> </span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679432030"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><span class="hs-comment">-- | Result of a side test</span></span><span>
</span><span id="line-277"></span><span class="hs-keyword">data</span><span> </span><span id="SideTestUpDown"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#SideTestUpDown"><span class="hs-identifier hs-var">SideTestUpDown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Below"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#Below"><span class="hs-identifier hs-var">Below</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="On"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#On"><span class="hs-identifier hs-var">On</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Above"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#Above"><span class="hs-identifier hs-var">Above</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679432039"><span id="local-6989586621679432041"><span id="local-6989586621679432045"><span class="annot"><span class="annottext">Int -&gt; SideTestUpDown -&gt; ShowS
[SideTestUpDown] -&gt; ShowS
SideTestUpDown -&gt; String
(Int -&gt; SideTestUpDown -&gt; ShowS)
-&gt; (SideTestUpDown -&gt; String)
-&gt; ([SideTestUpDown] -&gt; ShowS)
-&gt; Show SideTestUpDown
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; SideTestUpDown -&gt; ShowS
showsPrec :: Int -&gt; SideTestUpDown -&gt; ShowS
$cshow :: SideTestUpDown -&gt; String
show :: SideTestUpDown -&gt; String
$cshowList :: [SideTestUpDown] -&gt; ShowS
showList :: [SideTestUpDown] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679432048"><span id="local-6989586621679432052"><span id="local-6989586621679432055"><span id="local-6989586621679432060"><span class="annot"><span class="annottext">ReadPrec [SideTestUpDown]
ReadPrec SideTestUpDown
Int -&gt; ReadS SideTestUpDown
ReadS [SideTestUpDown]
(Int -&gt; ReadS SideTestUpDown)
-&gt; ReadS [SideTestUpDown]
-&gt; ReadPrec SideTestUpDown
-&gt; ReadPrec [SideTestUpDown]
-&gt; Read SideTestUpDown
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS SideTestUpDown
readsPrec :: Int -&gt; ReadS SideTestUpDown
$creadList :: ReadS [SideTestUpDown]
readList :: ReadS [SideTestUpDown]
$creadPrec :: ReadPrec SideTestUpDown
readPrec :: ReadPrec SideTestUpDown
$creadListPrec :: ReadPrec [SideTestUpDown]
readListPrec :: ReadPrec [SideTestUpDown]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679432065"><span id="local-6989586621679432070"><span class="annot"><span class="annottext">SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
(SideTestUpDown -&gt; SideTestUpDown -&gt; Bool)
-&gt; (SideTestUpDown -&gt; SideTestUpDown -&gt; Bool) -&gt; Eq SideTestUpDown
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
== :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
$c/= :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
/= :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679432076"><span id="local-6989586621679432080"><span id="local-6989586621679432084"><span id="local-6989586621679432088"><span id="local-6989586621679432091"><span id="local-6989586621679432094"><span id="local-6989586621679432097"><span class="annot"><span class="annottext">Eq SideTestUpDown
Eq SideTestUpDown =&gt;
(SideTestUpDown -&gt; SideTestUpDown -&gt; Ordering)
-&gt; (SideTestUpDown -&gt; SideTestUpDown -&gt; Bool)
-&gt; (SideTestUpDown -&gt; SideTestUpDown -&gt; Bool)
-&gt; (SideTestUpDown -&gt; SideTestUpDown -&gt; Bool)
-&gt; (SideTestUpDown -&gt; SideTestUpDown -&gt; Bool)
-&gt; (SideTestUpDown -&gt; SideTestUpDown -&gt; SideTestUpDown)
-&gt; (SideTestUpDown -&gt; SideTestUpDown -&gt; SideTestUpDown)
-&gt; Ord SideTestUpDown
SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
SideTestUpDown -&gt; SideTestUpDown -&gt; Ordering
SideTestUpDown -&gt; SideTestUpDown -&gt; SideTestUpDown
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: SideTestUpDown -&gt; SideTestUpDown -&gt; Ordering
compare :: SideTestUpDown -&gt; SideTestUpDown -&gt; Ordering
$c&lt; :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
&lt; :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
$c&lt;= :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
&lt;= :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
$c&gt; :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
&gt; :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
$c&gt;= :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
&gt;= :: SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
$cmax :: SideTestUpDown -&gt; SideTestUpDown -&gt; SideTestUpDown
max :: SideTestUpDown -&gt; SideTestUpDown -&gt; SideTestUpDown
$cmin :: SideTestUpDown -&gt; SideTestUpDown -&gt; SideTestUpDown
min :: SideTestUpDown -&gt; SideTestUpDown -&gt; SideTestUpDown
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Class for types that support testing on which side (above, on,</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- below) a particular point is.</span><span>
</span><span id="line-281"></span><span class="hs-keyword">class</span><span> </span><span id="OnSideUpDownTest"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#OnSideUpDownTest"><span class="hs-identifier hs-var">OnSideUpDownTest</span></a></span></span><span> </span><span id="local-6989586621679431017"><span class="annot"><a href="#local-6989586621679431017"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-comment">-- | Given a point q and a hyperplane h, compute to which side of h q lies. For</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-comment">-- vertical hyperplanes the left side of the hyperplane is interpeted as below.</span><span>
</span><span id="line-284"></span><span>  </span><span id="onSideUpDown"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#onSideUpDown"><span class="hs-identifier hs-type">onSideUpDown</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679431012"><span id="local-6989586621679431014"><span id="local-6989586621679431015"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679431012"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="annot"><a href="#local-6989586621679431017"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679431014"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679431017"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679431014"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679431014"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679431015"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431012"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679431014"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679431015"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679431017"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#SideTestUpDown"><span class="hs-identifier hs-type">SideTestUpDown</span></a></span></span></span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679431018"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#OnSideUpDownTest"><span class="hs-identifier hs-type">OnSideUpDownTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431018"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-comment">-- | Given a point q and a line l, compute to which side of l q lies. For</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-comment">-- vertical lines the left side of the line is interpeted as below.</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-comment">-- &gt;&gt;&gt; Point2 10 10 `onSideUpDown` (lineThrough origin $ Point2 10 5)</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-comment">-- Above</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-comment">-- &gt;&gt;&gt; Point2 10 10 `onSideUpDown` (lineThrough origin $ Point2 (-10) 5)</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-comment">-- Above</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-comment">-- &gt;&gt;&gt; Point2 5 5 `onSideUpDown` (verticalLine 10)</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-comment">-- Below</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-comment">-- &gt;&gt;&gt; Point2 5 5 `onSideUpDown` (lineThrough origin $ Point2 (-3) (-3))</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-comment">-- On</span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621679432245"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432245"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679432246"><span class="annot"><span class="annottext">onSideUpDown :: forall (d :: Nat) r point.
(d ~ Dimension (LinePV 2 r), r ~ NumType (LinePV 2 r), Ord r,
 Num r, Point_ point d r) =&gt;
point -&gt; LinePV 2 r -&gt; SideTestUpDown
</span><a href="HGeometry.Line.PointAndVector.html#onSideUpDown"><span class="hs-operator hs-var hs-var hs-var">`onSideUpDown`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679432247"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432247"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679432248"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432248"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679432249"><span class="annot"><span class="annottext">r :: Point 2 r
</span><a href="#local-6989586621679432249"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432247"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; Point 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432248"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-300"></span><span>                                      </span><span id="local-6989586621679432363"><span class="annot"><span class="annottext">f :: s -&gt; (NumType s, NumType s)
</span><a href="#local-6989586621679432363"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679432364"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679432364"><span class="hs-identifier hs-var">z</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679432364"><span class="hs-identifier hs-var">z</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (NumType s) s (NumType s) -&gt; NumType s
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType s) s (NumType s)
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int s (NumType s)
</span><span class="hs-identifier hs-var">xCoord</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679432364"><span class="hs-identifier hs-var">z</span></a></span><span class="annot"><span class="annottext">s -&gt; Getting (NumType s) s (NumType s) -&gt; NumType s
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType s) s (NumType s)
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int s (NumType s)
</span><span class="hs-identifier hs-var">yCoord</span></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                                      </span><span id="local-6989586621679432373"><span class="annot"><span class="annottext">minBy :: (a -&gt; a) -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679432373"><span class="hs-identifier hs-var hs-var">minBy</span></a></span></span><span> </span><span id="local-6989586621679432374"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679432374"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679432375"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432375"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679432376"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432376"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">F.minimumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679432374"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432375"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432376"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>                                      </span><span id="local-6989586621679432383"><span class="annot"><span class="annottext">maxBy :: (a -&gt; a) -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679432383"><span class="hs-identifier hs-var hs-var">maxBy</span></a></span></span><span> </span><span id="local-6989586621679432384"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679432384"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679432385"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432385"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679432386"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432386"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">F.maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679432384"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432385"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432386"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>                                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; (r, r)) -&gt; Point 2 r -&gt; Point 2 r -&gt; Point 2 r
forall {a} {a}. Ord a =&gt; (a -&gt; a) -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679432373"><span class="hs-identifier hs-var">minBy</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; (r, r)
Point 2 r -&gt; (NumType (Point 2 r), NumType (Point 2 r))
forall {s}.
(Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Num (NumType s), Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; (NumType s, NumType s)
</span><a href="#local-6989586621679432363"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432247"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432249"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point 2 r -&gt; (r, r)) -&gt; Point 2 r -&gt; Point 2 r -&gt; Point 2 r
forall {a} {a}. Ord a =&gt; (a -&gt; a) -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679432383"><span class="hs-identifier hs-var">maxBy</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; (r, r)
Point 2 r -&gt; (NumType (Point 2 r), NumType (Point 2 r))
forall {s}.
(Assert
   (OrdCond (CmpNat 1 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension s)) 'True 'True 'False)
   (TypeError ...),
 Num (NumType s), Point_ s (Dimension s) (NumType s)) =&gt;
s -&gt; (NumType s, NumType s)
</span><a href="#local-6989586621679432363"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432247"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432249"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432245"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point 2 r) point (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-304"></span><span>                                       </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SideTestUpDown
</span><a href="HGeometry.Line.PointAndVector.html#Above"><span class="hs-identifier hs-var">Above</span></a></span><span>
</span><span id="line-305"></span><span>                                       </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SideTestUpDown
</span><a href="HGeometry.Line.PointAndVector.html#Below"><span class="hs-identifier hs-var">Below</span></a></span><span>
</span><span id="line-306"></span><span>                                       </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CoLinear</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SideTestUpDown
</span><a href="HGeometry.Line.PointAndVector.html#On"><span class="hs-identifier hs-var">On</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><span class="hs-comment">-- | Result of a side test</span></span><span>
</span><span id="line-309"></span><span class="hs-keyword">data</span><span> </span><span id="SideTest"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#SideTest"><span class="hs-identifier hs-var">SideTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LeftSide"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LeftSide"><span class="hs-identifier hs-var">LeftSide</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="OnLine"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#OnLine"><span class="hs-identifier hs-var">OnLine</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="RightSide"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#RightSide"><span class="hs-identifier hs-var">RightSide</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679432394"><span id="local-6989586621679432396"><span id="local-6989586621679432400"><span class="annot"><span class="annottext">Int -&gt; SideTest -&gt; ShowS
[SideTest] -&gt; ShowS
SideTest -&gt; String
(Int -&gt; SideTest -&gt; ShowS)
-&gt; (SideTest -&gt; String) -&gt; ([SideTest] -&gt; ShowS) -&gt; Show SideTest
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; SideTest -&gt; ShowS
showsPrec :: Int -&gt; SideTest -&gt; ShowS
$cshow :: SideTest -&gt; String
show :: SideTest -&gt; String
$cshowList :: [SideTest] -&gt; ShowS
showList :: [SideTest] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679432403"><span id="local-6989586621679432407"><span id="local-6989586621679432410"><span id="local-6989586621679432415"><span class="annot"><span class="annottext">ReadPrec [SideTest]
ReadPrec SideTest
Int -&gt; ReadS SideTest
ReadS [SideTest]
(Int -&gt; ReadS SideTest)
-&gt; ReadS [SideTest]
-&gt; ReadPrec SideTest
-&gt; ReadPrec [SideTest]
-&gt; Read SideTest
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS SideTest
readsPrec :: Int -&gt; ReadS SideTest
$creadList :: ReadS [SideTest]
readList :: ReadS [SideTest]
$creadPrec :: ReadPrec SideTest
readPrec :: ReadPrec SideTest
$creadListPrec :: ReadPrec [SideTest]
readListPrec :: ReadPrec [SideTest]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679432418"><span id="local-6989586621679432422"><span class="annot"><span class="annottext">SideTest -&gt; SideTest -&gt; Bool
(SideTest -&gt; SideTest -&gt; Bool)
-&gt; (SideTest -&gt; SideTest -&gt; Bool) -&gt; Eq SideTest
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: SideTest -&gt; SideTest -&gt; Bool
== :: SideTest -&gt; SideTest -&gt; Bool
$c/= :: SideTest -&gt; SideTest -&gt; Bool
/= :: SideTest -&gt; SideTest -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679432428"><span id="local-6989586621679432432"><span id="local-6989586621679432436"><span id="local-6989586621679432440"><span id="local-6989586621679432443"><span id="local-6989586621679432446"><span id="local-6989586621679432449"><span class="annot"><span class="annottext">Eq SideTest
Eq SideTest =&gt;
(SideTest -&gt; SideTest -&gt; Ordering)
-&gt; (SideTest -&gt; SideTest -&gt; Bool)
-&gt; (SideTest -&gt; SideTest -&gt; Bool)
-&gt; (SideTest -&gt; SideTest -&gt; Bool)
-&gt; (SideTest -&gt; SideTest -&gt; Bool)
-&gt; (SideTest -&gt; SideTest -&gt; SideTest)
-&gt; (SideTest -&gt; SideTest -&gt; SideTest)
-&gt; Ord SideTest
SideTest -&gt; SideTest -&gt; Bool
SideTest -&gt; SideTest -&gt; Ordering
SideTest -&gt; SideTest -&gt; SideTest
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: SideTest -&gt; SideTest -&gt; Ordering
compare :: SideTest -&gt; SideTest -&gt; Ordering
$c&lt; :: SideTest -&gt; SideTest -&gt; Bool
&lt; :: SideTest -&gt; SideTest -&gt; Bool
$c&lt;= :: SideTest -&gt; SideTest -&gt; Bool
&lt;= :: SideTest -&gt; SideTest -&gt; Bool
$c&gt; :: SideTest -&gt; SideTest -&gt; Bool
&gt; :: SideTest -&gt; SideTest -&gt; Bool
$c&gt;= :: SideTest -&gt; SideTest -&gt; Bool
&gt;= :: SideTest -&gt; SideTest -&gt; Bool
$cmax :: SideTest -&gt; SideTest -&gt; SideTest
max :: SideTest -&gt; SideTest -&gt; SideTest
$cmin :: SideTest -&gt; SideTest -&gt; SideTest
min :: SideTest -&gt; SideTest -&gt; SideTest
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Given a point q and a line l, compute to which side of l q lies. For</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- vertical lines the left side of the line is interpeted as below.</span><span>
</span><span id="line-313"></span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- &gt;&gt;&gt; Point2 10 10 `onSide` (lineThrough origin $ Point2 10 5)</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- LeftSide</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- &gt;&gt;&gt; Point2 10 10 `onSide` (lineThrough origin $ Point2 (-10) 5)</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- RightSide</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- &gt;&gt;&gt; Point2 5 5 `onSide` (verticalLine 10)</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- LeftSide</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- &gt;&gt;&gt; Point2 5 5 `onSide` (lineThrough origin $ Point2 (-3) (-3))</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- OnLine</span><span>
</span><span id="line-322"></span><span id="local-6989586621679431045"><span id="local-6989586621679431046"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#onSide"><span class="hs-identifier hs-type">onSide</span></a></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679431045"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679431045"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-323"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679431046"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431045"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-324"></span><span>                         </span><span class="hs-comment">-- , OptCVector_ 2 r, OptMetric_ 2 r</span><span>
</span><span id="line-325"></span><span>                         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679431046"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431045"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#SideTest"><span class="hs-identifier hs-type">SideTest</span></a></span></span></span><span>
</span><span id="line-326"></span><span id="local-6989586621679432567"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432567"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="onSide"><span class="annot"><span class="annottext">onSide :: forall r point.
(Ord r, Num r, Point_ point 2 r) =&gt;
point -&gt; LinePV 2 r -&gt; SideTest
</span><a href="HGeometry.Line.PointAndVector.html#onSide"><span class="hs-operator hs-var hs-var">`onSide`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679432568"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432568"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679432569"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432569"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679432570"><span class="annot"><span class="annottext">r :: Point 2 r
</span><a href="#local-6989586621679432570"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432568"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; Point 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432569"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-327"></span><span>                            </span><span class="hs-comment">-- f z         = (z^.xCoord, -z^.yCoord)</span><span>
</span><span id="line-328"></span><span>                            </span><span class="hs-comment">-- minBy g a b = F.minimumBy (comparing g) [a,b]</span><span>
</span><span id="line-329"></span><span>                            </span><span class="hs-comment">-- maxBy g a b = F.maximumBy (comparing g) [a,b]</span><span>
</span><span id="line-330"></span><span>                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432568"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432570"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432567"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point 2 r) point (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-331"></span><span>                            </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SideTest
</span><a href="HGeometry.Line.PointAndVector.html#LeftSide"><span class="hs-identifier hs-var">LeftSide</span></a></span><span>
</span><span id="line-332"></span><span>                            </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SideTest
</span><a href="HGeometry.Line.PointAndVector.html#RightSide"><span class="hs-identifier hs-var">RightSide</span></a></span><span>
</span><span id="line-333"></span><span>                            </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CoLinear</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SideTest
</span><a href="HGeometry.Line.PointAndVector.html#OnLine"><span class="hs-identifier hs-var">OnLine</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><span class="hs-comment">-- | Test if the query point q lies (strictly) above line l</span></span><span>
</span><span id="line-336"></span><span id="local-6989586621679432571"><span id="local-6989586621679432572"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#liesAbove"><span class="hs-identifier hs-type">liesAbove</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679432571"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679432571"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-337"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679432572"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679432571"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-338"></span><span>                   </span><span class="hs-comment">-- , OptCVector_ 2 r, OptMetric_ 2 r</span><span>
</span><span id="line-339"></span><span>                   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679432572"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679432571"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-340"></span><span id="local-6989586621679432585"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432585"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="liesAbove"><span class="annot"><span class="annottext">liesAbove :: forall r point.
(Ord r, Num r, Point_ point 2 r) =&gt;
point -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#liesAbove"><span class="hs-operator hs-var hs-var">`liesAbove`</span></a></span></span><span> </span><span id="local-6989586621679432586"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432586"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432585"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; LinePV 2 r -&gt; SideTestUpDown
forall (d :: Nat) r point.
(d ~ Dimension (LinePV 2 r), r ~ NumType (LinePV 2 r), Ord r,
 Num r, Point_ point d r) =&gt;
point -&gt; LinePV 2 r -&gt; SideTestUpDown
forall t (d :: Nat) r point.
(OnSideUpDownTest t, d ~ Dimension t, r ~ NumType t, Ord r, Num r,
 Point_ point d r) =&gt;
point -&gt; t -&gt; SideTestUpDown
</span><a href="HGeometry.Line.PointAndVector.html#onSideUpDown"><span class="hs-operator hs-var">`onSideUpDown`</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432586"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SideTestUpDown
</span><a href="HGeometry.Line.PointAndVector.html#Above"><span class="hs-identifier hs-var">Above</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><span class="hs-comment">-- | Test if the query point q lies (strictly) above line l</span></span><span>
</span><span id="line-343"></span><span id="local-6989586621679432587"><span id="local-6989586621679432588"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#liesBelow"><span class="hs-identifier hs-type">liesBelow</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679432587"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679432587"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679432588"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679432587"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-344"></span><span>                  </span><span class="hs-comment">-- , OptCVector_ 2 r, OptMetric_ 2 r</span><span>
</span><span id="line-345"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679432588"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679432587"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-346"></span><span id="local-6989586621679432601"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432601"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="liesBelow"><span class="annot"><span class="annottext">liesBelow :: forall r point.
(Ord r, Num r, Point_ point 2 r) =&gt;
point -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#liesBelow"><span class="hs-operator hs-var hs-var">`liesBelow`</span></a></span></span><span> </span><span id="local-6989586621679432602"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432602"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432601"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; LinePV 2 r -&gt; SideTestUpDown
forall (d :: Nat) r point.
(d ~ Dimension (LinePV 2 r), r ~ NumType (LinePV 2 r), Ord r,
 Num r, Point_ point d r) =&gt;
point -&gt; LinePV 2 r -&gt; SideTestUpDown
forall t (d :: Nat) r point.
(OnSideUpDownTest t, d ~ Dimension t, r ~ NumType t, Ord r, Num r,
 Point_ point d r) =&gt;
point -&gt; t -&gt; SideTestUpDown
</span><a href="HGeometry.Line.PointAndVector.html#onSideUpDown"><span class="hs-operator hs-var">`onSideUpDown`</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432602"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SideTestUpDown -&gt; SideTestUpDown -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SideTestUpDown
</span><a href="HGeometry.Line.PointAndVector.html#Below"><span class="hs-identifier hs-var">Below</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><span class="hs-comment">-- | Get the bisector between two points</span></span><span>
</span><span id="line-349"></span><span id="local-6989586621679431053"><span id="local-6989586621679431054"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#bisector"><span class="hs-identifier hs-type">bisector</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679431053"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679431054"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431053"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-350"></span><span>                </span><span class="hs-comment">-- , OptCVector_ 2 r, OptMetric_ 2 r</span><span>
</span><span id="line-351"></span><span>                </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679431054"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679431054"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431053"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-352"></span><span id="bisector"><span class="annot"><span class="annottext">bisector :: forall r point.
(Fractional r, Point_ point 2 r) =&gt;
point -&gt; point -&gt; LinePV 2 r
</span><a href="HGeometry.Line.PointAndVector.html#bisector"><span class="hs-identifier hs-var hs-var">bisector</span></a></span></span><span> </span><span id="local-6989586621679432643"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432643"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679432644"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432644"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679432645"><span class="annot"><span class="annottext">v :: Vector 2 r
</span><a href="#local-6989586621679432645"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432644"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Vector 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432643"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-353"></span><span>                   </span><span id="local-6989586621679432646"><span class="annot"><span class="annottext">h :: Point 2 r
</span><a href="#local-6989586621679432646"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r) -&gt; point -&gt; Point 2 r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span> </span><span class="annot"><span class="annottext">(point -&gt; Point 2 r) -&gt; point -&gt; Point 2 r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679432643"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; Vector 2 r -&gt; point
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432645"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; r -&gt; Vector 2 r
forall vector (d :: Nat) r.
(Vector_ vector d r, Fractional r) =&gt;
vector -&gt; r -&gt; vector
</span><span class="hs-operator hs-var">^/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; LinePV 2 r
forall r. Num r =&gt; LinePV 2 r -&gt; LinePV 2 r
</span><a href="HGeometry.Line.PointAndVector.html#perpendicularTo"><span class="hs-identifier hs-var">perpendicularTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-var">LinePV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432646"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432645"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Given a line l with anchor point p and vector v, get the line m perpendicular to l</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- that also goes through p. The line is oriented *into* the right halfplane of l.</span><span>
</span><span id="line-358"></span><span class="hs-comment">--</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- &gt;&gt;&gt; perpendicularTo $ LinePV (Point2 3 4) (Vector2 (-1) 2)</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- LinePV (Point2 3 4) (Vector2 2 1)</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- &gt;&gt;&gt; perpendicularTo $ LinePV (Point2 (-1000) 268) (Vector2 (-50) 8)</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- LinePV (Point2 (-1000) 268) (Vector2 8 50)</span><span>
</span><span id="line-363"></span><span id="local-6989586621679431060"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#perpendicularTo"><span class="hs-identifier hs-type">perpendicularTo</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679431060"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431060"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431060"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-364"></span><span id="perpendicularTo"><span class="annot"><span class="annottext">perpendicularTo :: forall r. Num r =&gt; LinePV 2 r -&gt; LinePV 2 r
</span><a href="HGeometry.Line.PointAndVector.html#perpendicularTo"><span class="hs-identifier hs-var hs-var">perpendicularTo</span></a></span></span><span> </span><span id="local-6989586621679432657"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432657"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432657"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">LinePV 2 r -&gt; (LinePV 2 r -&gt; LinePV 2 r) -&gt; LinePV 2 r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Vector 2 r -&gt; Identity (Vector 2 r))
-&gt; LinePV 2 r -&gt; Identity (LinePV 2 r)
forall (d :: Nat) r.
(Dimension (LinePV 2 r) ~ d, NumType (LinePV 2 r) ~ r) =&gt;
Lens' (LinePV 2 r) (Vector d r)
forall t (d :: Nat) r.
(HasDirection t, Dimension t ~ d, NumType t ~ r) =&gt;
Lens' t (Vector d r)
Lens' (LinePV 2 r) (Vector 2 r)
</span><a href="HGeometry.Line.PointAndVector.html#direction"><span class="hs-identifier hs-var">direction</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector 2 r -&gt; Identity (Vector 2 r))
 -&gt; LinePV 2 r -&gt; Identity (LinePV 2 r))
-&gt; (Vector 2 r -&gt; Vector 2 r) -&gt; LinePV 2 r -&gt; LinePV 2 r
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r
forall {r}. Num r =&gt; Vector 2 r -&gt; Vector 2 r
</span><a href="#local-6989586621679432660"><span class="hs-identifier hs-var">rot90cw</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>    </span><span id="local-6989586621679432660"><span class="annot"><span class="annottext">rot90cw :: Vector 2 r -&gt; Vector 2 r
</span><a href="#local-6989586621679432660"><span class="hs-identifier hs-var hs-var">rot90cw</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679432663"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679432663"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span id="local-6989586621679432664"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679432664"><span class="hs-identifier hs-var">vy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Vector 2 r
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679432664"><span class="hs-identifier hs-var">vy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679432663"><span class="hs-identifier hs-var">vx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#perpendicularTo"><span class="hs-pragma hs-type">perpendicularTo</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="annot"><span class="hs-comment">-- | Test if a vector is perpendicular to the line.</span></span><span>
</span><span id="line-370"></span><span id="local-6989586621679431072"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#isPerpendicularTo"><span class="hs-identifier hs-type">isPerpendicularTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679431072"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679431072"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-371"></span><span>                     </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431072"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431072"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-372"></span><span id="local-6989586621679432684"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432684"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="isPerpendicularTo"><span class="annot"><span class="annottext">isPerpendicularTo :: forall r. (Num r, Eq r) =&gt; Vector 2 r -&gt; LinePV 2 r -&gt; Bool
</span><a href="HGeometry.Line.PointAndVector.html#isPerpendicularTo"><span class="hs-operator hs-var hs-var">`isPerpendicularTo`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679432685"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432685"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432684"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r -&gt; r
forall vector (d :: Nat) r.
(Metric_ vector d r, Num r) =&gt;
vector -&gt; vector -&gt; r
</span><span class="hs-operator hs-var">`dot`</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432685"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- | Compares the lines on slope. Vertical lines are considered larger than</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- anything else.</span><span>
</span><span id="line-377"></span><span class="hs-comment">--</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- &gt;&gt;&gt; (LinePV origin (Vector2 5 1)) `cmpSlope` (LinePV origin (Vector2 3 3))</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- LT</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- &gt;&gt;&gt; (LinePV origin (Vector2 5 1)) `cmpSlope` (LinePV origin (Vector2 (-3) 3))</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- GT</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- &gt;&gt;&gt; (LinePV origin (Vector2 5 1)) `cmpSlope` (LinePV origin (Vector2 0 1))</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- LT</span><span>
</span><span id="line-384"></span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#cmpSlope"><span class="hs-identifier hs-type">cmpSlope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679431074"><span class="annot"><a href="#local-6989586621679431074"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679431074"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679431074"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-385"></span><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431074"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431074"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span>
</span><span id="line-386"></span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679432742"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432742"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span id="cmpSlope"><span class="annot"><span class="annottext">cmpSlope :: forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; LinePV 2 r -&gt; Ordering
</span><a href="HGeometry.Line.PointAndVector.html#cmpSlope"><span class="hs-operator hs-var hs-var">`cmpSlope`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679432743"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432743"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
forall point (d :: Nat) r.
(Num r, ConstructablePoint_ point d r) =&gt;
point
</span><span class="hs-identifier hs-var">origin</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431074"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; Point 2 r
forall {a}. (Ord a, Num a) =&gt; Vector 2 a -&gt; PointF (Vector 2 a)
</span><a href="#local-6989586621679432745"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432742"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; Point 2 r
forall {a}. (Ord a, Num a) =&gt; Vector 2 a -&gt; PointF (Vector 2 a)
</span><a href="#local-6989586621679432745"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432743"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-387"></span><span>                                         </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-388"></span><span>                                         </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-389"></span><span>                                         </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CoLinear</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679432745"><span class="annot"><span class="annottext">f :: Vector 2 a -&gt; PointF (Vector 2 a)
</span><a href="#local-6989586621679432745"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679432769"><span class="annot"><span class="annottext">w :: Vector 2 a
</span><a href="#local-6989586621679432769"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679432770"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432770"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679432771"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432771"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 a -&gt; PointF (Vector 2 a)
forall v. v -&gt; PointF v
</span><span class="hs-identifier hs-var">Point</span></span><span> </span><span class="annot"><span class="annottext">(Vector 2 a -&gt; PointF (Vector 2 a))
-&gt; Vector 2 a -&gt; PointF (Vector 2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432770"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-operator hs-var">`compare`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679432771"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-392"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 a
</span><a href="#local-6989586621679432769"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-393"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 a
</span><a href="#local-6989586621679432769"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-394"></span><span>                                  </span><span class="annot"><span class="annottext">(Ordering, Bool)
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Vector 2 a -&gt; Vector 2 a
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
r -&gt; vector -&gt; vector
</span><span class="hs-operator hs-var">*^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 a
</span><a href="#local-6989586621679432769"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-395"></span><span>                                  </span><span class="hs-comment">-- x &lt; 0, or (x==0 and y &lt;0 ; i.e. a vertical line)</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="annot"><span class="hs-comment">-- | Given the oriented line, computes the halfspace left of the line.</span></span><span>
</span><span id="line-402"></span><span id="local-6989586621679431085"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#leftHalfPlane"><span class="hs-identifier hs-type">leftHalfPlane</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679431085"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679431085"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431085"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.HalfSpace.Type.html#HalfSpaceF"><span class="hs-identifier hs-type">HalfSpaceF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679431085"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-403"></span><span id="leftHalfPlane"><span class="annot"><span class="annottext">leftHalfPlane :: forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
</span><a href="HGeometry.Line.PointAndVector.html#leftHalfPlane"><span class="hs-identifier hs-var hs-var">leftHalfPlane</span></a></span></span><span> </span><span id="local-6989586621679432785"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432785"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sign -&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
forall boundingHyperPlane.
Sign -&gt; boundingHyperPlane -&gt; HalfSpaceF boundingHyperPlane
</span><a href="HGeometry.HalfSpace.Type.html#HalfSpace"><span class="hs-identifier hs-var">HalfSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="#local-6989586621679432787"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432785"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621679432787"><span class="annot"><span class="annottext">sign :: Sign
</span><a href="#local-6989586621679432787"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span id="local-6989586621679432788"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432788"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679432789"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432789"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; LinePV 2 r
forall r. Num r =&gt; LinePV 2 r -&gt; LinePV 2 r
</span><a href="HGeometry.Line.PointAndVector.html#perpendicularTo"><span class="hs-identifier hs-var">perpendicularTo</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432785"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-406"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; LinePV 2 r -&gt; Ordering
forall point.
(Point_ point 2 r, Ord r, Num r) =&gt;
point -&gt; LinePV 2 r -&gt; Ordering
forall hyperPlane (d :: Nat) r point.
(HyperPlane_ hyperPlane d r, Point_ point d r, Ord r, Num r) =&gt;
point -&gt; hyperPlane -&gt; Ordering
</span><a href="HGeometry.HyperPlane.Class.html#onSideTest"><span class="hs-identifier hs-var">onSideTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679432788"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; Point 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679432789"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432785"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-407"></span><span>                </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sign.html/HGeometry.Sign.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span>
</span><span id="line-408"></span><span>                </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sign.html/HGeometry.Sign.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><span class="hs-comment">-- | Given the oriented line, computes the halfspace right of the line.</span></span><span>
</span><span id="line-411"></span><span id="local-6989586621679432793"><span class="annot"><a href="HGeometry.Line.PointAndVector.html#rightHalfPlane"><span class="hs-identifier hs-type">rightHalfPlane</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679432793"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679432793"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679432793"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.HalfSpace.Type.html#HalfSpaceF"><span class="hs-identifier hs-type">HalfSpaceF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Line.PointAndVector.html#LinePV"><span class="hs-identifier hs-type">LinePV</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679432793"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-412"></span><span id="rightHalfPlane"><span class="annot"><span class="annottext">rightHalfPlane :: forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
</span><a href="HGeometry.Line.PointAndVector.html#rightHalfPlane"><span class="hs-identifier hs-var hs-var">rightHalfPlane</span></a></span></span><span> </span><span id="local-6989586621679432798"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432798"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="HGeometry.HalfSpace.Type.html#HalfSpace"><span class="hs-identifier hs-type">HalfSpace</span></a></span><span> </span><span id="local-6989586621679432799"><span class="annot"><span class="annottext">Sign
</span><a href="#local-6989586621679432799"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
</span><a href="HGeometry.Line.PointAndVector.html#leftHalfPlane"><span class="hs-identifier hs-var">leftHalfPlane</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432798"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-413"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Sign -&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
forall boundingHyperPlane.
Sign -&gt; boundingHyperPlane -&gt; HalfSpaceF boundingHyperPlane
</span><a href="HGeometry.HalfSpace.Type.html#HalfSpace"><span class="hs-identifier hs-var">HalfSpace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sign -&gt; Sign
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sign.html/HGeometry.Sign.html#flipSign"><span class="hs-identifier hs-var">flipSign</span></a></span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="#local-6989586621679432799"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679432798"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">{-
-- | Lines are transformable, via line segments
instance ( Fractional r
         , TransformationConstraints d r
         -- , OptVector_ d r, OptMetric_ d r
         ) =&gt; IsTransformable (LinePV d r) where
  transformBy t (LinePV p v) = lineThrough p' q'
    where
      p' = transformBy t p
      q' = transformBy t (p .+^ v)

-}</span><span>
</span><span id="line-427"></span></pre></body></html>