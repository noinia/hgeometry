<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Simple.ShortestPath.Tree</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Computing a shortest path tree in a simple polygon</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html"><span class="hs-identifier">HGeometry.Polygon.Simple.ShortestPath.Tree</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#labelWithShortestPaths"><span class="hs-identifier">labelWithShortestPaths</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#computeShortestPaths%27"><span class="hs-identifier">computeShortestPaths'</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-comment">-- , Parent</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-comment">-- , shortestPathTree</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Cons.html/Control.Lens.Cons.html#%3A%3C"><span class="hs-operator">(:&lt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Cons.html/Control.Lens.Cons.html#%3C%7C"><span class="hs-operator">(&lt;|)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Cons.html/Control.Lens.Cons.html#%7C%3E"><span class="hs-operator">(|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html"><span class="hs-identifier">Data.FingerTree</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#Measured"><span class="hs-identifier">Measured</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#FingerTree"><span class="hs-identifier">FingerTree</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#ViewL"><span class="hs-identifier">ViewL</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#SearchResult"><span class="hs-identifier">SearchResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator">(&lt;|)</span></a></span><span>
</span><span id="line-24"></span><span>                                 </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html"><span class="hs-identifier">Data.FingerTree</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">FT</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.Mutable.html/Data.Vector.Mutable.html"><span class="hs-identifier">Data.Vector.Mutable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MV</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-vector-0.2.4-35b277dd8fff524486dc8302cf5c123530ebecd0662a66c97dfadfce0cb0b290/share/doc/html/src/Data.Vector.NonEmpty.html/Data.Vector.NonEmpty.html"><span class="hs-identifier">Data.Vector.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.html"><span class="hs-identifier">HGeometry.PlaneGraph.Connected</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.Type.html"><span class="hs-identifier">HGeometry.PlaneGraph.Connected.Type</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Simple.DualTree.html"><span class="hs-identifier">HGeometry.Polygon.Simple.DualTree</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.html"><span class="hs-identifier">HGeometry.Polygon.Triangulation</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.html/HGeometry.Trie.html"><span class="hs-identifier">HGeometry.Trie</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.PlanarGraph.Connected.html/Hiraffe.PlanarGraph.Connected.html"><span class="hs-identifier">Hiraffe.PlanarGraph.Connected</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- class TriangulatedSimplePolygon_ polygon point r where</span><span>
</span><span id="line-41"></span><span class="hs-comment">--   dualTree :: polygon -&gt; BinaryTree (VertexIx polygon, Vertex polygon)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">{-

-}</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | Labels each vertex ith its parent (if it has one).</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- computeShortestPaths        :: ( SimplePolygon_ simplePolygon  point r</span><span>
</span><span id="line-49"></span><span class="hs-comment">--                                , SimplePolygon_ poly (point :+ Either source (VertexIx poly)) r</span><span>
</span><span id="line-50"></span><span class="hs-comment">--                                , Point_ source 2 r</span><span>
</span><span id="line-51"></span><span class="hs-comment">--                                , Ord r, Num r</span><span>
</span><span id="line-52"></span><span class="hs-comment">--                                ) =&gt; source -&gt; simplePolygon -&gt; poly</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- computeShortestPaths s poly = computeShortestPaths' s poly (triangulate poly)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- type Parent source s vertex = Either source (vertex :+ vertexId s)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><span class="hs-comment">-- | Labels each vertex ith its parent.</span></span><span>
</span><span id="line-58"></span><span id="local-6989586621679452676"><span id="local-6989586621679452677"><span id="local-6989586621679452679"><span id="local-6989586621679452680"><span id="local-6989586621679452682"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#labelWithShortestPaths"><span class="hs-identifier hs-type">labelWithShortestPaths</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452676"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452677"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-59"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452679"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452677"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-60"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679452677"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452677"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-61"></span><span>                                 </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>                              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452676"><span class="hs-identifier hs-type">source</span></a></span><span>
</span><span id="line-63"></span><span>                                 </span><span class="annot"><span class="hs-comment">-- ^ the source point.</span></span><span>
</span><span id="line-64"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.Type.html#CPlaneGraph"><span class="hs-identifier hs-type">CPlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452680"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452679"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonEdgeType"><span class="hs-identifier hs-type">PolygonEdgeType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452682"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-65"></span><span>                                    </span><span class="hs-comment">--  ^ the triangulated polygon</span><span>
</span><span id="line-66"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.Type.html#CPlaneGraph"><span class="hs-identifier hs-type">CPlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452680"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679452679"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679452676"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.PlanarGraph.Connected.Core.html/Hiraffe.PlanarGraph.Connected.Core.html#VertexId"><span class="hs-identifier hs-type">VertexId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452680"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>                                               </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonEdgeType"><span class="hs-identifier hs-type">PolygonEdgeType</span></a></span><span>
</span><span id="line-68"></span><span>                                               </span><span class="annot"><a href="#local-6989586621679452682"><span class="hs-identifier hs-type">f</span></a></span></span></span></span></span></span><span>
</span><span id="line-69"></span><span id="labelWithShortestPaths"><span class="annot"><span class="annottext">labelWithShortestPaths :: forall {k} source r vertex (s :: k) f.
(Point_ source 2 r, Point_ vertex 2 r, Num r, Ord r) =&gt;
source
-&gt; CPlaneGraph s vertex PolygonEdgeType f
-&gt; CPlaneGraph
     s (vertex :+ Either source (VertexId s)) PolygonEdgeType f
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#labelWithShortestPaths"><span class="hs-identifier hs-var hs-var">labelWithShortestPaths</span></a></span></span><span> </span><span id="local-6989586621679453205"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679453205"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679453206"><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
</span><a href="#local-6989586621679453206"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
</span><a href="#local-6989586621679453206"><span class="hs-identifier hs-var">poly</span></a></span><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
-&gt; (CPlaneGraph s vertex PolygonEdgeType f
    -&gt; CPlaneGraph
         s (vertex :+ Either source (VertexId s)) PolygonEdgeType f)
-&gt; CPlaneGraph
     s (vertex :+ Either source (VertexId s)) PolygonEdgeType f
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(CPlanarGraph 'Primal s vertex PolygonEdgeType f
 -&gt; Identity
      (CPlanarGraph
         'Primal
         s
         (vertex :+ Either source (VertexId s))
         PolygonEdgeType
         f))
-&gt; CPlaneGraph s vertex PolygonEdgeType f
-&gt; Identity
     (CPlaneGraph
        s (vertex :+ Either source (VertexId s)) PolygonEdgeType f)
forall {k} (s :: k) v e f1 v' e' f' (p :: * -&gt; * -&gt; *)
       (f2 :: * -&gt; *).
(Profunctor p, Functor f2) =&gt;
p (CPlanarGraph 'Primal s v e f1)
  (f2 (CPlanarGraph 'Primal s v' e' f'))
-&gt; p (CPlaneGraph s v e f1) (f2 (CPlaneGraph s v' e' f'))
</span><a href="HGeometry.PlaneGraph.Connected.Type.html#_CPlanarGraph"><span class="hs-identifier hs-var">_CPlanarGraph</span></a></span><span class="annot"><span class="annottext">((CPlanarGraph 'Primal s vertex PolygonEdgeType f
  -&gt; Identity
       (CPlanarGraph
          'Primal
          s
          (vertex :+ Either source (VertexId s))
          PolygonEdgeType
          f))
 -&gt; CPlaneGraph s vertex PolygonEdgeType f
 -&gt; Identity
      (CPlaneGraph
         s (vertex :+ Either source (VertexId s)) PolygonEdgeType f))
-&gt; ((NonEmptyVector vertex
     -&gt; Identity
          (NonEmptyVector (vertex :+ Either source (VertexId s))))
    -&gt; CPlanarGraph 'Primal s vertex PolygonEdgeType f
    -&gt; Identity
         (CPlanarGraph
            'Primal
            s
            (vertex :+ Either source (VertexId s))
            PolygonEdgeType
            f))
-&gt; (NonEmptyVector vertex
    -&gt; Identity
         (NonEmptyVector (vertex :+ Either source (VertexId s))))
-&gt; CPlaneGraph s vertex PolygonEdgeType f
-&gt; Identity
     (CPlaneGraph
        s (vertex :+ Either source (VertexId s)) PolygonEdgeType f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(NonEmptyVector vertex
 -&gt; Identity
      (NonEmptyVector (vertex :+ Either source (VertexId s))))
-&gt; CPlanarGraph 'Primal s vertex PolygonEdgeType f
-&gt; Identity
     (CPlanarGraph
        'Primal s (vertex :+ Either source (VertexId s)) PolygonEdgeType f)
forall {k} (w :: World) (s :: k) v e f1 v' (f2 :: * -&gt; *).
Functor f2 =&gt;
(NonEmptyVector v -&gt; f2 (NonEmptyVector v'))
-&gt; CPlanarGraph w s v e f1 -&gt; f2 (CPlanarGraph w s v' e f1)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.PlanarGraph.Connected.Core.html/Hiraffe.PlanarGraph.Connected.Core.html#vertexData"><span class="hs-identifier hs-var">vertexData</span></a></span><span> </span><span class="annot"><span class="annottext">((NonEmptyVector vertex
  -&gt; Identity
       (NonEmptyVector (vertex :+ Either source (VertexId s))))
 -&gt; CPlaneGraph s vertex PolygonEdgeType f
 -&gt; Identity
      (CPlaneGraph
         s (vertex :+ Either source (VertexId s)) PolygonEdgeType f))
-&gt; (NonEmptyVector vertex
    -&gt; NonEmptyVector (vertex :+ Either source (VertexId s)))
-&gt; CPlaneGraph s vertex PolygonEdgeType f
-&gt; CPlaneGraph
     s (vertex :+ Either source (VertexId s)) PolygonEdgeType f
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptyVector vertex
-&gt; NonEmptyVector (vertex :+ Either source (VertexId s))
</span><a href="#local-6989586621679453212"><span class="hs-identifier hs-var">assignParents</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679453213"><span class="annot"><span class="annottext">parents :: [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
</span><a href="#local-6989586621679453213"><span class="hs-identifier hs-var hs-var">parents</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">source
-&gt; CPlaneGraph s vertex PolygonEdgeType f
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall {k} source r vertex (s :: k) f.
(Point_ source 2 r, Point_ vertex 2 r, Num r, Ord r) =&gt;
source
-&gt; CPlaneGraph s vertex PolygonEdgeType f
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#computeShortestPaths%27"><span class="hs-identifier hs-var">computeShortestPaths'</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679453205"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
</span><a href="#local-6989586621679453206"><span class="hs-identifier hs-var">poly</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621679453212"><span class="annot"><span class="annottext">assignParents :: NonEmptyVector vertex
-&gt; NonEmptyVector (vertex :+ Either source (VertexId s))
</span><a href="#local-6989586621679453212"><span class="hs-identifier hs-var hs-var">assignParents</span></a></span></span><span> </span><span id="local-6989586621679453214"><span class="annot"><span class="annottext">NonEmptyVector vertex
</span><a href="#local-6989586621679453214"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (MVector s (vertex :+ Either source (VertexId s))))
-&gt; NonEmptyVector (vertex :+ Either source (VertexId s))
forall a. (forall s. ST s (MVector s a)) -&gt; NonEmptyVector a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-vector-0.2.4-35b277dd8fff524486dc8302cf5c123530ebecd0662a66c97dfadfce0cb0b290/share/doc/html/src/Data.Vector.NonEmpty.html/Data.Vector.NonEmpty.html#unsafeCreate"><span class="hs-identifier hs-var">V.unsafeCreate</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s.
  ST s (MVector s (vertex :+ Either source (VertexId s))))
 -&gt; NonEmptyVector (vertex :+ Either source (VertexId s)))
-&gt; (forall s.
    ST s (MVector s (vertex :+ Either source (VertexId s))))
-&gt; NonEmptyVector (vertex :+ Either source (VertexId s))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>                        </span><span id="local-6989586621679453234"><span class="annot"><a href="#local-6989586621679453234"><span class="hs-identifier hs-var">vertexVec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; ST
     s
     (MVector (PrimState (ST s)) (vertex :+ Either source (VertexId s)))
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Int -&gt; m (MVector (PrimState m) a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.Mutable.html/Data.Vector.Mutable.html#new"><span class="hs-identifier hs-var">MV.new</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmptyVector vertex -&gt; Int
forall a. NonEmptyVector a -&gt; Int
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-vector-0.2.4-35b277dd8fff524486dc8302cf5c123530ebecd0662a66c97dfadfce0cb0b290/share/doc/html/src/Data.Vector.NonEmpty.html/Data.Vector.NonEmpty.html#length"><span class="hs-identifier hs-var">V.length</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptyVector vertex
</span><a href="#local-6989586621679453214"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">forM_</span></span><span> </span><span class="annot"><a href="#local-6989586621679453213"><span class="hs-identifier hs-type">parents</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679453238"><span class="annot"><span class="annottext">VertexId s
</span><a href="#local-6989586621679453238"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679453239"><span class="annot"><span class="annottext">Either source (vertex :+ VertexId s)
</span><a href="#local-6989586621679453239"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679453240"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679453240"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexId s -&gt; Int
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">VertexId s
</span><a href="#local-6989586621679453238"><span class="hs-identifier hs-var">i'</span></a></span><span>
</span><span id="line-76"></span><span>                              </span><span id="local-6989586621679453241"><span class="annot"><span class="annottext">p :: Either source (VertexId s)
</span><a href="#local-6989586621679453241"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting (VertexId s) (vertex :+ VertexId s) (VertexId s)
-&gt; (vertex :+ VertexId s) -&gt; VertexId s
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (VertexId s) (vertex :+ VertexId s) (VertexId s)
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">((vertex :+ VertexId s) -&gt; VertexId s)
-&gt; Either source (vertex :+ VertexId s)
-&gt; Either source (VertexId s)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Either source (vertex :+ VertexId s)
</span><a href="#local-6989586621679453239"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-77"></span><span>                          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">MVector (PrimState (ST s)) (vertex :+ Either source (VertexId s))
-&gt; Int -&gt; (vertex :+ Either source (VertexId s)) -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MVector (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.Mutable.html/Data.Vector.Mutable.html#write"><span class="hs-identifier hs-var">MV.write</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s (vertex :+ Either source (VertexId s))
MVector (PrimState (ST s)) (vertex :+ Either source (VertexId s))
</span><a href="#local-6989586621679453234"><span class="hs-identifier hs-var">vertexVec</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679453240"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">((vertex :+ Either source (VertexId s)) -&gt; ST s ())
-&gt; (vertex :+ Either source (VertexId s)) -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmptyVector vertex
</span><a href="#local-6989586621679453214"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmptyVector vertex -&gt; Int -&gt; vertex
forall a. NonEmptyVector a -&gt; Int -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-vector-0.2.4-35b277dd8fff524486dc8302cf5c123530ebecd0662a66c97dfadfce0cb0b290/share/doc/html/src/Data.Vector.NonEmpty.html/Data.Vector.NonEmpty.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679453240"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
-&gt; Either source (VertexId s)
-&gt; vertex :+ Either source (VertexId s)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">Either source (VertexId s)
</span><a href="#local-6989586621679453241"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679453234"><span class="hs-identifier hs-type">vertexVec</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><span class="hs-comment">-- | Computes the shortest paths form the source point to all vertices of the polygon.</span></span><span>
</span><span id="line-81"></span><span id="local-6989586621679452759"><span id="local-6989586621679452760"><span id="local-6989586621679452761"><span id="local-6989586621679452762"><span id="local-6989586621679452763"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#computeShortestPaths%27"><span class="hs-identifier hs-type">computeShortestPaths'</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452759"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452760"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-82"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452761"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452760"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-83"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679452760"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452760"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-84"></span><span>                                </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>                             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452759"><span class="hs-identifier hs-type">source</span></a></span><span>
</span><span id="line-86"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.Type.html#CPlaneGraph"><span class="hs-identifier hs-type">CPlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452762"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452761"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonEdgeType"><span class="hs-identifier hs-type">PolygonEdgeType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452763"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-87"></span><span>                             </span><span class="hs-comment">--  ^ the triangulated polygon</span><span>
</span><span id="line-88"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679452761"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.PlanarGraph.Connected.Core.html/Hiraffe.PlanarGraph.Connected.Core.html#VertexId"><span class="hs-identifier hs-type">VertexId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452762"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679452759"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679452761"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.PlanarGraph.Connected.Core.html/Hiraffe.PlanarGraph.Connected.Core.html#VertexId"><span class="hs-identifier hs-type">VertexId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452762"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-89"></span><span id="computeShortestPaths%27"><span class="annot"><span class="annottext">computeShortestPaths' :: forall {k} source r vertex (s :: k) f.
(Point_ source 2 r, Point_ vertex 2 r, Num r, Ord r) =&gt;
source
-&gt; CPlaneGraph s vertex PolygonEdgeType f
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#computeShortestPaths%27"><span class="hs-identifier hs-var hs-var">computeShortestPaths'</span></a></span></span><span> </span><span id="local-6989586621679454027"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679454028"><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
</span><a href="#local-6989586621679454028"><span class="hs-identifier hs-var">poly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">source
-&gt; CPlaneGraph s vertex PolygonEdgeType f
-&gt; Maybe
     (DualTree
        (FaceIx (CPlaneGraph s vertex PolygonEdgeType f))
        (DartIx (CPlaneGraph s vertex PolygonEdgeType f))
        (FaceIx (CPlaneGraph s vertex PolygonEdgeType f),
         (VertexIx (CPlaneGraph s vertex PolygonEdgeType f), vertex)))
forall {k} source r point (s :: k) f.
(Point_ source 2 r, Point_ point 2 r, Ord r, Num r) =&gt;
source
-&gt; CPlaneGraph s point PolygonEdgeType f
-&gt; Maybe
     (DualTree
        (FaceIx (CPlaneGraph s point PolygonEdgeType f))
        (DartIx (CPlaneGraph s point PolygonEdgeType f))
        (FaceIx (CPlaneGraph s point PolygonEdgeType f),
         (VertexIx (CPlaneGraph s point PolygonEdgeType f), point)))
</span><a href="HGeometry.Polygon.Simple.DualTree.html#dualTreeFrom"><span class="hs-identifier hs-var">dualTreeFrom</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
</span><a href="#local-6989586621679454028"><span class="hs-identifier hs-var">poly</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">Maybe
  (DualTree
     (FaceIx (CPlaneGraph s vertex PolygonEdgeType f))
     (DartIx (CPlaneGraph s vertex PolygonEdgeType f))
     (FaceIx (CPlaneGraph s vertex PolygonEdgeType f),
      (VertexIx (CPlaneGraph s vertex PolygonEdgeType f), vertex)))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679454030"><span class="annot"><span class="annottext">DualTree
  (FaceIx (CPlaneGraph s vertex PolygonEdgeType f))
  (DartIx (CPlaneGraph s vertex PolygonEdgeType f))
  (FaceIx (CPlaneGraph s vertex PolygonEdgeType f),
   (VertexIx (CPlaneGraph s vertex PolygonEdgeType f), vertex))
</span><a href="#local-6989586621679454030"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
</span><a href="#local-6989586621679454031"><span class="hs-identifier hs-var">triang</span></a></span><span> </span><span class="annot"><span class="annottext">[(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-92"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(DartId s -&gt; Vector 2 (vertex :+ VertexId s))
-&gt; ((FaceId s, (VertexId s, vertex)) -&gt; vertex :+ VertexId s)
-&gt; DualTree (FaceId s) (DartId s) (FaceId s, (VertexId s, vertex))
-&gt; DualTree
     (FaceId s) (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s)
forall a b c d.
(a -&gt; b)
-&gt; (c -&gt; d) -&gt; DualTree (FaceId s) a c -&gt; DualTree (FaceId s) b d
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679454033"><span class="annot"><span class="annottext">DartId s
</span><a href="#local-6989586621679454033"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679454034"><span class="annot"><span class="annottext">VertexId s
</span><a href="#local-6989586621679454034"><span class="hs-identifier hs-var">ri</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679454035"><span class="annot"><span class="annottext">VertexId s
</span><a href="#local-6989586621679454035"><span class="hs-identifier hs-var">li</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679454036"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454036"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679454037"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454037"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
</span><a href="#local-6989586621679454028"><span class="hs-identifier hs-var">poly</span></a></span><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
-&gt; Getting
     ((VertexId s, VertexId s), (vertex, vertex))
     (CPlaneGraph s vertex PolygonEdgeType f)
     ((VertexId s, VertexId s), (vertex, vertex))
-&gt; ((VertexId s, VertexId s), (vertex, vertex))
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">DartIx (CPlaneGraph s vertex PolygonEdgeType f)
-&gt; IndexedGetter
     (VertexIx (CPlaneGraph s vertex PolygonEdgeType f),
      VertexIx (CPlaneGraph s vertex PolygonEdgeType f))
     (CPlaneGraph s vertex PolygonEdgeType f)
     (Vertex (CPlaneGraph s vertex PolygonEdgeType f),
      Vertex (CPlaneGraph s vertex PolygonEdgeType f))
forall graph.
DiGraph_ graph =&gt;
DartIx graph
-&gt; IndexedGetter
     (VertexIx graph, VertexIx graph) graph (Vertex graph, Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#endPointsOf"><span class="hs-identifier hs-var">endPointsOf</span></a></span><span> </span><span class="annot"><span class="annottext">DartIx (CPlaneGraph s vertex PolygonEdgeType f)
DartId s
</span><a href="#local-6989586621679454033"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">(Indexed
   (VertexId s, VertexId s)
   (vertex, vertex)
   (Const
      ((VertexId s, VertexId s), (vertex, vertex)) (vertex, vertex))
 -&gt; CPlaneGraph s vertex PolygonEdgeType f
 -&gt; Const
      ((VertexId s, VertexId s), (vertex, vertex))
      (CPlaneGraph s vertex PolygonEdgeType f))
-&gt; ((((VertexId s, VertexId s), (vertex, vertex))
     -&gt; Const
          ((VertexId s, VertexId s), (vertex, vertex))
          ((VertexId s, VertexId s), (vertex, vertex)))
    -&gt; Indexed
         (VertexId s, VertexId s)
         (vertex, vertex)
         (Const
            ((VertexId s, VertexId s), (vertex, vertex)) (vertex, vertex)))
-&gt; Getting
     ((VertexId s, VertexId s), (vertex, vertex))
     (CPlaneGraph s vertex PolygonEdgeType f)
     ((VertexId s, VertexId s), (vertex, vertex))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(((VertexId s, VertexId s), (vertex, vertex))
 -&gt; Const
      ((VertexId s, VertexId s), (vertex, vertex))
      ((VertexId s, VertexId s), (vertex, vertex)))
-&gt; Indexed
     (VertexId s, VertexId s)
     (vertex, vertex)
     (Const
        ((VertexId s, VertexId s), (vertex, vertex)) (vertex, vertex))
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s j t.
(Indexable i p, Functor f) =&gt;
p (i, s) (f (j, t)) -&gt; Indexed i s (f t)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Internal.Indexed.html/Control.Lens.Internal.Indexed.html#withIndex"><span class="hs-identifier hs-var">withIndex</span></a></span><span>
</span><span id="line-93"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(vertex :+ VertexId s)
-&gt; (vertex :+ VertexId s) -&gt; Vector 2 (vertex :+ VertexId s)
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454037"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; VertexId s -&gt; vertex :+ VertexId s
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId s
</span><a href="#local-6989586621679454035"><span class="hs-identifier hs-var">li</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454036"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; VertexId s -&gt; vertex :+ VertexId s
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId s
</span><a href="#local-6989586621679454034"><span class="hs-identifier hs-var">ri</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId s
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679454042"><span class="annot"><span class="annottext">VertexId s
</span><a href="#local-6989586621679454042"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679454043"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454043"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454043"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; VertexId s -&gt; vertex :+ VertexId s
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId s
</span><a href="#local-6989586621679454042"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DualTree (FaceId s) (DartId s) (FaceId s, (VertexId s, vertex))
DualTree
  (FaceIx (CPlaneGraph s vertex PolygonEdgeType f))
  (DartIx (CPlaneGraph s vertex PolygonEdgeType f))
  (FaceIx (CPlaneGraph s vertex PolygonEdgeType f),
   (VertexIx (CPlaneGraph s vertex PolygonEdgeType f), vertex))
</span><a href="#local-6989586621679454030"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>                 </span><span class="annot"><a href="HGeometry.Polygon.Simple.DualTree.html#RootZero"><span class="hs-identifier hs-type">RootZero</span></a></span><span>  </span><span class="annot"><span class="annottext">FaceId s
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-96"></span><span>                 </span><span class="annot"><a href="HGeometry.Polygon.Simple.DualTree.html#RootOne"><span class="hs-identifier hs-type">RootOne</span></a></span><span>   </span><span class="annot"><span class="annottext">FaceId s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454046"><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454046"><span class="hs-identifier hs-var">a</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">source
-&gt; (Vector 2 (vertex :+ VertexId s),
    BinaryTrie
      (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall source vertex r.
(Point_ vertex 2 r, Ord r, Num r, Point_ source 2 r) =&gt;
source
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Either source vertex]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454046"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-97"></span><span>                 </span><span class="annot"><a href="HGeometry.Polygon.Simple.DualTree.html#RootTwo"><span class="hs-identifier hs-type">RootTwo</span></a></span><span>   </span><span class="annot"><span class="annottext">FaceId s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454049"><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454049"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679454050"><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454050"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">source
-&gt; (Vector 2 (vertex :+ VertexId s),
    BinaryTrie
      (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall source vertex r.
(Point_ vertex 2 r, Ord r, Num r, Point_ source 2 r) =&gt;
source
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Either source vertex]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454049"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">source
-&gt; (Vector 2 (vertex :+ VertexId s),
    BinaryTrie
      (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall source vertex r.
(Point_ vertex 2 r, Ord r, Num r, Point_ source 2 r) =&gt;
source
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Either source vertex]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454050"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-98"></span><span>                 </span><span class="annot"><a href="HGeometry.Polygon.Simple.DualTree.html#RootThree"><span class="hs-identifier hs-type">RootThree</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId s
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454052"><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454052"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679454053"><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454053"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679454054"><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454054"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">source
-&gt; (Vector 2 (vertex :+ VertexId s),
    BinaryTrie
      (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall source vertex r.
(Point_ vertex 2 r, Ord r, Num r, Point_ source 2 r) =&gt;
source
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Either source vertex]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454052"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">source
-&gt; (Vector 2 (vertex :+ VertexId s),
    BinaryTrie
      (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall source vertex r.
(Point_ vertex 2 r, Ord r, Num r, Point_ source 2 r) =&gt;
source
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Either source vertex]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454053"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">source
-&gt; (Vector 2 (vertex :+ VertexId s),
    BinaryTrie
      (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall source vertex r.
(Point_ vertex 2 r, Ord r, Num r, Point_ source 2 r) =&gt;
source
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Either source vertex]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#compute"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 (vertex :+ VertexId s),
 BinaryTrie
   (Vector 2 (vertex :+ VertexId s)) (vertex :+ VertexId s))
</span><a href="#local-6989586621679454054"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>        </span><span id="local-6989586621679454031"><span class="annot"><span class="annottext">triang :: [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
</span><a href="#local-6989586621679454031"><span class="hs-identifier hs-var hs-var">triang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679454055"><span class="annot"><span class="annottext">vertex :+ VertexId s
</span><a href="#local-6989586621679454055"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex :+ VertexId s
</span><a href="#local-6989586621679454055"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">(vertex :+ VertexId s)
-&gt; Either source (vertex :+ VertexId s)
-&gt; (vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">source -&gt; Either source (vertex :+ VertexId s)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679454027"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((vertex :+ VertexId s)
 -&gt; (vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s))
-&gt; [vertex :+ VertexId s]
-&gt; [(vertex :+ VertexId s) :+ Either source (vertex :+ VertexId s)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
</span><a href="#local-6989586621679454028"><span class="hs-identifier hs-var">poly</span></a></span><span class="annot"><span class="annottext">CPlaneGraph s vertex PolygonEdgeType f
-&gt; Getting
     (Endo [vertex :+ VertexId s])
     (CPlaneGraph s vertex PolygonEdgeType f)
     (vertex :+ VertexId s)
-&gt; [vertex :+ VertexId s]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">FaceIx (CPlaneGraph s vertex PolygonEdgeType f)
-&gt; IndexedFold1
     (VertexIx (CPlaneGraph s vertex PolygonEdgeType f))
     (CPlaneGraph s vertex PolygonEdgeType f)
     (Vertex (CPlaneGraph s vertex PolygonEdgeType f))
forall planarGraph.
PlanarGraph_ planarGraph =&gt;
FaceIx planarGraph
-&gt; IndexedFold1
     (VertexIx planarGraph) planarGraph (Vertex planarGraph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.PlanarGraph.Class.html/Hiraffe.PlanarGraph.Class.html#boundaryVerticesOf"><span class="hs-identifier hs-var">boundaryVerticesOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DualTree (FaceId s) (DartId s) (FaceId s, (VertexId s, vertex))
DualTree
  (FaceIx (CPlaneGraph s vertex PolygonEdgeType f))
  (DartIx (CPlaneGraph s vertex PolygonEdgeType f))
  (FaceIx (CPlaneGraph s vertex PolygonEdgeType f),
   (VertexIx (CPlaneGraph s vertex PolygonEdgeType f), vertex))
</span><a href="#local-6989586621679454030"><span class="hs-identifier hs-var">tr</span></a></span><span class="annot"><span class="annottext">DualTree (FaceId s) (DartId s) (FaceId s, (VertexId s, vertex))
-&gt; Getting
     (FaceId s)
     (DualTree (FaceId s) (DartId s) (FaceId s, (VertexId s, vertex)))
     (FaceId s)
-&gt; FaceId s
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting
  (FaceId s)
  (DualTree (FaceId s) (DartId s) (FaceId s, (VertexId s, vertex)))
  (FaceId s)
forall a e b a' (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a') -&gt; DualTree a e b -&gt; f (DualTree a' e b)
</span><a href="HGeometry.Polygon.Simple.DualTree.html#rootVertex"><span class="hs-identifier hs-var">rootVertex</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Indexed
   (VertexId s) vertex (Const (Endo [vertex :+ VertexId s]) vertex)
 -&gt; CPlaneGraph s vertex PolygonEdgeType f
 -&gt; Const
      (Endo [vertex :+ VertexId s])
      (CPlaneGraph s vertex PolygonEdgeType f))
-&gt; (((vertex :+ VertexId s)
     -&gt; Const (Endo [vertex :+ VertexId s]) (vertex :+ VertexId s))
    -&gt; Indexed
         (VertexId s) vertex (Const (Endo [vertex :+ VertexId s]) vertex))
-&gt; Getting
     (Endo [vertex :+ VertexId s])
     (CPlaneGraph s vertex PolygonEdgeType f)
     (vertex :+ VertexId s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((vertex :+ VertexId s)
 -&gt; Const (Endo [vertex :+ VertexId s]) (vertex :+ VertexId s))
-&gt; Indexed
     (VertexId s) vertex (Const (Endo [vertex :+ VertexId s]) vertex)
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s t j.
(Indexable i p, Functor f) =&gt;
p (s :+ i) (f (t :+ j)) -&gt; Indexed i s (f t)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#asIndexedExt"><span class="hs-identifier hs-var">asIndexedExt</span></a></span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-comment">-- compute' = compute (=.=) s</span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-comment">-- (=.=) = (==) `on` (view extra)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- -- | Helper type for modeling vertices t</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- type Vertex' poly point = VertexIx poly :+ point</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">data</span><span> </span><span id="Range"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-var">Range</span></a></span></span><span> </span><span id="local-6989586621679452895"><span class="annot"><a href="#local-6989586621679452895"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EmptyRange"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#EmptyRange"><span class="hs-identifier hs-var">EmptyRange</span></a></span></span><span>
</span><span id="line-114"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="Range"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-var">Range</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_min"><span class="annot"><span class="annottext">forall r. Range r -&gt; r
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#_min"><span class="hs-identifier hs-var hs-var">_min</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679452895"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-115"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="_max"><span class="annot"><span class="annottext">forall r. Range r -&gt; r
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#_max"><span class="hs-identifier hs-var hs-var">_max</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679452895"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-116"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>             </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454066"><span id="local-6989586621679454072"><span id="local-6989586621679454076"><span class="annot"><span class="annottext">Int -&gt; Range r -&gt; ShowS
[Range r] -&gt; ShowS
Range r -&gt; String
(Int -&gt; Range r -&gt; ShowS)
-&gt; (Range r -&gt; String) -&gt; ([Range r] -&gt; ShowS) -&gt; Show (Range r)
forall r. Show r =&gt; Int -&gt; Range r -&gt; ShowS
forall r. Show r =&gt; [Range r] -&gt; ShowS
forall r. Show r =&gt; Range r -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall r. Show r =&gt; Int -&gt; Range r -&gt; ShowS
showsPrec :: Int -&gt; Range r -&gt; ShowS
$cshow :: forall r. Show r =&gt; Range r -&gt; String
show :: Range r -&gt; String
$cshowList :: forall r. Show r =&gt; [Range r] -&gt; ShowS
showList :: [Range r] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679454082"><span id="local-6989586621679454089"><span class="annot"><span class="annottext">Range r -&gt; Range r -&gt; Bool
(Range r -&gt; Range r -&gt; Bool)
-&gt; (Range r -&gt; Range r -&gt; Bool) -&gt; Eq (Range r)
forall r. Eq r =&gt; Range r -&gt; Range r -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall r. Eq r =&gt; Range r -&gt; Range r -&gt; Bool
== :: Range r -&gt; Range r -&gt; Bool
$c/= :: forall r. Eq r =&gt; Range r -&gt; Range r -&gt; Bool
/= :: Range r -&gt; Range r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679452911"><span id="local-6989586621679454095"><span id="local-6989586621679454099"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452911"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="annottext">Range r
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#EmptyRange"><span class="hs-identifier hs-var">EmptyRange</span></a></span><span>  </span><span id="local-6989586621679454104"><span class="annot"><span class="annottext">&lt;&gt; :: Range r -&gt; Range r -&gt; Range r
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621679454105"><span class="annot"><span class="annottext">Range r
</span><a href="#local-6989586621679454105"><span class="hs-identifier hs-var">r</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range r
</span><a href="#local-6989586621679454105"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679454106"><span class="annot"><span class="annottext">Range r
</span><a href="#local-6989586621679454106"><span class="hs-identifier hs-var">l</span></a></span></span><span>           </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Range r
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#EmptyRange"><span class="hs-identifier hs-var">EmptyRange</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range r
</span><a href="#local-6989586621679454106"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span id="local-6989586621679454107"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679454107"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454108"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679454108"><span class="hs-identifier hs-var">u'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Range r
forall r. r -&gt; r -&gt; Range r
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-var">Range</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679454107"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679454108"><span class="hs-identifier hs-var">u'</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679452914"><span id="local-6989586621679454113"><span id="local-6989586621679454117"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452914"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679454120"><span class="annot"><span class="annottext">mempty :: Range r
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range r
forall r. Range r
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#EmptyRange"><span class="hs-identifier hs-var">EmptyRange</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-keyword">newtype</span><span> </span><span id="Elem"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span></span><span> </span><span id="local-6989586621679454121"><span class="annot"><a href="#local-6989586621679454121"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Elem"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Elem"><span class="hs-identifier hs-var">Elem</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679454121"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454125"><span id="local-6989586621679454129"><span id="local-6989586621679454133"><span class="annot"><span class="annottext">Int -&gt; Elem a -&gt; ShowS
[Elem a] -&gt; ShowS
Elem a -&gt; String
(Int -&gt; Elem a -&gt; ShowS)
-&gt; (Elem a -&gt; String) -&gt; ([Elem a] -&gt; ShowS) -&gt; Show (Elem a)
forall a. Show a =&gt; Int -&gt; Elem a -&gt; ShowS
forall a. Show a =&gt; [Elem a] -&gt; ShowS
forall a. Show a =&gt; Elem a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Elem a -&gt; ShowS
showsPrec :: Int -&gt; Elem a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Elem a -&gt; String
show :: Elem a -&gt; String
$cshowList :: forall a. Show a =&gt; [Elem a] -&gt; ShowS
showList :: [Elem a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679454141"><span id="local-6989586621679454145"><span class="annot"><span class="annottext">Elem a -&gt; Elem a -&gt; Bool
(Elem a -&gt; Elem a -&gt; Bool)
-&gt; (Elem a -&gt; Elem a -&gt; Bool) -&gt; Eq (Elem a)
forall a. Eq a =&gt; Elem a -&gt; Elem a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; Elem a -&gt; Elem a -&gt; Bool
== :: Elem a -&gt; Elem a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Elem a -&gt; Elem a -&gt; Bool
/= :: Elem a -&gt; Elem a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679454155"><span id="local-6989586621679454159"><span id="local-6989586621679454163"><span id="local-6989586621679454167"><span id="local-6989586621679454171"><span id="local-6989586621679454175"><span id="local-6989586621679454179"><span class="annot"><span class="annottext">Eq (Elem a)
Eq (Elem a) =&gt;
(Elem a -&gt; Elem a -&gt; Ordering)
-&gt; (Elem a -&gt; Elem a -&gt; Bool)
-&gt; (Elem a -&gt; Elem a -&gt; Bool)
-&gt; (Elem a -&gt; Elem a -&gt; Bool)
-&gt; (Elem a -&gt; Elem a -&gt; Bool)
-&gt; (Elem a -&gt; Elem a -&gt; Elem a)
-&gt; (Elem a -&gt; Elem a -&gt; Elem a)
-&gt; Ord (Elem a)
Elem a -&gt; Elem a -&gt; Bool
Elem a -&gt; Elem a -&gt; Ordering
Elem a -&gt; Elem a -&gt; Elem a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (Elem a)
forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Bool
forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Ordering
forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Elem a
$ccompare :: forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Ordering
compare :: Elem a -&gt; Elem a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Bool
&lt; :: Elem a -&gt; Elem a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Bool
&lt;= :: Elem a -&gt; Elem a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Bool
&gt; :: Elem a -&gt; Elem a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Bool
&gt;= :: Elem a -&gt; Elem a -&gt; Bool
$cmax :: forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Elem a
max :: Elem a -&gt; Elem a -&gt; Elem a
$cmin :: forall a. Ord a =&gt; Elem a -&gt; Elem a -&gt; Elem a
min :: Elem a -&gt; Elem a -&gt; Elem a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">type</span><span> </span><span id="OrdSeq"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#OrdSeq"><span class="hs-identifier hs-var">OrdSeq</span></a></span></span><span> </span><span id="local-6989586621679454190"><span class="annot"><a href="#local-6989586621679454190"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#FingerTree"><span class="hs-identifier hs-type">FingerTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679454190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679454190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679452926"><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#Measured"><span class="hs-identifier hs-type">Measured</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452926"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679454196"><span class="annot"><span class="annottext">measure :: Elem a -&gt; Range a
</span><a href="#local-6989586621679454196"><span class="hs-identifier hs-var hs-var hs-var">measure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679454198"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679454198"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Range a
forall r. r -&gt; r -&gt; Range r
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-var">Range</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679454198"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679454198"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- testSeq :: OrdSeq Int</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- testSeq = FT.fromList $ map Elem [2,4..16]</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- testSplit = FT.search (isRightSplit 5) testSeq</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><span class="hs-comment">-- | The cusp of the funnel</span></span><span>
</span><span id="line-146"></span><span class="hs-keyword">data</span><span> </span><span id="Cusp"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span></span><span> </span><span id="local-6989586621679452927"><span class="annot"><a href="#local-6989586621679452927"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679452928"><span class="annot"><a href="#local-6989586621679452928"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Cusp"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_leftMost"><span class="annot"><span class="annottext">forall a v. Cusp a v -&gt; v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#_leftMost"><span class="hs-identifier hs-var hs-var">_leftMost</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679452928"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-147"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="_leftChain"><span class="annot"><span class="annottext">forall a v. Cusp a v -&gt; OrdSeq v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#_leftChain"><span class="hs-identifier hs-var hs-var">_leftChain</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#OrdSeq"><span class="hs-identifier hs-type">OrdSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452928"><span class="hs-identifier hs-type">v</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ from the diagonal towards the apex</span></span><span>
</span><span id="line-148"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="_apex"><span class="annot"><span class="annottext">forall a v. Cusp a v -&gt; a
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#_apex"><span class="hs-identifier hs-var hs-var">_apex</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679452927"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-149"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="_rightChain"><span class="annot"><span class="annottext">forall a v. Cusp a v -&gt; OrdSeq v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#_rightChain"><span class="hs-identifier hs-var hs-var">_rightChain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#OrdSeq"><span class="hs-identifier hs-type">OrdSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452928"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ from the diagonal towards the apex</span></span><span>
</span><span id="line-150"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="_rightMost"><span class="annot"><span class="annottext">forall a v. Cusp a v -&gt; v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#_rightMost"><span class="hs-identifier hs-var hs-var">_rightMost</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679452928"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-151"></span><span>                     </span><span class="hs-special">}</span><span>
</span><span id="line-152"></span><span>              </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454208"><span id="local-6989586621679454218"><span id="local-6989586621679454222"><span class="annot"><span class="annottext">Int -&gt; Cusp a v -&gt; ShowS
[Cusp a v] -&gt; ShowS
Cusp a v -&gt; String
(Int -&gt; Cusp a v -&gt; ShowS)
-&gt; (Cusp a v -&gt; String) -&gt; ([Cusp a v] -&gt; ShowS) -&gt; Show (Cusp a v)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall a v. (Show a, Show v) =&gt; Int -&gt; Cusp a v -&gt; ShowS
forall a v. (Show a, Show v) =&gt; [Cusp a v] -&gt; ShowS
forall a v. (Show a, Show v) =&gt; Cusp a v -&gt; String
$cshowsPrec :: forall a v. (Show a, Show v) =&gt; Int -&gt; Cusp a v -&gt; ShowS
showsPrec :: Int -&gt; Cusp a v -&gt; ShowS
$cshow :: forall a v. (Show a, Show v) =&gt; Cusp a v -&gt; String
show :: Cusp a v -&gt; String
$cshowList :: forall a v. (Show a, Show v) =&gt; [Cusp a v] -&gt; ShowS
showList :: [Cusp a v] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679454227"><span id="local-6989586621679454236"><span class="annot"><span class="annottext">Cusp a v -&gt; Cusp a v -&gt; Bool
(Cusp a v -&gt; Cusp a v -&gt; Bool)
-&gt; (Cusp a v -&gt; Cusp a v -&gt; Bool) -&gt; Eq (Cusp a v)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall a v. (Eq a, Eq v) =&gt; Cusp a v -&gt; Cusp a v -&gt; Bool
$c== :: forall a v. (Eq a, Eq v) =&gt; Cusp a v -&gt; Cusp a v -&gt; Bool
== :: Cusp a v -&gt; Cusp a v -&gt; Bool
$c/= :: forall a v. (Eq a, Eq v) =&gt; Cusp a v -&gt; Cusp a v -&gt; Bool
/= :: Cusp a v -&gt; Cusp a v -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><span class="hs-comment">-- | Lens to access the apex of the Cusp</span></span><span>
</span><span id="line-155"></span><span id="local-6989586621679452955"><span id="local-6989586621679452956"><span id="local-6989586621679452957"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#apex"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452957"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452956"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452957"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679452955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452956"><span class="hs-identifier hs-type">a'</span></a></span></span></span></span><span>
</span><span id="line-156"></span><span id="apex"><span class="annot"><span class="annottext">apex :: forall a v a' (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a') -&gt; Cusp a v -&gt; f (Cusp a' v)
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#apex"><span class="hs-identifier hs-var hs-var">apex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Cusp a v -&gt; a)
-&gt; (Cusp a v -&gt; a' -&gt; Cusp a' v)
-&gt; Lens (Cusp a v) (Cusp a' v) a a'
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp a v -&gt; a
forall a v. Cusp a v -&gt; a
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#_apex"><span class="hs-identifier hs-var">_apex</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span id="local-6989586621679454243"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679454243"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679454244"><span class="annot"><span class="annottext">OrdSeq v
</span><a href="#local-6989586621679454244"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454245"><span class="annot"><span class="annottext">OrdSeq v
</span><a href="#local-6989586621679454245"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679454246"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679454246"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679454247"><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679454247"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; OrdSeq v -&gt; a' -&gt; OrdSeq v -&gt; v -&gt; Cusp a' v
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679454243"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq v
</span><a href="#local-6989586621679454244"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679454247"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq v
</span><a href="#local-6989586621679454245"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679454246"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><span class="hs-comment">-- | The result of splitting a Cusp</span></span><span>
</span><span id="line-162"></span><span class="hs-keyword">data</span><span> </span><span id="Split"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Split"><span class="hs-identifier hs-var">Split</span></a></span></span><span> </span><span id="local-6989586621679453008"><span class="annot"><a href="#local-6989586621679453008"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679453009"><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ApexLeft"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-var">ApexLeft</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="AtApex"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#AtApex"><span class="hs-identifier hs-var">AtApex</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="ApexRight"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-var">ApexRight</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453009"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454254"><span id="local-6989586621679454265"><span id="local-6989586621679454269"><span class="annot"><span class="annottext">Int -&gt; Split a v -&gt; ShowS
[Split a v] -&gt; ShowS
Split a v -&gt; String
(Int -&gt; Split a v -&gt; ShowS)
-&gt; (Split a v -&gt; String)
-&gt; ([Split a v] -&gt; ShowS)
-&gt; Show (Split a v)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall a v. (Show a, Show v) =&gt; Int -&gt; Split a v -&gt; ShowS
forall a v. (Show a, Show v) =&gt; [Split a v] -&gt; ShowS
forall a v. (Show a, Show v) =&gt; Split a v -&gt; String
$cshowsPrec :: forall a v. (Show a, Show v) =&gt; Int -&gt; Split a v -&gt; ShowS
showsPrec :: Int -&gt; Split a v -&gt; ShowS
$cshow :: forall a v. (Show a, Show v) =&gt; Split a v -&gt; String
show :: Split a v -&gt; String
$cshowList :: forall a v. (Show a, Show v) =&gt; [Split a v] -&gt; ShowS
showList :: [Split a v] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679454274"><span id="local-6989586621679454284"><span class="annot"><span class="annottext">Split a v -&gt; Split a v -&gt; Bool
(Split a v -&gt; Split a v -&gt; Bool)
-&gt; (Split a v -&gt; Split a v -&gt; Bool) -&gt; Eq (Split a v)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall a v. (Eq a, Eq v) =&gt; Split a v -&gt; Split a v -&gt; Bool
$c== :: forall a v. (Eq a, Eq v) =&gt; Split a v -&gt; Split a v -&gt; Bool
== :: Split a v -&gt; Split a v -&gt; Bool
$c/= :: forall a v. (Eq a, Eq v) =&gt; Split a v -&gt; Split a v -&gt; Bool
/= :: Split a v -&gt; Split a v -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- isRightSplit q pref = \case</span><span>
</span><span id="line-169"></span><span class="hs-comment">--   EmptyRange -&gt; True</span><span>
</span><span id="line-170"></span><span class="hs-comment">--   Range y _  -&gt; case pref of</span><span>
</span><span id="line-171"></span><span class="hs-comment">--     EmptyRange -&gt; False</span><span>
</span><span id="line-172"></span><span class="hs-comment">--     Range _ x  -&gt; x &gt;= q &amp;&amp; q &lt;= y</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- Given a vertex w, the range \ell_1,..,\ell_i = p, and the range q=\ell_{i+1},..,\ell_n.</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- returns whether or not we make a right turn when going from w to p and then to q.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- i.e. this procedure is for searching on the left sequence of the cusp</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span id="local-6989586621679452976"><span id="local-6989586621679452977"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#isRightTurn"><span class="hs-identifier hs-type">isRightTurn</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452976"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452977"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452977"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679452977"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452976"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452976"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452976"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-184"></span><span id="isRightTurn"><span class="annot"><span class="annottext">isRightTurn :: forall vertex r.
(Point_ vertex 2 r, Ord r, Num r) =&gt;
vertex -&gt; Range vertex -&gt; Range vertex -&gt; Bool
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#isRightTurn"><span class="hs-identifier hs-var hs-var">isRightTurn</span></a></span></span><span> </span><span id="local-6989586621679454363"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454363"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679454364"><span class="annot"><span class="annottext">Range vertex
</span><a href="#local-6989586621679454364"><span class="hs-identifier hs-var">pref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="annottext">Range vertex
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#EmptyRange"><span class="hs-identifier hs-var">EmptyRange</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span id="local-6989586621679454365"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454365"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Range vertex
</span><a href="#local-6989586621679454364"><span class="hs-identifier hs-var">pref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">Range vertex
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#EmptyRange"><span class="hs-identifier hs-var">EmptyRange</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454366"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454366"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; vertex -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454363"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454366"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454365"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><span class="hs-comment">-- | for searching on the right sequence of the cusp</span></span><span>
</span><span id="line-191"></span><span id="local-6989586621679454369"><span id="local-6989586621679454370"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#isLeftTurn"><span class="hs-identifier hs-type">isLeftTurn</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679454369"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679454370"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679454370"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679454370"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679454369"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679454369"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679454369"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-193"></span><span id="isLeftTurn"><span class="annot"><span class="annottext">isLeftTurn :: forall vertex r.
(Point_ vertex 2 r, Ord r, Num r) =&gt;
vertex -&gt; Range vertex -&gt; Range vertex -&gt; Bool
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#isLeftTurn"><span class="hs-identifier hs-var hs-var">isLeftTurn</span></a></span></span><span> </span><span id="local-6989586621679454446"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454446"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679454447"><span class="annot"><span class="annottext">Range vertex
</span><a href="#local-6989586621679454447"><span class="hs-identifier hs-var">pref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><span class="annottext">Range vertex
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#EmptyRange"><span class="hs-identifier hs-var">EmptyRange</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span id="local-6989586621679454448"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454448"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Range vertex
</span><a href="#local-6989586621679454447"><span class="hs-identifier hs-var">pref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">Range vertex
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#EmptyRange"><span class="hs-identifier hs-var">EmptyRange</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679454449"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454449"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; vertex -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454446"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454449"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454448"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><span class="hs-comment">-- | Result of testing where a point lies w.r.t a cone</span></span><span>
</span><span id="line-200"></span><span class="hs-keyword">data</span><span> </span><span id="ConeCompare"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ConeCompare"><span class="hs-identifier hs-var">ConeCompare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InCone"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#InCone"><span class="hs-identifier hs-var">InCone</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="LeftOfCone"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#LeftOfCone"><span class="hs-identifier hs-var">LeftOfCone</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="RightOfCone"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#RightOfCone"><span class="hs-identifier hs-var">RightOfCone</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679454455"><span id="local-6989586621679454457"><span id="local-6989586621679454461"><span class="annot"><span class="annottext">Int -&gt; ConeCompare -&gt; ShowS
[ConeCompare] -&gt; ShowS
ConeCompare -&gt; String
(Int -&gt; ConeCompare -&gt; ShowS)
-&gt; (ConeCompare -&gt; String)
-&gt; ([ConeCompare] -&gt; ShowS)
-&gt; Show ConeCompare
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ConeCompare -&gt; ShowS
showsPrec :: Int -&gt; ConeCompare -&gt; ShowS
$cshow :: ConeCompare -&gt; String
show :: ConeCompare -&gt; String
$cshowList :: [ConeCompare] -&gt; ShowS
showList :: [ConeCompare] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679454464"><span id="local-6989586621679454468"><span class="annot"><span class="annottext">ConeCompare -&gt; ConeCompare -&gt; Bool
(ConeCompare -&gt; ConeCompare -&gt; Bool)
-&gt; (ConeCompare -&gt; ConeCompare -&gt; Bool) -&gt; Eq ConeCompare
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ConeCompare -&gt; ConeCompare -&gt; Bool
== :: ConeCompare -&gt; ConeCompare -&gt; Bool
$c/= :: ConeCompare -&gt; ConeCompare -&gt; Bool
/= :: ConeCompare -&gt; ConeCompare -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><span class="hs-comment">-- | test if w lies in the cone defined by apex a and vertices l and r.</span></span><span>
</span><span id="line-203"></span><span id="local-6989586621679452988"><span id="local-6989586621679452989"><span id="local-6989586621679452990"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#inApexCone"><span class="hs-identifier hs-type">inApexCone</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452988"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452989"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452990"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452989"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452989"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679452989"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452988"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452990"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452988"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452988"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ConeCompare"><span class="hs-identifier hs-type">ConeCompare</span></a></span></span></span></span><span>
</span><span id="line-205"></span><span id="inApexCone"><span class="annot"><span class="annottext">inApexCone :: forall vertex r apex.
(Point_ vertex 2 r, Point_ apex 2 r, Ord r, Num r) =&gt;
vertex -&gt; apex -&gt; vertex -&gt; vertex -&gt; ConeCompare
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#inApexCone"><span class="hs-identifier hs-var hs-var">inApexCone</span></a></span></span><span> </span><span id="local-6989586621679454705"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454705"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679454706"><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679454706"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679454707"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454707"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679454708"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454708"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">apex -&gt; vertex -&gt; vertex -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679454706"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454707"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454705"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-206"></span><span>                       </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConeCompare
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#LeftOfCone"><span class="hs-identifier hs-var">LeftOfCone</span></a></span><span>
</span><span id="line-207"></span><span>                       </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">apex -&gt; vertex -&gt; vertex -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679454706"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454708"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679454705"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-208"></span><span>                                </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConeCompare
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#RightOfCone"><span class="hs-identifier hs-var">RightOfCone</span></a></span><span>
</span><span id="line-209"></span><span>                                </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConeCompare
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#InCone"><span class="hs-identifier hs-var">InCone</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">{-
-- | Produce a singleton OrdSeq
singleton :: a -&gt; OrdSeq a
singleton = FT.singleton . Elem

-- | Return the first element of the OrdSeq, or the given default if the seq is empty
firstWith      :: OrdSeq a -&gt; a -&gt; a
firstWith s d = case FT.viewl s of
                  EmptyL -&gt; d
                  x :&lt; _ -&gt; coerce x
-}</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><span class="hs-comment">-- | Return the last element of the OrdSeq, or the given default if the seq is empty</span></span><span>
</span><span id="line-224"></span><span id="local-6989586621679452994"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#lastWith"><span class="hs-identifier hs-type">lastWith</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#OrdSeq"><span class="hs-identifier hs-type">OrdSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452994"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452994"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452994"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-225"></span><span id="lastWith"><span class="annot"><span class="annottext">lastWith :: forall a. OrdSeq a -&gt; a -&gt; a
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#lastWith"><span class="hs-identifier hs-var hs-var">lastWith</span></a></span></span><span> </span><span id="local-6989586621679454712"><span class="annot"><span class="annottext">OrdSeq a
</span><a href="#local-6989586621679454712"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679454713"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679454713"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrdSeq a -&gt; ViewR (FingerTree (Range a)) (Elem a)
forall v a.
Measured v a =&gt;
FingerTree v a -&gt; ViewR (FingerTree v) a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#viewr"><span class="hs-identifier hs-var">FT.viewr</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq a
</span><a href="#local-6989586621679454712"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>                 </span><span class="annot"><span class="annottext">ViewR (FingerTree (Range a)) (Elem a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#EmptyR"><span class="hs-identifier hs-var">FT.EmptyR</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679454713"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-227"></span><span>                 </span><span class="annot"><span class="annottext">OrdSeq a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3A%3E"><span class="hs-operator hs-type">FT.:&gt;</span></a></span><span> </span><span id="local-6989586621679454717"><span class="annot"><span class="annottext">Elem a
</span><a href="#local-6989586621679454717"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Elem a -&gt; a
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Elem a
</span><a href="#local-6989586621679454717"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Given a vertex w, splits the cusp into two cusps corresponding to the two</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- sides incident to w.</span><span>
</span><span id="line-232"></span><span id="local-6989586621679452999"><span id="local-6989586621679453000"><span id="local-6989586621679453001"><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#splitAtParent"><span class="hs-identifier hs-type">splitAtParent</span></a></span><span>                      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452999"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679453000"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679453000"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679453000"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-233"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679453001"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679453000"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-234"></span><span>                                      </span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>                                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452999"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453001"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452999"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Split"><span class="hs-identifier hs-type">Split</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453001"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452999"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span><span>
</span><span id="line-236"></span><span id="splitAtParent"><span class="annot"><span class="annottext">splitAtParent :: forall vertex r apex.
(Point_ vertex 2 r, Ord r, Num r, Point_ apex 2 r) =&gt;
vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#splitAtParent"><span class="hs-identifier hs-var hs-var">splitAtParent</span></a></span></span><span> </span><span id="local-6989586621679455074"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span id="local-6989586621679455075"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679455076"><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679455077"><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679455078"><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span id="local-6989586621679455079"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; apex -&gt; vertex -&gt; vertex -&gt; ConeCompare
forall vertex r apex.
(Point_ vertex 2 r, Point_ apex 2 r, Ord r, Num r) =&gt;
vertex -&gt; apex -&gt; vertex -&gt; vertex -&gt; ConeCompare
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#inApexCone"><span class="hs-identifier hs-var">inApexCone</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdSeq vertex -&gt; vertex -&gt; vertex
forall a. OrdSeq a -&gt; a -&gt; a
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#lastWith"><span class="hs-identifier hs-var">lastWith</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OrdSeq vertex -&gt; vertex -&gt; vertex
forall a. OrdSeq a -&gt; a -&gt; a
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#lastWith"><span class="hs-identifier hs-var">lastWith</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">ConeCompare
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#InCone"><span class="hs-identifier hs-var">InCone</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
forall a v. Cusp a v -&gt; Cusp a v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#AtApex"><span class="hs-identifier hs-var">AtApex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">ConeCompare
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#LeftOfCone"><span class="hs-identifier hs-var">LeftOfCone</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Split apex vertex
</span><a href="#local-6989586621679455080"><span class="hs-identifier hs-var">searchLeft</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">ConeCompare
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#RightOfCone"><span class="hs-identifier hs-var">RightOfCone</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Split apex vertex
</span><a href="#local-6989586621679455081"><span class="hs-identifier hs-var">searchRight</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679455080"><span class="annot"><span class="annottext">searchLeft :: Split apex vertex
</span><a href="#local-6989586621679455080"><span class="hs-identifier hs-var hs-var">searchLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Range vertex -&gt; Range vertex -&gt; Bool)
-&gt; OrdSeq vertex -&gt; SearchResult (Range vertex) (Elem vertex)
forall v a.
Measured v a =&gt;
(v -&gt; v -&gt; Bool) -&gt; FingerTree v a -&gt; SearchResult v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#search"><span class="hs-identifier hs-var">FT.search</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex -&gt; Range vertex -&gt; Range vertex -&gt; Bool
forall vertex r.
(Point_ vertex 2 r, Ord r, Num r) =&gt;
vertex -&gt; Range vertex -&gt; Range vertex -&gt; Bool
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#isRightTurn"><span class="hs-identifier hs-var">isRightTurn</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="annottext">SearchResult (Range vertex) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#Nowhere"><span class="hs-identifier hs-var">Nowhere</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Split apex vertex
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitAtParent: absurd: precondition on left chain failed&quot;</span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span id="local-6989586621679455086"><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455086"><span class="hs-identifier hs-var">lsL</span></a></span></span><span> </span><span id="local-6989586621679455087"><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455087"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679455088"><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455088"><span class="hs-identifier hs-var">lsR</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex -&gt; ViewL (FingerTree (Range vertex)) (Elem vertex)
forall v a.
Measured v a =&gt;
FingerTree v a -&gt; ViewL (FingerTree v) a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#viewl"><span class="hs-identifier hs-var">FT.viewl</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455086"><span class="hs-identifier hs-var">lsL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-245"></span><span>        </span><span class="annot"><span class="annottext">ViewL (FingerTree (Range vertex)) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Elem vertex -&gt; Bool
forall {point''} {point'} {point}.
(Dimension point'' ~ 2, Dimension point' ~ 2, Dimension point ~ 2,
 NumType point' ~ NumType point, NumType point'' ~ NumType point,
 Point_ point 2 (NumType point), Point_ point' 2 (NumType point),
 Point_ point'' 2 (NumType point), Num (NumType point),
 Ord (NumType point)) =&gt;
point -&gt; point' -&gt; Elem point'' -&gt; Bool
</span><a href="#local-6989586621679455091"><span class="hs-identifier hs-var">isRightTurn'</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455087"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>                    </span><span class="annot"><span class="annottext">Cusp vertex vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
forall a v. Cusp v v -&gt; Cusp a v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-var">ApexRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex -&gt; Elem vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex -&gt; OrdSeq vertex -&gt; OrdSeq vertex
forall v a. Measured v a =&gt; a -&gt; FingerTree v a -&gt; FingerTree v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                            </span><span class="hs-comment">-- we are really in the OnLeft case</span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="annottext">ViewL (FingerTree (Range vertex)) (Elem vertex)
</span><span class="hs-identifier">_</span></span><span>                           </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>                    </span><span class="annot"><span class="annottext">Cusp vertex vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
forall a v. Cusp v v -&gt; Cusp a v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-var">ApexRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455086"><span class="hs-identifier hs-var">lsL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elem vertex -&gt; vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455087"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455087"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex -&gt; OrdSeq vertex -&gt; OrdSeq vertex
forall v a. Measured v a =&gt; a -&gt; FingerTree v a -&gt; FingerTree v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455088"><span class="hs-identifier hs-var">lsR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">SearchResult (Range vertex) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#OnLeft"><span class="hs-identifier hs-var">OnLeft</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex -&gt; ViewL (FingerTree (Range vertex)) (Elem vertex)
forall v a.
Measured v a =&gt;
FingerTree v a -&gt; ViewL (FingerTree v) a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#viewl"><span class="hs-identifier hs-var">FT.viewl</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>        </span><span class="annot"><span class="annottext">ViewL (FingerTree (Range vertex)) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
forall a v. Cusp v v -&gt; Cusp a v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-var">ApexRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex -&gt; Elem vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex -&gt; OrdSeq vertex -&gt; OrdSeq vertex
forall v a. Measured v a =&gt; a -&gt; FingerTree v a -&gt; FingerTree v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>                    </span><span class="hs-comment">-- we necessarily make a right turn at l since we are left of the</span><span>
</span><span id="line-253"></span><span>                    </span><span class="hs-comment">-- visible cone</span><span>
</span><span id="line-254"></span><span>        </span><span id="local-6989586621679455093"><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455093"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Elem vertex -&gt; Bool
forall {point''} {point'} {point}.
(Dimension point'' ~ 2, Dimension point' ~ 2, Dimension point ~ 2,
 NumType point' ~ NumType point, NumType point'' ~ NumType point,
 Point_ point 2 (NumType point), Point_ point' 2 (NumType point),
 Point_ point'' 2 (NumType point), Num (NumType point),
 Ord (NumType point)) =&gt;
point -&gt; point' -&gt; Elem point'' -&gt; Bool
</span><a href="#local-6989586621679455091"><span class="hs-identifier hs-var">isRightTurn'</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455093"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>                    </span><span class="annot"><span class="annottext">Cusp vertex vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
forall a v. Cusp v v -&gt; Cusp a v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-var">ApexRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex -&gt; Elem vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex -&gt; OrdSeq vertex -&gt; OrdSeq vertex
forall v a. Measured v a =&gt; a -&gt; FingerTree v a -&gt; FingerTree v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>                   </span><span class="hs-comment">-- we actually allready make a right turn at l</span><span>
</span><span id="line-257"></span><span>                   </span><span class="hs-comment">-- so this is actually the same as the emptyL case</span><span>
</span><span id="line-258"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-259"></span><span>                    </span><span class="annot"><span class="annottext">Cusp vertex vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
forall a v. Cusp v v -&gt; Cusp a v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-var">ApexRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elem vertex -&gt; vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455093"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><span class="annottext">SearchResult (Range vertex) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#OnRight"><span class="hs-identifier hs-var">OnRight</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex -&gt; ViewR (FingerTree (Range vertex)) (Elem vertex)
forall v a.
Measured v a =&gt;
FingerTree v a -&gt; ViewR (FingerTree v) a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#viewr"><span class="hs-identifier hs-var">FT.viewr</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>          </span><span class="annot"><span class="annottext">ViewR (FingerTree (Range vertex)) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#EmptyR"><span class="hs-identifier hs-var">FT.EmptyR</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Split apex vertex
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitAtParent. searchLeft: absurd. emptyR&quot;</span></span><span>
</span><span id="line-263"></span><span>          </span><span id="local-6989586621679455096"><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455096"><span class="hs-identifier hs-var">lsL</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3A%3E"><span class="hs-operator hs-type">FT.:&gt;</span></a></span><span> </span><span id="local-6989586621679455097"><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455097"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>            </span><span class="annot"><span class="annottext">Cusp vertex vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
forall a v. Cusp v v -&gt; Cusp a v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-var">ApexRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455096"><span class="hs-identifier hs-var">lsL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elem vertex -&gt; vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455097"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621679455081"><span class="annot"><span class="annottext">searchRight :: Split apex vertex
</span><a href="#local-6989586621679455081"><span class="hs-identifier hs-var hs-var">searchRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Range vertex -&gt; Range vertex -&gt; Bool)
-&gt; OrdSeq vertex -&gt; SearchResult (Range vertex) (Elem vertex)
forall v a.
Measured v a =&gt;
(v -&gt; v -&gt; Bool) -&gt; FingerTree v a -&gt; SearchResult v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#search"><span class="hs-identifier hs-var">FT.search</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex -&gt; Range vertex -&gt; Range vertex -&gt; Bool
forall vertex r.
(Point_ vertex 2 r, Ord r, Num r) =&gt;
vertex -&gt; Range vertex -&gt; Range vertex -&gt; Bool
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#isLeftTurn"><span class="hs-identifier hs-var">isLeftTurn</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">SearchResult (Range vertex) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#Nowhere"><span class="hs-identifier hs-var">Nowhere</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Split apex vertex
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitAtParent: absurd: precondition on right chain failed&quot;</span></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span id="local-6989586621679455098"><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455098"><span class="hs-identifier hs-var">rsR</span></a></span></span><span> </span><span id="local-6989586621679455099"><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455099"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679455100"><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455100"><span class="hs-identifier hs-var">rsL</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex -&gt; ViewL (FingerTree (Range vertex)) (Elem vertex)
forall v a.
Measured v a =&gt;
FingerTree v a -&gt; ViewL (FingerTree v) a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#viewl"><span class="hs-identifier hs-var">FT.viewl</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455098"><span class="hs-identifier hs-var">rsR</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">ViewL (FingerTree (Range vertex)) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Elem vertex -&gt; Bool
forall {point''} {point'} {point}.
(Dimension point'' ~ 2, Dimension point' ~ 2, Dimension point ~ 2,
 NumType point' ~ NumType point, NumType point'' ~ NumType point,
 Point_ point 2 (NumType point), Point_ point' 2 (NumType point),
 Point_ point'' 2 (NumType point), Num (NumType point),
 Ord (NumType point)) =&gt;
point -&gt; point' -&gt; Elem point'' -&gt; Bool
</span><a href="#local-6989586621679455101"><span class="hs-identifier hs-var">isLeftTurn'</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455099"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>                   </span><span class="annot"><span class="annottext">Cusp apex vertex -&gt; Cusp vertex vertex -&gt; Split apex vertex
forall a v. Cusp a v -&gt; Cusp v v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-var">ApexLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex -&gt; Elem vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex -&gt; OrdSeq vertex -&gt; OrdSeq vertex
forall v a. Measured v a =&gt; a -&gt; FingerTree v a -&gt; FingerTree v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">ViewL (FingerTree (Range vertex)) (Elem vertex)
</span><span class="hs-identifier">_</span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>                   </span><span class="annot"><span class="annottext">Cusp apex vertex -&gt; Cusp vertex vertex -&gt; Split apex vertex
forall a v. Cusp a v -&gt; Cusp v v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-var">ApexLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455099"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex -&gt; OrdSeq vertex -&gt; OrdSeq vertex
forall v a. Measured v a =&gt; a -&gt; FingerTree v a -&gt; FingerTree v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455100"><span class="hs-identifier hs-var">rsL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elem vertex -&gt; vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455099"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455098"><span class="hs-identifier hs-var">rsR</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><span class="annottext">SearchResult (Range vertex) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#OnLeft"><span class="hs-identifier hs-var">OnLeft</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex -&gt; ViewL (FingerTree (Range vertex)) (Elem vertex)
forall v a.
Measured v a =&gt;
FingerTree v a -&gt; ViewL (FingerTree v) a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#viewl"><span class="hs-identifier hs-var">FT.viewl</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-274"></span><span>        </span><span class="annot"><span class="annottext">ViewL (FingerTree (Range vertex)) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#EmptyL"><span class="hs-identifier hs-var">EmptyL</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex -&gt; Cusp vertex vertex -&gt; Split apex vertex
forall a v. Cusp a v -&gt; Cusp v v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-var">ApexLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex -&gt; Elem vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex -&gt; OrdSeq vertex -&gt; OrdSeq vertex
forall v a. Measured v a =&gt; a -&gt; FingerTree v a -&gt; FingerTree v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>                    </span><span class="hs-comment">-- we necessarily make a left turn at r since we are right of the</span><span>
</span><span id="line-276"></span><span>                    </span><span class="hs-comment">-- visible cone</span><span>
</span><span id="line-277"></span><span>        </span><span id="local-6989586621679455102"><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455102"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Elem vertex -&gt; Bool
forall {point''} {point'} {point}.
(Dimension point'' ~ 2, Dimension point' ~ 2, Dimension point ~ 2,
 NumType point' ~ NumType point, NumType point'' ~ NumType point,
 Point_ point 2 (NumType point), Point_ point' 2 (NumType point),
 Point_ point'' 2 (NumType point), Num (NumType point),
 Ord (NumType point)) =&gt;
point -&gt; point' -&gt; Elem point'' -&gt; Bool
</span><a href="#local-6989586621679455101"><span class="hs-identifier hs-var">isLeftTurn'</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455102"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-278"></span><span>                    </span><span class="annot"><span class="annottext">Cusp apex vertex -&gt; Cusp vertex vertex -&gt; Split apex vertex
forall a v. Cusp a v -&gt; Cusp v v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-var">ApexLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex -&gt; Elem vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Elem vertex -&gt; OrdSeq vertex -&gt; OrdSeq vertex
forall v a. Measured v a =&gt; a -&gt; FingerTree v a -&gt; FingerTree v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3C%7C"><span class="hs-operator hs-var">&lt;|</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>                   </span><span class="hs-comment">-- we actually allready make a left turn at r</span><span>
</span><span id="line-280"></span><span>                   </span><span class="hs-comment">-- so this is actually the same as the emptyL case</span><span>
</span><span id="line-281"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-282"></span><span>                    </span><span class="annot"><span class="annottext">Cusp apex vertex -&gt; Cusp vertex vertex -&gt; Split apex vertex
forall a v. Cusp a v -&gt; Cusp v v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-var">ApexLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elem vertex -&gt; vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455102"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><span class="annottext">SearchResult (Range vertex) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#OnRight"><span class="hs-identifier hs-var">OnRight</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex -&gt; ViewR (FingerTree (Range vertex)) (Elem vertex)
forall v a.
Measured v a =&gt;
FingerTree v a -&gt; ViewR (FingerTree v) a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#viewr"><span class="hs-identifier hs-var">FT.viewr</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455078"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-285"></span><span>          </span><span class="annot"><span class="annottext">ViewR (FingerTree (Range vertex)) (Elem vertex)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#EmptyR"><span class="hs-identifier hs-var">FT.EmptyR</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Split apex vertex
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitAtParent. searchRight: absurd. emptyR&quot;</span></span><span>
</span><span id="line-286"></span><span>          </span><span id="local-6989586621679455103"><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455103"><span class="hs-identifier hs-var">rsR</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/fingertree-0.1.5.0-13b222bfe3c60f0321521586a25c191cbab36e73e65f149a498471a98f25c199/share/doc/html/src/Data.FingerTree.html/Data.FingerTree.html#%3A%3E"><span class="hs-operator hs-type">FT.:&gt;</span></a></span><span> </span><span id="local-6989586621679455104"><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455104"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex -&gt; Cusp vertex vertex -&gt; Split apex vertex
forall a v. Cusp a v -&gt; Cusp v v -&gt; Split a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-var">ApexLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; apex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp apex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455075"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455076"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">apex
</span><a href="#local-6989586621679455077"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp vertex vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455074"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Elem vertex -&gt; vertex
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Elem vertex
</span><a href="#local-6989586621679455104"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
</span><a href="#local-6989586621679455103"><span class="hs-identifier hs-var">rsR</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455079"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679455091"><span class="annot"><span class="annottext">isRightTurn' :: point -&gt; point' -&gt; Elem point'' -&gt; Bool
</span><a href="#local-6989586621679455091"><span class="hs-identifier hs-var hs-var">isRightTurn'</span></a></span></span><span> </span><span id="local-6989586621679455290"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679455290"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679455291"><span class="annot"><span class="annottext">point'
</span><a href="#local-6989586621679455291"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679455292"><span class="annot"><span class="annottext">point''
</span><a href="#local-6989586621679455292"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point' -&gt; point'' -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679455290"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">point'
</span><a href="#local-6989586621679455291"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">point''
</span><a href="#local-6989586621679455292"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621679455101"><span class="annot"><span class="annottext">isLeftTurn' :: point -&gt; point' -&gt; Elem point'' -&gt; Bool
</span><a href="#local-6989586621679455101"><span class="hs-identifier hs-var hs-var">isLeftTurn'</span></a></span></span><span>  </span><span id="local-6989586621679455474"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679455474"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679455475"><span class="annot"><span class="annottext">point'
</span><a href="#local-6989586621679455475"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Elem"><span class="hs-identifier hs-type">Elem</span></a></span><span> </span><span id="local-6989586621679455476"><span class="annot"><span class="annottext">point''
</span><a href="#local-6989586621679455476"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point' -&gt; point'' -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679455474"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">point'
</span><a href="#local-6989586621679455475"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">point''
</span><a href="#local-6989586621679455476"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="annot"><span class="hs-comment">-- | Run the actual shortest path computation.</span></span><span>
</span><span id="line-292"></span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#compute"><span class="hs-identifier hs-type">compute</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679452877"><span class="annot"><a href="#local-6989586621679452877"><span class="hs-identifier hs-type">source</span></a></span></span><span> </span><span id="local-6989586621679452875"><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span></span><span> </span><span id="local-6989586621679452876"><span class="annot"><a href="#local-6989586621679452876"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-293"></span><span>             </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452876"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452876"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679452876"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-294"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452877"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452876"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-295"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452877"><span class="hs-identifier hs-type">source</span></a></span><span>
</span><span id="line-297"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.Binary.html/HGeometry.Trie.Binary.html#BinaryTrie"><span class="hs-identifier hs-type">BinaryTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679452877"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span id="compute"><span class="annot"><span class="annottext">compute :: forall source vertex r.
(Point_ vertex 2 r, Ord r, Num r, Point_ source 2 r) =&gt;
source
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Either source vertex]
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#compute"><span class="hs-identifier hs-var hs-var">compute</span></a></span></span><span> </span><span id="local-6989586621679455507"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679455507"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679455508"><span class="annot"><span class="annottext">poly :: (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455508"><span class="hs-identifier hs-var">poly</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679455509"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455509"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span id="local-6989586621679455510"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455510"><span class="hs-identifier hs-var">r0</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BinaryTrie (Vector 2 vertex) vertex
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(source -&gt; Either source vertex)
-&gt; Cusp source vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Either source vertex]
forall (f :: * -&gt; *) apex.
(Applicative f, Point_ apex 2 r) =&gt;
(apex -&gt; f vertex)
-&gt; Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455511"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">source -&gt; Either source vertex
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; OrdSeq vertex
-&gt; source
-&gt; OrdSeq vertex
-&gt; vertex
-&gt; Cusp source vertex
forall a v. v -&gt; OrdSeq v -&gt; a -&gt; OrdSeq v -&gt; v -&gt; Cusp a v
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-var">Cusp</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455509"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679455507"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">OrdSeq vertex
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455510"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455508"><span class="hs-identifier hs-var">poly</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-comment">-- ^ The shortest path computation; the apex of the cusp may be the arbitrary source</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-comment">-- point initially. Afterwards it may swtich to always being a vertex.</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="#local-6989586621679455511"><span class="hs-identifier hs-type">go</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679453037"><span class="annot"><a href="#local-6989586621679453037"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679453038"><span class="annot"><a href="#local-6989586621679453038"><span class="hs-identifier hs-type">apex</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679453037"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679453038"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452876"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679453038"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679453037"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>            </span><span class="hs-comment">-- ^ action to lift the apex into an f vertex.</span><span>
</span><span id="line-307"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453038"><span class="hs-identifier hs-type">apex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-308"></span><span>            </span><span class="hs-comment">-- ^ current cusp</span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.Binary.html/HGeometry.Trie.Binary.html#BinaryTrie"><span class="hs-identifier hs-type">BinaryTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>            </span><span class="hs-comment">-- ^ the edge, and the</span><span>
</span><span id="line-311"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679453037"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679455511"><span class="annot"><span class="annottext">go :: forall (f :: * -&gt; *) apex.
(Applicative f, Point_ apex 2 r) =&gt;
(apex -&gt; f vertex)
-&gt; Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455511"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679455635"><span class="annot"><span class="annottext">apex -&gt; f vertex
</span><a href="#local-6989586621679455635"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>        </span><span id="local-6989586621679455639"><span class="annot"><span class="annottext">right :: a -&gt; f a
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var hs-var">right</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-comment">-- | run the computation, guarenteeing that the apex is a vertex</span><span>
</span><span id="line-316"></span><span>        </span><span id="local-6989586621679455640"><span class="annot"><span class="annottext">goVertex' :: Cusp vertex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455640"><span class="hs-identifier hs-var hs-var">goVertex'</span></a></span></span><span> </span><span id="local-6989586621679455641"><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455641"><span class="hs-identifier hs-var">cusp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((vertex :+ vertex) -&gt; vertex :+ f vertex)
-&gt; [vertex :+ vertex] -&gt; [vertex :+ f vertex]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASetter (vertex :+ vertex) (vertex :+ f vertex) vertex (f vertex)
-&gt; (vertex -&gt; f vertex) -&gt; (vertex :+ vertex) -&gt; vertex :+ f vertex
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter (vertex :+ vertex) (vertex :+ f vertex) vertex (f vertex)
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; f vertex
forall a. a -&gt; f a
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([vertex :+ vertex] -&gt; [vertex :+ f vertex])
-&gt; ((Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
    -&gt; [vertex :+ vertex])
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ vertex]
</span><a href="#local-6989586621679455643"><span class="hs-identifier hs-var">goVertex</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455641"><span class="hs-identifier hs-var">cusp'</span></a></span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-comment">-- | the actual worker; we create a closure for the 'left'.</span><span>
</span><span id="line-318"></span><span>        </span><span id="local-6989586621679455636"><span class="annot"><span class="annottext">worker :: Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var hs-var">worker</span></a></span></span><span> </span><span id="local-6989586621679455644"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455644"><span class="hs-identifier hs-var">cusp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 vertex
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679455645"><span class="annot"><span class="annottext">BinaryTrie (Vector 2 vertex) vertex
</span><a href="#local-6989586621679455645"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455646"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; f vertex -&gt; vertex :+ f vertex
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">f vertex
</span><a href="#local-6989586621679455647"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(vertex :+ f vertex)
-&gt; [vertex :+ f vertex] -&gt; [vertex :+ f vertex]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[vertex :+ f vertex]
</span><a href="#local-6989586621679455648"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-319"></span><span>           </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>             </span><span id="local-6989586621679455646"><span class="annot"><span class="annottext">w :: vertex
</span><a href="#local-6989586621679455646"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinaryTrie (Vector 2 vertex) vertex
</span><a href="#local-6989586621679455645"><span class="hs-identifier hs-var">tr</span></a></span><span class="annot"><span class="annottext">BinaryTrie (Vector 2 vertex) vertex
-&gt; Getting vertex (BinaryTrie (Vector 2 vertex) vertex) vertex
-&gt; vertex
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting vertex (BinaryTrie (Vector 2 vertex) vertex) vertex
forall {k} (f1 :: k -&gt; * -&gt; *) (e :: k) v (f2 :: * -&gt; *).
Functor f2 =&gt;
(v -&gt; f2 v) -&gt; TrieF f1 e v -&gt; f2 (TrieF f1 e v)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.Type.html/HGeometry.Trie.Type.html#root"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="hs-comment">-- ^ the vertex we are currently processing</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>             </span><span class="hs-comment">-- | the result of splitting the cusp into two cusps corresponding to the</span><span>
</span><span id="line-323"></span><span>             </span><span class="hs-comment">-- 'outgoing' diagonals.</span><span>
</span><span id="line-324"></span><span>             </span><span id="local-6989586621679455650"><span class="annot"><span class="annottext">split' :: Split apex vertex
</span><a href="#local-6989586621679455650"><span class="hs-identifier hs-var hs-var">split'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
forall vertex r apex.
(Point_ vertex 2 r, Ord r, Num r, Point_ apex 2 r) =&gt;
vertex -&gt; Cusp apex vertex -&gt; Split apex vertex
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#splitAtParent"><span class="hs-identifier hs-var">splitAtParent</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679455646"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455644"><span class="hs-identifier hs-var">cusp</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>             </span><span class="hs-comment">-- | the parent we assign to w, i.e. predecessor of w on the shortest path to s</span><span>
</span><span id="line-327"></span><span>             </span><span id="local-6989586621679455647"><span class="annot"><span class="annottext">p :: f vertex
</span><a href="#local-6989586621679455647"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Split apex vertex
</span><a href="#local-6989586621679455650"><span class="hs-identifier hs-var">split'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-328"></span><span>                        </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-type">ApexLeft</span></a></span><span>  </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621679455651"><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455651"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; f vertex
forall a. a -&gt; f a
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455651"><span class="hs-identifier hs-var">cr</span></a></span><span class="annot"><span class="annottext">Cusp vertex vertex
-&gt; Getting vertex (Cusp vertex vertex) vertex -&gt; vertex
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting vertex (Cusp vertex vertex) vertex
forall a v a' (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a') -&gt; Cusp a v -&gt; f (Cusp a' v)
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#apex"><span class="hs-identifier hs-var">apex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>                        </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#AtApex"><span class="hs-identifier hs-type">AtApex</span></a></span><span>    </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">apex -&gt; f vertex
</span><a href="#local-6989586621679455635"><span class="hs-identifier hs-var">left</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455644"><span class="hs-identifier hs-var">cusp</span></a></span><span class="annot"><span class="annottext">Cusp apex vertex -&gt; Getting apex (Cusp apex vertex) apex -&gt; apex
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting apex (Cusp apex vertex) apex
forall a v a' (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a') -&gt; Cusp a v -&gt; f (Cusp a' v)
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#apex"><span class="hs-identifier hs-var">apex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>                        </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-type">ApexRight</span></a></span><span> </span><span id="local-6989586621679455652"><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455652"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; f vertex
forall a. a -&gt; f a
</span><a href="#local-6989586621679455639"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455652"><span class="hs-identifier hs-var">cl</span></a></span><span class="annot"><span class="annottext">Cusp vertex vertex
-&gt; Getting vertex (Cusp vertex vertex) vertex -&gt; vertex
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting vertex (Cusp vertex vertex) vertex
forall a v a' (f :: * -&gt; *).
Functor f =&gt;
(a -&gt; f a') -&gt; Cusp a v -&gt; f (Cusp a' v)
</span><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#apex"><span class="hs-identifier hs-var">apex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>             </span><span class="hs-comment">-- | compute the rest of the shortest path tree; i.e.</span><span>
</span><span id="line-333"></span><span>             </span><span id="local-6989586621679455648"><span class="annot"><span class="annottext">rest :: [vertex :+ f vertex]
</span><a href="#local-6989586621679455648"><span class="hs-identifier hs-var hs-var">rest</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BinaryTrie (Vector 2 vertex) vertex
</span><a href="#local-6989586621679455645"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>               </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.Binary.html/HGeometry.Trie.Binary.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-335"></span><span>               </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.Binary.html/HGeometry.Trie.Binary.html#LeftNode"><span class="hs-identifier hs-type">LeftNode</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679455655"><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455655"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Split apex vertex
</span><a href="#local-6989586621679455650"><span class="hs-identifier hs-var">split'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-336"></span><span>                     </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-type">ApexLeft</span></a></span><span>  </span><span id="local-6989586621679455656"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455656"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span>    </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455656"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455655"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-337"></span><span>                     </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#AtApex"><span class="hs-identifier hs-type">AtApex</span></a></span><span>    </span><span id="local-6989586621679455657"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455657"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span>    </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455657"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455655"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-338"></span><span>                     </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-type">ApexRight</span></a></span><span> </span><span id="local-6989586621679455658"><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455658"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455640"><span class="hs-identifier hs-var">goVertex'</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455658"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455655"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-339"></span><span>               </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.Binary.html/HGeometry.Trie.Binary.html#RightNode"><span class="hs-identifier hs-type">RightNode</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679455660"><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455660"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Split apex vertex
</span><a href="#local-6989586621679455650"><span class="hs-identifier hs-var">split'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-340"></span><span>                     </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-type">ApexLeft</span></a></span><span>  </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679455661"><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455661"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455640"><span class="hs-identifier hs-var">goVertex'</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455661"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455660"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-341"></span><span>                     </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#AtApex"><span class="hs-identifier hs-type">AtApex</span></a></span><span>    </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679455662"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455662"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span>    </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455662"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455660"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-342"></span><span>                     </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-type">ApexRight</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679455663"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455663"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span>    </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455663"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455660"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-343"></span><span>               </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.Binary.html/HGeometry.Trie.Binary.html#TwoNode"><span class="hs-identifier hs-type">TwoNode</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679455665"><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455665"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679455666"><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455666"><span class="hs-identifier hs-var">r</span></a></span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Split apex vertex
</span><a href="#local-6989586621679455650"><span class="hs-identifier hs-var">split'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-344"></span><span>                 </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexLeft"><span class="hs-identifier hs-type">ApexLeft</span></a></span><span>  </span><span id="local-6989586621679455667"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455667"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span id="local-6989586621679455668"><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455668"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455667"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455665"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="annot"><span class="annottext">[vertex :+ f vertex]
-&gt; [vertex :+ f vertex] -&gt; [vertex :+ f vertex]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455640"><span class="hs-identifier hs-var">goVertex'</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455668"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455666"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-345"></span><span>                 </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#AtApex"><span class="hs-identifier hs-type">AtApex</span></a></span><span>    </span><span id="local-6989586621679455669"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455669"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span id="local-6989586621679455670"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455670"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455669"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455665"><span class="hs-identifier hs-var">l</span></a></span><span>    </span><span class="annot"><span class="annottext">[vertex :+ f vertex]
-&gt; [vertex :+ f vertex] -&gt; [vertex :+ f vertex]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455670"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455666"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-346"></span><span>                 </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#ApexRight"><span class="hs-identifier hs-type">ApexRight</span></a></span><span> </span><span id="local-6989586621679455671"><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455671"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span id="local-6989586621679455672"><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455672"><span class="hs-identifier hs-var">cr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455640"><span class="hs-identifier hs-var">goVertex'</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455671"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455665"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[vertex :+ f vertex]
-&gt; [vertex :+ f vertex] -&gt; [vertex :+ f vertex]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455636"><span class="hs-identifier hs-var">worker</span></a></span><span> </span><span class="annot"><span class="annottext">Cusp apex vertex
</span><a href="#local-6989586621679455672"><span class="hs-identifier hs-var">cr</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
</span><a href="#local-6989586621679455666"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-comment">-- | run the worker 'go' where the apex is now guaranteed to be a vertex as well.</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="#local-6989586621679455643"><span class="hs-identifier hs-type">goVertex</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.ShortestPath.Tree.html#Cusp"><span class="hs-identifier hs-type">Cusp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-351"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Trie.Binary.html/HGeometry.Trie.Binary.html#BinaryTrie"><span class="hs-identifier hs-type">BinaryTrie</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452875"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621679455643"><span class="annot"><span class="annottext">goVertex :: Cusp vertex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ vertex]
</span><a href="#local-6989586621679455643"><span class="hs-identifier hs-var hs-var">goVertex</span></a></span></span><span> </span><span id="local-6989586621679455673"><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455673"><span class="hs-identifier hs-var">cusp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[vertex :+ Identity vertex] -&gt; [vertex :+ vertex]
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">([vertex :+ Identity vertex] -&gt; [vertex :+ vertex])
-&gt; ((Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
    -&gt; [vertex :+ Identity vertex])
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ vertex]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(vertex -&gt; Identity vertex)
-&gt; Cusp vertex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ Identity vertex]
forall (f :: * -&gt; *) apex.
(Applicative f, Point_ apex 2 r) =&gt;
(apex -&gt; f vertex)
-&gt; Cusp apex vertex
-&gt; (Vector 2 vertex, BinaryTrie (Vector 2 vertex) vertex)
-&gt; [vertex :+ f vertex]
</span><a href="#local-6989586621679455511"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Identity vertex
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">Cusp vertex vertex
</span><a href="#local-6989586621679455673"><span class="hs-identifier hs-var">cusp</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- type R = RealNumber 5</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- test = let g = triangulate myPolygon</span><span>
</span><span id="line-362"></span><span class="hs-comment">--        in dualTreeFrom mySource g</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- mySource :: Point 2 R</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- mySource = Point2 224 112</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- myPolygon :: SimplePolygon (Point 2 R)</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- myPolygon = maybe (error &quot;absurd&quot;) id $ fromPoints</span><span>
</span><span id="line-368"></span><span class="hs-comment">--             [ Point2 80 160</span><span>
</span><span id="line-369"></span><span class="hs-comment">--             , Point2 64 64</span><span>
</span><span id="line-370"></span><span class="hs-comment">--             , Point2 96 64</span><span>
</span><span id="line-371"></span><span class="hs-comment">--             , Point2 128 80</span><span>
</span><span id="line-372"></span><span class="hs-comment">--             , Point2 96 112</span><span>
</span><span id="line-373"></span><span class="hs-comment">--             , Point2 192 112</span><span>
</span><span id="line-374"></span><span class="hs-comment">--             , Point2 192 32</span><span>
</span><span id="line-375"></span><span class="hs-comment">--             , Point2 304 64</span><span>
</span><span id="line-376"></span><span class="hs-comment">--             , Point2 224 160</span><span>
</span><span id="line-377"></span><span class="hs-comment">--             , Point2 304 128</span><span>
</span><span id="line-378"></span><span class="hs-comment">--             , Point2 320 48</span><span>
</span><span id="line-379"></span><span class="hs-comment">--             , Point2 352 160</span><span>
</span><span id="line-380"></span><span class="hs-comment">--             , Point2 224 224</span><span>
</span><span id="line-381"></span><span class="hs-comment">--             , Point2 208 128</span><span>
</span><span id="line-382"></span><span class="hs-comment">--             ]</span><span>
</span><span id="line-383"></span></pre></body></html>