<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.DelaunayTriangulation.DivideAndConquer</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html"><span class="hs-identifier">HGeometry.DelaunayTriangulation.DivideAndConquer</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Divide &amp; Conqueror Delaunay Triangulation</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delaunayTriangulation"><span class="hs-identifier">delaunayTriangulation</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-comment">-- , foo</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.html/Data.CircularList.html"><span class="hs-identifier">Data.CircularList</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CL</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IM</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-vector-0.2.4-35b277dd8fff524486dc8302cf5c123530ebecd0662a66c97dfadfce0cb0b290/share/doc/html/src/Data.Vector.NonEmpty.html/Data.Vector.NonEmpty.html"><span class="hs-identifier">Data.Vector.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NV</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Algorithms.DivideAndConquer.html/HGeometry.Algorithms.DivideAndConquer.html"><span class="hs-identifier">HGeometry.Algorithms.DivideAndConquer</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Ball</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Boundary</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.CircularList.Util.html/HGeometry.CircularList.Util.html"><span class="hs-identifier">HGeometry.CircularList.Util</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CU</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.ConvexHull.GrahamScan.html"><span class="hs-identifier">HGeometry.ConvexHull.GrahamScan</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GS</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Cyclic.html/HGeometry.Cyclic.html"><span class="hs-identifier">HGeometry.Cyclic</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html"><span class="hs-identifier">HGeometry.DelaunayTriangulation.Types</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html"><span class="hs-identifier">HGeometry.DelaunayTriangulation.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Naive</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Sort.html/HGeometry.Foldable.Sort.html"><span class="hs-identifier">HGeometry.Foldable.Sort</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.LineSegment</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Measured.Size.html/HGeometry.Measured.Size.html"><span class="hs-identifier">HGeometry.Measured.Size</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Class</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Convex</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Convex.Tangents.html"><span class="hs-identifier">HGeometry.Polygon.Convex.Tangents</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Merge.html"><span class="hs-identifier">HGeometry.Polygon.Convex.Merge</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Convex</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Simple.Class</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Simple.PossiblyDegenerate</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html"><span class="hs-identifier">HGeometry.Tree.Binary.Static</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- import           HGeometry.Number.Real.Rational</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- import           Debug.Trace</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- type R = RealNumber 5</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- TODO: this could use a rewrite. we shouldn't need the mapping</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- and it would be nice to just use the divideAndConquer1With strategy</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><span class="hs-comment">-- * Divide &amp; Conqueror Delaunay Triangulation</span></span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- Implementation of the Divide &amp; Conqueror algorithm as described in:</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- Two Algorithms for Constructing a Delaunay Triangulation</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- Lee and Schachter</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- International Journal of Computer and Information Sciences, Vol 9, No. 3, 1980</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- We store all adjacency lists in clockwise order</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- : If v on the convex hull, then its first entry in the adj. lists is its CCW</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- successor on the convex hull</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Rotating Right &lt;-&gt; rotate clockwise</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Computes the delaunay triangulation of a set of points.</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- Running time: \(O(n \log^2 n)\)</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- (note: the extra \(\log n\) factor is since we use an IntMap in the implementation)</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- pre:</span><span>
</span><span id="line-83"></span><span class="hs-comment">--      - the input is a *SET*, i.e. contains no duplicate points.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--      - no three colinear points</span><span>
</span><span id="line-85"></span><span class="hs-comment">--      - no four cocircular points</span><span>
</span><span id="line-86"></span><span id="local-6989586621679470849"><span id="local-6989586621679470851"><span id="local-6989586621679470852"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delaunayTriangulation"><span class="hs-identifier hs-type">delaunayTriangulation</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679470849"><span class="hs-identifier hs-type">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679470851"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679470852"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679470851"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679470852"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679470852"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-87"></span><span>                             </span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679470849"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470851"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Triangulation"><span class="hs-identifier hs-type">Triangulation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470851"><span class="hs-identifier hs-type">point</span></a></span></span></span></span><span>
</span><span id="line-89"></span><span id="delaunayTriangulation"><span class="annot"><span class="annottext">delaunayTriangulation :: forall (set :: * -&gt; *) point r.
(Foldable1 set, Point_ point 2 r, Ord point, Ord r, Num r) =&gt;
set point -&gt; Triangulation point
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delaunayTriangulation"><span class="hs-identifier hs-var hs-var">delaunayTriangulation</span></a></span></span><span> </span><span id="local-6989586621679471355"><span class="annot"><span class="annottext">set point
</span><a href="#local-6989586621679471355"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map point VertexID
-&gt; Vector point -&gt; Vector (CList VertexID) -&gt; Triangulation point
forall point.
Map point VertexID
-&gt; Vector point -&gt; Vector (CList VertexID) -&gt; Triangulation point
</span><a href="HGeometry.DelaunayTriangulation.Types.html#Triangulation"><span class="hs-identifier hs-var">Triangulation</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679471357"><span class="hs-identifier hs-var">vtxMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679471358"><span class="hs-identifier hs-var">ptsV</span></a></span><span> </span><span class="annot"><span class="annottext">Vector (CList VertexID)
</span><a href="#local-6989586621679471359"><span class="hs-identifier hs-var">adjV</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621679471358"><span class="annot"><span class="annottext">ptsV :: Vector point
</span><a href="#local-6989586621679471358"><span class="hs-identifier hs-var hs-var">ptsV</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">set point -&gt; Vector point
forall (vector :: * -&gt; *) (f :: * -&gt; *) a.
(Foldable f, Vector vector a, Ord a) =&gt;
f a -&gt; vector a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Sort.html/HGeometry.Foldable.Sort.html#sort"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">set point
</span><a href="#local-6989586621679471355"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-comment">-- sort lexicographically. TODO: make this more explicit</span><span>
</span><span id="line-92"></span><span>    </span><span id="local-6989586621679471357"><span class="annot"><span class="annottext">vtxMap :: Map point VertexID
</span><a href="#local-6989586621679471357"><span class="hs-identifier hs-var hs-var">vtxMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(point, VertexID)] -&gt; Map point VertexID
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(point, VertexID)] -&gt; Map point VertexID)
-&gt; (Vector point -&gt; [(point, VertexID)])
-&gt; Vector point
-&gt; Map point VertexID
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector (point, VertexID) -&gt; [(point, VertexID)]
forall a. Vector a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#toList"><span class="hs-identifier hs-var">V.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (point, VertexID) -&gt; [(point, VertexID)])
-&gt; (Vector point -&gt; Vector (point, VertexID))
-&gt; Vector point
-&gt; [(point, VertexID)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VertexID -&gt; point -&gt; (point, VertexID))
-&gt; Vector point -&gt; Vector (point, VertexID)
forall a b. (VertexID -&gt; a -&gt; b) -&gt; Vector a -&gt; Vector b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#imap"><span class="hs-identifier hs-var">V.imap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679471365"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471365"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679471366"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679471366"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679471366"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471365"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Vector point -&gt; Map point VertexID)
-&gt; Vector point -&gt; Map point VertexID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679471358"><span class="hs-identifier hs-var">ptsV</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679471367"><span class="annot"><span class="annottext">tr :: BinLeafTree (Count point) point
</span><a href="#local-6989586621679471367"><span class="hs-identifier hs-var hs-var">tr</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmptyVector point -&gt; BinLeafTree (Count point) point
forall (f :: * -&gt; *) a.
Foldable1 f =&gt;
f a -&gt; BinLeafTree (Count a) a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#asBalancedBinLeafTree"><span class="hs-identifier hs-var">asBalancedBinLeafTree</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmptyVector point -&gt; BinLeafTree (Count point) point)
-&gt; NonEmptyVector point -&gt; BinLeafTree (Count point) point
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; NonEmptyVector point
forall a. Vector a -&gt; NonEmptyVector a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-vector-0.2.4-35b277dd8fff524486dc8302cf5c123530ebecd0662a66c97dfadfce0cb0b290/share/doc/html/src/Data.Vector.NonEmpty.html/Data.Vector.NonEmpty.html#unsafeFromVector"><span class="hs-identifier hs-var">NV.unsafeFromVector</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679471358"><span class="hs-identifier hs-var">ptsV</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679471370"><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679471370"><span class="hs-identifier hs-var">adj</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) point
-&gt; Mapping point -&gt; (Adj, ConvexPolygon (point :+ VertexID))
forall point r.
(Point_ point 2 r, Ord point, Ord r, Num r) =&gt;
BinLeafTree (Count point) point
-&gt; Mapping point -&gt; (Adj, ConvexPolygon (point :+ VertexID))
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delaunayTriangulation%27"><span class="hs-identifier hs-var">delaunayTriangulation'</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) point
</span><a href="#local-6989586621679471367"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679471357"><span class="hs-identifier hs-var">vtxMap</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679471358"><span class="hs-identifier hs-var">ptsV</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679471359"><span class="annot"><span class="annottext">adjV :: Vector (CList VertexID)
</span><a href="#local-6989586621679471359"><span class="hs-identifier hs-var hs-var">adjV</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CList VertexID] -&gt; Vector (CList VertexID)
forall a. [a] -&gt; Vector a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#fromList"><span class="hs-identifier hs-var">V.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([CList VertexID] -&gt; Vector (CList VertexID))
-&gt; (Adj -&gt; [CList VertexID]) -&gt; Adj -&gt; Vector (CList VertexID)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Adj -&gt; [CList VertexID]
forall a. IntMap a -&gt; [a]
</span><span class="hs-identifier hs-var">IM.elems</span></span><span> </span><span class="annot"><span class="annottext">(Adj -&gt; Vector (CList VertexID)) -&gt; Adj -&gt; Vector (CList VertexID)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679471370"><span class="hs-identifier hs-var">adj</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- mergeConvex      :: PossiblyDegenerateSimplePolygon point (ConvexPolygon point)</span><span>
</span><span id="line-101"></span><span class="hs-comment">--                  -&gt; PossiblyDegenerateSimplePolygon point (ConvexPolygon point)</span><span>
</span><span id="line-102"></span><span class="hs-comment">--                  -&gt; PossiblyDegenerateSimplePolygon point (ConvexPolygon point)</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- mergeConvex l = \case</span><span>
</span><span id="line-104"></span><span class="hs-comment">--   ActualPolygon rCH -&gt; case l of</span><span>
</span><span id="line-105"></span><span class="hs-comment">--     ActualPolygon lCH -&gt; Convex.Merge lCH rCH</span><span>
</span><span id="line-106"></span><span class="hs-comment">--     _                 -&gt; foldr insertVertex rCH l</span><span>
</span><span id="line-107"></span><span class="hs-comment">--   r                  -&gt; case l of</span><span>
</span><span id="line-108"></span><span class="hs-comment">--     ActualPolygon lCH -&gt; foldr insertVertex lCH r</span><span>
</span><span id="line-109"></span><span class="hs-comment">--     _                 -&gt; GS.grahamScan (toNonEmpty l &lt;&gt; toNonEmpty l)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- -- | Given a point outside the convex polygon, insert it into the polygon</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- insertVertex      :: point -&gt; ConvexPolygon polygon -&gt; ConvexPolygon point</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- insertVertex q pg = let</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- : pre: - Input points are sorted lexicographically</span><span>
</span><span id="line-120"></span><span id="local-6989586621679470921"><span id="local-6989586621679470922"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delaunayTriangulation%27"><span class="hs-identifier hs-type">delaunayTriangulation'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679470921"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679470922"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679470921"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679470922"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679470922"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#BinLeafTree"><span class="hs-identifier hs-type">BinLeafTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Measured.Size.html/HGeometry.Measured.Size.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470921"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679470921"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-122"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Mapping"><span class="hs-identifier hs-type">Mapping</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470921"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-123"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConvexPolygon</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679470921"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-124"></span><span id="delaunayTriangulation%27"><span class="annot"><span class="annottext">delaunayTriangulation' :: forall point r.
(Point_ point 2 r, Ord point, Ord r, Num r) =&gt;
BinLeafTree (Count point) point
-&gt; Mapping point -&gt; (Adj, ConvexPolygon (point :+ VertexID))
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delaunayTriangulation%27"><span class="hs-identifier hs-var hs-var">delaunayTriangulation'</span></a></span></span><span> </span><span id="local-6989586621679471870"><span class="annot"><span class="annottext">BinLeafTree (Count point) point
</span><a href="#local-6989586621679471870"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span id="local-6989586621679471871"><span class="annot"><span class="annottext">mapping' :: Mapping point
</span><a href="#local-6989586621679471871"><span class="hs-identifier hs-var">mapping'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679471872"><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679471872"><span class="hs-identifier hs-var">vtxMap</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Vector point
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) point
</span><a href="#local-6989586621679471870"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679471874"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679471874"><span class="hs-identifier hs-var">p</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679471875"><span class="annot"><span class="annottext">i :: VertexID
</span><a href="#local-6989586621679471875"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map point VertexID -&gt; point -&gt; VertexID
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-var">lookup'</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679471872"><span class="hs-identifier hs-var">vtxMap</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679471874"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-126"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; CList VertexID -&gt; Adj
forall a. VertexID -&gt; a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.singleton</span></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471875"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
forall a. CList a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#empty"><span class="hs-identifier hs-var">CL.empty</span></a></span><span>
</span><span id="line-127"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NonEmpty (point :+ VertexID) -&gt; ConvexPolygon (point :+ VertexID)
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable1 f) =&gt;
f point -&gt; simplePolygon
forall (f :: * -&gt; *).
Foldable1 f =&gt;
f (point :+ VertexID) -&gt; ConvexPolygon (point :+ VertexID)
</span><span class="hs-identifier hs-var">uncheckedFromCCWPoints</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (point :+ VertexID) -&gt; ConvexPolygon (point :+ VertexID))
-&gt; ((point :+ VertexID) -&gt; NonEmpty (point :+ VertexID))
-&gt; (point :+ VertexID)
-&gt; ConvexPolygon (point :+ VertexID)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(point :+ VertexID) -&gt; NonEmpty (point :+ VertexID)
forall a. a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.singleton</span></span><span> </span><span class="annot"><span class="annottext">((point :+ VertexID) -&gt; ConvexPolygon (point :+ VertexID))
-&gt; (point :+ VertexID) -&gt; ConvexPolygon (point :+ VertexID)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679471874"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; VertexID -&gt; point :+ VertexID
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471875"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-128"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>                        </span><span class="hs-comment">-- FIXME: this deifnes an invalid polygon..</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679471883"><span class="annot"><span class="annottext">BinLeafTree (Count point) point
</span><a href="#local-6989586621679471883"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Measured.Size.html/HGeometry.Measured.Size.html#Count"><span class="hs-identifier hs-type">Count</span></a></span><span> </span><span id="local-6989586621679471885"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679471885"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679471886"><span class="annot"><span class="annottext">BinLeafTree (Count point) point
</span><a href="#local-6989586621679471886"><span class="hs-identifier hs-var">rt</span></a></span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679471885"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679471888"><span class="annot"><span class="annottext">pts' :: BinLeafTree (Count point) (point :+ VertexID)
</span><a href="#local-6989586621679471888"><span class="hs-identifier hs-var hs-var">pts'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679471889"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679471889"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679471889"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; VertexID -&gt; point :+ VertexID
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID -&gt; point -&gt; VertexID
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-var">lookup'</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679471872"><span class="hs-identifier hs-var">vtxMap</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679471889"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(point -&gt; point :+ VertexID)
-&gt; BinLeafTree (Count point) point
-&gt; BinLeafTree (Count point) (point :+ VertexID)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) point
</span><a href="#local-6989586621679471870"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-132"></span><span>                       </span><span id="local-6989586621679471891"><span class="annot"><span class="annottext">ch :: ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471891"><span class="hs-identifier hs-var hs-var">ch</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) (point :+ VertexID)
-&gt; ConvexPolygon (point :+ VertexID)
forall (set :: * -&gt; *) r point.
(Foldable1 set, Ord r, Num r, Point_ point 2 r) =&gt;
set point -&gt; ConvexPolygon point
</span><a href="HGeometry.ConvexHull.GrahamScan.html#convexHull"><span class="hs-identifier hs-var">GS.convexHull</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) (point :+ VertexID)
</span><a href="#local-6989586621679471888"><span class="hs-identifier hs-var">pts'</span></a></span><span>
</span><span id="line-133"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mapping point -&gt; ConvexPolygon (point :+ VertexID) -&gt; Adj
forall point r.
(Point_ point 2 r, Ord point) =&gt;
Mapping point -&gt; ConvexPolygon (point :+ VertexID) -&gt; Adj
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#fromHull"><span class="hs-identifier hs-var">fromHull</span></a></span><span> </span><span class="annot"><span class="annottext">Mapping point
</span><a href="#local-6989586621679471871"><span class="hs-identifier hs-var">mapping'</span></a></span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471891"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471891"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471894"><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679471894"><span class="hs-identifier hs-var">ld</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679471895"><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471895"><span class="hs-identifier hs-var">lch</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) point
-&gt; Mapping point -&gt; (Adj, ConvexPolygon (point :+ VertexID))
forall point r.
(Point_ point 2 r, Ord point, Ord r, Num r) =&gt;
BinLeafTree (Count point) point
-&gt; Mapping point -&gt; (Adj, ConvexPolygon (point :+ VertexID))
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delaunayTriangulation%27"><span class="hs-identifier hs-var">delaunayTriangulation'</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) point
</span><a href="#local-6989586621679471883"><span class="hs-identifier hs-var">lt</span></a></span><span> </span><span class="annot"><span class="annottext">Mapping point
</span><a href="#local-6989586621679471871"><span class="hs-identifier hs-var">mapping'</span></a></span><span>
</span><span id="line-135"></span><span>                       </span><span class="hs-special">(</span><span id="local-6989586621679471896"><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679471896"><span class="hs-identifier hs-var">rd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679471897"><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471897"><span class="hs-identifier hs-var">rch</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) point
-&gt; Mapping point -&gt; (Adj, ConvexPolygon (point :+ VertexID))
forall point r.
(Point_ point 2 r, Ord point, Ord r, Num r) =&gt;
BinLeafTree (Count point) point
-&gt; Mapping point -&gt; (Adj, ConvexPolygon (point :+ VertexID))
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delaunayTriangulation%27"><span class="hs-identifier hs-var">delaunayTriangulation'</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (Count point) point
</span><a href="#local-6989586621679471886"><span class="hs-identifier hs-var">rt</span></a></span><span> </span><span class="annot"><span class="annottext">Mapping point
</span><a href="#local-6989586621679471871"><span class="hs-identifier hs-var">mapping'</span></a></span><span>
</span><span id="line-136"></span><span>                       </span><span class="hs-special">(</span><span id="local-6989586621679471898"><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471898"><span class="hs-identifier hs-var">ch</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471899"><span class="annot"><span class="annottext">ClosedLineSegment
  ((point :+ VertexID)
   :+ VertexIx (ConvexPolygon (point :+ VertexID)))
</span><a href="#local-6989586621679471899"><span class="hs-identifier hs-var">bt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679471900"><span class="annot"><span class="annottext">ClosedLineSegment
  ((point :+ VertexID)
   :+ VertexIx (ConvexPolygon (point :+ VertexID)))
</span><a href="#local-6989586621679471900"><span class="hs-identifier hs-var">ut</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
-&gt; ConvexPolygon (point :+ VertexID)
-&gt; (ConvexPolygon (point :+ VertexID),
    ClosedLineSegment
      ((point :+ VertexID)
       :+ VertexIx (ConvexPolygon (point :+ VertexID))),
    ClosedLineSegment
      ((point :+ VertexID)
       :+ VertexIx (ConvexPolygon (point :+ VertexID))))
forall convexPolygon point r.
(ConvexPolygon_ convexPolygon point r, Num r, Ord r) =&gt;
convexPolygon
-&gt; convexPolygon
-&gt; (convexPolygon,
    ClosedLineSegment (point :+ VertexIx convexPolygon),
    ClosedLineSegment (point :+ VertexIx convexPolygon))
</span><a href="HGeometry.Polygon.Convex.Merge.html#merge"><span class="hs-identifier hs-var">Convex.merge</span></a></span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471895"><span class="hs-identifier hs-var">lch</span></a></span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471897"><span class="hs-identifier hs-var">rch</span></a></span><span>
</span><span id="line-137"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Adj
-&gt; Adj
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; Mapping point
-&gt; Firsts
-&gt; Adj
forall point r.
(Point_ point 2 r, Ord point, Ord r, Num r) =&gt;
Adj
-&gt; Adj
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; Mapping point
-&gt; Firsts
-&gt; Adj
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#merge"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679471894"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679471896"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (point :+ VertexID)
  ((point :+ VertexID) :+ VertexID)
  (point :+ VertexID)
-&gt; ((point :+ VertexID) :+ VertexID) -&gt; point :+ VertexID
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (point :+ VertexID)
  ((point :+ VertexID) :+ VertexID)
  (point :+ VertexID)
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="annot"><span class="annottext">(((point :+ VertexID) :+ VertexID) -&gt; point :+ VertexID)
-&gt; LineSegment (EndPoint 'Closed) ((point :+ VertexID) :+ VertexID)
-&gt; ClosedLineSegment (point :+ VertexID)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LineSegment (EndPoint 'Closed) ((point :+ VertexID) :+ VertexID)
ClosedLineSegment
  ((point :+ VertexID)
   :+ VertexIx (ConvexPolygon (point :+ VertexID)))
</span><a href="#local-6989586621679471899"><span class="hs-identifier hs-var">bt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (point :+ VertexID)
  ((point :+ VertexID) :+ VertexID)
  (point :+ VertexID)
-&gt; ((point :+ VertexID) :+ VertexID) -&gt; point :+ VertexID
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (point :+ VertexID)
  ((point :+ VertexID) :+ VertexID)
  (point :+ VertexID)
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span> </span><span class="annot"><span class="annottext">(((point :+ VertexID) :+ VertexID) -&gt; point :+ VertexID)
-&gt; LineSegment (EndPoint 'Closed) ((point :+ VertexID) :+ VertexID)
-&gt; ClosedLineSegment (point :+ VertexID)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LineSegment (EndPoint 'Closed) ((point :+ VertexID) :+ VertexID)
ClosedLineSegment
  ((point :+ VertexID)
   :+ VertexIx (ConvexPolygon (point :+ VertexID)))
</span><a href="#local-6989586621679471900"><span class="hs-identifier hs-var">ut</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Mapping point
</span><a href="#local-6989586621679471871"><span class="hs-identifier hs-var">mapping'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID) -&gt; Firsts
forall point r.
Point_ point 2 r =&gt;
ConvexPolygon (point :+ VertexID) -&gt; Firsts
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#firsts"><span class="hs-identifier hs-var">firsts</span></a></span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471898"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471898"><span class="hs-identifier hs-var">ch</span></a></span><span>
</span><span id="line-139"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-142"></span><span class="annot"><span class="hs-comment">-- * Implementation</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Mapping that says for each vtx in the convex hull what the first entry in</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- the adj. list should be.</span><span>
</span><span id="line-146"></span><span id="local-6989586621679471013"><span id="local-6989586621679471014"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#firsts"><span class="hs-identifier hs-type">firsts</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471013"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471014"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConvexPolygon</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679471013"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span></span></span><span>
</span><span id="line-148"></span><span id="firsts"><span class="annot"><span class="annottext">firsts :: forall point r.
Point_ point 2 r =&gt;
ConvexPolygon (point :+ VertexID) -&gt; Firsts
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#firsts"><span class="hs-identifier hs-var hs-var">firsts</span></a></span></span><span> </span><span id="local-6989586621679471941"><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471941"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(VertexID, VertexID)] -&gt; Firsts
forall a. [(VertexID, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(VertexID, VertexID)] -&gt; Firsts)
-&gt; ([(point :+ VertexID, point :+ VertexID)]
    -&gt; [(VertexID, VertexID)])
-&gt; [(point :+ VertexID, point :+ VertexID)]
-&gt; Firsts
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((point :+ VertexID, point :+ VertexID) -&gt; (VertexID, VertexID))
-&gt; [(point :+ VertexID, point :+ VertexID)]
-&gt; [(VertexID, VertexID)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((point :+ VertexID) -&gt; VertexID)
-&gt; ((point :+ VertexID) -&gt; VertexID)
-&gt; (point :+ VertexID, point :+ VertexID)
-&gt; (VertexID, VertexID)
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(point :+ VertexID)
-&gt; Getting VertexID (point :+ VertexID) VertexID -&gt; VertexID
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting VertexID (point :+ VertexID) VertexID
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(point :+ VertexID)
-&gt; Getting VertexID (point :+ VertexID) VertexID -&gt; VertexID
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting VertexID (point :+ VertexID) VertexID
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(point :+ VertexID, point :+ VertexID)] -&gt; Firsts)
-&gt; [(point :+ VertexID, point :+ VertexID)] -&gt; Firsts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471941"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
-&gt; Getting
     (Endo [(point :+ VertexID, point :+ VertexID)])
     (ConvexPolygon (point :+ VertexID))
     (point :+ VertexID, point :+ VertexID)
-&gt; [(point :+ VertexID, point :+ VertexID)]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">Getting
  (Endo [(point :+ VertexID, point :+ VertexID)])
  (ConvexPolygon (point :+ VertexID))
  (point :+ VertexID, point :+ VertexID)
((Vertex (ConvexPolygon (point :+ VertexID)),
  Vertex (ConvexPolygon (point :+ VertexID)))
 -&gt; Const
      (Endo [(point :+ VertexID, point :+ VertexID)])
      (Vertex (ConvexPolygon (point :+ VertexID)),
       Vertex (ConvexPolygon (point :+ VertexID))))
-&gt; ConvexPolygon (point :+ VertexID)
-&gt; Const
     (Endo [(point :+ VertexID, point :+ VertexID)])
     (ConvexPolygon (point :+ VertexID))
forall polygon.
HasOuterBoundary polygon =&gt;
IndexedFold1
  (VertexIx polygon, VertexIx polygon)
  polygon
  (Vertex polygon, Vertex polygon)
IndexedFold1
  (VertexIx (ConvexPolygon (point :+ VertexID)),
   VertexIx (ConvexPolygon (point :+ VertexID)))
  (ConvexPolygon (point :+ VertexID))
  (Vertex (ConvexPolygon (point :+ VertexID)),
   Vertex (ConvexPolygon (point :+ VertexID)))
</span><span class="hs-identifier hs-var">outerBoundaryEdges</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Given a polygon; construct the adjacency list representation</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- pre: at least two elements</span><span>
</span><span id="line-152"></span><span id="local-6989586621679470995"><span id="local-6989586621679470996"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#fromHull"><span class="hs-identifier hs-type">fromHull</span></a></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679470995"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679470996"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679470995"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Mapping"><span class="hs-identifier hs-type">Mapping</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470995"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConvexPolygon</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679470995"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span></span></span><span>
</span><span id="line-154"></span><span id="fromHull"><span class="annot"><span class="annottext">fromHull :: forall point r.
(Point_ point 2 r, Ord point) =&gt;
Mapping point -&gt; ConvexPolygon (point :+ VertexID) -&gt; Adj
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#fromHull"><span class="hs-identifier hs-var hs-var">fromHull</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679471980"><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679471980"><span class="hs-identifier hs-var">vtxMap</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Vector point
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679471981"><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471981"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679471982"><span class="annot"><span class="annottext">vs :: [VertexID]
</span><a href="#local-6989586621679471982"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679471983"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471983"><span class="hs-identifier hs-var">u</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679471984"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471984"><span class="hs-identifier hs-var">v</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679471985"><span class="annot"><span class="annottext">[VertexID]
</span><a href="#local-6989586621679471985"><span class="hs-identifier hs-var">vs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map point VertexID -&gt; point -&gt; VertexID
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-var">lookup'</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679471980"><span class="hs-identifier hs-var">vtxMap</span></a></span><span> </span><span class="annot"><span class="annottext">(point -&gt; VertexID)
-&gt; ((point :+ VertexID) -&gt; point)
-&gt; (point :+ VertexID)
-&gt; VertexID
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(point :+ VertexID)
-&gt; Getting point (point :+ VertexID) point -&gt; point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting point (point :+ VertexID) point
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>                                        </span><span class="annot"><span class="annottext">((point :+ VertexID) -&gt; VertexID)
-&gt; [point :+ VertexID] -&gt; [VertexID]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
</span><a href="#local-6989586621679471981"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">ConvexPolygon (point :+ VertexID)
-&gt; Getting
     (Endo [point :+ VertexID])
     (ConvexPolygon (point :+ VertexID))
     (point :+ VertexID)
-&gt; [point :+ VertexID]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">Getting
  (Endo [point :+ VertexID])
  (ConvexPolygon (point :+ VertexID))
  (point :+ VertexID)
(Vertex (ConvexPolygon (point :+ VertexID))
 -&gt; Const
      (Endo [point :+ VertexID])
      (Vertex (ConvexPolygon (point :+ VertexID))))
-&gt; ConvexPolygon (point :+ VertexID)
-&gt; Const
     (Endo [point :+ VertexID]) (ConvexPolygon (point :+ VertexID))
forall graph graph'.
HasVertices graph graph' =&gt;
IndexedTraversal1
  (VertexIx graph) graph graph' (Vertex graph) (Vertex graph')
IndexedTraversal1
  (VertexIx (ConvexPolygon (point :+ VertexID)))
  (ConvexPolygon (point :+ VertexID))
  (ConvexPolygon (point :+ VertexID))
  (Vertex (ConvexPolygon (point :+ VertexID)))
  (Vertex (ConvexPolygon (point :+ VertexID)))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span>
</span><span id="line-156"></span><span>                            </span><span id="local-6989586621679471987"><span class="annot"><span class="annottext">es :: [(VertexID, CList VertexID)]
</span><a href="#local-6989586621679471987"><span class="hs-identifier hs-var hs-var">es</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VertexID -&gt; VertexID -&gt; VertexID -&gt; (VertexID, CList VertexID))
-&gt; [VertexID]
-&gt; [VertexID]
-&gt; [VertexID]
-&gt; [(VertexID, CList VertexID)]
forall a b c d. (a -&gt; b -&gt; c -&gt; d) -&gt; [a] -&gt; [b] -&gt; [c] -&gt; [d]
</span><span class="hs-identifier hs-var">zipWith3</span></span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; VertexID -&gt; VertexID -&gt; (VertexID, CList VertexID)
forall {a} {a}. Eq a =&gt; a -&gt; a -&gt; a -&gt; (a, CList a)
</span><a href="#local-6989586621679471989"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[VertexID]
</span><a href="#local-6989586621679471982"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VertexID] -&gt; [VertexID]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[VertexID]
</span><a href="#local-6989586621679471982"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[VertexID] -&gt; [VertexID] -&gt; [VertexID]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471983"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[VertexID]
</span><a href="#local-6989586621679471985"><span class="hs-identifier hs-var">vs'</span></a></span><span> </span><span class="annot"><span class="annottext">[VertexID] -&gt; [VertexID] -&gt; [VertexID]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471983"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679471984"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>                            </span><span id="local-6989586621679471989"><span class="annot"><span class="annottext">f :: a -&gt; a -&gt; a -&gt; (a, CList a)
</span><a href="#local-6989586621679471989"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679471993"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471993"><span class="hs-identifier hs-var">prv</span></a></span></span><span> </span><span id="local-6989586621679471994"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471994"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679471995"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471995"><span class="hs-identifier hs-var">nxt</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471994"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a] -&gt; CList a
forall a. [a] -&gt; CList a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#fromList"><span class="hs-identifier hs-var">CL.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; CList a) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; CList a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.nub</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; CList a) -&gt; [a] -&gt; CList a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471993"><span class="hs-identifier hs-var">prv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679471995"><span class="hs-identifier hs-var">nxt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(VertexID, CList VertexID)] -&gt; Adj
forall a. [(VertexID, a)] -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.fromList</span></span><span> </span><span class="annot"><span class="annottext">[(VertexID, CList VertexID)]
</span><a href="#local-6989586621679471987"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Merge the two delaunay triangulations.</span><span>
</span><span id="line-162"></span><span class="hs-comment">--</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- running time: \(O(n)\) (although we cheat a bit by using a IntMap)</span><span>
</span><span id="line-164"></span><span id="local-6989586621679471003"><span id="local-6989586621679471004"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#merge"><span class="hs-identifier hs-type">merge</span></a></span><span>                            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471003"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471004"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471003"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471004"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679471004"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>                                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span>
</span><span id="line-166"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span>
</span><span id="line-167"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679471003"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>                                 </span><span class="annot"><span class="hs-comment">-- ^ lower tangent</span></span><span>
</span><span id="line-169"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679471003"><span class="hs-identifier hs-type">point</span></a></span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>                                 </span><span class="annot"><span class="hs-comment">-- ^ upper tangent</span></span><span>
</span><span id="line-171"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Mapping"><span class="hs-identifier hs-type">Mapping</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471003"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-172"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Firsts"><span class="hs-identifier hs-type">Firsts</span></a></span><span>
</span><span id="line-173"></span><span>                                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span></span></span><span>
</span><span id="line-174"></span><span id="merge"><span class="annot"><span class="annottext">merge :: forall point r.
(Point_ point 2 r, Ord point, Ord r, Num r) =&gt;
Adj
-&gt; Adj
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; Mapping point
-&gt; Firsts
-&gt; Adj
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#merge"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span id="local-6989586621679472098"><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679472098"><span class="hs-identifier hs-var">ld</span></a></span></span><span> </span><span id="local-6989586621679472099"><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679472099"><span class="hs-identifier hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679472100"><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
</span><a href="#local-6989586621679472100"><span class="hs-identifier hs-var">bt</span></a></span></span><span> </span><span id="local-6989586621679472101"><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
</span><a href="#local-6989586621679472101"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span id="local-6989586621679472102"><span class="annot"><span class="annottext">mapping' :: Mapping point
</span><a href="#local-6989586621679472102"><span class="hs-identifier hs-var">mapping'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679472103"><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679472103"><span class="hs-identifier hs-var">vtxMap</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Vector point
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679472104"><span class="annot"><span class="annottext">Firsts
</span><a href="#local-6989586621679472104"><span class="hs-identifier hs-var">fsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">(Reader (Mapping point, Firsts) Adj
 -&gt; (Mapping point, Firsts) -&gt; Adj)
-&gt; (Mapping point, Firsts)
-&gt; Reader (Mapping point, Firsts) Adj
-&gt; Adj
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Reader (Mapping point, Firsts) Adj
-&gt; (Mapping point, Firsts) -&gt; Adj
forall r a. Reader r a -&gt; r -&gt; a
</span><span class="hs-identifier hs-var">runReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mapping point
</span><a href="#local-6989586621679472102"><span class="hs-identifier hs-var">mapping'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Firsts
</span><a href="#local-6989586621679472104"><span class="hs-identifier hs-var">fsts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Reader (Mapping point, Firsts) Adj -&gt; Adj)
-&gt; (StateT Adj (ReaderT (Mapping point, Firsts) Identity) ()
    -&gt; Reader (Mapping point, Firsts) Adj)
-&gt; StateT Adj (ReaderT (Mapping point, Firsts) Identity) ()
-&gt; Adj
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StateT Adj (ReaderT (Mapping point, Firsts) Identity) ()
 -&gt; Adj -&gt; Reader (Mapping point, Firsts) Adj)
-&gt; Adj
-&gt; StateT Adj (ReaderT (Mapping point, Firsts) Identity) ()
-&gt; Reader (Mapping point, Firsts) Adj
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">StateT Adj (ReaderT (Mapping point, Firsts) Identity) ()
-&gt; Adj -&gt; Reader (Mapping point, Firsts) Adj
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m s
</span><span class="hs-identifier hs-var">execStateT</span></span><span> </span><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679472108"><span class="hs-identifier hs-var">adj</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT Adj (ReaderT (Mapping point, Firsts) Identity) () -&gt; Adj)
-&gt; StateT Adj (ReaderT (Mapping point, Firsts) Identity) () -&gt; Adj
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(VertexID, VertexID)
-&gt; VertexID
-&gt; VertexID
-&gt; StateT Adj (ReaderT (Mapping point, Firsts) Identity) ()
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
(VertexID, VertexID) -&gt; VertexID -&gt; VertexID -&gt; Merge point ()
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#moveUp"><span class="hs-identifier hs-var">moveUp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472110"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472111"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472112"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472113"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621679472112"><span class="annot"><span class="annottext">l :: VertexID
</span><a href="#local-6989586621679472112"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map point VertexID -&gt; point -&gt; VertexID
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-var">lookup'</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679472103"><span class="hs-identifier hs-var">vtxMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
</span><a href="#local-6989586621679472100"><span class="hs-identifier hs-var">bt</span></a></span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
-&gt; Getting point (ClosedLineSegment (point :+ VertexID)) point
-&gt; point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">((point :+ VertexID) -&gt; Const point (point :+ VertexID))
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; Const point (ClosedLineSegment (point :+ VertexID))
forall seg p. HasStart seg p =&gt; Lens' seg p
Lens' (ClosedLineSegment (point :+ VertexID)) (point :+ VertexID)
</span><span class="hs-identifier hs-var">start</span></span><span class="annot"><span class="annottext">(((point :+ VertexID) -&gt; Const point (point :+ VertexID))
 -&gt; ClosedLineSegment (point :+ VertexID)
 -&gt; Const point (ClosedLineSegment (point :+ VertexID)))
-&gt; ((point -&gt; Const point point)
    -&gt; (point :+ VertexID) -&gt; Const point (point :+ VertexID))
-&gt; Getting point (ClosedLineSegment (point :+ VertexID)) point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(point -&gt; Const point point)
-&gt; (point :+ VertexID) -&gt; Const point (point :+ VertexID)
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679472113"><span class="annot"><span class="annottext">r :: VertexID
</span><a href="#local-6989586621679472113"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map point VertexID -&gt; point -&gt; VertexID
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-var">lookup'</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679472103"><span class="hs-identifier hs-var">vtxMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
</span><a href="#local-6989586621679472100"><span class="hs-identifier hs-var">bt</span></a></span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
-&gt; Getting point (ClosedLineSegment (point :+ VertexID)) point
-&gt; point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">((point :+ VertexID) -&gt; Const point (point :+ VertexID))
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; Const point (ClosedLineSegment (point :+ VertexID))
forall seg p. HasEnd seg p =&gt; Lens' seg p
Lens' (ClosedLineSegment (point :+ VertexID)) (point :+ VertexID)
</span><span class="hs-identifier hs-var">end</span></span><span class="annot"><span class="annottext">(((point :+ VertexID) -&gt; Const point (point :+ VertexID))
 -&gt; ClosedLineSegment (point :+ VertexID)
 -&gt; Const point (ClosedLineSegment (point :+ VertexID)))
-&gt; ((point -&gt; Const point point)
    -&gt; (point :+ VertexID) -&gt; Const point (point :+ VertexID))
-&gt; Getting point (ClosedLineSegment (point :+ VertexID)) point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(point -&gt; Const point point)
-&gt; (point :+ VertexID) -&gt; Const point (point :+ VertexID)
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679472110"><span class="annot"><span class="annottext">tl :: VertexID
</span><a href="#local-6989586621679472110"><span class="hs-identifier hs-var hs-var">tl</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map point VertexID -&gt; point -&gt; VertexID
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-var">lookup'</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679472103"><span class="hs-identifier hs-var">vtxMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
</span><a href="#local-6989586621679472101"><span class="hs-identifier hs-var">ut</span></a></span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
-&gt; Getting point (ClosedLineSegment (point :+ VertexID)) point
-&gt; point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">((point :+ VertexID) -&gt; Const point (point :+ VertexID))
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; Const point (ClosedLineSegment (point :+ VertexID))
forall seg p. HasStart seg p =&gt; Lens' seg p
Lens' (ClosedLineSegment (point :+ VertexID)) (point :+ VertexID)
</span><span class="hs-identifier hs-var">start</span></span><span class="annot"><span class="annottext">(((point :+ VertexID) -&gt; Const point (point :+ VertexID))
 -&gt; ClosedLineSegment (point :+ VertexID)
 -&gt; Const point (ClosedLineSegment (point :+ VertexID)))
-&gt; ((point -&gt; Const point point)
    -&gt; (point :+ VertexID) -&gt; Const point (point :+ VertexID))
-&gt; Getting point (ClosedLineSegment (point :+ VertexID)) point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(point -&gt; Const point point)
-&gt; (point :+ VertexID) -&gt; Const point (point :+ VertexID)
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679472111"><span class="annot"><span class="annottext">tr :: VertexID
</span><a href="#local-6989586621679472111"><span class="hs-identifier hs-var hs-var">tr</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map point VertexID -&gt; point -&gt; VertexID
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-var">lookup'</span></a></span><span> </span><span class="annot"><span class="annottext">Map point VertexID
</span><a href="#local-6989586621679472103"><span class="hs-identifier hs-var">vtxMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
</span><a href="#local-6989586621679472101"><span class="hs-identifier hs-var">ut</span></a></span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexID)
-&gt; Getting point (ClosedLineSegment (point :+ VertexID)) point
-&gt; point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">((point :+ VertexID) -&gt; Const point (point :+ VertexID))
-&gt; ClosedLineSegment (point :+ VertexID)
-&gt; Const point (ClosedLineSegment (point :+ VertexID))
forall seg p. HasEnd seg p =&gt; Lens' seg p
Lens' (ClosedLineSegment (point :+ VertexID)) (point :+ VertexID)
</span><span class="hs-identifier hs-var">end</span></span><span class="annot"><span class="annottext">(((point :+ VertexID) -&gt; Const point (point :+ VertexID))
 -&gt; ClosedLineSegment (point :+ VertexID)
 -&gt; Const point (ClosedLineSegment (point :+ VertexID)))
-&gt; ((point -&gt; Const point point)
    -&gt; (point :+ VertexID) -&gt; Const point (point :+ VertexID))
-&gt; Getting point (ClosedLineSegment (point :+ VertexID)) point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(point -&gt; Const point point)
-&gt; (point :+ VertexID) -&gt; Const point (point :+ VertexID)
forall core extra core' (f :: * -&gt; *).
Functor f =&gt;
(core -&gt; f core') -&gt; (core :+ extra) -&gt; f (core' :+ extra)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#core"><span class="hs-identifier hs-var">core</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679472108"><span class="annot"><span class="annottext">adj :: Adj
</span><a href="#local-6989586621679472108"><span class="hs-identifier hs-var hs-var">adj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679472098"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="annot"><span class="annottext">Adj -&gt; Adj -&gt; Adj
forall a. IntMap a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-operator hs-var">`IM.union`</span></span><span> </span><span class="annot"><span class="annottext">Adj
</span><a href="#local-6989586621679472099"><span class="hs-identifier hs-var">rd</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-keyword">type</span><span> </span><span id="Merge"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span></span><span> </span><span id="local-6989586621679472117"><span class="annot"><a href="#local-6989586621679472117"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Mapping"><span class="hs-identifier hs-type">Mapping</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472117"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Firsts"><span class="hs-identifier hs-type">Firsts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-keyword">type</span><span> </span><span id="Firsts"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Firsts"><span class="hs-identifier hs-var">Firsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><span class="hs-comment">-- | Merges the two delaunay traingulations.</span></span><span>
</span><span id="line-188"></span><span id="local-6989586621679471099"><span id="local-6989586621679471100"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#moveUp"><span class="hs-identifier hs-type">moveUp</span></a></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471099"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471100"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471100"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679471100"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">,</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471099"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-190"></span><span id="moveUp"><span class="annot"><span class="annottext">moveUp :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
(VertexID, VertexID) -&gt; VertexID -&gt; VertexID -&gt; Merge point ()
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#moveUp"><span class="hs-identifier hs-var hs-var">moveUp</span></a></span></span><span> </span><span id="local-6989586621679472465"><span class="annot"><span class="annottext">(VertexID, VertexID)
</span><a href="#local-6989586621679472465"><span class="hs-identifier hs-var">ut</span></a></span></span><span> </span><span id="local-6989586621679472466"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472466"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679472467"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472467"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472466"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472467"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VertexID, VertexID) -&gt; (VertexID, VertexID) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(VertexID, VertexID)
</span><a href="#local-6989586621679472465"><span class="hs-identifier hs-var">ut</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; VertexID -&gt; Merge point ()
forall point r.
(Point_ point 2 r, Num r, Ord r) =&gt;
VertexID -&gt; VertexID -&gt; Merge point ()
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472466"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472467"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-193"></span><span>                     </span><span class="annot"><span class="annottext">VertexID -&gt; VertexID -&gt; Merge point ()
forall point r.
(Point_ point 2 r, Num r, Ord r) =&gt;
VertexID -&gt; VertexID -&gt; Merge point ()
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472466"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472467"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-194"></span><span>                     </span><span class="hs-comment">-- Get the neighbours of r and l along the convex hull</span><span>
</span><span id="line-195"></span><span>                     </span><span id="local-6989586621679472469"><span class="annot"><a href="#local-6989586621679472469"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Adj -&gt; CList VertexID)
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; CList VertexID
forall a. CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#pred%27"><span class="hs-identifier hs-var">pred'</span></a></span><span> </span><span class="annot"><span class="annottext">(CList VertexID -&gt; CList VertexID)
-&gt; (Adj -&gt; CList VertexID) -&gt; Adj -&gt; CList VertexID
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; CList VertexID -&gt; CList VertexID
forall a. Eq a =&gt; a -&gt; CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateTo"><span class="hs-identifier hs-var">rotateTo</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472466"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(CList VertexID -&gt; CList VertexID)
-&gt; (Adj -&gt; CList VertexID) -&gt; Adj -&gt; CList VertexID
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; Adj -&gt; CList VertexID
forall a. VertexID -&gt; IntMap a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27%27"><span class="hs-identifier hs-var">lookup''</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472467"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>                     </span><span id="local-6989586621679472474"><span class="annot"><a href="#local-6989586621679472474"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#succ%27"><span class="hs-identifier hs-type">succ'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateTo"><span class="hs-identifier hs-type">rotateTo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472467"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27%27"><span class="hs-identifier hs-type">lookup''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472466"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621679472476"><span class="annot"><a href="#local-6989586621679472476"><span class="hs-identifier hs-var">r1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679472477"><span class="annot"><a href="#local-6989586621679472477"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateR"><span class="hs-identifier hs-type">rotateR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472466"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472467"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472469"><span class="hs-identifier hs-type">r1</span></a></span><span>
</span><span id="line-199"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621679472479"><span class="annot"><a href="#local-6989586621679472479"><span class="hs-identifier hs-var">l1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679472480"><span class="annot"><a href="#local-6989586621679472480"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateL"><span class="hs-identifier hs-type">rotateL</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472466"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472467"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472474"><span class="hs-identifier hs-type">l1</span></a></span><span>
</span><span id="line-200"></span><span>                     </span><span id="local-6989586621679472482"><span class="annot"><a href="#local-6989586621679472482"><span class="hs-identifier hs-var">c</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#qTest"><span class="hs-identifier hs-type">qTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472466"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472467"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472476"><span class="hs-identifier hs-type">r1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472479"><span class="hs-identifier hs-type">l1'</span></a></span><span>
</span><span id="line-201"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679472484"><span class="annot"><a href="#local-6989586621679472484"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679472485"><span class="annot"><a href="#local-6989586621679472485"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679472477"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679472480"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679472482"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-202"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472479"><span class="hs-identifier hs-var">l1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472467"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472466"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span>          </span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472476"><span class="hs-identifier hs-var">r1'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472466"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span>          </span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472476"><span class="hs-identifier hs-var">r1'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472479"><span class="hs-identifier hs-var">l1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472467"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>                     </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#moveUp"><span class="hs-identifier hs-type">moveUp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472465"><span class="hs-identifier hs-type">ut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472484"><span class="hs-identifier hs-type">l'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472485"><span class="hs-identifier hs-type">r'</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | \'rotates\' around r and removes all neighbours of r that violate the</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- delaunay condition. Returns the first vertex (as a Neighbour of r) that</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- should remain in the Delaunay Triangulation, as well as a boolean A that</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- helps deciding if we merge up by rotating left or rotating right (See</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- description in the paper for more info)</span><span>
</span><span id="line-214"></span><span id="local-6989586621679471126"><span id="local-6989586621679471127"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateR"><span class="hs-identifier hs-type">rotateR</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471126"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471127"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471127"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679471127"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471126"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-216"></span><span id="rotateR"><span class="annot"><span class="annottext">rotateR :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID -&gt; CList VertexID -&gt; Merge point (CList VertexID, Bool)
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateR"><span class="hs-identifier hs-var hs-var">rotateR</span></a></span></span><span> </span><span id="local-6989586621679472622"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472622"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679472623"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472623"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679472624"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472624"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472624"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; (VertexID, VertexID) -&gt; Merge point Bool
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID -&gt; (VertexID, VertexID) -&gt; Merge point Bool
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#isLeftOf"><span class="hs-operator hs-var">`isLeftOf`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472622"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472623"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Merge point Bool
-&gt; (Bool
    -&gt; StateT
         Adj (Reader (Mapping point, Firsts)) (CList VertexID, Bool))
-&gt; StateT
     Adj (Reader (Mapping point, Firsts)) (CList VertexID, Bool)
forall a b.
StateT Adj (Reader (Mapping point, Firsts)) a
-&gt; (a -&gt; StateT Adj (Reader (Mapping point, Firsts)) b)
-&gt; StateT Adj (Reader (Mapping point, Firsts)) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-217"></span><span>                   </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CList VertexID -&gt; (CList VertexID, Bool))
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
-&gt; StateT
     Adj (Reader (Mapping point, Firsts)) (CList VertexID, Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VertexID
-&gt; VertexID
-&gt; CList VertexID
-&gt; CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID
-&gt; CList VertexID
-&gt; CList VertexID
-&gt; Merge point (CList VertexID)
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateR%27"><span class="hs-identifier hs-var">rotateR'</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472622"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472623"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472624"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; CList VertexID
forall a. CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#pred%27"><span class="hs-identifier hs-var">pred'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472624"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>                   </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CList VertexID, Bool)
-&gt; StateT
     Adj (Reader (Mapping point, Firsts)) (CList VertexID, Bool)
forall a. a -&gt; StateT Adj (Reader (Mapping point, Firsts)) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472624"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><span class="hs-comment">-- | The code that does the actual rotating</span></span><span>
</span><span id="line-222"></span><span id="local-6989586621679471144"><span id="local-6989586621679471145"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateR%27"><span class="hs-identifier hs-type">rotateR'</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471144"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471145"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471145"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679471145"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471144"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span></span></span><span>
</span><span id="line-224"></span><span id="rotateR%27"><span class="annot"><span class="annottext">rotateR' :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID
-&gt; CList VertexID
-&gt; CList VertexID
-&gt; Merge point (CList VertexID)
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateR%27"><span class="hs-identifier hs-var hs-var">rotateR'</span></a></span></span><span> </span><span id="local-6989586621679472706"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472706"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679472707"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472707"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList VertexID
-&gt; CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
</span><a href="#local-6989586621679472708"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679472708"><span class="annot"><span class="annottext">go :: CList VertexID
-&gt; CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
</span><a href="#local-6989586621679472708"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679472709"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472709"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621679472710"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472710"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexID
-&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID -&gt; Merge point Bool
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID -&gt; Merge point Bool
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#qTest"><span class="hs-identifier hs-var">qTest</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472706"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472707"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472709"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472710"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="annot"><span class="annottext">Merge point Bool
-&gt; (Bool
    -&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID))
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
forall a b.
StateT Adj (Reader (Mapping point, Firsts)) a
-&gt; (a -&gt; StateT Adj (Reader (Mapping point, Firsts)) b)
-&gt; StateT Adj (Reader (Mapping point, Firsts)) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-227"></span><span>                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
forall a. a -&gt; StateT Adj (Reader (Mapping point, Firsts)) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472709"><span class="hs-identifier hs-var">r1</span></a></span><span>
</span><span id="line-228"></span><span>                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">(Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ())
-&gt; (Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; VertexID -&gt; Adj -&gt; Adj
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472707"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472709"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>                             </span><span class="annot"><span class="annottext">CList VertexID
-&gt; CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
</span><a href="#local-6989586621679472708"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472710"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; CList VertexID
forall a. CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#pred%27"><span class="hs-identifier hs-var">pred'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472710"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="annot"><span class="hs-comment">-- | Symmetric to rotateR</span></span><span>
</span><span id="line-233"></span><span id="local-6989586621679472713"><span id="local-6989586621679472714"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateL"><span class="hs-identifier hs-type">rotateL</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472713"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472714"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472714"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679472714"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472713"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-235"></span><span id="rotateL"><span class="annot"><span class="annottext">rotateL :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID -&gt; CList VertexID -&gt; Merge point (CList VertexID, Bool)
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateL"><span class="hs-identifier hs-var hs-var">rotateL</span></a></span></span><span> </span><span id="local-6989586621679472845"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472845"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679472846"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472846"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679472847"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472847"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472847"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; (VertexID, VertexID) -&gt; Merge point Bool
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID -&gt; (VertexID, VertexID) -&gt; Merge point Bool
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#isRightOf"><span class="hs-operator hs-var">`isRightOf`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472846"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472845"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Merge point Bool
-&gt; (Bool
    -&gt; StateT
         Adj (Reader (Mapping point, Firsts)) (CList VertexID, Bool))
-&gt; StateT
     Adj (Reader (Mapping point, Firsts)) (CList VertexID, Bool)
forall a b.
StateT Adj (Reader (Mapping point, Firsts)) a
-&gt; (a -&gt; StateT Adj (Reader (Mapping point, Firsts)) b)
-&gt; StateT Adj (Reader (Mapping point, Firsts)) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-236"></span><span>                   </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CList VertexID -&gt; (CList VertexID, Bool))
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
-&gt; StateT
     Adj (Reader (Mapping point, Firsts)) (CList VertexID, Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">VertexID
-&gt; VertexID
-&gt; CList VertexID
-&gt; CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID
-&gt; CList VertexID
-&gt; CList VertexID
-&gt; Merge point (CList VertexID)
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateL%27"><span class="hs-identifier hs-var">rotateL'</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472845"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472846"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472847"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; CList VertexID
forall a. CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#succ%27"><span class="hs-identifier hs-var">succ'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472847"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>                   </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CList VertexID, Bool)
-&gt; StateT
     Adj (Reader (Mapping point, Firsts)) (CList VertexID, Bool)
forall a. a -&gt; StateT Adj (Reader (Mapping point, Firsts)) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472847"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><span class="hs-comment">-- | The code that does the actual rotating. Symmetric to rotateR'</span></span><span>
</span><span id="line-240"></span><span id="local-6989586621679472850"><span id="local-6989586621679472851"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateL%27"><span class="hs-identifier hs-type">rotateL'</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472850"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472851"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472851"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679472851"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472850"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span></span></span><span>
</span><span id="line-242"></span><span id="rotateL%27"><span class="annot"><span class="annottext">rotateL' :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID
-&gt; CList VertexID
-&gt; CList VertexID
-&gt; Merge point (CList VertexID)
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateL%27"><span class="hs-identifier hs-var hs-var">rotateL'</span></a></span></span><span> </span><span id="local-6989586621679472931"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472931"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679472932"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472932"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList VertexID
-&gt; CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
</span><a href="#local-6989586621679472933"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>    </span><span id="local-6989586621679472933"><span class="annot"><span class="annottext">go :: CList VertexID
-&gt; CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
</span><a href="#local-6989586621679472933"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679472934"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472934"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679472935"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472935"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexID
-&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID -&gt; Merge point Bool
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID -&gt; Merge point Bool
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#qTest"><span class="hs-identifier hs-var">qTest</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472931"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472932"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472934"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472935"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Merge point Bool
-&gt; (Bool
    -&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID))
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
forall a b.
StateT Adj (Reader (Mapping point, Firsts)) a
-&gt; (a -&gt; StateT Adj (Reader (Mapping point, Firsts)) b)
-&gt; StateT Adj (Reader (Mapping point, Firsts)) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-245"></span><span>                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
forall a. a -&gt; StateT Adj (Reader (Mapping point, Firsts)) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472934"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-246"></span><span>                 </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">(Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ())
-&gt; (Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; VertexID -&gt; Adj -&gt; Adj
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679472931"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472934"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                             </span><span class="annot"><span class="annottext">CList VertexID
-&gt; CList VertexID
-&gt; StateT Adj (Reader (Mapping point, Firsts)) (CList VertexID)
</span><a href="#local-6989586621679472933"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472935"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CList VertexID -&gt; CList VertexID
forall a. CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#succ%27"><span class="hs-identifier hs-var">succ'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679472935"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-250"></span><span class="annot"><span class="hs-comment">-- * Primitives used by the Algorithm</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | returns True if the forth point (vertex) does not lie in the disk defined</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- by the first three points.</span><span>
</span><span id="line-254"></span><span id="local-6989586621679471128"><span id="local-6989586621679471129"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#qTest"><span class="hs-identifier hs-type">qTest</span></a></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471128"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471129"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471129"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679471129"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#DTVertex"><span class="hs-identifier hs-type">DTVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471128"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-256"></span><span id="qTest"><span class="annot"><span class="annottext">qTest :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID
-&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID -&gt; Merge point Bool
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#qTest"><span class="hs-identifier hs-var hs-var">qTest</span></a></span></span><span> </span><span id="local-6989586621679473069"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473069"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679473070"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473070"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679473071"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679473071"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679473072"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679473072"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((Map point VertexID, Vector point), Firsts) -&gt; Bool)
-&gt; StateT
     Adj (Reader ((Map point VertexID, Vector point), Firsts)) Bool
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point -&gt; Bool
</span><a href="#local-6989586621679473074"><span class="hs-identifier hs-var">withPtMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector point -&gt; Bool)
-&gt; (((Map point VertexID, Vector point), Firsts) -&gt; Vector point)
-&gt; ((Map point VertexID, Vector point), Firsts)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map point VertexID, Vector point) -&gt; Vector point
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Map point VertexID, Vector point) -&gt; Vector point)
-&gt; (((Map point VertexID, Vector point), Firsts)
    -&gt; (Map point VertexID, Vector point))
-&gt; ((Map point VertexID, Vector point), Firsts)
-&gt; Vector point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Map point VertexID, Vector point), Firsts)
-&gt; (Map point VertexID, Vector point)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679473074"><span class="annot"><span class="annottext">withPtMap :: Vector point -&gt; Bool
</span><a href="#local-6989586621679473074"><span class="hs-identifier hs-var hs-var">withPtMap</span></a></span></span><span> </span><span id="local-6989586621679473077"><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473077"><span class="hs-identifier hs-var">ptMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679473078"><span class="annot"><span class="annottext">h' :: point
</span><a href="#local-6989586621679473078"><span class="hs-identifier hs-var hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473077"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473069"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-259"></span><span>                          </span><span id="local-6989586621679473080"><span class="annot"><span class="annottext">i' :: point
</span><a href="#local-6989586621679473080"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473077"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473070"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-260"></span><span>                          </span><span id="local-6989586621679473081"><span class="annot"><span class="annottext">j' :: point
</span><a href="#local-6989586621679473081"><span class="hs-identifier hs-var hs-var">j'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473077"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679473071"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-261"></span><span>                          </span><span id="local-6989586621679473082"><span class="annot"><span class="annottext">k' :: point
</span><a href="#local-6989586621679473082"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473077"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID -&gt; VertexID
forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var">focus'</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679473072"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-262"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (Maybe (BallByPoints' (1 + Dimension point) point) -&gt; Bool)
-&gt; Maybe (BallByPoints' (1 + Dimension point) point)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (BallByPoints' (1 + Dimension point) point -&gt; Bool)
-&gt; Maybe (BallByPoints' (1 + Dimension point) point)
-&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473082"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; BallByPoints' (1 + Dimension point) point -&gt; Bool
forall {ball} {point}.
(Dimension ball ~ Dimension point, NumType ball ~ NumType point,
 HasInBall ball, Point_ point (Dimension point) (NumType point),
 Ord (NumType point), Num (NumType point)) =&gt;
point -&gt; ball -&gt; Bool
</span><a href="#local-6989586621679473085"><span class="hs-operator hs-var">`insideBall`</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (BallByPoints' (1 + Dimension point) point) -&gt; Bool)
-&gt; Maybe (BallByPoints' (1 + Dimension point) point) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">point
-&gt; point
-&gt; point
-&gt; Maybe (BallByPoints' (1 + Dimension point) point)
forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
point -&gt; point -&gt; point -&gt; Maybe (BallByPoints point)
</span><span class="hs-identifier hs-var">diskFromPoints</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473078"><span class="hs-identifier hs-var">h'</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473080"><span class="hs-identifier hs-var">i'</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473081"><span class="hs-identifier hs-var">j'</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621679473085"><span class="annot"><span class="annottext">insideBall :: point -&gt; ball -&gt; Bool
</span><a href="#local-6989586621679473085"><span class="hs-identifier hs-var hs-var">insideBall</span></a></span></span><span> </span><span id="local-6989586621679473168"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473168"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679473169"><span class="annot"><span class="annottext">ball
</span><a href="#local-6989586621679473169"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473168"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; ball -&gt; PointLocationResult
forall ball point (d :: Nat) r.
(HasInBall ball, Point_ point d r, Ord r, Num r, NumType ball ~ r,
 Dimension ball ~ d) =&gt;
point -&gt; ball -&gt; PointLocationResult
forall point (d :: Nat) r.
(Point_ point d r, Ord r, Num r, NumType ball ~ r,
 Dimension ball ~ d) =&gt;
point -&gt; ball -&gt; PointLocationResult
</span><span class="hs-operator hs-var">`inBall`</span></span><span> </span><span class="annot"><span class="annottext">ball
</span><a href="#local-6989586621679473169"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PointLocationResult -&gt; PointLocationResult -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PointLocationResult
</span><span class="hs-identifier hs-var">Inside</span></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- should be strictly inside the ball</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="annot"><span class="hs-comment">-- | Inserts an edge into the right position.</span></span><span>
</span><span id="line-268"></span><span id="local-6989586621679471118"><span id="local-6989586621679471119"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471118"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471119"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679471119"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471119"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471118"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-269"></span><span id="insert"><span class="annot"><span class="annottext">insert :: forall point r.
(Point_ point 2 r, Num r, Ord r) =&gt;
VertexID -&gt; VertexID -&gt; Merge point ()
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679473251"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473251"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679473252"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473252"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>               </span><span class="hs-special">(</span><span id="local-6989586621679473253"><span class="annot"><a href="#local-6989586621679473253"><span class="hs-identifier hs-var">mapping'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679473254"><span class="annot"><a href="#local-6989586621679473254"><span class="hs-identifier hs-var">fsts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT Adj (Reader (Mapping point, Firsts)) (Mapping point, Firsts)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-271"></span><span>               </span><span class="annot"><span class="hs-identifier hs-type">modify</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#insert%27"><span class="hs-identifier hs-type">insert'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679473251"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679473252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679473253"><span class="hs-identifier hs-type">mapping'</span></a></span><span>
</span><span id="line-272"></span><span>               </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateToFirst"><span class="hs-identifier hs-type">rotateToFirst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679473251"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679473254"><span class="hs-identifier hs-type">fsts</span></a></span><span>
</span><span id="line-273"></span><span>               </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateToFirst"><span class="hs-identifier hs-type">rotateToFirst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679473252"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679473254"><span class="hs-identifier hs-type">fsts</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="annot"><span class="hs-comment">-- | make sure that the first vtx in the adj list of v is its predecessor on the CH</span></span><span>
</span><span id="line-277"></span><span id="local-6989586621679471196"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateToFirst"><span class="hs-identifier hs-type">rotateToFirst</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Firsts"><span class="hs-identifier hs-type">Firsts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471196"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-278"></span><span id="rotateToFirst"><span class="annot"><span class="annottext">rotateToFirst :: forall point. VertexID -&gt; Firsts -&gt; Merge point ()
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateToFirst"><span class="hs-identifier hs-var hs-var">rotateToFirst</span></a></span></span><span> </span><span id="local-6989586621679473264"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473264"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679473265"><span class="annot"><span class="annottext">Firsts
</span><a href="#local-6989586621679473265"><span class="hs-identifier hs-var">fsts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ())
-&gt; (Adj -&gt; Adj) -&gt; StateT Adj (Reader (Mapping point, Firsts)) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(CList VertexID -&gt; CList VertexID) -&gt; VertexID -&gt; Adj -&gt; Adj
forall a. (a -&gt; a) -&gt; VertexID -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.adjust</span></span><span> </span><span class="annot"><span class="annottext">CList VertexID -&gt; CList VertexID
</span><a href="#local-6989586621679473267"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473264"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679473268"><span class="annot"><span class="annottext">mfst :: Maybe VertexID
</span><a href="#local-6989586621679473268"><span class="hs-identifier hs-var hs-var">mfst</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; Firsts -&gt; Maybe VertexID
forall a. VertexID -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IM.lookup</span></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473264"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Firsts
</span><a href="#local-6989586621679473265"><span class="hs-identifier hs-var">fsts</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679473267"><span class="annot"><span class="annottext">f :: CList VertexID -&gt; CList VertexID
</span><a href="#local-6989586621679473267"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span>  </span><span id="local-6989586621679473270"><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679473270"><span class="hs-identifier hs-var">cl</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList VertexID -&gt; Maybe (CList VertexID) -&gt; CList VertexID
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679473270"><span class="hs-identifier hs-var">cl</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (CList VertexID) -&gt; CList VertexID)
-&gt; Maybe (CList VertexID) -&gt; CList VertexID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe VertexID
</span><a href="#local-6989586621679473268"><span class="hs-identifier hs-var">mfst</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe VertexID
-&gt; (VertexID -&gt; Maybe (CList VertexID)) -&gt; Maybe (CList VertexID)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(VertexID -&gt; CList VertexID -&gt; Maybe (CList VertexID))
-&gt; CList VertexID -&gt; VertexID -&gt; Maybe (CList VertexID)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">VertexID -&gt; CList VertexID -&gt; Maybe (CList VertexID)
forall a. Eq a =&gt; a -&gt; CList a -&gt; Maybe (CList a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#rotateTo"><span class="hs-identifier hs-var">CL.rotateTo</span></a></span><span> </span><span class="annot"><span class="annottext">CList VertexID
</span><a href="#local-6989586621679473270"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- | Inserts an edge (and makes sure that the vertex is inserted in the</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- correct. pos in the adjacency lists)</span><span>
</span><span id="line-286"></span><span id="local-6989586621679471194"><span id="local-6989586621679471195"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#insert%27"><span class="hs-identifier hs-type">insert'</span></a></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471194"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471195"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679471195"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471195"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Mapping"><span class="hs-identifier hs-type">Mapping</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471194"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span></span></span><span>
</span><span id="line-288"></span><span id="insert%27"><span class="annot"><span class="annottext">insert' :: forall point r.
(Point_ point 2 r, Num r, Ord r) =&gt;
VertexID -&gt; VertexID -&gt; Mapping point -&gt; Adj -&gt; Adj
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#insert%27"><span class="hs-identifier hs-var hs-var">insert'</span></a></span></span><span> </span><span id="local-6989586621679473292"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473292"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679473293"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473293"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map point VertexID
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679473294"><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473294"><span class="hs-identifier hs-var">ptMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VertexID -&gt; CList VertexID -&gt; CList VertexID)
-&gt; VertexID -&gt; Adj -&gt; Adj
forall a. (VertexID -&gt; a -&gt; a) -&gt; VertexID -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.adjustWithKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID -&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID
</span><a href="#local-6989586621679473296"><span class="hs-identifier hs-var">insert''</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473293"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473292"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-289"></span><span>                      </span><span class="annot"><span class="annottext">(Adj -&gt; Adj) -&gt; (Adj -&gt; Adj) -&gt; Adj -&gt; Adj
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VertexID -&gt; CList VertexID -&gt; CList VertexID)
-&gt; VertexID -&gt; Adj -&gt; Adj
forall a. (VertexID -&gt; a -&gt; a) -&gt; VertexID -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.adjustWithKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID -&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID
</span><a href="#local-6989586621679473296"><span class="hs-identifier hs-var">insert''</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473292"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473293"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-comment">-- inserts b into the adjacency list of a</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621679473296"><span class="annot"><span class="annottext">insert'' :: VertexID -&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID
</span><a href="#local-6989586621679473296"><span class="hs-identifier hs-var hs-var">insert''</span></a></span></span><span> </span><span id="local-6989586621679473297"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473297"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span id="local-6989586621679473298"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473298"><span class="hs-identifier hs-var">ai</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VertexID -&gt; VertexID -&gt; Ordering)
-&gt; VertexID -&gt; CList VertexID -&gt; CList VertexID
forall a. (a -&gt; a -&gt; Ordering) -&gt; a -&gt; CList a -&gt; CList a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.CircularList.Util.html/HGeometry.CircularList.Util.html#insertOrdBy"><span class="hs-identifier hs-var">CU.insertOrdBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; point -&gt; point -&gt; Ordering
forall {point} {center}.
(Dimension point ~ 2, Dimension center ~ 2,
 NumType center ~ NumType point, Ord (NumType point),
 Num (NumType point), Point_ point 2 (NumType point),
 Point_ center 2 (NumType point)) =&gt;
center -&gt; point -&gt; point -&gt; Ordering
</span><a href="#local-6989586621679473300"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473294"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473298"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(point -&gt; point -&gt; Ordering)
-&gt; (VertexID -&gt; point) -&gt; VertexID -&gt; VertexID -&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473294"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473297"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679473300"><span class="annot"><span class="annottext">cmp :: center -&gt; point -&gt; point -&gt; Ordering
</span><a href="#local-6989586621679473300"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621679473545"><span class="annot"><span class="annottext">center
</span><a href="#local-6989586621679473545"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679473546"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473546"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679473547"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473547"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">center -&gt; point -&gt; point -&gt; Ordering
forall center r point.
(Point_ center 2 r, Point_ point 2 r, Ord r, Num r) =&gt;
center -&gt; point -&gt; point -&gt; Ordering
</span><span class="hs-identifier hs-var">cwCmpAround</span></span><span> </span><span class="annot"><span class="annottext">center
</span><a href="#local-6989586621679473545"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473546"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473547"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">center -&gt; point -&gt; point -&gt; Ordering
forall r point (d :: Nat) center.
(Ord r, Num r, Point_ point d r, Point_ center d r,
 Metric_ (Vector d r) d r) =&gt;
center -&gt; point -&gt; point -&gt; Ordering
</span><span class="hs-identifier hs-var">cmpByDistanceTo</span></span><span> </span><span class="annot"><span class="annottext">center
</span><a href="#local-6989586621679473545"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473546"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473547"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><span class="hs-comment">-- | Deletes an edge</span></span><span>
</span><span id="line-297"></span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delete"><span class="hs-identifier hs-type">delete</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#Adj"><span class="hs-identifier hs-type">Adj</span></a></span><span>
</span><span id="line-298"></span><span id="delete"><span class="annot"><span class="annottext">delete :: VertexID -&gt; VertexID -&gt; Adj -&gt; Adj
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#delete"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span id="local-6989586621679473550"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473550"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679473551"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473551"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CList VertexID -&gt; CList VertexID) -&gt; VertexID -&gt; Adj -&gt; Adj
forall a. (a -&gt; a) -&gt; VertexID -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID -&gt; CList VertexID -&gt; CList VertexID
forall a. Eq a =&gt; a -&gt; CList a -&gt; CList a
</span><a href="#local-6989586621679473552"><span class="hs-identifier hs-var">delete'</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473551"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473550"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">(Adj -&gt; Adj) -&gt; (Adj -&gt; Adj) -&gt; Adj -&gt; Adj
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(CList VertexID -&gt; CList VertexID) -&gt; VertexID -&gt; Adj -&gt; Adj
forall a. (a -&gt; a) -&gt; VertexID -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IM.adjust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexID -&gt; CList VertexID -&gt; CList VertexID
forall a. Eq a =&gt; a -&gt; CList a -&gt; CList a
</span><a href="#local-6989586621679473552"><span class="hs-identifier hs-var">delete'</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473550"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473551"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679473552"><span class="annot"><span class="annottext">delete' :: a -&gt; CList a -&gt; CList a
</span><a href="#local-6989586621679473552"><span class="hs-identifier hs-var hs-var">delete'</span></a></span></span><span> </span><span id="local-6989586621679473555"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679473555"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; CList a -&gt; CList a
forall a. (a -&gt; Bool) -&gt; CList a -&gt; CList a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#filterL"><span class="hs-identifier hs-var">CL.filterL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679473555"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- should we rotate left or right if it is the focus?</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><span class="hs-comment">-- | Lifted version of Convex.IsLeftOf</span></span><span>
</span><span id="line-304"></span><span id="local-6989586621679471139"><span id="local-6989586621679471140"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#isLeftOf"><span class="hs-identifier hs-type">isLeftOf</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679471139"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679471140"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679471140"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679471140"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471139"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-306"></span><span id="local-6989586621679473583"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473583"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="isLeftOf"><span class="annot"><span class="annottext">isLeftOf :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID -&gt; (VertexID, VertexID) -&gt; Merge point Bool
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#isLeftOf"><span class="hs-operator hs-var hs-var">`isLeftOf`</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679473584"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473584"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679473585"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473585"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((Map point VertexID, Vector point), Firsts) -&gt; Bool)
-&gt; StateT
     Adj (Reader ((Map point VertexID, Vector point), Firsts)) Bool
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point -&gt; Bool
</span><a href="#local-6989586621679473586"><span class="hs-identifier hs-var">withPtMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector point -&gt; Bool)
-&gt; (((Map point VertexID, Vector point), Firsts) -&gt; Vector point)
-&gt; ((Map point VertexID, Vector point), Firsts)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map point VertexID, Vector point) -&gt; Vector point
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Map point VertexID, Vector point) -&gt; Vector point)
-&gt; (((Map point VertexID, Vector point), Firsts)
    -&gt; (Map point VertexID, Vector point))
-&gt; ((Map point VertexID, Vector point), Firsts)
-&gt; Vector point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Map point VertexID, Vector point), Firsts)
-&gt; (Map point VertexID, Vector point)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679473586"><span class="annot"><span class="annottext">withPtMap :: Vector point -&gt; Bool
</span><a href="#local-6989586621679473586"><span class="hs-identifier hs-var hs-var">withPtMap</span></a></span></span><span> </span><span id="local-6989586621679473587"><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473587"><span class="hs-identifier hs-var">ptMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473587"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473583"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">point -&gt; (point, point) -&gt; Bool
forall {point''} {point'} {point}.
(Dimension point'' ~ 2, Dimension point' ~ 2, Dimension point ~ 2,
 NumType point' ~ NumType point, NumType point'' ~ NumType point,
 Point_ point 2 (NumType point), Point_ point' 2 (NumType point),
 Point_ point'' 2 (NumType point), Num (NumType point),
 Ord (NumType point)) =&gt;
point'' -&gt; (point, point') -&gt; Bool
</span><a href="#local-6989586621679473588"><span class="hs-operator hs-var">`isLeftOf'`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473587"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473584"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473587"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473585"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679473771"><span class="annot"><span class="annottext">point''
</span><a href="#local-6989586621679473771"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679473588"><span class="annot"><span class="annottext">isLeftOf' :: point'' -&gt; (point, point') -&gt; Bool
</span><a href="#local-6989586621679473588"><span class="hs-operator hs-var hs-var">`isLeftOf'`</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679473772"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473772"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679473773"><span class="annot"><span class="annottext">point'
</span><a href="#local-6989586621679473773"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point' -&gt; point'' -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473772"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">point'
</span><a href="#local-6989586621679473773"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">point''
</span><a href="#local-6989586621679473771"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><span class="hs-comment">-- | Lifted version of Convex.IsRightOf</span></span><span>
</span><span id="line-312"></span><span id="local-6989586621679473776"><span id="local-6989586621679473777"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#isRightOf"><span class="hs-identifier hs-type">isRightOf</span></a></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679473776"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679473777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679473777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679473777"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.Types.html#VertexID"><span class="hs-identifier hs-type">VertexID</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679473776"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-314"></span><span id="local-6989586621679473803"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473803"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="isRightOf"><span class="annot"><span class="annottext">isRightOf :: forall point r.
(Point_ point 2 r, Ord r, Num r) =&gt;
VertexID -&gt; (VertexID, VertexID) -&gt; Merge point Bool
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#isRightOf"><span class="hs-operator hs-var hs-var">`isRightOf`</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679473804"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473804"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679473805"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473805"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((Map point VertexID, Vector point), Firsts) -&gt; Bool)
-&gt; StateT
     Adj (Reader ((Map point VertexID, Vector point), Firsts)) Bool
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point -&gt; Bool
</span><a href="#local-6989586621679473806"><span class="hs-identifier hs-var">withPtMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector point -&gt; Bool)
-&gt; (((Map point VertexID, Vector point), Firsts) -&gt; Vector point)
-&gt; ((Map point VertexID, Vector point), Firsts)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map point VertexID, Vector point) -&gt; Vector point
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Map point VertexID, Vector point) -&gt; Vector point)
-&gt; (((Map point VertexID, Vector point), Firsts)
    -&gt; (Map point VertexID, Vector point))
-&gt; ((Map point VertexID, Vector point), Firsts)
-&gt; Vector point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Map point VertexID, Vector point), Firsts)
-&gt; (Map point VertexID, Vector point)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679473806"><span class="annot"><span class="annottext">withPtMap :: Vector point -&gt; Bool
</span><a href="#local-6989586621679473806"><span class="hs-identifier hs-var hs-var">withPtMap</span></a></span></span><span> </span><span id="local-6989586621679473807"><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473807"><span class="hs-identifier hs-var">ptMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473807"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473803"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">point -&gt; (point, point) -&gt; Bool
forall {point''} {point'} {point}.
(Dimension point'' ~ 2, Dimension point' ~ 2, Dimension point ~ 2,
 NumType point' ~ NumType point, NumType point'' ~ NumType point,
 Point_ point 2 (NumType point), Point_ point' 2 (NumType point),
 Point_ point'' 2 (NumType point), Num (NumType point),
 Ord (NumType point)) =&gt;
point'' -&gt; (point, point') -&gt; Bool
</span><a href="#local-6989586621679473808"><span class="hs-operator hs-var">`isRightOf'`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473807"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473804"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Vector point
</span><a href="#local-6989586621679473807"><span class="hs-identifier hs-var">ptMap</span></a></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; VertexID -&gt; point
forall a. Vector a -&gt; VertexID -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#%21"><span class="hs-operator hs-var">V.!</span></a></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679473805"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679473990"><span class="annot"><span class="annottext">point''
</span><a href="#local-6989586621679473990"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679473808"><span class="annot"><span class="annottext">isRightOf' :: point'' -&gt; (point, point') -&gt; Bool
</span><a href="#local-6989586621679473808"><span class="hs-operator hs-var hs-var">`isRightOf'`</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679473991"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473991"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679473992"><span class="annot"><span class="annottext">point'
</span><a href="#local-6989586621679473992"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point' -&gt; point'' -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473991"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">point'
</span><a href="#local-6989586621679473992"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">point''
</span><a href="#local-6989586621679473990"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">CCW -&gt; CCW -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-320"></span><span class="annot"><span class="hs-comment">-- * Some Helper functions</span></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621679470977"><span id="local-6989586621679470978"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-type">lookup'</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679470977"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679470977"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679470978"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679470977"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679470978"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-324"></span><span id="lookup%27"><span class="annot"><span class="annottext">lookup' :: forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27"><span class="hs-identifier hs-var hs-var">lookup'</span></a></span></span><span> </span><span id="local-6989586621679473998"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679473998"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679473999"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679473999"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; a
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; Maybe a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k a -&gt; Maybe a
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679473999"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679473998"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | an \'unsafe\' version of rotateTo that assumes the element to rotate to</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- occurs in the list.</span><span>
</span><span id="line-329"></span><span id="local-6989586621679471124"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateTo"><span class="hs-identifier hs-type">rotateTo</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679471124"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679471124"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#CList"><span class="hs-identifier hs-type">CL.CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471124"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#CList"><span class="hs-identifier hs-type">CL.CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471124"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-330"></span><span id="rotateTo"><span class="annot"><span class="annottext">rotateTo :: forall a. Eq a =&gt; a -&gt; CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#rotateTo"><span class="hs-identifier hs-var hs-var">rotateTo</span></a></span></span><span> </span><span id="local-6989586621679474005"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679474005"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CList a) -&gt; CList a
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (CList a) -&gt; CList a)
-&gt; (CList a -&gt; Maybe (CList a)) -&gt; CList a -&gt; CList a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; CList a -&gt; Maybe (CList a)
forall a. Eq a =&gt; a -&gt; CList a -&gt; Maybe (CList a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#rotateTo"><span class="hs-identifier hs-var">CL.rotateTo</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679474005"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><span class="hs-comment">-- | Adjacency lists are stored in clockwise order, so pred means rotate right</span></span><span>
</span><span id="line-333"></span><span id="local-6989586621679471123"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#pred%27"><span class="hs-identifier hs-type">pred'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#CList"><span class="hs-identifier hs-type">CL.CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471123"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#CList"><span class="hs-identifier hs-type">CL.CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471123"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-334"></span><span id="pred%27"><span class="annot"><span class="annottext">pred' :: forall a. CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#pred%27"><span class="hs-identifier hs-var hs-var">pred'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList a
forall a. CList a -&gt; CList a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#rotR"><span class="hs-identifier hs-var">CL.rotR</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><span class="hs-comment">-- | Adjacency lists are stored in clockwise order, so pred and succ rotate left</span></span><span>
</span><span id="line-337"></span><span id="local-6989586621679474007"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#succ%27"><span class="hs-identifier hs-type">succ'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#CList"><span class="hs-identifier hs-type">CL.CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679474007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#CList"><span class="hs-identifier hs-type">CL.CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679474007"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-338"></span><span id="succ%27"><span class="annot"><span class="annottext">succ' :: forall a. CList a -&gt; CList a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#succ%27"><span class="hs-identifier hs-var hs-var">succ'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CList a -&gt; CList a
forall a. CList a -&gt; CList a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#rotL"><span class="hs-identifier hs-var">CL.rotL</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><span class="hs-comment">-- | Return the focus of the CList, throwing an exception if the list is empty.</span></span><span>
</span><span id="line-341"></span><span id="local-6989586621679471130"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-type">focus'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#CList"><span class="hs-identifier hs-type">CL.CList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679471130"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679471130"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-342"></span><span id="focus%27"><span class="annot"><span class="annottext">focus' :: forall a. CList a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#focus%27"><span class="hs-identifier hs-var hs-var">focus'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; a
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; (CList a -&gt; Maybe a) -&gt; CList a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CList a -&gt; Maybe a
forall a. CList a -&gt; Maybe a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/data-clist-0.2-dbbedd5ffc7fec8c841c116fb453df628f634baca339958b0a283342567eb51c/share/doc/html/src/Data.CircularList.Internal.html/Data.CircularList.Internal.html#focus"><span class="hs-identifier hs-var">CL.focus</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span id="local-6989586621679471125"><span class="annot"><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27%27"><span class="hs-identifier hs-type">lookup''</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IM.IntMap</span></span><span> </span><span class="annot"><a href="#local-6989586621679471125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679471125"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-345"></span><span id="lookup%27%27"><span class="annot"><span class="annottext">lookup'' :: forall a. VertexID -&gt; IntMap a -&gt; a
</span><a href="HGeometry.DelaunayTriangulation.DivideAndConquer.html#lookup%27%27"><span class="hs-identifier hs-var hs-var">lookup''</span></a></span></span><span> </span><span id="local-6989586621679474012"><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679474012"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679474013"><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679474013"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap a
</span><a href="#local-6989586621679474013"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap a -&gt; VertexID -&gt; a
forall a. IntMap a -&gt; VertexID -&gt; a
</span><span class="hs-operator hs-var">IM.!</span></span><span> </span><span class="annot"><span class="annottext">VertexID
</span><a href="#local-6989586621679474012"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- _foo = do mapM print (asBalancedBinLeafTree myPoints)</span><span>
</span><span id="line-352"></span><span class="hs-comment">--          print $ delaunayTr myPoints</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">--          -- print &quot;dummy&quot;</span><span>
</span><span id="line-355"></span><span class="hs-comment">--          -- let f p = (uncheckedFromCCWPoints . NonEmpty.singleton $ p ) :: ConvexPolygon (Point 2 R)</span><span>
</span><span id="line-356"></span><span class="hs-comment">--          -- print $ Convex.merge (f $ Point2 1  3) (f $ Point2 4  26)</span><span>
</span><span id="line-357"></span><span class="hs-comment">--          -- print &quot;dummy&quot;</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-comment">--          -- print &quot;================================================================================&quot;</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">--          -- let g s = (uncheckedFromCCWPoints . NonEmpty.fromList $ s) :: ConvexPolygon (Point 2 R)</span><span>
</span><span id="line-362"></span><span class="hs-comment">--          -- print $ mergeX (g [Point2 4  26, Point2 1 3]) (g [Point2 6 7, Point2 5 17])</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">--          -- print &quot;============&quot;</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">--          -- print $ chByMerge myPoints</span><span>
</span><span id="line-368"></span><span class="hs-comment">--          -- print $ delaunayTr myPoints</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-comment">-- myPoints :: NonEmpty.NonEmpty (Point 2 R)</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- myPoints = NonEmpty.fromList $</span><span>
</span><span id="line-372"></span><span class="hs-comment">--             [ Point2 64  736</span><span>
</span><span id="line-373"></span><span class="hs-comment">--             , Point2 96 688</span><span>
</span><span id="line-374"></span><span class="hs-comment">--             , Point2 128 752</span><span>
</span><span id="line-375"></span><span class="hs-comment">--             , Point2 160 704</span><span>
</span><span id="line-376"></span><span class="hs-comment">--             , Point2 128 672</span><span>
</span><span id="line-377"></span><span class="hs-comment">--             , Point2 64 656</span><span>
</span><span id="line-378"></span><span class="hs-comment">--             , Point2 192 736</span><span>
</span><span id="line-379"></span><span class="hs-comment">--             -- , Point2 208 704</span><span>
</span><span id="line-380"></span><span class="hs-comment">--             -- , Point2 192 672</span><span>
</span><span id="line-381"></span><span class="hs-comment">--             ]</span><span>
</span><span id="line-382"></span></pre></body></html>