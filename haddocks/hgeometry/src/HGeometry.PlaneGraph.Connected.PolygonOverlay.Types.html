<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  HGeometry.PlaneGraph.Connected.PolygonOverlay.Types</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Helper types for polygon overlay</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html"><span class="hs-identifier">HGeometry.PlaneGraph.Connected.PolygonOverlay.Types</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#HasCoveringPolygons"><span class="hs-identifier">HasCoveringPolygons</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier">V</span></a></span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier">V</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#location"><span class="hs-identifier">location</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#definingVertices"><span class="hs-identifier">definingVertices</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#E"><span class="hs-identifier">E</span></a></span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#E"><span class="hs-identifier">E</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#definingEdges"><span class="hs-identifier">definingEdges</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#pointInEdge"><span class="hs-identifier">pointInEdge</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#F"><span class="hs-identifier">F</span></a></span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#F"><span class="hs-identifier">F</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#pointInFace"><span class="hs-identifier">pointInFace</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sequence.NonEmpty.html"><span class="hs-identifier">HGeometry.Sequence.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sequence.NonEmpty.html#ViewL1"><span class="hs-identifier">ViewL1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Properties</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.LineSegment</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html"><span class="hs-identifier">Hiraffe.Graph.Class</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="annot"><span class="hs-comment">-- | Vertices in the overlay</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">data</span><span> </span><span id="V"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-var">V</span></a></span></span><span> </span><span id="local-6989586621679518162"><span class="annot"><a href="#local-6989586621679518162"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="V"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-var">V</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_location"><span class="annot"><span class="annottext">forall polygon. V polygon -&gt; Point 2 (NumType polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#_location"><span class="hs-identifier hs-var hs-var">_location</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518162"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="_definingVertices"><span class="annot"><span class="annottext">forall polygon. V polygon -&gt; Seq (Vertex polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#_definingVertices"><span class="hs-identifier hs-var hs-var">_definingVertices</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518162"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="_coveringPolygonsV"><span class="annot"><span class="annottext">forall polygon. V polygon -&gt; Seq polygon
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#_coveringPolygonsV"><span class="hs-identifier hs-var hs-var">_coveringPolygonsV</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679518162"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-36"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><span class="hs-identifier hs-var">NumType</span></span></span><span>   </span><span id="local-6989586621679518312"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518312"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518312"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><span class="hs-identifier hs-var">Dimension</span></span></span><span> </span><span id="local-6989586621679518313"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518313"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span id="local-6989586621679518162"><span id="location"><span id="definingVertices"><span id="coveringPolygonsV"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">V</span></span></span></span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679518197"><span id="local-6989586621679518198"><span id="local-6989586621679518351"><span id="local-6989586621679518360"><span id="local-6989586621679518367"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518197"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679518198"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Affine_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518197"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679518198"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679518200"><span class="annot"><span class="hs-identifier hs-type">HasVector</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518200"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518200"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679518411"><span class="annot"><span class="annottext">vector :: forall (d :: Nat) r s.
(Dimension (V polygon) ~ d, NumType (V polygon) ~ r,
 Dimension (V polygon) ~ d, NumType (V polygon) ~ s) =&gt;
Lens (V polygon) (V polygon) (Vector d r) (Vector d s)
</span><a href="#local-6989586621679518411"><span class="hs-identifier hs-var hs-var hs-var">vector</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 s -&gt; f (Point 2 s)) -&gt; V polygon -&gt; f (V polygon)
(Point 2 (NumType polygon) -&gt; f (Point 2 (NumType polygon)))
-&gt; V polygon -&gt; f (V polygon)
forall polygon (f :: * -&gt; *).
Functor f =&gt;
(Point 2 (NumType polygon) -&gt; f (Point 2 (NumType polygon)))
-&gt; V polygon -&gt; f (V polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#location"><span class="hs-identifier hs-var">location</span></a></span><span class="annot"><span class="annottext">((Point 2 s -&gt; f (Point 2 s)) -&gt; V polygon -&gt; f (V polygon))
-&gt; ((Vector d r -&gt; f (Vector d s)) -&gt; Point 2 s -&gt; f (Point 2 s))
-&gt; (Vector d r -&gt; f (Vector d s))
-&gt; V polygon
-&gt; f (V polygon)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Vector d r -&gt; f (Vector d s)) -&gt; Point 2 s -&gt; f (Point 2 s)
forall (d :: Nat) r s.
(Dimension (Point 2 s) ~ d, NumType (Point 2 s) ~ r,
 Dimension (Point 2 s) ~ d, NumType (Point 2 s) ~ s) =&gt;
Lens (Point 2 s) (Point 2 s) (Vector d r) (Vector d s)
forall point point' (d :: Nat) r s.
(HasVector point point', Dimension point ~ d, NumType point ~ r,
 Dimension point' ~ d, NumType point' ~ s) =&gt;
Lens point point' (Vector d r) (Vector d s)
Lens (Point 2 s) (Point 2 s) (Vector d r) (Vector d s)
</span><span class="hs-identifier hs-var">vector</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679518199"><span id="local-6989586621679518429"><span class="annot"><span class="hs-identifier hs-type">HasCoordinates</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518199"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518199"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679518246"><span id="local-6989586621679518247"><span id="local-6989586621679518444"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518246"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679518247"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518246"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679518247"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518246"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679518247"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621679518256"><span id="local-6989586621679518456"><span id="local-6989586621679518468"><span id="local-6989586621679518472"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679518256"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518256"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518256"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518256"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | The data associated with edges in the overlay.</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- An edge in the overlay corresponds to some line segment uv.</span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span> </span><span id="E"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#E"><span class="hs-identifier hs-var">E</span></a></span></span><span> </span><span id="local-6989586621679518257"><span class="annot"><a href="#local-6989586621679518257"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="E"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#E"><span class="hs-identifier hs-var">E</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_definingEdges"><span class="annot"><span class="annottext">forall polygon.
E polygon -&gt; ViewL1 (ClosedLineSegment (Vertex polygon) :+ polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#_definingEdges"><span class="hs-identifier hs-var hs-var">_definingEdges</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sequence.NonEmpty.html#ViewL1"><span class="hs-identifier hs-type">ViewL1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518257"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518257"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>                   </span><span class="hs-comment">-- ^ The defining polygon edges; i.e. each such an edge (e :+ P) contains</span><span>
</span><span id="line-60"></span><span>                   </span><span class="hs-comment">-- the line segment uv representing this edge.  Furthermore, each such a</span><span>
</span><span id="line-61"></span><span>                   </span><span class="hs-comment">-- segment is tagged with the polygon P that defines it. I.e. e is a</span><span>
</span><span id="line-62"></span><span>                   </span><span class="hs-comment">-- counterclockwise edge in P.</span><span>
</span><span id="line-63"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="_coveringPolygonsE"><span class="annot"><span class="annottext">forall polygon. E polygon -&gt; Seq polygon
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#_coveringPolygonsE"><span class="hs-identifier hs-var hs-var">_coveringPolygonsE</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679518257"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-64"></span><span>                   </span><span class="annot"><span class="hs-comment">-- ^ The polygons from our set that completely cover this edge uv.</span></span><span>
</span><span id="line-65"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="_pointInEdge"><span class="annot"><span class="annottext">forall polygon. E polygon -&gt; Point 2 (NumType polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#_pointInEdge"><span class="hs-identifier hs-var hs-var">_pointInEdge</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518257"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>                   </span><span class="annot"><span class="hs-comment">-- ^ A point in the interior of the edge.</span></span><span>
</span><span id="line-67"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span id="local-6989586621679518257"><span id="definingEdges"><span id="pointInEdge"><span id="coveringPolygonsE"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">E</span></span></span></span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="local-6989586621679518276"><span id="local-6989586621679518529"><span id="local-6989586621679518540"><span id="local-6989586621679518544"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679518276"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518276"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518276"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#E"><span class="hs-identifier hs-type">E</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518276"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="annot"><span class="hs-comment">-- | The data associated with a face in the overlay.</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="F"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#F"><span class="hs-identifier hs-var">F</span></a></span></span><span> </span><span id="local-6989586621679518277"><span class="annot"><a href="#local-6989586621679518277"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="F"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#F"><span class="hs-identifier hs-var">F</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_coveringPolygonsF"><span class="annot"><span class="annottext">forall polygon. F polygon -&gt; Seq polygon
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#_coveringPolygonsF"><span class="hs-identifier hs-var hs-var">_coveringPolygonsF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679518277"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-78"></span><span>                   </span><span class="annot"><span class="hs-comment">-- ^  the polgyons covering this face.</span></span><span>
</span><span id="line-79"></span><span>                   </span><span class="hs-special">,</span><span> </span><span id="_pointInFace"><span class="annot"><span class="annottext">forall polygon. F polygon -&gt; Maybe (Point 2 (NumType polygon))
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#_pointInFace"><span class="hs-identifier hs-var hs-var">_pointInFace</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518277"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>                   </span><span class="hs-comment">-- ^ A point strictly inside the face. For internal</span><span>
</span><span id="line-81"></span><span>                   </span><span class="hs-comment">-- faces this value should be a Just point</span><span>
</span><span id="line-82"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span id="local-6989586621679518277"><span id="pointInFace"><span id="coveringPolygonsF"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">F</span></span></span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span id="local-6989586621679518287"><span id="local-6989586621679518591"><span id="local-6989586621679518598"><span id="local-6989586621679518602"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679518287"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679518287"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518287"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><span class="hs-comment">-- | Class for types that have some polygons covering the object.</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">class</span><span> </span><span id="HasCoveringPolygons"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#HasCoveringPolygons"><span class="hs-identifier hs-var">HasCoveringPolygons</span></a></span></span><span> </span><span id="local-6989586621679518291"><span class="annot"><a href="#local-6989586621679518291"><span class="hs-identifier hs-type">geom</span></a></span></span><span> </span><span id="local-6989586621679518292"><span class="annot"><a href="#local-6989586621679518292"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679518291"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679518292"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">-- | Get the polygons covering this geometry</span><span>
</span><span id="line-93"></span><span>  </span><span id="coveringPolygons"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#coveringPolygons"><span class="hs-identifier hs-type">coveringPolygons</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518291"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq.Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679518292"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679518293"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#HasCoveringPolygons"><span class="hs-identifier hs-type">HasCoveringPolygons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#V"><span class="hs-identifier hs-type">V</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518293"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679518293"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679518637"><span class="annot"><span class="annottext">coveringPolygons :: Lens' (V polygon) (Seq polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#coveringPolygons"><span class="hs-identifier hs-var hs-var hs-var">coveringPolygons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Seq polygon -&gt; f (Seq polygon)) -&gt; V polygon -&gt; f (V polygon)
forall polygon (f :: * -&gt; *).
Functor f =&gt;
(Seq polygon -&gt; f (Seq polygon)) -&gt; V polygon -&gt; f (V polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#coveringPolygonsV"><span class="hs-identifier hs-var">coveringPolygonsV</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679518296"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#HasCoveringPolygons"><span class="hs-identifier hs-type">HasCoveringPolygons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#E"><span class="hs-identifier hs-type">E</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518296"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679518296"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679518642"><span class="annot"><span class="annottext">coveringPolygons :: Lens' (E polygon) (Seq polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#coveringPolygons"><span class="hs-identifier hs-var hs-var hs-var">coveringPolygons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Seq polygon -&gt; f (Seq polygon)) -&gt; E polygon -&gt; f (E polygon)
forall polygon (f :: * -&gt; *).
Functor f =&gt;
(Seq polygon -&gt; f (Seq polygon)) -&gt; E polygon -&gt; f (E polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#coveringPolygonsE"><span class="hs-identifier hs-var">coveringPolygonsE</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679518299"><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#HasCoveringPolygons"><span class="hs-identifier hs-type">HasCoveringPolygons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679518299"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679518299"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679518647"><span class="annot"><span class="annottext">coveringPolygons :: Lens' (F polygon) (Seq polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#coveringPolygons"><span class="hs-identifier hs-var hs-var hs-var">coveringPolygons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Seq polygon -&gt; f (Seq polygon)) -&gt; F polygon -&gt; f (F polygon)
forall polygon (f :: * -&gt; *).
Functor f =&gt;
(Seq polygon -&gt; f (Seq polygon)) -&gt; F polygon -&gt; f (F polygon)
</span><a href="HGeometry.PlaneGraph.Connected.PolygonOverlay.Types.html#coveringPolygonsF"><span class="hs-identifier hs-var">coveringPolygonsF</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-105"></span></pre></body></html>