<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.Plane.LowerEnvelope.BruteForce</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- The O(n^4) time algorithm.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.Connected.BruteForce</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#bruteForceLowerEnvelope"><span class="hs-identifier">bruteForceLowerEnvelope</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#bruteForceLowerEnvelopeIn"><span class="hs-identifier">bruteForceLowerEnvelopeIn</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#connectedLowerEnvelopeWith"><span class="hs-identifier">connectedLowerEnvelopeWith</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#computeVertexForm"><span class="hs-identifier">computeVertexForm</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#belowAll"><span class="hs-identifier">belowAll</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F1</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html"><span class="hs-identifier">Data.Map.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.Internal.html/Data.Map.NonEmpty.Internal.html#NEMap"><span class="hs-identifier">NEMap</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html#IsEmpty"><span class="hs-identifier">IsEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html#IsNonEmpty"><span class="hs-identifier">IsNonEmpty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html"><span class="hs-identifier">Data.Map.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NEMap</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html"><span class="hs-identifier">HGeometry.Combinatorial.Util</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.HyperPlane.Class</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.HyperPlane.NonVertical</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Intersection</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Clipped.Type.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.Clipped.Type</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.MonoidalMap.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.Connected.MonoidalMap</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Region.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.Connected.Region</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Regions.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.Connected.Regions</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html"><span class="hs-identifier">HGeometry.Plane.LowerEnvelope.Connected.Type</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point.Either</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Convex</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Convex.Unbounded</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Simple</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Simple.PossiblyDegenerate</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Triangle</span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-52"></span><span class="annot"><span class="hs-comment">-- * Computing the (minimization diagram of) the Lower envelope</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Computes the lower envelope in O(n^4) time using a brute force approach</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- The naive O(n^4) time algorithm.</span><span>
</span><span id="line-57"></span><span id="local-6989586621679452072"><span id="local-6989586621679452073"><span id="local-6989586621679452075"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#bruteForceLowerEnvelope"><span class="hs-identifier hs-type">bruteForceLowerEnvelope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452072"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452073"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452072"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452073"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679452073"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-58"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679452075"><span class="hs-identifier hs-type">set</span></a></span><span>
</span><span id="line-59"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452073"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452072"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-60"></span><span>                           </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452075"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452072"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-62"></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#MinimizationDiagram"><span class="hs-identifier hs-type">MinimizationDiagram</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452073"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Region.html#MDVertex"><span class="hs-identifier hs-type">MDVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452073"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452072"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679452072"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-63"></span><span id="bruteForceLowerEnvelope"><span class="annot"><span class="annottext">bruteForceLowerEnvelope :: forall plane r (set :: * -&gt; *).
(Plane_ plane r, Ord plane, Ord r, Fractional r, Foldable set,
 Show r, Show plane) =&gt;
set plane -&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#bruteForceLowerEnvelope"><span class="hs-identifier hs-var hs-var">bruteForceLowerEnvelope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(set plane -&gt; VertexForm Map r plane)
-&gt; set plane
-&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane)
forall plane r (set :: * -&gt; *).
(Plane_ plane r, Ord r, Fractional r, Foldable set, Ord plane,
 Show plane, Show r) =&gt;
(set plane -&gt; VertexForm Map r plane)
-&gt; set plane
-&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#connectedLowerEnvelopeWith"><span class="hs-identifier hs-var">connectedLowerEnvelopeWith</span></a></span><span> </span><span class="annot"><span class="annottext">set plane -&gt; VertexForm Map r plane
forall plane r (set :: * -&gt; *).
(Plane_ plane r, Ord plane, Ord r, Fractional r, Foldable set,
 Show plane, Show r) =&gt;
set plane -&gt; VertexForm Map r plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#computeVertexForm"><span class="hs-identifier hs-var">computeVertexForm</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | Given an algorithm to compute the vertices of the lower envelope, computes</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- the actual lower envelope. Returns a Nothing if there are no vertices</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span id="local-6989586621679452083"><span id="local-6989586621679452084"><span id="local-6989586621679452085"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#connectedLowerEnvelopeWith"><span class="hs-identifier hs-type">connectedLowerEnvelopeWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452083"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452084"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452084"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679452084"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679452085"><span class="hs-identifier hs-type">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452083"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-69"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452083"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452084"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-70"></span><span>                              </span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>                           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679452085"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452083"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.VertexForm.html#VertexForm"><span class="hs-identifier hs-type">VertexForm</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679452084"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452083"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452085"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452083"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-73"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#MinimizationDiagram"><span class="hs-identifier hs-type">MinimizationDiagram</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452084"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.Region.html#MDVertex"><span class="hs-identifier hs-type">MDVertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452084"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452083"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679452083"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-74"></span><span id="connectedLowerEnvelopeWith"><span class="annot"><span class="annottext">connectedLowerEnvelopeWith :: forall plane r (set :: * -&gt; *).
(Plane_ plane r, Ord r, Fractional r, Foldable set, Ord plane,
 Show plane, Show r) =&gt;
(set plane -&gt; VertexForm Map r plane)
-&gt; set plane
-&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#connectedLowerEnvelopeWith"><span class="hs-identifier hs-var hs-var">connectedLowerEnvelopeWith</span></a></span></span><span> </span><span id="local-6989586621679452420"><span class="annot"><span class="annottext">set plane -&gt; VertexForm Map r plane
</span><a href="#local-6989586621679452420"><span class="hs-identifier hs-var">computeVertexForm'</span></a></span></span><span> </span><span id="local-6989586621679452421"><span class="annot"><span class="annottext">set plane
</span><a href="#local-6989586621679452421"><span class="hs-identifier hs-var">planes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">set plane -&gt; VertexForm Map r plane
</span><a href="#local-6989586621679452420"><span class="hs-identifier hs-var">computeVertexForm'</span></a></span><span> </span><span class="annot"><span class="annottext">set plane
</span><a href="#local-6989586621679452421"><span class="hs-identifier hs-var">planes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html#IsNonEmpty"><span class="hs-identifier hs-type">IsNonEmpty</span></a></span><span> </span><span id="local-6989586621679452422"><span class="annot"><span class="annottext">NEMap (Point 3 r) (Definers plane)
</span><a href="#local-6989586621679452422"><span class="hs-identifier hs-var">vertices</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MinimizationDiagram r (MDVertex r plane) plane
-&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MinimizationDiagram r (MDVertex r plane) plane
 -&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane))
-&gt; MinimizationDiagram r (MDVertex r plane) plane
-&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NEMap (Point 3 r) (Definers plane)
-&gt; MinimizationDiagram r (MDVertex r plane) plane
forall plane r.
(Plane_ plane r, Ord plane, Ord r, Fractional r, Show r,
 Show plane) =&gt;
NEMap (Point 3 r) (Definers plane)
-&gt; MinimizationDiagram r (MDVertex r plane) plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Regions.html#fromVertexForm"><span class="hs-identifier hs-var">fromVertexForm</span></a></span><span> </span><span class="annot"><span class="annottext">NEMap (Point 3 r) (Definers plane)
</span><a href="#local-6989586621679452422"><span class="hs-identifier hs-var">vertices</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="annottext">VertexForm Map r plane
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html#IsEmpty"><span class="hs-identifier hs-var">IsEmpty</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (MinimizationDiagram r (MDVertex r plane) plane)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-80"></span><span class="annot"><span class="hs-comment">-- * Computing the (minimization diagram of) the Lower envelope clipped to a triangle</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Use a navive O(n^4) time algorithm to compute the lower envelope inside a given</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- triangle.</span><span>
</span><span id="line-84"></span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#bruteForceLowerEnvelopeIn"><span class="hs-identifier hs-type">bruteForceLowerEnvelopeIn</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679452102"><span class="annot"><a href="#local-6989586621679452102"><span class="hs-identifier hs-type">plane</span></a></span></span><span> </span><span id="local-6989586621679452103"><span class="annot"><a href="#local-6989586621679452103"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679452104"><span class="annot"><a href="#local-6989586621679452104"><span class="hs-identifier hs-type">corner</span></a></span></span><span> </span><span id="local-6989586621679452106"><span class="annot"><a href="#local-6989586621679452106"><span class="hs-identifier hs-type">set</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-85"></span><span>                                 </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452102"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452103"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452102"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452103"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679452103"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-86"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452104"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452103"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-87"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679452106"><span class="hs-identifier hs-type">set</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452103"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452104"><span class="hs-identifier hs-type">corner</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452102"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-comment">-- TODO: remove these</span><span>
</span><span id="line-90"></span><span>                                 </span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>                              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679452104"><span class="hs-identifier hs-type">corner</span></a></span><span>
</span><span id="line-92"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452106"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452102"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-93"></span><span>                              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Clipped.Type.html#ClippedMinimizationDiagram"><span class="hs-identifier hs-type">ClippedMinimizationDiagram</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452102"><span class="hs-identifier hs-type">plane</span></a></span><span>
</span><span id="line-94"></span><span id="bruteForceLowerEnvelopeIn"><span class="annot"><span class="annottext">bruteForceLowerEnvelopeIn :: forall plane r corner (set :: * -&gt; *).
(Plane_ plane r, Ord plane, Ord r, Fractional r, Point_ corner 2 r,
 Foldable1 set, Show r, Show corner, Show plane) =&gt;
Triangle corner -&gt; set plane -&gt; ClippedMinimizationDiagram plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#bruteForceLowerEnvelopeIn"><span class="hs-identifier hs-var hs-var">bruteForceLowerEnvelopeIn</span></a></span></span><span> </span><span id="local-6989586621679452891"><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679452891"><span class="hs-identifier hs-var">tri</span></a></span></span><span> </span><span id="local-6989586621679452892"><span class="annot"><span class="annottext">set plane
</span><a href="#local-6989586621679452892"><span class="hs-identifier hs-var">planes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AReview
  (ClippedMinimizationDiagram' (NumType plane) plane)
  (NEMap plane (ClippedMDCell r plane))
-&gt; NEMap plane (ClippedMDCell r plane)
-&gt; ClippedMinimizationDiagram' (NumType plane) plane
forall b (m :: * -&gt; *) t. MonadReader b m =&gt; AReview t b -&gt; m t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Review.html/Control.Lens.Review.html#review"><span class="hs-identifier hs-var">review</span></a></span><span> </span><span class="annot"><span class="annottext">AReview
  (ClippedMinimizationDiagram' (NumType plane) plane)
  (NEMap plane (ClippedMDCell r plane))
forall plane r.
(NumType plane ~ r) =&gt;
Iso'
  (ClippedMinimizationDiagram plane)
  (NEMap plane (ClippedMDCell r plane))
Iso'
  (ClippedMinimizationDiagram' (NumType plane) plane)
  (NEMap plane (ClippedMDCell r plane))
</span><a href="HGeometry.Plane.LowerEnvelope.Clipped.Type.html#_ClippedMinimizationDiagramMap"><span class="hs-identifier hs-var">_ClippedMinimizationDiagramMap</span></a></span><span>
</span><span id="line-95"></span><span>                                     </span><span class="annot"><span class="annottext">(NEMap plane (ClippedMDCell r plane)
 -&gt; ClippedMinimizationDiagram' (NumType plane) plane)
-&gt; NEMap plane (ClippedMDCell r plane)
-&gt; ClippedMinimizationDiagram' (NumType plane) plane
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">set plane -&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane)
forall plane r (set :: * -&gt; *).
(Plane_ plane r, Ord plane, Ord r, Fractional r, Foldable set,
 Show r, Show plane) =&gt;
set plane -&gt; Maybe (MinimizationDiagram r (MDVertex r plane) plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#bruteForceLowerEnvelope"><span class="hs-identifier hs-var">bruteForceLowerEnvelope</span></a></span><span> </span><span class="annot"><span class="annottext">set plane
</span><a href="#local-6989586621679452892"><span class="hs-identifier hs-var">planes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">Maybe (MinimizationDiagram r (MDVertex r plane) plane)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NEMap plane (ClippedMDCell r plane)
</span><a href="#local-6989586621679452895"><span class="hs-identifier hs-var">lowestPlane</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679452896"><span class="annot"><span class="annottext">MinimizationDiagram r (MDVertex r plane) plane
</span><a href="#local-6989586621679452896"><span class="hs-identifier hs-var">diagram</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Region r (MDVertex r plane) -&gt; Maybe (ClippedMDCell r plane))
-&gt; NEMap plane (Region r (MDVertex r plane))
-&gt; Map plane (ClippedMDCell r plane)
forall a b k. (a -&gt; Maybe b) -&gt; NEMap k a -&gt; Map k b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html#mapMaybe"><span class="hs-identifier hs-var">NEMap.mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679452891"><span class="hs-identifier hs-var">tri</span></a></span><span> </span><span class="annot"><span class="annottext">Triangle corner
-&gt; Region r (MDVertex r plane)
-&gt; Intersection (Triangle corner) (Region r (MDVertex r plane))
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MinimizationDiagram r (MDVertex r plane) plane
-&gt; NEMap plane (Region r (MDVertex r plane))
forall r vertex plane.
MinimizationDiagram r vertex plane -&gt; NEMap plane (Region r vertex)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Type.html#asMap"><span class="hs-identifier hs-var">asMap</span></a></span><span> </span><span class="annot"><span class="annottext">MinimizationDiagram r (MDVertex r plane) plane
</span><a href="#local-6989586621679452896"><span class="hs-identifier hs-var">diagram</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-98"></span><span>                      </span><span class="annot"><span class="annottext">Map plane (ClippedMDCell r plane)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html#IsEmpty"><span class="hs-identifier hs-var">IsEmpty</span></a></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NEMap plane (ClippedMDCell r plane)
</span><a href="#local-6989586621679452895"><span class="hs-identifier hs-var">lowestPlane</span></a></span><span>
</span><span id="line-99"></span><span>                      </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.html/Data.Map.NonEmpty.html#IsNonEmpty"><span class="hs-identifier hs-type">IsNonEmpty</span></a></span><span> </span><span id="local-6989586621679452900"><span class="annot"><span class="annottext">NEMap plane (ClippedMDCell r plane)
</span><a href="#local-6989586621679452900"><span class="hs-identifier hs-var">clippedDiagram</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NEMap plane (ClippedMDCell r plane)
</span><a href="#local-6989586621679452900"><span class="hs-identifier hs-var">clippedDiagram</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679452895"><span class="annot"><span class="annottext">lowestPlane :: NEMap plane (ClippedMDCell r plane)
</span><a href="#local-6989586621679452895"><span class="hs-identifier hs-var hs-var">lowestPlane</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679452901"><span class="annot"><span class="annottext">h :: plane
</span><a href="#local-6989586621679452901"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(plane -&gt; plane -&gt; Ordering) -&gt; set plane -&gt; plane
forall (t :: * -&gt; *) a.
Foldable1 t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">F1.minimumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(plane -&gt; r) -&gt; plane -&gt; plane -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">((plane -&gt; r) -&gt; plane -&gt; plane -&gt; Ordering)
-&gt; (plane -&gt; r) -&gt; plane -&gt; plane -&gt; Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; plane -&gt; r
forall point.
(Num r, 1 &lt;= 3, Point_ point (3 - 1) r) =&gt;
point -&gt; plane -&gt; r
forall hyperPlane (d :: Natural) r point.
(NonVerticalHyperPlane_ hyperPlane d r, Num r, 1 &lt;= d,
 Point_ point (d - 1) r) =&gt;
point -&gt; hyperPlane -&gt; r
</span><span class="hs-identifier hs-var">evalAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triangle (Point 2 r)
</span><a href="#local-6989586621679452904"><span class="hs-identifier hs-var">tri'</span></a></span><span class="annot"><span class="annottext">Triangle (Point 2 r)
-&gt; Getting (Point 2 r) (Triangle (Point 2 r)) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) (Triangle (Point 2 r)) (Point 2 r)
Lens' (Triangle (Point 2 r)) (Point 2 r)
forall (t :: * -&gt; *) a. Traversable1 t =&gt; Lens' (t a) a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#head1"><span class="hs-identifier hs-var">head1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">set plane
</span><a href="#local-6989586621679452892"><span class="hs-identifier hs-var">planes</span></a></span><span>
</span><span id="line-102"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">plane
-&gt; ClippedMDCell r plane -&gt; NEMap plane (ClippedMDCell r plane)
forall k a. k -&gt; a -&gt; NEMap k a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/nonempty-containers-0.3.5.0-fd0d5b6c1926d902399214660f830e56c6f93128c3fb0eab509cd444b1e6b8a0/share/doc/html/src/Data.Map.NonEmpty.Internal.html/Data.Map.NonEmpty.Internal.html#singleton"><span class="hs-identifier hs-var">NEMap.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679452901"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PossiblyDegenerateSimplePolygon
  (OriginalOrExtra (MDVertex r plane) (Point 2 r))
  (ConvexPolygonF
     NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
-&gt; ClippedMDCell r plane
forall r vertex.
PossiblyDegenerateSimplePolygon
  (OriginalOrExtra vertex (Point 2 r))
  (ClippedBoundedRegion r vertex (Point 2 r))
-&gt; ClippedMDCell' r vertex
</span><a href="HGeometry.Plane.LowerEnvelope.Clipped.Type.html#ClippedMDCell"><span class="hs-identifier hs-var">ClippedMDCell</span></a></span><span> </span><span class="annot"><span class="annottext">(PossiblyDegenerateSimplePolygon
   (OriginalOrExtra (MDVertex r plane) (Point 2 r))
   (ConvexPolygonF
      NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
 -&gt; ClippedMDCell r plane)
-&gt; (ConvexPolygonF
      NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
    -&gt; PossiblyDegenerateSimplePolygon
         (OriginalOrExtra (MDVertex r plane) (Point 2 r))
         (ConvexPolygonF
            NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))))
-&gt; ConvexPolygonF
     NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
-&gt; ClippedMDCell r plane
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConvexPolygonF
  NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
-&gt; PossiblyDegenerateSimplePolygon
     (OriginalOrExtra (MDVertex r plane) (Point 2 r))
     (ConvexPolygonF
        NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
forall vertex polygon.
polygon -&gt; PossiblyDegenerateSimplePolygon vertex polygon
</span><span class="hs-identifier hs-var">ActualPolygon</span></span><span> </span><span class="annot"><span class="annottext">(ConvexPolygonF
   NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
 -&gt; ClippedMDCell r plane)
-&gt; ConvexPolygonF
     NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
-&gt; ClippedMDCell r plane
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConvexPolygonF
  NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
</span><a href="#local-6989586621679452911"><span class="hs-identifier hs-var">polyTri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679452904"><span class="annot"><span class="annottext">tri' :: Triangle (Point 2 r)
</span><a href="#local-6989586621679452904"><span class="hs-identifier hs-var hs-var">tri'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">corner -&gt; Getting (Point 2 r) corner (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) corner (Point 2 r)
forall point (d :: Natural) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' corner (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(corner -&gt; Point 2 r) -&gt; Triangle corner -&gt; Triangle (Point 2 r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679452891"><span class="hs-identifier hs-var">tri</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679452911"><span class="annot"><span class="annottext">polyTri :: ConvexPolygonF
  NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
</span><a href="#local-6989586621679452911"><span class="hs-identifier hs-var hs-var">polyTri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConvexPolygonF
  NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
-&gt; Maybe
     (ConvexPolygonF
        NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
-&gt; ConvexPolygonF
     NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
-&gt; ConvexPolygonF
     NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;absurd: bruteForceLowerEnvelopeIn illegal triangle&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>            </span><span class="annot"><span class="annottext">(Maybe
   (ConvexPolygonF
      NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
 -&gt; ConvexPolygonF
      NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
-&gt; Maybe
     (ConvexPolygonF
        NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
-&gt; ConvexPolygonF
     NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Triangle (OriginalOrExtra (MDVertex r plane) (Point 2 r))
-&gt; Maybe
     (ConvexPolygonF
        NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable f,
 ConstructableSimplePolygon simplePolygon point r) =&gt;
f point -&gt; Maybe simplePolygon
forall (f :: * -&gt; *).
(Foldable f,
 ConstructableSimplePolygon
   (ConvexPolygonF
      NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
   (OriginalOrExtra (MDVertex r plane) (Point 2 r))
   r) =&gt;
f (OriginalOrExtra (MDVertex r plane) (Point 2 r))
-&gt; Maybe
     (ConvexPolygonF
        NonEmpty (OriginalOrExtra (MDVertex r plane) (Point 2 r)))
</span><span class="hs-identifier hs-var">fromPoints</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; OriginalOrExtra (MDVertex r plane) (Point 2 r)
forall orig extra. extra -&gt; OriginalOrExtra orig extra
</span><span class="hs-identifier hs-var">Extra</span></span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; OriginalOrExtra (MDVertex r plane) (Point 2 r))
-&gt; Triangle (Point 2 r)
-&gt; Triangle (OriginalOrExtra (MDVertex r plane) (Point 2 r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Triangle (Point 2 r)
</span><a href="#local-6989586621679452904"><span class="hs-identifier hs-var">tri'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">-- * Computing the vertices of the lower envelope</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Computes the vertices of the lower envelope</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- O(n^4) time.</span><span>
</span><span id="line-116"></span><span id="local-6989586621679452086"><span id="local-6989586621679452087"><span id="local-6989586621679452088"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#computeVertexForm"><span class="hs-identifier hs-type">computeVertexForm</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452086"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452086"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679452087"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679452088"><span class="hs-identifier hs-type">set</span></a></span><span>
</span><span id="line-117"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452086"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679452087"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-118"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>                         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452088"><span class="hs-identifier hs-type">set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452086"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.VertexForm.html#VertexForm"><span class="hs-identifier hs-type">VertexForm</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679452087"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452086"><span class="hs-identifier hs-type">plane</span></a></span></span></span></span><span>
</span><span id="line-120"></span><span id="computeVertexForm"><span class="annot"><span class="annottext">computeVertexForm :: forall plane r (set :: * -&gt; *).
(Plane_ plane r, Ord plane, Ord r, Fractional r, Foldable set,
 Show plane, Show r) =&gt;
set plane -&gt; VertexForm Map r plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#computeVertexForm"><span class="hs-identifier hs-var hs-var">computeVertexForm</span></a></span></span><span> </span><span id="local-6989586621679452943"><span class="annot"><span class="annottext">set plane
</span><a href="#local-6989586621679452943"><span class="hs-identifier hs-var">planes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 3 r -&gt; Definers plane -&gt; Definers plane -&gt; Definers plane)
-&gt; [Map (Point 3 r) (Definers plane)]
-&gt; Map (Point 3 r) (Definers plane)
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(k -&gt; a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.MonoidalMap.html#unionsWithKey"><span class="hs-identifier hs-var">unionsWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">Point 3 r -&gt; Definers plane -&gt; Definers plane -&gt; Definers plane
forall plane r.
(Plane_ plane r, Eq plane, Ord r, Fractional r, Show plane,
 Show r) =&gt;
Point 3 r -&gt; Definers plane -&gt; Definers plane -&gt; Definers plane
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.Regions.html#mergeDefiners"><span class="hs-identifier hs-var">mergeDefiners</span></a></span><span>
</span><span id="line-121"></span><span>                         </span><span class="annot"><span class="annottext">([Map (Point 3 r) (Definers plane)]
 -&gt; Map (Point 3 r) (Definers plane))
-&gt; ([Three plane] -&gt; [Map (Point 3 r) (Definers plane)])
-&gt; [Three plane]
-&gt; Map (Point 3 r) (Definers plane)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Three plane -&gt; Map (Point 3 r) (Definers plane))
-&gt; [Three plane] -&gt; [Map (Point 3 r) (Definers plane)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">set plane -&gt; Three plane -&gt; Map (Point 3 r) (Definers plane)
forall plane r (f :: * -&gt; *).
(Plane_ plane r, Foldable f, Ord plane, Ord r, Fractional r) =&gt;
f plane -&gt; Three plane -&gt; Map (Point 3 r) (Definers plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#asVertex"><span class="hs-identifier hs-var">asVertex</span></a></span><span> </span><span class="annot"><span class="annottext">set plane
</span><a href="#local-6989586621679452943"><span class="hs-identifier hs-var">planes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Three plane] -&gt; Map (Point 3 r) (Definers plane))
-&gt; [Three plane] -&gt; Map (Point 3 r) (Definers plane)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">set plane -&gt; [Three plane]
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; [Three a]
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html#uniqueTriplets"><span class="hs-identifier hs-var">uniqueTriplets</span></a></span><span> </span><span class="annot"><span class="annottext">set plane
</span><a href="#local-6989586621679452943"><span class="hs-identifier hs-var">planes</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679452352"><span id="local-6989586621679452353"><span id="local-6989586621679452354"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#asVertex"><span class="hs-identifier hs-type">asVertex</span></a></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452352"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452353"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679452354"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452352"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452353"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679452353"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452354"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452352"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html#Three"><span class="hs-identifier hs-type">Three</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452352"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="#local-6989586621679452353"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.VertexForm.html#Definers"><span class="hs-identifier hs-type">Definers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452352"><span class="hs-identifier hs-type">plane</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-125"></span><span id="asVertex"><span class="annot"><span class="annottext">asVertex :: forall plane r (f :: * -&gt; *).
(Plane_ plane r, Foldable f, Ord plane, Ord r, Fractional r) =&gt;
f plane -&gt; Three plane -&gt; Map (Point 3 r) (Definers plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#asVertex"><span class="hs-identifier hs-var hs-var">asVertex</span></a></span></span><span> </span><span id="local-6989586621679452961"><span class="annot"><span class="annottext">f plane
</span><a href="#local-6989586621679452961"><span class="hs-identifier hs-var">planes</span></a></span></span><span> </span><span id="local-6989586621679452962"><span class="annot"><span class="annottext">Three plane
</span><a href="#local-6989586621679452962"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Three plane -&gt; Maybe (Point 3 r, Definers plane)
forall plane r.
(Plane_ plane r, Ord r, Fractional r) =&gt;
Three plane -&gt; Maybe (Point 3 r, Definers plane)
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.VertexForm.html#definers"><span class="hs-identifier hs-var">definers</span></a></span><span> </span><span class="annot"><span class="annottext">Three plane
</span><a href="#local-6989586621679452962"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679452964"><span class="annot"><span class="annottext">Point 3 r
</span><a href="#local-6989586621679452964"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679452965"><span class="annot"><span class="annottext">Definers plane
</span><a href="#local-6989586621679452965"><span class="hs-identifier hs-var">defs'</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point 3 r
</span><a href="#local-6989586621679452964"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Point 3 r -&gt; f plane -&gt; Bool
forall plane r (f :: * -&gt; *).
(Plane_ plane r, Ord r, Num r, Foldable f) =&gt;
Point 3 r -&gt; f plane -&gt; Bool
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#belowAll"><span class="hs-operator hs-var">`belowAll`</span></a></span><span> </span><span class="annot"><span class="annottext">f plane
</span><a href="#local-6989586621679452961"><span class="hs-identifier hs-var">planes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 3 r -&gt; Definers plane -&gt; Map (Point 3 r) (Definers plane)
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">Point 3 r
</span><a href="#local-6989586621679452964"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Definers plane
</span><a href="#local-6989586621679452965"><span class="hs-identifier hs-var">defs'</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Point 3 r, Definers plane)
</span><span class="hs-identifier">_</span></span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map (Point 3 r) (Definers plane)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><span class="hs-comment">-- | test if v lies below (or on) all the given planes</span></span><span>
</span><span id="line-130"></span><span id="local-6989586621679452362"><span id="local-6989586621679452363"><span id="local-6989586621679452364"><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#belowAll"><span class="hs-identifier hs-type">belowAll</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Plane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452362"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452363"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452363"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679452363"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679452364"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="#local-6989586621679452363"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452364"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452362"><span class="hs-identifier hs-type">plane</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-131"></span><span id="belowAll"><span class="annot"><span class="annottext">belowAll :: forall plane r (f :: * -&gt; *).
(Plane_ plane r, Ord r, Num r, Foldable f) =&gt;
Point 3 r -&gt; f plane -&gt; Bool
</span><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#belowAll"><span class="hs-identifier hs-var hs-var">belowAll</span></a></span></span><span> </span><span id="local-6989586621679453057"><span class="annot"><span class="annottext">Point 3 r
</span><a href="#local-6989586621679453057"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(plane -&gt; Bool) -&gt; f plane -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679453059"><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679453059"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 3 r -&gt; plane -&gt; Ordering
forall point.
(1 &lt;= 3, Point_ point 3 r, Ord r, Num r) =&gt;
point -&gt; plane -&gt; Ordering
forall hyperPlane (d :: Natural) r point.
(NonVerticalHyperPlane_ hyperPlane d r, 1 &lt;= d, Point_ point d r,
 Ord r, Num r) =&gt;
point -&gt; hyperPlane -&gt; Ordering
</span><span class="hs-identifier hs-var">verticalSideTest</span></span><span> </span><span class="annot"><span class="annottext">Point 3 r
</span><a href="#local-6989586621679453057"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">plane
</span><a href="#local-6989586621679453059"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="HGeometry.Plane.LowerEnvelope.Connected.BruteForce.html#belowAll"><span class="hs-pragma hs-type">belowAll</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-136"></span></pre></body></html>