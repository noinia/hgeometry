<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Triangulation</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.html"><span class="hs-identifier">HGeometry.Polygon.Triangulation</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.html#triangulate"><span class="hs-identifier">triangulate</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.html#computeDiagonals"><span class="hs-identifier">computeDiagonals</span></a></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonEdgeType"><span class="hs-identifier">PolygonEdgeType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonFaceData"><span class="hs-identifier">PolygonFaceData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier">Diagonal</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.PlaneGraph.html"><span class="hs-identifier">HGeometry.PlaneGraph</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Simple</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html"><span class="hs-identifier">HGeometry.Polygon.Triangulation.MakeMonotone</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MM</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.TriangulateMonotone.html"><span class="hs-identifier">HGeometry.Polygon.Triangulation.TriangulateMonotone</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TM</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html"><span class="hs-identifier">HGeometry.Polygon.Triangulation.Types</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.PlanarGraph.html/Hiraffe.PlanarGraph.html"><span class="hs-identifier">Hiraffe.PlanarGraph</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | Triangulates a polygon of \(n\) vertices</span><span>
</span><span id="line-32"></span><span class="hs-comment">--</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- running time: \(O(n \log n)\)</span><span>
</span><span id="line-34"></span><span class="annot"><a href="HGeometry.Polygon.Triangulation.html#triangulate"><span class="hs-identifier hs-type">triangulate</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679493177"><span class="annot"><a href="#local-6989586621679493177"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679493173"><span class="annot"><a href="#local-6989586621679493173"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span id="local-6989586621679493174"><span class="annot"><a href="#local-6989586621679493174"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span id="local-6989586621679493175"><span class="annot"><a href="#local-6989586621679493175"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-35"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SimplePolygon_</span></span><span> </span><span class="annot"><a href="#local-6989586621679493173"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493174"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493175"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679493175"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679493175"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679493173"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-37"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.Type.html#CPlaneGraph"><span class="hs-identifier hs-type">CPlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493177"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493174"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonEdgeType"><span class="hs-identifier hs-type">PolygonEdgeType</span></a></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonFaceData"><span class="hs-identifier hs-type">PolygonFaceData</span></a></span><span>
</span><span id="line-38"></span><span id="triangulate"><span class="annot"><span class="annottext">triangulate :: forall {k} (s :: k) polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; CPlaneGraph s point PolygonEdgeType PolygonFaceData
</span><a href="HGeometry.Polygon.Triangulation.html#triangulate"><span class="hs-identifier hs-var hs-var">triangulate</span></a></span></span><span> </span><span id="local-6989586621679493855"><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679493855"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">polygon
-&gt; [Diagonal polygon]
-&gt; CPlaneGraph s point PolygonEdgeType PolygonFaceData
forall {k} (s :: k) polygon point r (f :: * -&gt; *).
(SimplePolygon_ polygon point r, Point_ point 2 r, Foldable f,
 Ord r, Num r) =&gt;
polygon
-&gt; f (Diagonal polygon)
-&gt; CPlaneGraph s point PolygonEdgeType PolygonFaceData
</span><a href="HGeometry.Polygon.Triangulation.Types.html#constructGraph"><span class="hs-identifier hs-var">constructGraph</span></a></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679493855"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon -&gt; [Diagonal polygon]
forall polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; [Diagonal polygon]
</span><a href="HGeometry.Polygon.Triangulation.html#computeDiagonals"><span class="hs-identifier hs-var">computeDiagonals</span></a></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679493855"><span class="hs-identifier hs-var">pg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Computes a set of diagaonals that together triangulate the input polygon</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- of \(n\) vertices.</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- running time: \(O(n \log n)\)</span><span>
</span><span id="line-44"></span><span class="annot"><a href="HGeometry.Polygon.Triangulation.html#computeDiagonals"><span class="hs-identifier hs-type">computeDiagonals</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679493263"><span class="annot"><a href="#local-6989586621679493263"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span id="local-6989586621679493264"><span class="annot"><a href="#local-6989586621679493264"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span id="local-6989586621679493265"><span class="annot"><a href="#local-6989586621679493265"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-45"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SimplePolygon_</span></span><span> </span><span class="annot"><a href="#local-6989586621679493263"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493264"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493265"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679493265"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679493265"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679493263"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier hs-type">Diagonal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493263"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span id="computeDiagonals"><span class="annot"><span class="annottext">computeDiagonals :: forall polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; [Diagonal polygon]
</span><a href="HGeometry.Polygon.Triangulation.html#computeDiagonals"><span class="hs-identifier hs-var hs-var">computeDiagonals</span></a></span></span><span> </span><span id="local-6989586621679494448"><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679494448"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vector 2 Int]
[Diagonal polygon]
</span><a href="#local-6989586621679494449"><span class="hs-identifier hs-var">monotoneDiags</span></a></span><span> </span><span class="annot"><span class="annottext">[Vector 2 Int] -&gt; [Vector 2 Int] -&gt; [Vector 2 Int]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Vector 2 Int]
[Diagonal polygon]
</span><a href="#local-6989586621679494450"><span class="hs-identifier hs-var">extraDiags</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="#local-6989586621679494451"><span class="hs-identifier hs-type">monotoneSubdiv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.Type.html#CPlaneGraph"><span class="hs-identifier hs-type">CPlaneGraph</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679493264"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonEdgeType"><span class="hs-identifier hs-type">PolygonEdgeType</span></a></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonFaceData"><span class="hs-identifier hs-type">PolygonFaceData</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679494451"><span class="annot"><span class="annottext">monotoneSubdiv :: CPlaneGraph () point PolygonEdgeType PolygonFaceData
</span><a href="#local-6989586621679494451"><span class="hs-identifier hs-var hs-var">monotoneSubdiv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (s :: k) polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; CPlaneGraph s point PolygonEdgeType PolygonFaceData
forall s polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; CPlaneGraph s point PolygonEdgeType PolygonFaceData
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#makeMonotone"><span class="hs-identifier hs-var">MM.makeMonotone</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679494448"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-comment">-- use some arbitrary proxy type</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-comment">-- get the existing diagonals</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="#local-6989586621679494449"><span class="hs-identifier hs-type">monotoneDiags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier hs-type">Diagonal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493263"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621679494449"><span class="annot"><span class="annottext">monotoneDiags :: [Diagonal polygon]
</span><a href="#local-6989586621679494449"><span class="hs-identifier hs-var hs-var">monotoneDiags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DartId (), PolygonEdgeType) -&gt; Vector 2 Int)
-&gt; [(DartId (), PolygonEdgeType)] -&gt; [Vector 2 Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679494453"><span class="annot"><span class="annottext">DartId ()
</span><a href="#local-6989586621679494453"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PolygonEdgeType
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494454"><span class="annot"><span class="annottext">VertexId ()
</span><a href="#local-6989586621679494454"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679494455"><span class="annot"><span class="annottext">VertexId ()
</span><a href="#local-6989586621679494455"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CPlaneGraph () point PolygonEdgeType PolygonFaceData
</span><a href="#local-6989586621679494451"><span class="hs-identifier hs-var">monotoneSubdiv</span></a></span><span> </span><span class="annot"><span class="annottext">CPlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Getting
     (VertexId (), VertexId ())
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (VertexId (), VertexId ())
-&gt; (VertexId (), VertexId ())
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">DartIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
-&gt; IndexedGetter
     (VertexIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData),
      VertexIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (Vertex (CPlaneGraph () point PolygonEdgeType PolygonFaceData),
      Vertex (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
forall graph.
DiGraph_ graph =&gt;
DartIx graph
-&gt; IndexedGetter
     (VertexIx graph, VertexIx graph) graph (Vertex graph, Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#endPointsOf"><span class="hs-identifier hs-var">endPointsOf</span></a></span><span> </span><span class="annot"><span class="annottext">DartIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
DartId ()
</span><a href="#local-6989586621679494453"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">(Indexed
   (VertexId (), VertexId ())
   (point, point)
   (Const (VertexId (), VertexId ()) (point, point))
 -&gt; CPlaneGraph () point PolygonEdgeType PolygonFaceData
 -&gt; Const
      (VertexId (), VertexId ())
      (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
-&gt; (((VertexId (), VertexId ())
     -&gt; Const (VertexId (), VertexId ()) (VertexId (), VertexId ()))
    -&gt; Indexed
         (VertexId (), VertexId ())
         (point, point)
         (Const (VertexId (), VertexId ()) (point, point)))
-&gt; Getting
     (VertexId (), VertexId ())
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (VertexId (), VertexId ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((VertexId (), VertexId ())
 -&gt; Const (VertexId (), VertexId ()) (VertexId (), VertexId ()))
-&gt; Indexed
     (VertexId (), VertexId ())
     (point, point)
     (Const (VertexId (), VertexId ()) (point, point))
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s.
(Indexable i p, Contravariant f, Functor f) =&gt;
p i (f i) -&gt; Indexed i s (f s)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.Internal.Indexed.html/Control.Lens.Internal.Indexed.html#asIndex"><span class="hs-identifier hs-var">asIndex</span></a></span><span>
</span><span id="line-56"></span><span>                                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Vector 2 (VertexId ()) -&gt; Vector 2 Int
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Vector 2 (VertexId ()) -&gt; Vector 2 Int)
-&gt; Vector 2 (VertexId ()) -&gt; Vector 2 Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexId () -&gt; VertexId () -&gt; Vector 2 (VertexId ())
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">VertexId ()
</span><a href="#local-6989586621679494454"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">VertexId ()
</span><a href="#local-6989586621679494455"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-57"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>                  </span><span class="annot"><span class="annottext">([(DartId (), PolygonEdgeType)] -&gt; [Diagonal polygon])
-&gt; ([(DartId (), PolygonEdgeType)]
    -&gt; [(DartId (), PolygonEdgeType)])
-&gt; [(DartId (), PolygonEdgeType)]
-&gt; [Diagonal polygon]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((DartId (), PolygonEdgeType) -&gt; Bool)
-&gt; [(DartId (), PolygonEdgeType)] -&gt; [(DartId (), PolygonEdgeType)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolygonEdgeType -&gt; PolygonEdgeType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PolygonEdgeType
</span><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier hs-var">Diagonal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PolygonEdgeType -&gt; Bool)
-&gt; ((DartId (), PolygonEdgeType) -&gt; PolygonEdgeType)
-&gt; (DartId (), PolygonEdgeType)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DartId (), PolygonEdgeType) -&gt; PolygonEdgeType
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>                  </span><span class="annot"><span class="annottext">([(DartId (), PolygonEdgeType)] -&gt; [Diagonal polygon])
-&gt; [(DartId (), PolygonEdgeType)] -&gt; [Diagonal polygon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CPlaneGraph () point PolygonEdgeType PolygonFaceData
</span><a href="#local-6989586621679494451"><span class="hs-identifier hs-var">monotoneSubdiv</span></a></span><span> </span><span class="annot"><span class="annottext">CPlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Getting
     (Endo [(DartId (), PolygonEdgeType)])
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (DartId (), PolygonEdgeType)
-&gt; [(DartId (), PolygonEdgeType)]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span> </span><span class="annot"><span class="annottext">Indexed
  (DartId ())
  (Edge (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
  (Const
     (Endo [(DartId (), PolygonEdgeType)])
     (Edge (CPlaneGraph () point PolygonEdgeType PolygonFaceData)))
-&gt; CPlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Const
     (Endo [(DartId (), PolygonEdgeType)])
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
Indexed
  (DartId ())
  PolygonEdgeType
  (Const (Endo [(DartId (), PolygonEdgeType)]) PolygonEdgeType)
-&gt; CPlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Const
     (Endo [(DartId (), PolygonEdgeType)])
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
forall graph graph'.
HasEdges graph graph' =&gt;
IndexedTraversal
  (EdgeIx graph) graph graph' (Edge graph) (Edge graph')
IndexedTraversal
  (EdgeIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
  (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
  (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
  (Edge (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
  (Edge (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#edges"><span class="hs-identifier hs-var">edges</span></a></span><span class="annot"><span class="annottext">(Indexed
   (DartId ())
   PolygonEdgeType
   (Const (Endo [(DartId (), PolygonEdgeType)]) PolygonEdgeType)
 -&gt; CPlaneGraph () point PolygonEdgeType PolygonFaceData
 -&gt; Const
      (Endo [(DartId (), PolygonEdgeType)])
      (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
-&gt; (((DartId (), PolygonEdgeType)
     -&gt; Const
          (Endo [(DartId (), PolygonEdgeType)]) (DartId (), PolygonEdgeType))
    -&gt; Indexed
         (DartId ())
         PolygonEdgeType
         (Const (Endo [(DartId (), PolygonEdgeType)]) PolygonEdgeType))
-&gt; Getting
     (Endo [(DartId (), PolygonEdgeType)])
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (DartId (), PolygonEdgeType)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((DartId (), PolygonEdgeType)
 -&gt; Const
      (Endo [(DartId (), PolygonEdgeType)]) (DartId (), PolygonEdgeType))
-&gt; Indexed
     (DartId ())
     PolygonEdgeType
     (Const (Endo [(DartId (), PolygonEdgeType)]) PolygonEdgeType)
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s j t.
(Indexable i p, Functor f) =&gt;
p (i, s) (f (j, t)) -&gt; Indexed i s (f t)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.Internal.Indexed.html/Control.Lens.Internal.Indexed.html#withIndex"><span class="hs-identifier hs-var">withIndex</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- and compute the diagonals in each interior y-monotone polygon</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="#local-6989586621679494450"><span class="hs-identifier hs-type">extraDiags</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier hs-type">Diagonal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493263"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679494450"><span class="annot"><span class="annottext">extraDiags :: [Diagonal polygon]
</span><a href="#local-6989586621679494450"><span class="hs-identifier hs-var hs-var">extraDiags</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FaceId (), PolygonFaceData) -&gt; [Diagonal polygon])
-&gt; [(FaceId (), PolygonFaceData)] -&gt; [Diagonal polygon]
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FaceId () -&gt; [Vector 2 Int]
</span><a href="#local-6989586621679494467"><span class="hs-identifier hs-var">collectDiags</span></a></span><span> </span><span class="annot"><span class="annottext">(FaceId () -&gt; [Vector 2 Int])
-&gt; ((FaceId (), PolygonFaceData) -&gt; FaceId ())
-&gt; (FaceId (), PolygonFaceData)
-&gt; [Vector 2 Int]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FaceId (), PolygonFaceData) -&gt; FaceId ()
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>                  </span><span class="annot"><span class="annottext">([(FaceId (), PolygonFaceData)] -&gt; [Diagonal polygon])
-&gt; [(FaceId (), PolygonFaceData)] -&gt; [Diagonal polygon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((FaceId (), PolygonFaceData) -&gt; Bool)
-&gt; [(FaceId (), PolygonFaceData)] -&gt; [(FaceId (), PolygonFaceData)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolygonFaceData -&gt; PolygonFaceData -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PolygonFaceData
</span><a href="HGeometry.Polygon.Triangulation.Types.html#Inside"><span class="hs-identifier hs-var">Inside</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PolygonFaceData -&gt; Bool)
-&gt; ((FaceId (), PolygonFaceData) -&gt; PolygonFaceData)
-&gt; (FaceId (), PolygonFaceData)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FaceId (), PolygonFaceData) -&gt; PolygonFaceData
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>                  </span><span class="annot"><span class="annottext">([(FaceId (), PolygonFaceData)] -&gt; [(FaceId (), PolygonFaceData)])
-&gt; [(FaceId (), PolygonFaceData)] -&gt; [(FaceId (), PolygonFaceData)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CPlaneGraph () point PolygonEdgeType PolygonFaceData
</span><a href="#local-6989586621679494451"><span class="hs-identifier hs-var">monotoneSubdiv</span></a></span><span class="annot"><span class="annottext">CPlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Getting
     (Endo [(FaceId (), PolygonFaceData)])
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (FaceId (), PolygonFaceData)
-&gt; [(FaceId (), PolygonFaceData)]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">Indexed
  (FaceId ())
  (Face (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
  (Const
     (Endo [(FaceId (), PolygonFaceData)])
     (Face (CPlaneGraph () point PolygonEdgeType PolygonFaceData)))
-&gt; CPlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Const
     (Endo [(FaceId (), PolygonFaceData)])
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
Indexed
  (FaceId ())
  PolygonFaceData
  (Const (Endo [(FaceId (), PolygonFaceData)]) PolygonFaceData)
-&gt; CPlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Const
     (Endo [(FaceId (), PolygonFaceData)])
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
forall planeGraph.
(HasOuterFace planeGraph, Eq (FaceIx planeGraph)) =&gt;
IndexedTraversal' (FaceIx planeGraph) planeGraph (Face planeGraph)
IndexedTraversal'
  (FaceIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
  (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
  (Face (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.PlanarGraph.Class.html/Hiraffe.PlanarGraph.Class.html#interiorFaces"><span class="hs-identifier hs-var">interiorFaces</span></a></span><span class="annot"><span class="annottext">(Indexed
   (FaceId ())
   PolygonFaceData
   (Const (Endo [(FaceId (), PolygonFaceData)]) PolygonFaceData)
 -&gt; CPlaneGraph () point PolygonEdgeType PolygonFaceData
 -&gt; Const
      (Endo [(FaceId (), PolygonFaceData)])
      (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
-&gt; (((FaceId (), PolygonFaceData)
     -&gt; Const
          (Endo [(FaceId (), PolygonFaceData)]) (FaceId (), PolygonFaceData))
    -&gt; Indexed
         (FaceId ())
         PolygonFaceData
         (Const (Endo [(FaceId (), PolygonFaceData)]) PolygonFaceData))
-&gt; Getting
     (Endo [(FaceId (), PolygonFaceData)])
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (FaceId (), PolygonFaceData)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((FaceId (), PolygonFaceData)
 -&gt; Const
      (Endo [(FaceId (), PolygonFaceData)]) (FaceId (), PolygonFaceData))
-&gt; Indexed
     (FaceId ())
     PolygonFaceData
     (Const (Endo [(FaceId (), PolygonFaceData)]) PolygonFaceData)
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s j t.
(Indexable i p, Functor f) =&gt;
p (i, s) (f (j, t)) -&gt; Indexed i s (f t)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.Internal.Indexed.html/Control.Lens.Internal.Indexed.html#withIndex"><span class="hs-identifier hs-var">withIndex</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- collectDiags   :: FaceIx planeGraph -&gt; [Diagonal polygon]</span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621679494467"><span class="annot"><span class="annottext">collectDiags :: FaceId () -&gt; [Vector 2 Int]
</span><a href="#local-6989586621679494467"><span class="hs-identifier hs-var hs-var">collectDiags</span></a></span></span><span> </span><span id="local-6989586621679494471"><span class="annot"><span class="annottext">FaceId ()
</span><a href="#local-6989586621679494471"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679494472"><span class="annot"><span class="annottext">yMonotonePoly :: SimplePolygon (point :+ VertexId ())
</span><a href="#local-6989586621679494472"><span class="hs-identifier hs-var hs-var">yMonotonePoly</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CPlaneGraph () point PolygonEdgeType PolygonFaceData
</span><a href="#local-6989586621679494451"><span class="hs-identifier hs-var">monotoneSubdiv</span></a></span><span> </span><span class="annot"><span class="annottext">CPlaneGraph () point PolygonEdgeType PolygonFaceData
-&gt; Getting
     (Endo (SimplePolygon (point :+ VertexId ())))
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (SimplePolygon (point :+ VertexId ()))
-&gt; SimplePolygon (point :+ VertexId ())
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span> </span><span class="annot"><span class="annottext">FaceIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
-&gt; IndexedFold
     (FaceIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData))
     (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
     (SimplePolygon
        (point
         :+ VertexIx
              (CPlaneGraph () point PolygonEdgeType PolygonFaceData)))
forall planeGraph vertex.
(PlaneGraph_ planeGraph vertex, HasOuterBoundaryOf planeGraph,
 Point_ vertex 2 (NumType vertex)) =&gt;
FaceIx planeGraph
-&gt; IndexedFold
     (FaceIx planeGraph)
     planeGraph
     (SimplePolygon (vertex :+ VertexIx planeGraph))
</span><a href="HGeometry.PlaneGraph.Class.html#outerBoundaryPolygonAt"><span class="hs-identifier hs-var">outerBoundaryPolygonAt</span></a></span><span> </span><span class="annot"><span class="annottext">FaceId ()
FaceIx (CPlaneGraph () point PolygonEdgeType PolygonFaceData)
</span><a href="#local-6989586621679494471"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-69"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Vector 2 Int -&gt; Vector 2 Int) -&gt; [Vector 2 Int] -&gt; [Vector 2 Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 (VertexId ()) -&gt; Vector 2 Int
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">(Vector 2 (VertexId ()) -&gt; Vector 2 Int)
-&gt; (Vector 2 Int -&gt; Vector 2 (VertexId ()))
-&gt; Vector 2 Int
-&gt; Vector 2 Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SimplePolygon (point :+ VertexId ())
-&gt; Diagonal (SimplePolygon (point :+ VertexId ()))
-&gt; Vector 2 (VertexId ())
forall yMonotonePolygon point i r.
YMonotonePolygon_ yMonotonePolygon (point :+ i) r =&gt;
yMonotonePolygon -&gt; Diagonal yMonotonePolygon -&gt; Vector 2 i
</span><a href="HGeometry.Polygon.Triangulation.html#withOriginalId"><span class="hs-identifier hs-var">withOriginalId</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon (point :+ VertexId ())
</span><a href="#local-6989586621679494472"><span class="hs-identifier hs-var">yMonotonePoly</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Vector 2 Int] -&gt; [Vector 2 Int])
-&gt; [Vector 2 Int] -&gt; [Vector 2 Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-70"></span><span>                            </span><span class="annot"><span class="annottext">SimplePolygon (point :+ VertexId ())
-&gt; [Diagonal (SimplePolygon (point :+ VertexId ()))]
forall polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; [Diagonal polygon]
</span><a href="HGeometry.Polygon.Triangulation.TriangulateMonotone.html#computeDiagonals"><span class="hs-identifier hs-var">TM.computeDiagonals</span></a></span><span> </span><span class="annot"><span class="annottext">SimplePolygon (point :+ VertexId ())
</span><a href="#local-6989586621679494472"><span class="hs-identifier hs-var">yMonotonePoly</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span id="local-6989586621679493431"><span id="local-6989586621679493432"><span id="local-6989586621679493433"><span id="local-6989586621679493434"><span class="annot"><a href="HGeometry.Polygon.Triangulation.html#withOriginalId"><span class="hs-identifier hs-type">withOriginalId</span></a></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.TriangulateMonotone.html#YMonotonePolygon_"><span class="hs-identifier hs-type">TM.YMonotonePolygon_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493431"><span class="hs-identifier hs-type">yMonotonePolygon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679493432"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493433"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679493434"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-73"></span><span>                                </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679493431"><span class="hs-identifier hs-type">yMonotonePolygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier hs-type">Diagonal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679493431"><span class="hs-identifier hs-type">yMonotonePolygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679493433"><span class="hs-identifier hs-type">i</span></a></span></span></span></span></span><span>
</span><span id="line-74"></span><span id="withOriginalId"><span class="annot"><span class="annottext">withOriginalId :: forall yMonotonePolygon point i r.
YMonotonePolygon_ yMonotonePolygon (point :+ i) r =&gt;
yMonotonePolygon -&gt; Diagonal yMonotonePolygon -&gt; Vector 2 i
</span><a href="HGeometry.Polygon.Triangulation.html#withOriginalId"><span class="hs-identifier hs-var hs-var">withOriginalId</span></a></span></span><span> </span><span id="local-6989586621679494496"><span class="annot"><span class="annottext">yMonotonePolygon
</span><a href="#local-6989586621679494496"><span class="hs-identifier hs-var">yMonotonePoly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; i) -&gt; Vector 2 Int -&gt; Vector 2 i
forall a b. (a -&gt; b) -&gt; Vector 2 a -&gt; Vector 2 b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679494497"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679494497"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">yMonotonePolygon
</span><a href="#local-6989586621679494496"><span class="hs-identifier hs-var">yMonotonePoly</span></a></span><span class="annot"><span class="annottext">yMonotonePolygon -&gt; Getting (Endo i) yMonotonePolygon i -&gt; i
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-8b88a30dd39d5cf6af3d15bbd3d4b10b6d686f625d00c4be01315ef5a0386892/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span class="annot"><span class="annottext">VertexIx yMonotonePolygon
-&gt; IndexedTraversal'
     (VertexIx yMonotonePolygon)
     yMonotonePolygon
     (Vertex yMonotonePolygon)
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
VertexIx yMonotonePolygon
</span><a href="#local-6989586621679494497"><span class="hs-identifier hs-var">j</span></a></span><span class="annot"><span class="annottext">(((point :+ i) -&gt; Const (Endo i) (point :+ i))
 -&gt; yMonotonePolygon -&gt; Const (Endo i) yMonotonePolygon)
-&gt; ((i -&gt; Const (Endo i) i)
    -&gt; (point :+ i) -&gt; Const (Endo i) (point :+ i))
-&gt; Getting (Endo i) yMonotonePolygon i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(i -&gt; Const (Endo i) i)
-&gt; (point :+ i) -&gt; Const (Endo i) (point :+ i)
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">-- getOriginalID :: VertexId monotonePolygon -&gt; VertexId polygon</span><span>
</span><span id="line-78"></span></pre></body></html>