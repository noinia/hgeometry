<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Triangulation.MakeMonotone</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html"><span class="hs-identifier">HGeometry.Polygon.Triangulation.MakeMonotone</span></a></span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#makeMonotone"><span class="hs-identifier">makeMonotone</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#computeDiagonals"><span class="hs-identifier">computeDiagonals</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#classifyVertices"><span class="hs-identifier">classifyVertices</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#VertexType"><span class="hs-identifier">VertexType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpX"><span class="hs-identifier">cmpX</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Down</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vector</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Sort.html/HGeometry.Foldable.Sort.html"><span class="hs-identifier">HGeometry.Foldable.Sort</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.LineSegment</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.html"><span class="hs-identifier">HGeometry.PlaneGraph.Connected</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Class</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Simple.Class</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html"><span class="hs-identifier">HGeometry.Polygon.Triangulation.Types</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Set.Util.html/HGeometry.Set.Util.html"><span class="hs-identifier">HGeometry.Set.Util</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SS</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-builder-0.3.8.6-f26b4c9259e54b201456dea6554b84866ae8dc90acfcbb414f19d393c9cdc23d/share/doc/html/src/VectorBuilder.Builder.html/VectorBuilder.Builder.html"><span class="hs-identifier">VectorBuilder.Builder</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Builder</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-builder-0.3.8.6-f26b4c9259e54b201456dea6554b84866ae8dc90acfcbb414f19d393c9cdc23d/share/doc/html/src/VectorBuilder.Vector.html/VectorBuilder.Vector.html"><span class="hs-identifier">VectorBuilder.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Builder</span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">----------------------------------------------------------------------------------</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Given a polygon, computes a plane subdivision representing a split of the polygon</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- into y-monotone subpolygons.</span><span>
</span><span id="line-39"></span><span class="hs-comment">--</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- running time: \(O(n\log n)\)</span><span>
</span><span id="line-41"></span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#makeMonotone"><span class="hs-identifier hs-type">makeMonotone</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679472412"><span class="annot"><a href="#local-6989586621679472412"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679472408"><span class="annot"><a href="#local-6989586621679472408"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span id="local-6989586621679472409"><span class="annot"><a href="#local-6989586621679472409"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span id="local-6989586621679472410"><span class="annot"><a href="#local-6989586621679472410"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-42"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SimplePolygon_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472408"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472409"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472410"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472410"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679472410"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472408"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-44"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.PlaneGraph.Connected.Type.html#CPlaneGraph"><span class="hs-identifier hs-type">CPlaneGraph</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472412"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472409"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonEdgeType"><span class="hs-identifier hs-type">PolygonEdgeType</span></a></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#PolygonFaceData"><span class="hs-identifier hs-type">PolygonFaceData</span></a></span><span>
</span><span id="line-45"></span><span id="makeMonotone"><span class="annot"><span class="annottext">makeMonotone :: forall {k} (s :: k) polygon point r.
(SimplePolygon_ polygon point r, Ord r, Num r) =&gt;
polygon -&gt; CPlaneGraph s point PolygonEdgeType PolygonFaceData
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#makeMonotone"><span class="hs-identifier hs-var hs-var">makeMonotone</span></a></span></span><span> </span><span id="local-6989586621679473200"><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473200"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">polygon
-&gt; [Diagonal polygon]
-&gt; CPlaneGraph s point PolygonEdgeType PolygonFaceData
forall {k} (s :: k) polygon point r (f :: * -&gt; *).
(SimplePolygon_ polygon point r, Point_ point 2 r, Foldable f,
 Ord r, Num r) =&gt;
polygon
-&gt; f (Diagonal polygon)
-&gt; CPlaneGraph s point PolygonEdgeType PolygonFaceData
</span><a href="HGeometry.Polygon.Triangulation.Types.html#constructGraph"><span class="hs-identifier hs-var">constructGraph</span></a></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473200"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon -&gt; [Diagonal polygon]
forall polygon point r.
(Polygon_ polygon point r, Point_ point 2 r, Ord r, Num r,
 Ord (VertexIx polygon)) =&gt;
polygon -&gt; [Diagonal polygon]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#computeDiagonals"><span class="hs-identifier hs-var">computeDiagonals</span></a></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473200"><span class="hs-identifier hs-var">pg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | Given a polygon, find a set of non-intersecting diagonals that partition</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- the polygon into y-monotone pieces.</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- running time: \(O(n\log n)\)</span><span>
</span><span id="line-52"></span><span id="local-6989586621679472498"><span id="local-6989586621679472499"><span id="local-6989586621679472500"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#computeDiagonals"><span class="hs-identifier hs-type">computeDiagonals</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Polygon_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472498"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472499"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472500"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472499"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472500"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-53"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472500"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679472500"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472498"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>                       </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472498"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier hs-type">Diagonal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472498"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-56"></span><span id="computeDiagonals"><span class="annot"><span class="annottext">computeDiagonals :: forall polygon point r.
(Polygon_ polygon point r, Point_ point 2 r, Ord r, Num r,
 Ord (VertexIx polygon)) =&gt;
polygon -&gt; [Diagonal polygon]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#computeDiagonals"><span class="hs-identifier hs-var hs-var">computeDiagonals</span></a></span></span><span> </span><span id="local-6989586621679473761"><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473761"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="annottext">(StatusStructure
   (VertexIx polygon)
   (ClosedLineSegment point :+ VertexIx polygon)
   (VertexIx polygon),
 [Diagonal polygon])
-&gt; [Diagonal polygon]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((StatusStructure
    (VertexIx polygon)
    (ClosedLineSegment point :+ VertexIx polygon)
    (VertexIx polygon),
  [Diagonal polygon])
 -&gt; [Diagonal polygon])
-&gt; (StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon),
    [Diagonal polygon])
-&gt; [Diagonal polygon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((StatusStructure
    (VertexIx polygon)
    (ClosedLineSegment point :+ VertexIx polygon)
    (VertexIx polygon),
  [Diagonal polygon])
 -&gt; Event' (VertexIx polygon) point
 -&gt; (StatusStructure
       (VertexIx polygon)
       (ClosedLineSegment point :+ VertexIx polygon)
       (VertexIx polygon),
     [Diagonal polygon]))
-&gt; (StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon),
    [Diagonal polygon])
-&gt; Vector (Event' (VertexIx polygon) point)
-&gt; (StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon),
    [Diagonal polygon])
forall a b. (a -&gt; b -&gt; a) -&gt; a -&gt; Vector b -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#foldl%27"><span class="hs-identifier hs-var">Vector.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon
-&gt; (StatusSruct polygon, [Diagonal polygon])
-&gt; Event polygon
-&gt; (StatusSruct polygon, [Diagonal polygon])
forall polygon point r.
(Polygon_ polygon point r, Point_ point 2 r, Num r, Ord r,
 Ord (VertexIx polygon)) =&gt;
polygon
-&gt; (StatusSruct polygon, [Diagonal polygon])
-&gt; Event polygon
-&gt; (StatusSruct polygon, [Diagonal polygon])
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473761"><span class="hs-identifier hs-var">pg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Map (VertexIx polygon) (VertexIx polygon)
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall edgeId edge vtx.
Set edge -&gt; Map edgeId vtx -&gt; StatusStructure edgeId edge vtx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusStructure"><span class="hs-identifier hs-var">StatusStructure</span></a></span><span> </span><span class="annot"><span class="annottext">Set (ClosedLineSegment point :+ VertexIx polygon)
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">Map (VertexIx polygon) (VertexIx polygon)
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Event' (VertexIx polygon) point)
</span><a href="#local-6989586621679473768"><span class="hs-identifier hs-var">events</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">-- sweep line algorithm to compute the diagonals</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679473768"><span class="annot"><span class="annottext">events :: Vector (Event' (VertexIx polygon) point)
</span><a href="#local-6989586621679473768"><span class="hs-identifier hs-var hs-var">events</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Event' (VertexIx polygon) point
 -&gt; Event' (VertexIx polygon) point -&gt; Ordering)
-&gt; Vector (Event' (VertexIx polygon) point)
-&gt; Vector (Event' (VertexIx polygon) point)
forall (vector :: * -&gt; *) (f :: * -&gt; *) a.
(Foldable f, Vector vector a) =&gt;
(a -&gt; a -&gt; Ordering) -&gt; f a -&gt; vector a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Sort.html/HGeometry.Foldable.Sort.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="annot"><span class="annottext">Event' (VertexIx polygon) point
-&gt; Event' (VertexIx polygon) point -&gt; Ordering
forall point r i.
(Point_ point 2 r, Ord r) =&gt;
Event' i point -&gt; Event' i point -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#compareEvent"><span class="hs-identifier hs-var">compareEvent</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Event' (VertexIx polygon) point)
 -&gt; Vector (Event' (VertexIx polygon) point))
-&gt; (Builder (Event' (VertexIx polygon) point)
    -&gt; Vector (Event' (VertexIx polygon) point))
-&gt; Builder (Event' (VertexIx polygon) point)
-&gt; Vector (Event' (VertexIx polygon) point)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (vector :: * -&gt; *) element.
Vector vector element =&gt;
Builder element -&gt; vector element
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-builder-0.3.8.6-f26b4c9259e54b201456dea6554b84866ae8dc90acfcbb414f19d393c9cdc23d/share/doc/html/src/VectorBuilder.Vector.html/VectorBuilder.Vector.html#build"><span class="hs-identifier hs-var">Builder.build</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-66c0c43b6a1c7e682eec5be5849d4cbdf281375d0306ebde2a04ed8c14b07f1d/share/doc/html/src/Data.Vector.html/Data.Vector.html#Vector"><span class="hs-identifier hs-type">Vector.Vector</span></a></span><span>
</span><span id="line-61"></span><span>           </span><span class="annot"><span class="annottext">(Builder (Event' (VertexIx polygon) point)
 -&gt; Vector (Event' (VertexIx polygon) point))
-&gt; Builder (Event' (VertexIx polygon) point)
-&gt; Vector (Event' (VertexIx polygon) point)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IndexedGetting
  (VertexIx polygon)
  (Builder (Event' (VertexIx polygon) point))
  polygon
  point
-&gt; (VertexIx polygon
    -&gt; point -&gt; Builder (Event' (VertexIx polygon) point))
-&gt; polygon
-&gt; Builder (Event' (VertexIx polygon) point)
forall i m s a. IndexedGetting i m s a -&gt; (i -&gt; a -&gt; m) -&gt; s -&gt; m
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#ifoldMapOf"><span class="hs-identifier hs-var">ifoldMapOf</span></a></span><span> </span><span class="annot"><span class="annottext">IndexedGetting
  (VertexIx polygon)
  (Builder (Event' (VertexIx polygon) point))
  polygon
  point
Indexed
  (VertexIx polygon)
  (Vertex polygon)
  (Const
     (Builder (Event' (VertexIx polygon) point)) (Vertex polygon))
-&gt; polygon
-&gt; Const (Builder (Event' (VertexIx polygon) point)) polygon
forall graph graph'.
HasVertices graph graph' =&gt;
IndexedTraversal1
  (VertexIx graph) graph graph' (Vertex graph) (Vertex graph')
IndexedTraversal1
  (VertexIx polygon)
  polygon
  polygon
  (Vertex polygon)
  (Vertex polygon)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679473775"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679473775"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679473776"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473776"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Event' (VertexIx polygon) point
-&gt; Builder (Event' (VertexIx polygon) point)
forall element. element -&gt; Builder element
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-builder-0.3.8.6-f26b4c9259e54b201456dea6554b84866ae8dc90acfcbb414f19d393c9cdc23d/share/doc/html/src/VectorBuilder.Core.Builder.html/VectorBuilder.Core.Builder.html#singleton"><span class="hs-identifier hs-var">Builder.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(Event' (VertexIx polygon) point
 -&gt; Builder (Event' (VertexIx polygon) point))
-&gt; Event' (VertexIx polygon) point
-&gt; Builder (Event' (VertexIx polygon) point)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon -&gt; point -&gt; Event' (VertexIx polygon) point
</span><a href="#local-6989586621679473778"><span class="hs-identifier hs-var">toEvent</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679473775"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473776"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473761"><span class="hs-identifier hs-var">pg</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-comment">-- Transform the vertex into an Event</span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679473778"><span class="annot"><span class="annottext">toEvent :: VertexIx polygon -&gt; point -&gt; Event' (VertexIx polygon) point
</span><a href="#local-6989586621679473778"><span class="hs-identifier hs-var hs-var">toEvent</span></a></span></span><span> </span><span id="local-6989586621679473779"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679473779"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679473780"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473780"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexType
-&gt; VertexIx polygon
-&gt; point
-&gt; VertexIx polygon
-&gt; VertexIx polygon
-&gt; Event' (VertexIx polygon) point
forall idx point.
VertexType -&gt; idx -&gt; point -&gt; idx -&gt; idx -&gt; Event' idx point
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event"><span class="hs-identifier hs-var">Event</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon -&gt; VertexIx polygon -&gt; point -&gt; VertexType
forall polygon point r.
(Polygon_ polygon point r, Num r, Ord r, Point_ point 2 r) =&gt;
polygon -&gt; VertexIx polygon -&gt; point -&gt; VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#classify"><span class="hs-identifier hs-var">classify</span></a></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473761"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679473779"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473780"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679473779"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679473780"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473761"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon
-&gt; Getting (VertexIx polygon) polygon (VertexIx polygon)
-&gt; VertexIx polygon
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; IndexedLens' (VertexIx polygon) polygon (Vertex polygon)
forall polygon point r.
Polygon_ polygon point r =&gt;
VertexIx polygon
-&gt; IndexedLens' (VertexIx polygon) polygon (Vertex polygon)
</span><span class="hs-identifier hs-var">ccwPredecessorOf</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679473779"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">(Indexed (VertexIx polygon) point (Const (VertexIx polygon) point)
 -&gt; polygon -&gt; Const (VertexIx polygon) polygon)
-&gt; ((VertexIx polygon
     -&gt; Const (VertexIx polygon) (VertexIx polygon))
    -&gt; Indexed
         (VertexIx polygon) point (Const (VertexIx polygon) point))
-&gt; Getting (VertexIx polygon) polygon (VertexIx polygon)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((VertexIx polygon, point)
 -&gt; Const (VertexIx polygon) (VertexIx polygon, point))
-&gt; Indexed
     (VertexIx polygon) point (Const (VertexIx polygon) point)
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s j t.
(Indexable i p, Functor f) =&gt;
p (i, s) (f (j, t)) -&gt; Indexed i s (f t)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Internal.Indexed.html/Control.Lens.Internal.Indexed.html#withIndex"><span class="hs-identifier hs-var">withIndex</span></a></span><span class="annot"><span class="annottext">(((VertexIx polygon, point)
  -&gt; Const (VertexIx polygon) (VertexIx polygon, point))
 -&gt; Indexed
      (VertexIx polygon) point (Const (VertexIx polygon) point))
-&gt; ((VertexIx polygon
     -&gt; Const (VertexIx polygon) (VertexIx polygon))
    -&gt; (VertexIx polygon, point)
    -&gt; Const (VertexIx polygon) (VertexIx polygon, point))
-&gt; (VertexIx polygon
    -&gt; Const (VertexIx polygon) (VertexIx polygon))
-&gt; Indexed
     (VertexIx polygon) point (Const (VertexIx polygon) point)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(VertexIx polygon -&gt; Const (VertexIx polygon) (VertexIx polygon))
-&gt; (VertexIx polygon, point)
-&gt; Const (VertexIx polygon) (VertexIx polygon, point)
forall s t a b. Field1 s t a b =&gt; Lens s t a b
Lens
  (VertexIx polygon, point)
  (VertexIx polygon, point)
  (VertexIx polygon)
  (VertexIx polygon)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Tuple.html/Control.Lens.Tuple.html#_1"><span class="hs-identifier hs-var">_1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>                                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679473761"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon
-&gt; Getting (VertexIx polygon) polygon (VertexIx polygon)
-&gt; VertexIx polygon
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; IndexedLens' (VertexIx polygon) polygon (Vertex polygon)
forall polygon point r.
Polygon_ polygon point r =&gt;
VertexIx polygon
-&gt; IndexedLens' (VertexIx polygon) polygon (Vertex polygon)
</span><span class="hs-identifier hs-var">ccwSuccessorOf</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679473779"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">(Indexed (VertexIx polygon) point (Const (VertexIx polygon) point)
 -&gt; polygon -&gt; Const (VertexIx polygon) polygon)
-&gt; ((VertexIx polygon
     -&gt; Const (VertexIx polygon) (VertexIx polygon))
    -&gt; Indexed
         (VertexIx polygon) point (Const (VertexIx polygon) point))
-&gt; Getting (VertexIx polygon) polygon (VertexIx polygon)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((VertexIx polygon, point)
 -&gt; Const (VertexIx polygon) (VertexIx polygon, point))
-&gt; Indexed
     (VertexIx polygon) point (Const (VertexIx polygon) point)
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s j t.
(Indexable i p, Functor f) =&gt;
p (i, s) (f (j, t)) -&gt; Indexed i s (f t)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Internal.Indexed.html/Control.Lens.Internal.Indexed.html#withIndex"><span class="hs-identifier hs-var">withIndex</span></a></span><span class="annot"><span class="annottext">(((VertexIx polygon, point)
  -&gt; Const (VertexIx polygon) (VertexIx polygon, point))
 -&gt; Indexed
      (VertexIx polygon) point (Const (VertexIx polygon) point))
-&gt; ((VertexIx polygon
     -&gt; Const (VertexIx polygon) (VertexIx polygon))
    -&gt; (VertexIx polygon, point)
    -&gt; Const (VertexIx polygon) (VertexIx polygon, point))
-&gt; (VertexIx polygon
    -&gt; Const (VertexIx polygon) (VertexIx polygon))
-&gt; Indexed
     (VertexIx polygon) point (Const (VertexIx polygon) point)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(VertexIx polygon -&gt; Const (VertexIx polygon) (VertexIx polygon))
-&gt; (VertexIx polygon, point)
-&gt; Const (VertexIx polygon) (VertexIx polygon, point)
forall s t a b. Field1 s t a b =&gt; Lens s t a b
Lens
  (VertexIx polygon, point)
  (VertexIx polygon, point)
  (VertexIx polygon)
  (VertexIx polygon)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Tuple.html/Control.Lens.Tuple.html#_1"><span class="hs-identifier hs-var">_1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><span class="hs-comment">-- | Assigns a vertex type to the given vertex</span></span><span>
</span><span id="line-67"></span><span id="local-6989586621679472568"><span id="local-6989586621679472569"><span id="local-6989586621679472570"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#classify"><span class="hs-identifier hs-type">classify</span></a></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Polygon_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472568"><span class="hs-identifier hs-type">polygon</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679472569"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472570"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679472570"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472570"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472569"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472570"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472568"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472568"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472569"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#VertexType"><span class="hs-identifier hs-type">VertexType</span></a></span></span></span></span><span>
</span><span id="line-69"></span><span id="classify"><span class="annot"><span class="annottext">classify :: forall polygon point r.
(Polygon_ polygon point r, Num r, Ord r, Point_ point 2 r) =&gt;
polygon -&gt; VertexIx polygon -&gt; point -&gt; VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#classify"><span class="hs-identifier hs-var hs-var">classify</span></a></span></span><span> </span><span id="local-6989586621679474163"><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474163"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span id="local-6989586621679474164"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474164"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679474165"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474165"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679474166"><span class="annot"><span class="annottext">p :: point
</span><a href="#local-6989586621679474166"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474163"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon -&gt; Getting point polygon point -&gt; point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; IndexedLens' (VertexIx polygon) polygon (Vertex polygon)
forall polygon point r.
Polygon_ polygon point r =&gt;
VertexIx polygon
-&gt; IndexedLens' (VertexIx polygon) polygon (Vertex polygon)
</span><span class="hs-identifier hs-var">ccwPredecessorOf</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474164"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-70"></span><span>                      </span><span id="local-6989586621679474167"><span class="annot"><span class="annottext">n :: point
</span><a href="#local-6989586621679474167"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474163"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon -&gt; Getting point polygon point -&gt; point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; IndexedLens' (VertexIx polygon) polygon (Vertex polygon)
forall polygon point r.
Polygon_ polygon point r =&gt;
VertexIx polygon
-&gt; IndexedLens' (VertexIx polygon) polygon (Vertex polygon)
</span><span class="hs-identifier hs-var">ccwSuccessorOf</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474164"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-71"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474166"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Ordering
forall point r.
(Point_ point 2 r, Ord r) =&gt;
point -&gt; point -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpSweep"><span class="hs-operator hs-var">`cmpSweep`</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474165"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474167"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Ordering
forall point r.
(Point_ point 2 r, Ord r) =&gt;
point -&gt; point -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpSweep"><span class="hs-operator hs-var">`cmpSweep`</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474165"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Bool
</span><a href="#local-6989586621679474169"><span class="hs-identifier hs-var">largeInteriorAngle</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474166"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474167"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-72"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span>
</span><span id="line-73"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Split"><span class="hs-identifier hs-var">Split</span></a></span><span>
</span><span id="line-74"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#End"><span class="hs-identifier hs-var">End</span></a></span><span>
</span><span id="line-75"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span><span>
</span><span id="line-76"></span><span>                       </span><span class="annot"><span class="annottext">(Ordering, Ordering, Bool)
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Regular"><span class="hs-identifier hs-var">Regular</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- is the angle larger than &gt; 180 degrees</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679474169"><span class="annot"><span class="annottext">largeInteriorAngle :: point -&gt; point -&gt; Bool
</span><a href="#local-6989586621679474169"><span class="hs-identifier hs-var hs-var">largeInteriorAngle</span></a></span></span><span> </span><span id="local-6989586621679474175"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474175"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679474176"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474176"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; point -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474175"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474165"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474176"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-80"></span><span>           </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-81"></span><span>           </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-82"></span><span>           </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Bool
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;classifyVertices -&gt; largeInteriorAngle: colinear points&quot;</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | comparison used to order the events w.r.t the sweep line:</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- p &lt; q = p.y &lt; q.y || p.y == q.y &amp;&amp; p.x &gt; q.y</span><span>
</span><span id="line-86"></span><span id="local-6989586621679472590"><span id="local-6989586621679472591"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpSweep"><span class="hs-identifier hs-type">cmpSweep</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472590"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472591"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472591"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472590"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472590"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span></span><span>
</span><span id="line-87"></span><span id="local-6989586621679474314"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474314"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="cmpSweep"><span class="annot"><span class="annottext">cmpSweep :: forall point r.
(Point_ point 2 r, Ord r) =&gt;
point -&gt; point -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpSweep"><span class="hs-operator hs-var hs-var">`cmpSweep`</span></a></span></span><span> </span><span id="local-6989586621679474315"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474315"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; r) -&gt; point -&gt; point -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; Getting r point r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r point r
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point r
</span><span class="hs-identifier hs-var">yCoord</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474314"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474315"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(point -&gt; Down r) -&gt; point -&gt; point -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Down r
forall a. a -&gt; Down a
</span><span class="hs-identifier hs-var">Down</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; Down r) -&gt; (point -&gt; r) -&gt; point -&gt; Down r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; Getting r point r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r point r
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point r
</span><span class="hs-identifier hs-var">xCoord</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474314"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474315"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><span class="hs-comment">-- | Handle an event</span></span><span>
</span><span id="line-91"></span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#handle"><span class="hs-identifier hs-type">handle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679472536"><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span id="local-6989586621679472537"><span class="annot"><a href="#local-6989586621679472537"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span id="local-6989586621679472538"><span class="annot"><a href="#local-6989586621679472538"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Polygon_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472537"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472538"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-92"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472537"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472538"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679472538"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472538"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-93"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>                                  </span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-96"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusSruct"><span class="hs-identifier hs-type">StatusSruct</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier hs-type">Diagonal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-97"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusSruct"><span class="hs-identifier hs-type">StatusSruct</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.Types.html#Diagonal"><span class="hs-identifier hs-type">Diagonal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span id="handle"><span class="annot"><span class="annottext">handle :: forall polygon point r.
(Polygon_ polygon point r, Point_ point 2 r, Num r, Ord r,
 Ord (VertexIx polygon)) =&gt;
polygon
-&gt; (StatusSruct polygon, [Diagonal polygon])
-&gt; Event polygon
-&gt; (StatusSruct polygon, [Diagonal polygon])
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#handle"><span class="hs-identifier hs-var hs-var">handle</span></a></span></span><span> </span><span id="local-6989586621679474876"><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474876"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474877"><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679474878"><span class="annot"><span class="annottext">[Diagonal polygon]
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">diags</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span id="local-6989586621679474879"><span class="annot"><span class="annottext">VertexType
</span><a href="#local-6989586621679474879"><span class="hs-identifier hs-var">et</span></a></span></span><span> </span><span id="local-6989586621679474880"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679474881"><span class="annot"><span class="annottext">Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679474882"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679474883"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474883"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VertexType
</span><a href="#local-6989586621679474879"><span class="hs-identifier hs-var">et</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
-&gt; Edge' polygon
-&gt; VertexIx polygon
-&gt; StatusSruct polygon
-&gt; StatusSruct polygon
</span><a href="#local-6989586621679474884"><span class="hs-identifier hs-var">insertAt</span></a></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474885"><span class="hs-identifier hs-var">nextEdge</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Diagonal polygon]
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">diags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#End"><span class="hs-identifier hs-var">End</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
-&gt; Edge' polygon -&gt; StatusSruct polygon -&gt; StatusSruct polygon
</span><a href="#local-6989586621679474886"><span class="hs-identifier hs-var">deleteAt</span></a></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474887"><span class="hs-identifier hs-var">prevEdge</span></a></span><span> </span><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Maybe (Diagonal polygon)
</span><a href="#local-6989586621679474888"><span class="hs-identifier hs-var">diagFromHelper</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Diagonal polygon)
-&gt; [Diagonal polygon] -&gt; [Diagonal polygon]
forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-var">&lt;?</span></a></span><span> </span><span class="annot"><span class="annottext">[Diagonal polygon]
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">diags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Split"><span class="hs-identifier hs-var">Split</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
-&gt; Edge' polygon
-&gt; VertexIx polygon
-&gt; StatusSruct polygon
-&gt; StatusSruct polygon
</span><a href="#local-6989586621679474884"><span class="hs-identifier hs-var">insertAt</span></a></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474885"><span class="hs-identifier hs-var">nextEdge</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
-&gt; (StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
    -&gt; StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Map (VertexIx polygon) (VertexIx polygon)
 -&gt; Identity (Map (VertexIx polygon) (VertexIx polygon)))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Identity
     (StatusStructure
        (VertexIx polygon)
        (ClosedLineSegment point :+ VertexIx polygon)
        (VertexIx polygon))
forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Map edgeId vtx -&gt; f (Map edgeId vtx))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helpers"><span class="hs-identifier hs-var">helpers</span></a></span><span> </span><span class="annot"><span class="annottext">((Map (VertexIx polygon) (VertexIx polygon)
  -&gt; Identity (Map (VertexIx polygon) (VertexIx polygon)))
 -&gt; StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
 -&gt; Identity
      (StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon)))
-&gt; (Map (VertexIx polygon) (VertexIx polygon)
    -&gt; Map (VertexIx polygon) (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; VertexIx polygon
-&gt; Map (VertexIx polygon) (VertexIx polygon)
-&gt; Map (VertexIx polygon) (VertexIx polygon)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474894"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-104"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Diagonal polygon
</span><a href="#local-6989586621679474895"><span class="hs-identifier hs-var">diag</span></a></span><span> </span><span class="annot"><span class="annottext">Diagonal polygon -&gt; [Diagonal polygon] -&gt; [Diagonal polygon]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Diagonal polygon]
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">diags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
-&gt; Edge' polygon -&gt; StatusSruct polygon -&gt; StatusSruct polygon
</span><a href="#local-6989586621679474886"><span class="hs-identifier hs-var">deleteAt</span></a></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474887"><span class="hs-identifier hs-var">prevEdge</span></a></span><span> </span><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
-&gt; (StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
    -&gt; StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Map (VertexIx polygon) (VertexIx polygon)
 -&gt; Identity (Map (VertexIx polygon) (VertexIx polygon)))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Identity
     (StatusStructure
        (VertexIx polygon)
        (ClosedLineSegment point :+ VertexIx polygon)
        (VertexIx polygon))
forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Map edgeId vtx -&gt; f (Map edgeId vtx))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helpers"><span class="hs-identifier hs-var">helpers</span></a></span><span> </span><span class="annot"><span class="annottext">((Map (VertexIx polygon) (VertexIx polygon)
  -&gt; Identity (Map (VertexIx polygon) (VertexIx polygon)))
 -&gt; StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
 -&gt; Identity
      (StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon)))
-&gt; (Map (VertexIx polygon) (VertexIx polygon)
    -&gt; Map (VertexIx polygon) (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; VertexIx polygon
-&gt; Map (VertexIx polygon) (VertexIx polygon)
-&gt; Map (VertexIx polygon) (VertexIx polygon)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474894"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-107"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Maybe (Diagonal polygon)
</span><a href="#local-6989586621679474888"><span class="hs-identifier hs-var">diagFromHelper</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474894"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Diagonal polygon)
-&gt; [Diagonal polygon] -&gt; [Diagonal polygon]
forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-var">&lt;?</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Maybe (Diagonal polygon)
</span><a href="#local-6989586621679474888"><span class="hs-identifier hs-var">diagFromHelper</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Diagonal polygon)
-&gt; [Diagonal polygon] -&gt; [Diagonal polygon]
forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-var">&lt;?</span></a></span><span> </span><span class="annot"><span class="annottext">[Diagonal polygon]
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">diags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Regular"><span class="hs-identifier hs-var">Regular</span></a></span><span>
</span><span id="line-110"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679474896"><span class="hs-identifier hs-var">isLeftVertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">point
-&gt; Edge' polygon
-&gt; VertexIx polygon
-&gt; StatusSruct polygon
-&gt; StatusSruct polygon
</span><a href="#local-6989586621679474884"><span class="hs-identifier hs-var">insertAt</span></a></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474885"><span class="hs-identifier hs-var">nextEdge</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(StatusSruct polygon -&gt; StatusSruct polygon)
-&gt; StatusSruct polygon -&gt; StatusSruct polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">point
-&gt; Edge' polygon -&gt; StatusSruct polygon -&gt; StatusSruct polygon
</span><a href="#local-6989586621679474886"><span class="hs-identifier hs-var">deleteAt</span></a></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474887"><span class="hs-identifier hs-var">prevEdge</span></a></span><span> </span><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span>
</span><span id="line-111"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Maybe (Diagonal polygon)
</span><a href="#local-6989586621679474888"><span class="hs-identifier hs-var">diagFromHelper</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Diagonal polygon)
-&gt; [Diagonal polygon] -&gt; [Diagonal polygon]
forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-var">&lt;?</span></a></span><span> </span><span class="annot"><span class="annottext">[Diagonal polygon]
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">diags</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
-&gt; (StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
    -&gt; StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Map (VertexIx polygon) (VertexIx polygon)
 -&gt; Identity (Map (VertexIx polygon) (VertexIx polygon)))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Identity
     (StatusStructure
        (VertexIx polygon)
        (ClosedLineSegment point :+ VertexIx polygon)
        (VertexIx polygon))
forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Map edgeId vtx -&gt; f (Map edgeId vtx))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helpers"><span class="hs-identifier hs-var">helpers</span></a></span><span> </span><span class="annot"><span class="annottext">((Map (VertexIx polygon) (VertexIx polygon)
  -&gt; Identity (Map (VertexIx polygon) (VertexIx polygon)))
 -&gt; StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
 -&gt; Identity
      (StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon)))
-&gt; (Map (VertexIx polygon) (VertexIx polygon)
    -&gt; Map (VertexIx polygon) (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; VertexIx polygon
-&gt; Map (VertexIx polygon) (VertexIx polygon)
-&gt; Map (VertexIx polygon) (VertexIx polygon)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474894"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Maybe (Diagonal polygon)
</span><a href="#local-6989586621679474888"><span class="hs-identifier hs-var">diagFromHelper</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474894"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Diagonal polygon)
-&gt; [Diagonal polygon] -&gt; [Diagonal polygon]
forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-var">&lt;?</span></a></span><span> </span><span class="annot"><span class="annottext">[Diagonal polygon]
</span><a href="#local-6989586621679474878"><span class="hs-identifier hs-var">diags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- edges incident to v = v_i</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679474887"><span class="annot"><span class="annottext">prevEdge :: ClosedLineSegment point :+ VertexIx polygon
</span><a href="#local-6989586621679474887"><span class="hs-identifier hs-var hs-var">prevEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; ClosedLineSegment point
forall point. point -&gt; point -&gt; ClosedLineSegment point
</span><span class="hs-identifier hs-var">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474876"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon -&gt; Getting (Endo point) polygon point -&gt; point
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; IndexedTraversal' (VertexIx polygon) polygon (Vertex polygon)
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point
-&gt; VertexIx polygon -&gt; ClosedLineSegment point :+ VertexIx polygon
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679474885"><span class="annot"><span class="annottext">nextEdge :: ClosedLineSegment point :+ VertexIx polygon
</span><a href="#local-6989586621679474885"><span class="hs-identifier hs-var hs-var">nextEdge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; ClosedLineSegment point
forall point. point -&gt; point -&gt; ClosedLineSegment point
</span><span class="hs-identifier hs-var">ClosedLineSegment</span></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474876"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon -&gt; Getting (Endo point) polygon point -&gt; point
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; IndexedTraversal' (VertexIx polygon) polygon (Vertex polygon)
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474883"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point
-&gt; VertexIx polygon -&gt; ClosedLineSegment point :+ VertexIx polygon
forall core extra. core -&gt; extra -&gt; core :+ extra
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-comment">-- j is the EdgeId of the edge directly left of v (j may not exist when v is a start,</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- end, or left-regular vertex; we use it only when we know it exists.)</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679474894"><span class="annot"><span class="annottext">j :: VertexIx polygon
</span><a href="#local-6989586621679474894"><span class="hs-identifier hs-var hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">point -&gt; StatusSruct polygon -&gt; Maybe (Edge' polygon)
</span><a href="#local-6989586621679474901"><span class="hs-identifier hs-var">lookupLT</span></a></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-121"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474902"><span class="annot"><span class="annottext">ClosedLineSegment (Vertex polygon)
</span><a href="#local-6989586621679474902"><span class="hs-identifier hs-var">_leftEdge</span></a></span></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679474903"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474903"><span class="hs-identifier hs-var">j'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474903"><span class="hs-identifier hs-var">j'</span></a></span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Edge' polygon)
</span><span class="hs-identifier">_</span></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; VertexIx polygon
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; VertexIx polygon) -&gt; [Char] -&gt; VertexIx polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;MakeMonotone.handleSplit: absurd. no j&quot;</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- the diagonal between the current vertex v and the helper</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679474895"><span class="annot"><span class="annottext">diag :: Diagonal polygon
</span><a href="#local-6989586621679474895"><span class="hs-identifier hs-var hs-var">diag</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Maybe (VertexIx polygon)
forall edgeId edge vtx.
Ord edgeId =&gt;
edgeId -&gt; StatusStructure edgeId edge vtx -&gt; Maybe vtx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helper"><span class="hs-identifier hs-var">helper</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474894"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474877"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-125"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679474905"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474905"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon -&gt; VertexIx polygon -&gt; Diagonal polygon
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474905"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-126"></span><span>                  </span><span class="annot"><span class="annottext">Maybe (VertexIx polygon)
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Diagonal polygon
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;MakeMonotone.handleSplit: absurd. no helper&quot;</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">-- figure out what the helper of edgeIx is, and if its a merge vertex connect it to</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- the current vertex v</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679474888"><span class="annot"><span class="annottext">diagFromHelper :: VertexIx polygon
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Maybe (Diagonal polygon)
</span><a href="#local-6989586621679474888"><span class="hs-identifier hs-var hs-var">diagFromHelper</span></a></span></span><span> </span><span id="local-6989586621679474907"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474907"><span class="hs-identifier hs-var">edgeIx</span></a></span></span><span> </span><span id="local-6989586621679474908"><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
</span><a href="#local-6989586621679474908"><span class="hs-identifier hs-var">status'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Maybe (VertexIx polygon)
forall edgeId edge vtx.
Ord edgeId =&gt;
edgeId -&gt; StatusStructure edgeId edge vtx -&gt; Maybe vtx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helper"><span class="hs-identifier hs-var">helper</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474907"><span class="hs-identifier hs-var">edgeIx</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
</span><a href="#local-6989586621679474908"><span class="hs-identifier hs-var">status'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>                                      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679474909"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474909"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon -&gt; Bool
</span><a href="#local-6989586621679474910"><span class="hs-identifier hs-var">isMerge</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474909"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Diagonal polygon -&gt; Maybe (Diagonal polygon)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Diagonal polygon -&gt; Maybe (Diagonal polygon))
-&gt; Diagonal polygon -&gt; Maybe (Diagonal polygon)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon -&gt; VertexIx polygon -&gt; Diagonal polygon
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474880"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474909"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-132"></span><span>                                      </span><span class="annot"><span class="annottext">Maybe (VertexIx polygon)
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Diagonal polygon)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>        </span><span id="local-6989586621679474910"><span class="annot"><span class="annottext">isMerge :: VertexIx polygon -&gt; Bool
</span><a href="#local-6989586621679474910"><span class="hs-identifier hs-var hs-var">isMerge</span></a></span></span><span> </span><span id="local-6989586621679474911"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474911"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">polygon -&gt; VertexIx polygon -&gt; point -&gt; VertexType
forall polygon point r.
(Polygon_ polygon point r, Num r, Ord r, Point_ point 2 r) =&gt;
polygon -&gt; VertexIx polygon -&gt; point -&gt; VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#classify"><span class="hs-identifier hs-var">classify</span></a></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474876"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474911"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474876"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon -&gt; Getting (Endo point) polygon point -&gt; point
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; IndexedTraversal' (VertexIx polygon) polygon (Vertex polygon)
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474911"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexType -&gt; VertexType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">-- | returns True if v the interior of the polygon is to the right of v</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679474896"><span class="annot"><span class="annottext">isLeftVertex :: Bool
</span><a href="#local-6989586621679474896"><span class="hs-identifier hs-var hs-var">isLeftVertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679474876"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon -&gt; Getting (Endo point) polygon point -&gt; point
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E%3F%21"><span class="hs-operator hs-var">^?!</span></a></span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; IndexedTraversal' (VertexIx polygon) polygon (Vertex polygon)
forall graph.
HasVertices' graph =&gt;
VertexIx graph
-&gt; IndexedTraversal' (VertexIx graph) graph (Vertex graph)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#vertexAt"><span class="hs-identifier hs-var">vertexAt</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474882"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Ordering
forall point r.
(Point_ point 2 r, Ord r) =&gt;
point -&gt; point -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpSweep"><span class="hs-operator hs-var">`cmpSweep`</span></a></span><span> </span><span class="annot"><span class="annottext">point
Vertex polygon
</span><a href="#local-6989586621679474881"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>                     </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-139"></span><span>                     </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">-- given a vertex that determines the time, and an edge and its helper, insert it</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">-- into the status structure</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="#local-6989586621679474884"><span class="hs-identifier hs-type">insertAt</span></a></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679472537"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-144"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Edge%27"><span class="hs-identifier hs-type">Edge'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-145"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-comment">-- ^ the helper of the edge</span><span>
</span><span id="line-146"></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusSruct"><span class="hs-identifier hs-type">StatusSruct</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusSruct"><span class="hs-identifier hs-type">StatusSruct</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621679474884"><span class="annot"><span class="annottext">insertAt :: point
-&gt; Edge' polygon
-&gt; VertexIx polygon
-&gt; StatusSruct polygon
-&gt; StatusSruct polygon
</span><a href="#local-6989586621679474884"><span class="hs-identifier hs-var hs-var">insertAt</span></a></span></span><span> </span><span id="local-6989586621679474912"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474912"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679474913"><span class="annot"><span class="annottext">Edge' polygon
</span><a href="#local-6989586621679474913"><span class="hs-identifier hs-var">seg</span></a></span></span><span> </span><span id="local-6989586621679474914"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474914"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679474915"><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474915"><span class="hs-identifier hs-var">status'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474915"><span class="hs-identifier hs-var">status'</span></a></span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
-&gt; (StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
    -&gt; StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Set (ClosedLineSegment point :+ VertexIx polygon)
 -&gt; Identity (Set (ClosedLineSegment point :+ VertexIx polygon)))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Identity
     (StatusStructure
        (VertexIx polygon)
        (ClosedLineSegment point :+ VertexIx polygon)
        (VertexIx polygon))
forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Set edge -&gt; f (Set edge))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span>    </span><span class="annot"><span class="annottext">((Set (ClosedLineSegment point :+ VertexIx polygon)
  -&gt; Identity (Set (ClosedLineSegment point :+ VertexIx polygon)))
 -&gt; StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
 -&gt; Identity
      (StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon)))
-&gt; (Set (ClosedLineSegment point :+ VertexIx polygon)
    -&gt; Set (ClosedLineSegment point :+ VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">((ClosedLineSegment point :+ VertexIx polygon)
 -&gt; (ClosedLineSegment point :+ VertexIx polygon) -&gt; Ordering)
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Set (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Set (ClosedLineSegment point :+ VertexIx polygon)
forall a. (a -&gt; a -&gt; Ordering) -&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Set.Util.html/HGeometry.Set.Util.html#insertBy"><span class="hs-identifier hs-var">SS.insertBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Ordering
forall r lineSegment point.
(Num r, Ord r, LineSegment_ lineSegment point, Point_ point 2 r) =&gt;
r -&gt; lineSegment -&gt; lineSegment -&gt; Ordering
</span><span class="hs-identifier hs-var">ordAtY</span></span><span> </span><span class="annot"><span class="annottext">(r
 -&gt; (ClosedLineSegment point :+ VertexIx polygon)
 -&gt; (ClosedLineSegment point :+ VertexIx polygon)
 -&gt; Ordering)
-&gt; r
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474912"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting r point r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r point r
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point r
</span><span class="hs-identifier hs-var">yCoord</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474913"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-148"></span><span>                                      </span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
-&gt; (StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
    -&gt; StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Map (VertexIx polygon) (VertexIx polygon)
 -&gt; Identity (Map (VertexIx polygon) (VertexIx polygon)))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Identity
     (StatusStructure
        (VertexIx polygon)
        (ClosedLineSegment point :+ VertexIx polygon)
        (VertexIx polygon))
forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Map edgeId vtx -&gt; f (Map edgeId vtx))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helpers"><span class="hs-identifier hs-var">helpers</span></a></span><span> </span><span class="annot"><span class="annottext">((Map (VertexIx polygon) (VertexIx polygon)
  -&gt; Identity (Map (VertexIx polygon) (VertexIx polygon)))
 -&gt; StatusStructure
      (VertexIx polygon)
      (ClosedLineSegment point :+ VertexIx polygon)
      (VertexIx polygon)
 -&gt; Identity
      (StatusStructure
         (VertexIx polygon)
         (ClosedLineSegment point :+ VertexIx polygon)
         (VertexIx polygon)))
-&gt; (Map (VertexIx polygon) (VertexIx polygon)
    -&gt; Map (VertexIx polygon) (VertexIx polygon))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
-&gt; VertexIx polygon
-&gt; Map (VertexIx polygon) (VertexIx polygon)
-&gt; Map (VertexIx polygon) (VertexIx polygon)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474913"><span class="hs-identifier hs-var">seg</span></a></span><span class="annot"><span class="annottext">(ClosedLineSegment point :+ VertexIx polygon)
-&gt; Getting
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; VertexIx polygon
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679474914"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-comment">-- given a vertex that determines the dtime, and an edge. Delete the edge from the status</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-comment">-- structure.</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="#local-6989586621679474886"><span class="hs-identifier hs-type">deleteAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679472537"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Edge%27"><span class="hs-identifier hs-type">Edge'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusSruct"><span class="hs-identifier hs-type">StatusSruct</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusSruct"><span class="hs-identifier hs-type">StatusSruct</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679474886"><span class="annot"><span class="annottext">deleteAt :: point
-&gt; Edge' polygon -&gt; StatusSruct polygon -&gt; StatusSruct polygon
</span><a href="#local-6989586621679474886"><span class="hs-identifier hs-var hs-var">deleteAt</span></a></span></span><span> </span><span id="local-6989586621679474920"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474920"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679474921"><span class="annot"><span class="annottext">Edge' polygon
</span><a href="#local-6989586621679474921"><span class="hs-identifier hs-var">seg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter
  (StatusSruct polygon)
  (StatusSruct polygon)
  (Set (ClosedLineSegment point :+ VertexIx polygon))
  (Set (ClosedLineSegment point :+ VertexIx polygon))
-&gt; (Set (ClosedLineSegment point :+ VertexIx polygon)
    -&gt; Set (ClosedLineSegment point :+ VertexIx polygon))
-&gt; StatusSruct polygon
-&gt; StatusSruct polygon
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">(Set (ClosedLineSegment point :+ VertexIx polygon)
 -&gt; Identity (Set (ClosedLineSegment point :+ VertexIx polygon)))
-&gt; StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon)
-&gt; Identity
     (StatusStructure
        (VertexIx polygon)
        (ClosedLineSegment point :+ VertexIx polygon)
        (VertexIx polygon))
ASetter
  (StatusSruct polygon)
  (StatusSruct polygon)
  (Set (ClosedLineSegment point :+ VertexIx polygon))
  (Set (ClosedLineSegment point :+ VertexIx polygon))
forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Set edge -&gt; f (Set edge))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span> </span><span class="annot"><span class="annottext">((Set (ClosedLineSegment point :+ VertexIx polygon)
  -&gt; Set (ClosedLineSegment point :+ VertexIx polygon))
 -&gt; StatusSruct polygon -&gt; StatusSruct polygon)
-&gt; (Set (ClosedLineSegment point :+ VertexIx polygon)
    -&gt; Set (ClosedLineSegment point :+ VertexIx polygon))
-&gt; StatusSruct polygon
-&gt; StatusSruct polygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ClosedLineSegment point :+ VertexIx polygon)
 -&gt; (ClosedLineSegment point :+ VertexIx polygon) -&gt; Ordering)
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Set (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Set (ClosedLineSegment point :+ VertexIx polygon)
forall a. (a -&gt; a -&gt; Ordering) -&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Set.Util.html/HGeometry.Set.Util.html#deleteAllBy"><span class="hs-identifier hs-var">SS.deleteAllBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Ordering
forall r lineSegment point.
(Num r, Ord r, LineSegment_ lineSegment point, Point_ point 2 r) =&gt;
r -&gt; lineSegment -&gt; lineSegment -&gt; Ordering
</span><span class="hs-identifier hs-var">ordAtY</span></span><span> </span><span class="annot"><span class="annottext">(r
 -&gt; (ClosedLineSegment point :+ VertexIx polygon)
 -&gt; (ClosedLineSegment point :+ VertexIx polygon)
 -&gt; Ordering)
-&gt; r
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Ordering
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474920"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting r point r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r point r
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point r
</span><span class="hs-identifier hs-var">yCoord</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment point :+ VertexIx polygon
Edge' polygon
</span><a href="#local-6989586621679474921"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-comment">-- Look up the edge directly to the left of the query point q.</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="#local-6989586621679474901"><span class="hs-identifier hs-type">lookupLT</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679472537"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusSruct"><span class="hs-identifier hs-type">StatusSruct</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Edge%27"><span class="hs-identifier hs-type">Edge'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472536"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679474901"><span class="annot"><span class="annottext">lookupLT :: point -&gt; StatusSruct polygon -&gt; Maybe (Edge' polygon)
</span><a href="#local-6989586621679474901"><span class="hs-identifier hs-var hs-var">lookupLT</span></a></span></span><span> </span><span id="local-6989586621679474924"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474924"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679474925"><span class="annot"><span class="annottext">StatusSruct polygon
</span><a href="#local-6989586621679474925"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679474926"><span class="annot"><span class="annottext">Set (ClosedLineSegment point :+ VertexIx polygon)
</span><a href="#local-6989586621679474926"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set (ClosedLineSegment point :+ VertexIx polygon)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set (ClosedLineSegment point :+ VertexIx polygon)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ClosedLineSegment point :+ VertexIx polygon) -&gt; Ordering)
-&gt; Set (ClosedLineSegment point :+ VertexIx polygon)
-&gt; (Set (ClosedLineSegment point :+ VertexIx polygon),
    Set (ClosedLineSegment point :+ VertexIx polygon),
    Set (ClosedLineSegment point :+ VertexIx polygon))
forall a. (a -&gt; Ordering) -&gt; Set a -&gt; (Set a, Set a, Set a)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Set.Util.html/HGeometry.Set.Util.html#splitBy"><span class="hs-identifier hs-var">SS.splitBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; (ClosedLineSegment point :+ VertexIx polygon) -&gt; Ordering
forall point r lineSegment point'.
(Point_ point 2 r, LineSegment_ lineSegment point',
 Point_ point' 2 r, Ord r, Num r) =&gt;
point -&gt; lineSegment -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpX"><span class="hs-identifier hs-var">cmpX</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679474924"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
StatusSruct polygon
</span><a href="#local-6989586621679474925"><span class="hs-identifier hs-var">s'</span></a></span><span class="annot"><span class="annottext">StatusStructure
  (VertexIx polygon)
  (ClosedLineSegment point :+ VertexIx polygon)
  (VertexIx polygon)
-&gt; Getting
     (Set (ClosedLineSegment point :+ VertexIx polygon))
     (StatusStructure
        (VertexIx polygon)
        (ClosedLineSegment point :+ VertexIx polygon)
        (VertexIx polygon))
     (Set (ClosedLineSegment point :+ VertexIx polygon))
-&gt; Set (ClosedLineSegment point :+ VertexIx polygon)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting
  (Set (ClosedLineSegment point :+ VertexIx polygon))
  (StatusStructure
     (VertexIx polygon)
     (ClosedLineSegment point :+ VertexIx polygon)
     (VertexIx polygon))
  (Set (ClosedLineSegment point :+ VertexIx polygon))
forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Set edge -&gt; f (Set edge))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#tree"><span class="hs-identifier hs-var">tree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Set (ClosedLineSegment point :+ VertexIx polygon)
-&gt; Maybe (ClosedLineSegment point :+ VertexIx polygon)
forall a. Set a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Set.lookupMax</span></span><span> </span><span class="annot"><span class="annottext">Set (ClosedLineSegment point :+ VertexIx polygon)
</span><a href="#local-6989586621679474926"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | compare the point and the segment horizontally. I.e. returs LT if the segment lies</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- left of the point, EQ if the point is on the segment, and GT if the segment lies right</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- of the point.</span><span>
</span><span id="line-163"></span><span id="local-6989586621679472674"><span id="local-6989586621679472675"><span id="local-6989586621679472676"><span id="local-6989586621679472677"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpX"><span class="hs-identifier hs-type">cmpX</span></a></span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472674"><span class="hs-identifier hs-type">point</span></a></span><span>  </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LineSegment_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472676"><span class="hs-identifier hs-type">lineSegment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472677"><span class="hs-identifier hs-type">point'</span></a></span><span>
</span><span id="line-164"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472677"><span class="hs-identifier hs-type">point'</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472675"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679472675"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-165"></span><span>                            </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472674"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472676"><span class="hs-identifier hs-type">lineSegment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span></span></span></span><span>
</span><span id="line-166"></span><span id="cmpX"><span class="annot"><span class="annottext">cmpX :: forall point r lineSegment point'.
(Point_ point 2 r, LineSegment_ lineSegment point',
 Point_ point' 2 r, Ord r, Num r) =&gt;
point -&gt; lineSegment -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpX"><span class="hs-identifier hs-var hs-var">cmpX</span></a></span></span><span> </span><span id="local-6989586621679475345"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679475345"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">lineSegment -&gt; lineSegment
forall lineSegment point (d :: Nat) r.
(LineSegment_ lineSegment point, Point_ point d r, 1 &lt;= d,
 Ord r) =&gt;
lineSegment -&gt; lineSegment
</span><span class="hs-identifier hs-var">orientLR</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679475347"><span class="annot"><span class="annottext">lineSegment
</span><a href="#local-6989586621679475347"><span class="hs-identifier hs-var">seg</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">lineSegment
</span><a href="#local-6989586621679475347"><span class="hs-identifier hs-var">seg</span></a></span><span class="annot"><span class="annottext">lineSegment -&gt; Getting r lineSegment r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(point' -&gt; Const r point') -&gt; lineSegment -&gt; Const r lineSegment
forall seg p. HasStart seg p =&gt; Lens' seg p
Lens' lineSegment point'
</span><span class="hs-identifier hs-var">start</span></span><span class="annot"><span class="annottext">((point' -&gt; Const r point') -&gt; lineSegment -&gt; Const r lineSegment)
-&gt; ((r -&gt; Const r r) -&gt; point' -&gt; Const r point')
-&gt; Getting r lineSegment r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(r -&gt; Const r r) -&gt; point' -&gt; Const r point'
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point' r
</span><span class="hs-identifier hs-var">yCoord</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">lineSegment
</span><a href="#local-6989586621679475347"><span class="hs-identifier hs-var">seg</span></a></span><span class="annot"><span class="annottext">lineSegment -&gt; Getting r lineSegment r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(point' -&gt; Const r point') -&gt; lineSegment -&gt; Const r lineSegment
forall seg p. HasEnd seg p =&gt; Lens' seg p
Lens' lineSegment point'
</span><span class="hs-identifier hs-var">end</span></span><span class="annot"><span class="annottext">((point' -&gt; Const r point') -&gt; lineSegment -&gt; Const r lineSegment)
-&gt; ((r -&gt; Const r r) -&gt; point' -&gt; Const r point')
-&gt; Getting r lineSegment r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(r -&gt; Const r r) -&gt; point' -&gt; Const r point'
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point' r
</span><span class="hs-identifier hs-var">yCoord</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
</span><a href="#local-6989586621679475351"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Ordering
</span><a href="#local-6989586621679475351"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679475351"><span class="annot"><span class="annottext">f :: Ordering -&gt; Ordering -&gt; Ordering
</span><a href="#local-6989586621679475351"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679475352"><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679475352"><span class="hs-identifier hs-var">lt</span></a></span></span><span> </span><span id="local-6989586621679475353"><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679475353"><span class="hs-identifier hs-var">gt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Point 2 r -&gt; CCW
forall point r point' point''.
(Point_ point 2 r, Point_ point' 2 r, Point_ point'' 2 r, Num r,
 Ord r) =&gt;
point -&gt; point' -&gt; point'' -&gt; CCW
</span><span class="hs-identifier hs-var">ccw</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">lineSegment
</span><a href="#local-6989586621679475347"><span class="hs-identifier hs-var">seg</span></a></span><span class="annot"><span class="annottext">lineSegment
-&gt; Getting (Point 2 r) lineSegment (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(point' -&gt; Const (Point 2 r) point')
-&gt; lineSegment -&gt; Const (Point 2 r) lineSegment
forall seg p. HasStart seg p =&gt; Lens' seg p
Lens' lineSegment point'
</span><span class="hs-identifier hs-var">start</span></span><span class="annot"><span class="annottext">((point' -&gt; Const (Point 2 r) point')
 -&gt; lineSegment -&gt; Const (Point 2 r) lineSegment)
-&gt; ((Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
    -&gt; point' -&gt; Const (Point 2 r) point')
-&gt; Getting (Point 2 r) lineSegment (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
-&gt; point' -&gt; Const (Point 2 r) point'
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point' (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679475345"><span class="hs-identifier hs-var">q</span></a></span><span class="annot"><span class="annottext">point -&gt; Getting (Point 2 r) point (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) point (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">lineSegment
</span><a href="#local-6989586621679475347"><span class="hs-identifier hs-var">seg</span></a></span><span class="annot"><span class="annottext">lineSegment
-&gt; Getting (Point 2 r) lineSegment (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(point' -&gt; Const (Point 2 r) point')
-&gt; lineSegment -&gt; Const (Point 2 r) lineSegment
forall seg p. HasEnd seg p =&gt; Lens' seg p
Lens' lineSegment point'
</span><span class="hs-identifier hs-var">end</span></span><span class="annot"><span class="annottext">((point' -&gt; Const (Point 2 r) point')
 -&gt; lineSegment -&gt; Const (Point 2 r) lineSegment)
-&gt; ((Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
    -&gt; point' -&gt; Const (Point 2 r) point')
-&gt; Getting (Point 2 r) lineSegment (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
-&gt; point' -&gt; Const (Point 2 r) point'
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point' (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-171"></span><span>                </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CW</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679475352"><span class="hs-identifier hs-var">lt</span></a></span><span>
</span><span id="line-172"></span><span>                </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CoLinear</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-173"></span><span>                </span><span class="annot"><span class="annottext">CCW
</span><span class="hs-identifier hs-var">CCW</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><a href="#local-6989586621679475353"><span class="hs-identifier hs-var">gt</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-177"></span><span class="annot"><span class="hs-comment">-- * An Event; essentially just a vertex.</span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><span class="hs-comment">-- | Events during the sweepline algorithm ; the vertices</span></span><span>
</span><span id="line-180"></span><span class="hs-keyword">type</span><span> </span><span id="Event"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event"><span class="hs-identifier hs-var">Event</span></a></span></span><span> </span><span id="local-6989586621679475356"><span class="annot"><a href="#local-6989586621679475356"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event%27"><span class="hs-identifier hs-type">Event'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679475356"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679475356"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span class="hs-keyword">data</span><span> </span><span id="Event%27"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event%27"><span class="hs-identifier hs-var">Event'</span></a></span></span><span> </span><span id="local-6989586621679472566"><span class="annot"><a href="#local-6989586621679472566"><span class="hs-identifier hs-type">idx</span></a></span></span><span> </span><span id="local-6989586621679472567"><span class="annot"><a href="#local-6989586621679472567"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>  </span><span id="Event"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event"><span class="hs-identifier hs-var">Event</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_eventType"><span class="annot"><span class="annottext">forall idx point. Event' idx point -&gt; VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_eventType"><span class="hs-identifier hs-var hs-var">_eventType</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span class="hs-glyph">!</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#VertexType"><span class="hs-identifier hs-type">VertexType</span></a></span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_vtxId"><span class="annot"><span class="annottext">forall idx point. Event' idx point -&gt; idx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_vtxId"><span class="hs-identifier hs-var hs-var">_vtxId</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679472566"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="eventPoint"><span class="annot"><span class="annottext">forall idx point. Event' idx point -&gt; point
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#eventPoint"><span class="hs-identifier hs-var hs-var">eventPoint</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679472567"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_predecessorVtx"><span class="annot"><span class="annottext">forall idx point. Event' idx point -&gt; idx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_predecessorVtx"><span class="hs-identifier hs-var hs-var">_predecessorVtx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679472566"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="_successorVtx"><span class="annot"><span class="annottext">forall idx point. Event' idx point -&gt; idx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_successorVtx"><span class="hs-identifier hs-var hs-var">_successorVtx</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679472566"><span class="hs-identifier hs-type">idx</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679475365"><span id="local-6989586621679475374"><span id="local-6989586621679475378"><span class="annot"><span class="annottext">Int -&gt; Event' idx point -&gt; ShowS
[Event' idx point] -&gt; ShowS
Event' idx point -&gt; [Char]
(Int -&gt; Event' idx point -&gt; ShowS)
-&gt; (Event' idx point -&gt; [Char])
-&gt; ([Event' idx point] -&gt; ShowS)
-&gt; Show (Event' idx point)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall idx point.
(Show point, Show idx) =&gt;
Int -&gt; Event' idx point -&gt; ShowS
forall idx point.
(Show point, Show idx) =&gt;
[Event' idx point] -&gt; ShowS
forall idx point.
(Show point, Show idx) =&gt;
Event' idx point -&gt; [Char]
$cshowsPrec :: forall idx point.
(Show point, Show idx) =&gt;
Int -&gt; Event' idx point -&gt; ShowS
showsPrec :: Int -&gt; Event' idx point -&gt; ShowS
$cshow :: forall idx point.
(Show point, Show idx) =&gt;
Event' idx point -&gt; [Char]
show :: Event' idx point -&gt; [Char]
$cshowList :: forall idx point.
(Show point, Show idx) =&gt;
[Event' idx point] -&gt; ShowS
showList :: [Event' idx point] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679475385"><span id="local-6989586621679475392"><span class="annot"><span class="annottext">Event' idx point -&gt; Event' idx point -&gt; Bool
(Event' idx point -&gt; Event' idx point -&gt; Bool)
-&gt; (Event' idx point -&gt; Event' idx point -&gt; Bool)
-&gt; Eq (Event' idx point)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall idx point.
(Eq point, Eq idx) =&gt;
Event' idx point -&gt; Event' idx point -&gt; Bool
$c== :: forall idx point.
(Eq point, Eq idx) =&gt;
Event' idx point -&gt; Event' idx point -&gt; Bool
== :: Event' idx point -&gt; Event' idx point -&gt; Bool
$c/= :: forall idx point.
(Eq point, Eq idx) =&gt;
Event' idx point -&gt; Event' idx point -&gt; Bool
/= :: Event' idx point -&gt; Event' idx point -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><span class="hs-comment">-- | how to compare events</span></span><span>
</span><span id="line-190"></span><span id="local-6989586621679472550"><span id="local-6989586621679472551"><span id="local-6989586621679472552"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#compareEvent"><span class="hs-identifier hs-type">compareEvent</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472550"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472551"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472551"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event%27"><span class="hs-identifier hs-type">Event'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472552"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472550"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Event%27"><span class="hs-identifier hs-type">Event'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472552"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472550"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span></span></span></span><span>
</span><span id="line-191"></span><span id="compareEvent"><span class="annot"><span class="annottext">compareEvent :: forall point r i.
(Point_ point 2 r, Ord r) =&gt;
Event' i point -&gt; Event' i point -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#compareEvent"><span class="hs-identifier hs-var hs-var">compareEvent</span></a></span></span><span> </span><span id="local-6989586621679475465"><span class="annot"><span class="annottext">Event' i point
</span><a href="#local-6989586621679475465"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679475466"><span class="annot"><span class="annottext">Event' i point
</span><a href="#local-6989586621679475466"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Event' i point -&gt; point
forall idx point. Event' idx point -&gt; point
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#eventPoint"><span class="hs-identifier hs-var">eventPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Event' i point
</span><a href="#local-6989586621679475466"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; Ordering
forall point r.
(Point_ point 2 r, Ord r) =&gt;
point -&gt; point -&gt; Ordering
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#cmpSweep"><span class="hs-operator hs-var">`cmpSweep`</span></a></span><span> </span><span class="annot"><span class="annottext">Event' i point -&gt; point
forall idx point. Event' idx point -&gt; point
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#eventPoint"><span class="hs-identifier hs-var">eventPoint</span></a></span><span> </span><span class="annot"><span class="annottext">Event' i point
</span><a href="#local-6989586621679475465"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- note that the order of p and q has switched.</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-195"></span><span class="annot"><span class="hs-comment">-- * The Status Structure</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><span class="hs-comment">-- | edges are identified using their first vertex</span></span><span>
</span><span id="line-198"></span><span class="hs-keyword">type</span><span> </span><span id="Edge%27"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Edge%27"><span class="hs-identifier hs-var">Edge'</span></a></span></span><span> </span><span id="local-6989586621679475467"><span class="annot"><a href="#local-6989586621679475467"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-type">Vertex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679475467"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679475467"><span class="hs-identifier hs-type">polygon</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><span class="hs-comment">-- | The status structure during the sweep</span></span><span>
</span><span id="line-201"></span><span class="hs-keyword">type</span><span> </span><span id="StatusSruct"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusSruct"><span class="hs-identifier hs-var">StatusSruct</span></a></span></span><span> </span><span id="local-6989586621679475468"><span class="annot"><a href="#local-6989586621679475468"><span class="hs-identifier hs-type">polygon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusStructure"><span class="hs-identifier hs-type">StatusStructure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679475468"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>                                           </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Edge%27"><span class="hs-identifier hs-type">Edge'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679475468"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>                                           </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679475468"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | The status structure consists of a BST of edges intersected by the sweep line (in</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- left to right order), and, for each edge currently intersected by the sweep line its</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- helper vertex.</span><span>
</span><span id="line-209"></span><span class="hs-keyword">data</span><span> </span><span id="StatusStructure"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusStructure"><span class="hs-identifier hs-var">StatusStructure</span></a></span></span><span> </span><span id="local-6989586621679472542"><span class="annot"><a href="#local-6989586621679472542"><span class="hs-identifier hs-type">edgeId</span></a></span></span><span> </span><span id="local-6989586621679472541"><span class="annot"><a href="#local-6989586621679472541"><span class="hs-identifier hs-type">edge</span></a></span></span><span> </span><span id="local-6989586621679472543"><span class="annot"><a href="#local-6989586621679472543"><span class="hs-identifier hs-type">vtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>  </span><span id="StatusStructure"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusStructure"><span class="hs-identifier hs-var">StatusStructure</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_tree"><span class="annot"><span class="annottext">forall edgeId edge vtx. StatusStructure edgeId edge vtx -&gt; Set edge
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_tree"><span class="hs-identifier hs-var hs-var">_tree</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679472541"><span class="hs-identifier hs-type">edge</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the BST with edges ordered along sweep</span></span><span>
</span><span id="line-211"></span><span>                  </span><span class="hs-special">,</span><span> </span><span id="_helpers"><span class="annot"><span class="annottext">forall edgeId edge vtx.
StatusStructure edgeId edge vtx -&gt; Map edgeId vtx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_helpers"><span class="hs-identifier hs-var hs-var">_helpers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679472542"><span class="hs-identifier hs-type">edgeId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472543"><span class="hs-identifier hs-type">vtx</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ for each edge its helper</span></span><span>
</span><span id="line-212"></span><span>                  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679475475"><span id="local-6989586621679475482"><span id="local-6989586621679475486"><span class="annot"><span class="annottext">Int -&gt; StatusStructure edgeId edge vtx -&gt; ShowS
[StatusStructure edgeId edge vtx] -&gt; ShowS
StatusStructure edgeId edge vtx -&gt; [Char]
(Int -&gt; StatusStructure edgeId edge vtx -&gt; ShowS)
-&gt; (StatusStructure edgeId edge vtx -&gt; [Char])
-&gt; ([StatusStructure edgeId edge vtx] -&gt; ShowS)
-&gt; Show (StatusStructure edgeId edge vtx)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall edgeId edge vtx.
(Show edge, Show edgeId, Show vtx) =&gt;
Int -&gt; StatusStructure edgeId edge vtx -&gt; ShowS
forall edgeId edge vtx.
(Show edge, Show edgeId, Show vtx) =&gt;
[StatusStructure edgeId edge vtx] -&gt; ShowS
forall edgeId edge vtx.
(Show edge, Show edgeId, Show vtx) =&gt;
StatusStructure edgeId edge vtx -&gt; [Char]
$cshowsPrec :: forall edgeId edge vtx.
(Show edge, Show edgeId, Show vtx) =&gt;
Int -&gt; StatusStructure edgeId edge vtx -&gt; ShowS
showsPrec :: Int -&gt; StatusStructure edgeId edge vtx -&gt; ShowS
$cshow :: forall edgeId edge vtx.
(Show edge, Show edgeId, Show vtx) =&gt;
StatusStructure edgeId edge vtx -&gt; [Char]
show :: StatusStructure edgeId edge vtx -&gt; [Char]
$cshowList :: forall edgeId edge vtx.
(Show edge, Show edgeId, Show vtx) =&gt;
[StatusStructure edgeId edge vtx] -&gt; ShowS
showList :: [StatusStructure edgeId edge vtx] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679475492"><span id="local-6989586621679475498"><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx
-&gt; StatusStructure edgeId edge vtx -&gt; Bool
(StatusStructure edgeId edge vtx
 -&gt; StatusStructure edgeId edge vtx -&gt; Bool)
-&gt; (StatusStructure edgeId edge vtx
    -&gt; StatusStructure edgeId edge vtx -&gt; Bool)
-&gt; Eq (StatusStructure edgeId edge vtx)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall edgeId edge vtx.
(Eq edge, Eq edgeId, Eq vtx) =&gt;
StatusStructure edgeId edge vtx
-&gt; StatusStructure edgeId edge vtx -&gt; Bool
$c== :: forall edgeId edge vtx.
(Eq edge, Eq edgeId, Eq vtx) =&gt;
StatusStructure edgeId edge vtx
-&gt; StatusStructure edgeId edge vtx -&gt; Bool
== :: StatusStructure edgeId edge vtx
-&gt; StatusStructure edgeId edge vtx -&gt; Bool
$c/= :: forall edgeId edge vtx.
(Eq edge, Eq edgeId, Eq vtx) =&gt;
StatusStructure edgeId edge vtx
-&gt; StatusStructure edgeId edge vtx -&gt; Bool
/= :: StatusStructure edgeId edge vtx
-&gt; StatusStructure edgeId edge vtx -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span id="local-6989586621679472662"><span id="local-6989586621679472663"><span id="local-6989586621679472664"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#tree"><span class="hs-identifier hs-type">tree</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusStructure"><span class="hs-identifier hs-type">StatusStructure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472663"><span class="hs-identifier hs-type">edgeId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472662"><span class="hs-identifier hs-type">edge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472664"><span class="hs-identifier hs-type">vtx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="#local-6989586621679472662"><span class="hs-identifier hs-type">edge</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-215"></span><span id="tree"><span class="annot"><span class="annottext">tree :: forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Set edge -&gt; f (Set edge))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#tree"><span class="hs-identifier hs-var hs-var">tree</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StatusStructure edgeId edge vtx -&gt; Set edge)
-&gt; (StatusStructure edgeId edge vtx
    -&gt; Set edge -&gt; StatusStructure edgeId edge vtx)
-&gt; Lens
     (StatusStructure edgeId edge vtx)
     (StatusStructure edgeId edge vtx)
     (Set edge)
     (Set edge)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx -&gt; Set edge
forall edgeId edge vtx. StatusStructure edgeId edge vtx -&gt; Set edge
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_tree"><span class="hs-identifier hs-var">_tree</span></a></span><span>   </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679475504"><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx
</span><a href="#local-6989586621679475504"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621679475505"><span class="annot"><span class="annottext">Set edge
</span><a href="#local-6989586621679475505"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx
</span><a href="#local-6989586621679475504"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_tree"><span class="hs-identifier hs-var">_tree</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679475505"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621679472640"><span id="local-6989586621679472641"><span id="local-6989586621679472642"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helpers"><span class="hs-identifier hs-type">helpers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusStructure"><span class="hs-identifier hs-type">StatusStructure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472640"><span class="hs-identifier hs-type">edgeId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472642"><span class="hs-identifier hs-type">edge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472641"><span class="hs-identifier hs-type">vtx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679472640"><span class="hs-identifier hs-type">edgeId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472641"><span class="hs-identifier hs-type">vtx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-218"></span><span id="helpers"><span class="annot"><span class="annottext">helpers :: forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Map edgeId vtx -&gt; f (Map edgeId vtx))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helpers"><span class="hs-identifier hs-var hs-var">helpers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StatusStructure edgeId edge vtx -&gt; Map edgeId vtx)
-&gt; (StatusStructure edgeId edge vtx
    -&gt; Map edgeId vtx -&gt; StatusStructure edgeId edge vtx)
-&gt; Lens
     (StatusStructure edgeId edge vtx)
     (StatusStructure edgeId edge vtx)
     (Map edgeId vtx)
     (Map edgeId vtx)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx -&gt; Map edgeId vtx
forall edgeId edge vtx.
StatusStructure edgeId edge vtx -&gt; Map edgeId vtx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_helpers"><span class="hs-identifier hs-var">_helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679475508"><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx
</span><a href="#local-6989586621679475508"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621679475509"><span class="annot"><span class="annottext">Map edgeId vtx
</span><a href="#local-6989586621679475509"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx
</span><a href="#local-6989586621679475508"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#_helpers"><span class="hs-identifier hs-var">_helpers</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679475509"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><span class="hs-comment">-- | Get the helper of the given edge</span></span><span>
</span><span id="line-221"></span><span id="local-6989586621679472657"><span id="local-6989586621679472658"><span id="local-6989586621679472659"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helper"><span class="hs-identifier hs-type">helper</span></a></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472657"><span class="hs-identifier hs-type">edgeId</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472657"><span class="hs-identifier hs-type">edgeId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#StatusStructure"><span class="hs-identifier hs-type">StatusStructure</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472657"><span class="hs-identifier hs-type">edgeId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472658"><span class="hs-identifier hs-type">edge</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472659"><span class="hs-identifier hs-type">vtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679472659"><span class="hs-identifier hs-type">vtx</span></a></span></span></span></span><span>
</span><span id="line-222"></span><span id="helper"><span class="annot"><span class="annottext">helper :: forall edgeId edge vtx.
Ord edgeId =&gt;
edgeId -&gt; StatusStructure edgeId edge vtx -&gt; Maybe vtx
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helper"><span class="hs-identifier hs-var hs-var">helper</span></a></span></span><span> </span><span id="local-6989586621679475515"><span class="annot"><span class="annottext">edgeId
</span><a href="#local-6989586621679475515"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679475516"><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx
</span><a href="#local-6989586621679475516"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx
</span><a href="#local-6989586621679475516"><span class="hs-identifier hs-var">status</span></a></span><span class="annot"><span class="annottext">StatusStructure edgeId edge vtx
-&gt; Getting
     (Maybe vtx) (StatusStructure edgeId edge vtx) (Maybe vtx)
-&gt; Maybe vtx
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Map edgeId vtx -&gt; Const (Maybe vtx) (Map edgeId vtx))
-&gt; StatusStructure edgeId edge vtx
-&gt; Const (Maybe vtx) (StatusStructure edgeId edge vtx)
forall edgeId edge vtx (f :: * -&gt; *).
Functor f =&gt;
(Map edgeId vtx -&gt; f (Map edgeId vtx))
-&gt; StatusStructure edgeId edge vtx
-&gt; f (StatusStructure edgeId edge vtx)
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#helpers"><span class="hs-identifier hs-var">helpers</span></a></span><span class="annot"><span class="annottext">((Map edgeId vtx -&gt; Const (Maybe vtx) (Map edgeId vtx))
 -&gt; StatusStructure edgeId edge vtx
 -&gt; Const (Maybe vtx) (StatusStructure edgeId edge vtx))
-&gt; ((Maybe vtx -&gt; Const (Maybe vtx) (Maybe vtx))
    -&gt; Map edgeId vtx -&gt; Const (Maybe vtx) (Map edgeId vtx))
-&gt; Getting
     (Maybe vtx) (StatusStructure edgeId edge vtx) (Maybe vtx)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Index (Map edgeId vtx)
-&gt; Lens' (Map edgeId vtx) (Maybe (IxValue (Map edgeId vtx)))
forall m. At m =&gt; Index m -&gt; Lens' m (Maybe (IxValue m))
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.At.html/Control.Lens.At.html#at"><span class="hs-identifier hs-var">at</span></a></span><span> </span><span class="annot"><span class="annottext">edgeId
Index (Map edgeId vtx)
</span><a href="#local-6989586621679475515"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><span class="hs-comment">-- | The various vertex types</span></span><span>
</span><span id="line-227"></span><span class="hs-keyword">data</span><span> </span><span id="VertexType"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#VertexType"><span class="hs-identifier hs-var">VertexType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Start"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Start"><span class="hs-identifier hs-var">Start</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Merge"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Split"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Split"><span class="hs-identifier hs-var">Split</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="End"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#End"><span class="hs-identifier hs-var">End</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Regular"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#Regular"><span class="hs-identifier hs-var">Regular</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679475519"><span id="local-6989586621679475521"><span id="local-6989586621679475524"><span class="annot"><span class="annottext">Int -&gt; VertexType -&gt; ShowS
[VertexType] -&gt; ShowS
VertexType -&gt; [Char]
(Int -&gt; VertexType -&gt; ShowS)
-&gt; (VertexType -&gt; [Char])
-&gt; ([VertexType] -&gt; ShowS)
-&gt; Show VertexType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; VertexType -&gt; ShowS
showsPrec :: Int -&gt; VertexType -&gt; ShowS
$cshow :: VertexType -&gt; [Char]
show :: VertexType -&gt; [Char]
$cshowList :: [VertexType] -&gt; ShowS
showList :: [VertexType] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679475527"><span id="local-6989586621679475531"><span id="local-6989586621679475534"><span id="local-6989586621679475542"><span class="annot"><span class="annottext">ReadPrec [VertexType]
ReadPrec VertexType
Int -&gt; ReadS VertexType
ReadS [VertexType]
(Int -&gt; ReadS VertexType)
-&gt; ReadS [VertexType]
-&gt; ReadPrec VertexType
-&gt; ReadPrec [VertexType]
-&gt; Read VertexType
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS VertexType
readsPrec :: Int -&gt; ReadS VertexType
$creadList :: ReadS [VertexType]
readList :: ReadS [VertexType]
$creadPrec :: ReadPrec VertexType
readPrec :: ReadPrec VertexType
$creadListPrec :: ReadPrec [VertexType]
readListPrec :: ReadPrec [VertexType]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679475549"><span id="local-6989586621679475554"><span class="annot"><span class="annottext">VertexType -&gt; VertexType -&gt; Bool
(VertexType -&gt; VertexType -&gt; Bool)
-&gt; (VertexType -&gt; VertexType -&gt; Bool) -&gt; Eq VertexType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: VertexType -&gt; VertexType -&gt; Bool
== :: VertexType -&gt; VertexType -&gt; Bool
$c/= :: VertexType -&gt; VertexType -&gt; Bool
/= :: VertexType -&gt; VertexType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><span class="hs-comment">-- | Classify all vertices of the polygon; i.e. compute their vertex types.</span></span><span>
</span><span id="line-230"></span><span id="local-6989586621679472778"><span id="local-6989586621679472779"><span id="local-6989586621679472780"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#classifyVertices"><span class="hs-identifier hs-type">classifyVertices</span></a></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Polygon_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472778"><span class="hs-identifier hs-type">polygon</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621679472779"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679472780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679472780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679472779"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679472780"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679472778"><span class="hs-identifier hs-type">polygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679472778"><span class="hs-identifier hs-type">polygon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#VertexType"><span class="hs-identifier hs-type">VertexType</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-232"></span><span id="classifyVertices"><span class="annot"><span class="annottext">classifyVertices :: forall polygon point r.
(Polygon_ polygon point r, Num r, Ord r, Point_ point 2 r) =&gt;
polygon -&gt; [(VertexIx polygon, VertexType)]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#classifyVertices"><span class="hs-identifier hs-var hs-var">classifyVertices</span></a></span></span><span> </span><span id="local-6989586621679475748"><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679475748"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679475749"><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679475749"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679475750"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679475750"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679475749"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">polygon -&gt; VertexIx polygon -&gt; point -&gt; VertexType
forall polygon point r.
(Polygon_ polygon point r, Num r, Ord r, Point_ point 2 r) =&gt;
polygon -&gt; VertexIx polygon -&gt; point -&gt; VertexType
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#classify"><span class="hs-identifier hs-var">classify</span></a></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679475748"><span class="hs-identifier hs-var">pg</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx polygon
</span><a href="#local-6989586621679475749"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679475750"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((VertexIx polygon, point) -&gt; (VertexIx polygon, VertexType))
-&gt; [(VertexIx polygon, point)] -&gt; [(VertexIx polygon, VertexType)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">polygon
</span><a href="#local-6989586621679475748"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">polygon
-&gt; IndexedGetting
     (VertexIx polygon) (Endo [(VertexIx polygon, point)]) polygon point
-&gt; [(VertexIx polygon, point)]
forall s i a. s -&gt; IndexedGetting i (Endo [(i, a)]) s a -&gt; [(i, a)]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E%40.."><span class="hs-operator hs-var">^@..</span></a></span><span class="annot"><span class="annottext">IndexedGetting
  (VertexIx polygon) (Endo [(VertexIx polygon, point)]) polygon point
Indexed
  (VertexIx polygon)
  (Vertex polygon)
  (Const (Endo [(VertexIx polygon, point)]) (Vertex polygon))
-&gt; polygon -&gt; Const (Endo [(VertexIx polygon, point)]) polygon
forall graph graph'.
HasVertices graph graph' =&gt;
IndexedTraversal1
  (VertexIx graph) graph graph' (Vertex graph) (Vertex graph')
IndexedTraversal1
  (VertexIx polygon)
  polygon
  polygon
  (Vertex polygon)
  (Vertex polygon)
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-235"></span><span class="annot"><span class="hs-comment">-- * Helper functions</span></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-type">&lt;?</span></a></span><span>
</span><span id="line-238"></span><span class="annot"><span class="hs-comment">-- | Cons the item onto the list (if the item actually exists)</span></span><span>
</span><span id="line-239"></span><span id="local-6989586621679472635"><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-type">(&lt;?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679472635"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679472635"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679472635"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-240"></span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span id="%3C%3F"><span class="annot"><span class="annottext">&lt;? :: forall a. Maybe a -&gt; [a] -&gt; [a]
</span><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-var hs-var">&lt;?</span></a></span></span><span> </span><span id="local-6989586621679475753"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679475753"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679475753"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-241"></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679475754"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679475754"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Triangulation.MakeMonotone.html#%3C%3F"><span class="hs-operator hs-var">&lt;?</span></a></span><span> </span><span id="local-6989586621679475755"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679475755"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679475754"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679475755"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-242"></span></pre></body></html>