<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Convex.Merge</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Algorithm for merging two disjoint convex polygons; i.e. computing their tangents and</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- combining them.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Merge.html"><span class="hs-identifier">HGeometry.Polygon.Convex.Merge</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Merge.html#merge"><span class="hs-identifier">merge</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html"><span class="hs-identifier">HGeometry.Ext</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.LineSegment</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Class</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Convex.Class</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Convex.Tangents.html"><span class="hs-identifier">HGeometry.Polygon.Convex.Tangents</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Polygon.Simple.Class</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">-- | Merging two convex hulls, based on the paper:</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- Two Algorithms for Constructing a Delaunay Triangulation</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- Lee and Schachter</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- International Journal of Computer and Information Sciences, Vol 9, No. 3, 1980</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- : (combined hull, lower tangent that was added, upper tangent that was</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- added)</span><span>
</span><span id="line-36"></span><span class="hs-comment">--</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- pre: - lp and rp are disjoint, and there is a vertical line separating</span><span>
</span><span id="line-38"></span><span class="hs-comment">--        the two polygons.</span><span>
</span><span id="line-39"></span><span class="hs-comment">--</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- Running time: O(n+m), where n and m are the sizes of the two polygons respectively</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- FIXME: This currently returns the VertexIx's in the *original* polygons, rather than</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- in the new polygon.</span><span>
</span><span id="line-44"></span><span id="local-6989586621679478427"><span id="local-6989586621679478428"><span id="local-6989586621679478429"><span class="annot"><a href="HGeometry.Polygon.Convex.Merge.html#merge"><span class="hs-identifier hs-type">merge</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConvexPolygon_</span></span><span> </span><span class="annot"><a href="#local-6989586621679478427"><span class="hs-identifier hs-type">convexPolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679478428"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679478429"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679478429"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679478429"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679478427"><span class="hs-identifier hs-type">convexPolygon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679478427"><span class="hs-identifier hs-type">convexPolygon</span></a></span><span>
</span><span id="line-46"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679478427"><span class="hs-identifier hs-type">convexPolygon</span></a></span><span>
</span><span id="line-47"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679478428"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679478427"><span class="hs-identifier hs-type">convexPolygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679478428"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#%3A%2B"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-type">VertexIx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679478427"><span class="hs-identifier hs-type">convexPolygon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>               </span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-50"></span><span id="merge"><span class="annot"><span class="annottext">merge :: forall convexPolygon point r.
(ConvexPolygon_ convexPolygon point r, Num r, Ord r) =&gt;
convexPolygon
-&gt; convexPolygon
-&gt; (convexPolygon,
    ClosedLineSegment (point :+ VertexIx convexPolygon),
    ClosedLineSegment (point :+ VertexIx convexPolygon))
</span><a href="HGeometry.Polygon.Convex.Merge.html#merge"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span id="local-6989586621679479158"><span class="annot"><span class="annottext">convexPolygon
</span><a href="#local-6989586621679479158"><span class="hs-identifier hs-var">lp</span></a></span></span><span> </span><span id="local-6989586621679479159"><span class="annot"><span class="annottext">convexPolygon
</span><a href="#local-6989586621679479159"><span class="hs-identifier hs-var">rp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty point -&gt; convexPolygon
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable1 f) =&gt;
f point -&gt; simplePolygon
forall (f :: * -&gt; *). Foldable1 f =&gt; f point -&gt; convexPolygon
</span><span class="hs-identifier hs-var">uncheckedFromCCWPoints</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty point -&gt; convexPolygon)
-&gt; NonEmpty point -&gt; convexPolygon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty point
NonEmpty (Vertex convexPolygon)
</span><a href="#local-6989586621679479161"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty point -&gt; NonEmpty point -&gt; NonEmpty point
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty point
NonEmpty (Vertex convexPolygon)
</span><a href="#local-6989586621679479162"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="#local-6989586621679479163"><span class="hs-identifier hs-var">lt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="#local-6989586621679479164"><span class="hs-identifier hs-var">ut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>    </span><span id="local-6989586621679479163"><span class="annot"><span class="annottext">lt :: ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="#local-6989586621679479163"><span class="hs-identifier hs-var hs-var">lt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">convexPolygon
-&gt; convexPolygon
-&gt; ClosedLineSegment (point :+ VertexIx convexPolygon)
forall r convexPolygon point.
(Num r, Ord r, ConvexPolygon_ convexPolygon point r,
 Point_ point 2 r) =&gt;
convexPolygon
-&gt; convexPolygon
-&gt; ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="HGeometry.Polygon.Convex.Tangents.html#lowerTangent"><span class="hs-identifier hs-var">lowerTangent</span></a></span><span> </span><span class="annot"><span class="annottext">convexPolygon
</span><a href="#local-6989586621679479158"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">convexPolygon
</span><a href="#local-6989586621679479159"><span class="hs-identifier hs-var">rp</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span id="local-6989586621679479164"><span class="annot"><span class="annottext">ut :: ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="#local-6989586621679479164"><span class="hs-identifier hs-var hs-var">ut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">convexPolygon
-&gt; convexPolygon
-&gt; ClosedLineSegment (point :+ VertexIx convexPolygon)
forall convexPolygon point r.
(Num r, Ord r, ConvexPolygon_ convexPolygon point r) =&gt;
convexPolygon
-&gt; convexPolygon
-&gt; ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="HGeometry.Polygon.Convex.Tangents.html#upperTangent"><span class="hs-identifier hs-var">upperTangent</span></a></span><span> </span><span class="annot"><span class="annottext">convexPolygon
</span><a href="#local-6989586621679479158"><span class="hs-identifier hs-var">lp</span></a></span><span> </span><span class="annot"><span class="annottext">convexPolygon
</span><a href="#local-6989586621679479159"><span class="hs-identifier hs-var">rp</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span id="local-6989586621679479161"><span class="annot"><span class="annottext">r' :: NonEmpty (Vertex convexPolygon)
</span><a href="#local-6989586621679479161"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexIx convexPolygon
-&gt; VertexIx convexPolygon
-&gt; convexPolygon
-&gt; NonEmpty (Vertex convexPolygon)
forall {s}.
(HasOuterBoundary s, Eq (VertexIx s)) =&gt;
VertexIx s -&gt; VertexIx s -&gt; s -&gt; NonEmpty (Vertex s)
</span><a href="#local-6989586621679479167"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ Int)
ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="#local-6989586621679479163"><span class="hs-identifier hs-var">lt</span></a></span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ Int)
-&gt; Getting Int (ClosedLineSegment (point :+ Int)) Int -&gt; Int
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">((point :+ Int) -&gt; Const Int (point :+ Int))
-&gt; ClosedLineSegment (point :+ Int)
-&gt; Const Int (ClosedLineSegment (point :+ Int))
forall seg p. HasEnd seg p =&gt; Lens' seg p
Lens' (ClosedLineSegment (point :+ Int)) (point :+ Int)
</span><span class="hs-identifier hs-var">end</span></span><span class="annot"><span class="annottext">(((point :+ Int) -&gt; Const Int (point :+ Int))
 -&gt; ClosedLineSegment (point :+ Int)
 -&gt; Const Int (ClosedLineSegment (point :+ Int)))
-&gt; ((Int -&gt; Const Int Int)
    -&gt; (point :+ Int) -&gt; Const Int (point :+ Int))
-&gt; Getting Int (ClosedLineSegment (point :+ Int)) Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Int -&gt; Const Int Int)
-&gt; (point :+ Int) -&gt; Const Int (point :+ Int)
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ Int)
ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="#local-6989586621679479164"><span class="hs-identifier hs-var">ut</span></a></span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ Int)
-&gt; Getting Int (ClosedLineSegment (point :+ Int)) Int -&gt; Int
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">((point :+ Int) -&gt; Const Int (point :+ Int))
-&gt; ClosedLineSegment (point :+ Int)
-&gt; Const Int (ClosedLineSegment (point :+ Int))
forall seg p. HasEnd seg p =&gt; Lens' seg p
Lens' (ClosedLineSegment (point :+ Int)) (point :+ Int)
</span><span class="hs-identifier hs-var">end</span></span><span class="annot"><span class="annottext">(((point :+ Int) -&gt; Const Int (point :+ Int))
 -&gt; ClosedLineSegment (point :+ Int)
 -&gt; Const Int (ClosedLineSegment (point :+ Int)))
-&gt; ((Int -&gt; Const Int Int)
    -&gt; (point :+ Int) -&gt; Const Int (point :+ Int))
-&gt; Getting Int (ClosedLineSegment (point :+ Int)) Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Int -&gt; Const Int Int)
-&gt; (point :+ Int) -&gt; Const Int (point :+ Int)
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">convexPolygon
</span><a href="#local-6989586621679479159"><span class="hs-identifier hs-var">rp</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621679479162"><span class="annot"><span class="annottext">l' :: NonEmpty (Vertex convexPolygon)
</span><a href="#local-6989586621679479162"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VertexIx convexPolygon
-&gt; VertexIx convexPolygon
-&gt; convexPolygon
-&gt; NonEmpty (Vertex convexPolygon)
forall {s}.
(HasOuterBoundary s, Eq (VertexIx s)) =&gt;
VertexIx s -&gt; VertexIx s -&gt; s -&gt; NonEmpty (Vertex s)
</span><a href="#local-6989586621679479167"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ Int)
ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="#local-6989586621679479164"><span class="hs-identifier hs-var">ut</span></a></span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ Int)
-&gt; Getting Int (ClosedLineSegment (point :+ Int)) Int -&gt; Int
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">((point :+ Int) -&gt; Const Int (point :+ Int))
-&gt; ClosedLineSegment (point :+ Int)
-&gt; Const Int (ClosedLineSegment (point :+ Int))
forall seg p. HasStart seg p =&gt; Lens' seg p
Lens' (ClosedLineSegment (point :+ Int)) (point :+ Int)
</span><span class="hs-identifier hs-var">start</span></span><span class="annot"><span class="annottext">(((point :+ Int) -&gt; Const Int (point :+ Int))
 -&gt; ClosedLineSegment (point :+ Int)
 -&gt; Const Int (ClosedLineSegment (point :+ Int)))
-&gt; ((Int -&gt; Const Int Int)
    -&gt; (point :+ Int) -&gt; Const Int (point :+ Int))
-&gt; Getting Int (ClosedLineSegment (point :+ Int)) Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Int -&gt; Const Int Int)
-&gt; (point :+ Int) -&gt; Const Int (point :+ Int)
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ Int)
ClosedLineSegment (point :+ VertexIx convexPolygon)
</span><a href="#local-6989586621679479163"><span class="hs-identifier hs-var">lt</span></a></span><span class="annot"><span class="annottext">ClosedLineSegment (point :+ Int)
-&gt; Getting Int (ClosedLineSegment (point :+ Int)) Int -&gt; Int
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">((point :+ Int) -&gt; Const Int (point :+ Int))
-&gt; ClosedLineSegment (point :+ Int)
-&gt; Const Int (ClosedLineSegment (point :+ Int))
forall seg p. HasStart seg p =&gt; Lens' seg p
Lens' (ClosedLineSegment (point :+ Int)) (point :+ Int)
</span><span class="hs-identifier hs-var">start</span></span><span class="annot"><span class="annottext">(((point :+ Int) -&gt; Const Int (point :+ Int))
 -&gt; ClosedLineSegment (point :+ Int)
 -&gt; Const Int (ClosedLineSegment (point :+ Int)))
-&gt; ((Int -&gt; Const Int Int)
    -&gt; (point :+ Int) -&gt; Const Int (point :+ Int))
-&gt; Getting Int (ClosedLineSegment (point :+ Int)) Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Int -&gt; Const Int Int)
-&gt; (point :+ Int) -&gt; Const Int (point :+ Int)
forall core extra extra' (f :: * -&gt; *).
Functor f =&gt;
(extra -&gt; f extra') -&gt; (core :+ extra) -&gt; f (core :+ extra')
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Ext.html/HGeometry.Ext.html#extra"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">convexPolygon
</span><a href="#local-6989586621679479158"><span class="hs-identifier hs-var">lp</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679479167"><span class="annot"><span class="annottext">slice :: VertexIx s -&gt; VertexIx s -&gt; s -&gt; NonEmpty (Vertex s)
</span><a href="#local-6989586621679479167"><span class="hs-identifier hs-var hs-var">slice</span></a></span></span><span> </span><span id="local-6989586621679479193"><span class="annot"><span class="annottext">VertexIx s
</span><a href="#local-6989586621679479193"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679479194"><span class="annot"><span class="annottext">VertexIx s
</span><a href="#local-6989586621679479194"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679479195"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679479195"><span class="hs-identifier hs-var">pg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((VertexIx s, Vertex s) -&gt; Vertex s)
-&gt; NonEmpty (VertexIx s, Vertex s) -&gt; NonEmpty (Vertex s)
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(VertexIx s, Vertex s) -&gt; Vertex s
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (VertexIx s, Vertex s) -&gt; NonEmpty (Vertex s))
-&gt; ([(VertexIx s, Vertex s)] -&gt; NonEmpty (VertexIx s, Vertex s))
-&gt; [(VertexIx s, Vertex s)]
-&gt; NonEmpty (Vertex s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((VertexIx s, Vertex s) -&gt; Bool)
-&gt; [(VertexIx s, Vertex s)] -&gt; NonEmpty (VertexIx s, Vertex s)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; NonEmpty a
</span><a href="HGeometry.Polygon.Convex.Merge.html#takeUntil"><span class="hs-identifier hs-var">takeUntil</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">VertexIx s -&gt; VertexIx s -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">VertexIx s
</span><a href="#local-6989586621679479194"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VertexIx s -&gt; Bool)
-&gt; ((VertexIx s, Vertex s) -&gt; VertexIx s)
-&gt; (VertexIx s, Vertex s)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(VertexIx s, Vertex s) -&gt; VertexIx s
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(VertexIx s, Vertex s)] -&gt; NonEmpty (Vertex s))
-&gt; [(VertexIx s, Vertex s)] -&gt; NonEmpty (Vertex s)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679479195"><span class="hs-identifier hs-var">pg</span></a></span><span class="annot"><span class="annottext">s
-&gt; Getting (Endo [(VertexIx s, Vertex s)]) s (VertexIx s, Vertex s)
-&gt; [(VertexIx s, Vertex s)]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">VertexIx s -&gt; IndexedTraversal1' (VertexIx s) s (Vertex s)
forall polygon.
HasOuterBoundary polygon =&gt;
VertexIx polygon
-&gt; IndexedTraversal1' (VertexIx polygon) polygon (Vertex polygon)
</span><span class="hs-identifier hs-var">ccwOuterBoundaryFrom</span></span><span> </span><span class="annot"><span class="annottext">VertexIx s
</span><a href="#local-6989586621679479193"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">(Indexed
   (VertexIx s)
   (Vertex s)
   (Const (Endo [(VertexIx s, Vertex s)]) (Vertex s))
 -&gt; s -&gt; Const (Endo [(VertexIx s, Vertex s)]) s)
-&gt; (((VertexIx s, Vertex s)
     -&gt; Const (Endo [(VertexIx s, Vertex s)]) (VertexIx s, Vertex s))
    -&gt; Indexed
         (VertexIx s)
         (Vertex s)
         (Const (Endo [(VertexIx s, Vertex s)]) (Vertex s)))
-&gt; Getting (Endo [(VertexIx s, Vertex s)]) s (VertexIx s, Vertex s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">((VertexIx s, Vertex s)
 -&gt; Const (Endo [(VertexIx s, Vertex s)]) (VertexIx s, Vertex s))
-&gt; Indexed
     (VertexIx s)
     (Vertex s)
     (Const (Endo [(VertexIx s, Vertex s)]) (Vertex s))
forall i (p :: * -&gt; * -&gt; *) (f :: * -&gt; *) s j t.
(Indexable i p, Functor f) =&gt;
p (i, s) (f (j, t)) -&gt; Indexed i s (f t)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.5-ea5aa937eedd0462f218acdbfc581f79beb571afb488c5dc937a3e109e6a2626/share/doc/html/src/Control.Lens.Internal.Indexed.html/Control.Lens.Internal.Indexed.html#withIndex"><span class="hs-identifier hs-var">withIndex</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | pre: predicate is true for at least one element.</span><span>
</span><span id="line-60"></span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &gt;&gt;&gt; takeUntil (== 5) [1..10]</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- 1 :| [2,3,4,5]</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- &gt;&gt;&gt; takeUntil even [1..10]</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- 1 :| [2]</span><span>
</span><span id="line-65"></span><span id="local-6989586621679478566"><span class="annot"><a href="HGeometry.Polygon.Convex.Merge.html#takeUntil"><span class="hs-identifier hs-type">takeUntil</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679478566"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679478566"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679478566"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-66"></span><span id="takeUntil"><span class="annot"><span class="annottext">takeUntil :: forall a. (a -&gt; Bool) -&gt; [a] -&gt; NonEmpty a
</span><a href="HGeometry.Polygon.Convex.Merge.html#takeUntil"><span class="hs-identifier hs-var hs-var">takeUntil</span></a></span></span><span> </span><span id="local-6989586621679479206"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679479206"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; NonEmpty a
forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; NonEmpty a) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; NonEmpty a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679479209"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679479209"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679479210"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679479210"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679479206"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679479209"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679479209"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679479209"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679479210"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>              </span><span class="hs-comment">-- precondition guarantees there is at least one elem in the output</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- takeUntil      :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- takeUntil p xs = let (xs',x:_) = break p xs in xs' &lt;&gt; [x]</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- rotateTo'   :: Eq a =&gt; (a :+ b) -&gt; CircularVector (a :+ b) -&gt; CircularVector (a :+ b)</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- rotateTo' x = fromJust . CV.findRotateTo (coreEq x)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- coreEq :: Eq a =&gt; (a :+ b) -&gt; (a :+ b) -&gt; Bool</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- coreEq = (==) `on` (^.core)</span><span>
</span><span id="line-79"></span></pre></body></html>