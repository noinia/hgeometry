<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  HGeometry.RangeTree.Base</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Range Tree implementation</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html"><span class="hs-identifier">HGeometry.RangeTree.Base</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier">RangeTree</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#buildRangeTree"><span class="hs-identifier">buildRangeTree</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#fromAscList"><span class="hs-identifier">fromAscList</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#fromGroupedAscList"><span class="hs-identifier">fromGroupedAscList</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#rangeQuery"><span class="hs-identifier">rangeQuery</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#query"><span class="hs-identifier">query</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Type.Ord</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-469fa586d848648e0ac6b4063215d74fc75db3883d0b743c4f65af91e864edda/share/doc/html/src/Data.Vector.html/Data.Vector.html"><span class="hs-identifier">Data.Vector</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Vector</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Sort.html/HGeometry.Foldable.Sort.html"><span class="hs-identifier">HGeometry.Foldable.Sort</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Interval</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Measured.html/HGeometry.Measured.html"><span class="hs-identifier">HGeometry.Measured</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Properties</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.SegmentTree.CanonicalSubSet.html"><span class="hs-identifier">HGeometry.SegmentTree.CanonicalSubSet</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html"><span class="hs-identifier">HGeometry.Tree.Binary.Static</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Vector.NonEmpty.Util.html/HGeometry.Vector.NonEmpty.Util.html"><span class="hs-identifier">HGeometry.Vector.NonEmpty.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><span class="hs-comment">-- | Type Representing a generic (1D) range-tree.</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">newtype</span><span> </span><span id="RangeTree"><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-var">RangeTree</span></a></span></span><span> </span><span id="local-6989586621679555607"><span class="annot"><a href="#local-6989586621679555607"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679555608"><span class="annot"><a href="#local-6989586621679555608"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RangeTree"><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-var">RangeTree</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#SubTree"><span class="hs-identifier hs-type">SubTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555607"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555608"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679555608"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span id="local-6989586621679555255"><span id="local-6989586621679555256"><span id="local-6989586621679555676"><span id="local-6989586621679555684"><span id="local-6989586621679555688"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555255"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555256"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679555256"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-type">RangeTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555255"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555256"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-45"></span><span id="local-6989586621679555273"><span id="local-6989586621679555274"><span id="local-6989586621679555697"><span id="local-6989586621679555704"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555273"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555274"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679555274"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-type">RangeTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555273"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555274"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><span class="hs-comment">-- | The actual tree type</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">type</span><span> </span><span id="SubTree"><span class="annot"><a href="HGeometry.RangeTree.Base.html#SubTree"><span class="hs-identifier hs-var">SubTree</span></a></span></span><span> </span><span id="local-6989586621679555714"><span class="annot"><a href="#local-6989586621679555714"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679555715"><span class="annot"><a href="#local-6989586621679555715"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span id="local-6989586621679555716"><span class="annot"><a href="#local-6989586621679555716"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#BinLeafTree"><span class="hs-identifier hs-type">BinLeafTree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-type">NodeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555714"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555715"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555716"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>                                     </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-type">LeafData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555714"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555715"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555716"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><span class="hs-comment">-- | Data stored at a leaf</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span> </span><span id="LeafData"><span class="annot"><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-var">LeafData</span></a></span></span><span> </span><span id="local-6989586621679555276"><span class="annot"><a href="#local-6989586621679555276"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679555277"><span class="annot"><a href="#local-6989586621679555277"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span id="local-6989586621679555278"><span class="annot"><a href="#local-6989586621679555278"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LeafData"><span class="annot"><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-var">LeafData</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_thePoint"><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (point :: k) r. LeafData f point r -&gt; r
</span><a href="HGeometry.RangeTree.Base.html#_thePoint"><span class="hs-identifier hs-var hs-var">_thePoint</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679555278"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-54"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span id="_leafCanonical"><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (point :: k) r.
LeafData f point r -&gt; f point
</span><a href="HGeometry.RangeTree.Base.html#_leafCanonical"><span class="hs-identifier hs-var hs-var">_leafCanonical</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555276"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555277"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>                                   </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679555723"><span id="local-6989586621679555728"><span id="local-6989586621679555731"><span class="annot"><span class="annottext">Int -&gt; LeafData f point r -&gt; ShowS
[LeafData f point r] -&gt; ShowS
LeafData f point r -&gt; String
(Int -&gt; LeafData f point r -&gt; ShowS)
-&gt; (LeafData f point r -&gt; String)
-&gt; ([LeafData f point r] -&gt; ShowS)
-&gt; Show (LeafData f point r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
Int -&gt; LeafData f point r -&gt; ShowS
forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
[LeafData f point r] -&gt; ShowS
forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
LeafData f point r -&gt; String
$cshowsPrec :: forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
Int -&gt; LeafData f point r -&gt; ShowS
showsPrec :: Int -&gt; LeafData f point r -&gt; ShowS
$cshow :: forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
LeafData f point r -&gt; String
show :: LeafData f point r -&gt; String
$cshowList :: forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
[LeafData f point r] -&gt; ShowS
showList :: [LeafData f point r] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555736"><span id="local-6989586621679555740"><span class="annot"><span class="annottext">LeafData f point r -&gt; LeafData f point r -&gt; Bool
(LeafData f point r -&gt; LeafData f point r -&gt; Bool)
-&gt; (LeafData f point r -&gt; LeafData f point r -&gt; Bool)
-&gt; Eq (LeafData f point r)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (f :: k -&gt; *) (point :: k) r.
(Eq r, Eq (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Bool
$c== :: forall k (f :: k -&gt; *) (point :: k) r.
(Eq r, Eq (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Bool
== :: LeafData f point r -&gt; LeafData f point r -&gt; Bool
$c/= :: forall k (f :: k -&gt; *) (point :: k) r.
(Eq r, Eq (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Bool
/= :: LeafData f point r -&gt; LeafData f point r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555749"><span id="local-6989586621679555753"><span id="local-6989586621679555757"><span id="local-6989586621679555761"><span id="local-6989586621679555764"><span id="local-6989586621679555767"><span id="local-6989586621679555770"><span class="annot"><span class="annottext">Eq (LeafData f point r)
Eq (LeafData f point r) =&gt;
(LeafData f point r -&gt; LeafData f point r -&gt; Ordering)
-&gt; (LeafData f point r -&gt; LeafData f point r -&gt; Bool)
-&gt; (LeafData f point r -&gt; LeafData f point r -&gt; Bool)
-&gt; (LeafData f point r -&gt; LeafData f point r -&gt; Bool)
-&gt; (LeafData f point r -&gt; LeafData f point r -&gt; Bool)
-&gt; (LeafData f point r -&gt; LeafData f point r -&gt; LeafData f point r)
-&gt; (LeafData f point r -&gt; LeafData f point r -&gt; LeafData f point r)
-&gt; Ord (LeafData f point r)
LeafData f point r -&gt; LeafData f point r -&gt; Bool
LeafData f point r -&gt; LeafData f point r -&gt; Ordering
LeafData f point r -&gt; LeafData f point r -&gt; LeafData f point r
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
Eq (LeafData f point r)
forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Bool
forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Ordering
forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; LeafData f point r
$ccompare :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Ordering
compare :: LeafData f point r -&gt; LeafData f point r -&gt; Ordering
$c&lt; :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Bool
&lt; :: LeafData f point r -&gt; LeafData f point r -&gt; Bool
$c&lt;= :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Bool
&lt;= :: LeafData f point r -&gt; LeafData f point r -&gt; Bool
$c&gt; :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Bool
&gt; :: LeafData f point r -&gt; LeafData f point r -&gt; Bool
$c&gt;= :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; Bool
&gt;= :: LeafData f point r -&gt; LeafData f point r -&gt; Bool
$cmax :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; LeafData f point r
max :: LeafData f point r -&gt; LeafData f point r -&gt; LeafData f point r
$cmin :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
LeafData f point r -&gt; LeafData f point r -&gt; LeafData f point r
min :: LeafData f point r -&gt; LeafData f point r -&gt; LeafData f point r
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555779"><span id="local-6989586621679555781"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; LeafData f point a -&gt; LeafData f point b)
-&gt; (forall a b. a -&gt; LeafData f point b -&gt; LeafData f point a)
-&gt; Functor (LeafData f point)
forall a b. a -&gt; LeafData f point b -&gt; LeafData f point a
forall a b. (a -&gt; b) -&gt; LeafData f point a -&gt; LeafData f point b
forall k (f :: k -&gt; *) (point :: k) a b.
a -&gt; LeafData f point b -&gt; LeafData f point a
forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b) -&gt; LeafData f point a -&gt; LeafData f point b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b) -&gt; LeafData f point a -&gt; LeafData f point b
fmap :: forall a b. (a -&gt; b) -&gt; LeafData f point a -&gt; LeafData f point b
$c&lt;$ :: forall k (f :: k -&gt; *) (point :: k) a b.
a -&gt; LeafData f point b -&gt; LeafData f point a
&lt;$ :: forall a b. a -&gt; LeafData f point b -&gt; LeafData f point a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555786"><span id="local-6989586621679555792"><span id="local-6989586621679555795"><span id="local-6989586621679555800"><span id="local-6989586621679555802"><span id="local-6989586621679555805"><span id="local-6989586621679555808"><span id="local-6989586621679555811"><span id="local-6989586621679555814"><span id="local-6989586621679555817"><span id="local-6989586621679555820"><span id="local-6989586621679555822"><span id="local-6989586621679555825"><span id="local-6989586621679555830"><span id="local-6989586621679555835"><span id="local-6989586621679555840"><span id="local-6989586621679555845"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; LeafData f point m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeafData f point a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeafData f point a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; LeafData f point a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; LeafData f point a -&gt; a)
-&gt; (forall a. LeafData f point a -&gt; [a])
-&gt; (forall a. LeafData f point a -&gt; Bool)
-&gt; (forall a. LeafData f point a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; LeafData f point a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; LeafData f point a -&gt; a)
-&gt; (forall a. Ord a =&gt; LeafData f point a -&gt; a)
-&gt; (forall a. Num a =&gt; LeafData f point a -&gt; a)
-&gt; (forall a. Num a =&gt; LeafData f point a -&gt; a)
-&gt; Foldable (LeafData f point)
forall a. Eq a =&gt; a -&gt; LeafData f point a -&gt; Bool
forall a. Num a =&gt; LeafData f point a -&gt; a
forall a. Ord a =&gt; LeafData f point a -&gt; a
forall m. Monoid m =&gt; LeafData f point m -&gt; m
forall a. LeafData f point a -&gt; Bool
forall a. LeafData f point a -&gt; Int
forall a. LeafData f point a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; LeafData f point a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeafData f point a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
forall k (f :: k -&gt; *) (point :: k) a.
Eq a =&gt;
a -&gt; LeafData f point a -&gt; Bool
forall k (f :: k -&gt; *) (point :: k) a.
Num a =&gt;
LeafData f point a -&gt; a
forall k (f :: k -&gt; *) (point :: k) a.
Ord a =&gt;
LeafData f point a -&gt; a
forall k (f :: k -&gt; *) (point :: k) m.
Monoid m =&gt;
LeafData f point m -&gt; m
forall k (f :: k -&gt; *) (point :: k) a. LeafData f point a -&gt; Bool
forall k (f :: k -&gt; *) (point :: k) a. LeafData f point a -&gt; Int
forall k (f :: k -&gt; *) (point :: k) a. LeafData f point a -&gt; [a]
forall k (f :: k -&gt; *) (point :: k) a.
(a -&gt; a -&gt; a) -&gt; LeafData f point a -&gt; a
forall k (f :: k -&gt; *) (point :: k) m a.
Monoid m =&gt;
(a -&gt; m) -&gt; LeafData f point a -&gt; m
forall k (f :: k -&gt; *) (point :: k) b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall k (f :: k -&gt; *) (point :: k) m.
Monoid m =&gt;
LeafData f point m -&gt; m
fold :: forall m. Monoid m =&gt; LeafData f point m -&gt; m
$cfoldMap :: forall k (f :: k -&gt; *) (point :: k) m a.
Monoid m =&gt;
(a -&gt; m) -&gt; LeafData f point a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeafData f point a -&gt; m
$cfoldMap' :: forall k (f :: k -&gt; *) (point :: k) m a.
Monoid m =&gt;
(a -&gt; m) -&gt; LeafData f point a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeafData f point a -&gt; m
$cfoldr :: forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
$cfoldr' :: forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
$cfoldl :: forall k (f :: k -&gt; *) (point :: k) b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
$cfoldl' :: forall k (f :: k -&gt; *) (point :: k) b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeafData f point a -&gt; b
$cfoldr1 :: forall k (f :: k -&gt; *) (point :: k) a.
(a -&gt; a -&gt; a) -&gt; LeafData f point a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; LeafData f point a -&gt; a
$cfoldl1 :: forall k (f :: k -&gt; *) (point :: k) a.
(a -&gt; a -&gt; a) -&gt; LeafData f point a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; LeafData f point a -&gt; a
$ctoList :: forall k (f :: k -&gt; *) (point :: k) a. LeafData f point a -&gt; [a]
toList :: forall a. LeafData f point a -&gt; [a]
$cnull :: forall k (f :: k -&gt; *) (point :: k) a. LeafData f point a -&gt; Bool
null :: forall a. LeafData f point a -&gt; Bool
$clength :: forall k (f :: k -&gt; *) (point :: k) a. LeafData f point a -&gt; Int
length :: forall a. LeafData f point a -&gt; Int
$celem :: forall k (f :: k -&gt; *) (point :: k) a.
Eq a =&gt;
a -&gt; LeafData f point a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; LeafData f point a -&gt; Bool
$cmaximum :: forall k (f :: k -&gt; *) (point :: k) a.
Ord a =&gt;
LeafData f point a -&gt; a
maximum :: forall a. Ord a =&gt; LeafData f point a -&gt; a
$cminimum :: forall k (f :: k -&gt; *) (point :: k) a.
Ord a =&gt;
LeafData f point a -&gt; a
minimum :: forall a. Ord a =&gt; LeafData f point a -&gt; a
$csum :: forall k (f :: k -&gt; *) (point :: k) a.
Num a =&gt;
LeafData f point a -&gt; a
sum :: forall a. Num a =&gt; LeafData f point a -&gt; a
$cproduct :: forall k (f :: k -&gt; *) (point :: k) a.
Num a =&gt;
LeafData f point a -&gt; a
product :: forall a. Num a =&gt; LeafData f point a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555858"><span id="local-6989586621679555863"><span id="local-6989586621679555869"><span id="local-6989586621679555874"><span class="annot"><span class="annottext">Functor (LeafData f point)
Foldable (LeafData f point)
(Functor (LeafData f point), Foldable (LeafData f point)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; LeafData f point a -&gt; f (LeafData f point b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    LeafData f point (f a) -&gt; f (LeafData f point a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; LeafData f point a -&gt; m (LeafData f point b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    LeafData f point (m a) -&gt; m (LeafData f point a))
-&gt; Traversable (LeafData f point)
forall k (f :: k -&gt; *) (point :: k). Functor (LeafData f point)
forall k (f :: k -&gt; *) (point :: k). Foldable (LeafData f point)
forall k (f :: k -&gt; *) (point :: k) (m :: * -&gt; *) a.
Monad m =&gt;
LeafData f point (m a) -&gt; m (LeafData f point a)
forall k (f :: k -&gt; *) (point :: k) (f :: * -&gt; *) a.
Applicative f =&gt;
LeafData f point (f a) -&gt; f (LeafData f point a)
forall k (f :: k -&gt; *) (point :: k) (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeafData f point a -&gt; m (LeafData f point b)
forall k (f :: k -&gt; *) (point :: k) (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeafData f point a -&gt; f (LeafData f point b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
LeafData f point (m a) -&gt; m (LeafData f point a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
LeafData f point (f a) -&gt; f (LeafData f point a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeafData f point a -&gt; m (LeafData f point b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeafData f point a -&gt; f (LeafData f point b)
$ctraverse :: forall k (f :: k -&gt; *) (point :: k) (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeafData f point a -&gt; f (LeafData f point b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeafData f point a -&gt; f (LeafData f point b)
$csequenceA :: forall k (f :: k -&gt; *) (point :: k) (f :: * -&gt; *) a.
Applicative f =&gt;
LeafData f point (f a) -&gt; f (LeafData f point a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
LeafData f point (f a) -&gt; f (LeafData f point a)
$cmapM :: forall k (f :: k -&gt; *) (point :: k) (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeafData f point a -&gt; m (LeafData f point b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeafData f point a -&gt; m (LeafData f point b)
$csequence :: forall k (f :: k -&gt; *) (point :: k) (m :: * -&gt; *) a.
Monad m =&gt;
LeafData f point (m a) -&gt; m (LeafData f point a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
LeafData f point (m a) -&gt; m (LeafData f point a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><span class="hs-comment">-- | Access the point stored in this leaf.</span></span><span>
</span><span id="line-58"></span><span id="local-6989586621679555368"><span id="local-6989586621679555369"><span id="local-6989586621679555370"><span id="local-6989586621679555371"><span class="annot"><a href="HGeometry.RangeTree.Base.html#thePoint"><span class="hs-identifier hs-type">thePoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-type">LeafData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555370"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555371"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555368"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-type">LeafData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555370"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555371"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555369"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679555368"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555369"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span><span>
</span><span id="line-59"></span><span id="thePoint"><span class="annot"><span class="annottext">thePoint :: forall {k} (f :: k -&gt; *) (point :: k) r s (f :: * -&gt; *).
Functor f =&gt;
(r -&gt; f s) -&gt; LeafData f point r -&gt; f (LeafData f point s)
</span><a href="HGeometry.RangeTree.Base.html#thePoint"><span class="hs-identifier hs-var hs-var">thePoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LeafData f point r -&gt; r)
-&gt; (LeafData f point r -&gt; s -&gt; LeafData f point s)
-&gt; Lens (LeafData f point r) (LeafData f point s) r s
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">LeafData f point r -&gt; r
forall {k} (f :: k -&gt; *) (point :: k) r. LeafData f point r -&gt; r
</span><a href="HGeometry.RangeTree.Base.html#_thePoint"><span class="hs-identifier hs-var">_thePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679555885"><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679555885"><span class="hs-identifier hs-var">ld</span></a></span></span><span> </span><span id="local-6989586621679555886"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679555886"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679555885"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#_thePoint"><span class="hs-identifier hs-var">_thePoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679555886"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679555396"><span id="local-6989586621679555397"><span id="local-6989586621679555398"><span id="local-6989586621679555399"><span class="annot"><a href="HGeometry.SegmentTree.CanonicalSubSet.html#HasCanonicalSubSet"><span class="hs-identifier hs-type">HasCanonicalSubSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-type">LeafData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555396"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555397"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555398"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-type">LeafData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555399"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555397"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555398"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679555397"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555396"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555399"><span class="hs-identifier hs-type">g</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679555892"><span class="annot"><span class="annottext">canonicalSubSet :: Lens (LeafData f point r) (LeafData g point r) (f point) (g point)
</span><a href="#local-6989586621679555892"><span class="hs-identifier hs-var hs-var hs-var">canonicalSubSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LeafData f point r -&gt; f point)
-&gt; (LeafData f point r -&gt; g point -&gt; LeafData g point r)
-&gt; Lens
     (LeafData f point r) (LeafData g point r) (f point) (g point)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">LeafData f point r -&gt; f point
forall {k} (f :: k -&gt; *) (point :: k) r.
LeafData f point r -&gt; f point
</span><a href="HGeometry.RangeTree.Base.html#_leafCanonical"><span class="hs-identifier hs-var">_leafCanonical</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-type">LeafData</span></a></span><span> </span><span id="local-6989586621679555894"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679555894"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">f point
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679555895"><span class="annot"><span class="annottext">g point
</span><a href="#local-6989586621679555895"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; g point -&gt; LeafData g point r
forall {k} (f :: k -&gt; *) (point :: k) r.
r -&gt; f point -&gt; LeafData f point r
</span><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-var">LeafData</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679555894"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">g point
</span><a href="#local-6989586621679555895"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">-- | The data stored at an internal node.</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">data</span><span> </span><span id="NodeData"><span class="annot"><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-var">NodeData</span></a></span></span><span> </span><span id="local-6989586621679555402"><span class="annot"><a href="#local-6989586621679555402"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679555403"><span class="annot"><a href="#local-6989586621679555403"><span class="hs-identifier hs-type">point</span></a></span></span><span> </span><span id="local-6989586621679555404"><span class="annot"><a href="#local-6989586621679555404"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NodeData"><span class="annot"><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-var">NodeData</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_split"><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (point :: k) r. NodeData f point r -&gt; r
</span><a href="HGeometry.RangeTree.Base.html#_split"><span class="hs-identifier hs-var hs-var">_split</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679555404"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-66"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span id="_canonicalSubSet"><span class="annot"><span class="annottext">forall {k} (f :: k -&gt; *) (point :: k) r.
NodeData f point r -&gt; f point
</span><a href="HGeometry.RangeTree.Base.html#_canonicalSubSet"><span class="hs-identifier hs-var hs-var">_canonicalSubSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555402"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555403"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>                                   </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679555902"><span id="local-6989586621679555907"><span id="local-6989586621679555910"><span class="annot"><span class="annottext">Int -&gt; NodeData f point r -&gt; ShowS
[NodeData f point r] -&gt; ShowS
NodeData f point r -&gt; String
(Int -&gt; NodeData f point r -&gt; ShowS)
-&gt; (NodeData f point r -&gt; String)
-&gt; ([NodeData f point r] -&gt; ShowS)
-&gt; Show (NodeData f point r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
Int -&gt; NodeData f point r -&gt; ShowS
forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
[NodeData f point r] -&gt; ShowS
forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
NodeData f point r -&gt; String
$cshowsPrec :: forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
Int -&gt; NodeData f point r -&gt; ShowS
showsPrec :: Int -&gt; NodeData f point r -&gt; ShowS
$cshow :: forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
NodeData f point r -&gt; String
show :: NodeData f point r -&gt; String
$cshowList :: forall k (f :: k -&gt; *) (point :: k) r.
(Show r, Show (f point)) =&gt;
[NodeData f point r] -&gt; ShowS
showList :: [NodeData f point r] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555915"><span id="local-6989586621679555919"><span class="annot"><span class="annottext">NodeData f point r -&gt; NodeData f point r -&gt; Bool
(NodeData f point r -&gt; NodeData f point r -&gt; Bool)
-&gt; (NodeData f point r -&gt; NodeData f point r -&gt; Bool)
-&gt; Eq (NodeData f point r)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall k (f :: k -&gt; *) (point :: k) r.
(Eq r, Eq (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Bool
$c== :: forall k (f :: k -&gt; *) (point :: k) r.
(Eq r, Eq (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Bool
== :: NodeData f point r -&gt; NodeData f point r -&gt; Bool
$c/= :: forall k (f :: k -&gt; *) (point :: k) r.
(Eq r, Eq (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Bool
/= :: NodeData f point r -&gt; NodeData f point r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555928"><span id="local-6989586621679555932"><span id="local-6989586621679555936"><span id="local-6989586621679555940"><span id="local-6989586621679555943"><span id="local-6989586621679555946"><span id="local-6989586621679555949"><span class="annot"><span class="annottext">Eq (NodeData f point r)
Eq (NodeData f point r) =&gt;
(NodeData f point r -&gt; NodeData f point r -&gt; Ordering)
-&gt; (NodeData f point r -&gt; NodeData f point r -&gt; Bool)
-&gt; (NodeData f point r -&gt; NodeData f point r -&gt; Bool)
-&gt; (NodeData f point r -&gt; NodeData f point r -&gt; Bool)
-&gt; (NodeData f point r -&gt; NodeData f point r -&gt; Bool)
-&gt; (NodeData f point r -&gt; NodeData f point r -&gt; NodeData f point r)
-&gt; (NodeData f point r -&gt; NodeData f point r -&gt; NodeData f point r)
-&gt; Ord (NodeData f point r)
NodeData f point r -&gt; NodeData f point r -&gt; Bool
NodeData f point r -&gt; NodeData f point r -&gt; Ordering
NodeData f point r -&gt; NodeData f point r -&gt; NodeData f point r
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
Eq (NodeData f point r)
forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Bool
forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Ordering
forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; NodeData f point r
$ccompare :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Ordering
compare :: NodeData f point r -&gt; NodeData f point r -&gt; Ordering
$c&lt; :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Bool
&lt; :: NodeData f point r -&gt; NodeData f point r -&gt; Bool
$c&lt;= :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Bool
&lt;= :: NodeData f point r -&gt; NodeData f point r -&gt; Bool
$c&gt; :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Bool
&gt; :: NodeData f point r -&gt; NodeData f point r -&gt; Bool
$c&gt;= :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; Bool
&gt;= :: NodeData f point r -&gt; NodeData f point r -&gt; Bool
$cmax :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; NodeData f point r
max :: NodeData f point r -&gt; NodeData f point r -&gt; NodeData f point r
$cmin :: forall k (f :: k -&gt; *) (point :: k) r.
(Ord r, Ord (f point)) =&gt;
NodeData f point r -&gt; NodeData f point r -&gt; NodeData f point r
min :: NodeData f point r -&gt; NodeData f point r -&gt; NodeData f point r
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555952"><span id="local-6989586621679555954"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; NodeData f point a -&gt; NodeData f point b)
-&gt; (forall a b. a -&gt; NodeData f point b -&gt; NodeData f point a)
-&gt; Functor (NodeData f point)
forall a b. a -&gt; NodeData f point b -&gt; NodeData f point a
forall a b. (a -&gt; b) -&gt; NodeData f point a -&gt; NodeData f point b
forall k (f :: k -&gt; *) (point :: k) a b.
a -&gt; NodeData f point b -&gt; NodeData f point a
forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b) -&gt; NodeData f point a -&gt; NodeData f point b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b) -&gt; NodeData f point a -&gt; NodeData f point b
fmap :: forall a b. (a -&gt; b) -&gt; NodeData f point a -&gt; NodeData f point b
$c&lt;$ :: forall k (f :: k -&gt; *) (point :: k) a b.
a -&gt; NodeData f point b -&gt; NodeData f point a
&lt;$ :: forall a b. a -&gt; NodeData f point b -&gt; NodeData f point a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679555957"><span id="local-6989586621679555963"><span id="local-6989586621679555966"><span id="local-6989586621679555971"><span id="local-6989586621679555973"><span id="local-6989586621679555976"><span id="local-6989586621679555979"><span id="local-6989586621679555982"><span id="local-6989586621679555985"><span id="local-6989586621679555988"><span id="local-6989586621679555991"><span id="local-6989586621679555993"><span id="local-6989586621679555996"><span id="local-6989586621679556001"><span id="local-6989586621679556006"><span id="local-6989586621679556011"><span id="local-6989586621679556016"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; NodeData f point m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; NodeData f point a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; NodeData f point a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; NodeData f point a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; NodeData f point a -&gt; a)
-&gt; (forall a. NodeData f point a -&gt; [a])
-&gt; (forall a. NodeData f point a -&gt; Bool)
-&gt; (forall a. NodeData f point a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; NodeData f point a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; NodeData f point a -&gt; a)
-&gt; (forall a. Ord a =&gt; NodeData f point a -&gt; a)
-&gt; (forall a. Num a =&gt; NodeData f point a -&gt; a)
-&gt; (forall a. Num a =&gt; NodeData f point a -&gt; a)
-&gt; Foldable (NodeData f point)
forall a. Eq a =&gt; a -&gt; NodeData f point a -&gt; Bool
forall a. Num a =&gt; NodeData f point a -&gt; a
forall a. Ord a =&gt; NodeData f point a -&gt; a
forall m. Monoid m =&gt; NodeData f point m -&gt; m
forall a. NodeData f point a -&gt; Bool
forall a. NodeData f point a -&gt; Int
forall a. NodeData f point a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; NodeData f point a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; NodeData f point a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
forall k (f :: k -&gt; *) (point :: k) a.
Eq a =&gt;
a -&gt; NodeData f point a -&gt; Bool
forall k (f :: k -&gt; *) (point :: k) a.
Num a =&gt;
NodeData f point a -&gt; a
forall k (f :: k -&gt; *) (point :: k) a.
Ord a =&gt;
NodeData f point a -&gt; a
forall k (f :: k -&gt; *) (point :: k) m.
Monoid m =&gt;
NodeData f point m -&gt; m
forall k (f :: k -&gt; *) (point :: k) a. NodeData f point a -&gt; Bool
forall k (f :: k -&gt; *) (point :: k) a. NodeData f point a -&gt; Int
forall k (f :: k -&gt; *) (point :: k) a. NodeData f point a -&gt; [a]
forall k (f :: k -&gt; *) (point :: k) a.
(a -&gt; a -&gt; a) -&gt; NodeData f point a -&gt; a
forall k (f :: k -&gt; *) (point :: k) m a.
Monoid m =&gt;
(a -&gt; m) -&gt; NodeData f point a -&gt; m
forall k (f :: k -&gt; *) (point :: k) b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall k (f :: k -&gt; *) (point :: k) m.
Monoid m =&gt;
NodeData f point m -&gt; m
fold :: forall m. Monoid m =&gt; NodeData f point m -&gt; m
$cfoldMap :: forall k (f :: k -&gt; *) (point :: k) m a.
Monoid m =&gt;
(a -&gt; m) -&gt; NodeData f point a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; NodeData f point a -&gt; m
$cfoldMap' :: forall k (f :: k -&gt; *) (point :: k) m a.
Monoid m =&gt;
(a -&gt; m) -&gt; NodeData f point a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; NodeData f point a -&gt; m
$cfoldr :: forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
$cfoldr' :: forall k (f :: k -&gt; *) (point :: k) a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
$cfoldl :: forall k (f :: k -&gt; *) (point :: k) b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
$cfoldl' :: forall k (f :: k -&gt; *) (point :: k) b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; NodeData f point a -&gt; b
$cfoldr1 :: forall k (f :: k -&gt; *) (point :: k) a.
(a -&gt; a -&gt; a) -&gt; NodeData f point a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; NodeData f point a -&gt; a
$cfoldl1 :: forall k (f :: k -&gt; *) (point :: k) a.
(a -&gt; a -&gt; a) -&gt; NodeData f point a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; NodeData f point a -&gt; a
$ctoList :: forall k (f :: k -&gt; *) (point :: k) a. NodeData f point a -&gt; [a]
toList :: forall a. NodeData f point a -&gt; [a]
$cnull :: forall k (f :: k -&gt; *) (point :: k) a. NodeData f point a -&gt; Bool
null :: forall a. NodeData f point a -&gt; Bool
$clength :: forall k (f :: k -&gt; *) (point :: k) a. NodeData f point a -&gt; Int
length :: forall a. NodeData f point a -&gt; Int
$celem :: forall k (f :: k -&gt; *) (point :: k) a.
Eq a =&gt;
a -&gt; NodeData f point a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; NodeData f point a -&gt; Bool
$cmaximum :: forall k (f :: k -&gt; *) (point :: k) a.
Ord a =&gt;
NodeData f point a -&gt; a
maximum :: forall a. Ord a =&gt; NodeData f point a -&gt; a
$cminimum :: forall k (f :: k -&gt; *) (point :: k) a.
Ord a =&gt;
NodeData f point a -&gt; a
minimum :: forall a. Ord a =&gt; NodeData f point a -&gt; a
$csum :: forall k (f :: k -&gt; *) (point :: k) a.
Num a =&gt;
NodeData f point a -&gt; a
sum :: forall a. Num a =&gt; NodeData f point a -&gt; a
$cproduct :: forall k (f :: k -&gt; *) (point :: k) a.
Num a =&gt;
NodeData f point a -&gt; a
product :: forall a. Num a =&gt; NodeData f point a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679556025"><span id="local-6989586621679556030"><span id="local-6989586621679556036"><span id="local-6989586621679556041"><span class="annot"><span class="annottext">Functor (NodeData f point)
Foldable (NodeData f point)
(Functor (NodeData f point), Foldable (NodeData f point)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; NodeData f point a -&gt; f (NodeData f point b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    NodeData f point (f a) -&gt; f (NodeData f point a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; NodeData f point a -&gt; m (NodeData f point b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    NodeData f point (m a) -&gt; m (NodeData f point a))
-&gt; Traversable (NodeData f point)
forall k (f :: k -&gt; *) (point :: k). Functor (NodeData f point)
forall k (f :: k -&gt; *) (point :: k). Foldable (NodeData f point)
forall k (f :: k -&gt; *) (point :: k) (m :: * -&gt; *) a.
Monad m =&gt;
NodeData f point (m a) -&gt; m (NodeData f point a)
forall k (f :: k -&gt; *) (point :: k) (f :: * -&gt; *) a.
Applicative f =&gt;
NodeData f point (f a) -&gt; f (NodeData f point a)
forall k (f :: k -&gt; *) (point :: k) (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NodeData f point a -&gt; m (NodeData f point b)
forall k (f :: k -&gt; *) (point :: k) (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NodeData f point a -&gt; f (NodeData f point b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
NodeData f point (m a) -&gt; m (NodeData f point a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
NodeData f point (f a) -&gt; f (NodeData f point a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NodeData f point a -&gt; m (NodeData f point b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NodeData f point a -&gt; f (NodeData f point b)
$ctraverse :: forall k (f :: k -&gt; *) (point :: k) (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NodeData f point a -&gt; f (NodeData f point b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NodeData f point a -&gt; f (NodeData f point b)
$csequenceA :: forall k (f :: k -&gt; *) (point :: k) (f :: * -&gt; *) a.
Applicative f =&gt;
NodeData f point (f a) -&gt; f (NodeData f point a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
NodeData f point (f a) -&gt; f (NodeData f point a)
$cmapM :: forall k (f :: k -&gt; *) (point :: k) (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NodeData f point a -&gt; m (NodeData f point b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NodeData f point a -&gt; m (NodeData f point b)
$csequence :: forall k (f :: k -&gt; *) (point :: k) (m :: * -&gt; *) a.
Monad m =&gt;
NodeData f point (m a) -&gt; m (NodeData f point a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
NodeData f point (m a) -&gt; m (NodeData f point a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><span class="hs-comment">-- | Access the split value of a NodeData</span></span><span>
</span><span id="line-70"></span><span id="local-6989586621679555460"><span id="local-6989586621679555461"><span id="local-6989586621679555462"><span id="local-6989586621679555463"><span class="annot"><a href="HGeometry.RangeTree.Base.html#split"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-type">NodeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555462"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555463"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555460"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-type">NodeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555462"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555463"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555461"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679555460"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555461"><span class="hs-identifier hs-type">s</span></a></span></span></span></span></span><span>
</span><span id="line-71"></span><span id="split"><span class="annot"><span class="annottext">split :: forall {k} (f :: k -&gt; *) (point :: k) r s (f :: * -&gt; *).
Functor f =&gt;
(r -&gt; f s) -&gt; NodeData f point r -&gt; f (NodeData f point s)
</span><a href="HGeometry.RangeTree.Base.html#split"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeData f point r -&gt; r)
-&gt; (NodeData f point r -&gt; s -&gt; NodeData f point s)
-&gt; Lens (NodeData f point r) (NodeData f point s) r s
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">NodeData f point r -&gt; r
forall {k} (f :: k -&gt; *) (point :: k) r. NodeData f point r -&gt; r
</span><a href="HGeometry.RangeTree.Base.html#_split"><span class="hs-identifier hs-var">_split</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679556048"><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556048"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679556049"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679556049"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556048"><span class="hs-identifier hs-var">nd</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#_split"><span class="hs-identifier hs-var">_split</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679556049"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679555476"><span id="local-6989586621679555477"><span id="local-6989586621679555478"><span id="local-6989586621679555479"><span class="annot"><a href="HGeometry.SegmentTree.CanonicalSubSet.html#HasCanonicalSubSet"><span class="hs-identifier hs-type">HasCanonicalSubSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-type">NodeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555476"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555477"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555478"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-type">NodeData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555479"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555477"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555478"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679555477"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555476"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555479"><span class="hs-identifier hs-type">g</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679556054"><span class="annot"><span class="annottext">canonicalSubSet :: Lens (NodeData f point r) (NodeData g point r) (f point) (g point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var hs-var hs-var">canonicalSubSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NodeData f point r -&gt; f point)
-&gt; (NodeData f point r -&gt; g point -&gt; NodeData g point r)
-&gt; Lens
     (NodeData f point r) (NodeData g point r) (f point) (g point)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">NodeData f point r -&gt; f point
forall {k} (f :: k -&gt; *) (point :: k) r.
NodeData f point r -&gt; f point
</span><a href="HGeometry.RangeTree.Base.html#_canonicalSubSet"><span class="hs-identifier hs-var">_canonicalSubSet</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-type">NodeData</span></a></span><span> </span><span id="local-6989586621679556055"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679556055"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">f point
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679556056"><span class="annot"><span class="annottext">g point
</span><a href="#local-6989586621679556056"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r -&gt; g point -&gt; NodeData g point r
forall {k} (f :: k -&gt; *) (point :: k) r.
r -&gt; f point -&gt; NodeData f point r
</span><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-var">NodeData</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679556055"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">g point
</span><a href="#local-6989586621679556056"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679555486"><span id="local-6989586621679555487"><span id="local-6989586621679555488"><span class="annot"><a href="HGeometry.SegmentTree.CanonicalSubSet.html#HasCanonicalSubSet"><span class="hs-identifier hs-type">HasCanonicalSubSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#SubTree"><span class="hs-identifier hs-type">SubTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555486"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555487"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555488"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#SubTree"><span class="hs-identifier hs-type">SubTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555486"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555487"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555488"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679555487"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555486"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555486"><span class="hs-identifier hs-type">f</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">-- | Sets the node data of the root</span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679556063"><span class="annot"><span class="annottext">canonicalSubSet :: Lens (SubTree f point r) (SubTree f point r) (f point) (f point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var hs-var hs-var">canonicalSubSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SubTree f point r -&gt; f point)
-&gt; (SubTree f point r -&gt; f point -&gt; SubTree f point r)
-&gt; Lens (SubTree f point r) (SubTree f point r) (f point) (f point)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">SubTree f point r -&gt; f point
</span><a href="#local-6989586621679556064"><span class="hs-identifier hs-var">get''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f point -&gt; SubTree f point r -&gt; SubTree f point r)
-&gt; SubTree f point r -&gt; f point -&gt; SubTree f point r
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">f point -&gt; SubTree f point r -&gt; SubTree f point r
forall {k} {a} {a :: k} {f :: k -&gt; *} {g :: k -&gt; *} {a}
       {f :: k -&gt; *}.
(HasCanonicalSubSet a a a f g, HasCanonicalSubSet a a a f g) =&gt;
g a -&gt; BinLeafTree a a -&gt; BinLeafTree a a
</span><a href="#local-6989586621679556066"><span class="hs-identifier hs-var">set''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>      </span><span id="local-6989586621679556064"><span class="annot"><span class="annottext">get'' :: SubTree f point r -&gt; f point
</span><a href="#local-6989586621679556064"><span class="hs-identifier hs-var hs-var">get''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679556073"><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556073"><span class="hs-identifier hs-var">ld</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556073"><span class="hs-identifier hs-var">ld</span></a></span><span class="annot"><span class="annottext">LeafData f point r
-&gt; Getting (f point) (LeafData f point r) (f point) -&gt; f point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (f point) (LeafData f point r) (f point)
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens (LeafData f point r) (LeafData f point r) (f point) (f point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><span class="annottext">SubTree f point r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679556076"><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556076"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span class="annot"><span class="annottext">SubTree f point r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556076"><span class="hs-identifier hs-var">nd</span></a></span><span class="annot"><span class="annottext">NodeData f point r
-&gt; Getting (f point) (NodeData f point r) (f point) -&gt; f point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (f point) (NodeData f point r) (f point)
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens (NodeData f point r) (NodeData f point r) (f point) (f point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span>
</span><span id="line-83"></span><span>      </span><span id="local-6989586621679556066"><span class="annot"><span class="annottext">set'' :: g a -&gt; BinLeafTree a a -&gt; BinLeafTree a a
</span><a href="#local-6989586621679556066"><span class="hs-identifier hs-var hs-var">set''</span></a></span></span><span> </span><span id="local-6989586621679556084"><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679556084"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679556085"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679556085"><span class="hs-identifier hs-var">ld</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; BinLeafTree a a
forall v a. a -&gt; BinLeafTree v a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-var">Leaf</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; BinLeafTree a a) -&gt; a -&gt; BinLeafTree a a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679556085"><span class="hs-identifier hs-var">ld</span></a></span><span class="annot"><span class="annottext">a -&gt; (a -&gt; a) -&gt; a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(f a -&gt; Identity (g a)) -&gt; a -&gt; Identity a
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens a a (f a) (g a)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span> </span><span class="annot"><span class="annottext">((f a -&gt; Identity (g a)) -&gt; a -&gt; Identity a) -&gt; g a -&gt; a -&gt; a
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679556084"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679556088"><span class="annot"><span class="annottext">BinLeafTree a a
</span><a href="#local-6989586621679556088"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679556089"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679556089"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679556090"><span class="annot"><span class="annottext">BinLeafTree a a
</span><a href="#local-6989586621679556090"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinLeafTree a a -&gt; a -&gt; BinLeafTree a a -&gt; BinLeafTree a a
forall v a.
BinLeafTree v a -&gt; v -&gt; BinLeafTree v a -&gt; BinLeafTree v a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree a a
</span><a href="#local-6989586621679556088"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679556089"><span class="hs-identifier hs-var">nd</span></a></span><span class="annot"><span class="annottext">a -&gt; (a -&gt; a) -&gt; a
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(f a -&gt; Identity (g a)) -&gt; a -&gt; Identity a
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens a a (f a) (g a)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span> </span><span class="annot"><span class="annottext">((f a -&gt; Identity (g a)) -&gt; a -&gt; Identity a) -&gt; g a -&gt; a -&gt; a
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">g a
</span><a href="#local-6989586621679556084"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BinLeafTree a a
</span><a href="#local-6989586621679556090"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Construct a rangetree on n points.</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- \(O(n\log n)\)</span><span>
</span><span id="line-91"></span><span id="local-6989586621679555521"><span id="local-6989586621679555523"><span id="local-6989586621679555524"><span id="local-6989586621679555525"><span id="local-6989586621679555528"><span class="annot"><a href="HGeometry.RangeTree.Base.html#buildRangeTree"><span class="hs-identifier hs-type">buildRangeTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679555521"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679555523"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555524"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555525"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679555525"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679555524"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-92"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555528"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555523"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Measured.Class.html/HGeometry.Measured.Class.html#Measured"><span class="hs-identifier hs-type">Measured</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555528"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555523"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-93"></span><span>                  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679555521"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555523"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-type">RangeTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555528"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555523"><span class="hs-identifier hs-type">point</span></a></span></span></span></span></span></span><span>
</span><span id="line-94"></span><span id="buildRangeTree"><span class="annot"><span class="annottext">buildRangeTree :: forall (g :: * -&gt; *) point (d :: Nat) r (f :: * -&gt; *).
(Foldable1 g, Point_ point d r, Ord r, 1 &lt;= d, Semigroup (f point),
 Measured f point) =&gt;
g point -&gt; RangeTree f point
</span><a href="HGeometry.RangeTree.Base.html#buildRangeTree"><span class="hs-identifier hs-var hs-var">buildRangeTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (NonEmpty point) -&gt; RangeTree f point
forall (g :: * -&gt; *) (h :: * -&gt; *) point (d :: Nat) r
       (f :: * -&gt; *).
(Foldable1 g, Foldable1 h, Point_ point d r, 1 &lt;= d,
 Semigroup (f point), Measured f point) =&gt;
g (h point) -&gt; RangeTree f point
</span><a href="HGeometry.RangeTree.Base.html#fromGroupedAscList"><span class="hs-identifier hs-var">fromGroupedAscList</span></a></span><span>
</span><span id="line-95"></span><span>               </span><span class="annot"><span class="annottext">(NonEmpty (NonEmpty point) -&gt; RangeTree f point)
-&gt; (g point -&gt; NonEmpty (NonEmpty point))
-&gt; g point
-&gt; RangeTree f point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(point -&gt; r) -&gt; NonEmpty point -&gt; NonEmpty (NonEmpty point)
forall b a. Eq b =&gt; (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty (NonEmpty a)
</span><span class="hs-identifier hs-var">NonEmpty.groupWith1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; Getting r point r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r point r
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point r
</span><span class="hs-identifier hs-var">xCoord</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>               </span><span class="annot"><span class="annottext">(NonEmpty point -&gt; NonEmpty (NonEmpty point))
-&gt; (g point -&gt; NonEmpty point)
-&gt; g point
-&gt; NonEmpty (NonEmpty point)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[point] -&gt; NonEmpty point
forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">([point] -&gt; NonEmpty point)
-&gt; (g point -&gt; [point]) -&gt; g point -&gt; NonEmpty point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Vector point -&gt; [point]
forall a. Vector a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/vector-0.13.2.0-469fa586d848648e0ac6b4063215d74fc75db3883d0b743c4f65af91e864edda/share/doc/html/src/Data.Vector.html/Data.Vector.html#toList"><span class="hs-identifier hs-var">Vector.toList</span></a></span><span>
</span><span id="line-97"></span><span>               </span><span class="annot"><span class="annottext">(Vector point -&gt; [point])
-&gt; (g point -&gt; Vector point) -&gt; g point -&gt; [point]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(point -&gt; r) -&gt; g point -&gt; Vector point
forall (vector :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable f, Vector vector a, Ord b) =&gt;
(a -&gt; b) -&gt; f a -&gt; vector a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Sort.html/HGeometry.Foldable.Sort.html#sortOnCheap"><span class="hs-identifier hs-var">sortOnCheap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; Getting r point r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r point r
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point r
</span><span class="hs-identifier hs-var">xCoord</span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Given the points in sorted order, builds the range tree.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- The running time and space depends on the monoid used. In particlar, we use (&lt;&gt;) at</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- every internal node.</span><span>
</span><span id="line-103"></span><span id="local-6989586621679555590"><span id="local-6989586621679555591"><span id="local-6989586621679555592"><span id="local-6989586621679555593"><span id="local-6989586621679555594"><span class="annot"><a href="HGeometry.RangeTree.Base.html#fromAscList"><span class="hs-identifier hs-type">fromAscList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679555590"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679555590"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679555591"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555592"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555593"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679555592"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-104"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555594"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555591"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Measured.Class.html/HGeometry.Measured.Class.html#Measured"><span class="hs-identifier hs-type">Measured</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555594"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555591"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-105"></span><span>               </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679555590"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555591"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-type">RangeTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555594"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555591"><span class="hs-identifier hs-type">point</span></a></span></span></span></span></span></span><span>
</span><span id="line-106"></span><span id="fromAscList"><span class="annot"><span class="annottext">fromAscList :: forall (g :: * -&gt; *) point (d :: Nat) r (f :: * -&gt; *).
(Foldable1 g, Functor g, Point_ point d r, 1 &lt;= d,
 Semigroup (f point), Measured f point) =&gt;
g point -&gt; RangeTree f point
</span><a href="HGeometry.RangeTree.Base.html#fromAscList"><span class="hs-identifier hs-var hs-var">fromAscList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g (NonEmpty point) -&gt; RangeTree f point
forall (g :: * -&gt; *) (h :: * -&gt; *) point (d :: Nat) r
       (f :: * -&gt; *).
(Foldable1 g, Foldable1 h, Point_ point d r, 1 &lt;= d,
 Semigroup (f point), Measured f point) =&gt;
g (h point) -&gt; RangeTree f point
</span><a href="HGeometry.RangeTree.Base.html#fromGroupedAscList"><span class="hs-identifier hs-var">fromGroupedAscList</span></a></span><span> </span><span class="annot"><span class="annottext">(g (NonEmpty point) -&gt; RangeTree f point)
-&gt; (g point -&gt; g (NonEmpty point)) -&gt; g point -&gt; RangeTree f point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(point -&gt; NonEmpty point) -&gt; g point -&gt; g (NonEmpty point)
forall a b. (a -&gt; b) -&gt; g a -&gt; g b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; [point] -&gt; NonEmpty point
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="annot"><span class="hs-comment">-- | Given the points in groups per x-coordinate, in increasing order of x-coordinate</span></span><span>
</span><span id="line-109"></span><span id="local-6989586621679555569"><span id="local-6989586621679555570"><span id="local-6989586621679555571"><span id="local-6989586621679555572"><span id="local-6989586621679555573"><span id="local-6989586621679555574"><span class="annot"><a href="HGeometry.RangeTree.Base.html#fromGroupedAscList"><span class="hs-identifier hs-type">fromGroupedAscList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679555569"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679555570"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679555571"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555572"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555573"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679555572"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-110"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555574"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555571"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Measured.Class.html/HGeometry.Measured.Class.html#Measured"><span class="hs-identifier hs-type">Measured</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555574"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555571"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-111"></span><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679555569"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555570"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555571"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-type">RangeTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555574"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555571"><span class="hs-identifier hs-type">point</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-112"></span><span id="fromGroupedAscList"><span class="annot"><span class="annottext">fromGroupedAscList :: forall (g :: * -&gt; *) (h :: * -&gt; *) point (d :: Nat) r
       (f :: * -&gt; *).
(Foldable1 g, Foldable1 h, Point_ point d r, 1 &lt;= d,
 Semigroup (f point), Measured f point) =&gt;
g (h point) -&gt; RangeTree f point
</span><a href="HGeometry.RangeTree.Base.html#fromGroupedAscList"><span class="hs-identifier hs-var hs-var">fromGroupedAscList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
-&gt; RangeTree f point
SubTree f point (NumType point) -&gt; RangeTree f point
forall (f :: * -&gt; *) point.
SubTree f point (NumType point) -&gt; RangeTree f point
</span><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-var">RangeTree</span></a></span><span> </span><span class="annot"><span class="annottext">(BinLeafTree (NodeData f point r) (LeafData f point r)
 -&gt; RangeTree f point)
-&gt; (g (h point)
    -&gt; BinLeafTree (NodeData f point r) (LeafData f point r))
-&gt; g (h point)
-&gt; RangeTree f point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(BinLeafTree (NodeData f point r) (LeafData f point r), r)
-&gt; BinLeafTree (NodeData f point r) (LeafData f point r)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((BinLeafTree (NodeData f point r) (LeafData f point r), r)
 -&gt; BinLeafTree (NodeData f point r) (LeafData f point r))
-&gt; (g (h point)
    -&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r))
-&gt; g (h point)
-&gt; BinLeafTree (NodeData f point r) (LeafData f point r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((BinLeafTree (NodeData f point r) (LeafData f point r), r)
 -&gt; Count (h point)
 -&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r)
 -&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r))
-&gt; (h point
    -&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r))
-&gt; BinLeafTree (Count (h point)) (h point)
-&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r)
forall b v a.
(b -&gt; v -&gt; b -&gt; b) -&gt; (a -&gt; b) -&gt; BinLeafTree v a -&gt; b
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#foldUp"><span class="hs-identifier hs-var">foldUp</span></a></span><span> </span><span class="annot"><span class="annottext">(BinLeafTree (NodeData f point r) (LeafData f point r), r)
-&gt; Count (h point)
-&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r)
-&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r)
forall {k} {f :: k -&gt; *} {point :: k} {r} {a} {p} {b}.
(Semigroup (f point),
 HasCanonicalSubSet
   (BinLeafTree (NodeData f point r) a)
   (BinLeafTree (NodeData f point r) a)
   point
   f
   f) =&gt;
(BinLeafTree (NodeData f point r) a, r)
-&gt; p
-&gt; (BinLeafTree (NodeData f point r) a, b)
-&gt; (BinLeafTree (NodeData f point r) a, b)
</span><a href="#local-6989586621679556407"><span class="hs-identifier hs-var">node'</span></a></span><span> </span><span class="annot"><span class="annottext">h point
-&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r)
h point
-&gt; (BinLeafTree
      (NodeData f point r) (LeafData f point (NumType point)),
    NumType point)
forall {point} {f :: * -&gt; *} {t :: * -&gt; *} {v}.
(Assert
   (OrdCond (CmpNat 1 (Dimension point)) 'True 'True 'False)
   (TypeError ...),
 Semigroup (f point), Measured f point, Foldable1 t,
 Point_ point (Dimension point) (NumType point)) =&gt;
t point
-&gt; (BinLeafTree v (LeafData f point (NumType point)),
    NumType point)
</span><a href="#local-6989586621679556408"><span class="hs-identifier hs-var">leaf'</span></a></span><span> </span><span class="annot"><span class="annottext">(BinLeafTree (Count (h point)) (h point)
 -&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r))
-&gt; (g (h point) -&gt; BinLeafTree (Count (h point)) (h point))
-&gt; g (h point)
-&gt; (BinLeafTree (NodeData f point r) (LeafData f point r), r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">g (h point) -&gt; BinLeafTree (Count (h point)) (h point)
forall (f :: * -&gt; *) a.
Foldable1 f =&gt;
f a -&gt; BinLeafTree (Count a) a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#asBalancedBinLeafTree"><span class="hs-identifier hs-var">asBalancedBinLeafTree</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679556408"><span class="annot"><span class="annottext">leaf' :: t point
-&gt; (BinLeafTree v (LeafData f point (NumType point)),
    NumType point)
</span><a href="#local-6989586621679556408"><span class="hs-identifier hs-var hs-var">leaf'</span></a></span></span><span> </span><span id="local-6989586621679556479"><span class="annot"><span class="annottext">t point
</span><a href="#local-6989586621679556479"><span class="hs-identifier hs-var">pts</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679556480"><span class="annot"><span class="annottext">p :: point
</span><a href="#local-6989586621679556480"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty point -&gt; point
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.head</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty point -&gt; point) -&gt; NonEmpty point -&gt; point
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t point -&gt; NonEmpty point
forall a. t a -&gt; NonEmpty a
forall (t :: * -&gt; *) a. Foldable1 t =&gt; t a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">toNonEmpty</span></span><span> </span><span class="annot"><span class="annottext">t point
</span><a href="#local-6989586621679556479"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-115"></span><span>                               </span><span id="local-6989586621679556483"><span class="annot"><span class="annottext">x :: NumType point
</span><a href="#local-6989586621679556483"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679556480"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">point
-&gt; Getting (NumType point) point (NumType point) -&gt; NumType point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType point) point (NumType point)
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int point (NumType point)
</span><span class="hs-identifier hs-var">xCoord</span></span><span>
</span><span id="line-116"></span><span>                               </span><span id="local-6989586621679556484"><span class="annot"><span class="annottext">m :: f point
</span><a href="#local-6989586621679556484"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(point -&gt; f point) -&gt; t point -&gt; f point
forall m a. Semigroup m =&gt; (a -&gt; m) -&gt; t a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable1 t, Semigroup m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap1</span></span><span> </span><span class="annot"><span class="annottext">point -&gt; f point
forall (f :: * -&gt; *) a. Measured f a =&gt; a -&gt; f a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Measured.Class.html/HGeometry.Measured.Class.html#measure"><span class="hs-identifier hs-var">measure</span></a></span><span> </span><span class="annot"><span class="annottext">t point
</span><a href="#local-6989586621679556479"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-117"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeafData f point (NumType point)
-&gt; BinLeafTree v (LeafData f point (NumType point))
forall v a. a -&gt; BinLeafTree v a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-var">Leaf</span></a></span><span> </span><span class="annot"><span class="annottext">(LeafData f point (NumType point)
 -&gt; BinLeafTree v (LeafData f point (NumType point)))
-&gt; LeafData f point (NumType point)
-&gt; BinLeafTree v (LeafData f point (NumType point))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NumType point -&gt; f point -&gt; LeafData f point (NumType point)
forall {k} (f :: k -&gt; *) (point :: k) r.
r -&gt; f point -&gt; LeafData f point r
</span><a href="HGeometry.RangeTree.Base.html#LeafData"><span class="hs-identifier hs-var">LeafData</span></a></span><span> </span><span class="annot"><span class="annottext">NumType point
</span><a href="#local-6989586621679556483"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f point
</span><a href="#local-6989586621679556484"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumType point
</span><a href="#local-6989586621679556483"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679556407"><span class="annot"><span class="annottext">node' :: (BinLeafTree (NodeData f point r) a, r)
-&gt; p
-&gt; (BinLeafTree (NodeData f point r) a, b)
-&gt; (BinLeafTree (NodeData f point r) a, b)
</span><a href="#local-6989586621679556407"><span class="hs-identifier hs-var hs-var">node'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679556494"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
</span><a href="#local-6989586621679556494"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679556495"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679556495"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679556496"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
</span><a href="#local-6989586621679556496"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679556497"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679556497"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
-&gt; NodeData f point r
-&gt; BinLeafTree (NodeData f point r) a
-&gt; BinLeafTree (NodeData f point r) a
forall v a.
BinLeafTree v a -&gt; v -&gt; BinLeafTree v a -&gt; BinLeafTree v a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-var">Node</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
</span><a href="#local-6989586621679556494"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; f point -&gt; NodeData f point r
forall {k} (f :: k -&gt; *) (point :: k) r.
r -&gt; f point -&gt; NodeData f point r
</span><a href="HGeometry.RangeTree.Base.html#NodeData"><span class="hs-identifier hs-var">NodeData</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679556495"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(f point -&gt; NodeData f point r) -&gt; f point -&gt; NodeData f point r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
</span><a href="#local-6989586621679556494"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
-&gt; Getting (f point) (BinLeafTree (NodeData f point r) a) (f point)
-&gt; f point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (f point) (BinLeafTree (NodeData f point r) a) (f point)
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens
  (BinLeafTree (NodeData f point r) a)
  (BinLeafTree (NodeData f point r) a)
  (f point)
  (f point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span> </span><span class="annot"><span class="annottext">f point -&gt; f point -&gt; f point
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
</span><a href="#local-6989586621679556496"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
-&gt; Getting (f point) (BinLeafTree (NodeData f point r) a) (f point)
-&gt; f point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (f point) (BinLeafTree (NodeData f point r) a) (f point)
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens
  (BinLeafTree (NodeData f point r) a)
  (BinLeafTree (NodeData f point r) a)
  (f point)
  (f point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) a
</span><a href="#local-6989586621679556496"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-119"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679556497"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-120"></span><span>                           </span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Report the canonical subsets of the nodes that together represent the query interval.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- \(O(\log n)\)</span><span>
</span><span id="line-125"></span><span id="local-6989586621679555638"><span id="local-6989586621679555639"><span id="local-6989586621679555641"><span id="local-6989586621679555642"><span id="local-6989586621679555643"><span class="annot"><a href="HGeometry.RangeTree.Base.html#rangeQuery"><span class="hs-identifier hs-type">rangeQuery</span></a></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Interval_</span></span><span> </span><span class="annot"><a href="#local-6989586621679555638"><span class="hs-identifier hs-type">interval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555639"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679555641"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555642"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555639"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679555642"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679555639"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>                            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679555638"><span class="hs-identifier hs-type">interval</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-type">RangeTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555643"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555641"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679555643"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555641"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-127"></span><span id="rangeQuery"><span class="annot"><span class="annottext">rangeQuery :: forall interval r point (d :: Nat) (f :: * -&gt; *).
(Interval_ interval r, Point_ point d r, 1 &lt;= d, Ord r) =&gt;
interval -&gt; RangeTree f point -&gt; [f point]
</span><a href="HGeometry.RangeTree.Base.html#rangeQuery"><span class="hs-identifier hs-var hs-var">rangeQuery</span></a></span></span><span> </span><span id="local-6989586621679556526"><span class="annot"><span class="annottext">interval
</span><a href="#local-6989586621679556526"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-type">RangeTree</span></a></span><span> </span><span id="local-6989586621679556527"><span class="annot"><span class="annottext">SubTree f point (NumType point)
</span><a href="#local-6989586621679556527"><span class="hs-identifier hs-var">t0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556528"><span class="hs-identifier hs-var">findSplitNode</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
SubTree f point (NumType point)
</span><a href="#local-6989586621679556527"><span class="hs-identifier hs-var">t0</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679556528"><span class="annot"><span class="annottext">findSplitNode :: BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556528"><span class="hs-identifier hs-var hs-var">findSplitNode</span></a></span></span><span> </span><span id="local-6989586621679556529"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556529"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556529"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679556530"><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556530"><span class="hs-identifier hs-var">ld</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LeafData f point r -&gt; [f point]
</span><a href="#local-6989586621679556531"><span class="hs-identifier hs-var">goReport</span></a></span><span> </span><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556530"><span class="hs-identifier hs-var">ld</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679556532"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556532"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679556533"><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556533"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679556534"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556534"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556533"><span class="hs-identifier hs-var">nd</span></a></span><span class="annot"><span class="annottext">NodeData f point r -&gt; Getting r (NodeData f point r) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r (NodeData f point r) r
forall {k} (f :: k -&gt; *) (point :: k) r s (f :: * -&gt; *).
Functor f =&gt;
(r -&gt; f s) -&gt; NodeData f point r -&gt; f (NodeData f point s)
</span><a href="HGeometry.RangeTree.Base.html#split"><span class="hs-identifier hs-var">split</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; interval -&gt; Ordering
forall r interval.
(Ord r, Interval_ interval r) =&gt;
r -&gt; interval -&gt; Ordering
</span><span class="hs-operator hs-var">`compareInterval`</span></span><span> </span><span class="annot"><span class="annottext">interval
</span><a href="#local-6989586621679556526"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-133"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556528"><span class="hs-identifier hs-var">findSplitNode</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556534"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-134"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556536"><span class="hs-identifier hs-var">reportRightSubtrees</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556532"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[f point] -&gt; [f point] -&gt; [f point]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556537"><span class="hs-identifier hs-var">reportLeftSubtrees</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556534"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-135"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556528"><span class="hs-identifier hs-var">findSplitNode</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556532"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-comment">-- | Report a leaf (if needed)</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679556531"><span class="annot"><span class="annottext">goReport :: LeafData f point r -&gt; [f point]
</span><a href="#local-6989586621679556531"><span class="hs-identifier hs-var hs-var">goReport</span></a></span></span><span> </span><span id="local-6989586621679556538"><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556538"><span class="hs-identifier hs-var">ld</span></a></span></span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556538"><span class="hs-identifier hs-var">ld</span></a></span><span class="annot"><span class="annottext">LeafData f point r -&gt; Getting r (LeafData f point r) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r (LeafData f point r) r
forall {k} (f :: k -&gt; *) (point :: k) r s (f :: * -&gt; *).
Functor f =&gt;
(r -&gt; f s) -&gt; LeafData f point r -&gt; f (LeafData f point s)
</span><a href="HGeometry.RangeTree.Base.html#thePoint"><span class="hs-identifier hs-var">thePoint</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; interval -&gt; Bool
forall interval r.
(Ord r, Interval_ interval r) =&gt;
r -&gt; interval -&gt; Bool
</span><span class="hs-operator hs-var">`stabsInterval`</span></span><span> </span><span class="annot"><span class="annottext">interval
</span><a href="#local-6989586621679556526"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556538"><span class="hs-identifier hs-var">ld</span></a></span><span class="annot"><span class="annottext">LeafData f point r
-&gt; Getting (f point) (LeafData f point r) (f point) -&gt; f point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (f point) (LeafData f point r) (f point)
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens (LeafData f point r) (LeafData f point r) (f point) (f point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-comment">-- | walk the left-path reporting the right subtrees</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679556536"><span class="annot"><span class="annottext">reportRightSubtrees :: BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556536"><span class="hs-identifier hs-var hs-var">reportRightSubtrees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679556540"><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556540"><span class="hs-identifier hs-var">ld</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LeafData f point r -&gt; [f point]
</span><a href="#local-6989586621679556531"><span class="hs-identifier hs-var">goReport</span></a></span><span> </span><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556540"><span class="hs-identifier hs-var">ld</span></a></span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679556541"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556541"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679556542"><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556542"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679556543"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556543"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556542"><span class="hs-identifier hs-var">nd</span></a></span><span class="annot"><span class="annottext">NodeData f point r -&gt; Getting r (NodeData f point r) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r (NodeData f point r) r
forall {k} (f :: k -&gt; *) (point :: k) r s (f :: * -&gt; *).
Functor f =&gt;
(r -&gt; f s) -&gt; NodeData f point r -&gt; f (NodeData f point s)
</span><a href="HGeometry.RangeTree.Base.html#split"><span class="hs-identifier hs-var">split</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; interval -&gt; Ordering
forall r interval.
(Ord r, Interval_ interval r) =&gt;
r -&gt; interval -&gt; Ordering
</span><span class="hs-operator hs-var">`compareInterval`</span></span><span> </span><span class="annot"><span class="annottext">interval
</span><a href="#local-6989586621679556526"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-146"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556536"><span class="hs-identifier hs-var">reportRightSubtrees</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556543"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-147"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; f point
</span><a href="#local-6989586621679556544"><span class="hs-identifier hs-var">reportSubTree</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556543"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">f point -&gt; [f point] -&gt; [f point]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556536"><span class="hs-identifier hs-var">reportRightSubtrees</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556541"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-148"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [f point]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RangeTree.rangeQuery, reportRightSubtrees absurd&quot;</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-comment">-- | walk the right-path reporting left subtrees</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679556537"><span class="annot"><span class="annottext">reportLeftSubtrees :: BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556537"><span class="hs-identifier hs-var hs-var">reportLeftSubtrees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-152"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679556546"><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556546"><span class="hs-identifier hs-var">ld</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LeafData f point r -&gt; [f point]
</span><a href="#local-6989586621679556531"><span class="hs-identifier hs-var">goReport</span></a></span><span> </span><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556546"><span class="hs-identifier hs-var">ld</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span id="local-6989586621679556547"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556547"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679556548"><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556548"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679556549"><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556549"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556548"><span class="hs-identifier hs-var">nd</span></a></span><span class="annot"><span class="annottext">NodeData f point r -&gt; Getting r (NodeData f point r) r -&gt; r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting r (NodeData f point r) r
forall {k} (f :: k -&gt; *) (point :: k) r s (f :: * -&gt; *).
Functor f =&gt;
(r -&gt; f s) -&gt; NodeData f point r -&gt; f (NodeData f point s)
</span><a href="HGeometry.RangeTree.Base.html#split"><span class="hs-identifier hs-var">split</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; interval -&gt; Ordering
forall r interval.
(Ord r, Interval_ interval r) =&gt;
r -&gt; interval -&gt; Ordering
</span><span class="hs-operator hs-var">`compareInterval`</span></span><span> </span><span class="annot"><span class="annottext">interval
</span><a href="#local-6989586621679556526"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-154"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; [f point]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RangeTree.rangeQuery, reportLeftSubtrees absurd&quot;</span></span><span>
</span><span id="line-155"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; f point
</span><a href="#local-6989586621679556544"><span class="hs-identifier hs-var">reportSubTree</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556547"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">f point -&gt; [f point] -&gt; [f point]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556537"><span class="hs-identifier hs-var">reportLeftSubtrees</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556549"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-156"></span><span>                       </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; [f point]
</span><a href="#local-6989586621679556537"><span class="hs-identifier hs-var">reportLeftSubtrees</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><a href="#local-6989586621679556547"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-comment">-- | report the canonical subset of the node</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679556544"><span class="annot"><span class="annottext">reportSubTree :: BinLeafTree (NodeData f point r) (LeafData f point r) -&gt; f point
</span><a href="#local-6989586621679556544"><span class="hs-identifier hs-var hs-var">reportSubTree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-160"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a></span><span> </span><span id="local-6989586621679556554"><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556554"><span class="hs-identifier hs-var">ld</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LeafData f point r
</span><a href="#local-6989586621679556554"><span class="hs-identifier hs-var">ld</span></a></span><span class="annot"><span class="annottext">LeafData f point r
-&gt; Getting (f point) (LeafData f point r) (f point) -&gt; f point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (f point) (LeafData f point r) (f point)
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens (LeafData f point r) (LeafData f point r) (f point) (f point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Tree.Binary.Static.html/HGeometry.Tree.Binary.Static.html#Node"><span class="hs-identifier hs-type">Node</span></a></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679556555"><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556555"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span class="annot"><span class="annottext">BinLeafTree (NodeData f point r) (LeafData f point r)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeData f point r
</span><a href="#local-6989586621679556555"><span class="hs-identifier hs-var">nd</span></a></span><span class="annot"><span class="annottext">NodeData f point r
-&gt; Getting (f point) (NodeData f point r) (f point) -&gt; f point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.3-ce13621ca90282c7ffe4fce28e3082324aec22dc8cdfa5fe56a4cc94c1bcacc4/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (f point) (NodeData f point r) (f point)
forall {k} s t (a :: k) (f :: k -&gt; *) (g :: k -&gt; *).
HasCanonicalSubSet s t a f g =&gt;
Lens s t (f a) (g a)
Lens (NodeData f point r) (NodeData f point r) (f point) (f point)
</span><a href="HGeometry.SegmentTree.CanonicalSubSet.html#canonicalSubSet"><span class="hs-identifier hs-var">canonicalSubSet</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Query the range tree</span><span>
</span><span id="line-165"></span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- \(O(\log n + k)\), where \(k\) is somehow depends on the output size (and the monoid</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- used).</span><span>
</span><span id="line-168"></span><span id="local-6989586621679555656"><span id="local-6989586621679555657"><span id="local-6989586621679555658"><span id="local-6989586621679555659"><span id="local-6989586621679555660"><span class="annot"><a href="HGeometry.RangeTree.Base.html#query"><span class="hs-identifier hs-type">query</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Interval_</span></span><span> </span><span class="annot"><a href="#local-6989586621679555656"><span class="hs-identifier hs-type">interval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555657"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679555658"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555659"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555657"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679555659"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679555657"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679555660"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555658"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679555656"><span class="hs-identifier hs-type">interval</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.RangeTree.Base.html#RangeTree"><span class="hs-identifier hs-type">RangeTree</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555660"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555658"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679555660"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679555658"><span class="hs-identifier hs-type">point</span></a></span></span></span></span></span></span><span>
</span><span id="line-170"></span><span id="query"><span class="annot"><span class="annottext">query :: forall interval r point (d :: Nat) (f :: * -&gt; *).
(Interval_ interval r, Point_ point d r, 1 &lt;= d, Ord r,
 Monoid (f point)) =&gt;
interval -&gt; RangeTree f point -&gt; f point
</span><a href="HGeometry.RangeTree.Base.html#query"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621679556631"><span class="annot"><span class="annottext">interval
</span><a href="#local-6989586621679556631"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[f point] -&gt; f point
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([f point] -&gt; f point)
-&gt; (RangeTree f point -&gt; [f point]) -&gt; RangeTree f point -&gt; f point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">interval -&gt; RangeTree f point -&gt; [f point]
forall interval r point (d :: Nat) (f :: * -&gt; *).
(Interval_ interval r, Point_ point d r, 1 &lt;= d, Ord r) =&gt;
interval -&gt; RangeTree f point -&gt; [f point]
</span><a href="HGeometry.RangeTree.Base.html#rangeQuery"><span class="hs-identifier hs-var">rangeQuery</span></a></span><span> </span><span class="annot"><span class="annottext">interval
</span><a href="#local-6989586621679556631"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-171"></span></pre></body></html>