<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.ClosestPair.Naive</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Naive \O(n\^2)\) time algorithm to compute the closest pair of points among</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- \(n\) points in \(\mathbb{R}^d\).</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.ClosestPair.Naive.html"><span class="hs-identifier">HGeometry.ClosestPair.Naive</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.ClosestPair.Naive.html#closestPair"><span class="hs-identifier">closestPair</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.ClosestPair.Naive.html#closestPairWith"><span class="hs-identifier">closestPairWith</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.ClosestPair.Naive.html#DistanceFunction"><span class="hs-identifier">DistanceFunction</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.2-2c225bc76acc8fc1e6dce12ee325f5b0d01c05bbb9d72de01b3c6c240d1fc294/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.2-2c225bc76acc8fc1e6dce12ee325f5b0d01c05bbb9d72de01b3c6c240d1fc294/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator">(^.)</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.2-2c225bc76acc8fc1e6dce12ee325f5b0d01c05bbb9d72de01b3c6c240d1fc294/share/doc/html/src/Control.Lens.Tuple.html/Control.Lens.Tuple.html#_1"><span class="hs-identifier">_1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/semigroupoids-6.0.1-a8bbfdf809d26cf53d1649155d1175ff37b07769640f0e81bd2ce91845990ef7/share/doc/html/src/Data.Semigroup.Foldable.html/Data.Semigroup.Foldable.html"><span class="hs-identifier">Data.Semigroup.Foldable</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html"><span class="hs-identifier">HGeometry.Combinatorial.Util</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Properties</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NumType</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | Naive algorithm to compute the closest pair according to the</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- (squared) Euclidean distance in \(d\) dimensions. Note that we need</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- at least two elements for there to be a closest pair.</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- pre: there are at least two! points in the input</span><span>
</span><span id="line-35"></span><span class="hs-comment">--</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- running time: \(O(dn^2)\) time.</span><span>
</span><span id="line-37"></span><span id="local-6989586621679451967"><span id="local-6989586621679451968"><span id="local-6989586621679451969"><span id="local-6989586621679451971"><span class="annot"><a href="HGeometry.ClosestPair.Naive.html#closestPair"><span class="hs-identifier hs-type">closestPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679451967"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679451967"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679451968"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451969"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451967"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679451971"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Has_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Metric_</span></span><span> </span><span class="annot"><a href="#local-6989586621679451969"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451967"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451971"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451968"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679451968"><span class="hs-identifier hs-type">point</span></a></span></span></span></span></span><span>
</span><span id="line-39"></span><span id="closestPair"><span class="annot"><span class="annottext">closestPair :: forall r point (d :: Nat) (f :: * -&gt; *).
(Ord r, Num r, Point_ point d r, Foldable1 f, Has_ Metric_ d r) =&gt;
f point -&gt; Vector 2 point
</span><a href="HGeometry.ClosestPair.Naive.html#closestPair"><span class="hs-identifier hs-var hs-var">closestPair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SP (Vector 2 point) r
-&gt; Getting
     (Vector 2 point) (SP (Vector 2 point) r) (Vector 2 point)
-&gt; Vector 2 point
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.2-2c225bc76acc8fc1e6dce12ee325f5b0d01c05bbb9d72de01b3c6c240d1fc294/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Vector 2 point) (SP (Vector 2 point) r) (Vector 2 point)
forall s t a b. Field1 s t a b =&gt; Lens s t a b
Lens
  (SP (Vector 2 point) r)
  (SP (Vector 2 point) r)
  (Vector 2 point)
  (Vector 2 point)
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.2-2c225bc76acc8fc1e6dce12ee325f5b0d01c05bbb9d72de01b3c6c240d1fc294/share/doc/html/src/Control.Lens.Tuple.html/Control.Lens.Tuple.html#_1"><span class="hs-identifier hs-var">_1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SP (Vector 2 point) r -&gt; Vector 2 point)
-&gt; (f point -&gt; SP (Vector 2 point) r) -&gt; f point -&gt; Vector 2 point
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DistanceFunction point -&gt; f point -&gt; SP (Vector 2 point) r
forall r point (d :: Nat) (f :: * -&gt; *).
(Ord r, Point_ point d r, Foldable1 f) =&gt;
DistanceFunction point -&gt; f point -&gt; SP (Vector 2 point) r
</span><a href="HGeometry.ClosestPair.Naive.html#closestPairWith"><span class="hs-identifier hs-var">closestPairWith</span></a></span><span> </span><span class="annot"><span class="annottext">point -&gt; point -&gt; r
DistanceFunction point
forall r point (d :: Nat) point'.
(Num r, Point_ point d r, Point_ point' d r,
 Metric_ (Vector d r) d r) =&gt;
point -&gt; point' -&gt; r
</span><span class="hs-identifier hs-var">squaredEuclideanDist</span></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">-- | A distance function between geometries of type 'g'</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">type</span><span> </span><span id="DistanceFunction"><span class="annot"><a href="HGeometry.ClosestPair.Naive.html#DistanceFunction"><span class="hs-identifier hs-var">DistanceFunction</span></a></span></span><span> </span><span id="local-6989586621679452231"><span class="annot"><a href="#local-6989586621679452231"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679452231"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452231"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679452231"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | Naive algorithm to compute the closest pair of points (and the</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- distance realized by those points) given a distance function.  Note</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- that we need at least two elements for there to be a closest pair.</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- running time: \(O(T(d)n^2)\), where \(T(d)\) is the time required</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- to evaluate the distance between two points in \(\mathbb{R}^d\).</span><span>
</span><span id="line-50"></span><span id="local-6989586621679452030"><span id="local-6989586621679452031"><span id="local-6989586621679452032"><span id="local-6989586621679452033"><span class="annot"><a href="HGeometry.ClosestPair.Naive.html#closestPairWith"><span class="hs-identifier hs-type">closestPairWith</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679452030"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679452031"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452032"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452030"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679452033"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.ClosestPair.Naive.html#DistanceFunction"><span class="hs-identifier hs-type">DistanceFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452031"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-52"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452033"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452031"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html#SP"><span class="hs-identifier hs-type">SP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679452031"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679452030"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-53"></span><span id="closestPairWith"><span class="annot"><span class="annottext">closestPairWith :: forall r point (d :: Nat) (f :: * -&gt; *).
(Ord r, Point_ point d r, Foldable1 f) =&gt;
DistanceFunction point -&gt; f point -&gt; SP (Vector 2 point) r
</span><a href="HGeometry.ClosestPair.Naive.html#closestPairWith"><span class="hs-identifier hs-var hs-var">closestPairWith</span></a></span></span><span> </span><span id="local-6989586621679452246"><span class="annot"><span class="annottext">DistanceFunction point
</span><a href="#local-6989586621679452246"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg r (Vector 2 point) -&gt; SP (Vector 2 point) r
forall {b} {a}. Arg b a -&gt; SP a b
</span><a href="#local-6989586621679452247"><span class="hs-identifier hs-var">getVal</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg r (Vector 2 point) -&gt; SP (Vector 2 point) r)
-&gt; (f point -&gt; Arg r (Vector 2 point))
-&gt; f point
-&gt; SP (Vector 2 point) r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Min (Arg r (Vector 2 point)) -&gt; Arg r (Vector 2 point)
forall a. Min a -&gt; a
</span><span class="hs-identifier hs-var">getMin</span></span><span> </span><span class="annot"><span class="annottext">(Min (Arg r (Vector 2 point)) -&gt; Arg r (Vector 2 point))
-&gt; (f point -&gt; Min (Arg r (Vector 2 point)))
-&gt; f point
-&gt; Arg r (Vector 2 point)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Min (Arg r (Vector 2 point)))
-&gt; Min (Arg r (Vector 2 point))
forall a. Semigroup a =&gt; NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">sconcat</span></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Min (Arg r (Vector 2 point)))
 -&gt; Min (Arg r (Vector 2 point)))
-&gt; (f point -&gt; NonEmpty (Min (Arg r (Vector 2 point))))
-&gt; f point
-&gt; Min (Arg r (Vector 2 point))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Two point -&gt; Min (Arg r (Vector 2 point)))
-&gt; NonEmpty (Two point) -&gt; NonEmpty (Min (Arg r (Vector 2 point)))
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Two point -&gt; Min (Arg r (Vector 2 point))
</span><a href="#local-6989586621679452250"><span class="hs-identifier hs-var">mkPair</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Two point) -&gt; NonEmpty (Min (Arg r (Vector 2 point))))
-&gt; (f point -&gt; NonEmpty (Two point))
-&gt; f point
-&gt; NonEmpty (Min (Arg r (Vector 2 point)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f point -&gt; NonEmpty (Two point)
forall (f :: * -&gt; *) a. Foldable1 f =&gt; f a -&gt; NonEmpty (Two a)
</span><a href="HGeometry.ClosestPair.Naive.html#pairs"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621679452247"><span class="annot"><span class="annottext">getVal :: Arg b a -&gt; SP a b
</span><a href="#local-6989586621679452247"><span class="hs-identifier hs-var hs-var">getVal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arg</span></span><span> </span><span id="local-6989586621679452253"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679452253"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679452254"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679452254"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; SP a b
forall a b. a -&gt; b -&gt; SP a b
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html#SP"><span class="hs-identifier hs-var">SP</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679452254"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679452253"><span class="hs-identifier hs-var">dist</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span id="local-6989586621679452250"><span class="annot"><span class="annottext">mkPair :: Two point -&gt; Min (Arg r (Vector 2 point))
</span><a href="#local-6989586621679452250"><span class="hs-identifier hs-var hs-var">mkPair</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span id="local-6989586621679452257"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679452257"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679452258"><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679452258"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg r (Vector 2 point) -&gt; Min (Arg r (Vector 2 point))
forall a. a -&gt; Min a
</span><span class="hs-identifier hs-var">Min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">r -&gt; Vector 2 point -&gt; Arg r (Vector 2 point)
forall a b. a -&gt; b -&gt; Arg a b
</span><span class="hs-identifier hs-var">Arg</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DistanceFunction point
</span><a href="#local-6989586621679452246"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679452257"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679452258"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">point -&gt; point -&gt; Vector 2 point
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679452257"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">point
</span><a href="#local-6989586621679452258"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Produce all lists from a vec of elements. Since the Vec contains at least two</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- elements, the resulting list is non-empty</span><span>
</span><span id="line-60"></span><span id="local-6989586621679452055"><span id="local-6989586621679452056"><span class="annot"><a href="HGeometry.ClosestPair.Naive.html#pairs"><span class="hs-identifier hs-type">pairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable1</span></span><span> </span><span class="annot"><a href="#local-6989586621679452055"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679452055"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452056"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679452056"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-61"></span><span id="pairs"><span class="annot"><span class="annottext">pairs :: forall (f :: * -&gt; *) a. Foldable1 f =&gt; f a -&gt; NonEmpty (Two a)
</span><a href="HGeometry.ClosestPair.Naive.html#pairs"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Two a] -&gt; NonEmpty (Two a)
forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">NonEmpty.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Two a] -&gt; NonEmpty (Two a))
-&gt; (f a -&gt; [Two a]) -&gt; f a -&gt; NonEmpty (Two a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [Two a]
forall (f :: * -&gt; *) a. Foldable f =&gt; f a -&gt; [Two a]
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html/HGeometry.Combinatorial.Util.html#uniquePairs"><span class="hs-identifier hs-var">uniquePairs</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [Two a]) -&gt; (f a -&gt; [a]) -&gt; f a -&gt; [Two a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">f a -&gt; [a]
forall a. f a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span>
</span><span id="line-62"></span></pre></body></html>