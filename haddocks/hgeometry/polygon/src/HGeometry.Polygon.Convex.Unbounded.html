<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Convex.Unbounded</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- A type for representing unbounded, Convex, polygonal regions.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html"><span class="hs-identifier">HGeometry.Polygon.Convex.Unbounded</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegion"><span class="hs-identifier">UnboundedConvexRegion</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier">UnboundedConvexRegionF</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier">extremalVertices</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#mapChain"><span class="hs-identifier">mapChain</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier">toBoundedFrom</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.HalfLine</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.HalfSpace</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.HyperPlane.Class</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Intersection</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Line</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.LineSegment</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Point.Either</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.html"><span class="hs-identifier">HGeometry.Polygon</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Polygon.Simple.PossiblyDegenerate.html"><span class="hs-identifier">HGeometry.Polygon.Simple.PossiblyDegenerate</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Properties</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Triangle</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="annot"><span class="hs-comment">-- | An unbounded polygonal Convex Region</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">type</span><span> </span><span id="UnboundedConvexRegion"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegion"><span class="hs-identifier hs-var">UnboundedConvexRegion</span></a></span></span><span> </span><span id="local-6989586621679295162"><span class="annot"><a href="#local-6989586621679295162"><span class="hs-identifier hs-type">vertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679295162"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679295162"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><span class="hs-comment">-- | An unbounded polygonal ConvexRegion whose vertices are stored in an 'nonEmpty'</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">data</span><span> </span><span id="UnboundedConvexRegionF"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-var">UnboundedConvexRegionF</span></a></span></span><span> </span><span id="local-6989586621679294915"><span class="annot"><a href="#local-6989586621679294915"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679294916"><span class="annot"><a href="#local-6989586621679294916"><span class="hs-identifier hs-type">nonEmpty</span></a></span></span><span> </span><span id="local-6989586621679294917"><span class="annot"><a href="#local-6989586621679294917"><span class="hs-identifier hs-type">vertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-49"></span><span>  </span><span id="Unbounded"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-var">Unbounded</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679294915"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>            </span><span class="hs-comment">-- ^ vector indicating the direction of the unbounded edge</span><span>
</span><span id="line-51"></span><span>            </span><span class="hs-comment">-- incident to the first vertex. Note that this vector</span><span>
</span><span id="line-52"></span><span>            </span><span class="hs-comment">-- thus points INTO vertex v.</span><span>
</span><span id="line-53"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679294916"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294917"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ the vertices in CCW order,</span></span><span>
</span><span id="line-55"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679294915"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>            </span><span class="hs-comment">-- ^ the vector indicating the direction of the unbounded</span><span>
</span><span id="line-57"></span><span>            </span><span class="hs-comment">-- edge incident to the last vertex. The vector points</span><span>
</span><span id="line-58"></span><span>            </span><span class="hs-comment">-- away from the vertex (i.e. towards +infty).</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679295167"><span id="local-6989586621679295177"><span id="local-6989586621679295181"><span class="annot"><span class="annottext">Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS
[UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS
UnboundedConvexRegionF r nonEmpty vertex -&gt; String
(Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS)
-&gt; (UnboundedConvexRegionF r nonEmpty vertex -&gt; String)
-&gt; ([UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS)
-&gt; Show (UnboundedConvexRegionF r nonEmpty vertex)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Show r, Show (nonEmpty vertex)) =&gt;
Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS
forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Show r, Show (nonEmpty vertex)) =&gt;
[UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS
forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Show r, Show (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex -&gt; String
$cshowsPrec :: forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Show r, Show (nonEmpty vertex)) =&gt;
Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS
showsPrec :: Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS
$cshow :: forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Show r, Show (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex -&gt; String
show :: UnboundedConvexRegionF r nonEmpty vertex -&gt; String
$cshowList :: forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Show r, Show (nonEmpty vertex)) =&gt;
[UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS
showList :: [UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679295189"><span id="local-6989586621679295195"><span class="annot"><span class="annottext">UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
(UnboundedConvexRegionF r nonEmpty vertex
 -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool)
-&gt; (UnboundedConvexRegionF r nonEmpty vertex
    -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool)
-&gt; Eq (UnboundedConvexRegionF r nonEmpty vertex)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Eq r, Eq (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
$c== :: forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Eq r, Eq (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
== :: UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
$c/= :: forall r k (nonEmpty :: k -&gt; *) (vertex :: k).
(Eq r, Eq (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
/= :: UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679295201"><span id="local-6989586621679295204"><span class="annot"><span class="annottext">(forall a b.
 (a -&gt; b)
 -&gt; UnboundedConvexRegionF r nonEmpty a
 -&gt; UnboundedConvexRegionF r nonEmpty b)
-&gt; (forall a b.
    a
    -&gt; UnboundedConvexRegionF r nonEmpty b
    -&gt; UnboundedConvexRegionF r nonEmpty a)
-&gt; Functor (UnboundedConvexRegionF r nonEmpty)
forall a b.
a
-&gt; UnboundedConvexRegionF r nonEmpty b
-&gt; UnboundedConvexRegionF r nonEmpty a
forall a b.
(a -&gt; b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; UnboundedConvexRegionF r nonEmpty b
forall r (nonEmpty :: * -&gt; *) a b.
Functor nonEmpty =&gt;
a
-&gt; UnboundedConvexRegionF r nonEmpty b
-&gt; UnboundedConvexRegionF r nonEmpty a
forall r (nonEmpty :: * -&gt; *) a b.
Functor nonEmpty =&gt;
(a -&gt; b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; UnboundedConvexRegionF r nonEmpty b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall r (nonEmpty :: * -&gt; *) a b.
Functor nonEmpty =&gt;
(a -&gt; b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; UnboundedConvexRegionF r nonEmpty b
fmap :: forall a b.
(a -&gt; b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; UnboundedConvexRegionF r nonEmpty b
$c&lt;$ :: forall r (nonEmpty :: * -&gt; *) a b.
Functor nonEmpty =&gt;
a
-&gt; UnboundedConvexRegionF r nonEmpty b
-&gt; UnboundedConvexRegionF r nonEmpty a
&lt;$ :: forall a b.
a
-&gt; UnboundedConvexRegionF r nonEmpty b
-&gt; UnboundedConvexRegionF r nonEmpty a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679295211"><span id="local-6989586621679295217"><span id="local-6989586621679295222"><span id="local-6989586621679295227"><span id="local-6989586621679295230"><span id="local-6989586621679295233"><span id="local-6989586621679295236"><span id="local-6989586621679295239"><span id="local-6989586621679295242"><span id="local-6989586621679295245"><span id="local-6989586621679295248"><span id="local-6989586621679295251"><span id="local-6989586621679295254"><span id="local-6989586621679295259"><span id="local-6989586621679295264"><span id="local-6989586621679295269"><span id="local-6989586621679295274"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; UnboundedConvexRegionF r nonEmpty m -&gt; m)
-&gt; (forall m a.
    Monoid m =&gt;
    (a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m)
-&gt; (forall m a.
    Monoid m =&gt;
    (a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m)
-&gt; (forall a b.
    (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b)
-&gt; (forall a b.
    (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b)
-&gt; (forall b a.
    (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b)
-&gt; (forall b a.
    (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b)
-&gt; (forall a.
    (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a.
    (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a. UnboundedConvexRegionF r nonEmpty a -&gt; [a])
-&gt; (forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Bool)
-&gt; (forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Int)
-&gt; (forall a.
    Eq a =&gt;
    a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; Foldable (UnboundedConvexRegionF r nonEmpty)
forall a. Eq a =&gt; a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool
forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
forall m. Monoid m =&gt; UnboundedConvexRegionF r nonEmpty m -&gt; m
forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Bool
forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Int
forall a. UnboundedConvexRegionF r nonEmpty a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
forall m a.
Monoid m =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
forall b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
forall a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Eq a) =&gt;
a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool
forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Num a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Ord a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
forall r (nonEmpty :: * -&gt; *) m.
(Foldable nonEmpty, Monoid m) =&gt;
UnboundedConvexRegionF r nonEmpty m -&gt; m
forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; Bool
forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; Int
forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; [a]
forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
(a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
forall r (nonEmpty :: * -&gt; *) m a.
(Foldable nonEmpty, Monoid m) =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
forall r (nonEmpty :: * -&gt; *) b a.
Foldable nonEmpty =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
forall r (nonEmpty :: * -&gt; *) a b.
Foldable nonEmpty =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall r (nonEmpty :: * -&gt; *) m.
(Foldable nonEmpty, Monoid m) =&gt;
UnboundedConvexRegionF r nonEmpty m -&gt; m
fold :: forall m. Monoid m =&gt; UnboundedConvexRegionF r nonEmpty m -&gt; m
$cfoldMap :: forall r (nonEmpty :: * -&gt; *) m a.
(Foldable nonEmpty, Monoid m) =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
foldMap :: forall m a.
Monoid m =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
$cfoldMap' :: forall r (nonEmpty :: * -&gt; *) m a.
(Foldable nonEmpty, Monoid m) =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
foldMap' :: forall m a.
Monoid m =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
$cfoldr :: forall r (nonEmpty :: * -&gt; *) a b.
Foldable nonEmpty =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
foldr :: forall a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
$cfoldr' :: forall r (nonEmpty :: * -&gt; *) a b.
Foldable nonEmpty =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
foldr' :: forall a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
$cfoldl :: forall r (nonEmpty :: * -&gt; *) b a.
Foldable nonEmpty =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
foldl :: forall b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
$cfoldl' :: forall r (nonEmpty :: * -&gt; *) b a.
Foldable nonEmpty =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
foldl' :: forall b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
$cfoldr1 :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
(a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$cfoldl1 :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
(a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$ctoList :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; [a]
toList :: forall a. UnboundedConvexRegionF r nonEmpty a -&gt; [a]
$cnull :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; Bool
null :: forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Bool
$clength :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; Int
length :: forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Int
$celem :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Eq a) =&gt;
a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool
$cmaximum :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Ord a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
maximum :: forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$cminimum :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Ord a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
minimum :: forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$csum :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Num a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
sum :: forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$cproduct :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Num a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
product :: forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679295290"><span id="local-6989586621679295297"><span id="local-6989586621679295303"><span id="local-6989586621679295308"><span class="annot"><span class="annottext">Functor (UnboundedConvexRegionF r nonEmpty)
Foldable (UnboundedConvexRegionF r nonEmpty)
(Functor (UnboundedConvexRegionF r nonEmpty),
 Foldable (UnboundedConvexRegionF r nonEmpty)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b)
 -&gt; UnboundedConvexRegionF r nonEmpty a
 -&gt; f (UnboundedConvexRegionF r nonEmpty b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    UnboundedConvexRegionF r nonEmpty (f a)
    -&gt; f (UnboundedConvexRegionF r nonEmpty a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b)
    -&gt; UnboundedConvexRegionF r nonEmpty a
    -&gt; m (UnboundedConvexRegionF r nonEmpty b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    UnboundedConvexRegionF r nonEmpty (m a)
    -&gt; m (UnboundedConvexRegionF r nonEmpty a))
-&gt; Traversable (UnboundedConvexRegionF r nonEmpty)
forall r (nonEmpty :: * -&gt; *).
Traversable nonEmpty =&gt;
Functor (UnboundedConvexRegionF r nonEmpty)
forall r (nonEmpty :: * -&gt; *).
Traversable nonEmpty =&gt;
Foldable (UnboundedConvexRegionF r nonEmpty)
forall r (nonEmpty :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable nonEmpty, Monad m) =&gt;
UnboundedConvexRegionF r nonEmpty (m a)
-&gt; m (UnboundedConvexRegionF r nonEmpty a)
forall r (nonEmpty :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable nonEmpty, Applicative f) =&gt;
UnboundedConvexRegionF r nonEmpty (f a)
-&gt; f (UnboundedConvexRegionF r nonEmpty a)
forall r (nonEmpty :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable nonEmpty, Monad m) =&gt;
(a -&gt; m b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; m (UnboundedConvexRegionF r nonEmpty b)
forall r (nonEmpty :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable nonEmpty, Applicative f) =&gt;
(a -&gt; f b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; f (UnboundedConvexRegionF r nonEmpty b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
UnboundedConvexRegionF r nonEmpty (m a)
-&gt; m (UnboundedConvexRegionF r nonEmpty a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
UnboundedConvexRegionF r nonEmpty (f a)
-&gt; f (UnboundedConvexRegionF r nonEmpty a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; m (UnboundedConvexRegionF r nonEmpty b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; f (UnboundedConvexRegionF r nonEmpty b)
$ctraverse :: forall r (nonEmpty :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable nonEmpty, Applicative f) =&gt;
(a -&gt; f b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; f (UnboundedConvexRegionF r nonEmpty b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; f (UnboundedConvexRegionF r nonEmpty b)
$csequenceA :: forall r (nonEmpty :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable nonEmpty, Applicative f) =&gt;
UnboundedConvexRegionF r nonEmpty (f a)
-&gt; f (UnboundedConvexRegionF r nonEmpty a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
UnboundedConvexRegionF r nonEmpty (f a)
-&gt; f (UnboundedConvexRegionF r nonEmpty a)
$cmapM :: forall r (nonEmpty :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable nonEmpty, Monad m) =&gt;
(a -&gt; m b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; m (UnboundedConvexRegionF r nonEmpty b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; m (UnboundedConvexRegionF r nonEmpty b)
$csequence :: forall r (nonEmpty :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable nonEmpty, Monad m) =&gt;
UnboundedConvexRegionF r nonEmpty (m a)
-&gt; m (UnboundedConvexRegionF r nonEmpty a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
UnboundedConvexRegionF r nonEmpty (m a)
-&gt; m (UnboundedConvexRegionF r nonEmpty a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><span class="hs-identifier hs-var">NumType</span></span></span><span>   </span><span id="local-6989586621679295317"><span id="local-6989586621679295318"><span id="local-6989586621679295319"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295317"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295318"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295319"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679295317"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><span class="hs-identifier hs-var">Dimension</span></span></span><span> </span><span id="local-6989586621679295320"><span id="local-6989586621679295321"><span id="local-6989586621679295322"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295320"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295321"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295322"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="annot"><span class="hs-comment">-- | map a function over the sequence of points</span></span><span>
</span><span id="line-65"></span><span id="local-6989586621679294902"><span id="local-6989586621679294903"><span id="local-6989586621679294904"><span id="local-6989586621679294905"><span id="local-6989586621679294906"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#mapChain"><span class="hs-identifier hs-type">mapChain</span></a></span><span>                       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679294902"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294903"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294904"><span class="hs-identifier hs-type">nonEmpty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294905"><span class="hs-identifier hs-type">vertex'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294906"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294902"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294903"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-67"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294906"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294904"><span class="hs-identifier hs-type">nonEmpty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294905"><span class="hs-identifier hs-type">vertex'</span></a></span></span></span></span></span></span><span>
</span><span id="line-68"></span><span id="mapChain"><span class="annot"><span class="annottext">mapChain :: forall {k} {k} (nonEmpty :: k -&gt; *) (vertex :: k)
       (nonEmpty' :: k -&gt; *) (vertex' :: k) r.
(nonEmpty vertex -&gt; nonEmpty' vertex')
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty' vertex'
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#mapChain"><span class="hs-identifier hs-var hs-var">mapChain</span></a></span></span><span> </span><span id="local-6989586621679295323"><span class="annot"><span class="annottext">nonEmpty vertex -&gt; nonEmpty' vertex'
</span><a href="#local-6989586621679295323"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span id="local-6989586621679295324"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295324"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679295325"><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679295325"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span id="local-6989586621679295326"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295326"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
-&gt; nonEmpty' vertex'
-&gt; Vector 2 r
-&gt; UnboundedConvexRegionF r nonEmpty' vertex'
forall {k} r (nonEmpty :: k -&gt; *) (vertex :: k).
Vector 2 r
-&gt; nonEmpty vertex
-&gt; Vector 2 r
-&gt; UnboundedConvexRegionF r nonEmpty vertex
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-var">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295324"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">nonEmpty vertex -&gt; nonEmpty' vertex'
</span><a href="#local-6989586621679295323"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679295325"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295326"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Compute the first and last vertex of the chain. Returns a Left if the first and last</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- are the same.</span><span>
</span><span id="line-72"></span><span id="local-6989586621679294918"><span id="local-6989586621679294919"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-type">extremalVertices</span></a></span><span>                            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294918"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679294919"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-73"></span><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679294919"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679294919"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-74"></span><span id="extremalVertices"><span class="annot"><span class="annottext">extremalVertices :: forall r vertex.
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-var hs-var">extremalVertices</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679295327"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295327"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679295329"><span class="annot"><span class="annottext">[vertex]
</span><a href="#local-6989586621679295329"><span class="hs-identifier hs-var">pts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[vertex] -&gt; Maybe (NonEmpty vertex)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NonEmpty.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[vertex]
</span><a href="#local-6989586621679295329"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-75"></span><span>                                                </span><span class="annot"><span class="annottext">Maybe (NonEmpty vertex)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Either vertex (Vector 2 vertex)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295327"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-76"></span><span>                                                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679295331"><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679295331"><span class="hs-identifier hs-var">pts'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex -&gt; Either vertex (Vector 2 vertex)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex -&gt; Either vertex (Vector 2 vertex))
-&gt; Vector 2 vertex -&gt; Either vertex (Vector 2 vertex)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Vector 2 vertex
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295327"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty vertex -&gt; vertex
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.last</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679295331"><span class="hs-identifier hs-var">pts'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Computes the two bounding rays of the unbounded region. Note that the rays now are</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- both pointing toward infinity. The second ray has the unbounded region to its left,</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- whereas the first one has it to its right.</span><span>
</span><span id="line-81"></span><span id="local-6989586621679294931"><span id="local-6989586621679294932"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier hs-type">boundingRays</span></a></span><span>                          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679294931"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679294932"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679294932"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>                                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294932"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679294931"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-83"></span><span>                                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="annot"><a href="#local-6989586621679294931"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-84"></span><span id="boundingRays"><span class="annot"><span class="annottext">boundingRays :: forall vertex r.
(Point_ vertex 2 r, Num r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier hs-var hs-var">boundingRays</span></a></span></span><span> </span><span id="local-6989586621679295373"><span class="annot"><span class="annottext">chain :: UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679295373"><span class="hs-identifier hs-var">chain</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span id="local-6989586621679295374"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295374"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679295375"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295375"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex -&gt; Vector 2 (HalfLine vertex)
</span><a href="#local-6989586621679295376"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex -&gt; Vector 2 (HalfLine vertex))
-&gt; Vector 2 vertex -&gt; Vector 2 (HalfLine vertex)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
forall r vertex.
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-var">extremalVertices</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679295373"><span class="hs-identifier hs-var">chain</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>                                     </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679295377"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295377"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Vector 2 vertex
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295377"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295377"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-86"></span><span>                                     </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679295378"><span class="annot"><span class="annottext">Vector 2 vertex
</span><a href="#local-6989586621679295378"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex
</span><a href="#local-6989586621679295378"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679295376"><span class="annot"><span class="annottext">compute :: Vector 2 vertex -&gt; Vector 2 (HalfLine vertex)
</span><a href="#local-6989586621679295376"><span class="hs-identifier hs-var hs-var">compute</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679295379"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295379"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679295380"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295380"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HalfLine vertex -&gt; HalfLine vertex -&gt; Vector 2 (HalfLine vertex)
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; Vector (Dimension vertex) (NumType vertex) -&gt; HalfLine vertex
forall point.
point -&gt; Vector (Dimension point) (NumType point) -&gt; HalfLine point
</span><span class="hs-identifier hs-var">HalfLine</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295379"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Dimension vertex) (NumType vertex) -&gt; HalfLine vertex)
-&gt; Vector (Dimension vertex) (NumType vertex) -&gt; HalfLine vertex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
vector -&gt; vector
</span><span class="hs-identifier hs-var">negated</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295374"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; Vector (Dimension vertex) (NumType vertex) -&gt; HalfLine vertex
forall point.
point -&gt; Vector (Dimension point) (NumType point) -&gt; HalfLine point
</span><span class="hs-identifier hs-var">HalfLine</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295380"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension vertex) (NumType vertex)
</span><a href="#local-6989586621679295375"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">{-
data Cone r apex = Cone { _apex                   :: apex
                        , _leftBoundingDirection  :: Vector 2 r
                        , _rightBoundingDirection :: Vector 2 r
                        }
                 deriving (Show,Eq)
makeLenses ''Cone

type instance Dimension (Cone r apex) = 2
type instance NumType   (Cone r apex) = r
-}</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- newtype VerticalLine r = VerticalLineThrough r</span><span>
</span><span id="line-108"></span><span class="hs-comment">--   deriving (Show,Read,Eq,Ord,Functor,Foldable,Traversable)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- type instance NumType   (VerticalLine r) = r</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- type instance Dimension (VerticalLine r) = 2</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">{-

-- TODO: for this to be useful we probably want to know *which* edges the half line intersects
data LineUnboundedConvexRegionIntersection r vertex =
    Line_x_UnboundedConvexRegion_BoundedEdge (ClosedLineSegment vertex)
  | Line_x_UnboundedConvexRegion_UnBoundedEdge (HalfLine vertex)
  | Line_x_UnboundedConvexRegion_HalfLine      (HalfLine (Point 2 r))
  | Line_x_UnboundedConvexRegion_Tangent vertex
  | Line_x_UnboundedConvexRegion_LineSegment (ClosedLineSegment (Point 2 r))
  -- deriving (Show,Eq)

type instance Intersection (LinePV 2 r) (UnboundedConvexRegionF r nonEmpty vertex)
  = AtMostTwo (Point 2 r)

instance ( Point_ vertex 2 r, Num r, Ord r
         ) =&gt; LinePV 2 r `IsIntersectableWith` UnboundedConvexRegionF r NonEmpty vertex where
  line `intersect` reg@(Unbounded _ pts' _) = case (line `intersect'`) &lt;$&gt; boundingRays reg of
      Vector2 Nothing Nothing   -&gt; findIntersections Zero
      Vector2 (Just p) (Just q) -&gt; Two p q
      Vector2 (Just p) Nothing  -&gt; findIntersections (One p)
      Vector2 Nothing  (Just q) -&gt; findIntersections (One q)
    where
      pts    = (^.asPoint) &lt;$&gt; pts'
      edges' = zipWith OpenLineSegment (F.toList pts) (NonEmpty.tail pts)
      findIntersections = findIntersectingVertices  . findIntersectingEdges
      -- | Finds intersection with edges
      findIntersectingEdges z = foldr (\e acc -&gt; case line `intersect` e of
                                               Nothing -&gt; acc
                                               Just p  -&gt; inc p acc
                                  ) z edges'
      findIntersectingVertices z = foldr (\p acc -&gt; if p `intersect` line then inc p acc else acc
                                         ) z pts

      inc p = \case
        Zero  -&gt; One p
        One a -&gt; Two p a
        two   -&gt; two

instance ( Point_ vertex 2 r, Num r, Ord r
         ) =&gt; LinePV 2 r `HasIntersectionWith` UnboundedConvexRegionF r NonEmpty vertex where
  line `intersects` reg = case line `intersect` reg of
                            Zero -&gt; True
                            _    -&gt; False



-}</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- type BoundedComponent nonEmpty r vertex =</span><span>
</span><span id="line-163"></span><span class="hs-comment">--   PossiblyDegenerateSimplePolygon vertex (ConvexPolygonF nonEmpty (OriginalOrCanonical vertex))</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- data HalfPlaneUnboundedConvexIntersection r nonEmpty vertex =</span><span>
</span><span id="line-167"></span><span class="hs-comment">--     HalfPlane_x_UnboundedConvexRegion_Bounded</span><span>
</span><span id="line-168"></span><span class="hs-comment">--        (BoundedComponent nonEmpty r vertex)</span><span>
</span><span id="line-169"></span><span class="hs-comment">--   | HalfPlane_x_UnboundedConvexRegion_Unbounded</span><span>
</span><span id="line-170"></span><span class="hs-comment">--        (UnboundedConvexRegionF r nonEmpty (OriginalOrCanonical vertex))</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- deriving instance ( Show r, Show vertex, Point_ vertex 2 r</span><span>
</span><span id="line-174"></span><span class="hs-comment">--                   , SimplePolygon_ (ConvexPolygonF nonEmpty (OriginalOrCanonical vertex))</span><span>
</span><span id="line-175"></span><span class="hs-comment">--                                    (OriginalOrCanonical vertex)</span><span>
</span><span id="line-176"></span><span class="hs-comment">--                   )</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- =&gt;</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   Show (HalfPlaneUnboundedConvexIntersection r nonEmpty vertex)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- type instance Intersection (HalfPlaneF line) (UnboundedConvexRegionF r nonEmpty vertex)</span><span>
</span><span id="line-181"></span><span class="hs-comment">--   = Maybe (HalfPlaneUnboundedConvexIntersection r nonEmpty vertex)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- instance ( Point_ vertex 2 r, Num r, Ord r</span><span>
</span><span id="line-184"></span><span class="hs-comment">--          , HyperPlane_ line 2 r</span><span>
</span><span id="line-185"></span><span class="hs-comment">--          , HalfLine vertex `HasIntersectionWith` HalfPlaneF line</span><span>
</span><span id="line-186"></span><span class="hs-comment">--          ) =&gt; HalfPlaneF line `IsIntersectableWith` UnboundedConvexRegionF r NonEmpty vertex where</span><span>
</span><span id="line-187"></span><span class="hs-comment">--   h `intersect` (Unbounded u chain v) = undefined</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">--     do (u',chain0) &lt;- trimChain  tri u chain</span><span>
</span><span id="line-192"></span><span class="hs-comment">--                                            (v',chain') &lt;- trimRChain tri v chain0</span><span>
</span><span id="line-193"></span><span class="hs-comment">--                                            pure</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- c</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">--     go v pts</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">--     where</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- -- | Trims the chain; making sure the remaining vertices lie in the convex region</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- trimChain     :: (Point_ point 2 r, Num r, Ord r, Point 2 r `HasIntersectionWith` convexRegion)</span><span>
</span><span id="line-204"></span><span class="hs-comment">--               =&gt; convexRegion -- ^ Convex region we are intersecting</span><span>
</span><span id="line-205"></span><span class="hs-comment">--               -&gt; Vector 2 r  -- ^ Vector into the first vertex of the chain</span><span>
</span><span id="line-206"></span><span class="hs-comment">--               -&gt; NonEmpty point -- ^ Convex Chain of vertices</span><span>
</span><span id="line-207"></span><span class="hs-comment">--               -&gt; Maybe (Vector 2 r, NonEmpty point) -- ^ Vector into the vertex of the chain</span><span>
</span><span id="line-208"></span><span class="hs-comment">--               -- and the first point on the chain that lies in the covnex region</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- trimChain tri = go</span><span>
</span><span id="line-210"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-211"></span><span class="hs-comment">--     go u chain@(p :| rest)</span><span>
</span><span id="line-212"></span><span class="hs-comment">--       | (p^.asPoint) `intersects` tri = Just (u,chain)</span><span>
</span><span id="line-213"></span><span class="hs-comment">--       | otherwise                     = case NonEmpty.nonEmpty rest of</span><span>
</span><span id="line-214"></span><span class="hs-comment">--                                           Nothing           -&gt; Nothing</span><span>
</span><span id="line-215"></span><span class="hs-comment">--                                           Just rest'@(q:|_) -&gt; go (q .-. p) rest'</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- trimRChain       :: (Point_ corner 2 r, Point_ point 2 r, Num r, Ord r)</span><span>
</span><span id="line-218"></span><span class="hs-comment">--                  =&gt; Triangle corner</span><span>
</span><span id="line-219"></span><span class="hs-comment">--                  -&gt; Vector 2 r -&gt; NonEmpty point -&gt; Maybe (Vector 2 r, NonEmpty point)</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- trimRChain tri v = either (const Nothing) Just . go</span><span>
</span><span id="line-221"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-222"></span><span class="hs-comment">--     -- main idea: we compute either the result (i.e. the vector and the chain), or</span><span>
</span><span id="line-223"></span><span class="hs-comment">--     -- the first point of the suffix  that lies outside the triangle</span><span>
</span><span id="line-224"></span><span class="hs-comment">--     go chain@(p :| rest) = case NonEmpty.nonEmpty rest of</span><span>
</span><span id="line-225"></span><span class="hs-comment">--       Nothing</span><span>
</span><span id="line-226"></span><span class="hs-comment">--         | (p^.asPoint) `intersects` tri -&gt; Right (v,chain)</span><span>
</span><span id="line-227"></span><span class="hs-comment">--         | otherwise                     -&gt; Left p</span><span>
</span><span id="line-228"></span><span class="hs-comment">--       Just rest'                        -&gt; case go rest' of</span><span>
</span><span id="line-229"></span><span class="hs-comment">--         Left q</span><span>
</span><span id="line-230"></span><span class="hs-comment">--           | (p^.asPoint) `intersects` tri -&gt; Right (q .-. p, NonEmpty.singleton p)</span><span>
</span><span id="line-231"></span><span class="hs-comment">--           | otherwise                     -&gt; Left p</span><span>
</span><span id="line-232"></span><span class="hs-comment">--         Right (w,result)                  -&gt; Right (w, p NonEmpty.&lt;| result)</span><span>
</span><span id="line-233"></span><span class="hs-comment">--   -- TODO: hmm, come to think of it; can't the chain enter/exit the triangle multiple times?</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- (Unbounded u chain v)</span><span>
</span><span id="line-239"></span><span class="hs-comment">--                             -&gt; do (u',chain0) &lt;- trimChain  tri u chain</span><span>
</span><span id="line-240"></span><span class="hs-comment">--                                   (v',chain') &lt;- trimRChain tri v chain0</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679294974"><span id="local-6989586621679294975"><span id="local-6989586621679294976"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679294974"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679294975"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679294975"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679294975"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-244"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HyperPlane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679294976"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679294975"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-245"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="annot"><a href="#local-6989586621679294974"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HalfPlaneF</span></span><span> </span><span class="annot"><a href="#local-6989586621679294976"><span class="hs-identifier hs-type">line</span></a></span><span>
</span><span id="line-246"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HalfPlaneF</span></span><span> </span><span class="annot"><a href="#local-6989586621679294976"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294975"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679294974"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679295417"><span class="annot"><span class="annottext">HalfPlaneF line
</span><a href="#local-6989586621679295417"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679295418"><span class="annot"><span class="annottext">intersects :: HalfPlaneF line -&gt; UnboundedConvexRegionF r NonEmpty vertex -&gt; Bool
</span><a href="#local-6989586621679295418"><span class="hs-operator hs-var hs-var hs-var">`intersects`</span></a></span></span><span> </span><span id="local-6989586621679295420"><span class="annot"><span class="annottext">reg :: UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679295420"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679295421"><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679295421"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HalfLine vertex -&gt; Bool) -&gt; Vector 2 (HalfLine vertex) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HalfLine vertex -&gt; HalfPlaneF line -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfPlaneF line
</span><a href="#local-6989586621679295417"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
forall vertex r.
(Point_ vertex 2 r, Num r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier hs-var">boundingRays</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679295420"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>                                        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Getting Any (NonEmpty vertex) (Point 2 r)
-&gt; (Point 2 r -&gt; Bool) -&gt; NonEmpty vertex -&gt; Bool
forall s a. Getting Any s a -&gt; (a -&gt; Bool) -&gt; s -&gt; Bool
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#anyOf"><span class="hs-identifier hs-var">anyOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(vertex -&gt; Const Any vertex)
-&gt; NonEmpty vertex -&gt; Const Any (NonEmpty vertex)
forall (f :: * -&gt; *) a. Foldable f =&gt; IndexedFold Int (f a) a
IndexedFold Int (NonEmpty vertex) vertex
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#folded"><span class="hs-identifier hs-var">folded</span></a></span><span class="annot"><span class="annottext">((vertex -&gt; Const Any vertex)
 -&gt; NonEmpty vertex -&gt; Const Any (NonEmpty vertex))
-&gt; ((Point 2 r -&gt; Const Any (Point 2 r))
    -&gt; vertex -&gt; Const Any vertex)
-&gt; Getting Any (NonEmpty vertex) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const Any (Point 2 r)) -&gt; vertex -&gt; Const Any vertex
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' vertex (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfPlaneF line -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfPlaneF line
</span><a href="#local-6989586621679295417"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679295421"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- -- | given a vertical line l through point (x,0) that intersects the unbounded convex region</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- -- intersect the convex region with the left halfplane of l.</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- intersectVerticalLeft :: r -&gt; UnboundedConvexRegionF r nonEmpty vertex</span><span>
</span><span id="line-260"></span><span class="hs-comment">--                            -&gt; Either (UnboundedConvexRegionF r nonEmpty vertex)</span><span>
</span><span id="line-261"></span><span class="hs-comment">--                                      (ConvexPolygonF NonEmpty vertex)</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- intersectVerticalLeft x chain@(Chain v pts w) =</span><span>
</span><span id="line-263"></span><span class="hs-comment">--   case (verticalLine x `intersect`) &lt;$&gt; boundingRays chain of</span><span>
</span><span id="line-264"></span><span class="hs-comment">--     Vector2 Nothing Nothing</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Intersection"><span class="annot"><span class="hs-identifier hs-var">Intersection</span></span></span><span> </span><span id="local-6989586621679295428"><span id="local-6989586621679295429"><span id="local-6989586621679295430"><span id="local-6989586621679295431"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679295428"><span class="hs-identifier hs-type">corner</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295429"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295430"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295431"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Intersection</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679295428"><span class="hs-identifier hs-type">corner</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Internal.html#ConvexPolygonF"><span class="hs-identifier hs-type">ConvexPolygonF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295430"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295431"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679295018"><span id="local-6989586621679295019"><span id="local-6989586621679295020"><span id="local-6989586621679295437"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679295018"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679295019"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679295020"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679295019"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679295019"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679295019"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-273"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679295020"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295019"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679295018"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679295015"><span id="local-6989586621679295016"><span id="local-6989586621679295017"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679295015"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679295016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679295017"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679295016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679295016"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679295016"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-276"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679295017"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`IsIntersectableWith`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295016"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679295015"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679295627"><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679295627"><span class="hs-identifier hs-var">tri</span></a></span></span><span> </span><span id="local-6989586621679295628"><span class="annot"><span class="annottext">intersect :: Triangle corner
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; Intersection
     (Triangle corner) (UnboundedConvexRegionF r NonEmpty vertex)
</span><a href="#local-6989586621679295628"><span class="hs-operator hs-var hs-var hs-var">`intersect`</span></a></span></span><span> </span><span id="local-6989586621679295630"><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679295630"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679295627"><span class="hs-identifier hs-var">tri</span></a></span><span> </span><span class="annot"><span class="annottext">Triangle corner
-&gt; ConvexPolygonF NonEmpty vertex
-&gt; Intersection (Triangle corner) (ConvexPolygonF NonEmpty vertex)
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triangle corner
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; ConvexPolygonF NonEmpty vertex
forall (nonEmpty :: * -&gt; *) point r vertex.
(Foldable nonEmpty, Point_ point 2 r, Point_ vertex 2 r, Ord r,
 Fractional r) =&gt;
nonEmpty point
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; ConvexPolygonF NonEmpty vertex
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier hs-var">toBoundedFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679295627"><span class="hs-identifier hs-var">tri</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679295630"><span class="hs-identifier hs-var">region</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Given some convex shape S, construct some &quot;big enough&quot; convex polygon B out of the</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- unbounded convex polygon U so that the intersection \(U \cap S\) is the same as \(B</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- \cap S\)</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- note: this creates some new vertices; which are &quot;copies&quot; from the extremal vertices.</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- this is to avoid having to introduce yet another level of 'OriginalOrExtra''s</span><span>
</span><span id="line-285"></span><span id="local-6989586621679295045"><span id="local-6989586621679295046"><span id="local-6989586621679295047"><span id="local-6989586621679295048"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier hs-type">toBoundedFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679295045"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679295046"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679295047"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679295048"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679295047"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679295047"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679295047"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679295045"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295046"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679295047"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679295048"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-287"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Internal.html#ConvexPolygonF"><span class="hs-identifier hs-type">ConvexPolygonF</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679295048"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span></span><span>
</span><span id="line-288"></span><span id="toBoundedFrom"><span class="annot"><span class="annottext">toBoundedFrom :: forall (nonEmpty :: * -&gt; *) point r vertex.
(Foldable nonEmpty, Point_ point 2 r, Point_ vertex 2 r, Ord r,
 Fractional r) =&gt;
nonEmpty point
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; ConvexPolygonF NonEmpty vertex
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier hs-var hs-var">toBoundedFrom</span></a></span></span><span> </span><span id="local-6989586621679295799"><span class="annot"><span class="annottext">nonEmpty point
</span><a href="#local-6989586621679295799"><span class="hs-identifier hs-var">tri</span></a></span></span><span> </span><span id="local-6989586621679295800"><span class="annot"><span class="annottext">reg :: UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679295800"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span id="local-6989586621679295801"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295801"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679295802"><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679295802"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span id="local-6989586621679295803"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295803"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex -&gt; ConvexPolygonF NonEmpty vertex
</span><a href="#local-6989586621679295804"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex -&gt; ConvexPolygonF NonEmpty vertex)
-&gt; Vector 2 vertex -&gt; ConvexPolygonF NonEmpty vertex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
forall r vertex.
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-var">extremalVertices</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679295800"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>                                                   </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679295805"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295805"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Vector 2 vertex
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295805"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295805"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-290"></span><span>                                                   </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679295806"><span class="annot"><span class="annottext">Vector 2 vertex
</span><a href="#local-6989586621679295806"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex
</span><a href="#local-6989586621679295806"><span class="hs-identifier hs-var">vec</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-comment">-- the main idea is to compute the line through two points on the boundary of the of</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-comment">-- halflines bounding the region, and consider the halfplane h that is bounded by this</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-comment">-- line l and contains the vertices of the unbounded region. We now find the furthest</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-comment">-- point pt from h (among the points in tri), and construct a line l' through this</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-comment">-- furthest point. It follows all points in tri lie &quot;right&quot; of this line (on the same</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-comment">-- side as the vertices of our unbounded region). Hence, we can safely clip the region</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-comment">-- using this line l'. (So we compute the intersection point between the two bounding</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-comment">-- rays and l') to find the two additional vertices a and b that we have to insert.</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679295804"><span class="annot"><span class="annottext">go :: Vector 2 vertex -&gt; ConvexPolygonF NonEmpty vertex
</span><a href="#local-6989586621679295804"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679295807"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295807"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679295808"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295808"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex -&gt; ConvexPolygonF NonEmpty vertex
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable1 f) =&gt;
f point -&gt; simplePolygon
forall (f :: * -&gt; *).
Foldable1 f =&gt;
f vertex -&gt; ConvexPolygonF NonEmpty vertex
</span><a href="HGeometry.Polygon.Simple.Class.html#uncheckedFromCCWPoints"><span class="hs-identifier hs-var">uncheckedFromCCWPoints</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty vertex -&gt; ConvexPolygonF NonEmpty vertex)
-&gt; NonEmpty vertex -&gt; ConvexPolygonF NonEmpty vertex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295810"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; NonEmpty vertex -&gt; NonEmpty vertex
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NonEmpty.&lt;|</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295812"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; NonEmpty vertex -&gt; NonEmpty vertex
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NonEmpty.&lt;|</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679295802"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>      </span><span id="local-6989586621679295813"><span class="annot"><span class="annottext">l :: LinePV 2 r
</span><a href="#local-6989586621679295813"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; LinePV 2 r
forall line point (d :: Nat) r.
(Line_ line d r, Point_ point d r, Num r) =&gt;
point -&gt; point -&gt; line
</span><span class="hs-identifier hs-var">lineThrough</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295807"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Vector 2 r -&gt; vertex
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
vector -&gt; vector
</span><span class="hs-identifier hs-var">negated</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295801"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295808"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Vector 2 r -&gt; vertex
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295803"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-305"></span><span>      </span><span id="local-6989586621679295932"><span class="annot"><span class="annottext">h' :: HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679295932"><span class="hs-identifier hs-var hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sign -&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
forall boundingHyperPlane.
Sign -&gt; boundingHyperPlane -&gt; HalfSpaceF boundingHyperPlane
</span><span class="hs-identifier hs-var">HalfSpace</span></span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sign.html/HGeometry.Sign.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679295813"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-306"></span><span>      </span><span id="local-6989586621679295935"><span class="annot"><span class="annottext">h :: HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679295935"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679295936"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfSpaceF (LinePV 2 r) -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679295932"><span class="hs-identifier hs-var">h'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679295932"><span class="hs-identifier hs-var">h'</span></a></span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
-&gt; (HalfSpaceF (LinePV 2 r) -&gt; HalfSpaceF (LinePV 2 r))
-&gt; HalfSpaceF (LinePV 2 r)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Sign -&gt; Identity Sign)
-&gt; HalfSpaceF (LinePV 2 r) -&gt; Identity (HalfSpaceF (LinePV 2 r))
forall halfSpace (d :: Nat) r.
HalfSpace_ halfSpace d r =&gt;
Lens' halfSpace Sign
Lens' (HalfSpaceF (LinePV 2 r)) Sign
</span><span class="hs-identifier hs-var">halfSpaceSign</span></span><span> </span><span class="annot"><span class="annottext">((Sign -&gt; Identity Sign)
 -&gt; HalfSpaceF (LinePV 2 r) -&gt; Identity (HalfSpaceF (LinePV 2 r)))
-&gt; Sign -&gt; HalfSpaceF (LinePV 2 r) -&gt; HalfSpaceF (LinePV 2 r)
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.10.1/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sign.html/HGeometry.Sign.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679295932"><span class="hs-identifier hs-var">h'</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span id="local-6989586621679295936"><span class="annot"><span class="annottext">q' :: Point 2 r
</span><a href="#local-6989586621679295936"><span class="hs-identifier hs-var hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295808"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Vector 2 r -&gt; vertex
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295803"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Additive_ vector d r) =&gt;
vector -&gt; vector -&gt; vector
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679295803"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">vertex -&gt; Getting (Point 2 r) vertex (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) vertex (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' vertex (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-comment">-- make sure that there is at least one point outside the halfplane</span><span>
</span><span id="line-309"></span><span>      </span><span id="local-6989586621679295943"><span class="annot"><span class="annottext">pt :: Point 2 r
</span><a href="#local-6989586621679295943"><span class="hs-identifier hs-var hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; r) -&gt; NonEmpty (Point 2 r) -&gt; Point 2 r
forall {t :: * -&gt; *} {a} {a}.
(Foldable1 t, Ord a) =&gt;
(a -&gt; a) -&gt; t a -&gt; a
</span><a href="#local-6989586621679295944"><span class="hs-identifier hs-var">maximumOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfSpaceF (LinePV 2 r) -&gt; r
forall g r (d :: Nat) point.
(HasSquaredEuclideanDistance g, r ~ NumType g, d ~ Dimension g,
 Num r, Point_ point d r) =&gt;
point -&gt; g -&gt; r
forall r (d :: Nat) point.
(r ~ NumType (HalfSpaceF (LinePV 2 r)),
 d ~ Dimension (HalfSpaceF (LinePV 2 r)), Num r,
 Point_ point d r) =&gt;
point -&gt; HalfSpaceF (LinePV 2 r) -&gt; r
</span><span class="hs-operator hs-var">`squaredEuclideanDistTo`</span></span><span> </span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679295935"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679295936"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; [Point 2 r] -&gt; NonEmpty (Point 2 r)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">nonEmpty point
</span><a href="#local-6989586621679295799"><span class="hs-identifier hs-var">tri</span></a></span><span class="annot"><span class="annottext">nonEmpty point
-&gt; Getting (Endo [Point 2 r]) (nonEmpty point) (Point 2 r)
-&gt; [Point 2 r]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">(point -&gt; Const (Endo [Point 2 r]) point)
-&gt; nonEmpty point -&gt; Const (Endo [Point 2 r]) (nonEmpty point)
forall (f :: * -&gt; *) a. Foldable f =&gt; IndexedFold Int (f a) a
IndexedFold Int (nonEmpty point) point
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Fold.html/Control.Lens.Fold.html#folded"><span class="hs-identifier hs-var">folded</span></a></span><span class="annot"><span class="annottext">((point -&gt; Const (Endo [Point 2 r]) point)
 -&gt; nonEmpty point -&gt; Const (Endo [Point 2 r]) (nonEmpty point))
-&gt; ((Point 2 r -&gt; Const (Endo [Point 2 r]) (Point 2 r))
    -&gt; point -&gt; Const (Endo [Point 2 r]) point)
-&gt; Getting (Endo [Point 2 r]) (nonEmpty point) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Endo [Point 2 r]) (Point 2 r))
-&gt; point -&gt; Const (Endo [Point 2 r]) point
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-comment">-- the furthest point in the direction perpendicular to the halfplane</span><span>
</span><span id="line-311"></span><span>      </span><span id="local-6989586621679295947"><span class="annot"><span class="annottext">l' :: LinePV 2 r
</span><a href="#local-6989586621679295947"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679295813"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">LinePV 2 r -&gt; (LinePV 2 r -&gt; LinePV 2 r) -&gt; LinePV 2 r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Identity (Point 2 r))
-&gt; LinePV 2 r -&gt; Identity (LinePV 2 r)
forall (d :: Nat) r (f :: * -&gt; *).
Functor f =&gt;
(Point d r -&gt; f (Point d r)) -&gt; LinePV d r -&gt; f (LinePV d r)
</span><span class="hs-identifier hs-var">anchorPoint</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r -&gt; Identity (Point 2 r))
 -&gt; LinePV 2 r -&gt; Identity (LinePV 2 r))
-&gt; Point 2 r -&gt; LinePV 2 r -&gt; LinePV 2 r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679295943"><span class="hs-identifier hs-var">pt</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span id="local-6989586621679295812"><span class="annot"><span class="annottext">a :: vertex
</span><a href="#local-6989586621679295812"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vertex
-&gt; Vector (Dimension vertex) (NumType vertex)
-&gt; LinePV 2 r
-&gt; vertex
forall {b} {h} {line}.
(Intersection (LinePV (Dimension b) (NumType b)) h
 ~ Maybe (LineLineIntersectionG (NumType b) line),
 Assert
   (OrdCond (CmpNat 1 (Dimension b)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension b)) 'True 'True 'False)
   (TypeError ...),
 IsIntersectableWith (LinePV (Dimension b) (NumType b)) h,
 Point_ b (Dimension b) (NumType b)) =&gt;
b -&gt; Vector (Dimension b) (NumType b) -&gt; h -&gt; b
</span><a href="#local-6989586621679295949"><span class="hs-identifier hs-var">intersectionPoint</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295807"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension vertex) (NumType vertex)
</span><a href="#local-6989586621679295801"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679295947"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-comment">-- no need to negate v here</span><span>
</span><span id="line-313"></span><span>      </span><span id="local-6989586621679295810"><span class="annot"><span class="annottext">b :: vertex
</span><a href="#local-6989586621679295810"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vertex
-&gt; Vector (Dimension vertex) (NumType vertex)
-&gt; LinePV 2 r
-&gt; vertex
forall {b} {h} {line}.
(Intersection (LinePV (Dimension b) (NumType b)) h
 ~ Maybe (LineLineIntersectionG (NumType b) line),
 Assert
   (OrdCond (CmpNat 1 (Dimension b)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension b)) 'True 'True 'False)
   (TypeError ...),
 IsIntersectableWith (LinePV (Dimension b) (NumType b)) h,
 Point_ b (Dimension b) (NumType b)) =&gt;
b -&gt; Vector (Dimension b) (NumType b) -&gt; h -&gt; b
</span><a href="#local-6989586621679295949"><span class="hs-identifier hs-var">intersectionPoint</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679295808"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension vertex) (NumType vertex)
</span><a href="#local-6989586621679295803"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679295947"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679295944"><span class="annot"><span class="annottext">maximumOn :: (a -&gt; a) -&gt; t a -&gt; a
</span><a href="#local-6989586621679295944"><span class="hs-identifier hs-var hs-var">maximumOn</span></a></span></span><span> </span><span id="local-6989586621679295959"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679295959"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
forall (t :: * -&gt; *) a.
Foldable1 t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679295959"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679295949"><span class="annot"><span class="annottext">intersectionPoint :: b -&gt; Vector (Dimension b) (NumType b) -&gt; h -&gt; b
</span><a href="#local-6989586621679295949"><span class="hs-identifier hs-var hs-var">intersectionPoint</span></a></span></span><span> </span><span id="local-6989586621679296190"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679296190"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679296191"><span class="annot"><span class="annottext">Vector (Dimension b) (NumType b)
</span><a href="#local-6989586621679296191"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621679296192"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679296192"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point (Dimension b) (NumType b)
-&gt; Vector (Dimension b) (NumType b)
-&gt; LinePV (Dimension b) (NumType b)
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><span class="hs-identifier hs-var">LinePV</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679296190"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">b
-&gt; Getting
     (Point (Dimension b) (NumType b))
     b
     (Point (Dimension b) (NumType b))
-&gt; Point (Dimension b) (NumType b)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting
  (Point (Dimension b) (NumType b))
  b
  (Point (Dimension b) (NumType b))
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' b (Point (Dimension b) (NumType b))
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Dimension b) (NumType b)
</span><a href="#local-6989586621679296191"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LinePV (Dimension b) (NumType b)
-&gt; h -&gt; Intersection (LinePV (Dimension b) (NumType b)) h
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679296192"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-319"></span><span>                                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Line_x_Line_Point</span></span><span> </span><span id="local-6989586621679296195"><span class="annot"><span class="annottext">Point 2 (NumType b)
</span><a href="#local-6989586621679296195"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679296190"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">b -&gt; (b -&gt; b) -&gt; b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(NumType b -&gt; Identity (NumType b)) -&gt; b -&gt; Identity b
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int b (NumType b)
</span><span class="hs-identifier hs-var">xCoord</span></span><span> </span><span class="annot"><span class="annottext">((NumType b -&gt; Identity (NumType b)) -&gt; b -&gt; Identity b)
-&gt; NumType b -&gt; b -&gt; b
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 (NumType b)
</span><a href="#local-6989586621679296195"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Point 2 (NumType b)
-&gt; Getting (NumType b) (Point 2 (NumType b)) (NumType b)
-&gt; NumType b
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType b) (Point 2 (NumType b)) (NumType b)
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 (NumType b)) (NumType b)
</span><span class="hs-identifier hs-var">xCoord</span></span><span>
</span><span id="line-320"></span><span>                                                                </span><span class="annot"><span class="annottext">b -&gt; (b -&gt; b) -&gt; b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(NumType b -&gt; Identity (NumType b)) -&gt; b -&gt; Identity b
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int b (NumType b)
</span><span class="hs-identifier hs-var">yCoord</span></span><span> </span><span class="annot"><span class="annottext">((NumType b -&gt; Identity (NumType b)) -&gt; b -&gt; Identity b)
-&gt; NumType b -&gt; b -&gt; b
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 (NumType b)
</span><a href="#local-6989586621679296195"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Point 2 (NumType b)
-&gt; Getting (NumType b) (Point 2 (NumType b)) (NumType b)
-&gt; NumType b
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType b) (Point 2 (NumType b)) (NumType b)
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 (NumType b)) (NumType b)
</span><span class="hs-identifier hs-var">yCoord</span></span><span>
</span><span id="line-321"></span><span>                                 </span><span class="annot"><span class="annottext">Intersection (LinePV (Dimension b) (NumType b)) h
</span><span class="hs-identifier">_</span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;intersectionPoint: absurd'&quot;</span></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">-- -- TODO: this would make for a good property test: test if the points all lie inside the reegion</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-comment">-- case traverse (`intersect` box) rays of</span><span>
</span><span id="line-327"></span><span>  </span><span class="hs-comment">--   Just (Vector2 (HalfLine_x_Box_LineSegment s1)</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-comment">--                 (HalfLine_x_Box_LineSegment s2)) -&gt; f (s1^.end) (s2^.end)</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-comment">--   _ -&gt; error &quot;toBoundedFrom: absurd&quot;</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-comment">-- where</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-comment">--   (a,qSide) = intersectionPoint r1</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-comment">--   (b,pSide) = intersectionPoint r2</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-comment">--   box = boundingBox $ boxRay r1 &lt;&gt; boxRay r2 &lt;&gt; toNonEmptyOf folded tri</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-comment">--   rays@(Vector2 r1 r2) = boundingRays reg</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-comment">--   boxRay r = NonEmpty.fromList [ r^.start, r^.start .+^ r^.direction ]</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-comment">--   f a b = uncheckedFromCCWPoints $ case cornerInBetween b a box of</span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-comment">--             Nothing -&gt; b NonEmpty.&lt;|               a NonEmpty.&lt;| pts</span><span>
</span><span id="line-342"></span><span>  </span><span class="hs-comment">--             Just c  -&gt; b NonEmpty.&lt;| c NonEmpty.&lt;| a NonEmpty.&lt;| pts</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-- -- | Given a ray that starts inside the box box, compute the edge (and its index) on</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- -- which the ray intersects (and thus exits) the box</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- --</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- -- pre: the ray starts in the rectangle!</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- intersectionPoint       :: (Point_ corner 2 r, Fractional r, Ord r)</span><span>
</span><span id="line-353"></span><span class="hs-comment">--                         =&gt; HalfLine line -&gt; Rectangle corner</span><span>
</span><span id="line-354"></span><span class="hs-comment">--                         -&gt; (Point 2 r :+ VertexIx (Rectangle corner))</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- intersectionPoint r box = case getFirst $ intersectionPoint' r of</span><span>
</span><span id="line-356"></span><span class="hs-comment">--                             Nothing -&gt; error &quot;intersectionPoint: precondititon failed &quot;</span><span>
</span><span id="line-357"></span><span class="hs-comment">--                             Just x  -&gt; x</span><span>
</span><span id="line-358"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-359"></span><span class="hs-comment">--     intersectionPoint' r = flip (ifoldMapOf outerBoundaryEdgeSegments) box $ \(side,_) seg -&gt;</span><span>
</span><span id="line-360"></span><span class="hs-comment">--       case r `intersect` seg of</span><span>
</span><span id="line-361"></span><span class="hs-comment">--         Just (HalfLine_x_LineSegment_Point x) -&gt; First $ Just (x :+ side)</span><span>
</span><span id="line-362"></span><span class="hs-comment">--         _                                     -&gt; First   Nothing</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- -- | Given two vertex indices, computes the list of vertices in between them.</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- cornersInBetween         :: ( HasVertices triangle triangle, Eq (VertexIx triangle)</span><span>
</span><span id="line-367"></span><span class="hs-comment">--                             , Point_ (Vertex triangle) 2 r</span><span>
</span><span id="line-368"></span><span class="hs-comment">--                             )</span><span>
</span><span id="line-369"></span><span class="hs-comment">--                          =&gt; VertexIx triangle -&gt; VertexIx triangle</span><span>
</span><span id="line-370"></span><span class="hs-comment">--                          -&gt; triangle -&gt; [Point 2 r]</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- cornersInBetween s e tri = map (^._2.asPoint)</span><span>
</span><span id="line-372"></span><span class="hs-comment">--                          . takeWhile ((/= e) . fst) . dropWhile ((/= s) . fst)</span><span>
</span><span id="line-373"></span><span class="hs-comment">--                          $ cycle (itoListOf vertices tri)</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- -- | Given two points a and b on the sides of the box, computes the first CCW corner in</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- -- between a and b on the box (considered from a)</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- cornerInBetween a b box = case</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">--   case extremalVertices reg of</span><span>
</span><span id="line-382"></span><span class="hs-comment">--     Right (Vector2 p q) -&gt; compute p q</span><span>
</span><span id="line-383"></span><span class="hs-comment">--     Left p              -&gt; compute p p</span><span>
</span><span id="line-384"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-385"></span><span class="hs-comment">--     box =</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-397"></span></pre></body></html>