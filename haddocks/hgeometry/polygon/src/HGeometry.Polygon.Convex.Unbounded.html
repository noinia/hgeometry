<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unrecognised-pragmas #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# HLINT ignore &quot;Use camelCase&quot; #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      :  HGeometry.Polygon.Convex.Unbounded</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- A type for representing unbounded, Convex, polygonal regions.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html"><span class="hs-identifier">HGeometry.Polygon.Convex.Unbounded</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegion"><span class="hs-identifier">UnboundedConvexRegion</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier">UnboundedConvexRegionF</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#chain"><span class="hs-identifier">chain</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier">extremalVertices</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#mapChain"><span class="hs-identifier">mapChain</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#boundedCore"><span class="hs-identifier">boundedCore</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier">boundingRays</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#unboundedBoundingHalfplanes"><span class="hs-identifier">unboundedBoundingHalfplanes</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier">toBoundedFrom</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#LineUnboundedConvexRegionIntersection"><span class="hs-identifier">LineUnboundedConvexRegionIntersection</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Small.TwoOrThree.html"><span class="hs-identifier">HGeometry.Small.TwoOrThree</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable1</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">comparing</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Box</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Box</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Cyclic.html"><span class="hs-identifier">HGeometry.Cyclic</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.HalfLine</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Util.html"><span class="hs-identifier">HGeometry.Foldable.Util</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.HalfSpace</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.HyperPlane.Class</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Intersection</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Line</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Point</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HGeometry.Polygon.html"><span class="hs-identifier">HGeometry.Polygon</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.LineSegment</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.LineSegment.PossiblyDegenerate</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.PossiblyDegenerate.html"><span class="hs-identifier">HGeometry.Polygon.Simple.PossiblyDegenerate</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Properties</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Triangle</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Triangle</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><span class="hs-comment">-- | An unbounded polygonal Convex Region</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">type</span><span> </span><span id="UnboundedConvexRegion"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegion"><span class="hs-identifier hs-var">UnboundedConvexRegion</span></a></span></span><span> </span><span id="local-6989586621679321840"><span class="annot"><a href="#local-6989586621679321840"><span class="hs-identifier hs-type">vertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679321840"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321840"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><span class="hs-comment">-- | An unbounded polygonal ConvexRegion whose vertices are stored in an 'nonEmpty'</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">data</span><span> </span><span id="UnboundedConvexRegionF"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-var">UnboundedConvexRegionF</span></a></span></span><span> </span><span id="local-6989586621679321309"><span class="annot"><a href="#local-6989586621679321309"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679321310"><span class="annot"><a href="#local-6989586621679321310"><span class="hs-identifier hs-type">nonEmpty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679321311"><span class="annot"><a href="#local-6989586621679321311"><span class="hs-identifier hs-type">vertex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-61"></span><span>  </span><span id="Unbounded"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-var">Unbounded</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321309"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>            </span><span class="hs-comment">-- ^ vector indicating the direction of the unbounded edge</span><span>
</span><span id="line-63"></span><span>            </span><span class="hs-comment">-- incident to the first vertex. Note that this vector</span><span>
</span><span id="line-64"></span><span>            </span><span class="hs-comment">-- thus points INTO vertex v.</span><span>
</span><span id="line-65"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321310"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321311"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ the vertices in CCW order,</span></span><span>
</span><span id="line-67"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321309"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>            </span><span class="hs-comment">-- ^ the vector indicating the direction of the unbounded</span><span>
</span><span id="line-69"></span><span>            </span><span class="hs-comment">-- edge incident to the last vertex. The vector points</span><span>
</span><span id="line-70"></span><span>            </span><span class="hs-comment">-- away from the vertex (i.e. towards +infty).</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679321845"><span id="local-6989586621679321855"><span id="local-6989586621679321859"><span class="annot"><span class="annottext">Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS
[UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS
UnboundedConvexRegionF r nonEmpty vertex -&gt; String
(Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS)
-&gt; (UnboundedConvexRegionF r nonEmpty vertex -&gt; String)
-&gt; ([UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS)
-&gt; Show (UnboundedConvexRegionF r nonEmpty vertex)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall r (nonEmpty :: * -&gt; *) vertex.
(Show r, Show (nonEmpty vertex)) =&gt;
Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS
forall r (nonEmpty :: * -&gt; *) vertex.
(Show r, Show (nonEmpty vertex)) =&gt;
[UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS
forall r (nonEmpty :: * -&gt; *) vertex.
(Show r, Show (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex -&gt; String
$cshowsPrec :: forall r (nonEmpty :: * -&gt; *) vertex.
(Show r, Show (nonEmpty vertex)) =&gt;
Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS
showsPrec :: Int -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; ShowS
$cshow :: forall r (nonEmpty :: * -&gt; *) vertex.
(Show r, Show (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex -&gt; String
show :: UnboundedConvexRegionF r nonEmpty vertex -&gt; String
$cshowList :: forall r (nonEmpty :: * -&gt; *) vertex.
(Show r, Show (nonEmpty vertex)) =&gt;
[UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS
showList :: [UnboundedConvexRegionF r nonEmpty vertex] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679321867"><span id="local-6989586621679321873"><span class="annot"><span class="annottext">UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
(UnboundedConvexRegionF r nonEmpty vertex
 -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool)
-&gt; (UnboundedConvexRegionF r nonEmpty vertex
    -&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool)
-&gt; Eq (UnboundedConvexRegionF r nonEmpty vertex)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall r (nonEmpty :: * -&gt; *) vertex.
(Eq r, Eq (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
$c== :: forall r (nonEmpty :: * -&gt; *) vertex.
(Eq r, Eq (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
== :: UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
$c/= :: forall r (nonEmpty :: * -&gt; *) vertex.
(Eq r, Eq (nonEmpty vertex)) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
/= :: UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679321879"><span id="local-6989586621679321882"><span class="annot"><span class="annottext">(forall a b.
 (a -&gt; b)
 -&gt; UnboundedConvexRegionF r nonEmpty a
 -&gt; UnboundedConvexRegionF r nonEmpty b)
-&gt; (forall a b.
    a
    -&gt; UnboundedConvexRegionF r nonEmpty b
    -&gt; UnboundedConvexRegionF r nonEmpty a)
-&gt; Functor (UnboundedConvexRegionF r nonEmpty)
forall a b.
a
-&gt; UnboundedConvexRegionF r nonEmpty b
-&gt; UnboundedConvexRegionF r nonEmpty a
forall a b.
(a -&gt; b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; UnboundedConvexRegionF r nonEmpty b
forall r (nonEmpty :: * -&gt; *) a b.
Functor nonEmpty =&gt;
a
-&gt; UnboundedConvexRegionF r nonEmpty b
-&gt; UnboundedConvexRegionF r nonEmpty a
forall r (nonEmpty :: * -&gt; *) a b.
Functor nonEmpty =&gt;
(a -&gt; b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; UnboundedConvexRegionF r nonEmpty b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall r (nonEmpty :: * -&gt; *) a b.
Functor nonEmpty =&gt;
(a -&gt; b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; UnboundedConvexRegionF r nonEmpty b
fmap :: forall a b.
(a -&gt; b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; UnboundedConvexRegionF r nonEmpty b
$c&lt;$ :: forall r (nonEmpty :: * -&gt; *) a b.
Functor nonEmpty =&gt;
a
-&gt; UnboundedConvexRegionF r nonEmpty b
-&gt; UnboundedConvexRegionF r nonEmpty a
&lt;$ :: forall a b.
a
-&gt; UnboundedConvexRegionF r nonEmpty b
-&gt; UnboundedConvexRegionF r nonEmpty a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679321889"><span id="local-6989586621679321895"><span id="local-6989586621679321900"><span id="local-6989586621679321905"><span id="local-6989586621679321908"><span id="local-6989586621679321911"><span id="local-6989586621679321914"><span id="local-6989586621679321917"><span id="local-6989586621679321920"><span id="local-6989586621679321923"><span id="local-6989586621679321926"><span id="local-6989586621679321929"><span id="local-6989586621679321932"><span id="local-6989586621679321937"><span id="local-6989586621679321942"><span id="local-6989586621679321947"><span id="local-6989586621679321952"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; UnboundedConvexRegionF r nonEmpty m -&gt; m)
-&gt; (forall m a.
    Monoid m =&gt;
    (a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m)
-&gt; (forall m a.
    Monoid m =&gt;
    (a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m)
-&gt; (forall a b.
    (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b)
-&gt; (forall a b.
    (a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b)
-&gt; (forall b a.
    (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b)
-&gt; (forall b a.
    (b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b)
-&gt; (forall a.
    (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a.
    (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a. UnboundedConvexRegionF r nonEmpty a -&gt; [a])
-&gt; (forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Bool)
-&gt; (forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Int)
-&gt; (forall a.
    Eq a =&gt;
    a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; (forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a)
-&gt; Foldable (UnboundedConvexRegionF r nonEmpty)
forall a. Eq a =&gt; a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool
forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
forall m. Monoid m =&gt; UnboundedConvexRegionF r nonEmpty m -&gt; m
forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Bool
forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Int
forall a. UnboundedConvexRegionF r nonEmpty a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
forall m a.
Monoid m =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
forall b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
forall a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Eq a) =&gt;
a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool
forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Num a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Ord a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
forall r (nonEmpty :: * -&gt; *) m.
(Foldable nonEmpty, Monoid m) =&gt;
UnboundedConvexRegionF r nonEmpty m -&gt; m
forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; Bool
forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; Int
forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; [a]
forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
(a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
forall r (nonEmpty :: * -&gt; *) m a.
(Foldable nonEmpty, Monoid m) =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
forall r (nonEmpty :: * -&gt; *) b a.
Foldable nonEmpty =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
forall r (nonEmpty :: * -&gt; *) a b.
Foldable nonEmpty =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall r (nonEmpty :: * -&gt; *) m.
(Foldable nonEmpty, Monoid m) =&gt;
UnboundedConvexRegionF r nonEmpty m -&gt; m
fold :: forall m. Monoid m =&gt; UnboundedConvexRegionF r nonEmpty m -&gt; m
$cfoldMap :: forall r (nonEmpty :: * -&gt; *) m a.
(Foldable nonEmpty, Monoid m) =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
foldMap :: forall m a.
Monoid m =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
$cfoldMap' :: forall r (nonEmpty :: * -&gt; *) m a.
(Foldable nonEmpty, Monoid m) =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
foldMap' :: forall m a.
Monoid m =&gt;
(a -&gt; m) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; m
$cfoldr :: forall r (nonEmpty :: * -&gt; *) a b.
Foldable nonEmpty =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
foldr :: forall a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
$cfoldr' :: forall r (nonEmpty :: * -&gt; *) a b.
Foldable nonEmpty =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
foldr' :: forall a b.
(a -&gt; b -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
$cfoldl :: forall r (nonEmpty :: * -&gt; *) b a.
Foldable nonEmpty =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
foldl :: forall b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
$cfoldl' :: forall r (nonEmpty :: * -&gt; *) b a.
Foldable nonEmpty =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
foldl' :: forall b a.
(b -&gt; a -&gt; b) -&gt; b -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; b
$cfoldr1 :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
(a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$cfoldl1 :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
(a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$ctoList :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; [a]
toList :: forall a. UnboundedConvexRegionF r nonEmpty a -&gt; [a]
$cnull :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; Bool
null :: forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Bool
$clength :: forall r (nonEmpty :: * -&gt; *) a.
Foldable nonEmpty =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; Int
length :: forall a. UnboundedConvexRegionF r nonEmpty a -&gt; Int
$celem :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Eq a) =&gt;
a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; UnboundedConvexRegionF r nonEmpty a -&gt; Bool
$cmaximum :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Ord a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
maximum :: forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$cminimum :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Ord a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
minimum :: forall a. Ord a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$csum :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Num a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
sum :: forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
$cproduct :: forall r (nonEmpty :: * -&gt; *) a.
(Foldable nonEmpty, Num a) =&gt;
UnboundedConvexRegionF r nonEmpty a -&gt; a
product :: forall a. Num a =&gt; UnboundedConvexRegionF r nonEmpty a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679321968"><span id="local-6989586621679321975"><span id="local-6989586621679321981"><span id="local-6989586621679321986"><span class="annot"><span class="annottext">Functor (UnboundedConvexRegionF r nonEmpty)
Foldable (UnboundedConvexRegionF r nonEmpty)
(Functor (UnboundedConvexRegionF r nonEmpty),
 Foldable (UnboundedConvexRegionF r nonEmpty)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b)
 -&gt; UnboundedConvexRegionF r nonEmpty a
 -&gt; f (UnboundedConvexRegionF r nonEmpty b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    UnboundedConvexRegionF r nonEmpty (f a)
    -&gt; f (UnboundedConvexRegionF r nonEmpty a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b)
    -&gt; UnboundedConvexRegionF r nonEmpty a
    -&gt; m (UnboundedConvexRegionF r nonEmpty b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    UnboundedConvexRegionF r nonEmpty (m a)
    -&gt; m (UnboundedConvexRegionF r nonEmpty a))
-&gt; Traversable (UnboundedConvexRegionF r nonEmpty)
forall r (nonEmpty :: * -&gt; *).
Traversable nonEmpty =&gt;
Functor (UnboundedConvexRegionF r nonEmpty)
forall r (nonEmpty :: * -&gt; *).
Traversable nonEmpty =&gt;
Foldable (UnboundedConvexRegionF r nonEmpty)
forall r (nonEmpty :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable nonEmpty, Monad m) =&gt;
UnboundedConvexRegionF r nonEmpty (m a)
-&gt; m (UnboundedConvexRegionF r nonEmpty a)
forall r (nonEmpty :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable nonEmpty, Applicative f) =&gt;
UnboundedConvexRegionF r nonEmpty (f a)
-&gt; f (UnboundedConvexRegionF r nonEmpty a)
forall r (nonEmpty :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable nonEmpty, Monad m) =&gt;
(a -&gt; m b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; m (UnboundedConvexRegionF r nonEmpty b)
forall r (nonEmpty :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable nonEmpty, Applicative f) =&gt;
(a -&gt; f b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; f (UnboundedConvexRegionF r nonEmpty b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
UnboundedConvexRegionF r nonEmpty (m a)
-&gt; m (UnboundedConvexRegionF r nonEmpty a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
UnboundedConvexRegionF r nonEmpty (f a)
-&gt; f (UnboundedConvexRegionF r nonEmpty a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; m (UnboundedConvexRegionF r nonEmpty b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; f (UnboundedConvexRegionF r nonEmpty b)
$ctraverse :: forall r (nonEmpty :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable nonEmpty, Applicative f) =&gt;
(a -&gt; f b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; f (UnboundedConvexRegionF r nonEmpty b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; f (UnboundedConvexRegionF r nonEmpty b)
$csequenceA :: forall r (nonEmpty :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable nonEmpty, Applicative f) =&gt;
UnboundedConvexRegionF r nonEmpty (f a)
-&gt; f (UnboundedConvexRegionF r nonEmpty a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
UnboundedConvexRegionF r nonEmpty (f a)
-&gt; f (UnboundedConvexRegionF r nonEmpty a)
$cmapM :: forall r (nonEmpty :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable nonEmpty, Monad m) =&gt;
(a -&gt; m b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; m (UnboundedConvexRegionF r nonEmpty b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b)
-&gt; UnboundedConvexRegionF r nonEmpty a
-&gt; m (UnboundedConvexRegionF r nonEmpty b)
$csequence :: forall r (nonEmpty :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable nonEmpty, Monad m) =&gt;
UnboundedConvexRegionF r nonEmpty (m a)
-&gt; m (UnboundedConvexRegionF r nonEmpty a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
UnboundedConvexRegionF r nonEmpty (m a)
-&gt; m (UnboundedConvexRegionF r nonEmpty a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679321996"><span id="local-6989586621679321998"><span class="annot"><span class="annottext">(forall x.
 UnboundedConvexRegionF r nonEmpty vertex
 -&gt; Rep (UnboundedConvexRegionF r nonEmpty vertex) x)
-&gt; (forall x.
    Rep (UnboundedConvexRegionF r nonEmpty vertex) x
    -&gt; UnboundedConvexRegionF r nonEmpty vertex)
-&gt; Generic (UnboundedConvexRegionF r nonEmpty vertex)
forall x.
Rep (UnboundedConvexRegionF r nonEmpty vertex) x
-&gt; UnboundedConvexRegionF r nonEmpty vertex
forall x.
UnboundedConvexRegionF r nonEmpty vertex
-&gt; Rep (UnboundedConvexRegionF r nonEmpty vertex) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall r (nonEmpty :: * -&gt; *) vertex x.
Rep (UnboundedConvexRegionF r nonEmpty vertex) x
-&gt; UnboundedConvexRegionF r nonEmpty vertex
forall r (nonEmpty :: * -&gt; *) vertex x.
UnboundedConvexRegionF r nonEmpty vertex
-&gt; Rep (UnboundedConvexRegionF r nonEmpty vertex) x
$cfrom :: forall r (nonEmpty :: * -&gt; *) vertex x.
UnboundedConvexRegionF r nonEmpty vertex
-&gt; Rep (UnboundedConvexRegionF r nonEmpty vertex) x
from :: forall x.
UnboundedConvexRegionF r nonEmpty vertex
-&gt; Rep (UnboundedConvexRegionF r nonEmpty vertex) x
$cto :: forall r (nonEmpty :: * -&gt; *) vertex x.
Rep (UnboundedConvexRegionF r nonEmpty vertex) x
-&gt; UnboundedConvexRegionF r nonEmpty vertex
to :: forall x.
Rep (UnboundedConvexRegionF r nonEmpty vertex) x
-&gt; UnboundedConvexRegionF r nonEmpty vertex
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="NumType"><span class="annot"><span class="hs-identifier hs-var">NumType</span></span></span><span>   </span><span id="local-6989586621679322003"><span id="local-6989586621679322004"><span id="local-6989586621679322005"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322003"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322004"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322005"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679322003"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Dimension"><span class="annot"><span class="hs-identifier hs-var">Dimension</span></span></span><span> </span><span id="local-6989586621679322006"><span id="local-6989586621679322007"><span id="local-6989586621679322008"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322006"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322007"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322008"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321289"><span id="local-6989586621679321290"><span id="local-6989586621679321291"><span id="local-6989586621679322012"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679321289"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321290"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321291"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321289"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321290"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321291"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="annot"><span class="hs-comment">-- | Lens to access the chain of vertices in CCW order</span></span><span>
</span><span id="line-80"></span><span id="local-6989586621679321293"><span id="local-6989586621679321294"><span id="local-6989586621679321295"><span id="local-6989586621679321296"><span id="local-6989586621679321297"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#chain"><span class="hs-identifier hs-type">chain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Type.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321297"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321293"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321294"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321297"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321295"><span class="hs-identifier hs-type">nonEmpty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321296"><span class="hs-identifier hs-type">vertex'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321293"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321294"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321295"><span class="hs-identifier hs-type">nonEmpty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321296"><span class="hs-identifier hs-type">vertex'</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-83"></span><span id="chain"><span class="annot"><span class="annottext">chain :: forall r (nonEmpty :: * -&gt; *) vertex (nonEmpty' :: * -&gt; *) vertex'
       (f :: * -&gt; *).
Functor f =&gt;
(nonEmpty vertex -&gt; f (nonEmpty' vertex'))
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; f (UnboundedConvexRegionF r nonEmpty' vertex')
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#chain"><span class="hs-identifier hs-var hs-var">chain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UnboundedConvexRegionF r nonEmpty vertex -&gt; nonEmpty vertex)
-&gt; (UnboundedConvexRegionF r nonEmpty vertex
    -&gt; nonEmpty' vertex' -&gt; UnboundedConvexRegionF r nonEmpty' vertex')
-&gt; Lens
     (UnboundedConvexRegionF r nonEmpty vertex)
     (UnboundedConvexRegionF r nonEmpty' vertex')
     (nonEmpty vertex)
     (nonEmpty' vertex')
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679322034"><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679322034"><span class="hs-identifier hs-var">chain'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679322034"><span class="hs-identifier hs-var">chain'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>             </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span id="local-6989586621679322035"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322035"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679322036"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322036"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679322037"><span class="annot"><span class="annottext">nonEmpty' vertex'
</span><a href="#local-6989586621679322037"><span class="hs-identifier hs-var">chain'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
-&gt; nonEmpty' vertex'
-&gt; Vector 2 r
-&gt; UnboundedConvexRegionF r nonEmpty' vertex'
forall r (nonEmpty :: * -&gt; *) vertex.
Vector 2 r
-&gt; nonEmpty vertex
-&gt; Vector 2 r
-&gt; UnboundedConvexRegionF r nonEmpty vertex
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-var">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322035"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">nonEmpty' vertex'
</span><a href="#local-6989586621679322037"><span class="hs-identifier hs-var">chain'</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322036"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- | map a function over the sequence of points</span></span><span>
</span><span id="line-87"></span><span id="local-6989586621679321312"><span id="local-6989586621679321313"><span id="local-6989586621679321314"><span id="local-6989586621679321315"><span id="local-6989586621679321316"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#mapChain"><span class="hs-identifier hs-type">mapChain</span></a></span><span>                       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321312"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321313"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679321314"><span class="hs-identifier hs-type">nonEmpty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321315"><span class="hs-identifier hs-type">vertex'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321316"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321312"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321313"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-89"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321316"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321314"><span class="hs-identifier hs-type">nonEmpty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321315"><span class="hs-identifier hs-type">vertex'</span></a></span></span></span></span></span></span><span>
</span><span id="line-90"></span><span id="mapChain"><span class="annot"><span class="annottext">mapChain :: forall (nonEmpty :: * -&gt; *) vertex (nonEmpty' :: * -&gt; *) vertex' r.
(nonEmpty vertex -&gt; nonEmpty' vertex')
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; UnboundedConvexRegionF r nonEmpty' vertex'
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#mapChain"><span class="hs-identifier hs-var hs-var">mapChain</span></a></span></span><span> </span><span id="local-6989586621679322038"><span class="annot"><span class="annottext">nonEmpty vertex -&gt; nonEmpty' vertex'
</span><a href="#local-6989586621679322038"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span id="local-6989586621679322039"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322039"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679322040"><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679322040"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span id="local-6989586621679322041"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322041"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
-&gt; nonEmpty' vertex'
-&gt; Vector 2 r
-&gt; UnboundedConvexRegionF r nonEmpty' vertex'
forall r (nonEmpty :: * -&gt; *) vertex.
Vector 2 r
-&gt; nonEmpty vertex
-&gt; Vector 2 r
-&gt; UnboundedConvexRegionF r nonEmpty vertex
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-var">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322039"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">nonEmpty vertex -&gt; nonEmpty' vertex'
</span><a href="#local-6989586621679322038"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679322040"><span class="hs-identifier hs-var">pts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322041"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Compute the first and last vertex of the chain. Returns a Left if the first and last</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- are the same.</span><span>
</span><span id="line-94"></span><span id="local-6989586621679321322"><span id="local-6989586621679321323"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-type">extremalVertices</span></a></span><span>                            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321322"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321323"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-95"></span><span>                                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679321323"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321323"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-96"></span><span id="extremalVertices"><span class="annot"><span class="annottext">extremalVertices :: forall r vertex.
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-var hs-var">extremalVertices</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679322042"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322042"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679322044"><span class="annot"><span class="annottext">[vertex]
</span><a href="#local-6989586621679322044"><span class="hs-identifier hs-var">pts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[vertex] -&gt; Maybe (NonEmpty vertex)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NonEmpty.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[vertex]
</span><a href="#local-6989586621679322044"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>                                                </span><span class="annot"><span class="annottext">Maybe (NonEmpty vertex)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Either vertex (Vector 2 vertex)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322042"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-98"></span><span>                                                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679322046"><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679322046"><span class="hs-identifier hs-var">pts'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex -&gt; Either vertex (Vector 2 vertex)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex -&gt; Either vertex (Vector 2 vertex))
-&gt; Vector 2 vertex -&gt; Either vertex (Vector 2 vertex)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Vector 2 vertex
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322042"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty vertex -&gt; vertex
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.last</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679322046"><span class="hs-identifier hs-var">pts'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | Computes the two bounding rays of the unbounded region. Note that the rays now are</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- both pointing toward infinity. The second ray has the unbounded region to its left,</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- whereas the first one has it to its right.</span><span>
</span><span id="line-103"></span><span id="local-6989586621679321335"><span id="local-6989586621679321336"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier hs-type">boundingRays</span></a></span><span>                          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321335"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321336"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679321336"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>                                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321336"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321335"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-105"></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="annot"><a href="#local-6989586621679321335"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-106"></span><span id="boundingRays"><span class="annot"><span class="annottext">boundingRays :: forall vertex r.
(Point_ vertex 2 r, Num r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier hs-var hs-var">boundingRays</span></a></span></span><span> </span><span id="local-6989586621679322088"><span class="annot"><span class="annottext">chain' :: UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322088"><span class="hs-identifier hs-var">chain'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span id="local-6989586621679322089"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322089"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679322090"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322090"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex -&gt; Vector 2 (HalfLine vertex)
</span><a href="#local-6989586621679322091"><span class="hs-identifier hs-var">compute</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex -&gt; Vector 2 (HalfLine vertex))
-&gt; Vector 2 vertex -&gt; Vector 2 (HalfLine vertex)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
forall r vertex.
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-var">extremalVertices</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322088"><span class="hs-identifier hs-var">chain'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-107"></span><span>                                          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679322092"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322092"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Vector 2 vertex
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322092"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322092"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-108"></span><span>                                          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679322093"><span class="annot"><span class="annottext">Vector 2 vertex
</span><a href="#local-6989586621679322093"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex
</span><a href="#local-6989586621679322093"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621679322091"><span class="annot"><span class="annottext">compute :: Vector 2 vertex -&gt; Vector 2 (HalfLine vertex)
</span><a href="#local-6989586621679322091"><span class="hs-identifier hs-var hs-var">compute</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679322094"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322094"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679322095"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322095"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HalfLine vertex -&gt; HalfLine vertex -&gt; Vector 2 (HalfLine vertex)
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; Vector (Dimension vertex) (NumType vertex) -&gt; HalfLine vertex
forall point.
point -&gt; Vector (Dimension point) (NumType point) -&gt; HalfLine point
</span><span class="hs-identifier hs-var">HalfLine</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322094"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Dimension vertex) (NumType vertex) -&gt; HalfLine vertex)
-&gt; Vector (Dimension vertex) (NumType vertex) -&gt; HalfLine vertex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector (Dimension vertex) (NumType vertex)
-&gt; Vector (Dimension vertex) (NumType vertex)
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
vector -&gt; vector
</span><span class="hs-identifier hs-var">negated</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension vertex) (NumType vertex)
</span><a href="#local-6989586621679322089"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
-&gt; Vector (Dimension vertex) (NumType vertex) -&gt; HalfLine vertex
forall point.
point -&gt; Vector (Dimension point) (NumType point) -&gt; HalfLine point
</span><span class="hs-identifier hs-var">HalfLine</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322095"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension vertex) (NumType vertex)
</span><a href="#local-6989586621679322090"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Computes the core of the unbounded region; i.e. the convex hull of the</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- vertices of the region.</span><span>
</span><span id="line-115"></span><span id="local-6989586621679321370"><span id="local-6989586621679321371"><span id="local-6989586621679321373"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#boundedCore"><span class="hs-identifier hs-type">boundedCore</span></a></span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.Type.html#VertexContainer"><span class="hs-identifier hs-type">VertexContainer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321370"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321371"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321371"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321373"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-116"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Foldable.Util.html#HasFromFoldable1"><span class="hs-identifier hs-type">HasFromFoldable1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321370"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span>
</span><span id="line-117"></span><span>                                   </span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>                                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321373"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321370"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321371"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-119"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Simple.PossiblyDegenerate.html#PossiblyDegenerateSimplePolygon"><span class="hs-identifier hs-type">PossiblyDegenerateSimplePolygon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321371"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-120"></span><span>                                        </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Internal.html#ConvexPolygonF"><span class="hs-identifier hs-type">ConvexPolygonF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Cyclic.html#Cyclic"><span class="hs-identifier hs-type">Cyclic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321370"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679321371"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-121"></span><span id="boundedCore"><span class="annot"><span class="annottext">boundedCore :: forall (nonEmpty :: * -&gt; *) vertex r.
(VertexContainer nonEmpty vertex, Point_ vertex 2 r,
 HasFromFoldable1 nonEmpty) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundedCore"><span class="hs-identifier hs-var hs-var">boundedCore</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679322203"><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679322203"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex -&gt; NonEmpty vertex
forall a. nonEmpty a -&gt; NonEmpty a
forall (t :: * -&gt; *) a. Foldable1 t =&gt; t a -&gt; NonEmpty a
</span><span class="hs-identifier hs-var">toNonEmpty</span></span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679322203"><span class="hs-identifier hs-var">pts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679322205"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322205"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
forall vertex polygon.
vertex -&gt; PossiblyDegenerateSimplePolygon vertex polygon
</span><a href="HGeometry.Polygon.Simple.PossiblyDegenerate.html#DegenerateVertex"><span class="hs-identifier hs-var">DegenerateVertex</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322205"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679322207"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322207"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679322208"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322208"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
forall vertex polygon.
ClosedLineSegment vertex
-&gt; PossiblyDegenerateSimplePolygon vertex polygon
</span><a href="HGeometry.Polygon.Simple.PossiblyDegenerate.html#DegenerateEdge"><span class="hs-identifier hs-var">DegenerateEdge</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedLineSegment vertex
 -&gt; PossiblyDegenerateSimplePolygon
      vertex (ConvexPolygonF (Cyclic nonEmpty) vertex))
-&gt; ClosedLineSegment vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; ClosedLineSegment vertex
forall point. point -&gt; point -&gt; ClosedLineSegment point
</span><span class="hs-identifier hs-var">ClosedLineSegment</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322207"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322208"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConvexPolygonF (Cyclic nonEmpty) vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
forall vertex polygon.
polygon -&gt; PossiblyDegenerateSimplePolygon vertex polygon
</span><a href="HGeometry.Polygon.Simple.PossiblyDegenerate.html#ActualPolygon"><span class="hs-identifier hs-var">ActualPolygon</span></a></span><span> </span><span class="annot"><span class="annottext">(ConvexPolygonF (Cyclic nonEmpty) vertex
 -&gt; PossiblyDegenerateSimplePolygon
      vertex (ConvexPolygonF (Cyclic nonEmpty) vertex))
-&gt; ConvexPolygonF (Cyclic nonEmpty) vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex -&gt; ConvexPolygonF (Cyclic nonEmpty) vertex
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable1 f) =&gt;
f point -&gt; simplePolygon
forall (f :: * -&gt; *).
Foldable1 f =&gt;
f vertex -&gt; ConvexPolygonF (Cyclic nonEmpty) vertex
</span><a href="HGeometry.Polygon.Simple.Class.html#uncheckedFromCCWPoints"><span class="hs-identifier hs-var">uncheckedFromCCWPoints</span></a></span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex
</span><a href="#local-6989586621679322203"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | the 2 or three halfplanes bounding the unbounded part of the region</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- in particular: the region minus its bounded core</span><span>
</span><span id="line-129"></span><span id="local-6989586621679321424"><span id="local-6989586621679321425"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#unboundedBoundingHalfplanes"><span class="hs-identifier hs-type">unboundedBoundingHalfplanes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321424"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321425"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679321425"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321425"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>                            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321425"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321424"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-131"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Small.TwoOrThree.html#TwoOrThree"><span class="hs-identifier hs-type">TwoOrThree</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfPlaneF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321425"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-132"></span><span id="unboundedBoundingHalfplanes"><span class="annot"><span class="annottext">unboundedBoundingHalfplanes :: forall vertex r.
(Point_ vertex 2 r, Num r, Ord r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r))
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#unboundedBoundingHalfplanes"><span class="hs-identifier hs-var hs-var">unboundedBoundingHalfplanes</span></a></span></span><span> </span><span id="local-6989586621679322315"><span class="annot"><span class="annottext">region :: UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322315"><span class="hs-identifier hs-var">region</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span id="local-6989586621679322316"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322316"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679322317"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322317"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="annottext">Either
  (Two (HalfPlaneF (LinePV 2 r))) (Three (HalfPlaneF (LinePV 2 r)))
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r))
forall a. Either (Two a) (Three a) -&gt; TwoOrThree a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Small.TwoOrThree.html#TwoOrThree"><span class="hs-identifier hs-var">TwoOrThree</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   (Two (HalfPlaneF (LinePV 2 r))) (Three (HalfPlaneF (LinePV 2 r)))
 -&gt; TwoOrThree (HalfPlaneF (LinePV 2 r)))
-&gt; (Either vertex (Vector 2 vertex)
    -&gt; Either
         (Two (HalfPlaneF (LinePV 2 r))) (Three (HalfPlaneF (LinePV 2 r))))
-&gt; Either vertex (Vector 2 vertex)
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(vertex -&gt; Two (HalfPlaneF (LinePV 2 r)))
-&gt; (Vector 2 vertex -&gt; Three (HalfPlaneF (LinePV 2 r)))
-&gt; Either vertex (Vector 2 vertex)
-&gt; Either
     (Two (HalfPlaneF (LinePV 2 r))) (Three (HalfPlaneF (LinePV 2 r)))
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Either a c -&gt; Either b d
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Two (HalfPlaneF (LinePV 2 r))
</span><a href="#local-6989586621679322321"><span class="hs-identifier hs-var">two</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex -&gt; Three (HalfPlaneF (LinePV 2 r))
</span><a href="#local-6989586621679322322"><span class="hs-identifier hs-var">three</span></a></span><span> </span><span class="annot"><span class="annottext">(Either vertex (Vector 2 vertex)
 -&gt; TwoOrThree (HalfPlaneF (LinePV 2 r)))
-&gt; Either vertex (Vector 2 vertex)
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
forall r vertex.
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-var">extremalVertices</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322315"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679322321"><span class="annot"><span class="annottext">two :: vertex -&gt; Two (HalfPlaneF (LinePV 2 r))
</span><a href="#local-6989586621679322321"><span class="hs-identifier hs-var hs-var">two</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (Point 2 r) vertex (Point 2 r) -&gt; vertex -&gt; Point 2 r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) vertex (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' vertex (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679322325"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322325"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HalfPlaneF (LinePV 2 r)
-&gt; HalfPlaneF (LinePV 2 r) -&gt; Two (HalfPlaneF (LinePV 2 r))
forall a. a -&gt; a -&gt; Two a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html#Two"><span class="hs-identifier hs-var">Two</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
</span><span class="hs-identifier hs-var">leftHalfPlane</span></span><span> </span><span class="annot"><span class="annottext">(LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r))
-&gt; LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><span class="hs-identifier hs-var">LinePV</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322325"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322316"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
</span><span class="hs-identifier hs-var">leftHalfPlane</span></span><span> </span><span class="annot"><span class="annottext">(LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r))
-&gt; LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><span class="hs-identifier hs-var">LinePV</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322325"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322317"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679322322"><span class="annot"><span class="annottext">three :: Vector 2 vertex -&gt; Three (HalfPlaneF (LinePV 2 r))
</span><a href="#local-6989586621679322322"><span class="hs-identifier hs-var hs-var">three</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(vertex -&gt; Point 2 r) -&gt; Vector 2 vertex -&gt; Vector 2 (Point 2 r)
forall a b. (a -&gt; b) -&gt; Vector 2 a -&gt; Vector 2 b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (Point 2 r) vertex (Point 2 r) -&gt; vertex -&gt; Point 2 r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) vertex (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' vertex (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679322329"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322329"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679322330"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322330"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">HalfPlaneF (LinePV 2 r)
-&gt; HalfPlaneF (LinePV 2 r)
-&gt; HalfPlaneF (LinePV 2 r)
-&gt; Three (HalfPlaneF (LinePV 2 r))
forall a. a -&gt; a -&gt; a -&gt; Three a
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Combinatorial.Util.html#Three"><span class="hs-identifier hs-var">Three</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
</span><span class="hs-identifier hs-var">leftHalfPlane</span></span><span> </span><span class="annot"><span class="annottext">(LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r))
-&gt; LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><span class="hs-identifier hs-var">LinePV</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322329"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322316"><span class="hs-identifier hs-var">v</span></a></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
</span><span class="hs-identifier hs-var">leftHalfPlane</span></span><span> </span><span class="annot"><span class="annottext">(LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r))
-&gt; LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><span class="hs-identifier hs-var">LinePV</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322330"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322317"><span class="hs-identifier hs-var">w</span></a></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall r. (Num r, Ord r) =&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
</span><span class="hs-identifier hs-var">leftHalfPlane</span></span><span> </span><span class="annot"><span class="annottext">(LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r))
-&gt; LinePV 2 r -&gt; HalfPlaneF (LinePV 2 r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; LinePV 2 r
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><span class="hs-identifier hs-var">LinePV</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322329"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322330"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Vector 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; point -&gt; Vector d r
</span><span class="hs-operator hs-var">.-.</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322329"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-comment">{-
data Cone r apex = Cone { _apex                   :: apex
                        , _leftBoundingDirection  :: Vector 2 r
                        , _rightBoundingDirection :: Vector 2 r
                        }
                 deriving (Show,Eq)
makeLenses ''Cone

type instance Dimension (Cone r apex) = 2
type instance NumType   (Cone r apex) = r
-}</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321477"><span id="local-6989586621679321478"><span id="local-6989586621679321479"><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/semigroupoids-6.0.1-211fa6e880027a6eed340531b5cc5442a9c75924011128ea7558a48b1d6183a4/share/doc/html/src/Data.Semigroup.Traversable.Class.html#Traversable1"><span class="hs-identifier hs-type">Traversable1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321477"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span>
</span><span id="line-155"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#Ixed"><span class="hs-identifier hs-type">Ixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321477"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321478"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#IxValue"><span class="hs-identifier hs-type">IxValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321477"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321478"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679321478"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-156"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321477"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321478"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-157"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#HasVertices%27"><span class="hs-identifier hs-type">HasVertices'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321479"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321477"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321478"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Vertex"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#Vertex"><span class="hs-identifier hs-var">Vertex</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321479"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321477"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321478"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679321478"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="VertexIx"><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#VertexIx"><span class="hs-identifier hs-var">VertexIx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321479"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321477"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321478"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">-- I think we could get rid of the Int constraint here, and just use an arbitrary</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">-- Index type. In that case, we need a slightly more general version of 'traversed1'</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">-- to implement 'vertices' in the 'HasVertices' instance.</span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679322354"><span class="annot"><span class="annottext">vertexAt :: VertexIx (UnboundedConvexRegionF r nonEmpty vertex)
-&gt; IndexedTraversal'
     (VertexIx (UnboundedConvexRegionF r nonEmpty vertex))
     (UnboundedConvexRegionF r nonEmpty vertex)
     (Vertex (UnboundedConvexRegionF r nonEmpty vertex))
</span><a href="#local-6989586621679322354"><span class="hs-identifier hs-var hs-var hs-var">vertexAt</span></a></span></span><span> </span><span id="local-6989586621679322356"><span class="annot"><span class="annottext">VertexIx (UnboundedConvexRegionF r nonEmpty vertex)
</span><a href="#local-6989586621679322356"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(nonEmpty vertex -&gt; f (nonEmpty vertex))
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; f (UnboundedConvexRegionF r nonEmpty vertex)
forall r (nonEmpty :: * -&gt; *) vertex (nonEmpty' :: * -&gt; *) vertex'
       (f :: * -&gt; *).
Functor f =&gt;
(nonEmpty vertex -&gt; f (nonEmpty' vertex'))
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; f (UnboundedConvexRegionF r nonEmpty' vertex')
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#chain"><span class="hs-identifier hs-var">chain</span></a></span><span> </span><span class="annot"><span class="annottext">((nonEmpty vertex -&gt; f (nonEmpty vertex))
 -&gt; UnboundedConvexRegionF r nonEmpty vertex
 -&gt; f (UnboundedConvexRegionF r nonEmpty vertex))
-&gt; (p vertex (f vertex) -&gt; nonEmpty vertex -&gt; f (nonEmpty vertex))
-&gt; p vertex (f vertex)
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; f (UnboundedConvexRegionF r nonEmpty vertex)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Indexed.html#.%3E"><span class="hs-operator hs-var">.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Index (nonEmpty vertex)
-&gt; IndexedTraversal'
     (Index (nonEmpty vertex))
     (nonEmpty vertex)
     (IxValue (nonEmpty vertex))
forall m.
Ixed m =&gt;
Index m -&gt; IndexedTraversal' (Index m) m (IxValue m)
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#iix"><span class="hs-identifier hs-var">iix</span></a></span><span> </span><span class="annot"><span class="annottext">VertexIx (UnboundedConvexRegionF r nonEmpty vertex)
Index (nonEmpty vertex)
</span><a href="#local-6989586621679322356"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679322362"><span class="annot"><span class="annottext">numVertices :: UnboundedConvexRegionF r nonEmpty vertex -&gt; Int
</span><a href="#local-6989586621679322362"><span class="hs-identifier hs-var hs-var hs-var">numVertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">nonEmpty vertex -&gt; Int
forall a. nonEmpty a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(nonEmpty vertex -&gt; Int)
-&gt; (UnboundedConvexRegionF r nonEmpty vertex -&gt; nonEmpty vertex)
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (nonEmpty vertex)
  (UnboundedConvexRegionF r nonEmpty vertex)
  (nonEmpty vertex)
-&gt; UnboundedConvexRegionF r nonEmpty vertex -&gt; nonEmpty vertex
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting
  (nonEmpty vertex)
  (UnboundedConvexRegionF r nonEmpty vertex)
  (nonEmpty vertex)
forall r (nonEmpty :: * -&gt; *) vertex (nonEmpty' :: * -&gt; *) vertex'
       (f :: * -&gt; *).
Functor f =&gt;
(nonEmpty vertex -&gt; f (nonEmpty' vertex'))
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; f (UnboundedConvexRegionF r nonEmpty' vertex')
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#chain"><span class="hs-identifier hs-var">chain</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321492"><span id="local-6989586621679321493"><span id="local-6989586621679321494"><span id="local-6989586621679321495"><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/semigroupoids-6.0.1-211fa6e880027a6eed340531b5cc5442a9c75924011128ea7558a48b1d6183a4/share/doc/html/src/Data.Semigroup.Traversable.Class.html#Traversable1"><span class="hs-identifier hs-type">Traversable1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321492"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span>
</span><span id="line-167"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#Ixed"><span class="hs-identifier hs-type">Ixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321492"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321493"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#IxValue"><span class="hs-identifier hs-type">IxValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321492"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321493"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679321493"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-169"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#IxValue"><span class="hs-identifier hs-type">IxValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321492"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321494"><span class="hs-identifier hs-type">vertex'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679321494"><span class="hs-identifier hs-type">vertex'</span></a></span><span>
</span><span id="line-170"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321492"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321493"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321492"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321494"><span class="hs-identifier hs-type">vertex'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-171"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#HasVertices"><span class="hs-identifier hs-type">HasVertices</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321495"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321492"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321493"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321495"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321492"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321494"><span class="hs-identifier hs-type">vertex'</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679322391"><span class="annot"><span class="annottext">vertices :: IndexedTraversal1
  (VertexIx (UnboundedConvexRegionF r nonEmpty vertex))
  (UnboundedConvexRegionF r nonEmpty vertex)
  (UnboundedConvexRegionF r nonEmpty vertex')
  (Vertex (UnboundedConvexRegionF r nonEmpty vertex))
  (Vertex (UnboundedConvexRegionF r nonEmpty vertex'))
</span><a href="#local-6989586621679322391"><span class="hs-identifier hs-var hs-var hs-var">vertices</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(nonEmpty vertex -&gt; f (nonEmpty vertex'))
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; f (UnboundedConvexRegionF r nonEmpty vertex')
forall r (nonEmpty :: * -&gt; *) vertex (nonEmpty' :: * -&gt; *) vertex'
       (f :: * -&gt; *).
Functor f =&gt;
(nonEmpty vertex -&gt; f (nonEmpty' vertex'))
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; f (UnboundedConvexRegionF r nonEmpty' vertex')
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#chain"><span class="hs-identifier hs-var">chain</span></a></span><span> </span><span class="annot"><span class="annottext">((nonEmpty vertex -&gt; f (nonEmpty vertex'))
 -&gt; UnboundedConvexRegionF r nonEmpty vertex
 -&gt; f (UnboundedConvexRegionF r nonEmpty vertex'))
-&gt; (p vertex (f vertex')
    -&gt; nonEmpty vertex -&gt; f (nonEmpty vertex'))
-&gt; p vertex (f vertex')
-&gt; UnboundedConvexRegionF r nonEmpty vertex
-&gt; f (UnboundedConvexRegionF r nonEmpty vertex')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Indexed.html#.%3E"><span class="hs-operator hs-var">.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">p vertex (f vertex') -&gt; nonEmpty vertex -&gt; f (nonEmpty vertex')
forall (f :: * -&gt; *) a b.
Traversable1 f =&gt;
IndexedTraversal1 Int (f a) (f b) a b
IndexedTraversal1
  Int (nonEmpty vertex) (nonEmpty vertex') vertex vertex'
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Traversal.html#traversed1"><span class="hs-identifier hs-var">traversed1</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321510"><span id="local-6989586621679321511"><span id="local-6989586621679321512"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321510"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321511"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679321511"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321511"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-178"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HyperPlane_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321512"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321511"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-179"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="annot"><a href="#local-6989586621679321510"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HalfPlaneF</span></span><span> </span><span class="annot"><a href="#local-6989586621679321512"><span class="hs-identifier hs-type">line</span></a></span><span>
</span><span id="line-180"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HalfPlaneF</span></span><span> </span><span class="annot"><a href="#local-6989586621679321512"><span class="hs-identifier hs-type">line</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321511"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321510"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679322427"><span class="annot"><span class="annottext">HalfPlaneF line
</span><a href="#local-6989586621679322427"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679322428"><span class="annot"><span class="annottext">intersects :: HalfPlaneF line -&gt; UnboundedConvexRegionF r NonEmpty vertex -&gt; Bool
</span><a href="#local-6989586621679322428"><span class="hs-operator hs-var hs-var hs-var">`intersects`</span></a></span></span><span> </span><span id="local-6989586621679322430"><span class="annot"><span class="annottext">reg :: UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322430"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679322431"><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679322431"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HalfLine vertex -&gt; Bool) -&gt; Vector 2 (HalfLine vertex) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HalfLine vertex -&gt; HalfPlaneF line -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfPlaneF line
</span><a href="#local-6989586621679322427"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
forall vertex r.
(Point_ vertex 2 r, Num r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier hs-var">boundingRays</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322430"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                                        </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Getting Any (NonEmpty vertex) (Point 2 r)
-&gt; (Point 2 r -&gt; Bool) -&gt; NonEmpty vertex -&gt; Bool
forall s a. Getting Any s a -&gt; (a -&gt; Bool) -&gt; s -&gt; Bool
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#anyOf"><span class="hs-identifier hs-var">anyOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(vertex -&gt; Const Any vertex)
-&gt; NonEmpty vertex -&gt; Const Any (NonEmpty vertex)
forall (f :: * -&gt; *) a. Foldable f =&gt; IndexedFold Int (f a) a
IndexedFold Int (NonEmpty vertex) vertex
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#folded"><span class="hs-identifier hs-var">folded</span></a></span><span class="annot"><span class="annottext">((vertex -&gt; Const Any vertex)
 -&gt; NonEmpty vertex -&gt; Const Any (NonEmpty vertex))
-&gt; ((Point 2 r -&gt; Const Any (Point 2 r))
    -&gt; vertex -&gt; Const Any vertex)
-&gt; Getting Any (NonEmpty vertex) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const Any (Point 2 r)) -&gt; vertex -&gt; Const Any vertex
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' vertex (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfPlaneF line -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfPlaneF line
</span><a href="#local-6989586621679322427"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679322431"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- -- | given a vertical line l through point (x,0) that intersects the unbounded convex region</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- -- intersect the convex region with the left halfplane of l.</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- intersectVerticalLeft :: r -&gt; UnboundedConvexRegionF r nonEmpty vertex</span><span>
</span><span id="line-194"></span><span class="hs-comment">--                            -&gt; Either (UnboundedConvexRegionF r nonEmpty vertex)</span><span>
</span><span id="line-195"></span><span class="hs-comment">--                                      (ConvexPolygonF (Cyclic NonEmpty) vertex)</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- intersectVerticalLeft x chain@(Chain v pts w) =</span><span>
</span><span id="line-197"></span><span class="hs-comment">--   case (verticalLine x `intersect`) &lt;$&gt; boundingRays chain of</span><span>
</span><span id="line-198"></span><span class="hs-comment">--     Vector2 Nothing Nothing</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-202"></span><span class="annot"><span class="hs-comment">-- * Intersection of a Point and a Unbounded Convex Polygon</span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321530"><span id="local-6989586621679321531"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321530"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321531"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321531"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321531"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-208"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321531"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321531"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321530"><span class="hs-identifier hs-type">vertex</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679322492"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322492"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679322493"><span class="annot"><span class="annottext">intersects :: Point 2 r -&gt; UnboundedConvexRegionF r NonEmpty vertex -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">`intersects`</span></span></span><span> </span><span id="local-6989586621679322494"><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322494"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HalfPlaneF (LinePV 2 r) -&gt; Bool)
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r)) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322492"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfPlaneF (LinePV 2 r) -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r))
forall vertex r.
(Point_ vertex 2 r, Num r, Ord r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r))
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#unboundedBoundingHalfplanes"><span class="hs-identifier hs-var">unboundedBoundingHalfplanes</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322494"><span class="hs-identifier hs-var">region</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                       </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322492"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex)
-&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex)
forall (nonEmpty :: * -&gt; *) vertex r.
(VertexContainer nonEmpty vertex, Point_ vertex 2 r,
 HasFromFoldable1 nonEmpty) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundedCore"><span class="hs-identifier hs-var">boundedCore</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322494"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- * Intersection of a LineSegment with an Unbounded Convex Polygon</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- type instance Intersection (LineSegment endPoint point)</span><span>
</span><span id="line-216"></span><span class="hs-comment">--                            (UnboundedConvexRegionF r nonEmpty vertex) =</span><span>
</span><span id="line-217"></span><span class="hs-comment">--    Intersection (LineSegment endPoint point)</span><span>
</span><span id="line-218"></span><span class="hs-comment">--                 (ConvexPolygonF (Cyclic nonEmpty) vertex)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- data instance Intersection (LineSegment endPoint point)</span><span>
</span><span id="line-221"></span><span class="hs-comment">--                            (ConvexPolygonF (Cyclic nonEmpty) vertex) =</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321552"><span id="local-6989586621679321553"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321552"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321553"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321553"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321553"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-225"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321553"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-226"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321553"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321552"><span class="hs-identifier hs-type">vertex</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621679322536"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679322536"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span id="local-6989586621679322537"><span class="annot"><span class="annottext">intersects :: LinePV 2 r -&gt; UnboundedConvexRegionF r NonEmpty vertex -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">`intersects`</span></span></span><span> </span><span id="local-6989586621679322538"><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322538"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HalfLine vertex -&gt; Bool) -&gt; Vector 2 (HalfLine vertex) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679322536"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r -&gt; HalfLine vertex -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
forall vertex r.
(Point_ vertex 2 r, Num r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier hs-var">boundingRays</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322538"><span class="hs-identifier hs-var">region</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>                          </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679322536"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex)
-&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex)
forall (nonEmpty :: * -&gt; *) vertex r.
(VertexContainer nonEmpty vertex, Point_ vertex 2 r,
 HasFromFoldable1 nonEmpty) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundedCore"><span class="hs-identifier hs-var">boundedCore</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322538"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="annot"><span class="hs-comment">-- | Intersection between a halfline and a unbounded convex region</span></span><span>
</span><span id="line-231"></span><span class="hs-keyword">data</span><span> </span><span id="LineUnboundedConvexRegionIntersection"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#LineUnboundedConvexRegionIntersection"><span class="hs-identifier hs-var">LineUnboundedConvexRegionIntersection</span></a></span></span><span> </span><span id="local-6989586621679321638"><span class="annot"><a href="#local-6989586621679321638"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-232"></span><span>    </span><span id="Line_x_UnboundedConvexRegion_HalfLine"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_HalfLine"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_HalfLine</span></a></span></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321638"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Line_x_UnboundedConvexRegion_LineSegment"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_LineSegment"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_LineSegment</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321638"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Line_x_UnboundedConvexRegion_Point"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_Point"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_Point</span></a></span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321638"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679322544"><span id="local-6989586621679322560"><span id="local-6989586621679322564"><span class="annot"><span class="annottext">Int -&gt; LineUnboundedConvexRegionIntersection r -&gt; ShowS
[LineUnboundedConvexRegionIntersection r] -&gt; ShowS
LineUnboundedConvexRegionIntersection r -&gt; String
(Int -&gt; LineUnboundedConvexRegionIntersection r -&gt; ShowS)
-&gt; (LineUnboundedConvexRegionIntersection r -&gt; String)
-&gt; ([LineUnboundedConvexRegionIntersection r] -&gt; ShowS)
-&gt; Show (LineUnboundedConvexRegionIntersection r)
forall r.
Show r =&gt;
Int -&gt; LineUnboundedConvexRegionIntersection r -&gt; ShowS
forall r.
Show r =&gt;
[LineUnboundedConvexRegionIntersection r] -&gt; ShowS
forall r.
Show r =&gt;
LineUnboundedConvexRegionIntersection r -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall r.
Show r =&gt;
Int -&gt; LineUnboundedConvexRegionIntersection r -&gt; ShowS
showsPrec :: Int -&gt; LineUnboundedConvexRegionIntersection r -&gt; ShowS
$cshow :: forall r.
Show r =&gt;
LineUnboundedConvexRegionIntersection r -&gt; String
show :: LineUnboundedConvexRegionIntersection r -&gt; String
$cshowList :: forall r.
Show r =&gt;
[LineUnboundedConvexRegionIntersection r] -&gt; ShowS
showList :: [LineUnboundedConvexRegionIntersection r] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679322601"><span id="local-6989586621679322616"><span class="annot"><span class="annottext">LineUnboundedConvexRegionIntersection r
-&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool
(LineUnboundedConvexRegionIntersection r
 -&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool)
-&gt; (LineUnboundedConvexRegionIntersection r
    -&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool)
-&gt; Eq (LineUnboundedConvexRegionIntersection r)
forall r.
Eq r =&gt;
LineUnboundedConvexRegionIntersection r
-&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall r.
Eq r =&gt;
LineUnboundedConvexRegionIntersection r
-&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool
== :: LineUnboundedConvexRegionIntersection r
-&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool
$c/= :: forall r.
Eq r =&gt;
LineUnboundedConvexRegionIntersection r
-&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool
/= :: LineUnboundedConvexRegionIntersection r
-&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321594"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321594"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679321594"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-238"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321594"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#LineUnboundedConvexRegionIntersection"><span class="hs-identifier hs-type">LineUnboundedConvexRegionIntersection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321594"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621679322673"><span class="annot"><span class="annottext">intersects :: Point 2 r -&gt; LineUnboundedConvexRegionIntersection r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var">intersects</span></span></span><span> </span><span id="local-6989586621679322674"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322674"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_HalfLine"><span class="hs-identifier hs-type">Line_x_UnboundedConvexRegion_HalfLine</span></a></span><span>    </span><span id="local-6989586621679322675"><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322675"><span class="hs-identifier hs-var">hl</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322674"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfLine (Point 2 r) -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322675"><span class="hs-identifier hs-var">hl</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_LineSegment"><span class="hs-identifier hs-type">Line_x_UnboundedConvexRegion_LineSegment</span></a></span><span> </span><span id="local-6989586621679322676"><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679322676"><span class="hs-identifier hs-var">seg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322674"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; ClosedLineSegment (Point 2 r) -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679322676"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_Point"><span class="hs-identifier hs-type">Line_x_UnboundedConvexRegion_Point</span></a></span><span>       </span><span id="local-6989586621679322677"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322677"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322677"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322674"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Intersection"><span class="annot"><span class="hs-identifier hs-var">Intersection</span></span></span><span> </span><span id="local-6989586621679322678"><span id="local-6989586621679322679"><span id="local-6989586621679322680"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679322678"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322678"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322679"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322680"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#LineUnboundedConvexRegionIntersection"><span class="hs-identifier hs-type">LineUnboundedConvexRegionIntersection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679322678"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- boundingRayIntersections line rays = case withIntersection &lt;$&gt; rays of</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-255"></span><span class="hs-comment">--     withIntersection ray = (,ray) &lt;$&gt; line `intersect` ray</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- withIntersection &lt;$&gt; boundingRays</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321622"><span id="local-6989586621679321623"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321622"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321623"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321623"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321623"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-260"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321623"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-261"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">`IsIntersectableWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321623"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321622"><span class="hs-identifier hs-type">vertex</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679322822"><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679322822"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span id="local-6989586621679322823"><span class="annot"><span class="annottext">intersect :: LinePV 2 r
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; Intersection
     (LinePV 2 r) (UnboundedConvexRegionF r NonEmpty vertex)
</span><a href="#local-6989586621679322823"><span class="hs-operator hs-var hs-var hs-var">`intersect`</span></a></span></span><span> </span><span id="local-6989586621679322825"><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322825"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HalfLine vertex
-&gt; Maybe
     (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><a href="#local-6989586621679322826"><span class="hs-identifier hs-var">withIntersection</span></a></span><span> </span><span class="annot"><span class="annottext">(HalfLine vertex
 -&gt; Maybe
      (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))))
-&gt; Vector 2 (HalfLine vertex)
-&gt; Vector
     2
     (Maybe
        (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
forall vertex r.
(Point_ vertex 2 r, Num r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Vector 2 (HalfLine vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundingRays"><span class="hs-identifier hs-var">boundingRays</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322825"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>      </span><span class="hs-comment">-- somehow both rays intersect the line</span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679322828"><span class="annot"><span class="annottext">LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
</span><a href="#local-6989586621679322828"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679322829"><span class="annot"><span class="annottext">LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
</span><a href="#local-6989586621679322829"><span class="hs-identifier hs-var">qs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LineUnboundedConvexRegionIntersection r
-&gt; Maybe (LineUnboundedConvexRegionIntersection r)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LineUnboundedConvexRegionIntersection r
 -&gt; Maybe (LineUnboundedConvexRegionIntersection r))
-&gt; LineUnboundedConvexRegionIntersection r
-&gt; Maybe (LineUnboundedConvexRegionIntersection r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
</span><a href="#local-6989586621679322828"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Line_x_HalfLine_HalfLine</span></span><span> </span><span id="local-6989586621679322831"><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322831"><span class="hs-identifier hs-var">hl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
forall r.
HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_HalfLine"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_HalfLine</span></a></span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322831"><span class="hs-identifier hs-var">hl</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Line_x_HalfLine_Point</span></span><span> </span><span id="local-6989586621679322833"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322833"><span class="hs-identifier hs-var">p</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
</span><a href="#local-6989586621679322829"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-267"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Line_x_HalfLine_HalfLine</span></span><span> </span><span id="local-6989586621679322834"><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322834"><span class="hs-identifier hs-var">hl</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
forall r.
HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_HalfLine"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_HalfLine</span></a></span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322834"><span class="hs-identifier hs-var">hl</span></a></span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Line_x_HalfLine_Point</span></span><span> </span><span id="local-6989586621679322835"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322835"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322833"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322835"><span class="hs-identifier hs-var">q</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; LineUnboundedConvexRegionIntersection r
forall r. Point 2 r -&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_Point"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_Point</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322833"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-269"></span><span>                                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
forall r.
ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_LineSegment"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_LineSegment</span></a></span><span>
</span><span id="line-270"></span><span>                                                   </span><span class="annot"><span class="annottext">(ClosedLineSegment (Point 2 r)
 -&gt; LineUnboundedConvexRegionIntersection r)
-&gt; ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; ClosedLineSegment (Point 2 r)
forall point. point -&gt; point -&gt; ClosedLineSegment point
</span><span class="hs-identifier hs-var">ClosedLineSegment</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322833"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322835"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-comment">-- the rays do not intersect the line</span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span class="annot"><span class="annottext">Maybe (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (PossiblyDegenerateSegment
     (Point 2 r) (ClosedLineSegment (Point 2 r)))
Intersection
  (LinePV 2 r)
  (PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex))
</span><a href="#local-6989586621679322836"><span class="hs-identifier hs-var">boundedIntersection</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  (PossiblyDegenerateSegment
     (Point 2 r) (ClosedLineSegment (Point 2 r)))
-&gt; (PossiblyDegenerateSegment
      (Point 2 r) (ClosedLineSegment (Point 2 r))
    -&gt; LineUnboundedConvexRegionIntersection r)
-&gt; Maybe (LineUnboundedConvexRegionIntersection r)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-274"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">SinglePoint</span></span><span> </span><span id="local-6989586621679322839"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322839"><span class="hs-identifier hs-var">p</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; LineUnboundedConvexRegionIntersection r
forall r. Point 2 r -&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_Point"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_Point</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322839"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-275"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">ActualSegment</span></span><span> </span><span id="local-6989586621679322841"><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679322841"><span class="hs-identifier hs-var">seg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
forall r.
ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_LineSegment"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_LineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679322841"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>      </span><span class="hs-comment">-- exactly one ray intersects the line</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679322842"><span class="annot"><span class="annottext">Maybe (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><a href="#local-6989586621679322842"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
-&gt; LineUnboundedConvexRegionIntersection r
</span><a href="#local-6989586621679322843"><span class="hs-identifier hs-var">intersectBounded</span></a></span><span> </span><span class="annot"><span class="annottext">(LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
 -&gt; LineUnboundedConvexRegionIntersection r)
-&gt; Maybe
     (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
-&gt; Maybe (LineUnboundedConvexRegionIntersection r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><a href="#local-6989586621679322842"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span class="annot"><span class="annottext">Maybe (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span id="local-6989586621679322844"><span class="annot"><span class="annottext">Maybe (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><a href="#local-6989586621679322844"><span class="hs-identifier hs-var">qs</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
-&gt; LineUnboundedConvexRegionIntersection r
</span><a href="#local-6989586621679322843"><span class="hs-identifier hs-var">intersectBounded</span></a></span><span> </span><span class="annot"><span class="annottext">(LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
 -&gt; LineUnboundedConvexRegionIntersection r)
-&gt; Maybe
     (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
-&gt; Maybe (LineUnboundedConvexRegionIntersection r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><a href="#local-6989586621679322844"><span class="hs-identifier hs-var">qs</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="#local-6989586621679322826"><span class="hs-identifier hs-type">withIntersection</span></a></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="annot"><a href="#local-6989586621679321622"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-282"></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LineHalfLineIntersection</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321623"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321623"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>                                               </span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>      </span><span id="local-6989586621679322826"><span class="annot"><span class="annottext">withIntersection :: HalfLine vertex
-&gt; Maybe
     (LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r)))
</span><a href="#local-6989586621679322826"><span class="hs-identifier hs-var hs-var">withIntersection</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span id="local-6989586621679322845"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322845"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679322846"><span class="annot"><span class="annottext">Vector (Dimension vertex) (NumType vertex)
</span><a href="#local-6989586621679322846"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679322847"><span class="annot"><span class="annottext">ray :: HalfLine (Point 2 r)
</span><a href="#local-6989586621679322847"><span class="hs-identifier hs-var hs-var">ray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r
-&gt; Vector (Dimension (Point 2 r)) (NumType (Point 2 r))
-&gt; HalfLine (Point 2 r)
forall point.
point -&gt; Vector (Dimension point) (NumType point) -&gt; HalfLine point
</span><span class="hs-identifier hs-var">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679322845"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">vertex -&gt; Getting (Point 2 r) vertex (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) vertex (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' vertex (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Dimension vertex) (NumType vertex)
Vector (Dimension (Point 2 r)) (NumType (Point 2 r))
</span><a href="#local-6989586621679322846"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-286"></span><span>                                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679322822"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
-&gt; HalfLine (Point 2 r)
-&gt; Intersection (LinePV 2 r) (HalfLine (Point 2 r))
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322847"><span class="hs-identifier hs-var">ray</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>      </span><span id="local-6989586621679322836"><span class="annot"><span class="annottext">boundedIntersection :: Intersection
  (LinePV 2 r)
  (PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex))
</span><a href="#local-6989586621679322836"><span class="hs-identifier hs-var hs-var">boundedIntersection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679322822"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex)
-&gt; Intersection
     (LinePV 2 r)
     (PossiblyDegenerateSimplePolygon
        vertex (ConvexPolygonF (Cyclic NonEmpty) vertex))
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex)
forall (nonEmpty :: * -&gt; *) vertex r.
(VertexContainer nonEmpty vertex, Point_ vertex 2 r,
 HasFromFoldable1 nonEmpty) =&gt;
UnboundedConvexRegionF r nonEmpty vertex
-&gt; PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic nonEmpty) vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#boundedCore"><span class="hs-identifier hs-var">boundedCore</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322825"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>      </span><span id="local-6989586621679322843"><span class="annot"><span class="annottext">intersectBounded :: LineHalfLineIntersection (Point 2 r) (HalfLine (Point 2 r))
-&gt; LineUnboundedConvexRegionIntersection r
</span><a href="#local-6989586621679322843"><span class="hs-identifier hs-var hs-var">intersectBounded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-291"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Line_x_HalfLine_HalfLine</span></span><span> </span><span id="local-6989586621679322849"><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322849"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
forall r.
HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_HalfLine"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_HalfLine</span></a></span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679322849"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-292"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Line_x_HalfLine_Point</span></span><span> </span><span id="local-6989586621679322850"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322850"><span class="hs-identifier hs-var">p</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Intersection
  (LinePV 2 r)
  (PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex))
</span><a href="#local-6989586621679322836"><span class="hs-identifier hs-var">boundedIntersection</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-293"></span><span>                </span><span class="annot"><span class="annottext">Maybe
  (PossiblyDegenerateSegment
     (Point 2 r) (ClosedLineSegment (Point 2 r)))
Intersection
  (LinePV 2 r)
  (PossiblyDegenerateSimplePolygon
     vertex (ConvexPolygonF (Cyclic NonEmpty) vertex))
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
forall r.
HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_HalfLine"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_HalfLine</span></a></span><span> </span><span class="annot"><span class="annottext">(HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r)
-&gt; HalfLine (Point 2 r) -&gt; LineUnboundedConvexRegionIntersection r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfLine (Point 2 r)
</span><a href="#local-6989586621679322851"><span class="hs-identifier hs-var">hl</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322850"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-294"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SinglePoint</span></span><span> </span><span id="local-6989586621679322852"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322852"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
forall r.
ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_LineSegment"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_LineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">(ClosedLineSegment (Point 2 r)
 -&gt; LineUnboundedConvexRegionIntersection r)
-&gt; ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-295"></span><span>                                               </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; ClosedLineSegment (Point 2 r)
forall point. point -&gt; point -&gt; ClosedLineSegment point
</span><span class="hs-identifier hs-var">ClosedLineSegment</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322850"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322852"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-296"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ActualSegment</span></span><span> </span><span id="local-6989586621679322853"><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679322853"><span class="hs-identifier hs-var">seg</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679322854"><span class="annot"><span class="annottext">q :: Point 2 r
</span><a href="#local-6989586621679322854"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; Point 2 r -&gt; Ordering)
-&gt; ClosedLineSegment (Point 2 r) -&gt; Point 2 r
forall (t :: * -&gt; *) a.
Foldable1 t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; Ordering
</span><a href="#local-6989586621679322856"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679322853"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-297"></span><span>                                                 </span><span id="local-6989586621679322856"><span class="annot"><span class="annottext">cmp :: Point 2 r -&gt; Point 2 r -&gt; Ordering
</span><a href="#local-6989586621679322856"><span class="hs-identifier hs-var hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; r) -&gt; Point 2 r -&gt; Point 2 r -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; r
forall r point (d :: Nat) point'.
(Num r, Point_ point d r, Point_ point' d r,
 Metric_ (Vector d r) d r) =&gt;
point -&gt; point' -&gt; r
</span><span class="hs-identifier hs-var">squaredEuclideanDist</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322850"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                                                 </span><span id="local-6989586621679322858"><span class="annot"><span class="annottext">res :: ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679322858"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Point 2 r -&gt; ClosedLineSegment (Point 2 r)
forall point. point -&gt; point -&gt; ClosedLineSegment point
</span><span class="hs-identifier hs-var">ClosedLineSegment</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322850"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322854"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-299"></span><span>                                             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
forall r.
ClosedLineSegment (Point 2 r)
-&gt; LineUnboundedConvexRegionIntersection r
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_LineSegment"><span class="hs-identifier hs-var">Line_x_UnboundedConvexRegion_LineSegment</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679322858"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-300"></span><span>                                     </span><span class="hs-comment">-- the closest endpoint of seg must lie on</span><span>
</span><span id="line-301"></span><span>                                     </span><span class="hs-comment">-- the dummy edge of the core (connecting the two extremal)</span><span>
</span><span id="line-302"></span><span>                                     </span><span class="hs-comment">-- vertices of the chain</span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>          </span><span class="hs-comment">-- | given an intersection point p on one of the unbounded rays, compute</span><span>
</span><span id="line-305"></span><span>          </span><span class="hs-comment">-- the halfline that is contained in the unbounded region.</span><span>
</span><span id="line-306"></span><span>          </span><span id="local-6989586621679322851"><span class="annot"><span class="annottext">hl :: Point 2 r -&gt; HalfLine (Point 2 r)
</span><a href="#local-6989586621679322851"><span class="hs-identifier hs-var hs-var">hl</span></a></span></span><span> </span><span id="local-6989586621679322859"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322859"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679322860"><span class="annot"><span class="annottext">v :: Vector 2 r
</span><a href="#local-6989586621679322860"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679322822"><span class="hs-identifier hs-var">line</span></a></span><span class="annot"><span class="annottext">LinePV 2 r
-&gt; Getting (Vector 2 r) (LinePV 2 r) (Vector 2 r) -&gt; Vector 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Vector 2 r) (LinePV 2 r) (Vector 2 r)
forall (d :: Nat) r.
(Dimension (LinePV 2 r) ~ d, NumType (LinePV 2 r) ~ r) =&gt;
Lens' (LinePV 2 r) (Vector d r)
forall t (d :: Nat) r.
(HasDirection t, Dimension t ~ d, NumType t ~ r) =&gt;
Lens' t (Vector d r)
Lens' (LinePV 2 r) (Vector 2 r)
</span><span class="hs-identifier hs-var">direction</span></span><span>
</span><span id="line-307"></span><span>                     </span><span id="local-6989586621679322862"><span class="annot"><span class="annottext">region' :: TwoOrThree (HalfPlaneF (LinePV 2 r))
</span><a href="#local-6989586621679322862"><span class="hs-identifier hs-var hs-var">region'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r))
forall vertex r.
(Point_ vertex 2 r, Num r, Ord r) =&gt;
UnboundedConvexRegionF r NonEmpty vertex
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r))
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#unboundedBoundingHalfplanes"><span class="hs-identifier hs-var">unboundedBoundingHalfplanes</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679322825"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-308"></span><span>                     </span><span id="local-6989586621679322863"><span class="annot"><span class="annottext">v' :: Vector 2 r
</span><a href="#local-6989586621679322863"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(HalfPlaneF (LinePV 2 r) -&gt; Bool)
-&gt; TwoOrThree (HalfPlaneF (LinePV 2 r)) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322859"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; Point 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322860"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfPlaneF (LinePV 2 r) -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TwoOrThree (HalfPlaneF (LinePV 2 r))
</span><a href="#local-6989586621679322862"><span class="hs-identifier hs-var">region'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322860"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Vector_ vector d r) =&gt;
vector -&gt; vector
</span><span class="hs-identifier hs-var">negated</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679322860"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-309"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Point 2 r
-&gt; Vector (Dimension (Point 2 r)) (NumType (Point 2 r))
-&gt; HalfLine (Point 2 r)
forall point.
point -&gt; Vector (Dimension point) (NumType point) -&gt; HalfLine point
</span><span class="hs-identifier hs-var">HalfLine</span></span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679322859"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension (Point 2 r)) (NumType (Point 2 r))
</span><a href="#local-6989586621679322863"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-310"></span><span>                  </span><span class="hs-comment">-- if the point along v lies inside the (the unbounded part of the) region</span><span>
</span><span id="line-311"></span><span>                  </span><span class="hs-comment">-- use direction v, otherwise use direction v'.</span><span>
</span><span id="line-312"></span><span>                  </span><span class="hs-comment">-- note that since the intersection is guaranteed to be a halfline</span><span>
</span><span id="line-313"></span><span>                  </span><span class="hs-comment">-- this remainder of the halflien should lie in the unbounded part</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321660"><span id="local-6989586621679321661"><span id="local-6989586621679321662"><span id="local-6989586621679321663"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321660"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321662"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321661"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-316"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.At.html#IxValue"><span class="hs-identifier hs-type">IxValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321663"><span class="hs-identifier hs-type">endPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321662"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679321662"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EndPoint_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679321663"><span class="hs-identifier hs-type">endPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321662"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasOnSegment</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LineSegment</span></span><span> </span><span class="annot"><a href="#local-6989586621679321663"><span class="hs-identifier hs-type">endPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321662"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-318"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasIntersectionWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedLineSegment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LineSegment</span></span><span> </span><span class="annot"><a href="#local-6989586621679321663"><span class="hs-identifier hs-type">endPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321662"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasIntersectionWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HalfLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321661"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LineSegment</span></span><span> </span><span class="annot"><a href="#local-6989586621679321663"><span class="hs-identifier hs-type">endPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321662"><span class="hs-identifier hs-type">point</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LineSegment</span></span><span> </span><span class="annot"><a href="#local-6989586621679321663"><span class="hs-identifier hs-type">endPoint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321662"><span class="hs-identifier hs-type">point</span></a></span><span>
</span><span id="line-321"></span><span>                </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321661"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321660"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679323242"><span class="annot"><span class="annottext">LineSegment endPoint point
</span><a href="#local-6989586621679323242"><span class="hs-identifier hs-var">seg</span></a></span></span><span> </span><span id="local-6989586621679323243"><span class="annot"><span class="annottext">intersects :: LineSegment endPoint point
-&gt; UnboundedConvexRegionF r NonEmpty vertex -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">`intersects`</span></span></span><span> </span><span id="local-6989586621679323244"><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679323244"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LineSegment endPoint point
-&gt; LinePV
     (Dimension (LineSegment endPoint point))
     (NumType (LineSegment endPoint point))
forall t.
HasSupportingLine t =&gt;
t -&gt; LinePV (Dimension t) (NumType t)
</span><span class="hs-identifier hs-var">supportingLine</span></span><span> </span><span class="annot"><span class="annottext">LineSegment endPoint point
</span><a href="#local-6989586621679323242"><span class="hs-identifier hs-var">seg</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; Intersection
     (LinePV 2 r) (UnboundedConvexRegionF r NonEmpty vertex)
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679323244"><span class="hs-identifier hs-var">region</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="annottext">Maybe (LineUnboundedConvexRegionIntersection r)
Intersection
  (LinePV 2 r) (UnboundedConvexRegionF r NonEmpty vertex)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-324"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679323246"><span class="annot"><span class="annottext">LineUnboundedConvexRegionIntersection r
</span><a href="#local-6989586621679323246"><span class="hs-identifier hs-var">inters</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LineUnboundedConvexRegionIntersection r
</span><a href="#local-6989586621679323246"><span class="hs-identifier hs-var">inters</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_Point"><span class="hs-identifier hs-type">Line_x_UnboundedConvexRegion_Point</span></a></span><span> </span><span id="local-6989586621679323247"><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679323247"><span class="hs-identifier hs-var">p</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679323247"><span class="hs-identifier hs-var">p</span></a></span><span>    </span><span class="annot"><span class="annottext">Point 2 r -&gt; LineSegment endPoint point -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">LineSegment endPoint point
</span><a href="#local-6989586621679323242"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_LineSegment"><span class="hs-identifier hs-type">Line_x_UnboundedConvexRegion_LineSegment</span></a></span><span> </span><span id="local-6989586621679323248"><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679323248"><span class="hs-identifier hs-var">seg'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
</span><a href="#local-6989586621679323248"><span class="hs-identifier hs-var">seg'</span></a></span><span> </span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r) -&gt; LineSegment endPoint point -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">LineSegment endPoint point
</span><a href="#local-6989586621679323242"><span class="hs-identifier hs-var">seg</span></a></span><span>
</span><span id="line-327"></span><span>        </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Line_x_UnboundedConvexRegion_HalfLine"><span class="hs-identifier hs-type">Line_x_UnboundedConvexRegion_HalfLine</span></a></span><span>  </span><span id="local-6989586621679323249"><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679323249"><span class="hs-identifier hs-var">hl</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineSegment endPoint point
</span><a href="#local-6989586621679323242"><span class="hs-identifier hs-var">seg</span></a></span><span class="annot"><span class="annottext">LineSegment endPoint point
-&gt; Getting (Point 2 r) (LineSegment endPoint point) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(point -&gt; Const (Point 2 r) point)
-&gt; LineSegment endPoint point
-&gt; Const (Point 2 r) (LineSegment endPoint point)
forall seg p. HasStart seg p =&gt; Lens' seg p
Lens' (LineSegment endPoint point) point
</span><span class="hs-identifier hs-var">start</span></span><span class="annot"><span class="annottext">((point -&gt; Const (Point 2 r) point)
 -&gt; LineSegment endPoint point
 -&gt; Const (Point 2 r) (LineSegment endPoint point))
-&gt; ((Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
    -&gt; point -&gt; Const (Point 2 r) point)
-&gt; Getting (Point 2 r) (LineSegment endPoint point) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
-&gt; point -&gt; Const (Point 2 r) point
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfLine (Point 2 r) -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679323249"><span class="hs-identifier hs-var">hl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LineSegment endPoint point
</span><a href="#local-6989586621679323242"><span class="hs-identifier hs-var">seg</span></a></span><span class="annot"><span class="annottext">LineSegment endPoint point
-&gt; Getting (Point 2 r) (LineSegment endPoint point) (Point 2 r)
-&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(point -&gt; Const (Point 2 r) point)
-&gt; LineSegment endPoint point
-&gt; Const (Point 2 r) (LineSegment endPoint point)
forall seg p. HasEnd seg p =&gt; Lens' seg p
Lens' (LineSegment endPoint point) point
</span><span class="hs-identifier hs-var">end</span></span><span class="annot"><span class="annottext">((point -&gt; Const (Point 2 r) point)
 -&gt; LineSegment endPoint point
 -&gt; Const (Point 2 r) (LineSegment endPoint point))
-&gt; ((Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
    -&gt; point -&gt; Const (Point 2 r) point)
-&gt; Getting (Point 2 r) (LineSegment endPoint point) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Point 2 r) (Point 2 r))
-&gt; point -&gt; Const (Point 2 r) point
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfLine (Point 2 r) -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfLine (Point 2 r)
</span><a href="#local-6989586621679323249"><span class="hs-identifier hs-var">hl</span></a></span><span>
</span><span id="line-329"></span><span>            </span><span class="hs-comment">-- this is essentially the simplified version of 'hl `intersects` seg'</span><span>
</span><span id="line-330"></span><span>            </span><span class="hs-comment">-- as we already know they are colinear</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-333"></span><span class="annot"><span class="hs-comment">-- * Intersection of a Triangle with an Unbounded Convex Polygon</span></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Intersection"><span class="annot"><span class="hs-identifier hs-var">Intersection</span></span></span><span> </span><span id="local-6989586621679323252"><span id="local-6989586621679323253"><span id="local-6989586621679323254"><span id="local-6989586621679323255"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679323252"><span class="hs-identifier hs-type">corner</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679323253"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679323254"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679323255"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Intersection</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679323252"><span class="hs-identifier hs-type">corner</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Internal.html#ConvexPolygonF"><span class="hs-identifier hs-type">ConvexPolygonF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Cyclic.html#Cyclic"><span class="hs-identifier hs-type">Cyclic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679323254"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679323255"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321689"><span id="local-6989586621679321690"><span id="local-6989586621679321691"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321689"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321690"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321691"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321690"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321690"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321690"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-339"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679321691"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321690"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321689"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679323670"><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679323670"><span class="hs-identifier hs-var">tri</span></a></span></span><span> </span><span id="local-6989586621679323671"><span class="annot"><span class="annottext">intersects :: Triangle corner -&gt; UnboundedConvexRegionF r NonEmpty vertex -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">`intersects`</span></span></span><span> </span><span id="local-6989586621679323672"><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679323672"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-341"></span><span>       </span><span class="annot"><span class="annottext">Getting Any (UnboundedConvexRegionF r NonEmpty vertex) (Point 2 r)
-&gt; (Point 2 r -&gt; Bool)
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; Bool
forall s a. Getting Any s a -&gt; (a -&gt; Bool) -&gt; s -&gt; Bool
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#anyOf"><span class="hs-identifier hs-var">anyOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(vertex -&gt; Const Any vertex)
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; Const Any (UnboundedConvexRegionF r NonEmpty vertex)
(Vertex (UnboundedConvexRegionF r NonEmpty vertex)
 -&gt; Const Any (Vertex (UnboundedConvexRegionF r NonEmpty vertex)))
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; Const Any (UnboundedConvexRegionF r NonEmpty vertex)
forall graph graph'.
HasVertices graph graph' =&gt;
IndexedTraversal1
  (VertexIx graph) graph graph' (Vertex graph) (Vertex graph')
IndexedTraversal1
  (VertexIx (UnboundedConvexRegionF r NonEmpty vertex))
  (UnboundedConvexRegionF r NonEmpty vertex)
  (UnboundedConvexRegionF r NonEmpty vertex)
  (Vertex (UnboundedConvexRegionF r NonEmpty vertex))
  (Vertex (UnboundedConvexRegionF r NonEmpty vertex))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span class="annot"><span class="annottext">((vertex -&gt; Const Any vertex)
 -&gt; UnboundedConvexRegionF r NonEmpty vertex
 -&gt; Const Any (UnboundedConvexRegionF r NonEmpty vertex))
-&gt; ((Point 2 r -&gt; Const Any (Point 2 r))
    -&gt; vertex -&gt; Const Any vertex)
-&gt; Getting
     Any (UnboundedConvexRegionF r NonEmpty vertex) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const Any (Point 2 r)) -&gt; vertex -&gt; Const Any vertex
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' vertex (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; Triangle corner -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679323670"><span class="hs-identifier hs-var">tri</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679323672"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Getting Any (Triangle corner) (Point 2 r)
-&gt; (Point 2 r -&gt; Bool) -&gt; Triangle corner -&gt; Bool
forall s a. Getting Any s a -&gt; (a -&gt; Bool) -&gt; s -&gt; Bool
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#anyOf"><span class="hs-identifier hs-var">anyOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(corner -&gt; Const Any corner)
-&gt; Triangle corner -&gt; Const Any (Triangle corner)
(Vertex (Triangle corner) -&gt; Const Any (Vertex (Triangle corner)))
-&gt; Triangle corner -&gt; Const Any (Triangle corner)
forall graph graph'.
HasVertices graph graph' =&gt;
IndexedTraversal1
  (VertexIx graph) graph graph' (Vertex graph) (Vertex graph')
IndexedTraversal1
  (VertexIx (Triangle corner))
  (Triangle corner)
  (Triangle corner)
  (Vertex (Triangle corner))
  (Vertex (Triangle corner))
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hiraffe-0.1/doc/html/hiraffe/src/Hiraffe.Graph.Class.html#vertices"><span class="hs-identifier hs-var">vertices</span></a></span><span class="annot"><span class="annottext">((corner -&gt; Const Any corner)
 -&gt; Triangle corner -&gt; Const Any (Triangle corner))
-&gt; ((Point 2 r -&gt; Const Any (Point 2 r))
    -&gt; corner -&gt; Const Any corner)
-&gt; Getting Any (Triangle corner) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const Any (Point 2 r)) -&gt; corner -&gt; Const Any corner
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' corner (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; UnboundedConvexRegionF r NonEmpty vertex -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679323672"><span class="hs-identifier hs-var">region</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679323670"><span class="hs-identifier hs-var">tri</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Getting Any (Triangle (Point 2 r)) (ClosedLineSegment (Point 2 r))
-&gt; (ClosedLineSegment (Point 2 r) -&gt; Bool)
-&gt; Triangle (Point 2 r)
-&gt; Bool
forall s a. Getting Any s a -&gt; (a -&gt; Bool) -&gt; s -&gt; Bool
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#anyOf"><span class="hs-identifier hs-var">anyOf</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Any (Triangle (Point 2 r)) (ClosedLineSegment (Point 2 r))
forall polygon point r.
(HasOuterBoundary polygon, Vertex polygon ~ point,
 Point_ point 2 r) =&gt;
IndexedFold1
  (VertexIx polygon, VertexIx polygon)
  polygon
  (ClosedLineSegment point)
IndexedFold1
  (VertexIx (Triangle (Point 2 r)), VertexIx (Triangle (Point 2 r)))
  (Triangle (Point 2 r))
  (ClosedLineSegment (Point 2 r))
</span><a href="HGeometry.Polygon.Class.html#outerBoundaryEdgeSegments"><span class="hs-identifier hs-var">outerBoundaryEdgeSegments</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClosedLineSegment (Point 2 r)
-&gt; UnboundedConvexRegionF r NonEmpty vertex -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679323672"><span class="hs-identifier hs-var">region</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting (Point 2 r) corner (Point 2 r) -&gt; corner -&gt; Point 2 r
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Point 2 r) corner (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' corner (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span> </span><span class="annot"><span class="annottext">(corner -&gt; Point 2 r) -&gt; Triangle corner -&gt; Triangle (Point 2 r)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679323670"><span class="hs-identifier hs-var">tri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321719"><span id="local-6989586621679321720"><span id="local-6989586621679321721"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321719"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321720"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321721"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321720"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321720"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321720"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-348"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Triangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679321721"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`IsIntersectableWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321720"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321719"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679323859"><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679323859"><span class="hs-identifier hs-var">tri</span></a></span></span><span> </span><span id="local-6989586621679323860"><span class="annot"><span class="annottext">intersect :: Triangle corner
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; Intersection
     (Triangle corner) (UnboundedConvexRegionF r NonEmpty vertex)
</span><span class="hs-operator hs-var hs-var hs-var">`intersect`</span></span></span><span> </span><span id="local-6989586621679323861"><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679323861"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679323859"><span class="hs-identifier hs-var">tri</span></a></span><span> </span><span class="annot"><span class="annottext">Triangle corner
-&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
-&gt; Intersection
     (Triangle corner) (ConvexPolygonF (Cyclic NonEmpty) vertex)
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">Triangle corner
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
forall (nonEmpty :: * -&gt; *) point r vertex.
(Foldable nonEmpty, Point_ point 2 r, Point_ vertex 2 r, Ord r,
 Fractional r) =&gt;
nonEmpty point
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier hs-var">toBoundedFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Triangle corner
</span><a href="#local-6989586621679323859"><span class="hs-identifier hs-var">tri</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679323861"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Given some convex shape S, construct some &quot;big enough&quot; convex polygon B out of the</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- unbounded convex polygon U so that the intersection \(U \cap S\) is the same as \(B</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- \cap S\)</span><span>
</span><span id="line-354"></span><span class="hs-comment">--</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- note: this creates some new vertices; which are &quot;copies&quot; from the extremal vertices.</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- this is to avoid having to introduce yet another level of 'OriginalOrExtra''s</span><span>
</span><span id="line-357"></span><span id="local-6989586621679321728"><span id="local-6989586621679321729"><span id="local-6989586621679321730"><span id="local-6989586621679321731"><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier hs-type">toBoundedFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679321728"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321729"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321730"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321731"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321730"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321730"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321730"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679321728"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321729"><span class="hs-identifier hs-type">point</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321730"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321731"><span class="hs-identifier hs-type">vertex</span></a></span><span>
</span><span id="line-359"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Internal.html#ConvexPolygonF"><span class="hs-identifier hs-type">ConvexPolygonF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Cyclic.html#Cyclic"><span class="hs-identifier hs-type">Cyclic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679321731"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span></span><span>
</span><span id="line-360"></span><span id="toBoundedFrom"><span class="annot"><span class="annottext">toBoundedFrom :: forall (nonEmpty :: * -&gt; *) point r vertex.
(Foldable nonEmpty, Point_ point 2 r, Point_ vertex 2 r, Ord r,
 Fractional r) =&gt;
nonEmpty point
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier hs-var hs-var">toBoundedFrom</span></a></span></span><span> </span><span id="local-6989586621679324035"><span class="annot"><span class="annottext">nonEmpty point
</span><a href="#local-6989586621679324035"><span class="hs-identifier hs-var">tri</span></a></span></span><span> </span><span id="local-6989586621679324036"><span class="annot"><span class="annottext">reg :: UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679324036"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#Unbounded"><span class="hs-identifier hs-type">Unbounded</span></a></span><span> </span><span id="local-6989586621679324037"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679324037"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679324038"><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679324038"><span class="hs-identifier hs-var">pts</span></a></span></span><span> </span><span id="local-6989586621679324039"><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679324039"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex -&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
</span><a href="#local-6989586621679324040"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector 2 vertex -&gt; ConvexPolygonF (Cyclic NonEmpty) vertex)
-&gt; Vector 2 vertex -&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
forall r vertex.
UnboundedConvexRegionF r NonEmpty vertex
-&gt; Either vertex (Vector 2 vertex)
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#extremalVertices"><span class="hs-identifier hs-var">extremalVertices</span></a></span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679324036"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-361"></span><span>                                                   </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679324041"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324041"><span class="hs-identifier hs-var">p</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; Vector 2 vertex
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324041"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324041"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-362"></span><span>                                                   </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679324042"><span class="annot"><span class="annottext">Vector 2 vertex
</span><a href="#local-6989586621679324042"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector 2 vertex
</span><a href="#local-6989586621679324042"><span class="hs-identifier hs-var">vec</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-comment">-- the main idea is to compute the line through two points on the boundary of the of</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-comment">-- halflines bounding the region, and consider the halfplane h that is bounded by this</span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-comment">-- line l and contains the vertices of the unbounded region. We now find the furthest</span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-comment">-- point pt from h (among the points in tri), and construct a line l' through this</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-comment">-- furthest point. It follows all points in tri lie &quot;right&quot; of this line (on the same</span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-comment">-- side as the vertices of our unbounded region). Hence, we can safely clip the region</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-comment">-- using this line l'. (So we compute the intersection point between the two bounding</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-comment">-- rays and l') to find the two additional vertices a and b that we have to insert.</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679324040"><span class="annot"><span class="annottext">go :: Vector 2 vertex -&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
</span><a href="#local-6989586621679324040"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679324043"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324043"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679324044"><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324044"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex -&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
forall simplePolygon point r (f :: * -&gt; *).
(SimplePolygon_ simplePolygon point r, Foldable1 f) =&gt;
f point -&gt; simplePolygon
forall (f :: * -&gt; *).
Foldable1 f =&gt;
f vertex -&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
</span><a href="HGeometry.Polygon.Simple.Class.html#uncheckedFromCCWPoints"><span class="hs-identifier hs-var">uncheckedFromCCWPoints</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty vertex -&gt; ConvexPolygonF (Cyclic NonEmpty) vertex)
-&gt; NonEmpty vertex -&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324045"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; NonEmpty vertex -&gt; NonEmpty vertex
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NonEmpty.&lt;|</span></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324047"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; NonEmpty vertex -&gt; NonEmpty vertex
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NonEmpty.&lt;|</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty vertex
</span><a href="#local-6989586621679324038"><span class="hs-identifier hs-var">pts</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>        </span><span id="local-6989586621679324048"><span class="annot"><span class="annottext">l :: LinePV 2 r
</span><a href="#local-6989586621679324048"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vertex -&gt; vertex -&gt; LinePV 2 r
forall line point (d :: Nat) r.
(Line_ line d r, Point_ point d r, Num r) =&gt;
point -&gt; point -&gt; line
</span><span class="hs-identifier hs-var">lineThrough</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324043"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Vector 2 r -&gt; vertex
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.-^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679324037"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324044"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Vector 2 r -&gt; vertex
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679324039"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LinePV</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-377"></span><span>        </span><span id="local-6989586621679324151"><span class="annot"><span class="annottext">h' :: HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679324151"><span class="hs-identifier hs-var hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sign -&gt; LinePV 2 r -&gt; HalfSpaceF (LinePV 2 r)
forall boundingHyperPlane.
Sign -&gt; boundingHyperPlane -&gt; HalfSpaceF boundingHyperPlane
</span><span class="hs-identifier hs-var">HalfSpace</span></span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sign.html#Negative"><span class="hs-identifier hs-var">Negative</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679324048"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-378"></span><span>        </span><span id="local-6989586621679324154"><span class="annot"><span class="annottext">h :: HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679324154"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679324155"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfSpaceF (LinePV 2 r) -&gt; Bool
forall g h. HasIntersectionWith g h =&gt; g -&gt; h -&gt; Bool
</span><span class="hs-operator hs-var">`intersects`</span></span><span> </span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679324151"><span class="hs-identifier hs-var">h'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679324151"><span class="hs-identifier hs-var">h'</span></a></span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
-&gt; (HalfSpaceF (LinePV 2 r) -&gt; HalfSpaceF (LinePV 2 r))
-&gt; HalfSpaceF (LinePV 2 r)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Sign -&gt; Identity Sign)
-&gt; HalfSpaceF (LinePV 2 r) -&gt; Identity (HalfSpaceF (LinePV 2 r))
forall halfSpace (d :: Nat) r.
HalfSpace_ halfSpace d r =&gt;
Lens' halfSpace Sign
Lens' (HalfSpaceF (LinePV 2 r)) Sign
</span><span class="hs-identifier hs-var">halfSpaceSign</span></span><span> </span><span class="annot"><span class="annottext">((Sign -&gt; Identity Sign)
 -&gt; HalfSpaceF (LinePV 2 r) -&gt; Identity (HalfSpaceF (LinePV 2 r)))
-&gt; Sign -&gt; HalfSpaceF (LinePV 2 r) -&gt; HalfSpaceF (LinePV 2 r)
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Sign
</span><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Sign.html#Positive"><span class="hs-identifier hs-var">Positive</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679324151"><span class="hs-identifier hs-var">h'</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span id="local-6989586621679324155"><span class="annot"><span class="annottext">q' :: Point 2 r
</span><a href="#local-6989586621679324155"><span class="hs-identifier hs-var hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324044"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">vertex -&gt; Vector 2 r -&gt; vertex
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679324039"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r -&gt; Vector 2 r -&gt; Vector 2 r
forall r vector (d :: Nat).
(Num r, Additive_ vector d r) =&gt;
vector -&gt; vector -&gt; vector
</span><span class="hs-operator hs-var">^+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679324039"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">vertex -&gt; Getting (Point 2 r) vertex (Point 2 r) -&gt; Point 2 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Point 2 r) vertex (Point 2 r)
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' vertex (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span>
</span><span id="line-380"></span><span>          </span><span class="hs-comment">-- make sure that there is at least one point outside the halfplane</span><span>
</span><span id="line-381"></span><span>        </span><span id="local-6989586621679324161"><span class="annot"><span class="annottext">pt :: Point 2 r
</span><a href="#local-6989586621679324161"><span class="hs-identifier hs-var hs-var">pt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point 2 r -&gt; r) -&gt; NonEmpty (Point 2 r) -&gt; Point 2 r
forall {t :: * -&gt; *} {a} {a}.
(Foldable1 t, Ord a) =&gt;
(a -&gt; a) -&gt; t a -&gt; a
</span><a href="#local-6989586621679324162"><span class="hs-identifier hs-var">maximumOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r -&gt; HalfSpaceF (LinePV 2 r) -&gt; r
forall g r (d :: Nat) point.
(HasSquaredEuclideanDistance g, r ~ NumType g, d ~ Dimension g,
 Num r, Point_ point d r) =&gt;
point -&gt; g -&gt; r
forall r (d :: Nat) point.
(r ~ NumType (HalfSpaceF (LinePV 2 r)),
 d ~ Dimension (HalfSpaceF (LinePV 2 r)), Num r,
 Point_ point d r) =&gt;
point -&gt; HalfSpaceF (LinePV 2 r) -&gt; r
</span><span class="hs-operator hs-var">`squaredEuclideanDistTo`</span></span><span> </span><span class="annot"><span class="annottext">HalfSpaceF (LinePV 2 r)
</span><a href="#local-6989586621679324154"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679324155"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; [Point 2 r] -&gt; NonEmpty (Point 2 r)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">nonEmpty point
</span><a href="#local-6989586621679324035"><span class="hs-identifier hs-var">tri</span></a></span><span class="annot"><span class="annottext">nonEmpty point
-&gt; Getting (Endo [Point 2 r]) (nonEmpty point) (Point 2 r)
-&gt; [Point 2 r]
forall s a. s -&gt; Getting (Endo [a]) s a -&gt; [a]
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#%5E.."><span class="hs-operator hs-var">^..</span></a></span><span class="annot"><span class="annottext">(point -&gt; Const (Endo [Point 2 r]) point)
-&gt; nonEmpty point -&gt; Const (Endo [Point 2 r]) (nonEmpty point)
forall (f :: * -&gt; *) a. Foldable f =&gt; IndexedFold Int (f a) a
IndexedFold Int (nonEmpty point) point
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#folded"><span class="hs-identifier hs-var">folded</span></a></span><span class="annot"><span class="annottext">((point -&gt; Const (Endo [Point 2 r]) point)
 -&gt; nonEmpty point -&gt; Const (Endo [Point 2 r]) (nonEmpty point))
-&gt; ((Point 2 r -&gt; Const (Endo [Point 2 r]) (Point 2 r))
    -&gt; point -&gt; Const (Endo [Point 2 r]) point)
-&gt; Getting (Endo [Point 2 r]) (nonEmpty point) (Point 2 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Const (Endo [Point 2 r]) (Point 2 r))
-&gt; point -&gt; Const (Endo [Point 2 r]) point
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' point (Point 2 r)
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>          </span><span class="hs-comment">-- the furthest point in the direction perpendicular to the halfplane</span><span>
</span><span id="line-383"></span><span>        </span><span id="local-6989586621679324165"><span class="annot"><span class="annottext">l' :: LinePV 2 r
</span><a href="#local-6989586621679324165"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679324048"><span class="hs-identifier hs-var">l</span></a></span><span class="annot"><span class="annottext">LinePV 2 r -&gt; (LinePV 2 r -&gt; LinePV 2 r) -&gt; LinePV 2 r
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(Point 2 r -&gt; Identity (Point 2 r))
-&gt; LinePV 2 r -&gt; Identity (LinePV 2 r)
forall (d :: Nat) r (f :: * -&gt; *).
Functor f =&gt;
(Point d r -&gt; f (Point d r)) -&gt; LinePV d r -&gt; f (LinePV d r)
</span><span class="hs-identifier hs-var">anchorPoint</span></span><span> </span><span class="annot"><span class="annottext">((Point 2 r -&gt; Identity (Point 2 r))
 -&gt; LinePV 2 r -&gt; Identity (LinePV 2 r))
-&gt; Point 2 r -&gt; LinePV 2 r -&gt; LinePV 2 r
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point 2 r
</span><a href="#local-6989586621679324161"><span class="hs-identifier hs-var">pt</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 r -&gt; Vector 2 r -&gt; Point 2 r
forall point (d :: Nat) r.
(Affine_ point d r, Num r) =&gt;
point -&gt; Vector d r -&gt; point
</span><span class="hs-operator hs-var">.+^</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
</span><a href="#local-6989586621679324039"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- move even a bit further to make sure</span><span>
</span><span id="line-384"></span><span>                                         </span><span class="hs-comment">-- that the new vertices (a,b) we get are strictly</span><span>
</span><span id="line-385"></span><span>                                         </span><span class="hs-comment">-- outside the input triangle tri</span><span>
</span><span id="line-386"></span><span>        </span><span id="local-6989586621679324047"><span class="annot"><span class="annottext">a :: vertex
</span><a href="#local-6989586621679324047"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vertex
-&gt; Vector (Dimension vertex) (NumType vertex)
-&gt; LinePV 2 r
-&gt; vertex
forall {b} {h} {line}.
(Intersection (LinePV (Dimension b) (NumType b)) h
 ~ Maybe (LineLineIntersectionG (NumType b) line),
 Assert
   (OrdCond (CmpNat 1 (Dimension b)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension b)) 'True 'True 'False)
   (TypeError ...),
 IsIntersectableWith (LinePV (Dimension b) (NumType b)) h,
 Point_ b (Dimension b) (NumType b)) =&gt;
b -&gt; Vector (Dimension b) (NumType b) -&gt; h -&gt; b
</span><a href="#local-6989586621679324167"><span class="hs-identifier hs-var">intersectionPoint</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324043"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension vertex) (NumType vertex)
</span><a href="#local-6989586621679324037"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679324165"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-comment">-- no need to negate v here</span><span>
</span><span id="line-387"></span><span>        </span><span id="local-6989586621679324045"><span class="annot"><span class="annottext">b :: vertex
</span><a href="#local-6989586621679324045"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vertex
-&gt; Vector (Dimension vertex) (NumType vertex)
-&gt; LinePV 2 r
-&gt; vertex
forall {b} {h} {line}.
(Intersection (LinePV (Dimension b) (NumType b)) h
 ~ Maybe (LineLineIntersectionG (NumType b) line),
 Assert
   (OrdCond (CmpNat 1 (Dimension b)) 'True 'True 'False)
   (TypeError ...),
 Assert
   (OrdCond (CmpNat 2 (Dimension b)) 'True 'True 'False)
   (TypeError ...),
 IsIntersectableWith (LinePV (Dimension b) (NumType b)) h,
 Point_ b (Dimension b) (NumType b)) =&gt;
b -&gt; Vector (Dimension b) (NumType b) -&gt; h -&gt; b
</span><a href="#local-6989586621679324167"><span class="hs-identifier hs-var">intersectionPoint</span></a></span><span> </span><span class="annot"><span class="annottext">vertex
</span><a href="#local-6989586621679324044"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Vector 2 r
Vector (Dimension vertex) (NumType vertex)
</span><a href="#local-6989586621679324039"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV 2 r
</span><a href="#local-6989586621679324165"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621679324162"><span class="annot"><span class="annottext">maximumOn :: (a -&gt; a) -&gt; t a -&gt; a
</span><a href="#local-6989586621679324162"><span class="hs-identifier hs-var hs-var">maximumOn</span></a></span></span><span> </span><span id="local-6989586621679324176"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679324176"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
forall (t :: * -&gt; *) a.
Foldable1 t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a -&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679324176"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679324167"><span class="annot"><span class="annottext">intersectionPoint :: b -&gt; Vector (Dimension b) (NumType b) -&gt; h -&gt; b
</span><a href="#local-6989586621679324167"><span class="hs-identifier hs-var hs-var">intersectionPoint</span></a></span></span><span> </span><span id="local-6989586621679324406"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679324406"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679324407"><span class="annot"><span class="annottext">Vector (Dimension b) (NumType b)
</span><a href="#local-6989586621679324407"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621679324408"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679324408"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Point (Dimension b) (NumType b)
-&gt; Vector (Dimension b) (NumType b)
-&gt; LinePV (Dimension b) (NumType b)
forall (d :: Nat) r. Point d r -&gt; Vector d r -&gt; LinePV d r
</span><span class="hs-identifier hs-var">LinePV</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679324406"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">b
-&gt; Getting
     (Point (Dimension b) (NumType b))
     b
     (Point (Dimension b) (NumType b))
-&gt; Point (Dimension b) (NumType b)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting
  (Point (Dimension b) (NumType b))
  b
  (Point (Dimension b) (NumType b))
forall point (d :: Nat) r.
Point_ point d r =&gt;
Lens' point (Point d r)
Lens' b (Point (Dimension b) (NumType b))
</span><span class="hs-identifier hs-var">asPoint</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector (Dimension b) (NumType b)
</span><a href="#local-6989586621679324407"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">LinePV (Dimension b) (NumType b)
-&gt; h -&gt; Intersection (LinePV (Dimension b) (NumType b)) h
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679324408"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-393"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Line_x_Line_Point</span></span><span> </span><span id="local-6989586621679324410"><span class="annot"><span class="annottext">Point 2 (NumType b)
</span><a href="#local-6989586621679324410"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679324406"><span class="hs-identifier hs-var">p</span></a></span><span class="annot"><span class="annottext">b -&gt; (b -&gt; b) -&gt; b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(NumType b -&gt; Identity (NumType b)) -&gt; b -&gt; Identity b
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int b (NumType b)
</span><span class="hs-identifier hs-var">xCoord</span></span><span> </span><span class="annot"><span class="annottext">((NumType b -&gt; Identity (NumType b)) -&gt; b -&gt; Identity b)
-&gt; NumType b -&gt; b -&gt; b
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 (NumType b)
</span><a href="#local-6989586621679324410"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Point 2 (NumType b)
-&gt; Getting (NumType b) (Point 2 (NumType b)) (NumType b)
-&gt; NumType b
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType b) (Point 2 (NumType b)) (NumType b)
forall (d :: Nat) point r.
(1 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 (NumType b)) (NumType b)
</span><span class="hs-identifier hs-var">xCoord</span></span><span>
</span><span id="line-394"></span><span>                                     </span><span class="annot"><span class="annottext">b -&gt; (b -&gt; b) -&gt; b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(NumType b -&gt; Identity (NumType b)) -&gt; b -&gt; Identity b
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int b (NumType b)
</span><span class="hs-identifier hs-var">yCoord</span></span><span> </span><span class="annot"><span class="annottext">((NumType b -&gt; Identity (NumType b)) -&gt; b -&gt; Identity b)
-&gt; NumType b -&gt; b -&gt; b
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Setter.html#.~"><span class="hs-operator hs-var">.~</span></a></span><span> </span><span class="annot"><span class="annottext">Point 2 (NumType b)
</span><a href="#local-6989586621679324410"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Point 2 (NumType b)
-&gt; Getting (NumType b) (Point 2 (NumType b)) (NumType b)
-&gt; NumType b
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (NumType b) (Point 2 (NumType b)) (NumType b)
forall (d :: Nat) point r.
(2 &lt;= d, Point_ point d r) =&gt;
IndexedLens' Int point r
IndexedLens' Int (Point 2 (NumType b)) (NumType b)
</span><span class="hs-identifier hs-var">yCoord</span></span><span>
</span><span id="line-395"></span><span>      </span><span class="annot"><span class="annottext">Intersection (LinePV (Dimension b) (NumType b)) h
</span><span class="hs-identifier">_</span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; b
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;intersectionPoint: absurd'&quot;</span></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- -- TODO: this would make for a good property test: test if the points all lie inside the reegion</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-401"></span><span class="annot"><span class="hs-comment">-- * Intersection of a Rectangle with an Unbounded Convex Polygon</span></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Intersection"><span class="annot"><span class="hs-identifier hs-var">Intersection</span></span></span><span> </span><span id="local-6989586621679324414"><span id="local-6989586621679324415"><span id="local-6989586621679324416"><span id="local-6989586621679324417"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679324414"><span class="hs-identifier hs-type">corner</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679324415"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679324416"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679324417"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Intersection</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679324414"><span class="hs-identifier hs-type">corner</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Polygon.Convex.Internal.html#ConvexPolygonF"><span class="hs-identifier hs-type">ConvexPolygonF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/work/hgeometry/hgeometry/dist-newstyle/build/x86_64-linux/ghc-9.12.2/hgeometry-combinatorial-1.0.0.0/doc/html/hgeometry-combinatorial/src/HGeometry.Cyclic.html#Cyclic"><span class="hs-identifier hs-type">Cyclic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679324416"><span class="hs-identifier hs-type">nonEmpty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679324417"><span class="hs-identifier hs-type">vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321809"><span id="local-6989586621679321810"><span id="local-6989586621679321811"><span id="local-6989586621679324423"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321809"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321810"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321811"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321810"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321810"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321810"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-407"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679321811"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`HasIntersectionWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321810"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321809"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679321806"><span id="local-6989586621679321807"><span id="local-6989586621679321808"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321806"><span class="hs-identifier hs-type">vertex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321807"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Point_</span></span><span> </span><span class="annot"><a href="#local-6989586621679321808"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><a href="#local-6989586621679321807"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679321807"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679321807"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-410"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="annot"><a href="#local-6989586621679321808"><span class="hs-identifier hs-type">corner</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`IsIntersectableWith`</span></span><span> </span><span class="annot"><a href="HGeometry.Polygon.Convex.Unbounded.html#UnboundedConvexRegionF"><span class="hs-identifier hs-type">UnboundedConvexRegionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679321807"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679321806"><span class="hs-identifier hs-type">vertex</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621679324730"><span class="annot"><span class="annottext">Rectangle corner
</span><a href="#local-6989586621679324730"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span id="local-6989586621679324731"><span class="annot"><span class="annottext">intersect :: Rectangle corner
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; Intersection
     (Rectangle corner) (UnboundedConvexRegionF r NonEmpty vertex)
</span><span class="hs-operator hs-var hs-var hs-var">`intersect`</span></span></span><span> </span><span id="local-6989586621679324732"><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679324732"><span class="hs-identifier hs-var">region</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle corner
</span><a href="#local-6989586621679324730"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle corner
-&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
-&gt; Intersection
     (Rectangle corner) (ConvexPolygonF (Cyclic NonEmpty) vertex)
forall g h. IsIntersectableWith g h =&gt; g -&gt; h -&gt; Intersection g h
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">Corners corner
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
forall (nonEmpty :: * -&gt; *) point r vertex.
(Foldable nonEmpty, Point_ point 2 r, Point_ vertex 2 r, Ord r,
 Fractional r) =&gt;
nonEmpty point
-&gt; UnboundedConvexRegionF r NonEmpty vertex
-&gt; ConvexPolygonF (Cyclic NonEmpty) vertex
</span><a href="HGeometry.Polygon.Convex.Unbounded.html#toBoundedFrom"><span class="hs-identifier hs-var">toBoundedFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle corner -&gt; Corners corner
forall r rectangle point.
(Num r, Rectangle_ rectangle point, Point_ point 2 r) =&gt;
rectangle -&gt; Corners point
</span><span class="hs-identifier hs-var">Box.corners</span></span><span> </span><span class="annot"><span class="annottext">Rectangle corner
</span><a href="#local-6989586621679324730"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UnboundedConvexRegionF r NonEmpty vertex
</span><a href="#local-6989586621679324732"><span class="hs-identifier hs-var">region</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-comment">-- case traverse (`intersect` box) rays of</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-comment">--   Just (Vector2 (HalfLine_x_Box_LineSegment s1)</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-comment">--                 (HalfLine_x_Box_LineSegment s2)) -&gt; f (s1^.end) (s2^.end)</span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-comment">--   _ -&gt; error &quot;toBoundedFrom: absurd&quot;</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-comment">-- where</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-comment">--   (a,qSide) = intersectionPoint r1</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-comment">--   (b,pSide) = intersectionPoint r2</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>  </span><span class="hs-comment">--   box = boundingBox $ boxRay r1 &lt;&gt; boxRay r2 &lt;&gt; toNonEmptyOf folded tri</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-comment">--   rays@(Vector2 r1 r2) = boundingRays reg</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-comment">--   boxRay r = NonEmpty.fromList [ r^.start, r^.start .+^ r^.direction ]</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-comment">--   f a b = uncheckedFromCCWPoints $ case cornerInBetween b a box of</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-comment">--             Nothing -&gt; b NonEmpty.&lt;|               a NonEmpty.&lt;| pts</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-comment">--             Just c  -&gt; b NonEmpty.&lt;| c NonEmpty.&lt;| a NonEmpty.&lt;| pts</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- -- | Given a ray that starts inside the box box, compute the edge (and its index) on</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- -- which the ray intersects (and thus exits) the box</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- --</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- -- pre: the ray starts in the rectangle!</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- intersectionPoint       :: (Point_ corner 2 r, Fractional r, Ord r)</span><span>
</span><span id="line-446"></span><span class="hs-comment">--                         =&gt; HalfLine line -&gt; Rectangle corner</span><span>
</span><span id="line-447"></span><span class="hs-comment">--                         -&gt; (Point 2 r :+ VertexIx (Rectangle corner))</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- intersectionPoint r box = case getFirst $ intersectionPoint' r of</span><span>
</span><span id="line-449"></span><span class="hs-comment">--                             Nothing -&gt; error &quot;intersectionPoint: precondititon failed &quot;</span><span>
</span><span id="line-450"></span><span class="hs-comment">--                             Just x  -&gt; x</span><span>
</span><span id="line-451"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-452"></span><span class="hs-comment">--     intersectionPoint' r = flip (ifoldMapOf outerBoundaryEdgeSegments) box $ \(side,_) seg -&gt;</span><span>
</span><span id="line-453"></span><span class="hs-comment">--       case r `intersect` seg of</span><span>
</span><span id="line-454"></span><span class="hs-comment">--         Just (HalfLine_x_LineSegment_Point x) -&gt; First $ Just (x :+ side)</span><span>
</span><span id="line-455"></span><span class="hs-comment">--         _                                     -&gt; First   Nothing</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- -- | Given two vertex indices, computes the list of vertices in between them.</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- cornersInBetween         :: ( HasVertices triangle triangle, Eq (VertexIx triangle)</span><span>
</span><span id="line-460"></span><span class="hs-comment">--                             , Point_ (Vertex triangle) 2 r</span><span>
</span><span id="line-461"></span><span class="hs-comment">--                             )</span><span>
</span><span id="line-462"></span><span class="hs-comment">--                          =&gt; VertexIx triangle -&gt; VertexIx triangle</span><span>
</span><span id="line-463"></span><span class="hs-comment">--                          -&gt; triangle -&gt; [Point 2 r]</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- cornersInBetween s e tri = map (^._2.asPoint)</span><span>
</span><span id="line-465"></span><span class="hs-comment">--                          . takeWhile ((/= e) . fst) . dropWhile ((/= s) . fst)</span><span>
</span><span id="line-466"></span><span class="hs-comment">--                          $ cycle (itoListOf vertices tri)</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="hs-comment">-- -- | Given two points a and b on the sides of the box, computes the first CCW corner in</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- -- between a and b on the box (considered from a)</span><span>
</span><span id="line-471"></span><span class="hs-comment">-- cornerInBetween a b box = case</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">--   case extremalVertices reg of</span><span>
</span><span id="line-475"></span><span class="hs-comment">--     Right (Vector2 p q) -&gt; compute p q</span><span>
</span><span id="line-476"></span><span class="hs-comment">--     Left p              -&gt; compute p p</span><span>
</span><span id="line-477"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-478"></span><span class="hs-comment">--     box =</span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-490"></span></pre></body></html>