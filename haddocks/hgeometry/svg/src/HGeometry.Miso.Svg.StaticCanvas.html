<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings          #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  HGeometry.Miso.Svg.StaticCanvas</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- A Static canvas to be usedi nMiso applications</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html"><span class="hs-identifier">HGeometry.Miso.Svg.StaticCanvas</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#StaticCanvas"><span class="hs-identifier">StaticCanvas</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#staticCanvas"><span class="hs-identifier">staticCanvas</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#HasDimensions"><span class="hs-identifier">HasDimensions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-comment">-- , center, dimensions, zoomLevel</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#staticCanvas_"><span class="hs-identifier">staticCanvas_</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-comment">-- , textAt</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-comment">-- , realWorldCoordinates</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#ToSvgCoordinate"><span class="hs-identifier">ToSvgCoordinate</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#matrixToMisoString"><span class="hs-identifier">matrixToMisoString</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.html/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Traversal.html/Control.Lens.Traversal.html#elements"><span class="hs-identifier">elements</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Matrix</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Transformation</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Vector</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">HGeometry.Viewport</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.html/Miso.html"><span class="hs-identifier">Miso</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Types.html/Miso.Html.Types.html#Attribute"><span class="hs-identifier">Attribute</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Types.html/Miso.Html.Types.html#View"><span class="hs-identifier">View</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Property.html/Miso.Html.Property.html#height_"><span class="hs-identifier">height_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Property.html/Miso.Html.Property.html#width_"><span class="hs-identifier">width_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html"><span class="hs-identifier">Miso.String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#MisoString"><span class="hs-identifier">MisoString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#ToMisoString"><span class="hs-identifier">ToMisoString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#ms"><span class="hs-identifier">ms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Miso.String.Util.html"><span class="hs-identifier">Miso.String.Util</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MisoString</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Svg.html/Miso.Svg.html"><span class="hs-identifier">Miso.Svg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Svg.Element.html/Miso.Svg.Element.html#svg_"><span class="hs-identifier">svg_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Svg.Element.html/Miso.Svg.Element.html#g_"><span class="hs-identifier">g_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Svg.Attribute.html/Miso.Svg.Attribute.html#transform_"><span class="hs-identifier">transform_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-37"></span><span class="annot"><span class="hs-comment">-- *A Canvas</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="annot"><span class="hs-comment">-- | Static Canvas that has a &quot;proper&quot; Coordinate system whose origin is in the bottom left.</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">data</span><span> </span><span id="StaticCanvas"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#StaticCanvas"><span class="hs-identifier hs-var">StaticCanvas</span></a></span></span><span> </span><span id="local-6989586621679253248"><span class="annot"><a href="#local-6989586621679253248"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-41"></span><span>  </span><span id="Canvas"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#Canvas"><span class="hs-identifier hs-var">Canvas</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="_theViewport"><span class="annot"><span class="annottext">forall r. StaticCanvas r -&gt; Viewport r
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#_theViewport"><span class="hs-identifier hs-var hs-var">_theViewport</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Viewport</span></span><span> </span><span class="annot"><a href="#local-6989586621679253248"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ the viewport</span></span><span>
</span><span id="line-43"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="_dimensions"><span class="annot"><span class="annottext">forall r. StaticCanvas r -&gt; Vector 2 Int
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#_dimensions"><span class="hs-identifier hs-var hs-var">_dimensions</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ dimensions (width,height) in pixels, of the canvas</span></span><span>
</span><span id="line-45"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253393"><span id="local-6989586621679253400"><span class="annot"><span class="annottext">StaticCanvas r -&gt; StaticCanvas r -&gt; Bool
(StaticCanvas r -&gt; StaticCanvas r -&gt; Bool)
-&gt; (StaticCanvas r -&gt; StaticCanvas r -&gt; Bool)
-&gt; Eq (StaticCanvas r)
forall r. Eq r =&gt; StaticCanvas r -&gt; StaticCanvas r -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall r. Eq r =&gt; StaticCanvas r -&gt; StaticCanvas r -&gt; Bool
== :: StaticCanvas r -&gt; StaticCanvas r -&gt; Bool
$c/= :: forall r. Eq r =&gt; StaticCanvas r -&gt; StaticCanvas r -&gt; Bool
/= :: StaticCanvas r -&gt; StaticCanvas r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><span class="hs-comment">-- | Lens to access the viewport of a Canvas</span></span><span>
</span><span id="line-49"></span><span id="local-6989586621679253260"><span id="local-6989586621679253261"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#theViewport"><span class="hs-identifier hs-type">theViewport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens"><span class="hs-identifier hs-type">Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#StaticCanvas"><span class="hs-identifier hs-type">StaticCanvas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253260"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#StaticCanvas"><span class="hs-identifier hs-type">StaticCanvas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253261"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Viewport</span></span><span> </span><span class="annot"><a href="#local-6989586621679253260"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Viewport</span></span><span> </span><span class="annot"><a href="#local-6989586621679253261"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-50"></span><span id="theViewport"><span class="annot"><span class="annottext">theViewport :: forall r s (f :: * -&gt; *).
Functor f =&gt;
(Viewport r -&gt; f (Viewport s))
-&gt; StaticCanvas r -&gt; f (StaticCanvas s)
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#theViewport"><span class="hs-identifier hs-var hs-var">theViewport</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StaticCanvas r -&gt; Viewport r)
-&gt; (StaticCanvas r -&gt; Viewport s -&gt; StaticCanvas s)
-&gt; Lens (StaticCanvas r) (StaticCanvas s) (Viewport r) (Viewport s)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">StaticCanvas r -&gt; Viewport r
forall r. StaticCanvas r -&gt; Viewport r
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#_theViewport"><span class="hs-identifier hs-var">_theViewport</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679253409"><span class="annot"><span class="annottext">StaticCanvas r
</span><a href="#local-6989586621679253409"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679253410"><span class="annot"><span class="annottext">Viewport s
</span><a href="#local-6989586621679253410"><span class="hs-identifier hs-var">vp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StaticCanvas r
</span><a href="#local-6989586621679253409"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#_theViewport"><span class="hs-identifier hs-var">_theViewport</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679253410"><span class="hs-identifier hs-type">vp</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><span class="hs-comment">-- | Class for types that have a 'dimensions' field</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">class</span><span> </span><span id="HasDimensions"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#HasDimensions"><span class="hs-identifier hs-var">HasDimensions</span></a></span></span><span> </span><span id="local-6989586621679253273"><span class="annot"><a href="#local-6989586621679253273"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679253274"><span class="annot"><a href="#local-6989586621679253274"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679253273"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679253274"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-comment">-- | Lens to access the Dimensions field</span><span>
</span><span id="line-55"></span><span>  </span><span id="dimensions"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#dimensions"><span class="hs-identifier hs-type">dimensions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Type.html/Control.Lens.Type.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253273"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253274"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679253275"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#HasDimensions"><span class="hs-identifier hs-type">HasDimensions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#StaticCanvas"><span class="hs-identifier hs-type">StaticCanvas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253275"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679253417"><span class="annot"><span class="annottext">dimensions :: Lens' (StaticCanvas r) (Vector 2 Int)
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#dimensions"><span class="hs-identifier hs-var hs-var hs-var">dimensions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StaticCanvas r -&gt; Vector 2 Int)
-&gt; (StaticCanvas r -&gt; Vector 2 Int -&gt; StaticCanvas r)
-&gt; Lens' (StaticCanvas r) (Vector 2 Int)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Lens.html/Control.Lens.Lens.html#lens"><span class="hs-identifier hs-var">lens</span></a></span><span> </span><span class="annot"><span class="annottext">StaticCanvas r -&gt; Vector 2 Int
forall r. StaticCanvas r -&gt; Vector 2 Int
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#_dimensions"><span class="hs-identifier hs-var">_dimensions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679253418"><span class="annot"><span class="annottext">StaticCanvas r
</span><a href="#local-6989586621679253418"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679253419"><span class="annot"><span class="annottext">Vector 2 Int
</span><a href="#local-6989586621679253419"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StaticCanvas r
</span><a href="#local-6989586621679253418"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#_dimensions"><span class="hs-identifier hs-var">_dimensions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679253419"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#dimensions"><span class="hs-pragma hs-type">dimensions</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- class HasTheViewport s a | s -&gt; a where</span><span>
</span><span id="line-63"></span><span class="hs-comment">--   theViewport :: Lens' s a</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- instance HasTheViewport (Canvas r) (Viewport r) where</span><span>
</span><span id="line-66"></span><span class="hs-comment">--   {-# INLINE theViewport #-}</span><span>
</span><span id="line-67"></span><span class="hs-comment">--   theViewport f (Canvas vp d) = fmap (\ vp' -&gt; Canvas vp' d) (f vp)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- center     :: Lens' (Canvas r) (Point 2 r)</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- center     = lens _center     (\cv c -&gt; cv { _center     = c } )</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- dimensions :: Lens' (Canvas r) (Vector 2 Int)</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- dimensions = lens _dimensions (\cv c -&gt; cv { _dimensions = c } )</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- zoomLevel  :: Lens' (Canvas r) r</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- zoomLevel  = lens _zoomLevel      (\cv c -&gt; cv { _zoomLevel      = c } )</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-79"></span><span class="annot"><span class="hs-comment">-- | Create a canvas</span></span><span>
</span><span id="line-80"></span><span id="local-6989586621679253277"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#staticCanvas"><span class="hs-identifier hs-type">staticCanvas</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679253277"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-81"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#StaticCanvas"><span class="hs-identifier hs-type">StaticCanvas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253277"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-82"></span><span id="staticCanvas"><span class="annot"><span class="annottext">staticCanvas :: forall r. Num r =&gt; Int -&gt; Int -&gt; StaticCanvas r
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#staticCanvas"><span class="hs-identifier hs-var hs-var">staticCanvas</span></a></span></span><span> </span><span id="local-6989586621679253442"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253442"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679253443"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253443"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679253444"><span class="annot"><span class="annottext">v :: Vector 2 Int
</span><a href="#local-6989586621679253444"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Vector 2 Int
forall r. r -&gt; r -&gt; Vector 2 r
</span><span class="hs-identifier hs-var">Vector2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253442"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253443"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-83"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Viewport r -&gt; Vector 2 Int -&gt; StaticCanvas r
forall r. Viewport r -&gt; Vector 2 Int -&gt; StaticCanvas r
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#Canvas"><span class="hs-identifier hs-var">Canvas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector 2 r -&gt; Viewport r
forall r vector.
(Num r, Vector_ vector 2 r) =&gt;
vector -&gt; Viewport r
</span><span class="hs-identifier hs-var">flipY</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; r
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; r) -&gt; Vector 2 Int -&gt; Vector 2 r
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector 2 Int
</span><a href="#local-6989586621679253444"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector 2 Int
</span><a href="#local-6989586621679253444"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- * The Controller</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-90"></span><span class="annot"><span class="hs-comment">-- * The View</span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><span class="hs-comment">-- | Types for which we can convert into a Svg coordinate.</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">type</span><span> </span><span id="ToSvgCoordinate"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#ToSvgCoordinate"><span class="hs-identifier hs-var">ToSvgCoordinate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#ToMisoString"><span class="hs-identifier hs-type">ToMisoString</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><span class="hs-comment">-- | Draws the actual canvas</span></span><span>
</span><span id="line-97"></span><span id="local-6989586621679253302"><span id="local-6989586621679253304"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#staticCanvas_"><span class="hs-identifier hs-type">staticCanvas_</span></a></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621679253302"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#ToSvgCoordinate"><span class="hs-identifier hs-type">ToSvgCoordinate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253302"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>                            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#StaticCanvas"><span class="hs-identifier hs-type">StaticCanvas</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253302"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-99"></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Types.html/Miso.Html.Types.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253304"><span class="hs-identifier hs-type">action</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Types.html/Miso.Html.Types.html#View"><span class="hs-identifier hs-type">View</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253304"><span class="hs-identifier hs-type">action</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Types.html/Miso.Html.Types.html#View"><span class="hs-identifier hs-type">View</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253304"><span class="hs-identifier hs-type">action</span></a></span></span></span><span>
</span><span id="line-100"></span><span id="staticCanvas_"><span class="annot"><span class="annottext">staticCanvas_ :: forall r action.
(RealFrac r, ToSvgCoordinate r) =&gt;
StaticCanvas r
-&gt; [Attribute action] -&gt; [View action] -&gt; View action
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#staticCanvas_"><span class="hs-identifier hs-var hs-var">staticCanvas_</span></a></span></span><span> </span><span id="local-6989586621679253464"><span class="annot"><span class="annottext">StaticCanvas r
</span><a href="#local-6989586621679253464"><span class="hs-identifier hs-var">canvas</span></a></span></span><span> </span><span id="local-6989586621679253465"><span class="annot"><span class="annottext">[Attribute action]
</span><a href="#local-6989586621679253465"><span class="hs-identifier hs-var">ats</span></a></span></span><span> </span><span id="local-6989586621679253466"><span class="annot"><span class="annottext">[View action]
</span><a href="#local-6989586621679253466"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">[Attribute action] -&gt; [View action] -&gt; View action
forall action. [Attribute action] -&gt; [View action] -&gt; View action
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Svg.Element.html/Miso.Svg.Element.html#svg_"><span class="hs-identifier hs-var">svg_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MisoString -&gt; Attribute action
forall action. MisoString -&gt; Attribute action
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Property.html/Miso.Html.Property.html#width_"><span class="hs-identifier hs-var">width_</span></a></span><span>   </span><span class="annot"><span class="annottext">(MisoString -&gt; Attribute action)
-&gt; (Int -&gt; MisoString) -&gt; Int -&gt; Attribute action
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; MisoString
forall str. ToMisoString str =&gt; str -&gt; MisoString
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#ms"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Attribute action) -&gt; Int -&gt; Attribute action
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253468"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-102"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MisoString -&gt; Attribute action
forall action. MisoString -&gt; Attribute action
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Html.Property.html/Miso.Html.Property.html#height_"><span class="hs-identifier hs-var">height_</span></a></span><span>  </span><span class="annot"><span class="annottext">(MisoString -&gt; Attribute action)
-&gt; (Int -&gt; MisoString) -&gt; Int -&gt; Attribute action
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; MisoString
forall str. ToMisoString str =&gt; str -&gt; MisoString
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#ms"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Attribute action) -&gt; Int -&gt; Attribute action
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253469"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-103"></span><span>            </span><span class="hs-comment">-- , viewBox_      $ outerVB</span><span>
</span><span id="line-104"></span><span>          </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Attribute action] -&gt; [Attribute action] -&gt; [Attribute action]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Attribute action]
</span><a href="#local-6989586621679253465"><span class="hs-identifier hs-var">ats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Attribute action] -&gt; [View action] -&gt; View action
forall action. [Attribute action] -&gt; [View action] -&gt; View action
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Svg.Element.html/Miso.Svg.Element.html#g_"><span class="hs-identifier hs-var">g_</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">MisoString -&gt; Attribute action
forall action. MisoString -&gt; Attribute action
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.Svg.Attribute.html/Miso.Svg.Attribute.html#transform_"><span class="hs-identifier hs-var">transform_</span></a></span><span> </span><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253470"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[View action]
</span><a href="#local-6989586621679253466"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-106"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector2</span></span><span> </span><span id="local-6989586621679253468"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253468"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679253469"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253469"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StaticCanvas r
</span><a href="#local-6989586621679253464"><span class="hs-identifier hs-var">canvas</span></a></span><span class="annot"><span class="annottext">StaticCanvas r
-&gt; Getting (Vector 2 Int) (StaticCanvas r) (Vector 2 Int)
-&gt; Vector 2 Int
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting (Vector 2 Int) (StaticCanvas r) (Vector 2 Int)
forall s a. HasDimensions s a =&gt; Lens' s a
Lens' (StaticCanvas r) (Vector 2 Int)
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#dimensions"><span class="hs-identifier hs-var">dimensions</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679253470"><span class="annot"><span class="annottext">ts :: MisoString
</span><a href="#local-6989586621679253470"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix 3 3 r -&gt; MisoString
forall r. ToSvgCoordinate r =&gt; Matrix 3 3 r -&gt; MisoString
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#matrixToMisoString"><span class="hs-identifier hs-var">matrixToMisoString</span></a></span><span> </span><span class="annot"><span class="annottext">(Matrix 3 3 r -&gt; MisoString) -&gt; Matrix 3 3 r -&gt; MisoString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StaticCanvas r
</span><a href="#local-6989586621679253464"><span class="hs-identifier hs-var">canvas</span></a></span><span class="annot"><span class="annottext">StaticCanvas r
-&gt; Getting (Matrix 3 3 r) (StaticCanvas r) (Matrix 3 3 r)
-&gt; Matrix 3 3 r
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">(Viewport r -&gt; Const (Matrix 3 3 r) (Viewport r))
-&gt; StaticCanvas r -&gt; Const (Matrix 3 3 r) (StaticCanvas r)
forall r s (f :: * -&gt; *).
Functor f =&gt;
(Viewport r -&gt; f (Viewport s))
-&gt; StaticCanvas r -&gt; f (StaticCanvas s)
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#theViewport"><span class="hs-identifier hs-var">theViewport</span></a></span><span class="annot"><span class="annottext">((Viewport r -&gt; Const (Matrix 3 3 r) (Viewport r))
 -&gt; StaticCanvas r -&gt; Const (Matrix 3 3 r) (StaticCanvas r))
-&gt; ((Matrix 3 3 r -&gt; Const (Matrix 3 3 r) (Matrix 3 3 r))
    -&gt; Viewport r -&gt; Const (Matrix 3 3 r) (Viewport r))
-&gt; Getting (Matrix 3 3 r) (StaticCanvas r) (Matrix 3 3 r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Transformation 2 r -&gt; Const (Matrix 3 3 r) (Transformation 2 r))
-&gt; Viewport r -&gt; Const (Matrix 3 3 r) (Viewport r)
forall r (f :: * -&gt; *).
Functor f =&gt;
(Transformation 2 r -&gt; f (Transformation 2 r))
-&gt; Viewport r -&gt; f (Viewport r)
</span><span class="hs-identifier hs-var">worldToHost</span></span><span class="annot"><span class="annottext">((Transformation 2 r -&gt; Const (Matrix 3 3 r) (Transformation 2 r))
 -&gt; Viewport r -&gt; Const (Matrix 3 3 r) (Viewport r))
-&gt; ((Matrix 3 3 r -&gt; Const (Matrix 3 3 r) (Matrix 3 3 r))
    -&gt; Transformation 2 r -&gt; Const (Matrix 3 3 r) (Transformation 2 r))
-&gt; (Matrix 3 3 r -&gt; Const (Matrix 3 3 r) (Matrix 3 3 r))
-&gt; Viewport r
-&gt; Const (Matrix 3 3 r) (Viewport r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">(Matrix 3 3 r -&gt; Const (Matrix 3 3 r) (Matrix 3 3 r))
-&gt; Transformation 2 r -&gt; Const (Matrix 3 3 r) (Transformation 2 r)
(Matrix (2 + 1) (2 + 1) r
 -&gt; Const (Matrix 3 3 r) (Matrix (2 + 1) (2 + 1) r))
-&gt; Transformation 2 r -&gt; Const (Matrix 3 3 r) (Transformation 2 r)
forall (d :: Nat) r s (p :: * -&gt; * -&gt; *) (f :: * -&gt; *).
(Profunctor p, Functor f) =&gt;
p (Matrix (d + 1) (d + 1) r) (f (Matrix (d + 1) (d + 1) s))
-&gt; p (Transformation d r) (f (Transformation d s))
</span><span class="hs-identifier hs-var">transformationMatrix</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">-- | Renders a matrix as a MisoString</span></span><span>
</span><span id="line-112"></span><span id="local-6989586621679253330"><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#matrixToMisoString"><span class="hs-identifier hs-type">matrixToMisoString</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HGeometry.Miso.Svg.StaticCanvas.html#ToSvgCoordinate"><span class="hs-identifier hs-type">ToSvgCoordinate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253330"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="#local-6989586621679253330"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#MisoString"><span class="hs-identifier hs-type">MisoString</span></a></span></span><span>
</span><span id="line-113"></span><span id="matrixToMisoString"><span class="annot"><span class="annottext">matrixToMisoString :: forall r. ToSvgCoordinate r =&gt; Matrix 3 3 r -&gt; MisoString
</span><a href="HGeometry.Miso.Svg.StaticCanvas.html#matrixToMisoString"><span class="hs-identifier hs-var hs-var">matrixToMisoString</span></a></span></span><span> </span><span id="local-6989586621679253504"><span class="annot"><span class="annottext">Matrix 3 3 r
</span><a href="#local-6989586621679253504"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MisoString
</span><span class="hs-string">&quot;matrix(&quot;</span></span><span> </span><span class="annot"><span class="annottext">MisoString -&gt; MisoString -&gt; MisoString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[MisoString] -&gt; MisoString
</span><a href="Miso.String.Util.html#unwords"><span class="hs-identifier hs-var">MisoString.unwords</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253506"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253507"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253508"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253509"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253510"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253511"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">MisoString -&gt; MisoString -&gt; MisoString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MisoString
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector3</span></span><span> </span><span id="local-6989586621679253506"><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253506"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679253507"><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253507"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679253508"><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253508"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Vector3</span></span><span> </span><span id="local-6989586621679253510"><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253510"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679253509"><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253509"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679253511"><span class="annot"><span class="annottext">MisoString
</span><a href="#local-6989586621679253511"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>             </span><span class="annot"><span class="annottext">Vector 3 MisoString
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix 3 3 r
</span><a href="#local-6989586621679253504"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">Matrix 3 3 r
-&gt; (Matrix 3 3 r -&gt; Matrix 3 3 MisoString) -&gt; Matrix 3 3 MisoString
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span class="annot"><span class="annottext">(r -&gt; Identity MisoString)
-&gt; Matrix 3 3 r -&gt; Identity (Matrix 3 3 MisoString)
(NumType (Matrix 3 3 r)
 -&gt; Identity (NumType (Matrix 3 3 MisoString)))
-&gt; Matrix 3 3 r -&gt; Identity (Matrix 3 3 MisoString)
forall matrix matrix'.
HasElements matrix matrix' =&gt;
IndexedTraversal1
  (Int, Int) matrix matrix' (NumType matrix) (NumType matrix')
IndexedTraversal1
  (Int, Int)
  (Matrix 3 3 r)
  (Matrix 3 3 MisoString)
  (NumType (Matrix 3 3 r))
  (NumType (Matrix 3 3 MisoString))
</span><span class="hs-identifier hs-var">elements</span></span><span> </span><span class="annot"><span class="annottext">((r -&gt; Identity MisoString)
 -&gt; Matrix 3 3 r -&gt; Identity (Matrix 3 3 MisoString))
-&gt; (r -&gt; MisoString) -&gt; Matrix 3 3 r -&gt; Matrix 3 3 MisoString
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Setter.html/Control.Lens.Setter.html#%25~"><span class="hs-operator hs-var">%~</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; MisoString
forall str. ToMisoString str =&gt; str -&gt; MisoString
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#ms"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Matrix</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/miso-1.8.7.0-a3858eacf7eb2cc3e558ea7deda0a35649e5a23a3f1057fedb829f3a4a1b1124/share/doc/html/src/Miso.String.html/Miso.String.html#MisoString"><span class="hs-identifier hs-type">MisoString</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Matrix 3 3 MisoString
-&gt; Getting
     (Vector 3 (Vector 3 MisoString))
     (Matrix 3 3 MisoString)
     (Vector 3 (Vector 3 MisoString))
-&gt; Vector 3 (Vector 3 MisoString)
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///home/runner/.cabal/store/ghc-9.10.1-69c3/lens-5.3.4-c8eddd7fe276d1ed0463318676323ee32ff6011e688fc492e49b427c85e39e9d/share/doc/html/src/Control.Lens.Getter.html/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span class="annot"><span class="annottext">Getting
  (Vector 3 (Vector 3 MisoString))
  (Matrix 3 3 MisoString)
  (Vector 3 (Vector 3 MisoString))
forall matrix (n :: Nat) (m :: Nat) r.
Matrix_ matrix n m r =&gt;
Lens' matrix (Vector n (Vector m r))
Lens' (Matrix 3 3 MisoString) (Vector 3 (Vector 3 MisoString))
</span><span class="hs-identifier hs-var">rows</span></span><span>
</span><span id="line-118"></span><span>                              </span><span class="hs-comment">-- this last vector has to be 0 0 1</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-comment">-- | To be used instead of the text_ combinator in Miso</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- textAt                     :: ToSvgCoordinate r</span><span>
</span><span id="line-125"></span><span class="hs-comment">--                            =&gt; Point 2 r -- ^ position where to draw (in world coordinates)</span><span>
</span><span id="line-126"></span><span class="hs-comment">--                            -&gt; [Attribute action]</span><span>
</span><span id="line-127"></span><span class="hs-comment">--                            -&gt; MisoString -&gt; View action</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- textAt (Point2 x y) ats t = g_ [ transform_ $ mconcat [ &quot;translate(&quot;</span><span>
</span><span id="line-129"></span><span class="hs-comment">--                                                        , ms x</span><span>
</span><span id="line-130"></span><span class="hs-comment">--                                                        , &quot;, &quot;</span><span>
</span><span id="line-131"></span><span class="hs-comment">--                                                        , ms y</span><span>
</span><span id="line-132"></span><span class="hs-comment">--                                                        , &quot;)scale(1,-1)&quot;</span><span>
</span><span id="line-133"></span><span class="hs-comment">--                                                        ]</span><span>
</span><span id="line-134"></span><span class="hs-comment">--                                 ] [ Miso.text_ ats [text t] ]</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- class RenderWebSvg t where</span><span>
</span><span id="line-139"></span><span class="hs-comment">--   renderWith :: t -&gt; [Attribute action] -&gt; [View action] -&gt; View action</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- render       :: RenderWebSvg t =&gt; t -&gt; [Attribute action] -&gt; View action</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- render x ats = renderWith x ats []</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- instance ToSvgCoordinate r =&gt; RenderWebSvg (Point 2 r) where</span><span>
</span><span id="line-145"></span><span class="hs-comment">--   renderWith (Point2 x y) ats = ellipse_ $ [ cx_ $ ms x, cy_ $ ms y</span><span>
</span><span id="line-146"></span><span class="hs-comment">--                                            , rx_ &quot;5&quot;, ry_ &quot;5&quot;</span><span>
</span><span id="line-147"></span><span class="hs-comment">--                                            , fill_ &quot;black&quot;</span><span>
</span><span id="line-148"></span><span class="hs-comment">--                                            ] &lt;&gt; ats</span><span>
</span><span id="line-149"></span></pre></body></html>