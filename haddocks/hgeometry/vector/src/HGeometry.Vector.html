<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      :  HGeometry.Vector</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  (C) Frank Staals</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  see the LICENSE file</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  Frank Staals</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- D-dimensional Vectors</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-14"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="HGeometry.Vector.html"><span class="hs-identifier">HGeometry.Vector</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier">Vector</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.Type.html#HasComponents"><span class="hs-identifier">HasComponents</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span>  </span><span class="annot"><a href="HGeometry.Vector.Class.html"><span class="hs-identifier">HGeometry.Vector.Class</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.html#isScalarMultipleOf"><span class="hs-identifier">isScalarMultipleOf</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.html#scalarMultiple"><span class="hs-identifier">scalarMultiple</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.html#sameDirection"><span class="hs-identifier">sameDirection</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Special vector operations</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.Type.html#cross"><span class="hs-identifier">cross</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">natVal</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.html"><span class="hs-identifier">Data.Vector.Generic</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GV</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.html"><span class="hs-identifier">Data.Vector.Generic.Mutable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#MVector"><span class="hs-identifier">MVector</span></a></span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicInitialize"><span class="hs-identifier">basicInitialize</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.html"><span class="hs-identifier">Data.Vector.Generic.Mutable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GMV</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.html"><span class="hs-identifier">Data.Vector.Unboxed</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UV</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Mutable.html"><span class="hs-identifier">Data.Vector.Unboxed.Mutable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UMV</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Vector.Class.html"><span class="hs-identifier">HGeometry.Vector.Class</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HGeometry.Vector.Type.html"><span class="hs-identifier">HGeometry.Vector.Type</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | Given two colinar vectors, u and v, test if they point in the same direction, i.e.</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- iff scalarMultiple' u v == Just lambda, with lambda &gt; 0</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- pre: u and v are colinear, u and v are non-zero</span><span>
</span><span id="line-43"></span><span id="local-6989586621679226072"><span id="local-6989586621679226073"><span id="local-6989586621679226074"><span class="annot"><a href="HGeometry.Vector.html#sameDirection"><span class="hs-identifier hs-type">sameDirection</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HGeometry.Vector.Class.html#Additive_"><span class="hs-identifier hs-type">Additive_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226072"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226073"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226074"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-44"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679226074"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679226074"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-45"></span><span>                     </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226072"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226072"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-46"></span><span id="sameDirection"><span class="annot"><span class="annottext">sameDirection :: forall vector (d :: Nat) r.
(Additive_ vector d r, Num r, Eq r) =&gt;
vector -&gt; vector -&gt; Bool
</span><a href="HGeometry.Vector.html#sameDirection"><span class="hs-identifier hs-var hs-var">sameDirection</span></a></span></span><span> </span><span id="local-6989586621679226292"><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226292"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679226293"><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226293"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><span class="hs-identifier hs-var">getAll</span></span><span> </span><span class="annot"><span class="annottext">(All -&gt; Bool) -&gt; All -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; All) -&gt; vector -&gt; vector -&gt; All
forall vector (d :: Nat) r m.
(Additive_ vector d r, Semigroup m) =&gt;
(r -&gt; r -&gt; m) -&gt; vector -&gt; vector -&gt; m
</span><a href="HGeometry.Vector.Class.html#foldMapZip"><span class="hs-identifier hs-var">foldMapZip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679226296"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226296"><span class="hs-identifier hs-var">ux</span></a></span></span><span> </span><span id="local-6989586621679226297"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226297"><span class="hs-identifier hs-var">vx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; All) -&gt; Bool -&gt; All
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226296"><span class="hs-identifier hs-var">ux</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">signum</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226297"><span class="hs-identifier hs-var">vx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226292"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226293"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-47"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="HGeometry.Vector.html#sameDirection"><span class="hs-pragma hs-type">sameDirection</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | 'isScalarmultipleof u v' test if v is a scalar multiple of u.</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector2 1 1 `isScalarMultipleOf` Vector2 10 10</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector3 1 1 2 `isScalarMultipleOf` Vector3 10 10 20</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector2 1 1 `isScalarMultipleOf` Vector2 10 1</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector2 1 1 `isScalarMultipleOf` Vector2 (-1) (-1)</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector2 1 1 `isScalarMultipleOf` Vector2 11.1 11.1</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector2 1 1 `isScalarMultipleOf` Vector2 11.1 11.2</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector2 2 1 `isScalarMultipleOf` Vector2 11.1 11.2</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector2 2 1 `isScalarMultipleOf` Vector2 4 2</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector2 2 1 `isScalarMultipleOf` Vector2 4 0</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector3 2 1 0 `isScalarMultipleOf` Vector3 4 0 5</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- &gt;&gt;&gt; Vector3 0 0 0 `isScalarMultipleOf` Vector3 4 0 5</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-73"></span><span id="local-6989586621679226109"><span id="local-6989586621679226110"><span id="local-6989586621679226111"><span class="annot"><a href="HGeometry.Vector.html#isScalarMultipleOf"><span class="hs-identifier hs-type">isScalarMultipleOf</span></a></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679226109"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679226109"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-74"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.Class.html#Metric_"><span class="hs-identifier hs-type">Metric_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226110"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226111"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226109"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-75"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>                         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226110"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226110"><span class="hs-identifier hs-type">vector</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-77"></span><span id="local-6989586621679226365"><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226365"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="isScalarMultipleOf"><span class="annot"><span class="annottext">isScalarMultipleOf :: forall r vector (d :: Nat).
(Eq r, Num r, Metric_ vector d r) =&gt;
vector -&gt; vector -&gt; Bool
</span><a href="HGeometry.Vector.html#isScalarMultipleOf"><span class="hs-operator hs-var hs-var">`isScalarMultipleOf`</span></a></span></span><span> </span><span id="local-6989586621679226366"><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226366"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226367"><span class="annot"><span class="annottext">d :: r
</span><a href="#local-6989586621679226367"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226365"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">vector -&gt; vector -&gt; r
forall vector (d :: Nat) r.
(Metric_ vector d r, Num r) =&gt;
vector -&gt; vector -&gt; r
</span><a href="HGeometry.Vector.Class.html#dot"><span class="hs-operator hs-var">`dot`</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226366"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-78"></span><span>                               </span><span id="local-6989586621679226369"><span class="annot"><span class="annottext">num :: r
</span><a href="#local-6989586621679226369"><span class="hs-identifier hs-var hs-var">num</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vector -&gt; r
forall vector (d :: Nat) r.
(Metric_ vector d r, Num r) =&gt;
vector -&gt; r
</span><a href="HGeometry.Vector.Class.html#quadrance"><span class="hs-identifier hs-var">quadrance</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226365"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">vector -&gt; r
forall vector (d :: Nat) r.
(Metric_ vector d r, Num r) =&gt;
vector -&gt; r
</span><a href="HGeometry.Vector.Class.html#quadrance"><span class="hs-identifier hs-var">quadrance</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226366"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-79"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226369"><span class="hs-identifier hs-var">num</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226369"><span class="hs-identifier hs-var">num</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226367"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226367"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- u `isScalarMultipleOf` v = isJust $ scalarMultiple u v</span><span>
</span><span id="line-81"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="HGeometry.Vector.html#isScalarMultipleOf"><span class="hs-pragma hs-type">isScalarMultipleOf</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">-- | scalarMultiple u v computes the scalar labmda s.t. v = lambda * u (if it exists)</span></span><span>
</span><span id="line-84"></span><span id="local-6989586621679226119"><span id="local-6989586621679226120"><span id="local-6989586621679226121"><span class="annot"><a href="HGeometry.Vector.html#scalarMultiple"><span class="hs-identifier hs-type">scalarMultiple</span></a></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679226119"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679226119"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.Class.html#Additive_"><span class="hs-identifier hs-type">Additive_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226120"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226121"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226119"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226120"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226120"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679226119"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-86"></span><span id="scalarMultiple"><span class="annot"><span class="annottext">scalarMultiple :: forall r vector (d :: Nat).
(Eq r, Fractional r, Additive_ vector d r) =&gt;
vector -&gt; vector -&gt; Maybe r
</span><a href="HGeometry.Vector.html#scalarMultiple"><span class="hs-identifier hs-var hs-var">scalarMultiple</span></a></span></span><span> </span><span id="local-6989586621679226404"><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226404"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679226405"><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226405"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">vector -&gt; Bool
</span><a href="#local-6989586621679226406"><span class="hs-identifier hs-var">allZero</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226404"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">vector -&gt; Bool
</span><a href="#local-6989586621679226406"><span class="hs-identifier hs-var">allZero</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226405"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; Maybe r
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">vector -&gt; vector -&gt; Maybe r
forall r vector (d :: Nat).
(Eq r, Fractional r, Additive_ vector d r) =&gt;
vector -&gt; vector -&gt; Maybe r
</span><a href="HGeometry.Vector.html#scalarMultiple%27"><span class="hs-identifier hs-var">scalarMultiple'</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226404"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226405"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- allZero :: (Eq r, Num r, Vector_ vector d r) =&gt; vector -&gt; Bool</span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621679226406"><span class="annot"><span class="annottext">allZero :: vector -&gt; Bool
</span><a href="#local-6989586621679226406"><span class="hs-identifier hs-var hs-var">allZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting All vector (IxValue vector)
-&gt; (IxValue vector -&gt; Bool) -&gt; vector -&gt; Bool
forall s a. Getting All s a -&gt; (a -&gt; Bool) -&gt; s -&gt; Bool
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#allOf"><span class="hs-identifier hs-var">allOf</span></a></span><span> </span><span class="annot"><span class="annottext">Getting All vector (IxValue vector)
forall vector vector'.
HasComponents vector vector' =&gt;
IndexedTraversal1
  Int vector vector' (IxValue vector) (IxValue vector')
IndexedTraversal1
  Int vector vector (IxValue vector) (IxValue vector)
</span><a href="HGeometry.Vector.Type.html#components"><span class="hs-identifier hs-var">components</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IxValue vector -&gt; IxValue vector -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IxValue vector
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="HGeometry.Vector.html#scalarMultiple"><span class="hs-pragma hs-type">scalarMultiple</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="annot"><span class="hs-comment">-- | Helper type for implementing scalarMultiple</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="ScalarMultiple"><span class="annot"><a href="HGeometry.Vector.html#ScalarMultiple"><span class="hs-identifier hs-var">ScalarMultiple</span></a></span></span><span> </span><span id="local-6989586621679226151"><span class="annot"><a href="#local-6989586621679226151"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="No"><span class="annot"><a href="HGeometry.Vector.html#No"><span class="hs-identifier hs-var">No</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Maybe"><span class="annot"><a href="HGeometry.Vector.html#Maybe"><span class="hs-identifier hs-var">Maybe</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Yes"><span class="annot"><a href="HGeometry.Vector.html#Yes"><span class="hs-identifier hs-var">Yes</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679226151"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679226423"><span id="local-6989586621679226429"><span class="annot"><span class="annottext">ScalarMultiple r -&gt; ScalarMultiple r -&gt; Bool
(ScalarMultiple r -&gt; ScalarMultiple r -&gt; Bool)
-&gt; (ScalarMultiple r -&gt; ScalarMultiple r -&gt; Bool)
-&gt; Eq (ScalarMultiple r)
forall r. Eq r =&gt; ScalarMultiple r -&gt; ScalarMultiple r -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall r. Eq r =&gt; ScalarMultiple r -&gt; ScalarMultiple r -&gt; Bool
== :: ScalarMultiple r -&gt; ScalarMultiple r -&gt; Bool
$c/= :: forall r. Eq r =&gt; ScalarMultiple r -&gt; ScalarMultiple r -&gt; Bool
/= :: ScalarMultiple r -&gt; ScalarMultiple r -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679226435"><span id="local-6989586621679226440"><span id="local-6989586621679226444"><span class="annot"><span class="annottext">Int -&gt; ScalarMultiple r -&gt; ShowS
[ScalarMultiple r] -&gt; ShowS
ScalarMultiple r -&gt; String
(Int -&gt; ScalarMultiple r -&gt; ShowS)
-&gt; (ScalarMultiple r -&gt; String)
-&gt; ([ScalarMultiple r] -&gt; ShowS)
-&gt; Show (ScalarMultiple r)
forall r. Show r =&gt; Int -&gt; ScalarMultiple r -&gt; ShowS
forall r. Show r =&gt; [ScalarMultiple r] -&gt; ShowS
forall r. Show r =&gt; ScalarMultiple r -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall r. Show r =&gt; Int -&gt; ScalarMultiple r -&gt; ShowS
showsPrec :: Int -&gt; ScalarMultiple r -&gt; ShowS
$cshow :: forall r. Show r =&gt; ScalarMultiple r -&gt; String
show :: ScalarMultiple r -&gt; String
$cshowList :: forall r. Show r =&gt; [ScalarMultiple r] -&gt; ShowS
showList :: [ScalarMultiple r] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679226150"><span id="local-6989586621679226451"><span id="local-6989586621679226455"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679226150"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#ScalarMultiple"><span class="hs-identifier hs-type">ScalarMultiple</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226150"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="annottext">ScalarMultiple r
</span><a href="HGeometry.Vector.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>      </span><span id="local-6989586621679226461"><span class="annot"><span class="annottext">&lt;&gt; :: ScalarMultiple r -&gt; ScalarMultiple r -&gt; ScalarMultiple r
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
forall r. ScalarMultiple r
</span><a href="HGeometry.Vector.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">ScalarMultiple r
</span><span class="hs-identifier">_</span></span><span>       </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
</span><a href="HGeometry.Vector.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
forall r. ScalarMultiple r
</span><a href="HGeometry.Vector.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="annottext">ScalarMultiple r
</span><a href="HGeometry.Vector.html#Maybe"><span class="hs-identifier hs-var">Maybe</span></a></span><span>   </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679226462"><span class="annot"><span class="annottext">ScalarMultiple r
</span><a href="#local-6989586621679226462"><span class="hs-identifier hs-var">x</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
</span><a href="#local-6989586621679226462"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679226463"><span class="annot"><span class="annottext">ScalarMultiple r
</span><a href="#local-6989586621679226463"><span class="hs-identifier hs-var">x</span></a></span></span><span>       </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
</span><a href="HGeometry.Vector.html#Maybe"><span class="hs-identifier hs-var">Maybe</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
</span><a href="#local-6989586621679226463"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#Yes"><span class="hs-identifier hs-type">Yes</span></a></span><span> </span><span id="local-6989586621679226464"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226464"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#Yes"><span class="hs-identifier hs-type">Yes</span></a></span><span> </span><span id="local-6989586621679226465"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226465"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226464"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226465"><span class="hs-identifier hs-var">y</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; ScalarMultiple r
forall r. r -&gt; ScalarMultiple r
</span><a href="HGeometry.Vector.html#Yes"><span class="hs-identifier hs-var">Yes</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226464"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-104"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
forall r. ScalarMultiple r
</span><a href="HGeometry.Vector.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679226154"><span id="local-6989586621679226472"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679226154"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#ScalarMultiple"><span class="hs-identifier hs-type">ScalarMultiple</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226154"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679226476"><span class="annot"><span class="annottext">mempty :: ScalarMultiple r
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
forall r. ScalarMultiple r
</span><a href="HGeometry.Vector.html#Maybe"><span class="hs-identifier hs-var">Maybe</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679226478"><span class="annot"><span class="annottext">mappend :: ScalarMultiple r -&gt; ScalarMultiple r -&gt; ScalarMultiple r
</span><span class="hs-identifier hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r -&gt; ScalarMultiple r -&gt; ScalarMultiple r
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">-- | Actual implementation of scalarMultiple</span></span><span>
</span><span id="line-112"></span><span id="local-6989586621679226479"><span id="local-6989586621679226480"><span id="local-6989586621679226481"><span class="annot"><a href="HGeometry.Vector.html#scalarMultiple%27"><span class="hs-identifier hs-type">scalarMultiple'</span></a></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679226479"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fractional</span></span><span> </span><span class="annot"><a href="#local-6989586621679226479"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.Class.html#Additive_"><span class="hs-identifier hs-type">Additive_</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226480"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226481"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226479"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226480"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679226480"><span class="hs-identifier hs-type">vector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679226479"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-114"></span><span id="scalarMultiple%27"><span class="annot"><span class="annottext">scalarMultiple' :: forall r vector (d :: Nat).
(Eq r, Fractional r, Additive_ vector d r) =&gt;
vector -&gt; vector -&gt; Maybe r
</span><a href="HGeometry.Vector.html#scalarMultiple%27"><span class="hs-identifier hs-var hs-var">scalarMultiple'</span></a></span></span><span> </span><span id="local-6989586621679226511"><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226511"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679226512"><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226512"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r -&gt; Maybe r
forall {a}. ScalarMultiple a -&gt; Maybe a
</span><a href="#local-6989586621679226513"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">(ScalarMultiple r -&gt; Maybe r) -&gt; ScalarMultiple r -&gt; Maybe r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(r -&gt; r -&gt; ScalarMultiple r)
-&gt; vector -&gt; vector -&gt; ScalarMultiple r
forall vector (d :: Nat) r m.
(Additive_ vector d r, Semigroup m) =&gt;
(r -&gt; r -&gt; m) -&gt; vector -&gt; vector -&gt; m
</span><a href="HGeometry.Vector.Class.html#foldMapZip"><span class="hs-identifier hs-var">foldMapZip</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; ScalarMultiple r
forall {r}. (Eq r, Fractional r) =&gt; r -&gt; r -&gt; ScalarMultiple r
</span><a href="#local-6989586621679226514"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226511"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">vector
</span><a href="#local-6989586621679226512"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679226514"><span class="annot"><span class="annottext">f :: r -&gt; r -&gt; ScalarMultiple r
</span><a href="#local-6989586621679226514"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
forall r. ScalarMultiple r
</span><a href="HGeometry.Vector.html#Maybe"><span class="hs-identifier hs-var">Maybe</span></a></span><span> </span><span class="hs-comment">-- we don't know lambda yet, but it may still be a scalar mult.</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="#local-6989586621679226514"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">r
</span><span class="hs-number">0</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScalarMultiple r
forall r. ScalarMultiple r
</span><a href="HGeometry.Vector.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>      </span><span class="hs-comment">-- Not a scalar multiple</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><a href="#local-6989586621679226514"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span id="local-6989586621679226526"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226526"><span class="hs-identifier hs-var">ui</span></a></span></span><span> </span><span id="local-6989586621679226527"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226527"><span class="hs-identifier hs-var">vi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r -&gt; ScalarMultiple r
forall r. r -&gt; ScalarMultiple r
</span><a href="HGeometry.Vector.html#Yes"><span class="hs-identifier hs-var">Yes</span></a></span><span> </span><span class="annot"><span class="annottext">(r -&gt; ScalarMultiple r) -&gt; r -&gt; ScalarMultiple r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226526"><span class="hs-identifier hs-var">ui</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226527"><span class="hs-identifier hs-var">vi</span></a></span><span> </span><span class="hs-comment">-- can still be a scalar multiple</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679226513"><span class="annot"><span class="annottext">g :: ScalarMultiple a -&gt; Maybe a
</span><a href="#local-6989586621679226513"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="annot"><span class="annottext">ScalarMultiple a
</span><a href="HGeometry.Vector.html#No"><span class="hs-identifier hs-var">No</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="#local-6989586621679226513"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarMultiple a
</span><a href="HGeometry.Vector.html#Maybe"><span class="hs-identifier hs-var">Maybe</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scalarMultiple': found a Maybe, which means the vectors either have length zero, or one of them is all Zero!&quot;</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="#local-6989586621679226513"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#Yes"><span class="hs-identifier hs-type">Yes</span></a></span><span> </span><span id="local-6989586621679226532"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679226532"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679226532"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-126"></span><span class="annot"><span class="hs-comment">-- * unboxed vectors</span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="annot"><span class="hs-comment">-- | elements of the vector are stored consecutively</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="MVector"><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#MVector"><span class="hs-identifier hs-var">UMV.MVector</span></a></span></span><span> </span><span id="local-6989586621679226197"><span id="local-6989586621679226198"><span id="local-6989586621679226199"><span class="annot"><a href="#local-6989586621679226197"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226199"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226198"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MV_VectorD"><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-var">MV_VectorD</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#MVector"><span class="hs-identifier hs-type">UMV.MVector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226197"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226198"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Vector"><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#Vector"><span class="hs-identifier hs-var">UV.Vector</span></a></span></span><span>     </span><span id="local-6989586621679226239"><span id="local-6989586621679226240"><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226240"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226239"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="V_VectorD"><span class="annot"><a href="HGeometry.Vector.html#V_VectorD"><span class="hs-identifier hs-var">V_VectorD</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#Vector"><span class="hs-identifier hs-type">UV.Vector</span></a></span><span>     </span><span class="annot"><a href="#local-6989586621679226239"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><span class="hs-comment">-- | get the dimension as an Int</span></span><span>
</span><span id="line-133"></span><span class="annot"><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-type">natVal'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679226163"><span class="annot"><a href="#local-6989586621679226163"><span class="hs-identifier hs-type">d</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679226163"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-134"></span><span id="natVal%27"><span class="annot"><span class="annottext">natVal' :: forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var hs-var">natVal'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; Int) -&gt; Nat -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy d -&gt; Nat
forall (n :: Nat) (proxy :: Nat -&gt; *). KnownNat n =&gt; proxy n -&gt; Nat
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: Nat). Proxy t
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226163"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679226191"><span id="local-6989586621679226192"><span id="local-6989586621679226551"><span id="local-6989586621679226557"><span id="local-6989586621679226560"><span id="local-6989586621679226563"><span id="local-6989586621679226566"><span id="local-6989586621679226569"><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#MVector"><span class="hs-identifier hs-type">GMV.MVector</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#MVector"><span class="hs-identifier hs-type">UMV.MVector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226191"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-137"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.Class.html#Vector_"><span class="hs-identifier hs-type">Vector_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226192"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226191"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679226192"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226191"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-138"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#MVector"><span class="hs-identifier hs-type">GMV.MVector</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#MVector"><span class="hs-identifier hs-type">UMV.MVector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226192"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226191"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621679226579"><span class="annot"><span class="annottext">basicLength :: forall s. MVector s (Vector d r) -&gt; Int
</span><a href="#local-6989586621679226579"><span class="hs-identifier hs-var hs-var hs-var">basicLength</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-type">MV_VectorD</span></a></span><span> </span><span id="local-6989586621679226581"><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226581"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226582"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679226582"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var">natVal'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226192"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-141"></span><span>                               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">MVector s r -&gt; Int
forall s. MVector s r -&gt; Int
forall (v :: * -&gt; * -&gt; *) a s. MVector v a =&gt; v s a -&gt; Int
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicLength"><span class="hs-identifier hs-var">GMV.basicLength</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226581"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226582"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicLength"><span class="hs-pragma hs-type">basicLength</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679226588"><span class="annot"><span class="annottext">basicUnsafeSlice :: forall s.
Int -&gt; Int -&gt; MVector s (Vector d r) -&gt; MVector s (Vector d r)
</span><a href="#local-6989586621679226588"><span class="hs-identifier hs-var hs-var hs-var">basicUnsafeSlice</span></a></span></span><span> </span><span id="local-6989586621679226590"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226590"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679226591"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226591"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-type">MV_VectorD</span></a></span><span> </span><span id="local-6989586621679226592"><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226592"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226593"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679226593"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var">natVal'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226192"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-144"></span><span>                                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">MVector s r -&gt; MVector s (Vector d r)
forall s (d :: Nat) r. MVector s r -&gt; MVector s (Vector d r)
</span><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-var">MV_VectorD</span></a></span><span> </span><span class="annot"><span class="annottext">(MVector s r -&gt; MVector s (Vector d r))
-&gt; MVector s r -&gt; MVector s (Vector d r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; MVector s r -&gt; MVector s r
forall s. Int -&gt; Int -&gt; MVector s r -&gt; MVector s r
forall (v :: * -&gt; * -&gt; *) a s.
MVector v a =&gt;
Int -&gt; Int -&gt; v s a -&gt; v s a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicUnsafeSlice"><span class="hs-identifier hs-var">GMV.basicUnsafeSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226593"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226590"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226593"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226591"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226592"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicUnsafeSlice"><span class="hs-pragma hs-type">basicUnsafeSlice</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679226595"><span class="annot"><span class="annottext">basicOverlaps :: forall s. MVector s (Vector d r) -&gt; MVector s (Vector d r) -&gt; Bool
</span><a href="#local-6989586621679226595"><span class="hs-identifier hs-var hs-var hs-var">basicOverlaps</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-type">MV_VectorD</span></a></span><span> </span><span id="local-6989586621679226597"><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226597"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-type">MV_VectorD</span></a></span><span> </span><span id="local-6989586621679226598"><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226598"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector s r -&gt; MVector s r -&gt; Bool
forall s. MVector s r -&gt; MVector s r -&gt; Bool
forall (v :: * -&gt; * -&gt; *) a s.
MVector v a =&gt;
v s a -&gt; v s a -&gt; Bool
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicOverlaps"><span class="hs-identifier hs-var">GMV.basicOverlaps</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226597"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226598"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicOverlaps"><span class="hs-pragma hs-type">basicOverlaps</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679226604"><span class="annot"><span class="annottext">basicUnsafeNew :: forall s. Int -&gt; ST s (MVector s (Vector d r))
</span><a href="#local-6989586621679226604"><span class="hs-identifier hs-var hs-var hs-var">basicUnsafeNew</span></a></span></span><span> </span><span id="local-6989586621679226606"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226606"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226607"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679226607"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var">natVal'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226192"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-149"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">MVector s r -&gt; MVector s (Vector d r)
forall s (d :: Nat) r. MVector s r -&gt; MVector s (Vector d r)
</span><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-var">MV_VectorD</span></a></span><span> </span><span class="annot"><span class="annottext">(MVector s r -&gt; MVector s (Vector d r))
-&gt; ST s (MVector s r) -&gt; ST s (MVector s (Vector d r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (MVector s r)
forall s. Int -&gt; ST s (MVector s r)
forall (v :: * -&gt; * -&gt; *) a s. MVector v a =&gt; Int -&gt; ST s (v s a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicUnsafeNew"><span class="hs-identifier hs-var">GMV.basicUnsafeNew</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226607"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226606"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicUnsafeNew"><span class="hs-pragma hs-type">basicUnsafeNew</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679226610"><span class="annot"><span class="annottext">basicInitialize :: forall s. MVector s (Vector d r) -&gt; ST s ()
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicInitialize"><span class="hs-identifier hs-var hs-var hs-var">basicInitialize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-type">MV_VectorD</span></a></span><span> </span><span id="local-6989586621679226611"><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226611"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector s r -&gt; ST s ()
forall s. MVector s r -&gt; ST s ()
forall (v :: * -&gt; * -&gt; *) a s. MVector v a =&gt; v s a -&gt; ST s ()
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicInitialize"><span class="hs-identifier hs-var">GMV.basicInitialize</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226611"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicInitialize"><span class="hs-pragma hs-type">basicInitialize</span></a></span><span class="hs-pragma">#-}</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679226630"><span class="annot"><span class="annottext">basicUnsafeRead :: forall s. MVector s (Vector d r) -&gt; Int -&gt; ST s (Vector d r)
</span><a href="#local-6989586621679226630"><span class="hs-identifier hs-var hs-var hs-var">basicUnsafeRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-type">MV_VectorD</span></a></span><span> </span><span id="local-6989586621679226632"><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226632"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679226633"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226633"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226634"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679226634"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var">natVal'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226192"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-154"></span><span>                                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ST s r) -&gt; ST s (Vector d r)
forall vector (d :: Nat) r (f :: * -&gt; *).
(Vector_ vector d r, Applicative f) =&gt;
(Int -&gt; f r) -&gt; f vector
forall (f :: * -&gt; *).
Applicative f =&gt;
(Int -&gt; f r) -&gt; f (Vector d r)
</span><a href="HGeometry.Vector.Class.html#generateA"><span class="hs-identifier hs-var">generateA</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; ST s r) -&gt; ST s (Vector d r))
-&gt; (Int -&gt; ST s r) -&gt; ST s (Vector d r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679226636"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226636"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MVector s r -&gt; Int -&gt; ST s r
forall s. MVector s r -&gt; Int -&gt; ST s r
forall (v :: * -&gt; * -&gt; *) a s.
MVector v a =&gt;
v s a -&gt; Int -&gt; ST s a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicUnsafeRead"><span class="hs-identifier hs-var">GMV.basicUnsafeRead</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226632"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226634"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226633"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226636"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicUnsafeRead"><span class="hs-pragma hs-type">basicUnsafeRead</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679226651"><span class="annot"><span class="annottext">basicUnsafeWrite :: forall s. MVector s (Vector d r) -&gt; Int -&gt; Vector d r -&gt; ST s ()
</span><a href="#local-6989586621679226651"><span class="hs-identifier hs-var hs-var hs-var">basicUnsafeWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-type">MV_VectorD</span></a></span><span> </span><span id="local-6989586621679226653"><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226653"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679226654"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226654"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679226655"><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679226655"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IndexedGetting Int (Sequenced () (ST s)) (Vector d r) r
-&gt; (Int -&gt; r -&gt; ST s ()) -&gt; Vector d r -&gt; ST s ()
forall (m :: * -&gt; *) i r s a.
Monad m =&gt;
IndexedGetting i (Sequenced r m) s a
-&gt; (i -&gt; a -&gt; m r) -&gt; s -&gt; m ()
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/lens-5.3.5-af8f0435b03c00f06f5d03b52ea927527529d0c03b8a7eee42e07e484fdea6cb/share/doc/html/src/Control.Lens.Fold.html#imapMOf_"><span class="hs-identifier hs-var">imapMOf_</span></a></span><span> </span><span class="annot"><span class="annottext">IndexedGetting Int (Sequenced () (ST s)) (Vector d r) r
Indexed
  Int
  (IxValue (Vector d r))
  (Const (Sequenced () (ST s)) (IxValue (Vector d r)))
-&gt; Vector d r -&gt; Const (Sequenced () (ST s)) (Vector d r)
forall vector vector'.
HasComponents vector vector' =&gt;
IndexedTraversal1
  Int vector vector' (IxValue vector) (IxValue vector')
IndexedTraversal1
  Int
  (Vector d r)
  (Vector d r)
  (IxValue (Vector d r))
  (IxValue (Vector d r))
</span><a href="HGeometry.Vector.Type.html#components"><span class="hs-identifier hs-var">components</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; r -&gt; ST s ()
</span><a href="#local-6989586621679226657"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Vector d r
</span><a href="#local-6989586621679226655"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>      </span><span id="local-6989586621679226657"><span class="annot"><span class="annottext">f :: Int -&gt; r -&gt; ST s ()
</span><a href="#local-6989586621679226657"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679226658"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226658"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621679226659"><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226659"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector s r -&gt; Int -&gt; r -&gt; ST s ()
forall s. MVector s r -&gt; Int -&gt; r -&gt; ST s ()
forall (v :: * -&gt; * -&gt; *) a s.
MVector v a =&gt;
v s a -&gt; Int -&gt; a -&gt; ST s ()
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicUnsafeWrite"><span class="hs-identifier hs-var">GMV.basicUnsafeWrite</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226653"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226660"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226654"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226658"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r
</span><a href="#local-6989586621679226659"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-159"></span><span>      </span><span id="local-6989586621679226660"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679226660"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var">natVal'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226192"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Mutable.Base.html#basicUnsafeWrite"><span class="hs-pragma hs-type">basicUnsafeWrite</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679226236"><span id="local-6989586621679226237"><span id="local-6989586621679226672"><span id="local-6989586621679226676"><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#Vector"><span class="hs-identifier hs-type">GV.Vector</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#Vector"><span class="hs-identifier hs-type">UV.Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226236"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-164"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.Class.html#Vector_"><span class="hs-identifier hs-type">Vector_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226237"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226236"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679226237"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226236"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-165"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#Vector"><span class="hs-identifier hs-type">GV.Vector</span></a></span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#Vector"><span class="hs-identifier hs-type">UV.Vector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226237"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226236"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679226687"><span class="annot"><span class="annottext">basicUnsafeFreeze :: forall s.
Mutable Vector s (Vector d r) -&gt; ST s (Vector (Vector d r))
</span><a href="#local-6989586621679226687"><span class="hs-identifier hs-var hs-var hs-var">basicUnsafeFreeze</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-type">MV_VectorD</span></a></span><span> </span><span id="local-6989586621679226689"><span class="annot"><span class="annottext">MVector s r
</span><a href="#local-6989586621679226689"><span class="hs-identifier hs-var">mv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector r -&gt; Vector (Vector d r)
forall (d :: Nat) r. Vector r -&gt; Vector (Vector d r)
</span><a href="HGeometry.Vector.html#V_VectorD"><span class="hs-identifier hs-var">V_VectorD</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector r -&gt; Vector (Vector d r))
-&gt; ST s (Vector r) -&gt; ST s (Vector (Vector d r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Mutable Vector s r -&gt; ST s (Vector r)
forall s. Mutable Vector s r -&gt; ST s (Vector r)
forall (v :: * -&gt; *) a s. Vector v a =&gt; Mutable v s a -&gt; ST s (v a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicUnsafeFreeze"><span class="hs-identifier hs-var">GV.basicUnsafeFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">MVector s r
Mutable Vector s r
</span><a href="#local-6989586621679226689"><span class="hs-identifier hs-var">mv</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicUnsafeFreeze"><span class="hs-pragma hs-type">basicUnsafeFreeze</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679226692"><span class="annot"><span class="annottext">basicUnsafeThaw :: forall s.
Vector (Vector d r) -&gt; ST s (Mutable Vector s (Vector d r))
</span><a href="#local-6989586621679226692"><span class="hs-identifier hs-var hs-var hs-var">basicUnsafeThaw</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#V_VectorD"><span class="hs-identifier hs-type">V_VectorD</span></a></span><span> </span><span id="local-6989586621679226694"><span class="annot"><span class="annottext">Vector r
</span><a href="#local-6989586621679226694"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MVector s r -&gt; MVector s (Vector d r)
forall s (d :: Nat) r. MVector s r -&gt; MVector s (Vector d r)
</span><a href="HGeometry.Vector.html#MV_VectorD"><span class="hs-identifier hs-var">MV_VectorD</span></a></span><span> </span><span class="annot"><span class="annottext">(MVector s r -&gt; MVector s (Vector d r))
-&gt; ST s (MVector s r) -&gt; ST s (MVector s (Vector d r))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector r -&gt; ST s (Mutable Vector s r)
forall s. Vector r -&gt; ST s (Mutable Vector s r)
forall (v :: * -&gt; *) a s. Vector v a =&gt; v a -&gt; ST s (Mutable v s a)
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicUnsafeThaw"><span class="hs-identifier hs-var">GV.basicUnsafeThaw</span></a></span><span> </span><span class="annot"><span class="annottext">Vector r
</span><a href="#local-6989586621679226694"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicUnsafeThaw"><span class="hs-pragma hs-type">basicUnsafeThaw</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679226698"><span class="annot"><span class="annottext">basicLength :: Vector (Vector d r) -&gt; Int
</span><a href="#local-6989586621679226698"><span class="hs-identifier hs-var hs-var hs-var">basicLength</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#V_VectorD"><span class="hs-identifier hs-type">V_VectorD</span></a></span><span> </span><span id="local-6989586621679226700"><span class="annot"><span class="annottext">Vector r
</span><a href="#local-6989586621679226700"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226701"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679226701"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var">natVal'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226237"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-172"></span><span>                              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Vector r -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicLength"><span class="hs-identifier hs-var">GV.basicLength</span></a></span><span> </span><span class="annot"><span class="annottext">Vector r
</span><a href="#local-6989586621679226700"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226701"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicLength"><span class="hs-pragma hs-type">basicLength</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679226706"><span class="annot"><span class="annottext">basicUnsafeSlice :: Int -&gt; Int -&gt; Vector (Vector d r) -&gt; Vector (Vector d r)
</span><a href="#local-6989586621679226706"><span class="hs-identifier hs-var hs-var hs-var">basicUnsafeSlice</span></a></span></span><span> </span><span id="local-6989586621679226708"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226708"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679226709"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226709"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#V_VectorD"><span class="hs-identifier hs-type">V_VectorD</span></a></span><span> </span><span id="local-6989586621679226710"><span class="annot"><span class="annottext">Vector r
</span><a href="#local-6989586621679226710"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226711"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679226711"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var">natVal'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226237"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-175"></span><span>                                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Vector r -&gt; Vector (Vector d r)
forall (d :: Nat) r. Vector r -&gt; Vector (Vector d r)
</span><a href="HGeometry.Vector.html#V_VectorD"><span class="hs-identifier hs-var">V_VectorD</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector r -&gt; Vector (Vector d r))
-&gt; Vector r -&gt; Vector (Vector d r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Vector r -&gt; Vector r
forall (v :: * -&gt; *) a. Vector v a =&gt; Int -&gt; Int -&gt; v a -&gt; v a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicUnsafeSlice"><span class="hs-identifier hs-var">GV.basicUnsafeSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226711"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226708"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226711"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226709"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector r
</span><a href="#local-6989586621679226710"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicUnsafeSlice"><span class="hs-pragma hs-type">basicUnsafeSlice</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679226730"><span class="annot"><span class="annottext">basicUnsafeIndexM :: Vector (Vector d r) -&gt; Int -&gt; Box (Vector d r)
</span><a href="#local-6989586621679226730"><span class="hs-identifier hs-var hs-var hs-var">basicUnsafeIndexM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.html#V_VectorD"><span class="hs-identifier hs-type">V_VectorD</span></a></span><span> </span><span id="local-6989586621679226732"><span class="annot"><span class="annottext">Vector r
</span><a href="#local-6989586621679226732"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679226733"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226733"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679226734"><span class="annot"><span class="annottext">d :: Int
</span><a href="#local-6989586621679226734"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (d :: Nat). KnownNat d =&gt; Int
</span><a href="HGeometry.Vector.html#natVal%27"><span class="hs-identifier hs-var">natVal'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679226237"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-178"></span><span>                                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Box r) -&gt; Box (Vector d r)
forall vector (d :: Nat) r (f :: * -&gt; *).
(Vector_ vector d r, Applicative f) =&gt;
(Int -&gt; f r) -&gt; f vector
forall (f :: * -&gt; *).
Applicative f =&gt;
(Int -&gt; f r) -&gt; f (Vector d r)
</span><a href="HGeometry.Vector.Class.html#generateA"><span class="hs-identifier hs-var">generateA</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Box r) -&gt; Box (Vector d r))
-&gt; (Int -&gt; Box r) -&gt; Box (Vector d r)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679226735"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226735"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector r -&gt; Int -&gt; Box r
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int -&gt; Box a
</span><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicUnsafeIndexM"><span class="hs-identifier hs-var">GV.basicUnsafeIndexM</span></a></span><span> </span><span class="annot"><span class="annottext">Vector r
</span><a href="#local-6989586621679226732"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226734"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226733"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679226735"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Generic.Base.html#basicUnsafeIndexM"><span class="hs-pragma hs-type">basicUnsafeIndexM</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679226247"><span id="local-6989586621679226248"><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#Unbox"><span class="hs-identifier hs-type">UV.Unbox</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226247"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HGeometry.Vector.Class.html#Vector_"><span class="hs-identifier hs-type">Vector_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226248"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226247"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679226248"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226247"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-182"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/runner/.cabal/store/ghc-9.12.2-9b33/vector-0.13.2.0-b7c31238fc1798a4714f459ca07971b1aa69fb2e072b2ff74eb91ea2dad3dd53/share/doc/html/src/Data.Vector.Unboxed.Base.html#Unbox"><span class="hs-identifier hs-type">UV.Unbox</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HGeometry.Vector.Type.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226248"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679226247"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-186"></span></pre></body></html>