<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf          #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-uni-patterns #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">{-
(c) The University of Glasgow 2006
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998


Pattern-matching literal patterns
-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html"><span class="hs-identifier">GHC.HsToCore.Match.Literal</span></a></span><span>
</span><span id="line-18"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsLit"><span class="hs-identifier">dsLit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsOverLit"><span class="hs-identifier">dsOverLit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier">hsLitKey</span></a></span><span>
</span><span id="line-19"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#tidyLitPat"><span class="hs-identifier">tidyLitPat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#tidyNPat"><span class="hs-identifier">tidyNPat</span></a></span><span>
</span><span id="line-20"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#matchLiterals"><span class="hs-identifier">matchLiterals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#matchNPlusKPats"><span class="hs-identifier">matchNPlusKPats</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#matchNPats"><span class="hs-identifier">matchNPats</span></a></span><span>
</span><span id="line-21"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutIdentities"><span class="hs-identifier">warnAboutIdentities</span></a></span><span>
</span><span id="line-22"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedOverLit"><span class="hs-identifier">warnAboutOverflowedOverLit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedLit"><span class="hs-identifier">warnAboutOverflowedLit</span></a></span><span>
</span><span id="line-23"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutEmptyEnumerations"><span class="hs-identifier">warnAboutEmptyEnumerations</span></a></span><span>
</span><span id="line-24"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html"><span class="hs-identifier">GHC.HsToCore.Match</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#match"><span class="hs-identifier">match</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html"><span class="hs-identifier">GHC.HsToCore.Expr</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier">dsExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier">dsSyntaxExpr</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Errors.Types.html"><span class="hs-identifier">GHC.HsToCore.Errors.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html"><span class="hs-identifier">GHC.HsToCore.Monad</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html"><span class="hs-identifier">GHC.HsToCore.Utils</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Hs.html"><span class="hs-identifier">GHC.Hs</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcMType.html"><span class="hs-identifier">GHC.Tc.Utils.TcMType</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcMType.html#shortCutLit"><span class="hs-identifier">shortCutLit</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html"><span class="hs-identifier">GHC.Tc.Utils.TcType</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Make.html"><span class="hs-identifier">GHC.Core.Make</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Reduction.html"><span class="hs-identifier">GHC.Core.Reduction</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Reduction.html#Reduction"><span class="hs-identifier">Reduction</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html"><span class="hs-identifier">GHC.Core.FamInstEnv</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier">FamInstEnvs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#normaliseType"><span class="hs-identifier">normaliseType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html"><span class="hs-identifier">GHC.Types.SrcLoc</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html"><span class="hs-identifier">GHC.Types.SourceText</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html"><span class="hs-identifier">GHC.Driver.DynFlags</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html"><span class="hs-identifier">GHC.Utils.Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier">sameUnique</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Int.html"><span class="hs-identifier">Data.Int</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NEL</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Real.html"><span class="hs-identifier">GHC.Real</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Ratio</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">numerator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">denominator</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Desugaring literals
 [used to be in GHC.HsToCore.Expr, but GHC.HsToCore.Quote needs it,
  and it's nice to avoid a loop]
*                                                                      *
************************************************************************

We give int/float literals type @Integer@ and @Rational@, respectively.
The typechecker will (presumably) have put \tr{from{Integer,Rational}s}
around them.

ToDo: put in range checks for when converting ``@i@''
(or should that be in the typechecker?)

For numeric literals, we try to detect there use at a standard type
(@Int@, @Float@, etc.) are directly put in the right constructor.
[NB: down with the @App@ conversion.]

See also below where we look for @DictApps@ for \tr{plusInt}, etc.
-}</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsLit"><span class="hs-identifier hs-type">dsLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcRn"><span class="hs-identifier hs-type">GhcRn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-101"></span><span id="dsLit"><span class="annot"><span class="annottext">dsLit :: HsLit GhcRn -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsLit"><span class="hs-identifier hs-var hs-var">dsLit</span></a></span></span><span> </span><span id="local-6989586621683127121"><span class="annot"><span class="annottext">HsLit GhcRn
</span><a href="#local-6989586621683127121"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621683127122"><span class="annot"><a href="#local-6989586621683127122"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127124"><span class="annot"><a href="#local-6989586621683127124"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127122"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683127121"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsStringPrim"><span class="hs-identifier hs-type">HsStringPrim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsStringPrim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127127"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621683127127"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621683127127"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsCharPrim"><span class="hs-identifier hs-type">HsCharPrim</span></a></span><span>   </span><span class="annot"><span class="annottext">XHsCharPrim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127131"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127131"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitChar"><span class="hs-identifier hs-var">LitChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127131"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIntPrim"><span class="hs-identifier hs-type">HsIntPrim</span></a></span><span>    </span><span class="annot"><span class="annottext">XHsIntPrim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127134"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127134"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitIntWrap"><span class="hs-identifier hs-var">mkLitIntWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127124"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127134"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWordPrim"><span class="hs-identifier hs-type">HsWordPrim</span></a></span><span>   </span><span class="annot"><span class="annottext">XHsWordPrim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127137"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127137"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWordWrap"><span class="hs-identifier hs-var">mkLitWordWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127124"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127137"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt8Prim"><span class="hs-identifier hs-type">HsInt8Prim</span></a></span><span>   </span><span class="annot"><span class="annottext">XHsInt8Prim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127140"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127140"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt8Wrap"><span class="hs-identifier hs-var">mkLitInt8Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127140"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt16Prim"><span class="hs-identifier hs-type">HsInt16Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsInt16Prim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127143"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127143"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt16Wrap"><span class="hs-identifier hs-var">mkLitInt16Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127143"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt32Prim"><span class="hs-identifier hs-type">HsInt32Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsInt32Prim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127146"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127146"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt32Wrap"><span class="hs-identifier hs-var">mkLitInt32Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127146"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt64Prim"><span class="hs-identifier hs-type">HsInt64Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsInt64Prim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127149"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127149"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt64Wrap"><span class="hs-identifier hs-var">mkLitInt64Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127149"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord8Prim"><span class="hs-identifier hs-type">HsWord8Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsWord8Prim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127152"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127152"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord8Wrap"><span class="hs-identifier hs-var">mkLitWord8Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127152"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord16Prim"><span class="hs-identifier hs-type">HsWord16Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord16Prim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127155"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127155"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord16Wrap"><span class="hs-identifier hs-var">mkLitWord16Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127155"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord32Prim"><span class="hs-identifier hs-type">HsWord32Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord32Prim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127158"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127158"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord32Wrap"><span class="hs-identifier hs-var">mkLitWord32Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127158"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord64Prim"><span class="hs-identifier hs-type">HsWord64Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord64Prim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127161"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127161"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord64Wrap"><span class="hs-identifier hs-var">mkLitWord64Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127161"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-comment">-- This can be slow for very large literals. See Note [FractionalLit representation]</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- and #15646</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsFloatPrim"><span class="hs-identifier hs-type">HsFloatPrim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsFloatPrim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127164"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127164"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FractionalLit -&gt; Rational
</span><a href="GHC.Types.SourceText.html#rationalFromFractionalLit"><span class="hs-identifier hs-var">rationalFromFractionalLit</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127164"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsDoublePrim"><span class="hs-identifier hs-type">HsDoublePrim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsDoublePrim GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127168"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127168"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FractionalLit -&gt; Rational
</span><a href="GHC.Types.SourceText.html#rationalFromFractionalLit"><span class="hs-identifier hs-var">rationalFromFractionalLit</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127168"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsChar"><span class="hs-identifier hs-type">HsChar</span></a></span><span> </span><span class="annot"><span class="annottext">XHsChar GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127171"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127171"><span class="hs-identifier hs-var">c</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCharExpr"><span class="hs-identifier hs-var">mkCharExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127171"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsString"><span class="hs-identifier hs-type">HsString</span></a></span><span> </span><span class="annot"><span class="annottext">XHsString GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127174"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127174"><span class="hs-identifier hs-var">str</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; DsM CoreExpr
forall (m :: * -&gt; *). MonadThings m =&gt; FastString -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFS"><span class="hs-identifier hs-var">mkStringExprFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127174"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsMultilineString"><span class="hs-identifier hs-type">HsMultilineString</span></a></span><span> </span><span class="annot"><span class="annottext">XHsMultilineString GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127177"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127177"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; DsM CoreExpr
forall (m :: * -&gt; *). MonadThings m =&gt; FastString -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFS"><span class="hs-identifier hs-var">mkStringExprFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127177"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInteger"><span class="hs-identifier hs-type">HsInteger</span></a></span><span> </span><span class="annot"><span class="annottext">XHsInteger GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127179"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127179"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127124"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127179"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt"><span class="hs-identifier hs-type">HsInt</span></a></span><span> </span><span class="annot"><span class="annottext">XHsInt GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127182"><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683127182"><span class="hs-identifier hs-var">i</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntExpr"><span class="hs-identifier hs-var">mkIntExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127124"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntegralLit -&gt; Integer
</span><a href="GHC.Types.SourceText.html#il_value"><span class="hs-identifier hs-var">il_value</span></a></span><span> </span><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683127182"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsRat"><span class="hs-identifier hs-type">HsRat</span></a></span><span> </span><span class="annot"><span class="annottext">XHsRat GhcRn
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127186"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127186"><span class="hs-identifier hs-var">fl</span></a></span></span><span> </span><span id="local-6989586621683127187"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127187"><span class="hs-identifier hs-var">ty</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FractionalLit -&gt; Type -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsFractionalLitToRational"><span class="hs-identifier hs-var">dsFractionalLitToRational</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127186"><span class="hs-identifier hs-var">fl</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127187"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">{-
Note [FractionalLit representation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
There is a fun wrinkle to this, we used to simply compute the value
for these literals and store it as `Rational`. While this might seem
reasonable it meant typechecking literals of extremely large numbers
wasn't possible. This happened for example in #15646.

There a user would write in GHCi e.g. `:t 1e1234111111111111111111111`
which would trip up the compiler. The reason being we would parse it as
&lt;Literal of value n&gt;. Try to compute n, which would run out of memory
for truly large numbers, or take far too long for merely large ones.

To fix this we instead now store the significand and exponent of the
literal instead. Depending on the size of the exponent we then defer
the computation of the Rational value, potentially up to runtime of the
program! There are still cases left were we might compute large rationals
but it's a lot rarer then.

The current state of affairs for large literals is:
* Typechecking: Will produce a FractionalLit
* Desugaring a large overloaded literal to Float/Double *is* done
  at compile time. So can still fail. But this only matters for values too large
  to be represented as float anyway.
* Converting overloaded literals to a value of *Rational* is done at *runtime*.
  If such a value is then demanded at runtime the program might hang or run out of
  memory. But that is perhaps expected and acceptable.
* TH might also evaluate the literal even when overloaded.
  But there a user should be able to work around #15646 by
  generating a call to `mkRationalBase10/2` for large literals instead.


Note [FractionalLit representation]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
For fractional literals, like 1.3 or 0.79e22, we do /not/ represent
them within the compiler as a Rational.  Doing so would force the
compiler to compute a huge Rational for 2.3e300000000000, at compile
time (#15646)!

So instead we represent fractional literals as a FractionalLit,
in which we record the significand and exponent separately.  Then
we can compute the huge Rational at /runtime/, by emitting code
for
       mkRationalBase10 2.3 300000000000

where mkRationalBase10 is defined in the library GHC.Real

The moving parts are here:

* Parsing, renaming, typechecking: use FractionalLit, in which the
  significand and exponent are represented separately.

* Desugaring.  Remember that a fractional literal like 54.4e20 has type
     Fractional a =&gt; a

  - For fractional literals whose type turns out to be Float/Double,
    we desugar to a Float/Double literal at /compile time/.
    This conversion can still fail. But this only matters for values
    too large to be represented as float anyway.  See dsLit in
    GHC.HsToCore.Match.Literal

  - For fractional literals whose type turns out to be Rational, we
    desugar the literal to a call of `mkRationalBase10` (etc for hex
    literals), so that we only compute the Rational at /run time/.  If
    this value is then demanded at runtime the program might hang or
    run out of memory. But that is perhaps expected and acceptable.
    See dsFractionalLitToRational in GHC.HsToCore.Match.Literal

  - For fractional literals whose type isn't one of the above, we just
    call the typeclass method `fromRational`.  But to do that we need
    the rational to give to it, and we compute that at runtime, as
    above.

* Template Haskell definitions are also problematic. While the TH code
  works as expected once it's spliced into a program it will compute the
  value of the large literal.
  But there a user should be able to work around #15646
  by having their TH code generating a call to `mkRationalBase[10/2]` for
  large literals  instead.

-}</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><span class="hs-comment">-- | See Note [FractionalLit representation]</span></span><span>
</span><span id="line-212"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsFractionalLitToRational"><span class="hs-identifier hs-type">dsFractionalLitToRational</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html#FractionalLit"><span class="hs-identifier hs-type">FractionalLit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-213"></span><span id="dsFractionalLitToRational"><span class="annot"><span class="annottext">dsFractionalLitToRational :: FractionalLit -&gt; Type -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsFractionalLitToRational"><span class="hs-identifier hs-var hs-var">dsFractionalLitToRational</span></a></span></span><span> </span><span id="local-6989586621683127189"><span class="annot"><span class="annottext">fl :: FractionalLit
</span><a href="#local-6989586621683127189"><span class="hs-identifier hs-var">fl</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="GHC.Types.SourceText.html#FL"><span class="hs-identifier hs-type">FL</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fl_signi :: FractionalLit -&gt; Rational
</span><a href="GHC.Types.SourceText.html#fl_signi"><span class="hs-identifier hs-var">fl_signi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683127192"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621683127192"><span class="hs-identifier hs-var">signi</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fl_exp :: FractionalLit -&gt; Integer
</span><a href="GHC.Types.SourceText.html#fl_exp"><span class="hs-identifier hs-var">fl_exp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683127194"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127194"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fl_exp_base :: FractionalLit -&gt; FractionalExponentBase
</span><a href="GHC.Types.SourceText.html#fl_exp_base"><span class="hs-identifier hs-var">fl_exp_base</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683127196"><span class="annot"><span class="annottext">FractionalExponentBase
</span><a href="#local-6989586621683127196"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621683127197"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127197"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- We compute &quot;small&quot; rationals here and now</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127194"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621683127200"><span class="annot"><a href="#local-6989586621683127200"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(DynFlags -&gt; Platform)
-&gt; IOEnv (Env DsGblEnv DsLclEnv) DynFlags
-&gt; IOEnv (Env DsGblEnv DsLclEnv) Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621683127202"><span class="annot"><a href="#local-6989586621683127202"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FractionalLit -&gt; Rational
</span><a href="GHC.Types.SourceText.html#rationalFromFractionalLit"><span class="hs-identifier hs-var">rationalFromFractionalLit</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127189"><span class="hs-identifier hs-var">fl</span></a></span><span>
</span><span id="line-219"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621683127203"><span class="annot"><a href="#local-6989586621683127203"><span class="hs-identifier hs-var hs-var">num</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127200"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621683127202"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621683127204"><span class="annot"><a href="#local-6989586621683127204"><span class="hs-identifier hs-var hs-var">denom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127200"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621683127202"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621683127205"><span class="annot"><a href="#local-6989586621683127205"><span class="hs-identifier hs-var">ratio_data_con</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683127206"><span class="annot"><a href="#local-6989586621683127206"><span class="hs-identifier hs-var">integer_ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#tcSplitTyConApp"><span class="hs-identifier hs-type">tcSplitTyConApp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127197"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-223"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621683127208"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683127208"><span class="hs-identifier hs-var">tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621683127209"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127209"><span class="hs-identifier hs-var">i_ty</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (DataCon, Type) -&gt; (DataCon, Type)
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isIntegerTy"><span class="hs-identifier hs-var">isIntegerTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127209"><span class="hs-identifier hs-var">i_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683127208"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#ratioTyConKey"><span class="hs-identifier hs-var">ratioTyConKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DataCon] -&gt; DataCon
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="GHC.Prelude.Basic.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683127208"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127209"><span class="hs-identifier hs-var">i_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>                    </span><span id="local-6989586621683127217"><span class="annot"><span class="annottext">(TyCon, [Type])
</span><a href="#local-6989586621683127217"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (DataCon, Type)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dsLit&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyCon, [Type]) -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">(TyCon, [Type])
</span><a href="#local-6989586621683127217"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-type">mkCoreConApps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127205"><span class="hs-identifier hs-type">ratio_data_con</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127206"><span class="hs-identifier hs-type">integer_ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127203"><span class="hs-identifier hs-type">num</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127204"><span class="hs-identifier hs-type">denom</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">-- Large rationals will be computed at runtime.</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127223"><span class="annot"><span class="annottext">mkRationalName :: Name
</span><a href="#local-6989586621683127223"><span class="hs-identifier hs-var hs-var hs-var">mkRationalName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FractionalExponentBase
</span><a href="#local-6989586621683127196"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-231"></span><span>                             </span><span class="annot"><span class="annottext">FractionalExponentBase
</span><a href="GHC.Types.SourceText.html#Base2"><span class="hs-identifier hs-var">Base2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#mkRationalBase2Name"><span class="hs-identifier hs-var">mkRationalBase2Name</span></a></span><span>
</span><span id="line-232"></span><span>                             </span><span class="annot"><span class="annottext">FractionalExponentBase
</span><a href="GHC.Types.SourceText.html#Base10"><span class="hs-identifier hs-var">Base10</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#mkRationalBase10Name"><span class="hs-identifier hs-var">mkRationalBase10Name</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span id="local-6989586621683127228"><span class="annot"><a href="#local-6989586621683127228"><span class="hs-identifier hs-var">mkRational</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DsM Id
</span><a href="GHC.HsToCore.Monad.html#dsLookupGlobalId"><span class="hs-identifier hs-var">dsLookupGlobalId</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127223"><span class="hs-identifier hs-var">mkRationalName</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span id="local-6989586621683127230"><span class="annot"><a href="#local-6989586621683127230"><span class="hs-identifier hs-var">litR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsRational"><span class="hs-identifier hs-type">dsRational</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127192"><span class="hs-identifier hs-type">signi</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span id="local-6989586621683127232"><span class="annot"><a href="#local-6989586621683127232"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-type">getDynFlags</span></a></span><span>
</span><span id="line-236"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127233"><span class="annot"><a href="#local-6989586621683127233"><span class="hs-identifier hs-var hs-var">litE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127232"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127194"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-type">mkCoreApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127228"><span class="hs-identifier hs-type">mkRational</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621683127230"><span class="hs-identifier hs-type">litR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127233"><span class="hs-identifier hs-type">litE</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsRational"><span class="hs-identifier hs-type">dsRational</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-240"></span><span id="dsRational"><span class="annot"><span class="annottext">dsRational :: Rational -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsRational"><span class="hs-identifier hs-var hs-var">dsRational</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127236"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127236"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:%</span></span><span> </span><span id="local-6989586621683127237"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127237"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621683127238"><span class="annot"><a href="#local-6989586621683127238"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(DynFlags -&gt; Platform)
-&gt; IOEnv (Env DsGblEnv DsLclEnv) DynFlags
-&gt; IOEnv (Env DsGblEnv DsLclEnv) Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621683127239"><span class="annot"><a href="#local-6989586621683127239"><span class="hs-identifier hs-var">dcn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#dsLookupDataCon"><span class="hs-identifier hs-type">dsLookupDataCon</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#ratioDataConName"><span class="hs-identifier hs-type">ratioDataConName</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127242"><span class="annot"><a href="#local-6989586621683127242"><span class="hs-identifier hs-var hs-var">cn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127238"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127236"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127243"><span class="annot"><a href="#local-6989586621683127243"><span class="hs-identifier hs-var hs-var">dn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127238"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127237"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreConApps"><span class="hs-identifier hs-type">mkCoreConApps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127239"><span class="hs-identifier hs-type">dcn</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#integerTy"><span class="hs-identifier hs-type">integerTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127242"><span class="hs-identifier hs-type">cn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127243"><span class="hs-identifier hs-type">dn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsOverLit"><span class="hs-identifier hs-type">dsOverLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- ^ Post-typechecker, the 'HsExpr' field of an 'OverLit' contains</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- (an expression for) the literal value itself.</span><span>
</span><span id="line-251"></span><span id="dsOverLit"><span class="annot"><span class="annottext">dsOverLit :: HsOverLit GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsOverLit"><span class="hs-identifier hs-var hs-var">dsOverLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#OverLit"><span class="hs-identifier hs-type">OverLit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ol_val :: forall p. HsOverLit p -&gt; OverLitVal
</span><a href="Language.Haskell.Syntax.Lit.html#ol_val"><span class="hs-identifier hs-var">ol_val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683127247"><span class="annot"><span class="annottext">OverLitVal
</span><a href="#local-6989586621683127247"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ol_ext :: forall p. HsOverLit p -&gt; XOverLit p
</span><a href="Language.Haskell.Syntax.Lit.html#ol_ext"><span class="hs-identifier hs-var">ol_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Hs.Lit.html#OverLitTc"><span class="hs-identifier hs-type">OverLitTc</span></a></span><span> </span><span id="local-6989586621683127250"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683127250"><span class="hs-identifier hs-var">rebindable</span></a></span></span><span> </span><span id="local-6989586621683127251"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683127251"><span class="hs-identifier hs-var">witness</span></a></span></span><span> </span><span id="local-6989586621683127252"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127252"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621683127253"><span class="annot"><a href="#local-6989586621683127253"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127254"><span class="annot"><a href="#local-6989586621683127254"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127253"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcMType.html#shortCutLit"><span class="hs-identifier hs-type">shortCutLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127254"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127247"><span class="hs-identifier hs-type">val</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127252"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127255"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683127255"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683127250"><span class="hs-identifier hs-var">rebindable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683127255"><span class="hs-identifier hs-var">expr</span></a></span><span>        </span><span class="hs-comment">-- Note [Literal short cut]</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcTc)
</span><span class="hs-identifier">_</span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsExpr"><span class="hs-identifier hs-var">dsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683127251"><span class="hs-identifier hs-var">witness</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">{-
Note [Literal short cut]
~~~~~~~~~~~~~~~~~~~~~~~~
The type checker tries to do this short-cutting as early as possible, but
because of unification etc, more information is available to the desugarer.
And where it's possible to generate the correct literal right away, it's
much better to do so.


************************************************************************
*                                                                      *
                 Warnings about overflowed literals
*                                                                      *
************************************************************************

Warn about functions like toInteger, fromIntegral, that convert
between one type and another when the to- and from- types are the
same.  Then it's probably (albeit not definitely) the identity
-}</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutIdentities"><span class="hs-identifier hs-type">warnAboutIdentities</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span id="warnAboutIdentities"><span class="annot"><span class="annottext">warnAboutIdentities :: DynFlags -&gt; Id -&gt; Type -&gt; DsM ()
</span><a href="GHC.HsToCore.Match.Literal.html#warnAboutIdentities"><span class="hs-identifier hs-var hs-var">warnAboutIdentities</span></a></span></span><span> </span><span id="local-6989586621683127257"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127257"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621683127258"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127258"><span class="hs-identifier hs-var">conv_fn</span></a></span></span><span> </span><span id="local-6989586621683127259"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127259"><span class="hs-identifier hs-var">type_of_conv</span></a></span></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.DynFlags.html#wopt"><span class="hs-identifier hs-var">wopt</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnIdentities"><span class="hs-identifier hs-var">Opt_WarnIdentities</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127257"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Name
</span><a href="GHC.Types.Id.html#idName"><span class="hs-identifier hs-var">idName</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127258"><span class="hs-identifier hs-var">conv_fn</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="GHC.HsToCore.Match.Literal.html#conversionNames"><span class="hs-identifier hs-var">conversionNames</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunTyFlag
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683127265"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127265"><span class="hs-identifier hs-var">arg_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683127266"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127266"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe (FunTyFlag, Type, Type, Type)
</span><a href="GHC.Core.Type.html#splitFunTy_maybe"><span class="hs-identifier hs-var">splitFunTy_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127259"><span class="hs-identifier hs-var">type_of_conv</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127265"><span class="hs-identifier hs-var">arg_ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127266"><span class="hs-identifier hs-var">res_ty</span></a></span><span>  </span><span class="hs-comment">-- So we are converting  ty -&gt; ty</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DsMessage -&gt; DsM ()
</span><a href="GHC.HsToCore.Monad.html#diagnosticDs"><span class="hs-identifier hs-var">diagnosticDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Type -&gt; DsMessage
</span><a href="GHC.HsToCore.Errors.Types.html#DsIdentitiesFound"><span class="hs-identifier hs-var">DsIdentitiesFound</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127258"><span class="hs-identifier hs-var">conv_fn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127259"><span class="hs-identifier hs-var">type_of_conv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutIdentities"><span class="hs-identifier hs-var">warnAboutIdentities</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; DsM ()
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#conversionNames"><span class="hs-identifier hs-type">conversionNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-288"></span><span id="conversionNames"><span class="annot"><span class="annottext">conversionNames :: [Name]
</span><a href="GHC.HsToCore.Match.Literal.html#conversionNames"><span class="hs-identifier hs-var hs-var">conversionNames</span></a></span></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#toIntegerName"><span class="hs-identifier hs-var">toIntegerName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#toRationalName"><span class="hs-identifier hs-var">toRationalName</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#fromIntegralName"><span class="hs-identifier hs-var">fromIntegralName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#realToFracName"><span class="hs-identifier hs-var">realToFracName</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span> </span><span class="hs-comment">-- We can't easily add fromIntegerName, fromRationalName,</span><span>
</span><span id="line-292"></span><span> </span><span class="hs-comment">-- because they are generated by literals</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- | Emit warnings on overloaded integral literals which overflow the bounds</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- implied by their type.</span><span>
</span><span id="line-297"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedOverLit"><span class="hs-identifier hs-type">warnAboutOverflowedOverLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span id="warnAboutOverflowedOverLit"><span class="annot"><span class="annottext">warnAboutOverflowedOverLit :: HsOverLit GhcTc -&gt; DsM ()
</span><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedOverLit"><span class="hs-identifier hs-var hs-var">warnAboutOverflowedOverLit</span></a></span></span><span> </span><span id="local-6989586621683127275"><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127275"><span class="hs-identifier hs-var">hsOverLit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621683127276"><span class="annot"><a href="#local-6989586621683127276"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621683127277"><span class="annot"><a href="#local-6989586621683127277"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#dsGetFamInstEnvs"><span class="hs-identifier hs-type">dsGetFamInstEnvs</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedLiterals"><span class="hs-identifier hs-type">warnAboutOverflowedLiterals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127276"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getIntegralLit"><span class="hs-identifier hs-type">getIntegralLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127275"><span class="hs-identifier hs-type">hsOverLit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getNormalisedTyconName"><span class="hs-identifier hs-type">getNormalisedTyconName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127277"><span class="hs-identifier hs-type">fam_envs</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | Emit warnings on integral literals which overflow the bounds implied by</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- their type.</span><span>
</span><span id="line-306"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedLit"><span class="hs-identifier hs-type">warnAboutOverflowedLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span id="warnAboutOverflowedLit"><span class="annot"><span class="annottext">warnAboutOverflowedLit :: HsLit GhcTc -&gt; DsM ()
</span><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedLit"><span class="hs-identifier hs-var hs-var">warnAboutOverflowedLit</span></a></span></span><span> </span><span id="local-6989586621683127282"><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127282"><span class="hs-identifier hs-var">hsLit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621683127283"><span class="annot"><a href="#local-6989586621683127283"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedLiterals"><span class="hs-identifier hs-type">warnAboutOverflowedLiterals</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127283"><span class="hs-identifier hs-type">dflags</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-310"></span><span>      </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-type">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127282"><span class="hs-identifier hs-type">hsLit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getTyconName"><span class="hs-identifier hs-type">getTyconName</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- | Emit warnings on integral literals which overflow the bounds implied by</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- their type.</span><span>
</span><span id="line-314"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedLiterals"><span class="hs-identifier hs-type">warnAboutOverflowedLiterals</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the literal value and name of its tycon</span></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span id="warnAboutOverflowedLiterals"><span class="annot"><span class="annottext">warnAboutOverflowedLiterals :: DynFlags -&gt; Maybe (Integer, Name) -&gt; DsM ()
</span><a href="GHC.HsToCore.Match.Literal.html#warnAboutOverflowedLiterals"><span class="hs-identifier hs-var hs-var">warnAboutOverflowedLiterals</span></a></span></span><span> </span><span id="local-6989586621683127286"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127286"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621683127287"><span class="annot"><span class="annottext">Maybe (Integer, Name)
</span><a href="#local-6989586621683127287"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-319"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.DynFlags.html#wopt"><span class="hs-identifier hs-var">wopt</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnOverflowedLiterals"><span class="hs-identifier hs-var">Opt_WarnOverflowedLiterals</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127286"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-320"></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127289"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683127290"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Name)
</span><a href="#local-6989586621683127287"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-321"></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-comment">-- These only show up via the 'HsOverLit' route</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.html#intTyConName"><span class="hs-identifier hs-var">intTyConName</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127293"><span class="hs-identifier hs-var">minInt</span></a></span><span>         </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127294"><span class="hs-identifier hs-var">maxInt</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.html#wordTyConName"><span class="hs-identifier hs-var">wordTyConName</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127296"><span class="hs-identifier hs-var">minWord</span></a></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127297"><span class="hs-identifier hs-var">maxWord</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#int8TyConName"><span class="hs-identifier hs-var">int8TyConName</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#int16TyConName"><span class="hs-identifier hs-var">int16TyConName</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#int32TyConName"><span class="hs-identifier hs-var">int32TyConName</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#int64TyConName"><span class="hs-identifier hs-var">int64TyConName</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#word8TyConName"><span class="hs-identifier hs-var">word8TyConName</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#word16TyConName"><span class="hs-identifier hs-var">word16TyConName</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#word32TyConName"><span class="hs-identifier hs-var">word32TyConName</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#word64TyConName"><span class="hs-identifier hs-var">word64TyConName</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.html#naturalTyConName"><span class="hs-identifier hs-var">naturalTyConName</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; DsM ()
</span><a href="#local-6989586621683127309"><span class="hs-identifier hs-var">checkPositive</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-comment">-- These only show up via the 'HsLit' route</span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#intPrimTyConName"><span class="hs-identifier hs-var">intPrimTyConName</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127293"><span class="hs-identifier hs-var">minInt</span></a></span><span>         </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127294"><span class="hs-identifier hs-var">maxInt</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#wordPrimTyConName"><span class="hs-identifier hs-var">wordPrimTyConName</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127296"><span class="hs-identifier hs-var">minWord</span></a></span><span>        </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127297"><span class="hs-identifier hs-var">maxWord</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#int8PrimTyConName"><span class="hs-identifier hs-var">int8PrimTyConName</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#int16PrimTyConName"><span class="hs-identifier hs-var">int16PrimTyConName</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#int32PrimTyConName"><span class="hs-identifier hs-var">int32PrimTyConName</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#int64PrimTyConName"><span class="hs-identifier hs-var">int64PrimTyConName</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#word8PrimTyConName"><span class="hs-identifier hs-var">word8PrimTyConName</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#word16PrimTyConName"><span class="hs-identifier hs-var">word16PrimTyConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#word32PrimTyConName"><span class="hs-identifier hs-var">word32PrimTyConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; a -&gt; Bool
</span><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-var">sameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Types.Prim.html#word64PrimTyConName"><span class="hs-identifier hs-var">word64PrimTyConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127289"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127290"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var">min'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var">max'</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; DsM ()
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; DsM ()
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-comment">-- use target Int/Word sizes! See #17336</span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621683127320"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621683127320"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127286"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683127293"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127293"><span class="hs-identifier hs-var">minInt</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683127294"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127294"><span class="hs-identifier hs-var">maxInt</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer
</span><a href="GHC.Platform.html#platformMinInt"><span class="hs-identifier hs-var">platformMinInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127320"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer
</span><a href="GHC.Platform.html#platformMaxInt"><span class="hs-identifier hs-var">platformMaxInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127320"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621683127296"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127296"><span class="hs-identifier hs-var">minWord</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683127297"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127297"><span class="hs-identifier hs-var">maxWord</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span>                       </span><span class="annot"><span class="annottext">Platform -&gt; Integer
</span><a href="GHC.Platform.html#platformMaxWord"><span class="hs-identifier hs-var">platformMaxWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127320"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="#local-6989586621683127299"><span class="hs-identifier hs-type">min'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621683126705"><span class="annot"><a href="#local-6989586621683126705"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621683126705"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="annot"><a href="#local-6989586621683126705"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621683127299"><span class="annot"><span class="annottext">min' :: forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127299"><span class="hs-identifier hs-var hs-var">min'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621683126705"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="#local-6989586621683127300"><span class="hs-identifier hs-type">max'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621683127330"><span class="annot"><a href="#local-6989586621683127330"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621683127330"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="annot"><a href="#local-6989586621683127330"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621683127300"><span class="annot"><span class="annottext">max' :: forall a. (Integral a, Bounded a) =&gt; Integer
</span><a href="#local-6989586621683127300"><span class="hs-identifier hs-var hs-var">max'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621683127330"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><a href="#local-6989586621683127309"><span class="hs-identifier hs-type">checkPositive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621683127309"><span class="annot"><span class="annottext">checkPositive :: Integer -&gt; Name -&gt; DsM ()
</span><a href="#local-6989586621683127309"><span class="hs-identifier hs-var hs-var">checkPositive</span></a></span></span><span> </span><span id="local-6989586621683127337"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127337"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621683127338"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127338"><span class="hs-identifier hs-var">tc</span></a></span></span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DsM () -&gt; DsM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127337"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DsM () -&gt; DsM ()) -&gt; DsM () -&gt; DsM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><span class="annottext">DsMessage -&gt; DsM ()
</span><a href="GHC.HsToCore.Monad.html#diagnosticDs"><span class="hs-identifier hs-var">diagnosticDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
-&gt; Name
-&gt; Maybe (MinBound, MaxBound)
-&gt; NegLiteralExtEnabled
-&gt; DsMessage
</span><a href="GHC.HsToCore.Errors.Types.html#DsOverflowedLiterals"><span class="hs-identifier hs-var">DsOverflowedLiterals</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127337"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127338"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (MinBound, MaxBound)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; NegLiteralExtEnabled
</span><a href="GHC.HsToCore.Errors.Types.html#negLiteralExtEnabled"><span class="hs-identifier hs-var">negLiteralExtEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127286"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621683127292"><span class="annot"><span class="annottext">check :: Integer -&gt; Name -&gt; Integer -&gt; Integer -&gt; DsM ()
</span><a href="#local-6989586621683127292"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621683127343"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127343"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621683127344"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127344"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621683127345"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127345"><span class="hs-identifier hs-var">minB</span></a></span></span><span> </span><span id="local-6989586621683127346"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127346"><span class="hs-identifier hs-var">maxB</span></a></span></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DsM () -&gt; DsM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127343"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127345"><span class="hs-identifier hs-var">minB</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127343"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127346"><span class="hs-identifier hs-var">maxB</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DsM () -&gt; DsM ()) -&gt; DsM () -&gt; DsM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">DsMessage -&gt; DsM ()
</span><a href="GHC.HsToCore.Monad.html#diagnosticDs"><span class="hs-identifier hs-var">diagnosticDs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
-&gt; Name
-&gt; Maybe (MinBound, MaxBound)
-&gt; NegLiteralExtEnabled
-&gt; DsMessage
</span><a href="GHC.HsToCore.Errors.Types.html#DsOverflowedLiterals"><span class="hs-identifier hs-var">DsOverflowedLiterals</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127343"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127344"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (MinBound, MaxBound)
</span><a href="#local-6989586621683127349"><span class="hs-identifier hs-var">bounds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; NegLiteralExtEnabled
</span><a href="GHC.HsToCore.Errors.Types.html#negLiteralExtEnabled"><span class="hs-identifier hs-var">negLiteralExtEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127286"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>        </span><span id="local-6989586621683127349"><span class="annot"><span class="annottext">bounds :: Maybe (MinBound, MaxBound)
</span><a href="#local-6989586621683127349"><span class="hs-identifier hs-var hs-var">bounds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MinBound, MaxBound) -&gt; Maybe (MinBound, MaxBound)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; MinBound
</span><a href="GHC.HsToCore.Errors.Types.html#MinBound"><span class="hs-identifier hs-var">MinBound</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127345"><span class="hs-identifier hs-var">minB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; MaxBound
</span><a href="GHC.HsToCore.Errors.Types.html#MaxBound"><span class="hs-identifier hs-var">MaxBound</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127346"><span class="hs-identifier hs-var">maxB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#warnAboutEmptyEnumerations"><span class="hs-identifier hs-type">warnAboutEmptyEnumerations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.DynFlags.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-374"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>                           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- ^ Warns about @[2,3 .. 1]@ or @['b' .. 'a']@ which return the empty list.</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- For numeric literals, only works for integral types, not floating point.</span><span>
</span><span id="line-378"></span><span id="warnAboutEmptyEnumerations"><span class="annot"><span class="annottext">warnAboutEmptyEnumerations :: FamInstEnvs
-&gt; DynFlags
-&gt; LHsExpr GhcTc
-&gt; Maybe (LHsExpr GhcTc)
-&gt; LHsExpr GhcTc
-&gt; DsM ()
</span><a href="GHC.HsToCore.Match.Literal.html#warnAboutEmptyEnumerations"><span class="hs-identifier hs-var hs-var">warnAboutEmptyEnumerations</span></a></span></span><span> </span><span id="local-6989586621683127352"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683127352"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span id="local-6989586621683127353"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127353"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621683127354"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127354"><span class="hs-identifier hs-var">fromExpr</span></a></span></span><span> </span><span id="local-6989586621683127355"><span class="annot"><span class="annottext">Maybe (LHsExpr GhcTc)
</span><a href="#local-6989586621683127355"><span class="hs-identifier hs-var">mThnExpr</span></a></span></span><span> </span><span id="local-6989586621683127356"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127356"><span class="hs-identifier hs-var">toExpr</span></a></span></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WarningFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.DynFlags.html#wopt"><span class="hs-identifier hs-var">wopt</span></a></span><span> </span><span class="annot"><span class="annottext">WarningFlag
</span><a href="GHC.Driver.Flags.html#Opt_WarnEmptyEnumerations"><span class="hs-identifier hs-var">Opt_WarnEmptyEnumerations</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127353"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; DsM ()
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-comment">-- Numeric Literals</span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127358"><span class="annot"><span class="annottext">from_ty :: (Integer, Type)
</span><a href="#local-6989586621683127358"><span class="hs-identifier hs-var">from_ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621683127359"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127359"><span class="hs-identifier hs-var">from'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsIntegralLit"><span class="hs-identifier hs-var">getLHsIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127354"><span class="hs-identifier hs-var">fromExpr</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683127361"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621683127361"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; (Integer, Type) -&gt; Maybe (Integer, Name)
</span><a href="GHC.HsToCore.Match.Literal.html#getNormalisedTyconName"><span class="hs-identifier hs-var">getNormalisedTyconName</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683127352"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer, Type)
</span><a href="#local-6989586621683127358"><span class="hs-identifier hs-var">from_ty</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127362"><span class="annot"><span class="annottext">Maybe (Integer, Type)
</span><a href="#local-6989586621683127362"><span class="hs-identifier hs-var">mThn'</span></a></span></span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsExpr GhcTc) -&gt; Maybe (Integer, Type))
-&gt; Maybe (GenLocated SrcSpanAnnA (HsExpr GhcTc))
-&gt; Maybe (Maybe (Integer, Type))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (Integer, Type)
GenLocated SrcSpanAnnA (HsExpr GhcTc) -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsIntegralLit"><span class="hs-identifier hs-var">getLHsIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsExpr GhcTc)
Maybe (GenLocated SrcSpanAnnA (HsExpr GhcTc))
</span><a href="#local-6989586621683127355"><span class="hs-identifier hs-var">mThnExpr</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127364"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127364"><span class="hs-identifier hs-var">to'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsIntegralLit"><span class="hs-identifier hs-var">getLHsIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127356"><span class="hs-identifier hs-var">toExpr</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621683126722"><span class="annot"><a href="#local-6989586621683126722"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621683126722"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621683126722"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>        </span><span id="local-6989586621683127365"><span class="annot"><span class="annottext">check :: forall a. (Integral a, Num a) =&gt; DsM ()
</span><a href="#local-6989586621683127365"><span class="hs-identifier hs-var hs-var hs-var">check</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DsM () -&gt; DsM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Integer] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Integer]
</span><a href="#local-6989586621683127382"><span class="hs-identifier hs-var">enumeration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DsM ()
</span><a href="#local-6989586621683127383"><span class="hs-identifier hs-var">raiseWarning</span></a></span><span>
</span><span id="line-390"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-391"></span><span>            </span><span id="local-6989586621683127382"><span class="annot"><span class="annottext">enumeration :: [Integer]
</span><a href="#local-6989586621683127382"><span class="hs-identifier hs-var hs-var">enumeration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621683127384"><span class="hs-identifier hs-var">mThn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-392"></span><span>              </span><span class="annot"><span class="annottext">Maybe Integer
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127385"><span class="hs-identifier hs-var">from</span></a></span><span>      </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127386"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-393"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127387"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127387"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127385"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127387"><span class="hs-identifier hs-var">thn</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127386"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>            </span><span class="annot"><a href="#local-6989586621683127388"><span class="hs-identifier hs-type">wrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621683126726"><span class="annot"><a href="#local-6989586621683126726"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621683126726"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621683126726"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-395"></span><span>            </span><span id="local-6989586621683127388"><span class="annot"><span class="annottext">wrap :: forall a. (Integral a, Num a) =&gt; Integer -&gt; Integer
</span><a href="#local-6989586621683127388"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621683127394"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127394"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127394"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621683126726"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>            </span><span id="local-6989586621683127385"><span class="annot"><span class="annottext">from :: Integer
</span><a href="#local-6989586621683127385"><span class="hs-identifier hs-var hs-var">from</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Num a) =&gt; Integer -&gt; Integer
</span><a href="#local-6989586621683127388"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621683126722"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127359"><span class="hs-identifier hs-var">from'</span></a></span><span>
</span><span id="line-397"></span><span>            </span><span id="local-6989586621683127386"><span class="annot"><span class="annottext">to :: Integer
</span><a href="#local-6989586621683127386"><span class="hs-identifier hs-var hs-var">to</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Num a) =&gt; Integer -&gt; Integer
</span><a href="#local-6989586621683127388"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621683126722"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127364"><span class="hs-identifier hs-var">to'</span></a></span><span>
</span><span id="line-398"></span><span>            </span><span id="local-6989586621683127384"><span class="annot"><span class="annottext">mThn :: Maybe Integer
</span><a href="#local-6989586621683127384"><span class="hs-identifier hs-var hs-var">mThn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Integer, Type) -&gt; Integer)
-&gt; Maybe (Integer, Type) -&gt; Maybe Integer
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (Integral a, Num a) =&gt; Integer -&gt; Integer
</span><a href="#local-6989586621683127388"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621683126722"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer)
-&gt; ((Integer, Type) -&gt; Integer) -&gt; (Integer, Type) -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Integer
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
</span><a href="#local-6989586621683127362"><span class="hs-identifier hs-var">mThn'</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span>      </span><span id="local-6989586621683127397"><span class="annot"><a href="#local-6989586621683127397"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(DynFlags -&gt; Platform)
-&gt; IOEnv (Env DsGblEnv DsLclEnv) DynFlags
-&gt; IOEnv (Env DsGblEnv DsLclEnv) Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-401"></span><span>         </span><span class="hs-comment">-- Be careful to use target Int/Word sizes! cf #17336</span><span>
</span><span id="line-402"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#intTyConName"><span class="hs-identifier hs-type">intTyConName</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127397"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-403"></span><span>                                               </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Num a) =&gt; DsM ()
</span><a href="#local-6989586621683127365"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span>
</span><span id="line-404"></span><span>                                               </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Num a) =&gt; DsM ()
</span><a href="#local-6989586621683127365"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-405"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#wordTyConName"><span class="hs-identifier hs-type">wordTyConName</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127397"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-406"></span><span>                                               </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Num a) =&gt; DsM ()
</span><a href="#local-6989586621683127365"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-407"></span><span>                                               </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Integral a, Num a) =&gt; DsM ()
</span><a href="#local-6989586621683127365"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-408"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#int8TyConName"><span class="hs-identifier hs-type">int8TyConName</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int8</span></span><span>
</span><span id="line-409"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#int16TyConName"><span class="hs-identifier hs-type">int16TyConName</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span>
</span><span id="line-410"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#int32TyConName"><span class="hs-identifier hs-type">int32TyConName</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span>
</span><span id="line-411"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#int64TyConName"><span class="hs-identifier hs-type">int64TyConName</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-412"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#word8TyConName"><span class="hs-identifier hs-type">word8TyConName</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-413"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#word16TyConName"><span class="hs-identifier hs-type">word16TyConName</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-414"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#word32TyConName"><span class="hs-identifier hs-type">word32TyConName</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-415"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#word64TyConName"><span class="hs-identifier hs-type">word64TyConName</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-416"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#integerTyConName"><span class="hs-identifier hs-type">integerTyConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-417"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.Unique.html#sameUnique"><span class="hs-identifier hs-type">sameUnique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127361"><span class="hs-identifier hs-type">tc</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#naturalTyConName"><span class="hs-identifier hs-type">naturalTyConName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621683127365"><span class="hs-identifier hs-type">check</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-418"></span><span>            </span><span class="hs-comment">-- We use 'Integer' because otherwise a negative 'Natural' literal</span><span>
</span><span id="line-419"></span><span>            </span><span class="hs-comment">-- could cause a compile time crash (instead of a runtime one).</span><span>
</span><span id="line-420"></span><span>            </span><span class="hs-comment">-- See the T10930b test case for an example of where this matters.</span><span>
</span><span id="line-421"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-comment">-- Char literals (#18402)</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127402"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127402"><span class="hs-identifier hs-var">fromChar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe Char
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127354"><span class="hs-identifier hs-var">fromExpr</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127404"><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621683127404"><span class="hs-identifier hs-var">mThnChar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (HsExpr GhcTc) -&gt; Maybe Char)
-&gt; Maybe (GenLocated SrcSpanAnnA (HsExpr GhcTc))
-&gt; Maybe (Maybe Char)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe Char
GenLocated SrcSpanAnnA (HsExpr GhcTc) -&gt; Maybe Char
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (LHsExpr GhcTc)
Maybe (GenLocated SrcSpanAnnA (HsExpr GhcTc))
</span><a href="#local-6989586621683127355"><span class="hs-identifier hs-var">mThnExpr</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127405"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127405"><span class="hs-identifier hs-var">toChar</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe Char
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127356"><span class="hs-identifier hs-var">toExpr</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127406"><span class="annot"><span class="annottext">enumeration :: String
</span><a href="#local-6989586621683127406"><span class="hs-identifier hs-var hs-var">enumeration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621683127404"><span class="hs-identifier hs-var">mThnChar</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-428"></span><span>                        </span><span class="annot"><span class="annottext">Maybe Char
</span><span class="hs-identifier hs-var">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127402"><span class="hs-identifier hs-var">fromChar</span></a></span><span>          </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127405"><span class="hs-identifier hs-var">toChar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127407"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127407"><span class="hs-identifier hs-var">thnChar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127402"><span class="hs-identifier hs-var">fromChar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127407"><span class="hs-identifier hs-var">thnChar</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127405"><span class="hs-identifier hs-var">toChar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; DsM () -&gt; DsM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621683127406"><span class="hs-identifier hs-var">enumeration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DsM ()
</span><a href="#local-6989586621683127383"><span class="hs-identifier hs-var">raiseWarning</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; DsM ()
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-434"></span><span>    </span><span id="local-6989586621683127383"><span class="annot"><span class="annottext">raiseWarning :: DsM ()
</span><a href="#local-6989586621683127383"><span class="hs-identifier hs-var hs-var">raiseWarning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-435"></span><span>      </span><span class="annot"><span class="annottext">DsMessage -&gt; DsM ()
</span><a href="GHC.HsToCore.Monad.html#diagnosticDs"><span class="hs-identifier hs-var">diagnosticDs</span></a></span><span> </span><span class="annot"><span class="annottext">DsMessage
</span><a href="GHC.HsToCore.Errors.Types.html#DsEmptyEnumeration"><span class="hs-identifier hs-var">DsEmptyEnumeration</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getLHsIntegralLit"><span class="hs-identifier hs-type">getLHsIntegralLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span class="annot"><span class="hs-comment">-- ^ See if the expression is an 'Integral' literal.</span></span><span>
</span><span id="line-439"></span><span id="getLHsIntegralLit"><span class="annot"><span class="annottext">getLHsIntegralLit :: LHsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsIntegralLit"><span class="hs-identifier hs-var hs-var">getLHsIntegralLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127410"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683127410"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="#local-6989586621683127411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683127410"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621683127411"><span class="annot"><span class="annottext">go :: HsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="#local-6989586621683127411"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127413"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127413"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsIntegralLit"><span class="hs-identifier hs-var">getLHsIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127413"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="#local-6989586621683127411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">XOverLitE GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127415"><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127415"><span class="hs-identifier hs-var">over_lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getIntegralLit"><span class="hs-identifier hs-var">getIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127415"><span class="hs-identifier hs-var">over_lit</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><a href="#local-6989586621683127411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><span class="annottext">XLitE GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127417"><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127417"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127417"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-comment">-- Remember to look through automatically-added tick-boxes! (#8384)</span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><a href="#local-6989586621683127411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsTick"><span class="hs-identifier hs-type">HsTick</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127420"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127420"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsIntegralLit"><span class="hs-identifier hs-var">getLHsIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127420"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><a href="#local-6989586621683127411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsBinTick"><span class="hs-identifier hs-type">HsBinTick</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127422"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127422"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsIntegralLit"><span class="hs-identifier hs-var">getLHsIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127422"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-comment">-- The literal might be wrapped in a case with -XOverloadedLists</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><a href="#local-6989586621683127411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#WrapExpr"><span class="hs-identifier hs-type">WrapExpr</span></a></span><span> </span><span class="annot"><span class="annottext">HsWrapper
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127424"><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683127424"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc -&gt; Maybe (Integer, Type)
</span><a href="#local-6989586621683127411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><a href="#local-6989586621683127424"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><a href="#local-6989586621683127411"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | If 'Integral', extract the value and type of the overloaded literal.</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- See Note [Literals and the OverloadedLists extension]</span><span>
</span><span id="line-455"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getIntegralLit"><span class="hs-identifier hs-type">getIntegralLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span id="getIntegralLit"><span class="annot"><span class="annottext">getIntegralLit :: HsOverLit GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getIntegralLit"><span class="hs-identifier hs-var hs-var">getIntegralLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#OverLit"><span class="hs-identifier hs-type">OverLit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ol_val :: forall p. HsOverLit p -&gt; OverLitVal
</span><a href="Language.Haskell.Syntax.Lit.html#ol_val"><span class="hs-identifier hs-var">ol_val</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIntegral"><span class="hs-identifier hs-type">HsIntegral</span></a></span><span> </span><span id="local-6989586621683127426"><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683127426"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ol_ext :: forall p. HsOverLit p -&gt; XOverLit p
</span><a href="Language.Haskell.Syntax.Lit.html#ol_ext"><span class="hs-identifier hs-var">ol_ext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Hs.Lit.html#OverLitTc"><span class="hs-identifier hs-type">OverLitTc</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ol_type :: OverLitTc -&gt; Type
</span><a href="GHC.Hs.Lit.html#ol_type"><span class="hs-identifier hs-var">ol_type</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683127428"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127428"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntegralLit -&gt; Integer
</span><a href="GHC.Types.SourceText.html#il_value"><span class="hs-identifier hs-var">il_value</span></a></span><span> </span><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683127426"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127428"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getIntegralLit"><span class="hs-identifier hs-var">getIntegralLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="annot"><span class="hs-comment">-- | If 'Integral', extract the value and type of the non-overloaded literal.</span></span><span>
</span><span id="line-461"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-type">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span id="getSimpleIntegralLit"><span class="annot"><span class="annottext">getSimpleIntegralLit :: HsLit GhcTc -&gt; Maybe (Integer, Type)
</span><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var hs-var">getSimpleIntegralLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt"><span class="hs-identifier hs-type">HsInt</span></a></span><span> </span><span class="annot"><span class="annottext">XHsInt GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="GHC.Types.SourceText.html#IL"><span class="hs-identifier hs-type">IL</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">il_value :: IntegralLit -&gt; Integer
</span><a href="GHC.Types.SourceText.html#il_value"><span class="hs-identifier hs-var">il_value</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683127430"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127430"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127430"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#intTy"><span class="hs-identifier hs-var">intTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIntPrim"><span class="hs-identifier hs-type">HsIntPrim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsIntPrim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127432"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127432"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127432"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWordPrim"><span class="hs-identifier hs-type">HsWordPrim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWordPrim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127434"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127434"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127434"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#wordPrimTy"><span class="hs-identifier hs-var">wordPrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt8Prim"><span class="hs-identifier hs-type">HsInt8Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsInt8Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127436"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127436"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127436"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#int8PrimTy"><span class="hs-identifier hs-var">int8PrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt16Prim"><span class="hs-identifier hs-type">HsInt16Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsInt16Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127438"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127438"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127438"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#int16PrimTy"><span class="hs-identifier hs-var">int16PrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt32Prim"><span class="hs-identifier hs-type">HsInt32Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsInt32Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127440"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127440"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127440"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#int32PrimTy"><span class="hs-identifier hs-var">int32PrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt64Prim"><span class="hs-identifier hs-type">HsInt64Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsInt64Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127442"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127442"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127442"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#int64PrimTy"><span class="hs-identifier hs-var">int64PrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord8Prim"><span class="hs-identifier hs-type">HsWord8Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord8Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127444"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127444"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127444"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#word8PrimTy"><span class="hs-identifier hs-var">word8PrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord16Prim"><span class="hs-identifier hs-type">HsWord16Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord16Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127446"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127446"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127446"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#word16PrimTy"><span class="hs-identifier hs-var">word16PrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord32Prim"><span class="hs-identifier hs-type">HsWord32Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord32Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127448"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127448"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127448"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#word32PrimTy"><span class="hs-identifier hs-var">word32PrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord64Prim"><span class="hs-identifier hs-type">HsWord64Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord64Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127450"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127450"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127450"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#word64PrimTy"><span class="hs-identifier hs-var">word64PrimTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInteger"><span class="hs-identifier hs-type">HsInteger</span></a></span><span> </span><span class="annot"><span class="annottext">XHsInteger GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127452"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127452"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621683127453"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127453"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Type) -&gt; Maybe (Integer, Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127452"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127453"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsChar"><span class="hs-identifier hs-type">HsChar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-476"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsCharPrim"><span class="hs-identifier hs-type">HsCharPrim</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-477"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsString"><span class="hs-identifier hs-type">HsString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-478"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsMultilineString"><span class="hs-identifier hs-type">HsMultilineString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-479"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsStringPrim"><span class="hs-identifier hs-type">HsStringPrim</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-480"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsRat"><span class="hs-identifier hs-type">HsRat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-481"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsFloatPrim"><span class="hs-identifier hs-type">HsFloatPrim</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-482"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getSimpleIntegralLit"><span class="hs-identifier hs-var">getSimpleIntegralLit</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsDoublePrim"><span class="hs-identifier hs-type">HsDoublePrim</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="annot"><span class="hs-comment">-- | Extract the Char if the expression is a Char literal.</span></span><span>
</span><span id="line-485"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-type">getLHsCharLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#LHsExpr"><span class="hs-identifier hs-type">LHsExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-486"></span><span id="getLHsCharLit"><span class="annot"><span class="annottext">getLHsCharLit :: LHsExpr GhcTc -&gt; Maybe Char
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var hs-var">getLHsCharLit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsPar"><span class="hs-identifier hs-type">HsPar</span></a></span><span> </span><span class="annot"><span class="annottext">XPar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127454"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127454"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe Char
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127454"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-487"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><span class="annottext">XLitE GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsChar"><span class="hs-identifier hs-type">HsChar</span></a></span><span> </span><span class="annot"><span class="annottext">XHsChar GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127455"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127455"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127455"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-488"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsTick"><span class="hs-identifier hs-type">HsTick</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127456"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127456"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe Char
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127456"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-489"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#XExpr"><span class="hs-identifier hs-type">XExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Expr.html#HsBinTick"><span class="hs-identifier hs-type">HsBinTick</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127457"><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127457"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc -&gt; Maybe Char
</span><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><a href="#local-6989586621683127457"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-490"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getLHsCharLit"><span class="hs-identifier hs-var">getLHsCharLit</span></a></span><span> </span><span class="annot"><span class="annottext">LHsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Char
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">-- | Convert a pair (Integer, Type) to (Integer, Name) after eventually</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- normalising the type</span><span>
</span><span id="line-494"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getNormalisedTyconName"><span class="hs-identifier hs-type">getNormalisedTyconName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span id="getNormalisedTyconName"><span class="annot"><span class="annottext">getNormalisedTyconName :: FamInstEnvs -&gt; (Integer, Type) -&gt; Maybe (Integer, Name)
</span><a href="GHC.HsToCore.Match.Literal.html#getNormalisedTyconName"><span class="hs-identifier hs-var hs-var">getNormalisedTyconName</span></a></span></span><span> </span><span id="local-6989586621683127458"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683127458"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127459"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127459"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683127460"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127460"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127461"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683127461"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FamInstEnvs -&gt; Type -&gt; Type
</span><a href="#local-6989586621683127463"><span class="hs-identifier hs-var">normaliseNominal</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683127458"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127460"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Name) -&gt; Maybe (Integer, Name)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127459"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683127461"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Name)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><a href="#local-6989586621683127463"><span class="hs-identifier hs-type">normaliseNominal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.FamInstEnv.html#FamInstEnvs"><span class="hs-identifier hs-type">FamInstEnvs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-501"></span><span>    </span><span id="local-6989586621683127463"><span class="annot"><span class="annottext">normaliseNominal :: FamInstEnvs -&gt; Type -&gt; Type
</span><a href="#local-6989586621683127463"><span class="hs-identifier hs-var hs-var">normaliseNominal</span></a></span></span><span> </span><span id="local-6989586621683127465"><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683127465"><span class="hs-identifier hs-var">fam_envs</span></a></span></span><span> </span><span id="local-6989586621683127466"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127466"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-502"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reduction -&gt; Type
</span><a href="GHC.Core.Reduction.html#reductionReducedType"><span class="hs-identifier hs-var">reductionReducedType</span></a></span><span>
</span><span id="line-503"></span><span>      </span><span class="annot"><span class="annottext">(Reduction -&gt; Type) -&gt; Reduction -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs -&gt; Role -&gt; Type -&gt; Reduction
</span><a href="GHC.Core.FamInstEnv.html#normaliseType"><span class="hs-identifier hs-var">normaliseType</span></a></span><span> </span><span class="annot"><span class="annottext">FamInstEnvs
</span><a href="#local-6989586621683127465"><span class="hs-identifier hs-var">fam_envs</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Language.Haskell.Syntax.Basic.html#Nominal"><span class="hs-identifier hs-var">Nominal</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127466"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-comment">-- | Convert a pair (Integer, Type) to (Integer, Name) without normalising</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- the type</span><span>
</span><span id="line-507"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#getTyconName"><span class="hs-identifier hs-type">getTyconName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span id="getTyconName"><span class="annot"><span class="annottext">getTyconName :: (Integer, Type) -&gt; Maybe (Integer, Name)
</span><a href="GHC.HsToCore.Match.Literal.html#getTyconName"><span class="hs-identifier hs-var hs-var">getTyconName</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127469"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127469"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621683127470"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127470"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127471"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683127471"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon_maybe"><span class="hs-identifier hs-var">tyConAppTyCon_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127470"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer, Name) -&gt; Maybe (Integer, Name)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127469"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Name
</span><a href="GHC.Core.TyCon.html#tyConName"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621683127471"><span class="hs-identifier hs-var">tc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Name)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">{-
Note [Literals and the OverloadedLists extension]
~~~~
Consider the Literal `[256] :: [Data.Word.Word8]`

When the `OverloadedLists` extension is not active, then the `ol_ext` field
in the `OverLitTc` record that is passed to the function `getIntegralLit`
contains the type `Word8`. This is a simple type, and we can use its
type constructor immediately for the `warnAboutOverflowedLiterals` function.

When the `OverloadedLists` extension is active, then the `ol_ext` field
contains the type family `Item [Word8]`. The function `nomaliseType` is used
to convert it to the needed type `Word8`.
-}</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
        Tidying lit pats
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#tidyLitPat"><span class="hs-identifier hs-type">tidyLitPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- Result has only the following HsLits:</span><span>
</span><span id="line-537"></span><span class="hs-comment">--      HsIntPrim, HsWordPrim, HsCharPrim, HsString</span><span>
</span><span id="line-538"></span><span class="hs-comment">--  * HsInteger, HsRat, HsInt, as well as HsStringPrim,</span><span>
</span><span id="line-539"></span><span class="hs-comment">--    HsFloatPrim and HsDoublePrim can't show up in LitPats</span><span>
</span><span id="line-540"></span><span class="hs-comment">--  * We get rid of HsChar right here</span><span>
</span><span id="line-541"></span><span id="tidyLitPat"><span class="annot"><span class="annottext">tidyLitPat :: HsLit GhcTc -&gt; Pat GhcTc
</span><a href="GHC.HsToCore.Match.Literal.html#tidyLitPat"><span class="hs-identifier hs-var hs-var">tidyLitPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsChar"><span class="hs-identifier hs-type">HsChar</span></a></span><span> </span><span id="local-6989586621683127472"><span class="annot"><span class="annottext">XHsChar GhcTc
</span><a href="#local-6989586621683127472"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621683127473"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127473"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcTc) -&gt; Pat GhcTc
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceText -&gt; Char -&gt; LPat GhcTc
</span><a href="GHC.Hs.Pat.html#mkCharLitPat"><span class="hs-identifier hs-var">mkCharLitPat</span></a></span><span> </span><span class="annot"><span class="annottext">XHsChar GhcTc
SourceText
</span><a href="#local-6989586621683127472"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127473"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#tidyLitPat"><span class="hs-identifier hs-var">tidyLitPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsString"><span class="hs-identifier hs-type">HsString</span></a></span><span> </span><span id="local-6989586621683127476"><span class="annot"><span class="annottext">XHsString GhcTc
</span><a href="#local-6989586621683127476"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621683127477"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127477"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Int
</span><a href="GHC.Data.FastString.html#lengthFS"><span class="hs-identifier hs-var">lengthFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127477"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>     </span><span class="hs-comment">-- Short string literals only</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcTc) -&gt; Pat GhcTc
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (Pat GhcTc) -&gt; Pat GhcTc)
-&gt; GenLocated SrcSpanAnnA (Pat GhcTc) -&gt; Pat GhcTc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char
 -&gt; GenLocated SrcSpanAnnA (Pat GhcTc)
 -&gt; GenLocated SrcSpanAnnA (Pat GhcTc))
-&gt; GenLocated SrcSpanAnnA (Pat GhcTc)
-&gt; String
-&gt; GenLocated SrcSpanAnnA (Pat GhcTc)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621683127480"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127480"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621683127481"><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683127481"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; [LPat GhcTc] -&gt; [Type] -&gt; LPat GhcTc
</span><a href="GHC.Hs.Pat.html#mkPrefixConPat"><span class="hs-identifier hs-var">mkPrefixConPat</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#consDataCon"><span class="hs-identifier hs-var">consDataCon</span></a></span><span>
</span><span id="line-545"></span><span>                                             </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SourceText -&gt; Char -&gt; LPat GhcTc
</span><a href="GHC.Hs.Pat.html#mkCharLitPat"><span class="hs-identifier hs-var">mkCharLitPat</span></a></span><span> </span><span class="annot"><span class="annottext">XHsString GhcTc
SourceText
</span><a href="#local-6989586621683127476"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127480"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LPat GhcTc
GenLocated SrcSpanAnnA (Pat GhcTc)
</span><a href="#local-6989586621683127481"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#charTy"><span class="hs-identifier hs-var">charTy</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; LPat GhcTc
</span><a href="GHC.Hs.Pat.html#mkNilPat"><span class="hs-identifier hs-var">mkNilPat</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#charTy"><span class="hs-identifier hs-var">charTy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; String
</span><a href="GHC.Data.FastString.html#unpackFS"><span class="hs-identifier hs-var">unpackFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127477"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>        </span><span class="hs-comment">-- The stringTy is the type of the whole pattern, not</span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-comment">-- the type to instantiate (:) or [] with!</span><span>
</span><span id="line-549"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#tidyLitPat"><span class="hs-identifier hs-var">tidyLitPat</span></a></span><span> </span><span id="local-6989586621683127487"><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127487"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XLitPat GhcTc -&gt; HsLit GhcTc -&gt; Pat GhcTc
forall p. XLitPat p -&gt; HsLit p -&gt; Pat p
</span><a href="Language.Haskell.Syntax.Pat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a></span><span> </span><span class="annot"><span class="annottext">XLitPat GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127487"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">----------------</span><span>
</span><span id="line-552"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#tidyNPat"><span class="hs-identifier hs-type">tidyNPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsOverLit"><span class="hs-identifier hs-type">HsOverLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Expr.html#SyntaxExpr"><span class="hs-identifier hs-type">SyntaxExpr</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-553"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-554"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-555"></span><span id="tidyNPat"><span class="annot"><span class="annottext">tidyNPat :: HsOverLit GhcTc
-&gt; Maybe (SyntaxExpr GhcTc)
-&gt; SyntaxExpr GhcTc
-&gt; Type
-&gt; Pat GhcTc
</span><a href="GHC.HsToCore.Match.Literal.html#tidyNPat"><span class="hs-identifier hs-var hs-var">tidyNPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#OverLit"><span class="hs-identifier hs-type">OverLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Hs.Lit.html#OverLitTc"><span class="hs-identifier hs-type">OverLitTc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127490"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127490"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683127491"><span class="annot"><span class="annottext">OverLitVal
</span><a href="#local-6989586621683127491"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683127492"><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><a href="#local-6989586621683127492"><span class="hs-identifier hs-var">mb_neg</span></a></span></span><span> </span><span id="local-6989586621683127493"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683127493"><span class="hs-identifier hs-var">_eq</span></a></span></span><span> </span><span id="local-6989586621683127494"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127494"><span class="hs-identifier hs-var">outer_ty</span></a></span></span><span>
</span><span id="line-556"></span><span>        </span><span class="hs-comment">-- False: Take short cuts only if the literal is not using rebindable syntax</span><span>
</span><span id="line-557"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-558"></span><span>        </span><span class="hs-comment">-- Once that is settled, look for cases where the type of the</span><span>
</span><span id="line-559"></span><span>        </span><span class="hs-comment">-- entire overloaded literal matches the type of the underlying literal,</span><span>
</span><span id="line-560"></span><span>        </span><span class="hs-comment">-- and in that case take the short cut</span><span>
</span><span id="line-561"></span><span>        </span><span class="hs-comment">-- NB: Watch out for weird cases like #3382</span><span>
</span><span id="line-562"></span><span>        </span><span class="hs-comment">--        f :: Int -&gt; Int</span><span>
</span><span id="line-563"></span><span>        </span><span class="hs-comment">--        f &quot;blah&quot; = 4</span><span>
</span><span id="line-564"></span><span>        </span><span class="hs-comment">--     which might be ok if we have 'instance IsString Int'</span><span>
</span><span id="line-565"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683127495"><span class="hs-identifier hs-var">type_change</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isIntTy"><span class="hs-identifier hs-var">isIntTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127490"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127497"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127497"><span class="hs-identifier hs-var">int_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621683127498"><span class="hs-identifier hs-var">mb_int_lit</span></a></span><span>
</span><span id="line-567"></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; HsLit GhcTc -&gt; Pat GhcTc
</span><a href="#local-6989586621683127499"><span class="hs-identifier hs-var">mk_con_pat</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#intDataCon"><span class="hs-identifier hs-var">intDataCon</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XHsIntPrim GhcTc -&gt; Integer -&gt; HsLit GhcTc
forall x. XHsIntPrim x -&gt; Integer -&gt; HsLit x
</span><a href="Language.Haskell.Syntax.Lit.html#HsIntPrim"><span class="hs-identifier hs-var">HsIntPrim</span></a></span><span>    </span><span class="annot"><span class="annottext">XHsIntPrim GhcTc
SourceText
</span><a href="GHC.Types.SourceText.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127497"><span class="hs-identifier hs-var">int_lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683127495"><span class="hs-identifier hs-var">type_change</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isWordTy"><span class="hs-identifier hs-var">isWordTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127490"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127503"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127503"><span class="hs-identifier hs-var">int_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621683127498"><span class="hs-identifier hs-var">mb_int_lit</span></a></span><span>
</span><span id="line-569"></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; HsLit GhcTc -&gt; Pat GhcTc
</span><a href="#local-6989586621683127499"><span class="hs-identifier hs-var">mk_con_pat</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="GHC.Builtin.Types.html#wordDataCon"><span class="hs-identifier hs-var">wordDataCon</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XHsWordPrim GhcTc -&gt; Integer -&gt; HsLit GhcTc
forall x. XHsWordPrim x -&gt; Integer -&gt; HsLit x
</span><a href="Language.Haskell.Syntax.Lit.html#HsWordPrim"><span class="hs-identifier hs-var">HsWordPrim</span></a></span><span>   </span><span class="annot"><span class="annottext">XHsWordPrim GhcTc
SourceText
</span><a href="GHC.Types.SourceText.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127503"><span class="hs-identifier hs-var">int_lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621683127495"><span class="hs-identifier hs-var">type_change</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Bool
</span><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier hs-var">isStringTy</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127490"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127506"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127506"><span class="hs-identifier hs-var">str_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe FastString
</span><a href="#local-6989586621683127507"><span class="hs-identifier hs-var">mb_str_lit</span></a></span><span>
</span><span id="line-571"></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc -&gt; Pat GhcTc
</span><a href="GHC.HsToCore.Match.Literal.html#tidyLitPat"><span class="hs-identifier hs-var">tidyLitPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XHsString GhcTc -&gt; FastString -&gt; HsLit GhcTc
forall x. XHsString x -&gt; FastString -&gt; HsLit x
</span><a href="Language.Haskell.Syntax.Lit.html#HsString"><span class="hs-identifier hs-var">HsString</span></a></span><span> </span><span class="annot"><span class="annottext">XHsString GhcTc
SourceText
</span><a href="GHC.Types.SourceText.html#NoSourceText"><span class="hs-identifier hs-var">NoSourceText</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127506"><span class="hs-identifier hs-var">str_lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>     </span><span class="hs-comment">-- NB: do /not/ convert Float or Double literals to F# 3.8 or D# 5.3</span><span>
</span><span id="line-573"></span><span>     </span><span class="hs-comment">-- If we do convert to the constructor form, we'll generate a case</span><span>
</span><span id="line-574"></span><span>     </span><span class="hs-comment">-- expression on a Float# or Double# and that's not allowed in Core; see</span><span>
</span><span id="line-575"></span><span>     </span><span class="hs-comment">-- #9238 and Note [Rules for floating-point comparisons] in GHC.Core.Opt.ConstantFold</span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-577"></span><span>    </span><span class="hs-comment">-- Sometimes (like in test case</span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-comment">-- overloadedlists/should_run/overloadedlistsrun04), the SyntaxExprs include</span><span>
</span><span id="line-579"></span><span>    </span><span class="hs-comment">-- type-changing wrappers (for example, from Id Int to Int, for the identity</span><span>
</span><span id="line-580"></span><span>    </span><span class="hs-comment">-- type family Id). In these cases, we can't do the short-cut.</span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621683127495"><span class="annot"><span class="annottext">type_change :: Bool
</span><a href="#local-6989586621683127495"><span class="hs-identifier hs-var hs-var">type_change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127494"><span class="hs-identifier hs-var">outer_ty</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127490"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><a href="#local-6989586621683127499"><span class="hs-identifier hs-type">mk_con_pat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#Pat"><span class="hs-identifier hs-type">Pat</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span>
</span><span id="line-584"></span><span>    </span><span id="local-6989586621683127499"><span class="annot"><span class="annottext">mk_con_pat :: DataCon -&gt; HsLit GhcTc -&gt; Pat GhcTc
</span><a href="#local-6989586621683127499"><span class="hs-identifier hs-var hs-var">mk_con_pat</span></a></span></span><span> </span><span id="local-6989586621683127508"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683127508"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621683127509"><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127509"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-585"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcTc) -&gt; Pat GhcTc
forall l e. GenLocated l e -&gt; e
</span><a href="GHC.Types.SrcLoc.html#unLoc"><span class="hs-identifier hs-var">unLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; [LPat GhcTc] -&gt; [Type] -&gt; LPat GhcTc
</span><a href="GHC.Hs.Pat.html#mkPrefixConPat"><span class="hs-identifier hs-var">mkPrefixConPat</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621683127508"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pat GhcTc -&gt; GenLocated SrcSpanAnnA (Pat GhcTc)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">(Pat GhcTc -&gt; GenLocated SrcSpanAnnA (Pat GhcTc))
-&gt; Pat GhcTc -&gt; GenLocated SrcSpanAnnA (Pat GhcTc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XLitPat GhcTc -&gt; HsLit GhcTc -&gt; Pat GhcTc
forall p. XLitPat p -&gt; HsLit p -&gt; Pat p
</span><a href="Language.Haskell.Syntax.Pat.html#LitPat"><span class="hs-identifier hs-var">LitPat</span></a></span><span> </span><span class="annot"><span class="annottext">XLitPat GhcTc
NoExtField
</span><a href="Language.Haskell.Syntax.Extension.html#noExtField"><span class="hs-identifier hs-var">noExtField</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127509"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><a href="#local-6989586621683127498"><span class="hs-identifier hs-type">mb_int_lit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621683127498"><span class="annot"><span class="annottext">mb_int_lit :: Maybe Integer
</span><a href="#local-6989586621683127498"><span class="hs-identifier hs-var hs-var">mb_int_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
Maybe SyntaxExprTc
</span><a href="#local-6989586621683127492"><span class="hs-identifier hs-var">mb_neg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OverLitVal
</span><a href="#local-6989586621683127491"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-589"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe SyntaxExprTc
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIntegral"><span class="hs-identifier hs-type">HsIntegral</span></a></span><span> </span><span id="local-6989586621683127511"><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683127511"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntegralLit -&gt; Integer
</span><a href="GHC.Types.SourceText.html#il_value"><span class="hs-identifier hs-var">il_value</span></a></span><span> </span><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683127511"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExprTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span>  </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIntegral"><span class="hs-identifier hs-type">HsIntegral</span></a></span><span> </span><span id="local-6989586621683127512"><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683127512"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">IntegralLit -&gt; Integer
</span><a href="GHC.Types.SourceText.html#il_value"><span class="hs-identifier hs-var">il_value</span></a></span><span> </span><span class="annot"><span class="annottext">IntegralLit
</span><a href="#local-6989586621683127512"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>                   </span><span class="annot"><span class="annottext">(Maybe SyntaxExprTc, OverLitVal)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><a href="#local-6989586621683127507"><span class="hs-identifier hs-type">mb_str_lit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Data.FastString.html#FastString"><span class="hs-identifier hs-type">FastString</span></a></span><span>
</span><span id="line-594"></span><span>    </span><span id="local-6989586621683127507"><span class="annot"><span class="annottext">mb_str_lit :: Maybe FastString
</span><a href="#local-6989586621683127507"><span class="hs-identifier hs-var hs-var">mb_str_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
Maybe SyntaxExprTc
</span><a href="#local-6989586621683127492"><span class="hs-identifier hs-var">mb_neg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OverLitVal
</span><a href="#local-6989586621683127491"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-595"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe SyntaxExprTc
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIsString"><span class="hs-identifier hs-type">HsIsString</span></a></span><span> </span><span class="annot"><span class="annottext">SourceText
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127514"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127514"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Maybe FastString
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127514"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-596"></span><span>                   </span><span class="annot"><span class="annottext">(Maybe SyntaxExprTc, OverLitVal)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe FastString
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#tidyNPat"><span class="hs-identifier hs-var">tidyNPat</span></a></span><span> </span><span id="local-6989586621683127515"><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127515"><span class="hs-identifier hs-var">over_lit</span></a></span></span><span> </span><span id="local-6989586621683127516"><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><a href="#local-6989586621683127516"><span class="hs-identifier hs-var">mb_neg</span></a></span></span><span> </span><span id="local-6989586621683127517"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683127517"><span class="hs-identifier hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621683127518"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127518"><span class="hs-identifier hs-var">outer_ty</span></a></span></span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XNPat GhcTc
-&gt; XRec GhcTc (HsOverLit GhcTc)
-&gt; Maybe (SyntaxExpr GhcTc)
-&gt; SyntaxExpr GhcTc
-&gt; Pat GhcTc
forall p.
XNPat p
-&gt; XRec p (HsOverLit p)
-&gt; Maybe (SyntaxExpr p)
-&gt; SyntaxExpr p
-&gt; Pat p
</span><a href="Language.Haskell.Syntax.Pat.html#NPat"><span class="hs-identifier hs-var">NPat</span></a></span><span> </span><span class="annot"><span class="annottext">XNPat GhcTc
Type
</span><a href="#local-6989586621683127518"><span class="hs-identifier hs-var">outer_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsOverLit GhcTc -&gt; GenLocated EpAnnCO (HsOverLit GhcTc)
forall e a. HasAnnotation e =&gt; a -&gt; GenLocated e a
</span><a href="GHC.Parser.Annotation.html#noLocA"><span class="hs-identifier hs-var">noLocA</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127515"><span class="hs-identifier hs-var">over_lit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><a href="#local-6989586621683127516"><span class="hs-identifier hs-var">mb_neg</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683127517"><span class="hs-identifier hs-var">eq</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Pattern matching on LitPat
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#matchLiterals"><span class="hs-identifier hs-type">matchLiterals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-610"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Type of the whole case expression</span></span><span>
</span><span id="line-611"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#EquationInfoNE"><span class="hs-identifier hs-type">EquationInfoNE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ All PgLits</span></span><span>
</span><span id="line-612"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Monad.html#MatchResult"><span class="hs-identifier hs-type">MatchResult</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span id="matchLiterals"><span class="annot"><span class="annottext">matchLiterals :: NonEmpty Id
-&gt; Type
-&gt; NonEmpty (NonEmpty EquationInfoNE)
-&gt; DsM (MatchResult CoreExpr)
</span><a href="GHC.HsToCore.Match.Literal.html#matchLiterals"><span class="hs-identifier hs-var hs-var">matchLiterals</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127520"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127520"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621683127522"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683127522"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683127523"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127523"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621683127524"><span class="annot"><span class="annottext">NonEmpty (NonEmpty EquationInfoNE)
</span><a href="#local-6989586621683127524"><span class="hs-identifier hs-var">sub_groups</span></a></span></span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span>       </span><span class="hs-comment">-- Deal with each group</span><span>
</span><span id="line-616"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127525"><span class="annot"><a href="#local-6989586621683127525"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(NonEmpty EquationInfoNE
 -&gt; IOEnv (Env DsGblEnv DsLclEnv) (Literal, MatchResult CoreExpr))
-&gt; NonEmpty (NonEmpty EquationInfoNE)
-&gt; IOEnv
     (Env DsGblEnv DsLclEnv) (NonEmpty (Literal, MatchResult CoreExpr))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty EquationInfoNE
-&gt; IOEnv (Env DsGblEnv DsLclEnv) (Literal, MatchResult CoreExpr)
</span><a href="#local-6989586621683127527"><span class="hs-identifier hs-var">match_group</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (NonEmpty EquationInfoNE)
</span><a href="#local-6989586621683127524"><span class="hs-identifier hs-var">sub_groups</span></a></span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span>                </span><span class="hs-comment">-- Combine results.  For everything except String</span><span>
</span><span id="line-619"></span><span>                </span><span class="hs-comment">-- we can use a case expression; for String we need</span><span>
</span><span id="line-620"></span><span>                </span><span class="hs-comment">-- a chain of if-then-else</span><span>
</span><span id="line-621"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Tc.Utils.TcType.html#isStringTy"><span class="hs-identifier hs-type">isStringTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-type">idType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127520"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-622"></span><span>            </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683127529"><span class="annot"><a href="#local-6989586621683127529"><span class="hs-identifier hs-var">eq_str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#dsLookupGlobalId"><span class="hs-identifier hs-type">dsLookupGlobalId</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html#eqStringName"><span class="hs-identifier hs-type">eqStringName</span></a></span><span>
</span><span id="line-623"></span><span>                </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127531"><span class="annot"><a href="#local-6989586621683127531"><span class="hs-identifier hs-var">mrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683127532"><span class="hs-identifier hs-type">wrap_str_guard</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127529"><span class="hs-identifier hs-type">eq_str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621683127525"><span class="hs-identifier hs-type">alts</span></a></span><span>
</span><span id="line-624"></span><span>                </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">foldr1</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html#combineMatchResults"><span class="hs-identifier hs-type">combineMatchResults</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127531"><span class="hs-identifier hs-type">mrs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-625"></span><span>          </span><span class="hs-keyword">else</span><span>
</span><span id="line-626"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Utils.html#mkCoPrimCaseMatchResult"><span class="hs-identifier hs-type">mkCoPrimCaseMatchResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127520"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127523"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#toList"><span class="hs-identifier hs-type">NEL.toList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127525"><span class="hs-identifier hs-type">alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><a href="#local-6989586621683127527"><span class="hs-identifier hs-type">match_group</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#EquationInfoNE"><span class="hs-identifier hs-type">EquationInfoNE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#MatchResult"><span class="hs-identifier hs-type">MatchResult</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>    </span><span id="local-6989586621683127527"><span class="annot"><span class="annottext">match_group :: NonEmpty EquationInfoNE
-&gt; IOEnv (Env DsGblEnv DsLclEnv) (Literal, MatchResult CoreExpr)
</span><a href="#local-6989586621683127527"><span class="hs-identifier hs-var hs-var">match_group</span></a></span></span><span> </span><span id="local-6989586621683127537"><span class="annot"><span class="annottext">NonEmpty EquationInfoNE
</span><a href="#local-6989586621683127537"><span class="hs-identifier hs-var">eqns</span></a></span></span><span>
</span><span id="line-631"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621683127538"><span class="annot"><a href="#local-6989586621683127538"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IOEnv (Env DsGblEnv DsLclEnv) DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><a href="GHC.Driver.DynFlags.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-632"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127539"><span class="annot"><a href="#local-6989586621683127539"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Platform
</span><a href="GHC.Driver.DynFlags.html#targetPlatform"><span class="hs-identifier hs-var">targetPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621683127538"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-633"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#EqnMatch"><span class="hs-identifier hs-type">EqnMatch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#eqn_pat"><span class="hs-identifier hs-var">eqn_pat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#LitPat"><span class="hs-identifier hs-type">LitPat</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127542"><span class="annot"><a href="#local-6989586621683127542"><span class="hs-identifier hs-var">hs_lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#head"><span class="hs-identifier hs-type">NEL.head</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127537"><span class="hs-identifier hs-type">eqns</span></a></span><span>
</span><span id="line-634"></span><span>             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127544"><span class="annot"><a href="#local-6989586621683127544"><span class="hs-identifier hs-var">match_result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#match"><span class="hs-identifier hs-type">match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127522"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127523"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.List.NonEmpty.html#toList"><span class="hs-identifier hs-type">NEL.toList</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Utils.html#shiftEqns"><span class="hs-identifier hs-type">shiftEqns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127537"><span class="hs-identifier hs-type">eqns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-type">hsLitKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127539"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127542"><span class="hs-identifier hs-type">hs_lit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127544"><span class="hs-identifier hs-type">match_result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><a href="#local-6989586621683127532"><span class="hs-identifier hs-type">wrap_str_guard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.HsToCore.Monad.html#MatchResult"><span class="hs-identifier hs-type">MatchResult</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Monad.html#MatchResult"><span class="hs-identifier hs-type">MatchResult</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>        </span><span class="hs-comment">-- Equality check for string literals</span><span>
</span><span id="line-639"></span><span>    </span><span id="local-6989586621683127532"><span class="annot"><span class="annottext">wrap_str_guard :: Id -&gt; (Literal, MatchResult CoreExpr) -&gt; DsM (MatchResult CoreExpr)
</span><a href="#local-6989586621683127532"><span class="hs-identifier hs-var hs-var">wrap_str_guard</span></a></span></span><span> </span><span id="local-6989586621683127546"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127546"><span class="hs-identifier hs-var">eq_str</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621683127547"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621683127547"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683127548"><span class="annot"><span class="annottext">MatchResult CoreExpr
</span><a href="#local-6989586621683127548"><span class="hs-identifier hs-var">mr</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- We now have to convert back to FastString. Perhaps there</span><span>
</span><span id="line-641"></span><span>               </span><span class="hs-comment">-- should be separate LitBytes and LitString constructors?</span><span>
</span><span id="line-642"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127549"><span class="annot"><span class="annottext">s' :: FastString
</span><a href="#local-6989586621683127549"><span class="hs-identifier hs-var hs-var hs-var">s'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; FastString
</span><a href="GHC.Data.FastString.html#mkFastStringByteString"><span class="hs-identifier hs-var">mkFastStringByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621683127547"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-643"></span><span>             </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127551"><span class="annot"><a href="#local-6989586621683127551"><span class="hs-identifier hs-var">lit</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; DsM CoreExpr
forall (m :: * -&gt; *). MonadThings m =&gt; FastString -&gt; m CoreExpr
</span><a href="GHC.Core.Make.html#mkStringExprFS"><span class="hs-identifier hs-var">mkStringExprFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127549"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-644"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621683127552"><span class="annot"><a href="#local-6989586621683127552"><span class="hs-identifier hs-var hs-var">pred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; CoreExpr
forall b. Expr b -&gt; [Expr b] -&gt; Expr b
</span><a href="GHC.Core.html#mkApps"><span class="hs-identifier hs-var">mkApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127546"><span class="hs-identifier hs-var">eq_str</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127520"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683127551"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-645"></span><span>             </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Utils.html#mkGuardedMatchResult"><span class="hs-identifier hs-type">mkGuardedMatchResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127552"><span class="hs-identifier hs-type">pred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127548"><span class="hs-identifier hs-type">mr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-646"></span><span>    </span><span class="annot"><a href="#local-6989586621683127532"><span class="hs-identifier hs-var">wrap_str_guard</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127555"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621683127555"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MatchResult CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; DsM (MatchResult CoreExpr)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;matchLiterals/wrap_str_guard&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621683127555"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span class="hs-comment">---------------------------</span><span>
</span><span id="line-650"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-type">hsLitKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsLit"><span class="hs-identifier hs-type">HsLit</span></a></span><span> </span><span class="annot"><a href="GHC.Hs.Extension.html#GhcTc"><span class="hs-identifier hs-type">GhcTc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-651"></span><span class="hs-comment">-- Get the Core literal corresponding to a HsLit.</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- It only works for primitive types and strings;</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- others have been removed by tidy</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- For HsString, it produces a LitString, which really represents an _unboxed_</span><span>
</span><span id="line-655"></span><span class="hs-comment">-- string literal; and we deal with it in matchLiterals above. Otherwise, it</span><span>
</span><span id="line-656"></span><span class="hs-comment">-- produces a primitive Literal of type matching the original HsLit.</span><span>
</span><span id="line-657"></span><span class="hs-comment">-- In the case of the fixed-width numeric types, we need to wrap here</span><span>
</span><span id="line-658"></span><span class="hs-comment">-- because Literal has an invariant that the literal is in range, while</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- HsLit does not.</span><span>
</span><span id="line-660"></span><span id="hsLitKey"><span class="annot"><span class="annottext">hsLitKey :: Platform -&gt; HsLit GhcTc -&gt; Literal
</span><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var hs-var">hsLitKey</span></a></span></span><span> </span><span id="local-6989586621683127556"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127556"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsIntPrim"><span class="hs-identifier hs-type">HsIntPrim</span></a></span><span>    </span><span class="annot"><span class="annottext">XHsIntPrim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127557"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127557"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitIntWrap"><span class="hs-identifier hs-var">mkLitIntWrap</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127556"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127557"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-661"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span id="local-6989586621683127558"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127558"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWordPrim"><span class="hs-identifier hs-type">HsWordPrim</span></a></span><span>   </span><span class="annot"><span class="annottext">XHsWordPrim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127559"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127559"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWordWrap"><span class="hs-identifier hs-var">mkLitWordWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621683127558"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127559"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-662"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt8Prim"><span class="hs-identifier hs-type">HsInt8Prim</span></a></span><span>   </span><span class="annot"><span class="annottext">XHsInt8Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127560"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127560"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt8Wrap"><span class="hs-identifier hs-var">mkLitInt8Wrap</span></a></span><span>   </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127560"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-663"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt16Prim"><span class="hs-identifier hs-type">HsInt16Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsInt16Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127561"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127561"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt16Wrap"><span class="hs-identifier hs-var">mkLitInt16Wrap</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127561"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-664"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt32Prim"><span class="hs-identifier hs-type">HsInt32Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsInt32Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127562"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127562"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt32Wrap"><span class="hs-identifier hs-var">mkLitInt32Wrap</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127562"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-665"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsInt64Prim"><span class="hs-identifier hs-type">HsInt64Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsInt64Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127563"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127563"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt64Wrap"><span class="hs-identifier hs-var">mkLitInt64Wrap</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127563"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-666"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord8Prim"><span class="hs-identifier hs-type">HsWord8Prim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsWord8Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127564"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127564"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord8Wrap"><span class="hs-identifier hs-var">mkLitWord8Wrap</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127564"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-667"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord16Prim"><span class="hs-identifier hs-type">HsWord16Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord16Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127565"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127565"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord16Wrap"><span class="hs-identifier hs-var">mkLitWord16Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127565"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-668"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord32Prim"><span class="hs-identifier hs-type">HsWord32Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord32Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127566"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127566"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord32Wrap"><span class="hs-identifier hs-var">mkLitWord32Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127566"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-669"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsWord64Prim"><span class="hs-identifier hs-type">HsWord64Prim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsWord64Prim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127567"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127567"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord64Wrap"><span class="hs-identifier hs-var">mkLitWord64Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621683127567"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-670"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsCharPrim"><span class="hs-identifier hs-type">HsCharPrim</span></a></span><span>   </span><span class="annot"><span class="annottext">XHsCharPrim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127568"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127568"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitChar"><span class="hs-identifier hs-var">mkLitChar</span></a></span><span>            </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621683127568"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-671"></span><span class="hs-comment">-- This following two can be slow. See Note [FractionalLit representation]</span><span>
</span><span id="line-672"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsFloatPrim"><span class="hs-identifier hs-type">HsFloatPrim</span></a></span><span>  </span><span class="annot"><span class="annottext">XHsFloatPrim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127570"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127570"><span class="hs-identifier hs-var">fl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitFloat"><span class="hs-identifier hs-var">mkLitFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FractionalLit -&gt; Rational
</span><a href="GHC.Types.SourceText.html#rationalFromFractionalLit"><span class="hs-identifier hs-var">rationalFromFractionalLit</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127570"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsDoublePrim"><span class="hs-identifier hs-type">HsDoublePrim</span></a></span><span> </span><span class="annot"><span class="annottext">XHsDoublePrim GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127572"><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127572"><span class="hs-identifier hs-var">fl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitDouble"><span class="hs-identifier hs-var">mkLitDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FractionalLit -&gt; Rational
</span><a href="GHC.Types.SourceText.html#rationalFromFractionalLit"><span class="hs-identifier hs-var">rationalFromFractionalLit</span></a></span><span> </span><span class="annot"><span class="annottext">FractionalLit
</span><a href="#local-6989586621683127572"><span class="hs-identifier hs-var">fl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Lit.html#HsString"><span class="hs-identifier hs-type">HsString</span></a></span><span> </span><span class="annot"><span class="annottext">XHsString GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127574"><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127574"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FastString -&gt; ByteString
</span><a href="GHC.Data.FastString.html#bytesFS"><span class="hs-identifier hs-var">bytesFS</span></a></span><span> </span><span class="annot"><span class="annottext">FastString
</span><a href="#local-6989586621683127574"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#hsLitKey"><span class="hs-identifier hs-var">hsLitKey</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span id="local-6989586621683127576"><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127576"><span class="hs-identifier hs-var">l</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Literal
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hsLitKey&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsLit GhcTc -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">HsLit GhcTc
</span><a href="#local-6989586621683127576"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Pattern matching on NPat
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#matchNPats"><span class="hs-identifier hs-type">matchNPats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#EquationInfoNE"><span class="hs-identifier hs-type">EquationInfoNE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Monad.html#MatchResult"><span class="hs-identifier hs-type">MatchResult</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span id="matchNPats"><span class="annot"><span class="annottext">matchNPats :: NonEmpty Id
-&gt; Type -&gt; NonEmpty EquationInfoNE -&gt; DsM (MatchResult CoreExpr)
</span><a href="GHC.HsToCore.Match.Literal.html#matchNPats"><span class="hs-identifier hs-var hs-var">matchNPats</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127577"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127577"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621683127578"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683127578"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683127579"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127579"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127580"><span class="annot"><span class="annottext">EquationInfoNE
</span><a href="#local-6989586621683127580"><span class="hs-identifier hs-var">eqn1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621683127581"><span class="annot"><span class="annottext">[EquationInfoNE]
</span><a href="#local-6989586621683127581"><span class="hs-identifier hs-var">eqns</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- All for the same literal</span><span>
</span><span id="line-688"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#NPat"><span class="hs-identifier hs-type">NPat</span></a></span><span> </span><span class="annot"><span class="annottext">XNPat GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127582"><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127582"><span class="hs-identifier hs-var hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683127583"><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><a href="#local-6989586621683127583"><span class="hs-identifier hs-var hs-var">mb_neg</span></a></span></span><span> </span><span id="local-6989586621683127584"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683127584"><span class="hs-identifier hs-var hs-var">eq_chk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EquationInfoNE -&gt; Pat GhcTc
</span><a href="GHC.HsToCore.Utils.html#firstPat"><span class="hs-identifier hs-var">firstPat</span></a></span><span> </span><span class="annot"><span class="annottext">EquationInfoNE
</span><a href="#local-6989586621683127580"><span class="hs-identifier hs-var">eqn1</span></a></span><span>
</span><span id="line-689"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127586"><span class="annot"><a href="#local-6989586621683127586"><span class="hs-identifier hs-var">lit_expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsOverLit"><span class="hs-identifier hs-var">dsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127582"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127587"><span class="annot"><a href="#local-6989586621683127587"><span class="hs-identifier hs-var">neg_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621683127583"><span class="hs-identifier hs-type">mb_neg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-691"></span><span>                            </span><span class="annot"><span class="annottext">Maybe (SyntaxExpr GhcTc)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; DsM CoreExpr
forall a. a -&gt; IOEnv (Env DsGblEnv DsLclEnv) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683127586"><span class="hs-identifier hs-var">lit_expr</span></a></span><span>
</span><span id="line-692"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621683127588"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683127588"><span class="hs-identifier hs-var">neg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc -&gt; [CoreExpr] -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-var">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683127588"><span class="hs-identifier hs-var">neg</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621683127586"><span class="hs-identifier hs-var">lit_expr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-693"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127589"><span class="annot"><a href="#local-6989586621683127589"><span class="hs-identifier hs-var">pred_expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127584"><span class="hs-identifier hs-type">eq_chk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127577"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127587"><span class="hs-identifier hs-type">neg_lit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-694"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127590"><span class="annot"><a href="#local-6989586621683127590"><span class="hs-identifier hs-var">match_result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#match"><span class="hs-identifier hs-type">match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127578"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127579"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Utils.html#shiftEqns"><span class="hs-identifier hs-type">shiftEqns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683127580"><span class="hs-identifier hs-type">eqn1</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="#local-6989586621683127581"><span class="hs-identifier hs-type">eqns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Utils.html#mkGuardedMatchResult"><span class="hs-identifier hs-type">mkGuardedMatchResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127589"><span class="hs-identifier hs-type">pred_expr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127590"><span class="hs-identifier hs-type">match_result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-696"></span><span>
</span><span id="line-697"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
                Pattern matching on n+k patterns
*                                                                      *
************************************************************************

For an n+k pattern, we use the various magic expressions we've been given.
We generate:
\begin{verbatim}
    if ge var lit then
        let n = sub var lit
        in  &lt;expr-for-a-successful-match&gt;
    else
        &lt;try-next-pattern-or-whatever&gt;
\end{verbatim}
-}</span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#matchNPlusKPats"><span class="hs-identifier hs-type">matchNPlusKPats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Rep.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="GHC.HsToCore.Monad.html#EquationInfoNE"><span class="hs-identifier hs-type">EquationInfoNE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.HsToCore.Types.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Monad.html#MatchResult"><span class="hs-identifier hs-type">MatchResult</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- All NPlusKPats, for the *same* literal k</span><span>
</span><span id="line-717"></span><span id="matchNPlusKPats"><span class="annot"><span class="annottext">matchNPlusKPats :: NonEmpty Id
-&gt; Type -&gt; NonEmpty EquationInfoNE -&gt; DsM (MatchResult CoreExpr)
</span><a href="GHC.HsToCore.Match.Literal.html#matchNPlusKPats"><span class="hs-identifier hs-var hs-var">matchNPlusKPats</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127591"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127591"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621683127592"><span class="annot"><span class="annottext">[Id]
</span><a href="#local-6989586621683127592"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683127593"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621683127593"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127594"><span class="annot"><span class="annottext">EquationInfoNE
</span><a href="#local-6989586621683127594"><span class="hs-identifier hs-var">eqn1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621683127595"><span class="annot"><span class="annottext">[EquationInfoNE]
</span><a href="#local-6989586621683127595"><span class="hs-identifier hs-var">eqns</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#NPlusKPat"><span class="hs-identifier hs-type">NPlusKPat</span></a></span><span> </span><span class="annot"><span class="annottext">XNPlusKPat GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127597"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127597"><span class="hs-identifier hs-var hs-var">n1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">EpAnnCO
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127598"><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127598"><span class="hs-identifier hs-var hs-var">lit1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621683127599"><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127599"><span class="hs-identifier hs-var hs-var">lit2</span></a></span></span><span> </span><span id="local-6989586621683127600"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683127600"><span class="hs-identifier hs-var hs-var">ge</span></a></span></span><span> </span><span id="local-6989586621683127601"><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><a href="#local-6989586621683127601"><span class="hs-identifier hs-var hs-var">minus</span></a></span></span><span>
</span><span id="line-719"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EquationInfoNE -&gt; Pat GhcTc
</span><a href="GHC.HsToCore.Utils.html#firstPat"><span class="hs-identifier hs-var">firstPat</span></a></span><span> </span><span class="annot"><span class="annottext">EquationInfoNE
</span><a href="#local-6989586621683127594"><span class="hs-identifier hs-var">eqn1</span></a></span><span>
</span><span id="line-720"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127602"><span class="annot"><a href="#local-6989586621683127602"><span class="hs-identifier hs-var">lit1_expr</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc -&gt; DsM CoreExpr
</span><a href="GHC.HsToCore.Match.Literal.html#dsOverLit"><span class="hs-identifier hs-var">dsOverLit</span></a></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><a href="#local-6989586621683127598"><span class="hs-identifier hs-var">lit1</span></a></span><span>
</span><span id="line-721"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127603"><span class="annot"><a href="#local-6989586621683127603"><span class="hs-identifier hs-var">lit2_expr</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.Literal.html#dsOverLit"><span class="hs-identifier hs-type">dsOverLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127599"><span class="hs-identifier hs-type">lit2</span></a></span><span>
</span><span id="line-722"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127604"><span class="annot"><a href="#local-6989586621683127604"><span class="hs-identifier hs-var">pred_expr</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127600"><span class="hs-identifier hs-type">ge</span></a></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127591"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127602"><span class="hs-identifier hs-type">lit1_expr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-723"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127605"><span class="annot"><a href="#local-6989586621683127605"><span class="hs-identifier hs-var">minusk_expr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Expr.html#dsSyntaxExpr"><span class="hs-identifier hs-type">dsSyntaxExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127601"><span class="hs-identifier hs-type">minus</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127591"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621683127603"><span class="hs-identifier hs-type">lit2_expr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-724"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621683127606"><span class="annot"><a href="#local-6989586621683127606"><span class="hs-identifier hs-var">wraps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621683127607"><span class="annot"><a href="#local-6989586621683127607"><span class="hs-identifier hs-var">eqns'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#mapAndUnzip"><span class="hs-identifier hs-type">mapAndUnzip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683127609"><span class="hs-identifier hs-type">shift</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127597"><span class="hs-identifier hs-type">n1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621683127594"><span class="hs-identifier hs-type">eqn1</span></a></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><a href="#local-6989586621683127595"><span class="hs-identifier hs-type">eqns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>        </span><span class="hs-special">;</span><span> </span><span id="local-6989586621683127610"><span class="annot"><a href="#local-6989586621683127610"><span class="hs-identifier hs-var">match_result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.HsToCore.Match.html#match"><span class="hs-identifier hs-type">match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127592"><span class="hs-identifier hs-type">vars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127593"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127607"><span class="hs-identifier hs-type">eqns'</span></a></span><span>
</span><span id="line-726"></span><span>        </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Utils.html#mkGuardedMatchResult"><span class="hs-identifier hs-type">mkGuardedMatchResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127604"><span class="hs-identifier hs-type">pred_expr</span></a></span><span>               </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-727"></span><span>                   </span><span class="annot"><a href="GHC.HsToCore.Utils.html#mkCoLetMatchResult"><span class="hs-identifier hs-type">mkCoLetMatchResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#NonRec"><span class="hs-identifier hs-type">NonRec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127597"><span class="hs-identifier hs-type">n1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621683127605"><span class="hs-identifier hs-type">minusk_expr</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-728"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">foldr1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">(.)</span></span><span> </span><span class="annot"><a href="#local-6989586621683127606"><span class="hs-identifier hs-type">wraps</span></a></span><span class="hs-special">)</span><span>                      </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-729"></span><span>                   </span><span class="annot"><a href="#local-6989586621683127610"><span class="hs-identifier hs-type">match_result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-731"></span><span>    </span><span id="local-6989586621683127609"><span class="annot"><span class="annottext">shift :: Id -&gt; EquationInfoNE -&gt; (CoreExpr -&gt; CoreExpr, EquationInfoNE)
</span><a href="#local-6989586621683127609"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621683127617"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127617"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.HsToCore.Monad.html#EqnMatch"><span class="hs-identifier hs-type">EqnMatch</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eqn_pat :: EquationInfoNE -&gt; LPat GhcTc
</span><a href="GHC.HsToCore.Monad.html#eqn_pat"><span class="hs-identifier hs-var">eqn_pat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnA
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.Syntax.Pat.html#NPlusKPat"><span class="hs-identifier hs-type">NPlusKPat</span></a></span><span> </span><span class="annot"><span class="annottext">XNPlusKPat GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.SrcLoc.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnnN
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127618"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127618"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XRec GhcTc (HsOverLit GhcTc)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsOverLit GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SyntaxExpr GhcTc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eqn_rest :: EquationInfoNE -&gt; EquationInfoNE
</span><a href="GHC.HsToCore.Monad.html#eqn_rest"><span class="hs-identifier hs-var">eqn_rest</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621683127620"><span class="annot"><span class="annottext">EquationInfoNE
</span><a href="#local-6989586621683127620"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-732"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; Id -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.HsToCore.Utils.html#wrapBind"><span class="hs-identifier hs-var">wrapBind</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127618"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621683127617"><span class="hs-identifier hs-var">n1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EquationInfoNE
</span><a href="#local-6989586621683127620"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>        </span><span class="hs-comment">-- The wrapBind is a no-op for the first equation</span><span>
</span><span id="line-734"></span><span>    </span><span class="annot"><a href="#local-6989586621683127609"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621683127622"><span class="annot"><span class="annottext">EquationInfoNE
</span><a href="#local-6989586621683127622"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; (CoreExpr -&gt; CoreExpr, EquationInfoNE)
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;matchNPlusKPats/shift&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EquationInfoNE -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">EquationInfoNE
</span><a href="#local-6989586621683127622"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span></pre></body></html>