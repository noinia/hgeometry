<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
(c) The GRASP/AQUA Project, Glasgow University, 1992-1998

Conceptually, constant folding should be parameterized with the kind
of target machine to get identical behaviour during compilation time
and runtime. We cheat a little bit here...

ToDo:
   check boundaries before folding, e.g. we can fold the Float addition
   (i1 + i2) only if it results in a valid Float.
-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# OPTIONS_GHC -optc-DNON_POSIX_SOURCE -Wno-incomplete-uni-patterns #-}</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="annot"><span class="hs-comment">-- | Constant Folder</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html"><span class="hs-identifier">GHC.Core.Opt.ConstantFold</span></a></span><span>
</span><span id="line-27"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#primOpRules"><span class="hs-identifier">primOpRules</span></a></span><span>
</span><span id="line-28"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#builtinRules"><span class="hs-identifier">builtinRules</span></a></span><span>
</span><span id="line-29"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules"><span class="hs-identifier">caseRules</span></a></span><span>
</span><span id="line-30"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules2"><span class="hs-identifier">caseRules2</span></a></span><span>
</span><span id="line-31"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/GHC.Float.html"><span class="hs-identifier">GHC.Float</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html"><span class="hs-identifier">GHC.Types.Id.Make</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#unboxedUnitExpr"><span class="hs-identifier">unboxedUnitExpr</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Id.html"><span class="hs-identifier">GHC.Types.Id</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html"><span class="hs-identifier">GHC.Types.Literal</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html"><span class="hs-identifier">GHC.Types.Name.Occurrence</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier">occNameFS</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Tickish.html"><span class="hs-identifier">GHC.Types.Tickish</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Name.html"><span class="hs-identifier">GHC.Types.Name</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier">nameOccName</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html"><span class="hs-identifier">GHC.Types.Basic</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.html"><span class="hs-identifier">GHC.Core</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Make.html"><span class="hs-identifier">GHC.Core.Make</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.SimpleOpt.html"><span class="hs-identifier">GHC.Core.SimpleOpt</span></a></span><span> </span><span class="hs-special">(</span><span>  </span><span class="annot"><a href="GHC.Core.SimpleOpt.html#exprIsConApp_maybe"><span class="hs-identifier">exprIsConApp_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier">exprIsLiteral_maybe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html"><span class="hs-identifier">GHC.Core.DataCon</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier">DataCon</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.DataCon.html#dataConTagZ"><span class="hs-identifier">dataConTagZ</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier">dataConTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dataConWrapId"><span class="hs-identifier">dataConWrapId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier">dataConWorkId</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html"><span class="hs-identifier">GHC.Core.Utils</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-identifier">cheapEqExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#exprIsHNF"><span class="hs-identifier">exprIsHNF</span></a></span><span>
</span><span id="line-52"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#stripTicksTop"><span class="hs-identifier">stripTicksTop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#stripTicksTopT"><span class="hs-identifier">stripTicksTopT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#mkTicks"><span class="hs-identifier">mkTicks</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Multiplicity.html"><span class="hs-identifier">GHC.Core.Multiplicity</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html"><span class="hs-identifier">GHC.Core.Rules.Config</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Type.html"><span class="hs-identifier">GHC.Core.Type</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html"><span class="hs-identifier">GHC.Core.TyCo.Compare</span></a></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-identifier">eqType</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html"><span class="hs-identifier">GHC.Core.TyCon</span></a></span><span>
</span><span id="line-58"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#tyConDataCons_maybe"><span class="hs-identifier">tyConDataCons_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier">tyConDataCons</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#tyConFamilySize"><span class="hs-identifier">tyConFamilySize</span></a></span><span>
</span><span id="line-59"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#isEnumerationTyCon"><span class="hs-identifier">isEnumerationTyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#isValidDTT2TyCon"><span class="hs-identifier">isValidDTT2TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier">isNewTyCon</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Core.Map.Expr.html"><span class="hs-identifier">GHC.Core.Map.Expr</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.Map.Expr.html#eqCoreExpr"><span class="hs-identifier">eqCoreExpr</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html"><span class="hs-identifier">GHC.Builtin.PrimOps</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier">PrimOp</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#tagToEnumKey"><span class="hs-identifier">tagToEnumKey</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html"><span class="hs-identifier">GHC.Builtin.PrimOps.Ids</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier">primOpId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html"><span class="hs-identifier">GHC.Builtin.Types</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Types.Prim.html"><span class="hs-identifier">GHC.Builtin.Types.Prim</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Builtin.Names.html"><span class="hs-identifier">GHC.Builtin.Names</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html"><span class="hs-identifier">GHC.Cmm.MachOp</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#FMASign"><span class="hs-identifier">FMASign</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html"><span class="hs-identifier">GHC.Cmm.Type</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier">Width</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.FastString.html"><span class="hs-identifier">GHC.Data.FastString</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html"><span class="hs-identifier">GHC.Data.Maybe</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Data.Maybe.html#orElse"><span class="hs-identifier">orElse</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Outputable.html"><span class="hs-identifier">GHC.Utils.Outputable</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Panic.html"><span class="hs-identifier">GHC.Utils.Panic</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Alternative</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Functor.html"><span class="hs-identifier">Data.Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Ratio.html"><span class="hs-identifier">Data.Ratio</span></a></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Word.html"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.21.0.0-ae91/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">{-
Note [Constant folding]
~~~~~~~~~~~~~~~~~~~~~~~
primOpRules generates a rewrite rule for each primop
These rules do what is often called &quot;constant folding&quot;
E.g. the rules for +# might say
        4 +# 5 = 9
Well, of course you'd need a lot of rules if you did it
like that, so we use a BuiltinRule instead, so that we
can match in any two literal values.  So the rule is really
more like
        (Lit x) +# (Lit y) = Lit (x+#y)
where the (+#) on the rhs is done at compile time

That is why these rules are built in here.
-}</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#primOpRules"><span class="hs-identifier hs-type">primOpRules</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span>
</span><span id="line-104"></span><span id="primOpRules"><span class="annot"><span class="annottext">primOpRules :: Name -&gt; PrimOp -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#primOpRules"><span class="hs-identifier hs-var hs-var">primOpRules</span></a></span></span><span> </span><span id="local-6989586621682930369"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-105"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#TagToEnumOp"><span class="hs-identifier hs-var">TagToEnumOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#tagToEnumRule"><span class="hs-identifier hs-var">tagToEnumRule</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-106"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DataToTagSmallOp"><span class="hs-identifier hs-var">DataToTagSmallOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#dataToTagRule"><span class="hs-identifier hs-var">dataToTagRule</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-107"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DataToTagLargeOp"><span class="hs-identifier hs-var">DataToTagLargeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#dataToTagRule"><span class="hs-identifier hs-var">dataToTagRule</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>   </span><span class="hs-comment">-- Int8 operations</span><span>
</span><span id="line-110"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8AddOp"><span class="hs-identifier hs-var">Int8AddOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Op2"><span class="hs-identifier hs-var">int8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var">zeroI8</span></a></span><span>
</span><span id="line-112"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8AddOp"><span class="hs-identifier hs-var">Int8AddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Ops"><span class="hs-identifier hs-var">int8Ops</span></a></span><span>
</span><span id="line-113"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8SubOp"><span class="hs-identifier hs-var">Int8SubOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Op2"><span class="hs-identifier hs-var">int8Op2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var">zeroI8</span></a></span><span>
</span><span id="line-116"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var">zeroI8</span></a></span><span>
</span><span id="line-117"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8SubOp"><span class="hs-identifier hs-var">Int8SubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Ops"><span class="hs-identifier hs-var">int8Ops</span></a></span><span>
</span><span id="line-118"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8MulOp"><span class="hs-identifier hs-var">Int8MulOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Op2"><span class="hs-identifier hs-var">int8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-121"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI8"><span class="hs-identifier hs-var">oneI8</span></a></span><span>
</span><span id="line-122"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8MulOp"><span class="hs-identifier hs-var">Int8MulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Ops"><span class="hs-identifier hs-var">int8Ops</span></a></span><span>
</span><span id="line-123"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8QuotOp"><span class="hs-identifier hs-var">Int8QuotOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Op2"><span class="hs-identifier hs-var">int8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-126"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI8"><span class="hs-identifier hs-var">oneI8</span></a></span><span>
</span><span id="line-127"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI8"><span class="hs-identifier hs-var">oneI8</span></a></span><span>
</span><span id="line-128"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Ops"><span class="hs-identifier hs-var">int8Ops</span></a></span><span>
</span><span id="line-129"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8RemOp"><span class="hs-identifier hs-var">Int8RemOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Op2"><span class="hs-identifier hs-var">int8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-132"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var">zeroI8</span></a></span><span>
</span><span id="line-133"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var">zeroI8</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8NegOp"><span class="hs-identifier hs-var">Int8NegOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-var">negOp</span></a></span><span>
</span><span id="line-135"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8NegOp"><span class="hs-identifier hs-var">Int8NegOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8SllOp"><span class="hs-identifier hs-var">Int8SllOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var">zeroI8</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8SraOp"><span class="hs-identifier hs-var">Int8SraOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-identifier hs-var">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var">zeroI8</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8SrlOp"><span class="hs-identifier hs-var">Int8SrlOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span> </span><span class="annot"><span class="annottext">((Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr)
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; ConTagZ -&gt; Integer)
 -&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform
-&gt; Integer
-&gt; ConTagZ
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>
</span><span id="line-141"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var">zeroI8</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>   </span><span class="hs-comment">-- Word8 operations</span><span>
</span><span id="line-144"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8AddOp"><span class="hs-identifier hs-var">Word8AddOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var">zeroW8</span></a></span><span>
</span><span id="line-146"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8AddOp"><span class="hs-identifier hs-var">Word8AddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Ops"><span class="hs-identifier hs-var">word8Ops</span></a></span><span>
</span><span id="line-147"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8SubOp"><span class="hs-identifier hs-var">Word8SubOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var">zeroW8</span></a></span><span>
</span><span id="line-150"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var">zeroW8</span></a></span><span>
</span><span id="line-151"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8SubOp"><span class="hs-identifier hs-var">Word8SubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Ops"><span class="hs-identifier hs-var">word8Ops</span></a></span><span>
</span><span id="line-152"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8MulOp"><span class="hs-identifier hs-var">Word8MulOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW8"><span class="hs-identifier hs-var">oneW8</span></a></span><span>
</span><span id="line-155"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8MulOp"><span class="hs-identifier hs-var">Word8MulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Ops"><span class="hs-identifier hs-var">word8Ops</span></a></span><span>
</span><span id="line-156"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8QuotOp"><span class="hs-identifier hs-var">Word8QuotOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW8"><span class="hs-identifier hs-var">oneW8</span></a></span><span>
</span><span id="line-159"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Ops"><span class="hs-identifier hs-var">word8Ops</span></a></span><span>
</span><span id="line-160"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8RemOp"><span class="hs-identifier hs-var">Word8RemOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-163"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var">zeroW8</span></a></span><span>
</span><span id="line-164"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var">zeroW8</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8AndOp"><span class="hs-identifier hs-var">Word8AndOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-167"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-168"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord8"><span class="hs-identifier hs-var">mkLitWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFF</span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8AndOp"><span class="hs-identifier hs-var">Word8AndOp</span></a></span><span>
</span><span id="line-170"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules"><span class="hs-identifier hs-var">andFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Ops"><span class="hs-identifier hs-var">word8Ops</span></a></span><span>
</span><span id="line-171"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8OrOp"><span class="hs-identifier hs-var">Word8OrOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-174"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var">zeroW8</span></a></span><span>
</span><span id="line-175"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8OrOp"><span class="hs-identifier hs-var">Word8OrOp</span></a></span><span>
</span><span id="line-176"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules"><span class="hs-identifier hs-var">orFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Ops"><span class="hs-identifier hs-var">word8Ops</span></a></span><span>
</span><span id="line-177"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8XorOp"><span class="hs-identifier hs-var">Word8XorOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var">zeroW8</span></a></span><span>
</span><span id="line-180"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var">zeroW8</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8NotOp"><span class="hs-identifier hs-var">Word8NotOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-var">complementOp</span></a></span><span>
</span><span id="line-182"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8NotOp"><span class="hs-identifier hs-var">Word8NotOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8SllOp"><span class="hs-identifier hs-var">Word8SllOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-184"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8SrlOp"><span class="hs-identifier hs-var">Word8SrlOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span> </span><span class="annot"><span class="annottext">((Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr)
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; ConTagZ -&gt; Integer)
 -&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform
-&gt; Integer
-&gt; ConTagZ
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>   </span><span class="hs-comment">-- Int16 operations</span><span>
</span><span id="line-188"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16AddOp"><span class="hs-identifier hs-var">Int16AddOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Op2"><span class="hs-identifier hs-var">int16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var">zeroI16</span></a></span><span>
</span><span id="line-190"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16AddOp"><span class="hs-identifier hs-var">Int16AddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Ops"><span class="hs-identifier hs-var">int16Ops</span></a></span><span>
</span><span id="line-191"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16SubOp"><span class="hs-identifier hs-var">Int16SubOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Op2"><span class="hs-identifier hs-var">int16Op2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var">zeroI16</span></a></span><span>
</span><span id="line-194"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var">zeroI16</span></a></span><span>
</span><span id="line-195"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16SubOp"><span class="hs-identifier hs-var">Int16SubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Ops"><span class="hs-identifier hs-var">int16Ops</span></a></span><span>
</span><span id="line-196"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16MulOp"><span class="hs-identifier hs-var">Int16MulOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Op2"><span class="hs-identifier hs-var">int16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-199"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI16"><span class="hs-identifier hs-var">oneI16</span></a></span><span>
</span><span id="line-200"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16MulOp"><span class="hs-identifier hs-var">Int16MulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Ops"><span class="hs-identifier hs-var">int16Ops</span></a></span><span>
</span><span id="line-201"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16QuotOp"><span class="hs-identifier hs-var">Int16QuotOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Op2"><span class="hs-identifier hs-var">int16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-204"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI16"><span class="hs-identifier hs-var">oneI16</span></a></span><span>
</span><span id="line-205"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI16"><span class="hs-identifier hs-var">oneI16</span></a></span><span>
</span><span id="line-206"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Ops"><span class="hs-identifier hs-var">int16Ops</span></a></span><span>
</span><span id="line-207"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16RemOp"><span class="hs-identifier hs-var">Int16RemOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Op2"><span class="hs-identifier hs-var">int16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-210"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var">zeroI16</span></a></span><span>
</span><span id="line-211"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var">zeroI16</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16NegOp"><span class="hs-identifier hs-var">Int16NegOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-var">negOp</span></a></span><span>
</span><span id="line-213"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16NegOp"><span class="hs-identifier hs-var">Int16NegOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16SllOp"><span class="hs-identifier hs-var">Int16SllOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var">zeroI16</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16SraOp"><span class="hs-identifier hs-var">Int16SraOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-identifier hs-var">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var">zeroI16</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16SrlOp"><span class="hs-identifier hs-var">Int16SrlOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span> </span><span class="annot"><span class="annottext">((Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr)
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; ConTagZ -&gt; Integer)
 -&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform
-&gt; Integer
-&gt; ConTagZ
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span>
</span><span id="line-219"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var">zeroI16</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>   </span><span class="hs-comment">-- Word16 operations</span><span>
</span><span id="line-222"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16AddOp"><span class="hs-identifier hs-var">Word16AddOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var">zeroW16</span></a></span><span>
</span><span id="line-224"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16AddOp"><span class="hs-identifier hs-var">Word16AddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Ops"><span class="hs-identifier hs-var">word16Ops</span></a></span><span>
</span><span id="line-225"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16SubOp"><span class="hs-identifier hs-var">Word16SubOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var">zeroW16</span></a></span><span>
</span><span id="line-228"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var">zeroW16</span></a></span><span>
</span><span id="line-229"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16SubOp"><span class="hs-identifier hs-var">Word16SubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Ops"><span class="hs-identifier hs-var">word16Ops</span></a></span><span>
</span><span id="line-230"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16MulOp"><span class="hs-identifier hs-var">Word16MulOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW16"><span class="hs-identifier hs-var">oneW16</span></a></span><span>
</span><span id="line-233"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16MulOp"><span class="hs-identifier hs-var">Word16MulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Ops"><span class="hs-identifier hs-var">word16Ops</span></a></span><span>
</span><span id="line-234"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16QuotOp"><span class="hs-identifier hs-var">Word16QuotOp</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW16"><span class="hs-identifier hs-var">oneW16</span></a></span><span>
</span><span id="line-237"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Ops"><span class="hs-identifier hs-var">word16Ops</span></a></span><span>
</span><span id="line-238"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16RemOp"><span class="hs-identifier hs-var">Word16RemOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-241"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var">zeroW16</span></a></span><span>
</span><span id="line-242"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var">zeroW16</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-243"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16AndOp"><span class="hs-identifier hs-var">Word16AndOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-245"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-246"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord16"><span class="hs-identifier hs-var">mkLitWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFFFF</span></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16AndOp"><span class="hs-identifier hs-var">Word16AndOp</span></a></span><span>
</span><span id="line-248"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules"><span class="hs-identifier hs-var">andFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Ops"><span class="hs-identifier hs-var">word16Ops</span></a></span><span>
</span><span id="line-249"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-250"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16OrOp"><span class="hs-identifier hs-var">Word16OrOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-252"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var">zeroW16</span></a></span><span>
</span><span id="line-253"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16OrOp"><span class="hs-identifier hs-var">Word16OrOp</span></a></span><span>
</span><span id="line-254"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules"><span class="hs-identifier hs-var">orFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Ops"><span class="hs-identifier hs-var">word16Ops</span></a></span><span>
</span><span id="line-255"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16XorOp"><span class="hs-identifier hs-var">Word16XorOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var">zeroW16</span></a></span><span>
</span><span id="line-258"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var">zeroW16</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-259"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16NotOp"><span class="hs-identifier hs-var">Word16NotOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-var">complementOp</span></a></span><span>
</span><span id="line-260"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16NotOp"><span class="hs-identifier hs-var">Word16NotOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16SllOp"><span class="hs-identifier hs-var">Word16SllOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16SrlOp"><span class="hs-identifier hs-var">Word16SrlOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span> </span><span class="annot"><span class="annottext">((Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr)
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; ConTagZ -&gt; Integer)
 -&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform
-&gt; Integer
-&gt; ConTagZ
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>   </span><span class="hs-comment">-- Int32 operations</span><span>
</span><span id="line-266"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32AddOp"><span class="hs-identifier hs-var">Int32AddOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Op2"><span class="hs-identifier hs-var">int32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var">zeroI32</span></a></span><span>
</span><span id="line-268"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32AddOp"><span class="hs-identifier hs-var">Int32AddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Ops"><span class="hs-identifier hs-var">int32Ops</span></a></span><span>
</span><span id="line-269"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32SubOp"><span class="hs-identifier hs-var">Int32SubOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Op2"><span class="hs-identifier hs-var">int32Op2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var">zeroI32</span></a></span><span>
</span><span id="line-272"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var">zeroI32</span></a></span><span>
</span><span id="line-273"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32SubOp"><span class="hs-identifier hs-var">Int32SubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Ops"><span class="hs-identifier hs-var">int32Ops</span></a></span><span>
</span><span id="line-274"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32MulOp"><span class="hs-identifier hs-var">Int32MulOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Op2"><span class="hs-identifier hs-var">int32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-277"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI32"><span class="hs-identifier hs-var">oneI32</span></a></span><span>
</span><span id="line-278"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32MulOp"><span class="hs-identifier hs-var">Int32MulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Ops"><span class="hs-identifier hs-var">int32Ops</span></a></span><span>
</span><span id="line-279"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32QuotOp"><span class="hs-identifier hs-var">Int32QuotOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Op2"><span class="hs-identifier hs-var">int32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-282"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI32"><span class="hs-identifier hs-var">oneI32</span></a></span><span>
</span><span id="line-283"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI32"><span class="hs-identifier hs-var">oneI32</span></a></span><span>
</span><span id="line-284"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Ops"><span class="hs-identifier hs-var">int32Ops</span></a></span><span>
</span><span id="line-285"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-286"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32RemOp"><span class="hs-identifier hs-var">Int32RemOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Op2"><span class="hs-identifier hs-var">int32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-288"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var">zeroI32</span></a></span><span>
</span><span id="line-289"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var">zeroI32</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-290"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32NegOp"><span class="hs-identifier hs-var">Int32NegOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-var">negOp</span></a></span><span>
</span><span id="line-291"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32NegOp"><span class="hs-identifier hs-var">Int32NegOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32SllOp"><span class="hs-identifier hs-var">Int32SllOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var">zeroI32</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32SraOp"><span class="hs-identifier hs-var">Int32SraOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-identifier hs-var">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var">zeroI32</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32SrlOp"><span class="hs-identifier hs-var">Int32SrlOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span> </span><span class="annot"><span class="annottext">((Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr)
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; ConTagZ -&gt; Integer)
 -&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform
-&gt; Integer
-&gt; ConTagZ
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-297"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var">zeroI32</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>   </span><span class="hs-comment">-- Word32 operations</span><span>
</span><span id="line-300"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32AddOp"><span class="hs-identifier hs-var">Word32AddOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var">zeroW32</span></a></span><span>
</span><span id="line-302"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32AddOp"><span class="hs-identifier hs-var">Word32AddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Ops"><span class="hs-identifier hs-var">word32Ops</span></a></span><span>
</span><span id="line-303"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32SubOp"><span class="hs-identifier hs-var">Word32SubOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var">zeroW32</span></a></span><span>
</span><span id="line-306"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var">zeroW32</span></a></span><span>
</span><span id="line-307"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32SubOp"><span class="hs-identifier hs-var">Word32SubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Ops"><span class="hs-identifier hs-var">word32Ops</span></a></span><span>
</span><span id="line-308"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32MulOp"><span class="hs-identifier hs-var">Word32MulOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW32"><span class="hs-identifier hs-var">oneW32</span></a></span><span>
</span><span id="line-311"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32MulOp"><span class="hs-identifier hs-var">Word32MulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Ops"><span class="hs-identifier hs-var">word32Ops</span></a></span><span>
</span><span id="line-312"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-313"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32QuotOp"><span class="hs-identifier hs-var">Word32QuotOp</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW32"><span class="hs-identifier hs-var">oneW32</span></a></span><span>
</span><span id="line-315"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Ops"><span class="hs-identifier hs-var">word32Ops</span></a></span><span>
</span><span id="line-316"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-317"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32RemOp"><span class="hs-identifier hs-var">Word32RemOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-319"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var">zeroW32</span></a></span><span>
</span><span id="line-320"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var">zeroW32</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32AndOp"><span class="hs-identifier hs-var">Word32AndOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-323"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-324"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord32"><span class="hs-identifier hs-var">mkLitWord32</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFFFFFFFF</span></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32AndOp"><span class="hs-identifier hs-var">Word32AndOp</span></a></span><span>
</span><span id="line-326"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules"><span class="hs-identifier hs-var">andFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Ops"><span class="hs-identifier hs-var">word32Ops</span></a></span><span>
</span><span id="line-327"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32OrOp"><span class="hs-identifier hs-var">Word32OrOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-330"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var">zeroW32</span></a></span><span>
</span><span id="line-331"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32OrOp"><span class="hs-identifier hs-var">Word32OrOp</span></a></span><span>
</span><span id="line-332"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules"><span class="hs-identifier hs-var">orFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Ops"><span class="hs-identifier hs-var">word32Ops</span></a></span><span>
</span><span id="line-333"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-334"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32XorOp"><span class="hs-identifier hs-var">Word32XorOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var">zeroW32</span></a></span><span>
</span><span id="line-336"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var">zeroW32</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32NotOp"><span class="hs-identifier hs-var">Word32NotOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-var">complementOp</span></a></span><span>
</span><span id="line-338"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32NotOp"><span class="hs-identifier hs-var">Word32NotOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32SllOp"><span class="hs-identifier hs-var">Word32SllOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-340"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32SrlOp"><span class="hs-identifier hs-var">Word32SrlOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span> </span><span class="annot"><span class="annottext">((Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr)
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; ConTagZ -&gt; Integer)
 -&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform
-&gt; Integer
-&gt; ConTagZ
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>   </span><span class="hs-comment">-- Int64 operations</span><span>
</span><span id="line-343"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64AddOp"><span class="hs-identifier hs-var">Int64AddOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Op2"><span class="hs-identifier hs-var">int64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var">zeroI64</span></a></span><span>
</span><span id="line-345"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64AddOp"><span class="hs-identifier hs-var">Int64AddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Ops"><span class="hs-identifier hs-var">int64Ops</span></a></span><span>
</span><span id="line-346"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64SubOp"><span class="hs-identifier hs-var">Int64SubOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Op2"><span class="hs-identifier hs-var">int64Op2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var">zeroI64</span></a></span><span>
</span><span id="line-349"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var">zeroI64</span></a></span><span>
</span><span id="line-350"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64SubOp"><span class="hs-identifier hs-var">Int64SubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Ops"><span class="hs-identifier hs-var">int64Ops</span></a></span><span>
</span><span id="line-351"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-352"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64MulOp"><span class="hs-identifier hs-var">Int64MulOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Op2"><span class="hs-identifier hs-var">int64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-354"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI64"><span class="hs-identifier hs-var">oneI64</span></a></span><span>
</span><span id="line-355"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64MulOp"><span class="hs-identifier hs-var">Int64MulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Ops"><span class="hs-identifier hs-var">int64Ops</span></a></span><span>
</span><span id="line-356"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-357"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64QuotOp"><span class="hs-identifier hs-var">Int64QuotOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Op2"><span class="hs-identifier hs-var">int64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-359"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI64"><span class="hs-identifier hs-var">oneI64</span></a></span><span>
</span><span id="line-360"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI64"><span class="hs-identifier hs-var">oneI64</span></a></span><span>
</span><span id="line-361"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Ops"><span class="hs-identifier hs-var">int64Ops</span></a></span><span>
</span><span id="line-362"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-363"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64RemOp"><span class="hs-identifier hs-var">Int64RemOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Op2"><span class="hs-identifier hs-var">int64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-365"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var">zeroI64</span></a></span><span>
</span><span id="line-366"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var">zeroI64</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-367"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64NegOp"><span class="hs-identifier hs-var">Int64NegOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-var">negOp</span></a></span><span>
</span><span id="line-368"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64NegOp"><span class="hs-identifier hs-var">Int64NegOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64SllOp"><span class="hs-identifier hs-var">Int64SllOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var">zeroI64</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64SraOp"><span class="hs-identifier hs-var">Int64SraOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-identifier hs-var">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var">zeroI64</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64SrlOp"><span class="hs-identifier hs-var">Int64SrlOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span> </span><span class="annot"><span class="annottext">((Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr)
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; ConTagZ -&gt; Integer)
 -&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform
-&gt; Integer
-&gt; ConTagZ
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-374"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var">zeroI64</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>   </span><span class="hs-comment">-- Word64 operations</span><span>
</span><span id="line-377"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64AddOp"><span class="hs-identifier hs-var">Word64AddOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var">zeroW64</span></a></span><span>
</span><span id="line-379"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64AddOp"><span class="hs-identifier hs-var">Word64AddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Ops"><span class="hs-identifier hs-var">word64Ops</span></a></span><span>
</span><span id="line-380"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-381"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64SubOp"><span class="hs-identifier hs-var">Word64SubOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var">zeroW64</span></a></span><span>
</span><span id="line-383"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var">zeroW64</span></a></span><span>
</span><span id="line-384"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64SubOp"><span class="hs-identifier hs-var">Word64SubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Ops"><span class="hs-identifier hs-var">word64Ops</span></a></span><span>
</span><span id="line-385"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-386"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64MulOp"><span class="hs-identifier hs-var">Word64MulOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW64"><span class="hs-identifier hs-var">oneW64</span></a></span><span>
</span><span id="line-388"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64MulOp"><span class="hs-identifier hs-var">Word64MulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Ops"><span class="hs-identifier hs-var">word64Ops</span></a></span><span>
</span><span id="line-389"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-390"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64QuotOp"><span class="hs-identifier hs-var">Word64QuotOp</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW64"><span class="hs-identifier hs-var">oneW64</span></a></span><span>
</span><span id="line-392"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Ops"><span class="hs-identifier hs-var">word64Ops</span></a></span><span>
</span><span id="line-393"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64RemOp"><span class="hs-identifier hs-var">Word64RemOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-396"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var">zeroW64</span></a></span><span>
</span><span id="line-397"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var">zeroW64</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-398"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64AndOp"><span class="hs-identifier hs-var">Word64AndOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-400"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-401"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord64"><span class="hs-identifier hs-var">mkLitWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFFFFFFFFFFFFFFFF</span></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64AndOp"><span class="hs-identifier hs-var">Word64AndOp</span></a></span><span>
</span><span id="line-403"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules"><span class="hs-identifier hs-var">andFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Ops"><span class="hs-identifier hs-var">word64Ops</span></a></span><span>
</span><span id="line-404"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64OrOp"><span class="hs-identifier hs-var">Word64OrOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-407"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var">zeroW64</span></a></span><span>
</span><span id="line-408"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64OrOp"><span class="hs-identifier hs-var">Word64OrOp</span></a></span><span>
</span><span id="line-409"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules"><span class="hs-identifier hs-var">orFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Ops"><span class="hs-identifier hs-var">word64Ops</span></a></span><span>
</span><span id="line-410"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-411"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64XorOp"><span class="hs-identifier hs-var">Word64XorOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var">zeroW64</span></a></span><span>
</span><span id="line-413"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; CoreExpr -&gt; RuleM CoreExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var">zeroW64</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-414"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64NotOp"><span class="hs-identifier hs-var">Word64NotOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-var">complementOp</span></a></span><span>
</span><span id="line-415"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64NotOp"><span class="hs-identifier hs-var">Word64NotOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-416"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64SllOp"><span class="hs-identifier hs-var">Word64SllOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64SrlOp"><span class="hs-identifier hs-var">Word64SrlOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span> </span><span class="annot"><span class="annottext">((Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr)
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">((Integer -&gt; ConTagZ -&gt; Integer)
 -&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform
-&gt; Integer
-&gt; ConTagZ
-&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>   </span><span class="hs-comment">-- Int operations</span><span>
</span><span id="line-420"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAddOp"><span class="hs-identifier hs-var">IntAddOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span>
</span><span id="line-422"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAddOp"><span class="hs-identifier hs-var">IntAddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#intOps"><span class="hs-identifier hs-var">intOps</span></a></span><span>
</span><span id="line-423"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-424"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSubOp"><span class="hs-identifier hs-var">IntSubOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span>
</span><span id="line-426"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span>
</span><span id="line-427"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSubOp"><span class="hs-identifier hs-var">IntSubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#intOps"><span class="hs-identifier hs-var">intOps</span></a></span><span>
</span><span id="line-428"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-429"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAddCOp"><span class="hs-identifier hs-var">IntAddCOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOpC2"><span class="hs-identifier hs-var">intOpC2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityCPlatform"><span class="hs-identifier hs-var">identityCPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-431"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSubCOp"><span class="hs-identifier hs-var">IntSubCOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOpC2"><span class="hs-identifier hs-var">intOpC2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityCPlatform"><span class="hs-identifier hs-var">rightIdentityCPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span>
</span><span id="line-433"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLitNoC"><span class="hs-identifier hs-var">retLitNoC</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntMulOp"><span class="hs-identifier hs-var">IntMulOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-436"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-var">onei</span></a></span><span>
</span><span id="line-437"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntMulOp"><span class="hs-identifier hs-var">IntMulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#intOps"><span class="hs-identifier hs-var">intOps</span></a></span><span>
</span><span id="line-438"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-439"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntMul2Op"><span class="hs-identifier hs-var">IntMul2Op</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-440"></span><span>                                        </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682930551"><span class="annot"><a href="#local-6989586621682930551"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682930552"><span class="annot"><a href="#local-6989586621682930552"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-441"></span><span>                                        </span><span id="local-6989586621682930554"><span class="annot"><a href="#local-6989586621682930554"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-442"></span><span>                                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682930556"><span class="annot"><a href="#local-6989586621682930556"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682930551"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682930552"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-443"></span><span>                                        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-type">mkCoreUnboxedTuple</span></a></span><span>
</span><span id="line-444"></span><span>                                          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="GHC.Platform.html#platformInIntRange"><span class="hs-identifier hs-type">platformInIntRange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930554"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930556"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-type">zeroi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930554"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-type">onei</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930554"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#mkIntLitWrap"><span class="hs-identifier hs-type">mkIntLitWrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930554"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682930556"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-type">`shiftR`</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#platformWordSizeInBits"><span class="hs-identifier hs-type">platformWordSizeInBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930554"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#mkIntLitWrap"><span class="hs-identifier hs-type">mkIntLitWrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930554"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930556"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-447"></span><span>                                          </span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; (CoreExpr -&gt; RuleM CoreExpr) -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682930561"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682930561"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-450"></span><span>                                        </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-var">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682930561"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682930561"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682930561"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>                                      </span><span class="hs-comment">-- timesInt2# 1# other</span><span>
</span><span id="line-453"></span><span>                                      </span><span class="hs-comment">-- ~~~&gt;</span><span>
</span><span id="line-454"></span><span>                                      </span><span class="hs-comment">-- (# 0#, 0# -# (other &gt;&gt;# (WORD_SIZE_IN_BITS-1)), other #)</span><span>
</span><span id="line-455"></span><span>                                      </span><span class="hs-comment">-- The second element is the sign bit</span><span>
</span><span id="line-456"></span><span>                                      </span><span class="hs-comment">-- repeated to fill a word.</span><span>
</span><span id="line-457"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-var">onei</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; (CoreExpr -&gt; RuleM CoreExpr) -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682930562"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682930562"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>                                        </span><span id="local-6989586621682930563"><span class="annot"><a href="#local-6989586621682930563"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-459"></span><span>                                        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-type">mkCoreUnboxedTuple</span></a></span><span>
</span><span id="line-460"></span><span>                                          </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-type">zeroi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930563"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-type">mkCoreApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-type">primOpId</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#IntSubOp"><span class="hs-identifier hs-type">IntSubOp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>                                              </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-type">zeroi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930563"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>                                              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreApps"><span class="hs-identifier hs-type">mkCoreApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-type">primOpId</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#IntSrlOp"><span class="hs-identifier hs-type">IntSrlOp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>                                                </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621682930562"><span class="hs-identifier hs-type">other</span></a></span><span>
</span><span id="line-465"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#mkIntLit"><span class="hs-identifier hs-type">mkIntLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930563"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#platformWordSizeInBits"><span class="hs-identifier hs-type">platformWordSizeInBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930563"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>                                                </span><span class="hs-special">]</span><span>
</span><span id="line-467"></span><span>                                              </span><span class="hs-special">]</span><span>
</span><span id="line-468"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682930562"><span class="hs-identifier hs-type">other</span></a></span><span>
</span><span id="line-469"></span><span>                                          </span><span class="hs-special">]</span><span>
</span><span id="line-470"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-471"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntQuotOp"><span class="hs-identifier hs-var">IntQuotOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-473"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-var">onei</span></a></span><span>
</span><span id="line-474"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-var">onei</span></a></span><span>
</span><span id="line-475"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#intOps"><span class="hs-identifier hs-var">intOps</span></a></span><span>
</span><span id="line-476"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-477"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntRemOp"><span class="hs-identifier hs-var">IntRemOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-479"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span>
</span><span id="line-480"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-481"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-483"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-484"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682930571"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682930571"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682930571"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span>
</span><span id="line-486"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules"><span class="hs-identifier hs-var">andFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#intOps"><span class="hs-identifier hs-var">intOps</span></a></span><span>
</span><span id="line-487"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-488"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntOrOp"><span class="hs-identifier hs-var">IntOrOp</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-490"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span>
</span><span id="line-491"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntOrOp"><span class="hs-identifier hs-var">IntOrOp</span></a></span><span>
</span><span id="line-492"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules"><span class="hs-identifier hs-var">orFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#intOps"><span class="hs-identifier hs-var">intOps</span></a></span><span>
</span><span id="line-493"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-494"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntXorOp"><span class="hs-identifier hs-var">IntXorOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span>
</span><span id="line-496"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-497"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntNotOp"><span class="hs-identifier hs-var">IntNotOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-var">complementOp</span></a></span><span>
</span><span id="line-498"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntNotOp"><span class="hs-identifier hs-var">IntNotOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-499"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntNegOp"><span class="hs-identifier hs-var">IntNegOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-var">negOp</span></a></span><span>
</span><span id="line-500"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntNegOp"><span class="hs-identifier hs-var">IntNegOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-501"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSllOp"><span class="hs-identifier hs-var">IntSllOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-503"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSraOp"><span class="hs-identifier hs-var">IntSraOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-identifier hs-var">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-505"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSrlOp"><span class="hs-identifier hs-var">IntSrlOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogicalNative"><span class="hs-identifier hs-var">shiftRightLogicalNative</span></a></span><span>
</span><span id="line-506"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span>   </span><span class="hs-comment">-- Word operations</span><span>
</span><span id="line-509"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAddOp"><span class="hs-identifier hs-var">WordAddOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span>
</span><span id="line-511"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var">addFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAddOp"><span class="hs-identifier hs-var">WordAddOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOps"><span class="hs-identifier hs-var">wordOps</span></a></span><span>
</span><span id="line-512"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-513"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordSubOp"><span class="hs-identifier hs-var">WordSubOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span>
</span><span id="line-515"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span>
</span><span id="line-516"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var">subFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordSubOp"><span class="hs-identifier hs-var">WordSubOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOps"><span class="hs-identifier hs-var">wordOps</span></a></span><span>
</span><span id="line-517"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-518"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAddCOp"><span class="hs-identifier hs-var">WordAddCOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOpC2"><span class="hs-identifier hs-var">wordOpC2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityCPlatform"><span class="hs-identifier hs-var">identityCPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-520"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordSubCOp"><span class="hs-identifier hs-var">WordSubCOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOpC2"><span class="hs-identifier hs-var">wordOpC2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityCPlatform"><span class="hs-identifier hs-var">rightIdentityCPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span>
</span><span id="line-522"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLitNoC"><span class="hs-identifier hs-var">retLitNoC</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-523"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordMulOp"><span class="hs-identifier hs-var">WordMulOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onew"><span class="hs-identifier hs-var">onew</span></a></span><span>
</span><span id="line-525"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var">mulFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordMulOp"><span class="hs-identifier hs-var">WordMulOp</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOps"><span class="hs-identifier hs-var">wordOps</span></a></span><span>
</span><span id="line-526"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-527"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordQuotOp"><span class="hs-identifier hs-var">WordQuotOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onew"><span class="hs-identifier hs-var">onew</span></a></span><span>
</span><span id="line-529"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var">quotFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOps"><span class="hs-identifier hs-var">wordOps</span></a></span><span>
</span><span id="line-530"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-531"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordRemOp"><span class="hs-identifier hs-var">WordRemOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-533"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var">oneLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span>
</span><span id="line-534"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-535"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-537"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var">zeroElem</span></a></span><span>
</span><span id="line-538"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682930594"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682930594"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord"><span class="hs-identifier hs-var">mkLitWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682930594"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer
</span><a href="GHC.Platform.html#platformMaxWord"><span class="hs-identifier hs-var">platformMaxWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682930594"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span>
</span><span id="line-540"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules"><span class="hs-identifier hs-var">andFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOps"><span class="hs-identifier hs-var">wordOps</span></a></span><span>
</span><span id="line-541"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-542"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordOrOp"><span class="hs-identifier hs-var">WordOrOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var">idempotent</span></a></span><span>
</span><span id="line-544"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span>
</span><span id="line-545"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var">sameArgIdempotentCommut</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordOrOp"><span class="hs-identifier hs-var">WordOrOp</span></a></span><span>
</span><span id="line-546"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules"><span class="hs-identifier hs-var">orFoldingRules</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOps"><span class="hs-identifier hs-var">wordOps</span></a></span><span>
</span><span id="line-547"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-548"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordXorOp"><span class="hs-identifier hs-var">WordXorOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var">identityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span>
</span><span id="line-550"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var">retLit</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var">zerow</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-551"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordNotOp"><span class="hs-identifier hs-var">WordNotOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-var">complementOp</span></a></span><span>
</span><span id="line-552"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordNotOp"><span class="hs-identifier hs-var">WordNotOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-553"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordSllOp"><span class="hs-identifier hs-var">WordSllOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; ConTagZ -&gt; Integer)
-&gt; Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-554"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordSrlOp"><span class="hs-identifier hs-var">WordSrlOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var">shiftRule</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogicalNative"><span class="hs-identifier hs-var">shiftRightLogicalNative</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#PopCnt8Op"><span class="hs-identifier hs-var">PopCnt8Op</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#pop_count"><span class="hs-identifier hs-var">pop_count</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-557"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#PopCnt16Op"><span class="hs-identifier hs-var">PopCnt16Op</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#pop_count"><span class="hs-identifier hs-var">pop_count</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-558"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#PopCnt32Op"><span class="hs-identifier hs-var">PopCnt32Op</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#pop_count"><span class="hs-identifier hs-var">pop_count</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-559"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#PopCnt64Op"><span class="hs-identifier hs-var">PopCnt64Op</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#pop_count"><span class="hs-identifier hs-var">pop_count</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-560"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#PopCntOp"><span class="hs-identifier hs-var">PopCntOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM PlatformWordSize
</span><a href="GHC.Core.Opt.ConstantFold.html#getWordSize"><span class="hs-identifier hs-var">getWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM PlatformWordSize
-&gt; (PlatformWordSize -&gt; RuleM CoreExpr) -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-561"></span><span>                                        </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#pop_count"><span class="hs-identifier hs-var">pop_count</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-562"></span><span>                                        </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#pop_count"><span class="hs-identifier hs-var">pop_count</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-563"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Ctz8Op"><span class="hs-identifier hs-var">Ctz8Op</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ctz"><span class="hs-identifier hs-var">ctz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-566"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Ctz16Op"><span class="hs-identifier hs-var">Ctz16Op</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ctz"><span class="hs-identifier hs-var">ctz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-567"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Ctz32Op"><span class="hs-identifier hs-var">Ctz32Op</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ctz"><span class="hs-identifier hs-var">ctz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-568"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Ctz64Op"><span class="hs-identifier hs-var">Ctz64Op</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ctz"><span class="hs-identifier hs-var">ctz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-569"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CtzOp"><span class="hs-identifier hs-var">CtzOp</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM PlatformWordSize
</span><a href="GHC.Core.Opt.ConstantFold.html#getWordSize"><span class="hs-identifier hs-var">getWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM PlatformWordSize
-&gt; (PlatformWordSize -&gt; RuleM CoreExpr) -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-570"></span><span>                                        </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ctz"><span class="hs-identifier hs-var">ctz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-571"></span><span>                                        </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ctz"><span class="hs-identifier hs-var">ctz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-572"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Clz8Op"><span class="hs-identifier hs-var">Clz8Op</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#clz"><span class="hs-identifier hs-var">clz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-575"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Clz16Op"><span class="hs-identifier hs-var">Clz16Op</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#clz"><span class="hs-identifier hs-var">clz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-576"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Clz32Op"><span class="hs-identifier hs-var">Clz32Op</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#clz"><span class="hs-identifier hs-var">clz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-577"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Clz64Op"><span class="hs-identifier hs-var">Clz64Op</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#clz"><span class="hs-identifier hs-var">clz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#ClzOp"><span class="hs-identifier hs-var">ClzOp</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM PlatformWordSize
</span><a href="GHC.Core.Opt.ConstantFold.html#getWordSize"><span class="hs-identifier hs-var">getWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM PlatformWordSize
-&gt; (PlatformWordSize -&gt; RuleM CoreExpr) -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-579"></span><span>                                        </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#clz"><span class="hs-identifier hs-var">clz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-580"></span><span>                                        </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#clz"><span class="hs-identifier hs-var">clz</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-581"></span><span>                                    </span><span class="hs-special">]</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>   </span><span class="hs-comment">-- coercions</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8ToIntOp"><span class="hs-identifier hs-var">Int8ToIntOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#convertToIntLit"><span class="hs-identifier hs-var">convertToIntLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-586"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16ToIntOp"><span class="hs-identifier hs-var">Int16ToIntOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#convertToIntLit"><span class="hs-identifier hs-var">convertToIntLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-587"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32ToIntOp"><span class="hs-identifier hs-var">Int32ToIntOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#convertToIntLit"><span class="hs-identifier hs-var">convertToIntLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-588"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64ToIntOp"><span class="hs-identifier hs-var">Int64ToIntOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#convertToIntLit"><span class="hs-identifier hs-var">convertToIntLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-589"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToInt8Op"><span class="hs-identifier hs-var">IntToInt8Op</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#narrowInt8Lit"><span class="hs-identifier hs-var">narrowInt8Lit</span></a></span><span>
</span><span id="line-590"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToInt8Op"><span class="hs-identifier hs-var">IntToInt8Op</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-591"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToInt16Op"><span class="hs-identifier hs-var">IntToInt16Op</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#narrowInt16Lit"><span class="hs-identifier hs-var">narrowInt16Lit</span></a></span><span>
</span><span id="line-592"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToInt16Op"><span class="hs-identifier hs-var">IntToInt16Op</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">16</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToInt32Op"><span class="hs-identifier hs-var">IntToInt32Op</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#narrowInt32Lit"><span class="hs-identifier hs-var">narrowInt32Lit</span></a></span><span>
</span><span id="line-594"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToInt32Op"><span class="hs-identifier hs-var">IntToInt32Op</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">32</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToInt64Op"><span class="hs-identifier hs-var">IntToInt64Op</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#narrowInt64Lit"><span class="hs-identifier hs-var">narrowInt64Lit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8ToWordOp"><span class="hs-identifier hs-var">Word8ToWordOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#convertToWordLit"><span class="hs-identifier hs-var">convertToWordLit</span></a></span><span>
</span><span id="line-598"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Integer -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#extendNarrowPassthrough"><span class="hs-identifier hs-var">extendNarrowPassthrough</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord8Op"><span class="hs-identifier hs-var">WordToWord8Op</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFF</span></span><span>
</span><span id="line-599"></span><span>                                       </span><span class="hs-special">]</span><span>
</span><span id="line-600"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16ToWordOp"><span class="hs-identifier hs-var">Word16ToWordOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#convertToWordLit"><span class="hs-identifier hs-var">convertToWordLit</span></a></span><span>
</span><span id="line-601"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Integer -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#extendNarrowPassthrough"><span class="hs-identifier hs-var">extendNarrowPassthrough</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord16Op"><span class="hs-identifier hs-var">WordToWord16Op</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFFFF</span></span><span>
</span><span id="line-602"></span><span>                                       </span><span class="hs-special">]</span><span>
</span><span id="line-603"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32ToWordOp"><span class="hs-identifier hs-var">Word32ToWordOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#convertToWordLit"><span class="hs-identifier hs-var">convertToWordLit</span></a></span><span>
</span><span id="line-604"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Integer -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#extendNarrowPassthrough"><span class="hs-identifier hs-var">extendNarrowPassthrough</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord32Op"><span class="hs-identifier hs-var">WordToWord32Op</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0xFFFFFFFF</span></span><span>
</span><span id="line-605"></span><span>                                       </span><span class="hs-special">]</span><span>
</span><span id="line-606"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64ToWordOp"><span class="hs-identifier hs-var">Word64ToWordOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#convertToWordLit"><span class="hs-identifier hs-var">convertToWordLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord8Op"><span class="hs-identifier hs-var">WordToWord8Op</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#narrowWord8Lit"><span class="hs-identifier hs-var">narrowWord8Lit</span></a></span><span>
</span><span id="line-609"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord8Op"><span class="hs-identifier hs-var">WordToWord8Op</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-610"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord16Op"><span class="hs-identifier hs-var">WordToWord16Op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#narrowWord16Lit"><span class="hs-identifier hs-var">narrowWord16Lit</span></a></span><span>
</span><span id="line-611"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord16Op"><span class="hs-identifier hs-var">WordToWord16Op</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">16</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-612"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord32Op"><span class="hs-identifier hs-var">WordToWord32Op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#narrowWord32Lit"><span class="hs-identifier hs-var">narrowWord32Lit</span></a></span><span>
</span><span id="line-613"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord32Op"><span class="hs-identifier hs-var">WordToWord32Op</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">32</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-614"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToWord64Op"><span class="hs-identifier hs-var">WordToWord64Op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#narrowWord64Lit"><span class="hs-identifier hs-var">narrowWord64Lit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8ToInt8Op"><span class="hs-identifier hs-var">Word8ToInt8Op</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-617"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8ToWord8Op"><span class="hs-identifier hs-var">Int8ToWord8Op</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-618"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16ToInt16Op"><span class="hs-identifier hs-var">Word16ToInt16Op</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-619"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16ToWord16Op"><span class="hs-identifier hs-var">Int16ToWord16Op</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32ToInt32Op"><span class="hs-identifier hs-var">Word32ToInt32Op</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-621"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32ToWord32Op"><span class="hs-identifier hs-var">Int32ToWord32Op</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-622"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64ToInt64Op"><span class="hs-identifier hs-var">Word64ToInt64Op</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-623"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64ToWord64Op"><span class="hs-identifier hs-var">Int64ToWord64Op</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordToIntOp"><span class="hs-identifier hs-var">WordToIntOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-626"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToWordOp"><span class="hs-identifier hs-var">IntToWordOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumCoerce"><span class="hs-identifier hs-var">litNumCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8IntOp"><span class="hs-identifier hs-var">Narrow8IntOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumNarrow"><span class="hs-identifier hs-var">litNumNarrow</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8IntOp"><span class="hs-identifier hs-var">Narrow8IntOp</span></a></span><span>
</span><span id="line-630"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8IntOp"><span class="hs-identifier hs-var">Narrow8IntOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumesPrimOp"><span class="hs-operator hs-var">`subsumesPrimOp`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16IntOp"><span class="hs-identifier hs-var">Narrow16IntOp</span></a></span><span>
</span><span id="line-631"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8IntOp"><span class="hs-identifier hs-var">Narrow8IntOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumesPrimOp"><span class="hs-operator hs-var">`subsumesPrimOp`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32IntOp"><span class="hs-identifier hs-var">Narrow32IntOp</span></a></span><span>
</span><span id="line-632"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8IntOp"><span class="hs-identifier hs-var">Narrow8IntOp</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-633"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16IntOp"><span class="hs-identifier hs-var">Narrow16IntOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumNarrow"><span class="hs-identifier hs-var">litNumNarrow</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8IntOp"><span class="hs-identifier hs-var">Narrow8IntOp</span></a></span><span>
</span><span id="line-635"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16IntOp"><span class="hs-identifier hs-var">Narrow16IntOp</span></a></span><span>
</span><span id="line-636"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16IntOp"><span class="hs-identifier hs-var">Narrow16IntOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumesPrimOp"><span class="hs-operator hs-var">`subsumesPrimOp`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32IntOp"><span class="hs-identifier hs-var">Narrow32IntOp</span></a></span><span>
</span><span id="line-637"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16IntOp"><span class="hs-identifier hs-var">Narrow16IntOp</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">16</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-638"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32IntOp"><span class="hs-identifier hs-var">Narrow32IntOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumNarrow"><span class="hs-identifier hs-var">litNumNarrow</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8IntOp"><span class="hs-identifier hs-var">Narrow8IntOp</span></a></span><span>
</span><span id="line-640"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16IntOp"><span class="hs-identifier hs-var">Narrow16IntOp</span></a></span><span>
</span><span id="line-641"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32IntOp"><span class="hs-identifier hs-var">Narrow32IntOp</span></a></span><span>
</span><span id="line-642"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#removeOp32"><span class="hs-identifier hs-var">removeOp32</span></a></span><span>
</span><span id="line-643"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32IntOp"><span class="hs-identifier hs-var">Narrow32IntOp</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">32</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-644"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8WordOp"><span class="hs-identifier hs-var">Narrow8WordOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumNarrow"><span class="hs-identifier hs-var">litNumNarrow</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8WordOp"><span class="hs-identifier hs-var">Narrow8WordOp</span></a></span><span>
</span><span id="line-646"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8WordOp"><span class="hs-identifier hs-var">Narrow8WordOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumesPrimOp"><span class="hs-operator hs-var">`subsumesPrimOp`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16WordOp"><span class="hs-identifier hs-var">Narrow16WordOp</span></a></span><span>
</span><span id="line-647"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8WordOp"><span class="hs-identifier hs-var">Narrow8WordOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumesPrimOp"><span class="hs-operator hs-var">`subsumesPrimOp`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32WordOp"><span class="hs-identifier hs-var">Narrow32WordOp</span></a></span><span>
</span><span id="line-648"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8WordOp"><span class="hs-identifier hs-var">Narrow8WordOp</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-649"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16WordOp"><span class="hs-identifier hs-var">Narrow16WordOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumNarrow"><span class="hs-identifier hs-var">litNumNarrow</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8WordOp"><span class="hs-identifier hs-var">Narrow8WordOp</span></a></span><span>
</span><span id="line-651"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16WordOp"><span class="hs-identifier hs-var">Narrow16WordOp</span></a></span><span>
</span><span id="line-652"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16WordOp"><span class="hs-identifier hs-var">Narrow16WordOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumesPrimOp"><span class="hs-operator hs-var">`subsumesPrimOp`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32WordOp"><span class="hs-identifier hs-var">Narrow32WordOp</span></a></span><span>
</span><span id="line-653"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16WordOp"><span class="hs-identifier hs-var">Narrow16WordOp</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">16</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-654"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32WordOp"><span class="hs-identifier hs-var">Narrow32WordOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType -&gt; Platform -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#litNumNarrow"><span class="hs-identifier hs-var">litNumNarrow</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow8WordOp"><span class="hs-identifier hs-var">Narrow8WordOp</span></a></span><span>
</span><span id="line-656"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow16WordOp"><span class="hs-identifier hs-var">Narrow16WordOp</span></a></span><span>
</span><span id="line-657"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var">subsumedByPrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32WordOp"><span class="hs-identifier hs-var">Narrow32WordOp</span></a></span><span>
</span><span id="line-658"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#removeOp32"><span class="hs-identifier hs-var">removeOp32</span></a></span><span>
</span><span id="line-659"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var">narrowSubsumesAnd</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Narrow32WordOp"><span class="hs-identifier hs-var">Narrow32WordOp</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">32</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CastWord64ToDoubleOp"><span class="hs-identifier hs-var">CastWord64ToDoubleOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span>
</span><span id="line-662"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr)
-&gt; (RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682930676"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682930676"><span class="hs-identifier hs-var">_env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-663"></span><span>         </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682930677"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682930677"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-664"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682930678"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682930678"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Double
</span><span class="hs-identifier hs-var">castWord64ToDouble</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682930677"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>             </span><span class="hs-comment">-- we can't represent those float literals in Core until #18897 is fixed</span><span>
</span><span id="line-666"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682930678"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isInfinite</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682930678"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNegativeZero</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682930678"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; CoreExpr
forall b. Double -&gt; Expr b
</span><a href="GHC.Core.html#mkDoubleLitDouble"><span class="hs-identifier hs-var">mkDoubleLitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621682930678"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>         </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-669"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CastWord32ToFloatOp"><span class="hs-identifier hs-var">CastWord32ToFloatOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span>
</span><span id="line-672"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr)
-&gt; (RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682930687"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682930687"><span class="hs-identifier hs-var">_env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-673"></span><span>          </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682930688"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682930688"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-674"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682930689"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682930689"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Float
</span><span class="hs-identifier hs-var">castWord32ToFloat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682930688"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>              </span><span class="hs-comment">-- we can't represent those float literals in Core until #18897 is fixed</span><span>
</span><span id="line-676"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682930689"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isInfinite</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682930689"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNegativeZero</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682930689"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; CoreExpr
forall b. Float -&gt; Expr b
</span><a href="GHC.Core.html#mkFloatLitFloat"><span class="hs-identifier hs-var">mkFloatLitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621682930689"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>          </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CastDoubleToWord64Op"><span class="hs-identifier hs-var">CastDoubleToWord64Op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span>
</span><span id="line-682"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr)
-&gt; (RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682930693"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682930693"><span class="hs-identifier hs-var">_env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-683"></span><span>         </span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682930695"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682930695"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; CoreExpr
forall b. Word64 -&gt; Expr b
</span><a href="GHC.Core.html#mkWord64LitWord64"><span class="hs-identifier hs-var">mkWord64LitWord64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Word64
</span><span class="hs-identifier hs-var">castDoubleToWord64</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682930695"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>         </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-685"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CastFloatToWord32Op"><span class="hs-identifier hs-var">CastFloatToWord32Op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span>
</span><span id="line-688"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr)
-&gt; (RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682930699"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682930699"><span class="hs-identifier hs-var">_env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-689"></span><span>          </span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682930701"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682930701"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; CoreExpr
forall b. Word32 -&gt; Expr b
</span><a href="GHC.Core.html#mkWord32LitWord32"><span class="hs-identifier hs-var">mkWord32LitWord32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Word32
</span><span class="hs-identifier hs-var">castFloatToWord32</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Float
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682930701"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>          </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-691"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#OrdOp"><span class="hs-identifier hs-var">OrdOp</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#charToIntLit"><span class="hs-identifier hs-var">charToIntLit</span></a></span><span>
</span><span id="line-694"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#ChrOp"><span class="hs-identifier hs-var">ChrOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-695"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#ChrOp"><span class="hs-identifier hs-var">ChrOp</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682930707"><span class="annot"><a href="#local-6989586621682930707"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-696"></span><span>                                            </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#litFitsInChar"><span class="hs-identifier hs-type">litFitsInChar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682930707"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>                                            </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-type">liftLit</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#intToCharLit"><span class="hs-identifier hs-type">intToCharLit</span></a></span><span>
</span><span id="line-698"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#OrdOp"><span class="hs-identifier hs-var">OrdOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-699"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatToIntOp"><span class="hs-identifier hs-var">FloatToIntOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#floatToIntLit"><span class="hs-identifier hs-var">floatToIntLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToFloatOp"><span class="hs-identifier hs-var">IntToFloatOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#intToFloatLit"><span class="hs-identifier hs-var">intToFloatLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-701"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleToIntOp"><span class="hs-identifier hs-var">DoubleToIntOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#doubleToIntLit"><span class="hs-identifier hs-var">doubleToIntLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-702"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntToDoubleOp"><span class="hs-identifier hs-var">IntToDoubleOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#intToDoubleLit"><span class="hs-identifier hs-var">intToDoubleLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-703"></span><span>   </span><span class="hs-comment">-- SUP: Not sure what the standard says about precision in the following 2 cases</span><span>
</span><span id="line-704"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatToDoubleOp"><span class="hs-identifier hs-var">FloatToDoubleOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#floatToDoubleLit"><span class="hs-identifier hs-var">floatToDoubleLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-705"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleToFloatOp"><span class="hs-identifier hs-var">DoubleToFloatOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var">liftLit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#doubleToFloatLit"><span class="hs-identifier hs-var">doubleToFloatLit</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span>   </span><span class="hs-comment">-- Float</span><span>
</span><span id="line-708"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatAddOp"><span class="hs-identifier hs-var">FloatAddOp</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#floatOp2"><span class="hs-identifier hs-var">floatOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerof"><span class="hs-identifier hs-var">zerof</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-710"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatSubOp"><span class="hs-identifier hs-var">FloatSubOp</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#floatOp2"><span class="hs-identifier hs-var">floatOp2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerof"><span class="hs-identifier hs-var">zerof</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-712"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatMulOp"><span class="hs-identifier hs-var">FloatMulOp</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#floatOp2"><span class="hs-identifier hs-var">floatOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onef"><span class="hs-identifier hs-var">onef</span></a></span><span>
</span><span id="line-714"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#strengthReduction"><span class="hs-identifier hs-var">strengthReduction</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#twof"><span class="hs-identifier hs-var">twof</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatAddOp"><span class="hs-identifier hs-var">FloatAddOp</span></a></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-715"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatFMAdd"><span class="hs-identifier hs-var">FloatFMAdd</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var">fmaRules</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatFMSub"><span class="hs-identifier hs-var">FloatFMSub</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var">fmaRules</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatFNMAdd"><span class="hs-identifier hs-var">FloatFNMAdd</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var">fmaRules</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatFNMSub"><span class="hs-identifier hs-var">FloatFNMSub</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var">fmaRules</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-719"></span><span>
</span><span id="line-720"></span><span>             </span><span class="hs-comment">-- zeroElem zerof doesn't hold because of NaN</span><span>
</span><span id="line-721"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatDivOp"><span class="hs-identifier hs-var">FloatDivOp</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#guardFloatDiv"><span class="hs-identifier hs-var">guardFloatDiv</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#floatOp2"><span class="hs-identifier hs-var">floatOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(/)</span></span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onef"><span class="hs-identifier hs-var">onef</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-723"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatNegOp"><span class="hs-identifier hs-var">FloatNegOp</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-var">negOp</span></a></span><span>
</span><span id="line-724"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatNegOp"><span class="hs-identifier hs-var">FloatNegOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-725"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatDecode_IntOp"><span class="hs-identifier hs-var">FloatDecode_IntOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#floatDecodeOp"><span class="hs-identifier hs-var">floatDecodeOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-726"></span><span>
</span><span id="line-727"></span><span>   </span><span class="hs-comment">-- Double</span><span>
</span><span id="line-728"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleAddOp"><span class="hs-identifier hs-var">DoubleAddOp</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#doubleOp2"><span class="hs-identifier hs-var">doubleOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerod"><span class="hs-identifier hs-var">zerod</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-730"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleSubOp"><span class="hs-identifier hs-var">DoubleSubOp</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#doubleOp2"><span class="hs-identifier hs-var">doubleOp2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerod"><span class="hs-identifier hs-var">zerod</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-732"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleMulOp"><span class="hs-identifier hs-var">DoubleMulOp</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#doubleOp2"><span class="hs-identifier hs-var">doubleOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var">identity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oned"><span class="hs-identifier hs-var">oned</span></a></span><span>
</span><span id="line-734"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#strengthReduction"><span class="hs-identifier hs-var">strengthReduction</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#twod"><span class="hs-identifier hs-var">twod</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleAddOp"><span class="hs-identifier hs-var">DoubleAddOp</span></a></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-735"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleFMAdd"><span class="hs-identifier hs-var">DoubleFMAdd</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var">fmaRules</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleFMSub"><span class="hs-identifier hs-var">DoubleFMSub</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var">fmaRules</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span>  </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleFNMAdd"><span class="hs-identifier hs-var">DoubleFNMAdd</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var">fmaRules</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-738"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleFNMSub"><span class="hs-identifier hs-var">DoubleFNMSub</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var">fmaRules</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>              </span><span class="hs-comment">-- zeroElem zerod doesn't hold because of NaN</span><span>
</span><span id="line-740"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleDivOp"><span class="hs-identifier hs-var">DoubleDivOp</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#guardDoubleDiv"><span class="hs-identifier hs-var">guardDoubleDiv</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#doubleOp2"><span class="hs-identifier hs-var">doubleOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(/)</span></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oned"><span class="hs-identifier hs-var">oned</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-742"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleNegOp"><span class="hs-identifier hs-var">DoubleNegOp</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-var">negOp</span></a></span><span>
</span><span id="line-743"></span><span>                                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var">semiInversePrimOp</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleNegOp"><span class="hs-identifier hs-var">DoubleNegOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-744"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleDecode_Int64Op"><span class="hs-identifier hs-var">DoubleDecode_Int64Op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var">unaryLit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#doubleDecodeOp"><span class="hs-identifier hs-var">doubleDecodeOp</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span>   </span><span class="hs-comment">-- Relational operators, equality</span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8EqOp"><span class="hs-identifier hs-var">Int8EqOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-749"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8NeOp"><span class="hs-identifier hs-var">Int8NeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16EqOp"><span class="hs-identifier hs-var">Int16EqOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-752"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16NeOp"><span class="hs-identifier hs-var">Int16NeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-753"></span><span>
</span><span id="line-754"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32EqOp"><span class="hs-identifier hs-var">Int32EqOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-755"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32NeOp"><span class="hs-identifier hs-var">Int32NeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64EqOp"><span class="hs-identifier hs-var">Int64EqOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-758"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64NeOp"><span class="hs-identifier hs-var">Int64NeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntEqOp"><span class="hs-identifier hs-var">IntEqOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-761"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntNeOp"><span class="hs-identifier hs-var">IntNeOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8EqOp"><span class="hs-identifier hs-var">Word8EqOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-764"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8NeOp"><span class="hs-identifier hs-var">Word8NeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16EqOp"><span class="hs-identifier hs-var">Word16EqOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-767"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16NeOp"><span class="hs-identifier hs-var">Word16NeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-768"></span><span>
</span><span id="line-769"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32EqOp"><span class="hs-identifier hs-var">Word32EqOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-770"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32NeOp"><span class="hs-identifier hs-var">Word32NeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64EqOp"><span class="hs-identifier hs-var">Word64EqOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-773"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64NeOp"><span class="hs-identifier hs-var">Word64NeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordEqOp"><span class="hs-identifier hs-var">WordEqOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-776"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordNeOp"><span class="hs-identifier hs-var">WordNeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CharEqOp"><span class="hs-identifier hs-var">CharEqOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-779"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CharNeOp"><span class="hs-identifier hs-var">CharNeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var">litEq</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-780"></span><span>
</span><span id="line-781"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatEqOp"><span class="hs-identifier hs-var">FloatEqOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-782"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatNeOp"><span class="hs-identifier hs-var">FloatNeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span>
</span><span id="line-783"></span><span>
</span><span id="line-784"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleEqOp"><span class="hs-identifier hs-var">DoubleEqOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-785"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleNeOp"><span class="hs-identifier hs-var">DoubleNeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span>
</span><span id="line-786"></span><span>
</span><span id="line-787"></span><span>   </span><span class="hs-comment">-- Relational operators, ordering</span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8GtOp"><span class="hs-identifier hs-var">Int8GtOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-790"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8GeOp"><span class="hs-identifier hs-var">Int8GeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-791"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8LeOp"><span class="hs-identifier hs-var">Int8LeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-792"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8LtOp"><span class="hs-identifier hs-var">Int8LtOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16GtOp"><span class="hs-identifier hs-var">Int16GtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-795"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16GeOp"><span class="hs-identifier hs-var">Int16GeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-796"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16LeOp"><span class="hs-identifier hs-var">Int16LeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-797"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16LtOp"><span class="hs-identifier hs-var">Int16LtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32GtOp"><span class="hs-identifier hs-var">Int32GtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-800"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32GeOp"><span class="hs-identifier hs-var">Int32GeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-801"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32LeOp"><span class="hs-identifier hs-var">Int32LeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-802"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32LtOp"><span class="hs-identifier hs-var">Int32LtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64GtOp"><span class="hs-identifier hs-var">Int64GtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-805"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64GeOp"><span class="hs-identifier hs-var">Int64GeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-806"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64LeOp"><span class="hs-identifier hs-var">Int64LeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-807"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64LtOp"><span class="hs-identifier hs-var">Int64LtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntGtOp"><span class="hs-identifier hs-var">IntGtOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-810"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntGeOp"><span class="hs-identifier hs-var">IntGeOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-811"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntLeOp"><span class="hs-identifier hs-var">IntLeOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-812"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntLtOp"><span class="hs-identifier hs-var">IntLtOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8GtOp"><span class="hs-identifier hs-var">Word8GtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-815"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8GeOp"><span class="hs-identifier hs-var">Word8GeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-816"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8LeOp"><span class="hs-identifier hs-var">Word8LeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-817"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8LtOp"><span class="hs-identifier hs-var">Word8LtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-818"></span><span>
</span><span id="line-819"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16GtOp"><span class="hs-identifier hs-var">Word16GtOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-820"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16GeOp"><span class="hs-identifier hs-var">Word16GeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-821"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16LeOp"><span class="hs-identifier hs-var">Word16LeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-822"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16LtOp"><span class="hs-identifier hs-var">Word16LtOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32GtOp"><span class="hs-identifier hs-var">Word32GtOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-825"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32GeOp"><span class="hs-identifier hs-var">Word32GeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-826"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32LeOp"><span class="hs-identifier hs-var">Word32LeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-827"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32LtOp"><span class="hs-identifier hs-var">Word32LtOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64GtOp"><span class="hs-identifier hs-var">Word64GtOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-830"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64GeOp"><span class="hs-identifier hs-var">Word64GeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-831"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64LeOp"><span class="hs-identifier hs-var">Word64LeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-832"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64LtOp"><span class="hs-identifier hs-var">Word64LtOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordGtOp"><span class="hs-identifier hs-var">WordGtOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-835"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordGeOp"><span class="hs-identifier hs-var">WordGeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-836"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordLeOp"><span class="hs-identifier hs-var">WordLeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-837"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordLtOp"><span class="hs-identifier hs-var">WordLtOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CharGtOp"><span class="hs-identifier hs-var">CharGtOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-840"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CharGeOp"><span class="hs-identifier hs-var">CharGeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-841"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CharLeOp"><span class="hs-identifier hs-var">CharLeOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-842"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#CharLtOp"><span class="hs-identifier hs-var">CharLtOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var">mkRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var">boundsCmp</span></a></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatGtOp"><span class="hs-identifier hs-var">FloatGtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>
</span><span id="line-845"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatGeOp"><span class="hs-identifier hs-var">FloatGeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span>
</span><span id="line-846"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatLeOp"><span class="hs-identifier hs-var">FloatLeOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span>
</span><span id="line-847"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatLtOp"><span class="hs-identifier hs-var">FloatLtOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>
</span><span id="line-848"></span><span>
</span><span id="line-849"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleGtOp"><span class="hs-identifier hs-var">DoubleGtOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;)</span></span><span>
</span><span id="line-850"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleGeOp"><span class="hs-identifier hs-var">DoubleGeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&gt;=)</span></span><span>
</span><span id="line-851"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleLeOp"><span class="hs-identifier hs-var">DoubleLeOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;=)</span></span><span>
</span><span id="line-852"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleLtOp"><span class="hs-identifier hs-var">DoubleLtOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var">mkFloatingRelOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(&lt;)</span></span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span>   </span><span class="hs-comment">-- Misc</span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#AddrAddOp"><span class="hs-identifier hs-var">AddrAddOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#SparkOp"><span class="hs-identifier hs-var">SparkOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682930369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sparkRule"><span class="hs-identifier hs-var">sparkRule</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreRule
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-861"></span><span>
</span><span id="line-862"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Doing the business}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-comment">-- useful shorthands</span><span>
</span><span id="line-871"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-type">mkPrimOpRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span>
</span><span id="line-872"></span><span id="mkPrimOpRule"><span class="annot"><span class="annottext">mkPrimOpRule :: Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var hs-var">mkPrimOpRule</span></a></span></span><span> </span><span id="local-6989586621682931039"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931039"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621682931040"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931040"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621682931041"><span class="annot"><span class="annottext">[RuleM CoreExpr]
</span><a href="#local-6989586621682931041"><span class="hs-identifier hs-var">rules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreRule -&gt; Maybe CoreRule
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreRule -&gt; Maybe CoreRule) -&gt; CoreRule -&gt; Maybe CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkBasicRule"><span class="hs-identifier hs-var">mkBasicRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931039"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931040"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RuleM CoreExpr] -&gt; RuleM CoreExpr
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="annot"><span class="annottext">[RuleM CoreExpr]
</span><a href="#local-6989586621682931041"><span class="hs-identifier hs-var">rules</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span>
</span><span id="line-874"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-type">mkRelOpRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682929006"><span class="annot"><a href="#local-6989586621682929006"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621682929006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682929006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682929006"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span>
</span><span id="line-876"></span><span id="mkRelOpRule"><span class="annot"><span class="annottext">mkRelOpRule :: Name
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; [RuleM CoreExpr]
-&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRelOpRule"><span class="hs-identifier hs-var hs-var">mkRelOpRule</span></a></span></span><span> </span><span id="local-6989586621682931044"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931044"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621682931045"><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931045"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span id="local-6989586621682931046"><span class="annot"><span class="annottext">[RuleM CoreExpr]
</span><a href="#local-6989586621682931046"><span class="hs-identifier hs-var">extra</span></a></span></span><span>
</span><span id="line-877"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931044"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">([RuleM CoreExpr] -&gt; Maybe CoreRule)
-&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><span class="annottext">(forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryCmpLit"><span class="hs-identifier hs-var">binaryCmpLit</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931045"><span class="hs-identifier hs-var">cmp</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; [RuleM CoreExpr] -&gt; [RuleM CoreExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="#local-6989586621682931050"><span class="hs-identifier hs-var">equal_rule</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; [RuleM CoreExpr] -&gt; [RuleM CoreExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[RuleM CoreExpr]
</span><a href="#local-6989586621682931046"><span class="hs-identifier hs-var">extra</span></a></span><span>
</span><span id="line-879"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-880"></span><span>        </span><span class="hs-comment">-- x `cmp` x does not depend on x, so</span><span>
</span><span id="line-881"></span><span>        </span><span class="hs-comment">-- compute it for the arbitrary value 'True'</span><span>
</span><span id="line-882"></span><span>        </span><span class="hs-comment">-- and use that result</span><span>
</span><span id="line-883"></span><span>    </span><span id="local-6989586621682931050"><span class="annot"><span class="annottext">equal_rule :: RuleM CoreExpr
</span><a href="#local-6989586621682931050"><span class="hs-identifier hs-var hs-var">equal_rule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var">equalArgs</span></a></span><span>
</span><span id="line-884"></span><span>                    </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682931051"><span class="annot"><a href="#local-6989586621682931051"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-885"></span><span>                    </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682931045"><span class="hs-identifier hs-type">cmp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-886"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-type">trueValInt</span></a></span><span>  </span><span class="annot"><a href="#local-6989586621682931051"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-887"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-type">falseValInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931051"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="hs-comment">{- Note [Rules for floating-point comparisons]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We need different rules for floating-point values because for floats
it is not true that x = x (for NaNs); so we do not want the equal_rule
rule that mkRelOpRule uses.

Note also that, in the case of equality/inequality, we do /not/
want to switch to a case-expression.  For example, we do not want
to convert
   case (eqFloat# x 3.8#) of
     True -&gt; this
     False -&gt; that
to
  case x of
    3.8#::Float# -&gt; this
    _            -&gt; that
See #9238.  Reason: comparing floating-point values for equality
delicate, and we don't want to implement that delicacy in the code for
case expressions.  So we make it an invariant of Core that a case
expression never scrutinises a Float# or Double#.

This transformation is what the litEq rule does;
see Note [The litEq rule: converting equality to case].
So we /refrain/ from using litEq for mkFloatingRelOpRule.
-}</span><span>
</span><span id="line-914"></span><span>
</span><span id="line-915"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-type">mkFloatingRelOpRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682931054"><span class="annot"><a href="#local-6989586621682931054"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621682931054"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931054"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931054"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-916"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span>
</span><span id="line-917"></span><span class="hs-comment">-- See Note [Rules for floating-point comparisons]</span><span>
</span><span id="line-918"></span><span id="mkFloatingRelOpRule"><span class="annot"><span class="annottext">mkFloatingRelOpRule :: Name -&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatingRelOpRule"><span class="hs-identifier hs-var hs-var">mkFloatingRelOpRule</span></a></span></span><span> </span><span id="local-6989586621682931055"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931055"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621682931056"><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931056"><span class="hs-identifier hs-var">cmp</span></a></span></span><span>
</span><span id="line-919"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; [RuleM CoreExpr] -&gt; Maybe CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkPrimOpRule"><span class="hs-identifier hs-var">mkPrimOpRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931055"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryCmpLit"><span class="hs-identifier hs-var">binaryCmpLit</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931056"><span class="hs-identifier hs-var">cmp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-920"></span><span>
</span><span id="line-921"></span><span class="hs-comment">-- common constants</span><span>
</span><span id="line-922"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-type">zeroi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-type">onei</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-type">zerow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#onew"><span class="hs-identifier hs-type">onew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-923"></span><span id="zeroi"><span class="annot"><span class="annottext">zeroi :: Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var hs-var">zeroi</span></a></span></span><span> </span><span id="local-6989586621682931059"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931059"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931059"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-924"></span><span id="onei"><span class="annot"><span class="annottext">onei :: Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-var hs-var">onei</span></a></span></span><span>  </span><span id="local-6989586621682931060"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931060"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931060"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-925"></span><span id="zerow"><span class="annot"><span class="annottext">zerow :: Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerow"><span class="hs-identifier hs-var hs-var">zerow</span></a></span></span><span> </span><span id="local-6989586621682931061"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931061"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord"><span class="hs-identifier hs-var">mkLitWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931061"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-926"></span><span id="onew"><span class="annot"><span class="annottext">onew :: Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onew"><span class="hs-identifier hs-var hs-var">onew</span></a></span></span><span>  </span><span id="local-6989586621682931062"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931062"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord"><span class="hs-identifier hs-var">mkLitWord</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931062"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-927"></span><span>
</span><span id="line-928"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-type">zeroI8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneI8"><span class="hs-identifier hs-type">oneI8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-type">zeroW8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneW8"><span class="hs-identifier hs-type">oneW8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-929"></span><span id="zeroI8"><span class="annot"><span class="annottext">zeroI8 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI8"><span class="hs-identifier hs-var hs-var">zeroI8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt8"><span class="hs-identifier hs-var">mkLitInt8</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-930"></span><span id="oneI8"><span class="annot"><span class="annottext">oneI8 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI8"><span class="hs-identifier hs-var hs-var">oneI8</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt8"><span class="hs-identifier hs-var">mkLitInt8</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-931"></span><span id="zeroW8"><span class="annot"><span class="annottext">zeroW8 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW8"><span class="hs-identifier hs-var hs-var">zeroW8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord8"><span class="hs-identifier hs-var">mkLitWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-932"></span><span id="oneW8"><span class="annot"><span class="annottext">oneW8 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW8"><span class="hs-identifier hs-var hs-var">oneW8</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord8"><span class="hs-identifier hs-var">mkLitWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-type">zeroI16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneI16"><span class="hs-identifier hs-type">oneI16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-type">zeroW16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneW16"><span class="hs-identifier hs-type">oneW16</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-935"></span><span id="zeroI16"><span class="annot"><span class="annottext">zeroI16 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI16"><span class="hs-identifier hs-var hs-var">zeroI16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt16"><span class="hs-identifier hs-var">mkLitInt16</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-936"></span><span id="oneI16"><span class="annot"><span class="annottext">oneI16 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI16"><span class="hs-identifier hs-var hs-var">oneI16</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt16"><span class="hs-identifier hs-var">mkLitInt16</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-937"></span><span id="zeroW16"><span class="annot"><span class="annottext">zeroW16 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW16"><span class="hs-identifier hs-var hs-var">zeroW16</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord16"><span class="hs-identifier hs-var">mkLitWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-938"></span><span id="oneW16"><span class="annot"><span class="annottext">oneW16 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW16"><span class="hs-identifier hs-var hs-var">oneW16</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord16"><span class="hs-identifier hs-var">mkLitWord16</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-type">zeroI32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneI32"><span class="hs-identifier hs-type">oneI32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-type">zeroW32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneW32"><span class="hs-identifier hs-type">oneW32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-941"></span><span id="zeroI32"><span class="annot"><span class="annottext">zeroI32 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI32"><span class="hs-identifier hs-var hs-var">zeroI32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt32"><span class="hs-identifier hs-var">mkLitInt32</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-942"></span><span id="oneI32"><span class="annot"><span class="annottext">oneI32 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI32"><span class="hs-identifier hs-var hs-var">oneI32</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt32"><span class="hs-identifier hs-var">mkLitInt32</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-943"></span><span id="zeroW32"><span class="annot"><span class="annottext">zeroW32 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW32"><span class="hs-identifier hs-var hs-var">zeroW32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord32"><span class="hs-identifier hs-var">mkLitWord32</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-944"></span><span id="oneW32"><span class="annot"><span class="annottext">oneW32 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW32"><span class="hs-identifier hs-var hs-var">oneW32</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord32"><span class="hs-identifier hs-var">mkLitWord32</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-type">zeroI64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneI64"><span class="hs-identifier hs-type">oneI64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-type">zeroW64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneW64"><span class="hs-identifier hs-type">oneW64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-947"></span><span id="zeroI64"><span class="annot"><span class="annottext">zeroI64 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroI64"><span class="hs-identifier hs-var hs-var">zeroI64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt64"><span class="hs-identifier hs-var">mkLitInt64</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-948"></span><span id="oneI64"><span class="annot"><span class="annottext">oneI64 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneI64"><span class="hs-identifier hs-var hs-var">oneI64</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt64"><span class="hs-identifier hs-var">mkLitInt64</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-949"></span><span id="zeroW64"><span class="annot"><span class="annottext">zeroW64 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroW64"><span class="hs-identifier hs-var hs-var">zeroW64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord64"><span class="hs-identifier hs-var">mkLitWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-950"></span><span id="oneW64"><span class="annot"><span class="annottext">oneW64 :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oneW64"><span class="hs-identifier hs-var hs-var">oneW64</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord64"><span class="hs-identifier hs-var">mkLitWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-951"></span><span>
</span><span id="line-952"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zerof"><span class="hs-identifier hs-type">zerof</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#onef"><span class="hs-identifier hs-type">onef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#twof"><span class="hs-identifier hs-type">twof</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zerod"><span class="hs-identifier hs-type">zerod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oned"><span class="hs-identifier hs-type">oned</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#twod"><span class="hs-identifier hs-type">twod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-953"></span><span id="zerof"><span class="annot"><span class="annottext">zerof :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerof"><span class="hs-identifier hs-var hs-var">zerof</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitFloat"><span class="hs-identifier hs-var">mkLitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-954"></span><span id="onef"><span class="annot"><span class="annottext">onef :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onef"><span class="hs-identifier hs-var hs-var">onef</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitFloat"><span class="hs-identifier hs-var">mkLitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.0</span></span><span>
</span><span id="line-955"></span><span id="twof"><span class="annot"><span class="annottext">twof :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#twof"><span class="hs-identifier hs-var hs-var">twof</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitFloat"><span class="hs-identifier hs-var">mkLitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2.0</span></span><span>
</span><span id="line-956"></span><span id="zerod"><span class="annot"><span class="annottext">zerod :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zerod"><span class="hs-identifier hs-var hs-var">zerod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitDouble"><span class="hs-identifier hs-var">mkLitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-957"></span><span id="oned"><span class="annot"><span class="annottext">oned :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#oned"><span class="hs-identifier hs-var hs-var">oned</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitDouble"><span class="hs-identifier hs-var">mkLitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1.0</span></span><span>
</span><span id="line-958"></span><span id="twod"><span class="annot"><span class="annottext">twod :: Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#twod"><span class="hs-identifier hs-var hs-var">twod</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitDouble"><span class="hs-identifier hs-var">mkLitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2.0</span></span><span>
</span><span id="line-959"></span><span>
</span><span id="line-960"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#cmpOp"><span class="hs-identifier hs-type">cmpOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682931070"><span class="annot"><a href="#local-6989586621682931070"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621682931070"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931070"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931070"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-961"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-962"></span><span id="cmpOp"><span class="annot"><span class="annottext">cmpOp :: Platform
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; Literal
-&gt; Literal
-&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#cmpOp"><span class="hs-identifier hs-var hs-var">cmpOp</span></a></span></span><span> </span><span id="local-6989586621682931071"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931071"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931072"><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931072"><span class="hs-identifier hs-var">cmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931073"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-963"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-964"></span><span>    </span><span id="local-6989586621682931074"><span class="annot"><span class="annottext">done :: Bool -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931074"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-var">trueValInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931071"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-965"></span><span>    </span><span class="annot"><a href="#local-6989586621682931074"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-var">falseValInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931071"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-966"></span><span>
</span><span id="line-967"></span><span>    </span><span class="hs-comment">-- These compares are at different types</span><span>
</span><span id="line-968"></span><span>    </span><span id="local-6989586621682931073"><span class="annot"><span class="annottext">go :: Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931073"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitChar"><span class="hs-identifier hs-type">LitChar</span></a></span><span> </span><span id="local-6989586621682931076"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682931076"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitChar"><span class="hs-identifier hs-type">LitChar</span></a></span><span> </span><span id="local-6989586621682931077"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682931077"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931074"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682931076"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931072"><span class="hs-operator hs-var">`cmp`</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621682931077"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>    </span><span class="annot"><a href="#local-6989586621682931073"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931078"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931078"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931079"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931079"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931074"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931078"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931072"><span class="hs-operator hs-var">`cmp`</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931079"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>    </span><span class="annot"><a href="#local-6989586621682931073"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931080"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931080"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931081"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931081"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931074"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931080"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931072"><span class="hs-operator hs-var">`cmp`</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931081"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>    </span><span class="annot"><a href="#local-6989586621682931073"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span id="local-6989586621682931082"><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931082"><span class="hs-identifier hs-var">nt1</span></a></span></span><span> </span><span id="local-6989586621682931083"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931083"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span id="local-6989586621682931084"><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931084"><span class="hs-identifier hs-var">nt2</span></a></span></span><span> </span><span id="local-6989586621682931085"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931085"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931082"><span class="hs-identifier hs-var">nt1</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType -&gt; LitNumType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931084"><span class="hs-identifier hs-var">nt2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-973"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931074"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931083"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931072"><span class="hs-operator hs-var">`cmp`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931085"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>    </span><span class="annot"><a href="#local-6989586621682931073"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>               </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-975"></span><span>
</span><span id="line-976"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-977"></span><span>
</span><span id="line-978"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-type">negOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>  </span><span class="hs-comment">-- Negate</span><span>
</span><span id="line-979"></span><span id="negOp"><span class="annot"><span class="annottext">negOp :: RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#negOp"><span class="hs-identifier hs-var hs-var">negOp</span></a></span></span><span> </span><span id="local-6989586621682931086"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931086"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-980"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-comment">-- can't represent -0.0 as a Rational</span><span>
</span><span id="line-981"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931087"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931087"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Rational -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatVal"><span class="hs-identifier hs-var">mkFloatVal</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931086"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931087"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-982"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-983"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931089"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931089"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Rational -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkDoubleVal"><span class="hs-identifier hs-var">mkDoubleVal</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931086"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931089"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-984"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span id="local-6989586621682931091"><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931091"><span class="hs-identifier hs-var">nt</span></a></span></span><span> </span><span id="local-6989586621682931092"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931092"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LitNumType -&gt; Bool
</span><a href="GHC.Types.Literal.html#litNumIsSigned"><span class="hs-identifier hs-var">litNumIsSigned</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931091"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitNumberWrap"><span class="hs-identifier hs-var">mkLitNumberWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931086"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931091"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931092"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-986"></span><span>   </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-type">complementOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>  </span><span class="hs-comment">-- Binary complement</span><span>
</span><span id="line-989"></span><span id="complementOp"><span class="annot"><span class="annottext">complementOp :: RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-var hs-var">complementOp</span></a></span></span><span> </span><span id="local-6989586621682931096"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931096"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span id="local-6989586621682931097"><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931097"><span class="hs-identifier hs-var">nt</span></a></span></span><span> </span><span id="local-6989586621682931098"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931098"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-990"></span><span>   </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitNumberWrap"><span class="hs-identifier hs-var">mkLitNumberWrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931096"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931097"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931098"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#complementOp"><span class="hs-identifier hs-var">complementOp</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span>      </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span id="local-6989586621682928965"><span id="local-6989586621682928966"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int8Op2"><span class="hs-identifier hs-type">int8Op2</span></a></span><span>
</span><span id="line-994"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682928965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682928966"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-995"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682928965"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682928966"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-996"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-997"></span><span id="int8Op2"><span class="annot"><span class="annottext">int8Op2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Op2"><span class="hs-identifier hs-var hs-var">int8Op2</span></a></span></span><span> </span><span id="local-6989586621682931110"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931110"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span> </span><span id="local-6989586621682931111"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931111"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span> </span><span id="local-6989586621682931112"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931112"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-998"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Result"><span class="hs-identifier hs-var">int8Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931111"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931110"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931112"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int8Op2"><span class="hs-identifier hs-var">int8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1000"></span><span>
</span><span id="line-1001"></span><span id="local-6989586621682931114"><span id="local-6989586621682931115"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int16Op2"><span class="hs-identifier hs-type">int16Op2</span></a></span><span>
</span><span id="line-1002"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931114"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931115"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1003"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931114"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931115"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1004"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1005"></span><span id="int16Op2"><span class="annot"><span class="annottext">int16Op2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Op2"><span class="hs-identifier hs-var hs-var">int16Op2</span></a></span></span><span> </span><span id="local-6989586621682931124"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931124"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span> </span><span id="local-6989586621682931125"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931125"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span> </span><span id="local-6989586621682931126"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931126"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1006"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Result"><span class="hs-identifier hs-var">int16Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931125"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931124"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931126"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int16Op2"><span class="hs-identifier hs-var">int16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span id="local-6989586621682931128"><span id="local-6989586621682931129"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int32Op2"><span class="hs-identifier hs-type">int32Op2</span></a></span><span>
</span><span id="line-1010"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931128"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931129"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1011"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931128"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931129"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1012"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1013"></span><span id="int32Op2"><span class="annot"><span class="annottext">int32Op2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Op2"><span class="hs-identifier hs-var hs-var">int32Op2</span></a></span></span><span> </span><span id="local-6989586621682931138"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931138"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span> </span><span id="local-6989586621682931139"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931139"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span> </span><span id="local-6989586621682931140"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931140"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1014"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Result"><span class="hs-identifier hs-var">int32Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931139"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931138"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931140"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1015"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int32Op2"><span class="hs-identifier hs-var">int32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1016"></span><span>
</span><span id="line-1017"></span><span id="local-6989586621682931142"><span id="local-6989586621682931143"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int64Op2"><span class="hs-identifier hs-type">int64Op2</span></a></span><span>
</span><span id="line-1018"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931142"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931143"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931142"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931143"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1021"></span><span id="int64Op2"><span class="annot"><span class="annottext">int64Op2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Op2"><span class="hs-identifier hs-var hs-var">int64Op2</span></a></span></span><span> </span><span id="local-6989586621682931152"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931152"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span> </span><span id="local-6989586621682931153"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931153"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span> </span><span id="local-6989586621682931154"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931154"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1022"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Result"><span class="hs-identifier hs-var">int64Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931153"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931152"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931154"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int64Op2"><span class="hs-identifier hs-var">int64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1024"></span><span>
</span><span id="line-1025"></span><span id="local-6989586621682931156"><span id="local-6989586621682931157"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-type">intOp2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931156"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931157"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1026"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931156"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931157"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1028"></span><span id="intOp2"><span class="annot"><span class="annottext">intOp2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var hs-var">intOp2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(RuleOpts -&gt; a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2%27"><span class="hs-identifier hs-var">intOp2'</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; a -&gt; b -&gt; Integer)
 -&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; ((a -&gt; b -&gt; Integer) -&gt; RuleOpts -&gt; a -&gt; b -&gt; Integer)
-&gt; (a -&gt; b -&gt; Integer)
-&gt; RuleOpts
-&gt; Literal
-&gt; Literal
-&gt; Maybe CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; Integer) -&gt; RuleOpts -&gt; a -&gt; b -&gt; Integer
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-1029"></span><span>
</span><span id="line-1030"></span><span id="local-6989586621682929105"><span id="local-6989586621682929106"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intOp2%27"><span class="hs-identifier hs-type">intOp2'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682929105"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682929106"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1031"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682929105"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682929106"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1032"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1033"></span><span id="intOp2%27"><span class="annot"><span class="annottext">intOp2' :: forall a b.
(Integral a, Integral b) =&gt;
(RuleOpts -&gt; a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2%27"><span class="hs-identifier hs-var hs-var">intOp2'</span></a></span></span><span> </span><span id="local-6989586621682931172"><span class="annot"><span class="annottext">RuleOpts -&gt; a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931172"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682931173"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931173"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span id="local-6989586621682931174"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931174"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span id="local-6989586621682931175"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931175"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1034"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682931176"><span class="annot"><span class="annottext">o :: a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931176"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931172"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931173"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1035"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intResult"><span class="hs-identifier hs-var">intResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931173"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931174"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931176"><span class="hs-operator hs-var">`o`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931175"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intOp2%27"><span class="hs-identifier hs-var">intOp2'</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1037"></span><span>
</span><span id="line-1038"></span><span id="local-6989586621682931178"><span id="local-6989586621682931179"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intOpC2"><span class="hs-identifier hs-type">intOpC2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931179"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931179"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1041"></span><span id="intOpC2"><span class="annot"><span class="annottext">intOpC2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOpC2"><span class="hs-identifier hs-var hs-var">intOpC2</span></a></span></span><span> </span><span id="local-6989586621682931188"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931188"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682931189"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931189"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span id="local-6989586621682931190"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931190"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span id="local-6989586621682931191"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931191"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1042"></span><span>  </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intCResult"><span class="hs-identifier hs-var">intCResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931189"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931190"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931188"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931191"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intOpC2"><span class="hs-identifier hs-var">intOpC2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1044"></span><span>
</span><span id="line-1045"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-type">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682928986"><span class="annot"><a href="#local-6989586621682928986"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682928986"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bits</span></span><span> </span><span class="annot"><a href="#local-6989586621682928986"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1046"></span><span id="shiftRightLogical"><span class="annot"><span class="annottext">shiftRightLogical :: forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var hs-var">shiftRightLogical</span></a></span></span><span> </span><span id="local-6989586621682931201"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931201"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682931202"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931202"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; t
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931201"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; ConTagZ -&gt; t
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931202"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682928986"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span class="hs-comment">-- | Shift right, putting zeros in rather than sign-propagating as</span><span>
</span><span id="line-1049"></span><span class="hs-comment">-- 'Bits.shiftR' would do. Do this by converting to the appropriate Word</span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- and back. Obviously this won't work for too-big values, but its ok as</span><span>
</span><span id="line-1051"></span><span class="hs-comment">-- we use it here.</span><span>
</span><span id="line-1052"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogicalNative"><span class="hs-identifier hs-type">shiftRightLogicalNative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1053"></span><span id="shiftRightLogicalNative"><span class="annot"><span class="annottext">shiftRightLogicalNative :: Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogicalNative"><span class="hs-identifier hs-var hs-var">shiftRightLogicalNative</span></a></span></span><span> </span><span id="local-6989586621682931203"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931203"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1054"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931203"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1055"></span><span>      </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word32</span></span><span>
</span><span id="line-1056"></span><span>      </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall t. (Integral t, Bits t) =&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRightLogical"><span class="hs-identifier hs-var">shiftRightLogical</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Word64</span></span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-1059"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-type">retLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1060"></span><span id="retLit"><span class="annot"><span class="annottext">retLit :: (Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLit"><span class="hs-identifier hs-var hs-var">retLit</span></a></span></span><span> </span><span id="local-6989586621682931205"><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931205"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682931206"><span class="annot"><a href="#local-6989586621682931206"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1061"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931205"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931206"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-1062"></span><span>
</span><span id="line-1063"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#retLitNoC"><span class="hs-identifier hs-type">retLitNoC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1064"></span><span id="retLitNoC"><span class="annot"><span class="annottext">retLitNoC :: (Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#retLitNoC"><span class="hs-identifier hs-var hs-var">retLitNoC</span></a></span></span><span> </span><span id="local-6989586621682931207"><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931207"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621682931208"><span class="annot"><a href="#local-6989586621682931208"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1065"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682931209"><span class="annot"><a href="#local-6989586621682931209"><span class="hs-identifier hs-var hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931207"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931208"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1066"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-type">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931209"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-type">zeroi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931208"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span id="local-6989586621682931210"><span id="local-6989586621682931211"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-type">word8Op2</span></a></span><span>
</span><span id="line-1069"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931210"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931211"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931210"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931211"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1071"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1072"></span><span id="word8Op2"><span class="annot"><span class="annottext">word8Op2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var hs-var">word8Op2</span></a></span></span><span> </span><span id="local-6989586621682931220"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931220"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span> </span><span id="local-6989586621682931221"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931221"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span> </span><span id="local-6989586621682931222"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931222"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1073"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Result"><span class="hs-identifier hs-var">word8Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931221"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931220"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931222"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1074"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word8Op2"><span class="hs-identifier hs-var">word8Op2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1075"></span><span>
</span><span id="line-1076"></span><span id="local-6989586621682931224"><span id="local-6989586621682931225"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-type">word16Op2</span></a></span><span>
</span><span id="line-1077"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931224"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931225"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1078"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931224"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931225"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1079"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1080"></span><span id="word16Op2"><span class="annot"><span class="annottext">word16Op2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var hs-var">word16Op2</span></a></span></span><span> </span><span id="local-6989586621682931234"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931234"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span> </span><span id="local-6989586621682931235"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931235"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span> </span><span id="local-6989586621682931236"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931236"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1081"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Result"><span class="hs-identifier hs-var">word16Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931235"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931234"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931236"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1082"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word16Op2"><span class="hs-identifier hs-var">word16Op2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span id="local-6989586621682931238"><span id="local-6989586621682931239"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-type">word32Op2</span></a></span><span>
</span><span id="line-1085"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931239"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1086"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931239"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1087"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1088"></span><span id="word32Op2"><span class="annot"><span class="annottext">word32Op2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var hs-var">word32Op2</span></a></span></span><span> </span><span id="local-6989586621682931248"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931248"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span> </span><span id="local-6989586621682931249"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931249"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span> </span><span id="local-6989586621682931250"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931250"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1089"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Result"><span class="hs-identifier hs-var">word32Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931249"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931248"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931250"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word32Op2"><span class="hs-identifier hs-var">word32Op2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1091"></span><span>
</span><span id="line-1092"></span><span id="local-6989586621682931252"><span id="local-6989586621682931253"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-type">word64Op2</span></a></span><span>
</span><span id="line-1093"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931252"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931253"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1094"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931252"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931253"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1095"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1096"></span><span id="word64Op2"><span class="annot"><span class="annottext">word64Op2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var hs-var">word64Op2</span></a></span></span><span> </span><span id="local-6989586621682931262"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931262"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span> </span><span id="local-6989586621682931263"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931263"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span> </span><span id="local-6989586621682931264"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931264"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1097"></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Result"><span class="hs-identifier hs-var">word64Result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931263"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931262"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931264"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word64Op2"><span class="hs-identifier hs-var">word64Op2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1099"></span><span>
</span><span id="line-1100"></span><span id="local-6989586621682931266"><span id="local-6989586621682931267"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-type">wordOp2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931266"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931267"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931267"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1103"></span><span id="wordOp2"><span class="annot"><span class="annottext">wordOp2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var hs-var">wordOp2</span></a></span></span><span> </span><span id="local-6989586621682931276"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931276"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682931277"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931277"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span> </span><span id="local-6989586621682931278"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931278"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span> </span><span id="local-6989586621682931279"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931279"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1104"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordResult"><span class="hs-identifier hs-var">wordResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931277"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931278"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931276"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931279"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1105"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#wordOp2"><span class="hs-identifier hs-var">wordOp2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span id="local-6989586621682931281"><span id="local-6989586621682931282"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#wordOpC2"><span class="hs-identifier hs-type">wordOpC2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931281"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621682931282"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931281"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931282"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1109"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span></span></span><span>
</span><span id="line-1110"></span><span id="wordOpC2"><span class="annot"><span class="annottext">wordOpC2 :: forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOpC2"><span class="hs-identifier hs-var hs-var">wordOpC2</span></a></span></span><span> </span><span id="local-6989586621682931291"><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931291"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682931292"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931292"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span> </span><span id="local-6989586621682931293"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931293"><span class="hs-identifier hs-var">w1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span> </span><span id="local-6989586621682931294"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931294"><span class="hs-identifier hs-var">w2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1111"></span><span>  </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordCResult"><span class="hs-identifier hs-var">wordCResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931292"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; a
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931293"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><a href="#local-6989586621682931291"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; b
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931294"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1112"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#wordOpC2"><span class="hs-identifier hs-var">wordOpC2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1113"></span><span>
</span><span id="line-1114"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-type">shiftRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a></span><span>
</span><span id="line-1115"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1116"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1117"></span><span class="hs-comment">-- Shifts take an Int; hence third arg of op is Int</span><span>
</span><span id="line-1118"></span><span class="hs-comment">-- Used for shift primops</span><span>
</span><span id="line-1119"></span><span class="hs-comment">--    IntSllOp, IntSraOp, IntSrlOp :: Int# -&gt; Int# -&gt; Int#</span><span>
</span><span id="line-1120"></span><span class="hs-comment">--    SllOp, SrlOp                 :: Word# -&gt; Int# -&gt; Word#</span><span>
</span><span id="line-1121"></span><span id="shiftRule"><span class="annot"><span class="annottext">shiftRule :: LitNumType
-&gt; (Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#shiftRule"><span class="hs-identifier hs-var hs-var">shiftRule</span></a></span></span><span> </span><span id="local-6989586621682931296"><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931296"><span class="hs-identifier hs-var">lit_num_ty</span></a></span></span><span> </span><span id="local-6989586621682931297"><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="#local-6989586621682931297"><span class="hs-identifier hs-var">shift_op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1122"></span><span>  </span><span id="local-6989586621682931298"><span class="annot"><a href="#local-6989586621682931298"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1123"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931299"><span class="annot"><a href="#local-6989586621682931299"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-type">LitNumInt</span></a></span><span> </span><span id="local-6989586621682931300"><span class="annot"><a href="#local-6989586621682931300"><span class="hs-identifier hs-var">shift_len</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1124"></span><span>
</span><span id="line-1125"></span><span>  </span><span id="local-6989586621682931301"><span class="annot"><a href="#local-6989586621682931301"><span class="hs-identifier hs-var">bit_size</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#litNumBitSize"><span class="hs-identifier hs-type">litNumBitSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931298"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931296"><span class="hs-identifier hs-type">lit_num_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1126"></span><span>   </span><span class="annot"><span class="annottext">Maybe Word
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM Integer
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1127"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931304"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682931304"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; RuleM Integer
forall a. a -&gt; RuleM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621682931304"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682931299"><span class="hs-identifier hs-type">e1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1130"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931300"><span class="hs-identifier hs-var">shift_len</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931299"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1131"></span><span>
</span><span id="line-1132"></span><span>      </span><span class="hs-comment">-- See Note [Guarding against silly shifts]</span><span>
</span><span id="line-1133"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931300"><span class="hs-identifier hs-var">shift_len</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931300"><span class="hs-identifier hs-var">shift_len</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931301"><span class="hs-identifier hs-var">bit_size</span></a></span><span>
</span><span id="line-1134"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; RuleM CoreExpr) -&gt; CoreExpr -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr) -&gt; Literal -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitNumberWrap"><span class="hs-identifier hs-var">mkLitNumberWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931298"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931296"><span class="hs-identifier hs-var">lit_num_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1135"></span><span>           </span><span class="hs-comment">-- Be sure to use lit_num_ty here, so we get a correctly typed zero.</span><span>
</span><span id="line-1136"></span><span>           </span><span class="hs-comment">-- See #18589</span><span>
</span><span id="line-1137"></span><span>
</span><span id="line-1138"></span><span>    </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span id="local-6989586621682931305"><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931305"><span class="hs-identifier hs-var">nt</span></a></span></span><span> </span><span id="local-6989586621682931306"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931306"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1139"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931300"><span class="hs-identifier hs-var">shift_len</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931300"><span class="hs-identifier hs-var">shift_len</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931301"><span class="hs-identifier hs-var">bit_size</span></a></span><span>
</span><span id="line-1140"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931305"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType -&gt; LitNumType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931296"><span class="hs-identifier hs-var">lit_num_ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; RuleM CoreExpr)
-&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1141"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682931309"><span class="annot"><span class="annottext">op :: Integer -&gt; ConTagZ -&gt; Integer
</span><a href="#local-6989586621682931309"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; ConTagZ -&gt; Integer
</span><a href="#local-6989586621682931297"><span class="hs-identifier hs-var">shift_op</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931298"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1142"></span><span>              </span><span class="hs-comment">-- Do the shift at type Integer, but shift length is Int.</span><span>
</span><span id="line-1143"></span><span>              </span><span class="hs-comment">-- Using host's Int is ok even if target's Int has a different size</span><span>
</span><span id="line-1144"></span><span>              </span><span class="hs-comment">-- because we test that shift_len &lt;= bit_size (which is at most 64)</span><span>
</span><span id="line-1145"></span><span>              </span><span id="local-6989586621682931310"><span class="annot"><span class="annottext">y :: Integer
</span><a href="#local-6989586621682931310"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931306"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
</span><a href="#local-6989586621682931309"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931300"><span class="hs-identifier hs-var">shift_len</span></a></span><span>
</span><span id="line-1146"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; RuleM CoreExpr) -&gt; CoreExpr -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr) -&gt; Literal -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitNumberWrap"><span class="hs-identifier hs-var">mkLitNumberWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931298"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="#local-6989586621682931305"><span class="hs-identifier hs-var">nt</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931310"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1147"></span><span>
</span><span id="line-1148"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1149"></span><span>
</span><span id="line-1150"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-1151"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#floatOp2"><span class="hs-identifier hs-type">floatOp2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-1153"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1154"></span><span id="floatOp2"><span class="annot"><span class="annottext">floatOp2 :: (Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#floatOp2"><span class="hs-identifier hs-var hs-var">floatOp2</span></a></span></span><span> </span><span id="local-6989586621682931312"><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
</span><a href="#local-6989586621682931312"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682931313"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931313"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931314"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931314"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931315"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931315"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1155"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Rational -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatVal"><span class="hs-identifier hs-var">mkFloatVal</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931313"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931314"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
</span><a href="#local-6989586621682931312"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931315"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1156"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#floatOp2"><span class="hs-identifier hs-var">floatOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1157"></span><span>
</span><span id="line-1158"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-1159"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#floatDecodeOp"><span class="hs-identifier hs-type">floatDecodeOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1160"></span><span id="floatDecodeOp"><span class="annot"><span class="annottext">floatDecodeOp :: RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#floatDecodeOp"><span class="hs-identifier hs-var hs-var">floatDecodeOp</span></a></span></span><span> </span><span id="local-6989586621682931316"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931316"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; (Integer, ConTagZ)
forall a. RealFloat a =&gt; a -&gt; (Integer, ConTagZ)
</span><span class="hs-identifier hs-var">decodeFloat</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; (Integer, ConTagZ))
-&gt; (Rational -&gt; Float) -&gt; Rational -&gt; (Integer, ConTagZ)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682931318"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931318"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931319"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931319"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1161"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-var">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkIntVal"><span class="hs-identifier hs-var">mkIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931316"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931318"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1162"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkIntVal"><span class="hs-identifier hs-var">mkIntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931316"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConTagZ -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931319"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1163"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#floatDecodeOp"><span class="hs-identifier hs-var">floatDecodeOp</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-1164"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1165"></span><span>
</span><span id="line-1166"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-1167"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#doubleOp2"><span class="hs-identifier hs-type">doubleOp2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-1169"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1170"></span><span id="doubleOp2"><span class="annot"><span class="annottext">doubleOp2 :: (Rational -&gt; Rational -&gt; Rational)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#doubleOp2"><span class="hs-identifier hs-var hs-var">doubleOp2</span></a></span></span><span> </span><span id="local-6989586621682931321"><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
</span><a href="#local-6989586621682931321"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682931322"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931322"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931323"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931323"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931324"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931324"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1171"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Rational -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkDoubleVal"><span class="hs-identifier hs-var">mkDoubleVal</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931322"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931323"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
</span><a href="#local-6989586621682931321"><span class="hs-operator hs-var">`op`</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931324"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1172"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#doubleOp2"><span class="hs-identifier hs-var">doubleOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1173"></span><span>
</span><span id="line-1174"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-1175"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#doubleDecodeOp"><span class="hs-identifier hs-type">doubleDecodeOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1176"></span><span id="doubleDecodeOp"><span class="annot"><span class="annottext">doubleDecodeOp :: RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#doubleDecodeOp"><span class="hs-identifier hs-var hs-var">doubleDecodeOp</span></a></span></span><span> </span><span id="local-6989586621682931325"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931325"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; (Integer, ConTagZ)
forall a. RealFloat a =&gt; a -&gt; (Integer, ConTagZ)
</span><span class="hs-identifier hs-var">decodeFloat</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; (Integer, ConTagZ))
-&gt; (Rational -&gt; Double) -&gt; Rational -&gt; (Integer, ConTagZ)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682931326"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931326"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931327"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931327"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-var">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt64Wrap"><span class="hs-identifier hs-var">mkLitInt64Wrap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931326"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkIntVal"><span class="hs-identifier hs-var">mkIntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931329"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConTagZ -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931327"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1179"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1180"></span><span>    </span><span id="local-6989586621682931329"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621682931329"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931325"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1181"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#doubleDecodeOp"><span class="hs-identifier hs-var">doubleDecodeOp</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-1182"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1183"></span><span>
</span><span id="line-1184"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-1185"></span><span>
</span><span id="line-1186"></span><span class="annot"><span class="hs-comment">-- | Constant folding rules for fused multiply-add operations.</span></span><span>
</span><span id="line-1187"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-type">fmaRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#FMASign"><span class="hs-identifier hs-type">FMASign</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1188"></span><span id="fmaRules"><span class="annot"><span class="annottext">fmaRules :: FMASign -&gt; Width -&gt; [RuleM CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaRules"><span class="hs-identifier hs-var hs-var">fmaRules</span></a></span></span><span> </span><span id="local-6989586621682931330"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931330"><span class="hs-identifier hs-var">signs</span></a></span></span><span> </span><span id="local-6989586621682931331"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931331"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1189"></span><span>     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaLit"><span class="hs-identifier hs-var">fmaLit</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931330"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931331"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1190"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaZero_z"><span class="hs-identifier hs-var">fmaZero_z</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931330"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931331"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-1191"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; Width -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaOne"><span class="hs-identifier hs-var">fmaOne</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931330"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931331"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1192"></span><span>
</span><span id="line-1193"></span><span class="annot"><span class="hs-comment">-- | Compute @a * b + c@ when @a@, @b@, @c@ are all literals.</span></span><span>
</span><span id="line-1194"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#fmaLit"><span class="hs-identifier hs-type">fmaLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#FMASign"><span class="hs-identifier hs-type">FMASign</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1195"></span><span id="fmaLit"><span class="annot"><span class="annottext">fmaLit :: FMASign -&gt; Width -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaLit"><span class="hs-identifier hs-var hs-var">fmaLit</span></a></span></span><span> </span><span id="local-6989586621682931335"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931335"><span class="hs-identifier hs-var">signs</span></a></span></span><span> </span><span id="local-6989586621682931336"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931336"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1196"></span><span>  </span><span id="local-6989586621682931337"><span class="annot"><a href="#local-6989586621682931337"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-1197"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931339"><span class="annot"><a href="#local-6989586621682931339"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931340"><span class="annot"><a href="#local-6989586621682931340"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931341"><span class="annot"><a href="#local-6989586621682931341"><span class="hs-identifier hs-var">l3</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1198"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-1199"></span><span>    </span><span class="annot"><a href="#local-6989586621682931343"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931337"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-1200"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-type">convFloating</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931337"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931339"><span class="hs-identifier hs-type">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1201"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-type">convFloating</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931337"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931340"><span class="hs-identifier hs-type">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1202"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-type">convFloating</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931337"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931341"><span class="hs-identifier hs-type">l3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1203"></span><span>
</span><span id="line-1204"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1205"></span><span>    </span><span id="local-6989586621682931343"><span class="annot"><span class="annottext">op :: RuleOpts -&gt; Literal -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931343"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682931345"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931345"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682931346"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931346"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621682931347"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931347"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621682931348"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931348"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1206"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931336"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1207"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-1208"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931349"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931349"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931346"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-1209"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931350"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931350"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931347"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-1210"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931351"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931351"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931348"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-1211"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Rational -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatVal"><span class="hs-identifier hs-var">mkFloatVal</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931345"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; CoreExpr) -&gt; Rational -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1212"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931335"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1213"></span><span>              </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931349"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931350"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931351"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1214"></span><span>              </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931349"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931350"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931351"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1215"></span><span>              </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931349"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931350"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931351"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1216"></span><span>              </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931349"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931350"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931351"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1217"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>
</span><span id="line-1218"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931352"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931352"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931346"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-1219"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931353"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931353"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931347"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-1220"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931354"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931354"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931348"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-1221"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Rational -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkDoubleVal"><span class="hs-identifier hs-var">mkDoubleVal</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931345"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; CoreExpr) -&gt; Rational -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1222"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931335"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1223"></span><span>              </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931352"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931353"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931354"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1224"></span><span>              </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931352"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931353"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931354"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1225"></span><span>              </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931352"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931353"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931354"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1226"></span><span>              </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931352"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931353"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931354"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1227"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1228"></span><span>
</span><span id="line-1229"></span><span class="annot"><span class="hs-comment">-- | @x * y + 0 = x * y@.</span></span><span>
</span><span id="line-1230"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#fmaZero_z"><span class="hs-identifier hs-type">fmaZero_z</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#FMASign"><span class="hs-identifier hs-type">FMASign</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1231"></span><span id="fmaZero_z"><span class="annot"><span class="annottext">fmaZero_z :: FMASign -&gt; Width -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaZero_z"><span class="hs-identifier hs-var hs-var">fmaZero_z</span></a></span></span><span> </span><span id="local-6989586621682931355"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931355"><span class="hs-identifier hs-var">signs</span></a></span></span><span> </span><span id="local-6989586621682931356"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931356"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1232"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931357"><span class="annot"><a href="#local-6989586621682931357"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931358"><span class="annot"><a href="#local-6989586621682931358"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931359"><span class="annot"><a href="#local-6989586621682931359"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1233"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-1234"></span><span>    </span><span class="hs-comment">-- TODO: we should additionally check the sign of z.</span><span>
</span><span id="line-1235"></span><span>    </span><span class="hs-comment">-- FMAdd, FNMAdd: should be -0.0.</span><span>
</span><span id="line-1236"></span><span>    </span><span class="hs-comment">-- FMSub, FNMSub: should be +0.0.</span><span>
</span><span id="line-1237"></span><span>    </span><span id="local-6989586621682931360"><span class="annot"><a href="#local-6989586621682931360"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1238"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931356"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1239"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-1240"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931359"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1241"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1242"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>
</span><span id="line-1243"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931359"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1244"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1245"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1246"></span><span>    </span><span id="local-6989586621682931361"><span class="annot"><a href="#local-6989586621682931361"><span class="hs-identifier hs-var hs-var">neg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931356"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1247"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatNegOp"><span class="hs-identifier hs-var">FloatNegOp</span></a></span><span>
</span><span id="line-1248"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleNegOp"><span class="hs-identifier hs-var">DoubleNegOp</span></a></span><span>
</span><span id="line-1249"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PrimOp
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fmaZero_xy: not Float# or Double#&quot;</span></span><span>
</span><span id="line-1250"></span><span>    </span><span id="local-6989586621682931363"><span class="annot"><a href="#local-6989586621682931363"><span class="hs-identifier hs-var hs-var">mul</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931356"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1251"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatMulOp"><span class="hs-identifier hs-var">FloatMulOp</span></a></span><span>
</span><span id="line-1252"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleMulOp"><span class="hs-identifier hs-var">DoubleMulOp</span></a></span><span>
</span><span id="line-1253"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PrimOp
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fmaZero_z: not Float# or Double#&quot;</span></span><span>
</span><span id="line-1254"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682931360"><span class="hs-identifier hs-type">ok</span></a></span><span>
</span><span id="line-1255"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682931355"><span class="hs-identifier hs-type">signs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1256"></span><span>    </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931363"><span class="hs-identifier hs-var">mul</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931357"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931358"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1257"></span><span>    </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931363"><span class="hs-identifier hs-var">mul</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931357"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931358"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1258"></span><span>    </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931361"><span class="hs-identifier hs-var">neg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931363"><span class="hs-identifier hs-var">mul</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931357"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931358"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1259"></span><span>    </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931361"><span class="hs-identifier hs-var">neg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931363"><span class="hs-identifier hs-var">mul</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931357"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931358"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1260"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mzero</span></span><span>
</span><span id="line-1261"></span><span>
</span><span id="line-1262"></span><span class="annot"><span class="hs-comment">-- | @&#177;1 * y + z ==&gt; z &#177; y@ and @x * &#177;1 + z ==&gt; z &#177; x@.</span></span><span>
</span><span id="line-1263"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#fmaOne"><span class="hs-identifier hs-type">fmaOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Cmm.MachOp.html#FMASign"><span class="hs-identifier hs-type">FMASign</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Cmm.Type.html#Width"><span class="hs-identifier hs-type">Width</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1264"></span><span id="fmaOne"><span class="annot"><span class="annottext">fmaOne :: FMASign -&gt; Width -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#fmaOne"><span class="hs-identifier hs-var hs-var">fmaOne</span></a></span></span><span> </span><span id="local-6989586621682931365"><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span></span><span> </span><span id="local-6989586621682931366"><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931366"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1265"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931367"><span class="annot"><a href="#local-6989586621682931367"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931368"><span class="annot"><a href="#local-6989586621682931368"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931369"><span class="annot"><a href="#local-6989586621682931369"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1266"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-1267"></span><span>    </span><span class="annot"><a href="#local-6989586621682931370"><span class="hs-identifier hs-type">posNegOne_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1268"></span><span>    </span><span id="local-6989586621682931370"><span class="annot"><a href="#local-6989586621682931370"><span class="hs-identifier hs-var hs-var">posNegOne_maybe</span></a></span></span><span> </span><span id="local-6989586621682931371"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931371"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-1269"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931371"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1270"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1271"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931371"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1272"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1273"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1274"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1275"></span><span>    </span><span id="local-6989586621682931372"><span class="annot"><a href="#local-6989586621682931372"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1276"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931366"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1277"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span>
</span><span id="line-1278"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931373"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931373"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931367"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1279"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931374"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931374"><span class="hs-identifier hs-var">sgn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Maybe Bool
</span><a href="#local-6989586621682931370"><span class="hs-identifier hs-var">posNegOne_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931373"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1280"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, CoreExpr) -&gt; Maybe (Bool, CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931374"><span class="hs-identifier hs-var">sgn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931368"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1281"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931375"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931375"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931368"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1282"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931376"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931376"><span class="hs-identifier hs-var">sgn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Maybe Bool
</span><a href="#local-6989586621682931370"><span class="hs-identifier hs-var">posNegOne_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931375"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1283"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, CoreExpr) -&gt; Maybe (Bool, CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931376"><span class="hs-identifier hs-var">sgn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931367"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1284"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span>
</span><span id="line-1285"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931377"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931377"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931367"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1286"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931378"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931378"><span class="hs-identifier hs-var">sgn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Maybe Bool
</span><a href="#local-6989586621682931370"><span class="hs-identifier hs-var">posNegOne_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931377"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1287"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, CoreExpr) -&gt; Maybe (Bool, CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931378"><span class="hs-identifier hs-var">sgn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931368"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1288"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931379"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931379"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931368"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-1289"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931380"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931380"><span class="hs-identifier hs-var">sgn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Maybe Bool
</span><a href="#local-6989586621682931370"><span class="hs-identifier hs-var">posNegOne_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931379"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1290"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, CoreExpr) -&gt; Maybe (Bool, CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931380"><span class="hs-identifier hs-var">sgn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931367"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1291"></span><span>        </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, CoreExpr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1292"></span><span>    </span><span id="local-6989586621682931381"><span class="annot"><a href="#local-6989586621682931381"><span class="hs-identifier hs-var hs-var">neg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931366"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1293"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatNegOp"><span class="hs-identifier hs-var">FloatNegOp</span></a></span><span>
</span><span id="line-1294"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleNegOp"><span class="hs-identifier hs-var">DoubleNegOp</span></a></span><span>
</span><span id="line-1295"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PrimOp
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fmaOne: not Float# or Double#&quot;</span></span><span>
</span><span id="line-1296"></span><span>    </span><span id="local-6989586621682931382"><span class="annot"><a href="#local-6989586621682931382"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931366"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1297"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatAddOp"><span class="hs-identifier hs-var">FloatAddOp</span></a></span><span>
</span><span id="line-1298"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleAddOp"><span class="hs-identifier hs-var">DoubleAddOp</span></a></span><span>
</span><span id="line-1299"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PrimOp
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fmaOne: not Float# or Double#&quot;</span></span><span>
</span><span id="line-1300"></span><span>    </span><span id="local-6989586621682931383"><span class="annot"><a href="#local-6989586621682931383"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Width
</span><a href="#local-6989586621682931366"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1301"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W32"><span class="hs-identifier hs-var">W32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#FloatSubOp"><span class="hs-identifier hs-var">FloatSubOp</span></a></span><span>
</span><span id="line-1302"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><a href="GHC.Cmm.Type.html#W64"><span class="hs-identifier hs-var">W64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DoubleSubOp"><span class="hs-identifier hs-var">DoubleSubOp</span></a></span><span>
</span><span id="line-1303"></span><span>      </span><span class="annot"><span class="annottext">Width
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PrimOp
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#panic"><span class="hs-identifier hs-var">panic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fmaOne: not Float# or Double#&quot;</span></span><span>
</span><span id="line-1304"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682931372"><span class="hs-identifier hs-type">ok</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1305"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Bool, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1306"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682931384"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931384"><span class="hs-identifier hs-var">sgn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931385"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931385"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; RuleM CoreExpr) -&gt; CoreExpr -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1307"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-comment">-- t + z</span><span>
</span><span id="line-1308"></span><span>         </span><span class="hs-glyph">|</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; FMASign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span>  </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931384"><span class="hs-identifier hs-var">sgn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1309"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; FMASign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931384"><span class="hs-identifier hs-var">sgn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-1310"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931382"><span class="hs-identifier hs-var">add</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931385"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931369"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1311"></span><span>         </span><span class="hs-comment">-- - t + z</span><span>
</span><span id="line-1312"></span><span>         </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; FMASign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span>  </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMAdd"><span class="hs-identifier hs-var">FMAdd</span></a></span><span>
</span><span id="line-1313"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; FMASign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMAdd"><span class="hs-identifier hs-var">FNMAdd</span></a></span><span>
</span><span id="line-1314"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931383"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931369"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931385"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1315"></span><span>         </span><span class="hs-comment">-- t - z</span><span>
</span><span id="line-1316"></span><span>         </span><span class="hs-glyph">|</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; FMASign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span>  </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931384"><span class="hs-identifier hs-var">sgn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-1317"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; FMASign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931384"><span class="hs-identifier hs-var">sgn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-1318"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931383"><span class="hs-identifier hs-var">sub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931385"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931369"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-1319"></span><span>         </span><span class="hs-comment">-- - t - z</span><span>
</span><span id="line-1320"></span><span>         </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; FMASign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span>  </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FMSub"><span class="hs-identifier hs-var">FMSub</span></a></span><span>
</span><span id="line-1321"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span> </span><span class="annot"><span class="annottext">FMASign -&gt; FMASign -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="GHC.Cmm.MachOp.html#FNMSub"><span class="hs-identifier hs-var">FNMSub</span></a></span><span>
</span><span id="line-1322"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931381"><span class="hs-identifier hs-var">neg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931382"><span class="hs-identifier hs-var">add</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931385"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931369"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1323"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1324"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; CoreExpr
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fmaOne: non-exhaustive pattern match&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreExpr) -&gt; SDoc -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1325"></span><span>              </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;signs:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FMASign -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">FMASign
</span><a href="#local-6989586621682931365"><span class="hs-identifier hs-var">signs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1326"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sign:&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><a href="GHC.Utils.Outputable.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931384"><span class="hs-identifier hs-var">sgn</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1327"></span><span>
</span><span id="line-1328"></span><span class="hs-comment">--------------------------</span><span>
</span><span id="line-1329"></span><span class="hs-comment">{- Note [The litEq rule: converting equality to case]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
This stuff turns
     n ==# 3#
into
     case n of
       3# -&gt; True
       m  -&gt; False

This is a Good Thing, because it allows case-of case things
to happen, and case-default absorption to happen.  For
example:

     if (n ==# 3#) || (n ==# 4#) then e1 else e2
will transform to
     case n of
       3# -&gt; e1
       4# -&gt; e1
       m  -&gt; e2
(modulo the usual precautions to avoid duplicating e1)
-}</span><span>
</span><span id="line-1350"></span><span>
</span><span id="line-1351"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-type">litEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- True &lt;=&gt; equality, False &lt;=&gt; inequality</span><span>
</span><span id="line-1352"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1353"></span><span id="litEq"><span class="annot"><span class="annottext">litEq :: Bool -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#litEq"><span class="hs-identifier hs-var hs-var">litEq</span></a></span></span><span> </span><span id="local-6989586621682931392"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931392"><span class="hs-identifier hs-var">is_eq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RuleM CoreExpr] -&gt; RuleM CoreExpr
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span>
</span><span id="line-1354"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931393"><span class="annot"><a href="#local-6989586621682931393"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931394"><span class="annot"><a href="#local-6989586621682931394"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1355"></span><span>       </span><span id="local-6989586621682931395"><span class="annot"><a href="#local-6989586621682931395"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-1356"></span><span>       </span><span class="annot"><a href="#local-6989586621682931396"><span class="hs-identifier hs-type">do_lit_eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931395"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931393"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931394"><span class="hs-identifier hs-type">expr</span></a></span><span>
</span><span id="line-1357"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682931397"><span class="annot"><a href="#local-6989586621682931397"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931398"><span class="annot"><a href="#local-6989586621682931398"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1358"></span><span>       </span><span id="local-6989586621682931399"><span class="annot"><a href="#local-6989586621682931399"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-1359"></span><span>       </span><span class="annot"><a href="#local-6989586621682931396"><span class="hs-identifier hs-type">do_lit_eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931399"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931398"><span class="hs-identifier hs-type">lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931397"><span class="hs-identifier hs-type">expr</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1360"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1361"></span><span>    </span><span id="local-6989586621682931396"><span class="annot"><span class="annottext">do_lit_eq :: Platform -&gt; Literal -&gt; CoreExpr -&gt; RuleM CoreExpr
</span><a href="#local-6989586621682931396"><span class="hs-identifier hs-var hs-var">do_lit_eq</span></a></span></span><span> </span><span id="local-6989586621682931400"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931400"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931401"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931401"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621682931402"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931402"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1362"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; RuleM ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#litIsLifted"><span class="hs-identifier hs-var">litIsLifted</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931401"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1363"></span><span>      </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; Scaled Type -&gt; Type -&gt; [CoreAlt] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkWildCase"><span class="hs-identifier hs-var">mkWildCase</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931402"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Scaled Type
forall a. a -&gt; Scaled a
</span><a href="GHC.Core.Type.html#unrestricted"><span class="hs-identifier hs-var">unrestricted</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Scaled Type) -&gt; Type -&gt; Scaled Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Type
</span><a href="GHC.Types.Literal.html#literalType"><span class="hs-identifier hs-var">literalType</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931401"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.Prim.html#intPrimTy"><span class="hs-identifier hs-var">intPrimTy</span></a></span><span>
</span><span id="line-1364"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931410"><span class="hs-identifier hs-var">val_if_neq</span></a></span><span>
</span><span id="line-1365"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; AltCon
</span><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931401"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931412"><span class="hs-identifier hs-var">val_if_eq</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1366"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1367"></span><span>        </span><span id="local-6989586621682931412"><span class="annot"><span class="annottext">val_if_eq :: CoreExpr
</span><a href="#local-6989586621682931412"><span class="hs-identifier hs-var hs-var">val_if_eq</span></a></span></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931392"><span class="hs-identifier hs-var">is_eq</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-var">trueValInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931400"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1368"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-var">falseValInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931400"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1369"></span><span>        </span><span id="local-6989586621682931410"><span class="annot"><span class="annottext">val_if_neq :: CoreExpr
</span><a href="#local-6989586621682931410"><span class="hs-identifier hs-var hs-var">val_if_neq</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931392"><span class="hs-identifier hs-var">is_eq</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-var">falseValInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931400"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1370"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-var">trueValInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931400"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1371"></span><span>
</span><span id="line-1372"></span><span>
</span><span id="line-1373"></span><span class="hs-comment">-- | Check if there is comparison with minBound or maxBound, that is</span><span>
</span><span id="line-1374"></span><span class="hs-comment">-- always true or false. For instance, an Int cannot be smaller than its</span><span>
</span><span id="line-1375"></span><span class="hs-comment">-- minBound, so we can replace such comparison with False.</span><span>
</span><span id="line-1376"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-type">boundsCmp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#Comparison"><span class="hs-identifier hs-type">Comparison</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1377"></span><span id="boundsCmp"><span class="annot"><span class="annottext">boundsCmp :: Comparison -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#boundsCmp"><span class="hs-identifier hs-var hs-var">boundsCmp</span></a></span></span><span> </span><span id="local-6989586621682931413"><span class="annot"><span class="annottext">Comparison
</span><a href="#local-6989586621682931413"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1378"></span><span>  </span><span id="local-6989586621682931414"><span class="annot"><a href="#local-6989586621682931414"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1379"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931415"><span class="annot"><a href="#local-6989586621682931415"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931416"><span class="annot"><a href="#local-6989586621682931416"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1380"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-type">mkRuleFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931414"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931413"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931415"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931416"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1381"></span><span>
</span><span id="line-1382"></span><span class="hs-keyword">data</span><span> </span><span id="Comparison"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#Comparison"><span class="hs-identifier hs-var">Comparison</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Gt"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Ge"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Lt"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Le"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span></span><span>
</span><span id="line-1383"></span><span>
</span><span id="line-1384"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-type">mkRuleFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#Comparison"><span class="hs-identifier hs-type">Comparison</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1385"></span><span id="mkRuleFn"><span class="annot"><span class="annottext">mkRuleFn :: Platform -&gt; Comparison -&gt; CoreExpr -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var hs-var">mkRuleFn</span></a></span></span><span> </span><span id="local-6989586621682931418"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931418"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931419"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931419"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isMinBound"><span class="hs-identifier hs-var">isMinBound</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931418"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931419"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-var">falseValInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931418"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1386"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var">mkRuleFn</span></a></span><span> </span><span id="local-6989586621682931421"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931421"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931422"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931422"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isMinBound"><span class="hs-identifier hs-var">isMinBound</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931421"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931422"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-var">trueValInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931421"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1387"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var">mkRuleFn</span></a></span><span> </span><span id="local-6989586621682931423"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931423"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931424"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931424"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isMinBound"><span class="hs-identifier hs-var">isMinBound</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931423"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931424"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-var">trueValInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931423"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1388"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var">mkRuleFn</span></a></span><span> </span><span id="local-6989586621682931425"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931425"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931426"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931426"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isMinBound"><span class="hs-identifier hs-var">isMinBound</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931425"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931426"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-var">falseValInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931425"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1389"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var">mkRuleFn</span></a></span><span> </span><span id="local-6989586621682931427"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931427"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Ge"><span class="hs-identifier hs-var">Ge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931428"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931428"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isMaxBound"><span class="hs-identifier hs-var">isMaxBound</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931427"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931428"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-var">trueValInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931427"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1390"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var">mkRuleFn</span></a></span><span> </span><span id="local-6989586621682931430"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931430"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Lt"><span class="hs-identifier hs-var">Lt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931431"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931431"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isMaxBound"><span class="hs-identifier hs-var">isMaxBound</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931430"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931431"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-var">falseValInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931430"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1391"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var">mkRuleFn</span></a></span><span> </span><span id="local-6989586621682931432"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931432"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Gt"><span class="hs-identifier hs-var">Gt</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931433"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931433"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isMaxBound"><span class="hs-identifier hs-var">isMaxBound</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931432"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931433"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-var">falseValInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931432"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1392"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var">mkRuleFn</span></a></span><span> </span><span id="local-6989586621682931434"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931434"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><a href="GHC.Core.Opt.ConstantFold.html#Le"><span class="hs-identifier hs-var">Le</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931435"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931435"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isMaxBound"><span class="hs-identifier hs-var">isMaxBound</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931434"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931435"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-var">trueValInt</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931434"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1393"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkRuleFn"><span class="hs-identifier hs-var">mkRuleFn</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Comparison
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span>                                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1394"></span><span>
</span><span id="line-1395"></span><span class="hs-comment">-- | Create an Int literal expression while ensuring the given Integer is in the</span><span>
</span><span id="line-1396"></span><span class="hs-comment">-- target Int range</span><span>
</span><span id="line-1397"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int8Result"><span class="hs-identifier hs-type">int8Result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1398"></span><span id="int8Result"><span class="annot"><span class="annottext">int8Result :: Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Result"><span class="hs-identifier hs-var hs-var">int8Result</span></a></span></span><span> </span><span id="local-6989586621682931436"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931436"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Result%27"><span class="hs-identifier hs-var">int8Result'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931436"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1399"></span><span>
</span><span id="line-1400"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int8Result%27"><span class="hs-identifier hs-type">int8Result'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1401"></span><span id="int8Result%27"><span class="annot"><span class="annottext">int8Result' :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Result%27"><span class="hs-identifier hs-var hs-var">int8Result'</span></a></span></span><span> </span><span id="local-6989586621682931438"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931438"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt8Wrap"><span class="hs-identifier hs-var">mkLitInt8Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931438"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1402"></span><span>
</span><span id="line-1403"></span><span class="hs-comment">-- | Create an Int literal expression while ensuring the given Integer is in the</span><span>
</span><span id="line-1404"></span><span class="hs-comment">-- target Int range</span><span>
</span><span id="line-1405"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int16Result"><span class="hs-identifier hs-type">int16Result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1406"></span><span id="int16Result"><span class="annot"><span class="annottext">int16Result :: Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Result"><span class="hs-identifier hs-var hs-var">int16Result</span></a></span></span><span> </span><span id="local-6989586621682931440"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931440"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Result%27"><span class="hs-identifier hs-var">int16Result'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931440"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1407"></span><span>
</span><span id="line-1408"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int16Result%27"><span class="hs-identifier hs-type">int16Result'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1409"></span><span id="int16Result%27"><span class="annot"><span class="annottext">int16Result' :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Result%27"><span class="hs-identifier hs-var hs-var">int16Result'</span></a></span></span><span> </span><span id="local-6989586621682931442"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931442"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt16Wrap"><span class="hs-identifier hs-var">mkLitInt16Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931442"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1410"></span><span>
</span><span id="line-1411"></span><span class="hs-comment">-- | Create an Int literal expression while ensuring the given Integer is in the</span><span>
</span><span id="line-1412"></span><span class="hs-comment">-- target Int range</span><span>
</span><span id="line-1413"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int32Result"><span class="hs-identifier hs-type">int32Result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1414"></span><span id="int32Result"><span class="annot"><span class="annottext">int32Result :: Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Result"><span class="hs-identifier hs-var hs-var">int32Result</span></a></span></span><span> </span><span id="local-6989586621682931444"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931444"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Result%27"><span class="hs-identifier hs-var">int32Result'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931444"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1415"></span><span>
</span><span id="line-1416"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int32Result%27"><span class="hs-identifier hs-type">int32Result'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1417"></span><span id="int32Result%27"><span class="annot"><span class="annottext">int32Result' :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Result%27"><span class="hs-identifier hs-var hs-var">int32Result'</span></a></span></span><span> </span><span id="local-6989586621682931446"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931446"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt32Wrap"><span class="hs-identifier hs-var">mkLitInt32Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931446"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1418"></span><span>
</span><span id="line-1419"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intResult"><span class="hs-identifier hs-type">intResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1420"></span><span id="intResult"><span class="annot"><span class="annottext">intResult :: Platform -&gt; Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intResult"><span class="hs-identifier hs-var hs-var">intResult</span></a></span></span><span> </span><span id="local-6989586621682931448"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931448"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931449"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931449"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intResult%27"><span class="hs-identifier hs-var">intResult'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931448"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931449"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1421"></span><span>
</span><span id="line-1422"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intResult%27"><span class="hs-identifier hs-type">intResult'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1423"></span><span id="intResult%27"><span class="annot"><span class="annottext">intResult' :: Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intResult%27"><span class="hs-identifier hs-var hs-var">intResult'</span></a></span></span><span> </span><span id="local-6989586621682931451"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931451"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931452"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931452"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitIntWrap"><span class="hs-identifier hs-var">mkLitIntWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931451"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931452"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1424"></span><span>
</span><span id="line-1425"></span><span class="hs-comment">-- | Create an unboxed pair of an Int literal expression, ensuring the given</span><span>
</span><span id="line-1426"></span><span class="hs-comment">-- Integer is in the target Int range and the corresponding overflow flag</span><span>
</span><span id="line-1427"></span><span class="hs-comment">-- (@0#@/@1#@) if it wasn't.</span><span>
</span><span id="line-1428"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intCResult"><span class="hs-identifier hs-type">intCResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1429"></span><span id="intCResult"><span class="annot"><span class="annottext">intCResult :: Platform -&gt; Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intCResult"><span class="hs-identifier hs-var hs-var">intCResult</span></a></span></span><span> </span><span id="local-6989586621682931454"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931454"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931455"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931455"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-var">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931456"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931457"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1430"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1431"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682931456"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931456"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931458"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931458"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; (Literal, Bool)
</span><a href="GHC.Types.Literal.html#mkLitIntWrapC"><span class="hs-identifier hs-var">mkLitIntWrapC</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931454"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931455"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-1432"></span><span>    </span><span id="local-6989586621682931457"><span class="annot"><span class="annottext">c :: Literal
</span><a href="#local-6989586621682931457"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931458"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-var">onei</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931454"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931454"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1433"></span><span>
</span><span id="line-1434"></span><span class="hs-comment">-- | Create a Word literal expression while ensuring the given Integer is in the</span><span>
</span><span id="line-1435"></span><span class="hs-comment">-- target Word range</span><span>
</span><span id="line-1436"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word8Result"><span class="hs-identifier hs-type">word8Result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1437"></span><span id="word8Result"><span class="annot"><span class="annottext">word8Result :: Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Result"><span class="hs-identifier hs-var hs-var">word8Result</span></a></span></span><span> </span><span id="local-6989586621682931460"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931460"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Result%27"><span class="hs-identifier hs-var">word8Result'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931460"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1438"></span><span>
</span><span id="line-1439"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word8Result%27"><span class="hs-identifier hs-type">word8Result'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1440"></span><span id="word8Result%27"><span class="annot"><span class="annottext">word8Result' :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Result%27"><span class="hs-identifier hs-var hs-var">word8Result'</span></a></span></span><span> </span><span id="local-6989586621682931462"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931462"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord8Wrap"><span class="hs-identifier hs-var">mkLitWord8Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931462"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1441"></span><span>
</span><span id="line-1442"></span><span class="hs-comment">-- | Create a Word literal expression while ensuring the given Integer is in the</span><span>
</span><span id="line-1443"></span><span class="hs-comment">-- target Word range</span><span>
</span><span id="line-1444"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word16Result"><span class="hs-identifier hs-type">word16Result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1445"></span><span id="word16Result"><span class="annot"><span class="annottext">word16Result :: Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Result"><span class="hs-identifier hs-var hs-var">word16Result</span></a></span></span><span> </span><span id="local-6989586621682931464"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931464"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Result%27"><span class="hs-identifier hs-var">word16Result'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931464"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1446"></span><span>
</span><span id="line-1447"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word16Result%27"><span class="hs-identifier hs-type">word16Result'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1448"></span><span id="word16Result%27"><span class="annot"><span class="annottext">word16Result' :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Result%27"><span class="hs-identifier hs-var hs-var">word16Result'</span></a></span></span><span> </span><span id="local-6989586621682931466"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931466"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord16Wrap"><span class="hs-identifier hs-var">mkLitWord16Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931466"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1449"></span><span>
</span><span id="line-1450"></span><span class="hs-comment">-- | Create a Word literal expression while ensuring the given Integer is in the</span><span>
</span><span id="line-1451"></span><span class="hs-comment">-- target Word range</span><span>
</span><span id="line-1452"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word32Result"><span class="hs-identifier hs-type">word32Result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1453"></span><span id="word32Result"><span class="annot"><span class="annottext">word32Result :: Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Result"><span class="hs-identifier hs-var hs-var">word32Result</span></a></span></span><span> </span><span id="local-6989586621682931468"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931468"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Result%27"><span class="hs-identifier hs-var">word32Result'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931468"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1454"></span><span>
</span><span id="line-1455"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word32Result%27"><span class="hs-identifier hs-type">word32Result'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1456"></span><span id="word32Result%27"><span class="annot"><span class="annottext">word32Result' :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Result%27"><span class="hs-identifier hs-var hs-var">word32Result'</span></a></span></span><span> </span><span id="local-6989586621682931470"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931470"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord32Wrap"><span class="hs-identifier hs-var">mkLitWord32Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931470"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1457"></span><span>
</span><span id="line-1458"></span><span class="hs-comment">-- | Create a Word literal expression while ensuring the given Integer is in the</span><span>
</span><span id="line-1459"></span><span class="hs-comment">-- target Word range</span><span>
</span><span id="line-1460"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#wordResult"><span class="hs-identifier hs-type">wordResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1461"></span><span id="wordResult"><span class="annot"><span class="annottext">wordResult :: Platform -&gt; Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordResult"><span class="hs-identifier hs-var hs-var">wordResult</span></a></span></span><span> </span><span id="local-6989586621682931472"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931472"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931473"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931473"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordResult%27"><span class="hs-identifier hs-var">wordResult'</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931472"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931473"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1462"></span><span>
</span><span id="line-1463"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#wordResult%27"><span class="hs-identifier hs-type">wordResult'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1464"></span><span id="wordResult%27"><span class="annot"><span class="annottext">wordResult' :: Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordResult%27"><span class="hs-identifier hs-var hs-var">wordResult'</span></a></span></span><span> </span><span id="local-6989586621682931475"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931475"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931476"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931476"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWordWrap"><span class="hs-identifier hs-var">mkLitWordWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931475"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931476"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1465"></span><span>
</span><span id="line-1466"></span><span class="hs-comment">-- | Create an unboxed pair of a Word literal expression, ensuring the given</span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- Integer is in the target Word range and the corresponding carry flag</span><span>
</span><span id="line-1468"></span><span class="hs-comment">-- (@0#@/@1#@) if it wasn't.</span><span>
</span><span id="line-1469"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#wordCResult"><span class="hs-identifier hs-type">wordCResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1470"></span><span id="wordCResult"><span class="annot"><span class="annottext">wordCResult :: Platform -&gt; Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#wordCResult"><span class="hs-identifier hs-var hs-var">wordCResult</span></a></span></span><span> </span><span id="local-6989586621682931478"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931478"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931479"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931479"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreExpr] -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-var">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931480"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931481"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1471"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1472"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682931480"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931480"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931482"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931482"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; (Literal, Bool)
</span><a href="GHC.Types.Literal.html#mkLitWordWrapC"><span class="hs-identifier hs-var">mkLitWordWrapC</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931478"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931479"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-1473"></span><span>    </span><span id="local-6989586621682931481"><span class="annot"><span class="annottext">c :: Literal
</span><a href="#local-6989586621682931481"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682931482"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-var">onei</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931478"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931478"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1474"></span><span>
</span><span id="line-1475"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int64Result"><span class="hs-identifier hs-type">int64Result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1476"></span><span id="int64Result"><span class="annot"><span class="annottext">int64Result :: Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Result"><span class="hs-identifier hs-var hs-var">int64Result</span></a></span></span><span> </span><span id="local-6989586621682931484"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931484"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Result%27"><span class="hs-identifier hs-var">int64Result'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931484"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1477"></span><span>
</span><span id="line-1478"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int64Result%27"><span class="hs-identifier hs-type">int64Result'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1479"></span><span id="int64Result%27"><span class="annot"><span class="annottext">int64Result' :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Result%27"><span class="hs-identifier hs-var hs-var">int64Result'</span></a></span></span><span> </span><span id="local-6989586621682931486"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931486"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt64Wrap"><span class="hs-identifier hs-var">mkLitInt64Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931486"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1480"></span><span>
</span><span id="line-1481"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word64Result"><span class="hs-identifier hs-type">word64Result</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1482"></span><span id="word64Result"><span class="annot"><span class="annottext">word64Result :: Integer -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Result"><span class="hs-identifier hs-var hs-var">word64Result</span></a></span></span><span> </span><span id="local-6989586621682931487"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931487"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Result%27"><span class="hs-identifier hs-var">word64Result'</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931487"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1483"></span><span>
</span><span id="line-1484"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word64Result%27"><span class="hs-identifier hs-type">word64Result'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1485"></span><span id="word64Result%27"><span class="annot"><span class="annottext">word64Result' :: Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Result%27"><span class="hs-identifier hs-var hs-var">word64Result'</span></a></span></span><span> </span><span id="local-6989586621682931489"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931489"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWord64Wrap"><span class="hs-identifier hs-var">mkLitWord64Wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931489"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1486"></span><span>
</span><span id="line-1487"></span><span>
</span><span id="line-1488"></span><span class="annot"><span class="hs-comment">-- | 'ambient (primop x) = x', but not necessarily 'primop (ambient x) = x'.</span></span><span>
</span><span id="line-1489"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-type">semiInversePrimOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1490"></span><span id="semiInversePrimOp"><span class="annot"><span class="annottext">semiInversePrimOp :: PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#semiInversePrimOp"><span class="hs-identifier hs-var hs-var">semiInversePrimOp</span></a></span></span><span> </span><span id="local-6989586621682931491"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931491"><span class="hs-identifier hs-var">primop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1491"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682931492"><span class="annot"><a href="#local-6989586621682931492"><span class="hs-identifier hs-var">primop_id</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682931493"><span class="annot"><a href="#local-6989586621682931493"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1492"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#matchPrimOpId"><span class="hs-identifier hs-type">matchPrimOpId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931491"><span class="hs-identifier hs-type">primop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931492"><span class="hs-identifier hs-type">primop_id</span></a></span><span>
</span><span id="line-1493"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931493"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1494"></span><span>
</span><span id="line-1495"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#subsumesPrimOp"><span class="hs-identifier hs-type">subsumesPrimOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1496"></span><span id="local-6989586621682931495"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931495"><span class="hs-identifier hs-var">this</span></a></span></span><span> </span><span id="subsumesPrimOp"><span class="annot"><span class="annottext">subsumesPrimOp :: PrimOp -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumesPrimOp"><span class="hs-operator hs-var hs-var">`subsumesPrimOp`</span></a></span></span><span> </span><span id="local-6989586621682931496"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931496"><span class="hs-identifier hs-var">that</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1497"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682931497"><span class="annot"><a href="#local-6989586621682931497"><span class="hs-identifier hs-var">primop_id</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682931498"><span class="annot"><a href="#local-6989586621682931498"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1498"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#matchPrimOpId"><span class="hs-identifier hs-type">matchPrimOpId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931496"><span class="hs-identifier hs-type">that</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931497"><span class="hs-identifier hs-type">primop_id</span></a></span><span>
</span><span id="line-1499"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-type">primOpId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931495"><span class="hs-identifier hs-type">this</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931498"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1500"></span><span>
</span><span id="line-1501"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-type">subsumedByPrimOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1502"></span><span id="subsumedByPrimOp"><span class="annot"><span class="annottext">subsumedByPrimOp :: PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subsumedByPrimOp"><span class="hs-identifier hs-var hs-var">subsumedByPrimOp</span></a></span></span><span> </span><span id="local-6989586621682931499"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931499"><span class="hs-identifier hs-var">primop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1503"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931500"><span class="annot"><a href="#local-6989586621682931500"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682931501"><span class="annot"><a href="#local-6989586621682931501"><span class="hs-identifier hs-var">primop_id</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1504"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#matchPrimOpId"><span class="hs-identifier hs-type">matchPrimOpId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931499"><span class="hs-identifier hs-type">primop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931501"><span class="hs-identifier hs-type">primop_id</span></a></span><span>
</span><span id="line-1505"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931500"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1506"></span><span>
</span><span id="line-1507"></span><span class="annot"><span class="hs-comment">-- | Transform `extendWordN (narrowWordN x)` into `x .&amp;. 0xFF..FF`</span></span><span>
</span><span id="line-1508"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#extendNarrowPassthrough"><span class="hs-identifier hs-type">extendNarrowPassthrough</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1509"></span><span id="extendNarrowPassthrough"><span class="annot"><span class="annottext">extendNarrowPassthrough :: PrimOp -&gt; Integer -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#extendNarrowPassthrough"><span class="hs-identifier hs-var hs-var">extendNarrowPassthrough</span></a></span></span><span> </span><span id="local-6989586621682931502"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931502"><span class="hs-identifier hs-var">narrow_primop</span></a></span></span><span> </span><span id="local-6989586621682931503"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931503"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1510"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682931504"><span class="annot"><a href="#local-6989586621682931504"><span class="hs-identifier hs-var">primop_id</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682931505"><span class="annot"><a href="#local-6989586621682931505"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1511"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#matchPrimOpId"><span class="hs-identifier hs-type">matchPrimOpId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931502"><span class="hs-identifier hs-type">narrow_primop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931504"><span class="hs-identifier hs-type">primop_id</span></a></span><span>
</span><span id="line-1512"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-type">primOpId</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-type">WordAndOp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931505"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-type">LitNumWord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931503"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1513"></span><span>
</span><span id="line-1514"></span><span class="hs-comment">-- | narrow subsumes bitwise `and` with full mask (cf #16402):</span><span>
</span><span id="line-1515"></span><span class="hs-comment">--</span><span>
</span><span id="line-1516"></span><span class="hs-comment">--       narrowN (x .&amp;. m)</span><span>
</span><span id="line-1517"></span><span class="hs-comment">--       m .&amp;. (2^N-1) = 2^N-1</span><span>
</span><span id="line-1518"></span><span class="hs-comment">--       ==&gt; narrowN x</span><span>
</span><span id="line-1519"></span><span class="hs-comment">--</span><span>
</span><span id="line-1520"></span><span class="hs-comment">-- e.g.  narrow16 (x .&amp;. 0xFFFF)</span><span>
</span><span id="line-1521"></span><span class="hs-comment">--       ==&gt; narrow16 x</span><span>
</span><span id="line-1522"></span><span class="hs-comment">--</span><span>
</span><span id="line-1523"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-type">narrowSubsumesAnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1524"></span><span id="narrowSubsumesAnd"><span class="annot"><span class="annottext">narrowSubsumesAnd :: PrimOp -&gt; PrimOp -&gt; ConTagZ -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#narrowSubsumesAnd"><span class="hs-identifier hs-var hs-var">narrowSubsumesAnd</span></a></span></span><span> </span><span id="local-6989586621682931507"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931507"><span class="hs-identifier hs-var">and_primop</span></a></span></span><span> </span><span id="local-6989586621682931508"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931508"><span class="hs-identifier hs-var">narrw</span></a></span></span><span> </span><span id="local-6989586621682931509"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931509"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1525"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682931510"><span class="annot"><a href="#local-6989586621682931510"><span class="hs-identifier hs-var">primop_id</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682931511"><span class="annot"><a href="#local-6989586621682931511"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682931512"><span class="annot"><a href="#local-6989586621682931512"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1526"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#matchPrimOpId"><span class="hs-identifier hs-type">matchPrimOpId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931507"><span class="hs-identifier hs-type">and_primop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931510"><span class="hs-identifier hs-type">primop_id</span></a></span><span>
</span><span id="line-1527"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682931513"><span class="annot"><a href="#local-6989586621682931513"><span class="hs-identifier hs-var hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; Integer
forall a. (Num a, Bits a) =&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#bit"><span class="hs-identifier hs-var">bit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931509"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1528"></span><span>      </span><span id="local-6989586621682931515"><span class="annot"><a href="#local-6989586621682931515"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621682931516"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931516"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931517"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931517"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1529"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; RuleM ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931517"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931513"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931513"><span class="hs-identifier hs-var">mask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1530"></span><span>         </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931508"><span class="hs-identifier hs-var">narrw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931516"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1531"></span><span>      </span><span class="annot"><a href="#local-6989586621682931515"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1532"></span><span>  </span><span class="annot"><a href="#local-6989586621682931515"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931511"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931512"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;|&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682931515"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931512"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931511"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-1533"></span><span>
</span><span id="line-1534"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-type">idempotent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1535"></span><span id="idempotent"><span class="annot"><span class="annottext">idempotent :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#idempotent"><span class="hs-identifier hs-var hs-var">idempotent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682931519"><span class="annot"><a href="#local-6989586621682931519"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931520"><span class="annot"><a href="#local-6989586621682931520"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1536"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-identifier hs-type">cheapEqExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931519"><span class="hs-identifier hs-type">e1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931520"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-1537"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931519"><span class="hs-identifier hs-type">e1</span></a></span><span>
</span><span id="line-1538"></span><span>
</span><span id="line-1539"></span><span class="hs-comment">-- | Match</span><span>
</span><span id="line-1540"></span><span class="hs-comment">--       (op (op v e) e)</span><span>
</span><span id="line-1541"></span><span class="hs-comment">--    or (op e (op v e))</span><span>
</span><span id="line-1542"></span><span class="hs-comment">--    or (op (op e v) e)</span><span>
</span><span id="line-1543"></span><span class="hs-comment">--    or (op e (op e v))</span><span>
</span><span id="line-1544"></span><span class="hs-comment">--  and return the innermost (op v e) or (op e v).</span><span>
</span><span id="line-1545"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-type">sameArgIdempotentCommut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1546"></span><span id="sameArgIdempotentCommut"><span class="annot"><span class="annottext">sameArgIdempotentCommut :: PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sameArgIdempotentCommut"><span class="hs-identifier hs-var hs-var">sameArgIdempotentCommut</span></a></span></span><span> </span><span id="local-6989586621682931521"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931521"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1547"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931522"><span class="annot"><a href="#local-6989586621682931522"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931523"><span class="annot"><a href="#local-6989586621682931523"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1548"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931522"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621682931523"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1549"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var">is_binop</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931521"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682931525"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931525"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931526"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931526"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931527"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931527"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1550"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
forall b. Expr b -&gt; Expr b -&gt; Bool
</span><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-identifier hs-var">cheapEqExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931526"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931527"><span class="hs-identifier hs-var">e3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931522"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1551"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
forall b. Expr b -&gt; Expr b -&gt; Bool
</span><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-identifier hs-var">cheapEqExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931525"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931527"><span class="hs-identifier hs-var">e3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931522"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1552"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682931528"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931528"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var">is_binop</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931521"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682931529"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931529"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931530"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931530"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1553"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
forall b. Expr b -&gt; Expr b -&gt; Bool
</span><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-identifier hs-var">cheapEqExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931530"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931528"><span class="hs-identifier hs-var">e3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931523"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1554"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
forall b. Expr b -&gt; Expr b -&gt; Bool
</span><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-identifier hs-var">cheapEqExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931529"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931528"><span class="hs-identifier hs-var">e3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931523"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1555"></span><span>    </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1556"></span><span>
</span><span id="line-1557"></span><span class="hs-comment">{-
Note [Guarding against silly shifts]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Consider this code:

  import Data.Bits( (.|.), shiftL )
  chunkToBitmap :: [Bool] -&gt; Word32
  chunkToBitmap chunk = foldr (.|.) 0 [ 1 `shiftL` n | (True,n) &lt;- zip chunk [0..] ]

This optimises to:
Shift.$wgo = \ (w_sCS :: GHC.Prim.Int#) (w1_sCT :: [GHC.Types.Bool]) -&gt;
    case w1_sCT of _ {
      [] -&gt; 0##;
      : x_aAW xs_aAX -&gt;
        case x_aAW of _ {
          GHC.Types.False -&gt;
            case w_sCS of wild2_Xh {
              __DEFAULT -&gt; Shift.$wgo (GHC.Prim.+# wild2_Xh 1) xs_aAX;
              9223372036854775807 -&gt; 0## };
          GHC.Types.True -&gt;
            case GHC.Prim.&gt;=# w_sCS 64 of _ {
              GHC.Types.False -&gt;
                case w_sCS of wild3_Xh {
                  __DEFAULT -&gt;
                    case Shift.$wgo (GHC.Prim.+# wild3_Xh 1) xs_aAX of ww_sCW { __DEFAULT -&gt;
                      GHC.Prim.or# (GHC.Prim.narrow32Word#
                                      (GHC.Prim.uncheckedShiftL# 1## wild3_Xh))
                                   ww_sCW
                     };
                  9223372036854775807 -&gt;
                    GHC.Prim.narrow32Word#
!!!!--&gt;                  (GHC.Prim.uncheckedShiftL# 1## 9223372036854775807)
                };
              GHC.Types.True -&gt;
                case w_sCS of wild3_Xh {
                  __DEFAULT -&gt; Shift.$wgo (GHC.Prim.+# wild3_Xh 1) xs_aAX;
                  9223372036854775807 -&gt; 0##
                } } } }

Note the massive shift on line &quot;!!!!&quot;.  It can't happen, because we've checked
that w &lt; 64, but the optimiser didn't spot that. We DO NOT want to constant-fold this!
Moreover, if the programmer writes (n `uncheckedShiftL` 9223372036854775807), we
can't constant fold it, but if it gets to the assembler we get
     Error: operand type mismatch for `shl'

So the best thing to do is to rewrite the shift with a call to error,
when the second arg is large. However, in general we cannot do this; consider
this case

    let x = I# (uncheckedIShiftL# n 80)
    in ...

Here x contains an invalid shift and consequently we would like to rewrite it
as follows:

    let x = I# (error &quot;invalid shift&quot;)
    in ...

This was originally done in the fix to #16449 but this breaks the
let-can-float invariant (see Note [Core let-can-float invariant] in
GHC.Core) as noted in #16742.  For the reasons discussed under
&quot;NoEffect&quot; in Note [Classifying primop effects] (in GHC.Builtin.PrimOps)
there is no safe way to rewrite the argument of I# such that it bottoms.

Consequently we instead take advantage of the fact that the result of a
large shift is unspecified (see associated documentation in primops.txt.pp)
and transform the invalid shift into an &quot;obviously incorrect&quot; value.

There are two cases:

- Shifting fixed-width things: the primops IntSll, Sll, etc
  These are handled by shiftRule.

  We are happy to shift by any amount up to wordSize but no more.

- Shifting Bignums (Integer, Natural): these are handled by bignum_shift.

  Here we could in principle shift by any amount, but we arbitrary
  limit the shift to 4 bits; in particular we do not want shift by a
  huge amount, which can happen in code like that above.

The two cases are more different in their code paths that is comfortable,
but that is only a historical accident.


************************************************************************
*                                                                      *
\subsection{Vaguely generic functions}
*                                                                      *
************************************************************************
-}</span><span>
</span><span id="line-1648"></span><span>
</span><span id="line-1649"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkBasicRule"><span class="hs-identifier hs-type">mkBasicRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span>
</span><span id="line-1650"></span><span class="hs-comment">-- Gives the Rule the same name as the primop itself</span><span>
</span><span id="line-1651"></span><span id="mkBasicRule"><span class="annot"><span class="annottext">mkBasicRule :: Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkBasicRule"><span class="hs-identifier hs-var hs-var">mkBasicRule</span></a></span></span><span> </span><span id="local-6989586621682931531"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931531"><span class="hs-identifier hs-var">op_name</span></a></span></span><span> </span><span id="local-6989586621682931532"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931532"><span class="hs-identifier hs-var">n_args</span></a></span></span><span> </span><span id="local-6989586621682931533"><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="#local-6989586621682931533"><span class="hs-identifier hs-var">rm</span></a></span></span><span>
</span><span id="line-1652"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; RuleName
</span><a href="GHC.Types.Name.Occurrence.html#occNameFS"><span class="hs-identifier hs-var">occNameFS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; OccName
</span><a href="GHC.Types.Name.html#nameOccName"><span class="hs-identifier hs-var">nameOccName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931531"><span class="hs-identifier hs-var">op_name</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1653"></span><span>                  </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682931531"><span class="hs-identifier hs-var">op_name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1654"></span><span>                  </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931532"><span class="hs-identifier hs-var">n_args</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1655"></span><span>                  </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; RuleFun
forall r.
RuleM r -&gt; RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r
</span><a href="GHC.Core.Opt.ConstantFold.html#runRuleM"><span class="hs-identifier hs-var">runRuleM</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="#local-6989586621682931533"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1656"></span><span>
</span><span id="line-1657"></span><span class="hs-keyword">newtype</span><span> </span><span id="RuleM"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span></span><span> </span><span id="local-6989586621682929149"><span class="annot"><a href="#local-6989586621682929149"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RuleM"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span></span><span>
</span><span id="line-1658"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="runRuleM"><span class="annot"><span class="annottext">forall r.
RuleM r -&gt; RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r
</span><a href="GHC.Core.Opt.ConstantFold.html#runRuleM"><span class="hs-identifier hs-var hs-var">runRuleM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#InScopeEnv"><span class="hs-identifier hs-type">InScopeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682929149"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1659"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682931542"><span id="local-6989586621682931546"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; RuleM a -&gt; RuleM b)
-&gt; (forall a b. a -&gt; RuleM b -&gt; RuleM a) -&gt; Functor RuleM
forall a b. a -&gt; RuleM b -&gt; RuleM a
forall a b. (a -&gt; b) -&gt; RuleM a -&gt; RuleM b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; RuleM a -&gt; RuleM b
fmap :: forall a b. (a -&gt; b) -&gt; RuleM a -&gt; RuleM b
$c&lt;$ :: forall a b. a -&gt; RuleM b -&gt; RuleM a
&lt;$ :: forall a b. a -&gt; RuleM b -&gt; RuleM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1660"></span><span>
</span><span id="line-1661"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682931555"><span id="local-6989586621682931558"><span id="local-6989586621682931561"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1662"></span><span>    </span><span id="local-6989586621682931564"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; RuleM a
</span><span class="hs-identifier hs-var hs-var hs-var">pure</span></span></span><span> </span><span id="local-6989586621682931565"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682931565"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a) -&gt; RuleM a
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a)
 -&gt; RuleM a)
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a)
-&gt; RuleM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682931565"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1663"></span><span>    </span><span id="local-6989586621682931567"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b. RuleM (a -&gt; b) -&gt; RuleM a -&gt; RuleM b
</span><span class="hs-operator hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleM (a -&gt; b) -&gt; RuleM a -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b
</span><span class="hs-identifier hs-var">ap</span></span><span>
</span><span id="line-1664"></span><span>
</span><span id="line-1665"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682931573"><span id="local-6989586621682931576"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1666"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span id="local-6989586621682931579"><span class="annot"><span class="annottext">RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a
</span><a href="#local-6989586621682931579"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682931580"><span class="annot"><span class="annottext">&gt;&gt;= :: forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
</span><span class="hs-operator hs-var hs-var hs-var">&gt;&gt;=</span></span></span><span> </span><span id="local-6989586621682931581"><span class="annot"><span class="annottext">a -&gt; RuleM b
</span><a href="#local-6989586621682931581"><span class="hs-identifier hs-var">g</span></a></span></span><span>
</span><span id="line-1667"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe b) -&gt; RuleM b
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe b)
 -&gt; RuleM b)
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe b)
-&gt; RuleM b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682931582"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931582"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682931583"><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931583"><span class="hs-identifier hs-var">iu</span></a></span></span><span> </span><span id="local-6989586621682931584"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931584"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621682931585"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931585"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1668"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a
</span><a href="#local-6989586621682931579"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931582"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931583"><span class="hs-identifier hs-var">iu</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931584"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931585"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1669"></span><span>                </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe b
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1670"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931586"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682931586"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM b -&gt; RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe b
forall r.
RuleM r -&gt; RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r
</span><a href="GHC.Core.Opt.ConstantFold.html#runRuleM"><span class="hs-identifier hs-var">runRuleM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; RuleM b
</span><a href="#local-6989586621682931581"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682931586"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931582"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931583"><span class="hs-identifier hs-var">iu</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931584"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931585"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1671"></span><span>
</span><span id="line-1672"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1673"></span><span>    </span><span id="local-6989586621682931592"><span class="annot"><span class="annottext">fail :: forall a. String -&gt; RuleM a
</span><span class="hs-identifier hs-var hs-var hs-var">fail</span></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleM a
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1674"></span><span>
</span><span id="line-1675"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682931598"><span id="local-6989586621682931601"><span class="annot"><span class="hs-identifier hs-type">Alternative</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1676"></span><span>  </span><span id="local-6989586621682931604"><span class="annot"><span class="annottext">empty :: forall a. RuleM a
</span><a href="#local-6989586621682931604"><span class="hs-identifier hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a) -&gt; RuleM a
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a)
 -&gt; RuleM a)
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a)
-&gt; RuleM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1677"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span id="local-6989586621682931607"><span class="annot"><span class="annottext">RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a
</span><a href="#local-6989586621682931607"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621682931608"><span class="annot"><span class="annottext">&lt;|&gt; :: forall a. RuleM a -&gt; RuleM a -&gt; RuleM a
</span><span class="hs-operator hs-var hs-var hs-var">&lt;|&gt;</span></span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span id="local-6989586621682931609"><span class="annot"><span class="annottext">RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a
</span><a href="#local-6989586621682931609"><span class="hs-identifier hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a) -&gt; RuleM a
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a)
 -&gt; RuleM a)
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a)
-&gt; RuleM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682931610"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931610"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682931611"><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931611"><span class="hs-identifier hs-var">iu</span></a></span></span><span> </span><span id="local-6989586621682931612"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931612"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621682931613"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931613"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1678"></span><span>    </span><span class="annot"><span class="annottext">RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a
</span><a href="#local-6989586621682931607"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931610"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931611"><span class="hs-identifier hs-var">iu</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931612"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931613"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe a
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe a
</span><a href="#local-6989586621682931609"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931610"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931611"><span class="hs-identifier hs-var">iu</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931612"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931613"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1679"></span><span>
</span><span id="line-1680"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682931619"><span id="local-6989586621682931622"><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span></span></span><span>
</span><span id="line-1681"></span><span>
</span><span id="line-1682"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-1683"></span><span id="getPlatform"><span class="annot"><span class="annottext">getPlatform :: RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var hs-var">getPlatform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Platform) -&gt; RuleM RuleOpts -&gt; RuleM Platform
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-1684"></span><span>
</span><span id="line-1685"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getWordSize"><span class="hs-identifier hs-type">getWordSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Platform.html#PlatformWordSize"><span class="hs-identifier hs-type">PlatformWordSize</span></a></span><span>
</span><span id="line-1686"></span><span id="getWordSize"><span class="annot"><span class="annottext">getWordSize :: RuleM PlatformWordSize
</span><a href="GHC.Core.Opt.ConstantFold.html#getWordSize"><span class="hs-identifier hs-var hs-var">getWordSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; PlatformWordSize
</span><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; PlatformWordSize)
-&gt; RuleM Platform -&gt; RuleM PlatformWordSize
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1687"></span><span>
</span><span id="line-1688"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-type">getRuleOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span>
</span><span id="line-1689"></span><span id="getRuleOpts"><span class="annot"><span class="annottext">getRuleOpts :: RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var hs-var">getRuleOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe RuleOpts)
-&gt; RuleM RuleOpts
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe RuleOpts)
 -&gt; RuleM RuleOpts)
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe RuleOpts)
-&gt; RuleM RuleOpts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682931626"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931626"><span class="hs-identifier hs-var">rule_opts</span></a></span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleOpts -&gt; Maybe RuleOpts
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931626"><span class="hs-identifier hs-var">rule_opts</span></a></span><span>
</span><span id="line-1690"></span><span>
</span><span id="line-1691"></span><span id="local-6989586621682929130"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621682929130"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682929130"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1692"></span><span id="liftMaybe"><span class="annot"><span class="annottext">liftMaybe :: forall a. Maybe a -&gt; RuleM a
</span><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-var hs-var">liftMaybe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleM a
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1693"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-var">liftMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931629"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682931629"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; RuleM a
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682931629"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1694"></span><span>
</span><span id="line-1695"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-type">liftLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1696"></span><span id="liftLit"><span class="annot"><span class="annottext">liftLit :: (Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLit"><span class="hs-identifier hs-var hs-var">liftLit</span></a></span></span><span> </span><span id="local-6989586621682931630"><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="#local-6989586621682931630"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var">liftLitPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; Platform -&gt; Literal -&gt; Literal
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="#local-6989586621682931630"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>
</span><span id="line-1698"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-type">liftLitPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1699"></span><span id="liftLitPlatform"><span class="annot"><span class="annottext">liftLitPlatform :: (Platform -&gt; Literal -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#liftLitPlatform"><span class="hs-identifier hs-var hs-var">liftLitPlatform</span></a></span></span><span> </span><span id="local-6989586621682931631"><span class="annot"><span class="annottext">Platform -&gt; Literal -&gt; Literal
</span><a href="#local-6989586621682931631"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1700"></span><span>  </span><span id="local-6989586621682931632"><span class="annot"><a href="#local-6989586621682931632"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1701"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931633"><span class="annot"><a href="#local-6989586621682931633"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1702"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931631"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931632"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931633"><span class="hs-identifier hs-type">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1703"></span><span>
</span><span id="line-1704"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#removeOp32"><span class="hs-identifier hs-type">removeOp32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1705"></span><span id="removeOp32"><span class="annot"><span class="annottext">removeOp32 :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#removeOp32"><span class="hs-identifier hs-var hs-var">removeOp32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1706"></span><span>  </span><span id="local-6989586621682931634"><span class="annot"><a href="#local-6989586621682931634"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1707"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Platform.html#platformWordSize"><span class="hs-identifier hs-var">platformWordSize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931634"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1708"></span><span>    </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW4"><span class="hs-identifier hs-var">PW4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1709"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682931635"><span class="annot"><a href="#local-6989586621682931635"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1710"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931635"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-1711"></span><span>    </span><span class="annot"><span class="annottext">PlatformWordSize
</span><a href="GHC.Platform.html#PW8"><span class="hs-identifier hs-var">PW8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1712"></span><span>      </span><span class="annot"><span class="annottext">RuleM CoreExpr
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1713"></span><span>
</span><span id="line-1714"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1715"></span><span id="getArgs"><span class="annot"><span class="annottext">getArgs :: RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var hs-var">getArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe [CoreExpr])
-&gt; RuleM [CoreExpr]
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe [CoreExpr])
 -&gt; RuleM [CoreExpr])
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe [CoreExpr])
-&gt; RuleM [CoreExpr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931636"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931636"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; Maybe [CoreExpr]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931636"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1716"></span><span>
</span><span id="line-1717"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getInScopeEnv"><span class="hs-identifier hs-type">getInScopeEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#InScopeEnv"><span class="hs-identifier hs-type">InScopeEnv</span></a></span><span>
</span><span id="line-1718"></span><span id="getInScopeEnv"><span class="annot"><span class="annottext">getInScopeEnv :: RuleM InScopeEnv
</span><a href="GHC.Core.Opt.ConstantFold.html#getInScopeEnv"><span class="hs-identifier hs-var hs-var">getInScopeEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe InScopeEnv)
-&gt; RuleM InScopeEnv
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe InScopeEnv)
 -&gt; RuleM InScopeEnv)
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe InScopeEnv)
-&gt; RuleM InScopeEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931638"><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931638"><span class="hs-identifier hs-var">iu</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; Maybe InScopeEnv
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931638"><span class="hs-identifier hs-var">iu</span></a></span><span>
</span><span id="line-1719"></span><span>
</span><span id="line-1720"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getFunction"><span class="hs-identifier hs-type">getFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span>
</span><span id="line-1721"></span><span id="getFunction"><span class="annot"><span class="annottext">getFunction :: RuleM Id
</span><a href="GHC.Core.Opt.ConstantFold.html#getFunction"><span class="hs-identifier hs-var hs-var">getFunction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe Id)
-&gt; RuleM Id
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe Id)
 -&gt; RuleM Id)
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe Id)
-&gt; RuleM Id
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931640"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931640"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe Id
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931640"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-1722"></span><span>
</span><span id="line-1723"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isLiteral"><span class="hs-identifier hs-type">isLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-1724"></span><span id="isLiteral"><span class="annot"><span class="annottext">isLiteral :: CoreExpr -&gt; RuleM Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#isLiteral"><span class="hs-identifier hs-var hs-var">isLiteral</span></a></span></span><span> </span><span id="local-6989586621682931642"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931642"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1725"></span><span>    </span><span id="local-6989586621682931643"><span class="annot"><a href="#local-6989586621682931643"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM InScopeEnv
</span><a href="GHC.Core.Opt.ConstantFold.html#getInScopeEnv"><span class="hs-identifier hs-var">getInScopeEnv</span></a></span><span>
</span><span id="line-1726"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-type">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931643"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931642"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1727"></span><span>        </span><span class="annot"><span class="annottext">Maybe Literal
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM Literal
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1728"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931644"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931644"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM Literal
forall a. a -&gt; RuleM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931644"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1729"></span><span>
</span><span id="line-1730"></span><span class="annot"><span class="hs-comment">-- | Match BigNat#, Integer and Natural literals</span></span><span>
</span><span id="line-1731"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1732"></span><span id="isBignumLiteral"><span class="annot"><span class="annottext">isBignumLiteral :: CoreExpr -&gt; RuleM Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-var hs-var">isBignumLiteral</span></a></span></span><span> </span><span id="local-6989586621682931646"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931646"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#isNumberLiteral"><span class="hs-identifier hs-var">isNumberLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931646"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM Integer -&gt; RuleM Integer -&gt; RuleM Integer
forall a. RuleM a -&gt; RuleM a -&gt; RuleM a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-var">isIntegerLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931646"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM Integer -&gt; RuleM Integer -&gt; RuleM Integer
forall a. RuleM a -&gt; RuleM a -&gt; RuleM a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-var">isNaturalLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931646"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1733"></span><span>
</span><span id="line-1734"></span><span class="annot"><span class="hs-comment">-- | Match numeric literals</span></span><span>
</span><span id="line-1735"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNumberLiteral"><span class="hs-identifier hs-type">isNumberLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1736"></span><span id="isNumberLiteral"><span class="annot"><span class="annottext">isNumberLiteral :: CoreExpr -&gt; RuleM Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#isNumberLiteral"><span class="hs-identifier hs-var hs-var">isNumberLiteral</span></a></span></span><span> </span><span id="local-6989586621682931650"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931650"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#isLiteral"><span class="hs-identifier hs-var">isLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931650"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM Literal -&gt; (Literal -&gt; RuleM Integer) -&gt; RuleM Integer
forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1737"></span><span>  </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931651"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931651"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; RuleM Integer
forall a. a -&gt; RuleM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931651"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1738"></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM Integer
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1739"></span><span>
</span><span id="line-1740"></span><span class="hs-comment">-- | Match the application of a DataCon to a numeric literal.</span><span>
</span><span id="line-1741"></span><span class="hs-comment">--</span><span>
</span><span id="line-1742"></span><span class="hs-comment">-- Can be used to match e.g.:</span><span>
</span><span id="line-1743"></span><span class="hs-comment">--  IS 123#</span><span>
</span><span id="line-1744"></span><span class="hs-comment">--  IP bigNatLiteral</span><span>
</span><span id="line-1745"></span><span class="hs-comment">--  W# 123##</span><span>
</span><span id="line-1746"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isLitNumConApp"><span class="hs-identifier hs-type">isLitNumConApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-1747"></span><span id="isLitNumConApp"><span class="annot"><span class="annottext">isLitNumConApp :: CoreExpr -&gt; RuleM (DataCon, Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#isLitNumConApp"><span class="hs-identifier hs-var hs-var">isLitNumConApp</span></a></span></span><span> </span><span id="local-6989586621682931653"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931653"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1748"></span><span>  </span><span id="local-6989586621682931654"><span class="annot"><a href="#local-6989586621682931654"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM InScopeEnv
</span><a href="GHC.Core.Opt.ConstantFold.html#getInScopeEnv"><span class="hs-identifier hs-var">getInScopeEnv</span></a></span><span>
</span><span id="line-1749"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.SimpleOpt.html#exprIsConApp_maybe"><span class="hs-identifier hs-type">exprIsConApp_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931654"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931653"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1750"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682931655"><span class="annot"><span class="annottext">InScopeSet
</span><a href="#local-6989586621682931655"><span class="hs-identifier hs-var">_env</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931656"><span class="annot"><span class="annottext">[FloatBind]
</span><a href="#local-6989586621682931656"><span class="hs-identifier hs-var">_fb</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931657"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682931657"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931658"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682931658"><span class="hs-identifier hs-var">_tys</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621682931659"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931659"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682931654"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931659"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1751"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931660"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931660"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(DataCon, Integer) -&gt; RuleM (DataCon, Integer)
forall a. a -&gt; RuleM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682931657"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931660"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1752"></span><span>      </span><span class="annot"><span class="annottext">Maybe Literal
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM (DataCon, Integer)
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1753"></span><span>    </span><span class="annot"><span class="annottext">Maybe (InScopeSet, [FloatBind], DataCon, [Type], [CoreExpr])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RuleM (DataCon, Integer)
forall a. RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-1754"></span><span>
</span><span id="line-1755"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-type">isIntegerLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1756"></span><span id="isIntegerLiteral"><span class="annot"><span class="annottext">isIntegerLiteral :: CoreExpr -&gt; RuleM Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-var hs-var">isIntegerLiteral</span></a></span></span><span> </span><span id="local-6989586621682931661"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931661"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1757"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682931662"><span class="annot"><a href="#local-6989586621682931662"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931663"><span class="annot"><a href="#local-6989586621682931663"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM (DataCon, Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#isLitNumConApp"><span class="hs-identifier hs-var">isLitNumConApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931661"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1758"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682931662"><span class="hs-identifier hs-type">dc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#integerISDataCon"><span class="hs-identifier hs-type">integerISDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682931663"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-1759"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682931662"><span class="hs-identifier hs-type">dc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#integerINDataCon"><span class="hs-identifier hs-type">integerINDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">negate</span></span><span> </span><span class="annot"><a href="#local-6989586621682931663"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1760"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682931662"><span class="hs-identifier hs-type">dc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#integerIPDataCon"><span class="hs-identifier hs-type">integerIPDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682931663"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-1761"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mzero</span></span><span>
</span><span id="line-1762"></span><span>
</span><span id="line-1763"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBigIntegerLiteral"><span class="hs-identifier hs-type">isBigIntegerLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1764"></span><span id="isBigIntegerLiteral"><span class="annot"><span class="annottext">isBigIntegerLiteral :: CoreExpr -&gt; RuleM Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#isBigIntegerLiteral"><span class="hs-identifier hs-var hs-var">isBigIntegerLiteral</span></a></span></span><span> </span><span id="local-6989586621682931668"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931668"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1765"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682931669"><span class="annot"><a href="#local-6989586621682931669"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931670"><span class="annot"><a href="#local-6989586621682931670"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM (DataCon, Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#isLitNumConApp"><span class="hs-identifier hs-var">isLitNumConApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931668"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1766"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682931669"><span class="hs-identifier hs-type">dc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#integerINDataCon"><span class="hs-identifier hs-type">integerINDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">negate</span></span><span> </span><span class="annot"><a href="#local-6989586621682931670"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1767"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682931669"><span class="hs-identifier hs-type">dc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#integerIPDataCon"><span class="hs-identifier hs-type">integerIPDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682931670"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-1768"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mzero</span></span><span>
</span><span id="line-1769"></span><span>
</span><span id="line-1770"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-type">isNaturalLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-1771"></span><span id="isNaturalLiteral"><span class="annot"><span class="annottext">isNaturalLiteral :: CoreExpr -&gt; RuleM Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-var hs-var">isNaturalLiteral</span></a></span></span><span> </span><span id="local-6989586621682931671"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931671"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1772"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621682931672"><span class="annot"><a href="#local-6989586621682931672"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931673"><span class="annot"><a href="#local-6989586621682931673"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM (DataCon, Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#isLitNumConApp"><span class="hs-identifier hs-var">isLitNumConApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931671"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1773"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682931672"><span class="hs-identifier hs-type">dc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#naturalNSDataCon"><span class="hs-identifier hs-type">naturalNSDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682931673"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-1774"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682931672"><span class="hs-identifier hs-type">dc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="GHC.Builtin.Types.html#naturalNBDataCon"><span class="hs-identifier hs-type">naturalNBDataCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621682931673"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-1775"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mzero</span></span><span>
</span><span id="line-1776"></span><span>
</span><span id="line-1777"></span><span class="hs-comment">-- return the n-th argument of this rule, if it is a literal</span><span>
</span><span id="line-1778"></span><span class="hs-comment">-- argument indices start from 0</span><span>
</span><span id="line-1779"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getLiteral"><span class="hs-identifier hs-type">getLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-1780"></span><span id="getLiteral"><span class="annot"><span class="annottext">getLiteral :: ConTagZ -&gt; RuleM Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#getLiteral"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span id="local-6989586621682931677"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931677"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe Literal)
-&gt; RuleM Literal
forall r.
(RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r) -&gt; RuleM r
</span><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-var">RuleM</span></a></span><span> </span><span class="annot"><span class="annottext">((RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe Literal)
 -&gt; RuleM Literal)
-&gt; (RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe Literal)
-&gt; RuleM Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931678"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931678"><span class="hs-identifier hs-var">exprs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. ConTagZ -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931677"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682931678"><span class="hs-identifier hs-var">exprs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1781"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931680"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931680"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Maybe Literal
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931680"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1782"></span><span>  </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Literal
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1783"></span><span>
</span><span id="line-1784"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-type">unaryLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1785"></span><span id="unaryLit"><span class="annot"><span class="annottext">unaryLit :: (RuleOpts -&gt; Literal -&gt; Maybe CoreExpr) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unaryLit"><span class="hs-identifier hs-var hs-var">unaryLit</span></a></span></span><span> </span><span id="local-6989586621682931681"><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931681"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1786"></span><span>  </span><span id="local-6989586621682931682"><span class="annot"><a href="#local-6989586621682931682"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-1787"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931683"><span class="annot"><a href="#local-6989586621682931683"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1788"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931681"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931682"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-type">convFloating</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931682"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931683"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1789"></span><span>
</span><span id="line-1790"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-type">binaryLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1791"></span><span id="binaryLit"><span class="annot"><span class="annottext">binaryLit :: (RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var hs-var">binaryLit</span></a></span></span><span> </span><span id="local-6989586621682931684"><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682931684"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1792"></span><span>  </span><span id="local-6989586621682931685"><span class="annot"><a href="#local-6989586621682931685"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-1793"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931686"><span class="annot"><a href="#local-6989586621682931686"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931687"><span class="annot"><a href="#local-6989586621682931687"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1794"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931684"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931685"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-type">convFloating</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931685"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931686"><span class="hs-identifier hs-type">l1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-type">convFloating</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931685"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931687"><span class="hs-identifier hs-type">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1795"></span><span>
</span><span id="line-1796"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#binaryCmpLit"><span class="hs-identifier hs-type">binaryCmpLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682931688"><span class="annot"><a href="#local-6989586621682931688"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621682931688"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931688"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682931688"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1797"></span><span id="binaryCmpLit"><span class="annot"><span class="annottext">binaryCmpLit :: (forall a. Ord a =&gt; a -&gt; a -&gt; Bool) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryCmpLit"><span class="hs-identifier hs-var hs-var">binaryCmpLit</span></a></span></span><span> </span><span id="local-6989586621682931689"><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931689"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1798"></span><span>  </span><span id="local-6989586621682931690"><span class="annot"><a href="#local-6989586621682931690"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1799"></span><span>  </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-type">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Platform
-&gt; (forall a. Ord a =&gt; a -&gt; a -&gt; Bool)
-&gt; Literal
-&gt; Literal
-&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#cmpOp"><span class="hs-identifier hs-var">cmpOp</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931690"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621682931689"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1800"></span><span>
</span><span id="line-1801"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#leftIdentity"><span class="hs-identifier hs-type">leftIdentity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1802"></span><span id="leftIdentity"><span class="annot"><span class="annottext">leftIdentity :: Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftIdentity"><span class="hs-identifier hs-var hs-var">leftIdentity</span></a></span></span><span> </span><span id="local-6989586621682931694"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931694"><span class="hs-identifier hs-var">id_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftIdentityPlatform"><span class="hs-identifier hs-var">leftIdentityPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Platform -&gt; Literal
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931694"><span class="hs-identifier hs-var">id_lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1803"></span><span>
</span><span id="line-1804"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-type">rightIdentity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1805"></span><span id="rightIdentity"><span class="annot"><span class="annottext">rightIdentity :: Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var hs-var">rightIdentity</span></a></span></span><span> </span><span id="local-6989586621682931696"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931696"><span class="hs-identifier hs-var">id_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Platform -&gt; Literal
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931696"><span class="hs-identifier hs-var">id_lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1806"></span><span>
</span><span id="line-1807"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-type">identity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1808"></span><span id="identity"><span class="annot"><span class="annottext">identity :: Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identity"><span class="hs-identifier hs-var hs-var">identity</span></a></span></span><span> </span><span id="local-6989586621682931697"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931697"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftIdentity"><span class="hs-identifier hs-var">leftIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931697"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a. RuleM a -&gt; RuleM a -&gt; RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentity"><span class="hs-identifier hs-var">rightIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931697"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1809"></span><span>
</span><span id="line-1810"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#leftIdentityPlatform"><span class="hs-identifier hs-type">leftIdentityPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1811"></span><span id="leftIdentityPlatform"><span class="annot"><span class="annottext">leftIdentityPlatform :: (Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftIdentityPlatform"><span class="hs-identifier hs-var hs-var">leftIdentityPlatform</span></a></span></span><span> </span><span id="local-6989586621682931699"><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931699"><span class="hs-identifier hs-var">id_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1812"></span><span>  </span><span id="local-6989586621682931700"><span class="annot"><a href="#local-6989586621682931700"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1813"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931701"><span class="annot"><a href="#local-6989586621682931701"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931702"><span class="annot"><a href="#local-6989586621682931702"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1814"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931701"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682931699"><span class="hs-identifier hs-type">id_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931700"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-1815"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931702"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-1816"></span><span>
</span><span id="line-1817"></span><span class="hs-comment">-- | Left identity rule for PrimOps like 'IntAddC' and 'WordAddC', where, in</span><span>
</span><span id="line-1818"></span><span class="hs-comment">-- addition to the result, we have to indicate that no carry/overflow occurred.</span><span>
</span><span id="line-1819"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#leftIdentityCPlatform"><span class="hs-identifier hs-type">leftIdentityCPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1820"></span><span id="leftIdentityCPlatform"><span class="annot"><span class="annottext">leftIdentityCPlatform :: (Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftIdentityCPlatform"><span class="hs-identifier hs-var hs-var">leftIdentityCPlatform</span></a></span></span><span> </span><span id="local-6989586621682931704"><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931704"><span class="hs-identifier hs-var">id_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1821"></span><span>  </span><span id="local-6989586621682931705"><span class="annot"><a href="#local-6989586621682931705"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1822"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931706"><span class="annot"><a href="#local-6989586621682931706"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931707"><span class="annot"><a href="#local-6989586621682931707"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1823"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931706"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682931704"><span class="hs-identifier hs-type">id_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931705"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-1824"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682931708"><span class="annot"><a href="#local-6989586621682931708"><span class="hs-identifier hs-var hs-var">no_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931705"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1825"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-type">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682931707"><span class="hs-identifier hs-type">e2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682931708"><span class="hs-identifier hs-type">no_c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1826"></span><span>
</span><span id="line-1827"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-type">rightIdentityPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1828"></span><span id="rightIdentityPlatform"><span class="annot"><span class="annottext">rightIdentityPlatform :: (Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var hs-var">rightIdentityPlatform</span></a></span></span><span> </span><span id="local-6989586621682931709"><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931709"><span class="hs-identifier hs-var">id_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1829"></span><span>  </span><span id="local-6989586621682931710"><span class="annot"><a href="#local-6989586621682931710"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1830"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931711"><span class="annot"><a href="#local-6989586621682931711"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931712"><span class="annot"><a href="#local-6989586621682931712"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1831"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931712"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682931709"><span class="hs-identifier hs-type">id_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931710"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-1832"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931711"><span class="hs-identifier hs-type">e1</span></a></span><span>
</span><span id="line-1833"></span><span>
</span><span id="line-1834"></span><span class="hs-comment">-- | Right identity rule for PrimOps like 'IntSubC' and 'WordSubC', where, in</span><span>
</span><span id="line-1835"></span><span class="hs-comment">-- addition to the result, we have to indicate that no carry/overflow occurred.</span><span>
</span><span id="line-1836"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityCPlatform"><span class="hs-identifier hs-type">rightIdentityCPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1837"></span><span id="rightIdentityCPlatform"><span class="annot"><span class="annottext">rightIdentityCPlatform :: (Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityCPlatform"><span class="hs-identifier hs-var hs-var">rightIdentityCPlatform</span></a></span></span><span> </span><span id="local-6989586621682931713"><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931713"><span class="hs-identifier hs-var">id_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1838"></span><span>  </span><span id="local-6989586621682931714"><span class="annot"><a href="#local-6989586621682931714"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1839"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931715"><span class="annot"><a href="#local-6989586621682931715"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931716"><span class="annot"><a href="#local-6989586621682931716"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1840"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931716"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682931713"><span class="hs-identifier hs-type">id_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931714"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-1841"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682931717"><span class="annot"><a href="#local-6989586621682931717"><span class="hs-identifier hs-var hs-var">no_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931714"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1842"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-type">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682931715"><span class="hs-identifier hs-type">e1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682931717"><span class="hs-identifier hs-type">no_c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1843"></span><span>
</span><span id="line-1844"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-type">identityPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1845"></span><span id="identityPlatform"><span class="annot"><span class="annottext">identityPlatform :: (Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityPlatform"><span class="hs-identifier hs-var hs-var">identityPlatform</span></a></span></span><span> </span><span id="local-6989586621682931718"><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931718"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1846"></span><span>  </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftIdentityPlatform"><span class="hs-identifier hs-var">leftIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931718"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a. RuleM a -&gt; RuleM a -&gt; RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityPlatform"><span class="hs-identifier hs-var">rightIdentityPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931718"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1847"></span><span>
</span><span id="line-1848"></span><span class="hs-comment">-- | Identity rule for PrimOps like 'IntAddC' and 'WordAddC', where, in addition</span><span>
</span><span id="line-1849"></span><span class="hs-comment">-- to the result, we have to indicate that no carry/overflow occurred.</span><span>
</span><span id="line-1850"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#identityCPlatform"><span class="hs-identifier hs-type">identityCPlatform</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1851"></span><span id="identityCPlatform"><span class="annot"><span class="annottext">identityCPlatform :: (Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#identityCPlatform"><span class="hs-identifier hs-var hs-var">identityCPlatform</span></a></span></span><span> </span><span id="local-6989586621682931719"><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931719"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1852"></span><span>  </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftIdentityCPlatform"><span class="hs-identifier hs-var">leftIdentityCPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931719"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a. RuleM a -&gt; RuleM a -&gt; RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">(Platform -&gt; Literal) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightIdentityCPlatform"><span class="hs-identifier hs-var">rightIdentityCPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="#local-6989586621682931719"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-1853"></span><span>
</span><span id="line-1854"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-type">leftZero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1855"></span><span id="leftZero"><span class="annot"><span class="annottext">leftZero :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var hs-var">leftZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1856"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931720"><span class="annot"><a href="#local-6989586621682931720"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1857"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#isZeroLit"><span class="hs-identifier hs-type">isZeroLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931720"><span class="hs-identifier hs-type">l1</span></a></span><span>
</span><span id="line-1858"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931720"><span class="hs-identifier hs-type">l1</span></a></span><span>
</span><span id="line-1859"></span><span>
</span><span id="line-1860"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#rightZero"><span class="hs-identifier hs-type">rightZero</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1861"></span><span id="rightZero"><span class="annot"><span class="annottext">rightZero :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightZero"><span class="hs-identifier hs-var hs-var">rightZero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1862"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931723"><span class="annot"><a href="#local-6989586621682931723"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1863"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#isZeroLit"><span class="hs-identifier hs-type">isZeroLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931723"><span class="hs-identifier hs-type">l2</span></a></span><span>
</span><span id="line-1864"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931723"><span class="hs-identifier hs-type">l2</span></a></span><span>
</span><span id="line-1865"></span><span>
</span><span id="line-1866"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-type">zeroElem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1867"></span><span id="zeroElem"><span class="annot"><span class="annottext">zeroElem :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroElem"><span class="hs-identifier hs-var hs-var">zeroElem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a. RuleM a -&gt; RuleM a -&gt; RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#rightZero"><span class="hs-identifier hs-var">rightZero</span></a></span><span>
</span><span id="line-1868"></span><span>
</span><span id="line-1869"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-type">equalArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1870"></span><span id="equalArgs"><span class="annot"><span class="annottext">equalArgs :: RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#equalArgs"><span class="hs-identifier hs-var hs-var">equalArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1871"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621682931724"><span class="annot"><a href="#local-6989586621682931724"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931725"><span class="annot"><a href="#local-6989586621682931725"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1872"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931724"><span class="hs-identifier hs-type">e1</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-operator hs-type">`cheapEqExpr`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931725"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-1873"></span><span>
</span><span id="line-1874"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-type">nonZeroLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1875"></span><span id="nonZeroLit"><span class="annot"><span class="annottext">nonZeroLit :: ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var hs-var">nonZeroLit</span></a></span></span><span> </span><span id="local-6989586621682931726"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931726"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#getLiteral"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931726"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM Literal -&gt; (Literal -&gt; RuleM ()) -&gt; RuleM ()
forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; RuleM ()) -&gt; (Literal -&gt; Bool) -&gt; Literal -&gt; RuleM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Literal -&gt; Bool) -&gt; Literal -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isZeroLit"><span class="hs-identifier hs-var">isZeroLit</span></a></span><span>
</span><span id="line-1876"></span><span>
</span><span id="line-1877"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-type">oneLit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1878"></span><span id="oneLit"><span class="annot"><span class="annottext">oneLit :: ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#oneLit"><span class="hs-identifier hs-var hs-var">oneLit</span></a></span></span><span> </span><span id="local-6989586621682931727"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931727"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#getLiteral"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931727"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM Literal -&gt; (Literal -&gt; RuleM ()) -&gt; RuleM ()
forall a b. RuleM a -&gt; (a -&gt; RuleM b) -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RuleM ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; RuleM ()) -&gt; (Literal -&gt; Bool) -&gt; Literal -&gt; RuleM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Bool
</span><a href="GHC.Types.Literal.html#isOneLit"><span class="hs-identifier hs-var">isOneLit</span></a></span><span>
</span><span id="line-1879"></span><span>
</span><span id="line-1880"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#lift_bits_op"><span class="hs-identifier hs-type">lift_bits_op</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682929190"><span class="annot"><a href="#local-6989586621682929190"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621682929190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteBits</span></span><span> </span><span class="annot"><a href="#local-6989586621682929190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682929190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1881"></span><span id="lift_bits_op"><span class="annot"><span class="annottext">lift_bits_op :: forall a. (Num a, FiniteBits a) =&gt; (a -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#lift_bits_op"><span class="hs-identifier hs-var hs-var">lift_bits_op</span></a></span></span><span> </span><span id="local-6989586621682931737"><span class="annot"><span class="annottext">a -&gt; Integer
</span><a href="#local-6989586621682931737"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1882"></span><span>  </span><span id="local-6989586621682931738"><span class="annot"><a href="#local-6989586621682931738"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-1883"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931739"><span class="annot"><a href="#local-6989586621682931739"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-1884"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#mkWordLit"><span class="hs-identifier hs-type">mkWordLit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931738"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931737"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682931739"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682929190"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1885"></span><span>
</span><span id="line-1886"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#pop_count"><span class="hs-identifier hs-type">pop_count</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682928995"><span class="annot"><a href="#local-6989586621682928995"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621682928995"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteBits</span></span><span> </span><span class="annot"><a href="#local-6989586621682928995"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1887"></span><span id="pop_count"><span class="annot"><span class="annottext">pop_count :: forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#pop_count"><span class="hs-identifier hs-var hs-var">pop_count</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; (a -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#lift_bits_op"><span class="hs-identifier hs-var">lift_bits_op</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682928995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConTagZ -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(ConTagZ -&gt; Integer) -&gt; (a -&gt; ConTagZ) -&gt; a -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ConTagZ
forall a. Bits a =&gt; a -&gt; ConTagZ
</span><span class="hs-identifier hs-var">popCount</span></span><span class="hs-special">)</span><span>
</span><span id="line-1888"></span><span>
</span><span id="line-1889"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#ctz"><span class="hs-identifier hs-type">ctz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682931751"><span class="annot"><a href="#local-6989586621682931751"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621682931751"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteBits</span></span><span> </span><span class="annot"><a href="#local-6989586621682931751"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1890"></span><span id="ctz"><span class="annot"><span class="annottext">ctz :: forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ctz"><span class="hs-identifier hs-var hs-var">ctz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; (a -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#lift_bits_op"><span class="hs-identifier hs-var">lift_bits_op</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682931751"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConTagZ -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(ConTagZ -&gt; Integer) -&gt; (a -&gt; ConTagZ) -&gt; a -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ConTagZ
forall b. FiniteBits b =&gt; b -&gt; ConTagZ
</span><span class="hs-identifier hs-var">countTrailingZeros</span></span><span class="hs-special">)</span><span>
</span><span id="line-1891"></span><span>
</span><span id="line-1892"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#clz"><span class="hs-identifier hs-type">clz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682931760"><span class="annot"><a href="#local-6989586621682931760"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621682931760"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FiniteBits</span></span><span> </span><span class="annot"><a href="#local-6989586621682931760"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1893"></span><span id="clz"><span class="annot"><span class="annottext">clz :: forall a. (Num a, FiniteBits a) =&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#clz"><span class="hs-identifier hs-var hs-var">clz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Num a, FiniteBits a) =&gt; (a -&gt; Integer) -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#lift_bits_op"><span class="hs-identifier hs-var">lift_bits_op</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682931760"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConTagZ -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(ConTagZ -&gt; Integer) -&gt; (a -&gt; ConTagZ) -&gt; a -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ConTagZ
forall b. FiniteBits b =&gt; b -&gt; ConTagZ
</span><span class="hs-identifier hs-var">countLeadingZeros</span></span><span class="hs-special">)</span><span>
</span><span id="line-1894"></span><span>
</span><span id="line-1895"></span><span class="hs-comment">-- When excess precision is not requested, cut down the precision of the</span><span>
</span><span id="line-1896"></span><span class="hs-comment">-- Rational value to that of Float/Double. We confuse host architecture</span><span>
</span><span id="line-1897"></span><span class="hs-comment">-- and target architecture here, but it's convenient (and wrong :-).</span><span>
</span><span id="line-1898"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-type">convFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-1899"></span><span id="convFloating"><span class="annot"><span class="annottext">convFloating :: RuleOpts -&gt; Literal -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-var hs-var">convFloating</span></a></span></span><span> </span><span id="local-6989586621682931769"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931769"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span>  </span><span id="local-6989586621682931770"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931770"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Bool
</span><a href="GHC.Core.Rules.Config.html#roExcessRationalPrecision"><span class="hs-identifier hs-var">roExcessRationalPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931769"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1900"></span><span>   </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Float
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931770"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1901"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-var">convFloating</span></a></span><span> </span><span id="local-6989586621682931772"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931772"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931773"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931773"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Bool
</span><a href="GHC.Core.Rules.Config.html#roExcessRationalPrecision"><span class="hs-identifier hs-var">roExcessRationalPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931772"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1902"></span><span>   </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931773"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1903"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-var">convFloating</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682931774"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931774"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931774"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#guardFloatDiv"><span class="hs-identifier hs-type">guardFloatDiv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1906"></span><span id="guardFloatDiv"><span class="annot"><span class="annottext">guardFloatDiv :: RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#guardFloatDiv"><span class="hs-identifier hs-var hs-var">guardFloatDiv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1907"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931775"><span class="annot"><a href="#local-6989586621682931775"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span> </span><span id="local-6989586621682931776"><span class="annot"><a href="#local-6989586621682931776"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1908"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931775"><span class="hs-identifier hs-type">f1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682931776"><span class="hs-identifier hs-type">f2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- see Note [negative zero]</span><span>
</span><span id="line-1909"></span><span>       </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682931776"><span class="hs-identifier hs-type">f2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>            </span><span class="hs-comment">-- avoid NaN and Infinity/-Infinity</span><span>
</span><span id="line-1910"></span><span>
</span><span id="line-1911"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#guardDoubleDiv"><span class="hs-identifier hs-type">guardDoubleDiv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1912"></span><span id="guardDoubleDiv"><span class="annot"><span class="annottext">guardDoubleDiv :: RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#guardDoubleDiv"><span class="hs-identifier hs-var hs-var">guardDoubleDiv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1913"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931777"><span class="annot"><a href="#local-6989586621682931777"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-type">LitDouble</span></a></span><span> </span><span id="local-6989586621682931778"><span class="annot"><a href="#local-6989586621682931778"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1914"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931777"><span class="hs-identifier hs-type">d1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621682931778"><span class="hs-identifier hs-type">d2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- see Note [negative zero]</span><span>
</span><span id="line-1915"></span><span>       </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682931778"><span class="hs-identifier hs-type">d2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>            </span><span class="hs-comment">-- avoid NaN and Infinity/-Infinity</span><span>
</span><span id="line-1916"></span><span class="hs-comment">-- Note [negative zero]</span><span>
</span><span id="line-1917"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-1918"></span><span class="hs-comment">-- Avoid (0 / -d), otherwise 0/(-1) reduces to</span><span>
</span><span id="line-1919"></span><span class="hs-comment">-- zero, but we might want to preserve the negative zero here which</span><span>
</span><span id="line-1920"></span><span class="hs-comment">-- is representable in Float/Double but not in (normalised)</span><span>
</span><span id="line-1921"></span><span class="hs-comment">-- Rational. (#3676) Perhaps we should generate (0 :% (-1)) instead?</span><span>
</span><span id="line-1922"></span><span>
</span><span id="line-1923"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#strengthReduction"><span class="hs-identifier hs-type">strengthReduction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-1924"></span><span id="strengthReduction"><span class="annot"><span class="annottext">strengthReduction :: Literal -&gt; PrimOp -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#strengthReduction"><span class="hs-identifier hs-var hs-var">strengthReduction</span></a></span></span><span> </span><span id="local-6989586621682931779"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682931779"><span class="hs-identifier hs-var">two_lit</span></a></span></span><span> </span><span id="local-6989586621682931780"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931780"><span class="hs-identifier hs-var">add_op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- Note [Strength reduction]</span><span>
</span><span id="line-1925"></span><span>  </span><span id="local-6989586621682931781"><span class="annot"><a href="#local-6989586621682931781"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[RuleM CoreExpr] -&gt; RuleM CoreExpr
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682931782"><span class="annot"><a href="#local-6989586621682931782"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931783"><span class="annot"><a href="#local-6989586621682931783"><span class="hs-identifier hs-var">mult_lit</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1926"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931783"><span class="hs-identifier hs-type">mult_lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682931779"><span class="hs-identifier hs-type">two_lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1927"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931782"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-1928"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682931784"><span class="annot"><a href="#local-6989586621682931784"><span class="hs-identifier hs-var">mult_lit</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931785"><span class="annot"><a href="#local-6989586621682931785"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-1929"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931784"><span class="hs-identifier hs-type">mult_lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682931779"><span class="hs-identifier hs-type">two_lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1930"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931785"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1931"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-type">primOpId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931780"><span class="hs-identifier hs-type">add_op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931781"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931781"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-1932"></span><span>
</span><span id="line-1933"></span><span class="hs-comment">-- Note [Strength reduction]</span><span>
</span><span id="line-1934"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-1935"></span><span class="hs-comment">-- This rule turns floating point multiplications of the form 2.0 * x and</span><span>
</span><span id="line-1936"></span><span class="hs-comment">-- x * 2.0 into x + x addition, because addition costs less than multiplication.</span><span>
</span><span id="line-1937"></span><span class="hs-comment">-- See #7116</span><span>
</span><span id="line-1938"></span><span>
</span><span id="line-1939"></span><span class="hs-comment">-- Note [What's true and false]</span><span>
</span><span id="line-1940"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-1941"></span><span class="hs-comment">-- trueValInt and falseValInt represent true and false values returned by</span><span>
</span><span id="line-1942"></span><span class="hs-comment">-- comparison primops for Char, Int, Word, Integer, Double, Float and Addr.</span><span>
</span><span id="line-1943"></span><span class="hs-comment">-- True is represented as an unboxed 1# literal, while false is represented</span><span>
</span><span id="line-1944"></span><span class="hs-comment">-- as 0# literal.</span><span>
</span><span id="line-1945"></span><span class="hs-comment">-- We still need Bool data constructors (True and False) to use in a rule</span><span>
</span><span id="line-1946"></span><span class="hs-comment">-- for constant folding of equal Strings</span><span>
</span><span id="line-1947"></span><span>
</span><span id="line-1948"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-type">trueValInt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-type">falseValInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span>
</span><span id="line-1949"></span><span id="trueValInt"><span class="annot"><span class="annottext">trueValInt :: Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-var hs-var">trueValInt</span></a></span></span><span>  </span><span id="local-6989586621682931786"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931786"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr) -&gt; Literal -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#onei"><span class="hs-identifier hs-var">onei</span></a></span><span>  </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931786"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-comment">-- see Note [What's true and false]</span><span>
</span><span id="line-1950"></span><span id="falseValInt"><span class="annot"><span class="annottext">falseValInt :: Platform -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-var hs-var">falseValInt</span></a></span></span><span> </span><span id="local-6989586621682931787"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931787"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr) -&gt; Literal -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#zeroi"><span class="hs-identifier hs-var">zeroi</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931787"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-1951"></span><span>
</span><span id="line-1952"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#trueValBool"><span class="hs-identifier hs-type">trueValBool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#falseValBool"><span class="hs-identifier hs-type">falseValBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span>
</span><span id="line-1953"></span><span id="trueValBool"><span class="annot"><span class="annottext">trueValBool :: CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValBool"><span class="hs-identifier hs-var hs-var">trueValBool</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.html#trueDataConId"><span class="hs-identifier hs-var">trueDataConId</span></a></span><span> </span><span class="hs-comment">-- see Note [What's true and false]</span><span>
</span><span id="line-1954"></span><span id="falseValBool"><span class="annot"><span class="annottext">falseValBool :: CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValBool"><span class="hs-identifier hs-var hs-var">falseValBool</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.html#falseDataConId"><span class="hs-identifier hs-var">falseDataConId</span></a></span><span>
</span><span id="line-1955"></span><span>
</span><span id="line-1956"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#ltVal"><span class="hs-identifier hs-type">ltVal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#eqVal"><span class="hs-identifier hs-type">eqVal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#gtVal"><span class="hs-identifier hs-type">gtVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span>
</span><span id="line-1957"></span><span id="ltVal"><span class="annot"><span class="annottext">ltVal :: CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ltVal"><span class="hs-identifier hs-var hs-var">ltVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.html#ordLTDataConId"><span class="hs-identifier hs-var">ordLTDataConId</span></a></span><span>
</span><span id="line-1958"></span><span id="eqVal"><span class="annot"><span class="annottext">eqVal :: CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#eqVal"><span class="hs-identifier hs-var hs-var">eqVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.html#ordEQDataConId"><span class="hs-identifier hs-var">ordEQDataConId</span></a></span><span>
</span><span id="line-1959"></span><span id="gtVal"><span class="annot"><span class="annottext">gtVal :: CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#gtVal"><span class="hs-identifier hs-var hs-var">gtVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="GHC.Builtin.Types.html#ordGTDataConId"><span class="hs-identifier hs-var">ordGTDataConId</span></a></span><span>
</span><span id="line-1960"></span><span>
</span><span id="line-1961"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkIntVal"><span class="hs-identifier hs-type">mkIntVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span>
</span><span id="line-1962"></span><span id="mkIntVal"><span class="annot"><span class="annottext">mkIntVal :: Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkIntVal"><span class="hs-identifier hs-var hs-var">mkIntVal</span></a></span></span><span> </span><span id="local-6989586621682931798"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931798"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682931799"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931799"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682931798"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931799"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1963"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkFloatVal"><span class="hs-identifier hs-type">mkFloatVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span>
</span><span id="line-1964"></span><span id="mkFloatVal"><span class="annot"><span class="annottext">mkFloatVal :: RuleOpts -&gt; Rational -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkFloatVal"><span class="hs-identifier hs-var hs-var">mkFloatVal</span></a></span></span><span> </span><span id="local-6989586621682931800"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931800"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682931801"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931801"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-var">convFloating</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931800"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitFloat"><span class="hs-identifier hs-var">LitFloat</span></a></span><span>  </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931801"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1965"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkDoubleVal"><span class="hs-identifier hs-type">mkDoubleVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Rules.Config.html#RuleOpts"><span class="hs-identifier hs-type">RuleOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span>
</span><span id="line-1966"></span><span id="mkDoubleVal"><span class="annot"><span class="annottext">mkDoubleVal :: RuleOpts -&gt; Rational -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mkDoubleVal"><span class="hs-identifier hs-var hs-var">mkDoubleVal</span></a></span></span><span> </span><span id="local-6989586621682931802"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931802"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621682931803"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931803"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Literal -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#convFloating"><span class="hs-identifier hs-var">convFloating</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682931802"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitDouble"><span class="hs-identifier hs-var">LitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621682931803"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1967"></span><span>
</span><span id="line-1968"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#matchPrimOpId"><span class="hs-identifier hs-type">matchPrimOpId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1969"></span><span id="matchPrimOpId"><span class="annot"><span class="annottext">matchPrimOpId :: PrimOp -&gt; Id -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#matchPrimOpId"><span class="hs-identifier hs-var hs-var">matchPrimOpId</span></a></span></span><span> </span><span id="local-6989586621682931804"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682931804"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682931805"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931805"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1970"></span><span>  </span><span id="local-6989586621682931806"><span class="annot"><a href="#local-6989586621682931806"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp -&gt; RuleM PrimOp
forall a. Maybe a -&gt; RuleM a
</span><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-var">liftMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe PrimOp -&gt; RuleM PrimOp) -&gt; Maybe PrimOp -&gt; RuleM PrimOp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe PrimOp
</span><a href="GHC.Types.Id.html#isPrimOpId_maybe"><span class="hs-identifier hs-var">isPrimOpId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682931805"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1971"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931804"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621682931806"><span class="hs-identifier hs-type">op'</span></a></span><span>
</span><span id="line-1972"></span><span>
</span><span id="line-1973"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Special rules for seq, tagToEnum, dataToTag}
*                                                                      *
************************************************************************

Note [tagToEnum#]
~~~~~~~~~~~~~~~~~
Nasty check to ensure that tagToEnum# is applied to a type that is an
enumeration TyCon.  Unification may refine the type later, but this
check won't see that, alas.  It's crude but it works.

Here's are two cases that should fail
        f :: forall a. a
        f = tagToEnum# 0        -- Can't do tagToEnum# at a type variable

        g :: Int
        g = tagToEnum# 0        -- Int is not an enumeration

We used to make this check in the type inference engine, but it's quite
ugly to do so, because the delayed constraint solving means that we don't
really know what's going on until the end. It's very much a corner case
because we don't expect the user to call tagToEnum# at all; we merely
generate calls in derived instances of Enum.  So we compromise: a
rewrite rule rewrites a bad instance of tagToEnum# to an error call,
and emits a warning.
-}</span><span>
</span><span id="line-2001"></span><span>
</span><span id="line-2002"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tagToEnumRule"><span class="hs-identifier hs-type">tagToEnumRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2003"></span><span class="hs-comment">-- If     data T a = A | B | C</span><span>
</span><span id="line-2004"></span><span class="hs-comment">-- then   tagToEnum# (T ty) 2# --&gt;  B ty</span><span>
</span><span id="line-2005"></span><span id="tagToEnumRule"><span class="annot"><span class="annottext">tagToEnumRule :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#tagToEnumRule"><span class="hs-identifier hs-var hs-var">tagToEnumRule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2006"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931809"><span class="annot"><a href="#local-6989586621682931809"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-type">LitNumInt</span></a></span><span> </span><span id="local-6989586621682931810"><span class="annot"><a href="#local-6989586621682931810"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2007"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-type">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931809"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2008"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682931812"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682931812"><span class="hs-identifier hs-var">tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931813"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621682931813"><span class="hs-identifier hs-var">tc_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isEnumerationTyCon"><span class="hs-identifier hs-var">isEnumerationTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682931812"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2009"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682931814"><span class="annot"><span class="annottext">tag :: ConTagZ
</span><a href="#local-6989586621682931814"><span class="hs-identifier hs-var hs-var hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682931810"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-2010"></span><span>          </span><span id="local-6989586621682931815"><span class="annot"><span class="annottext">correct_tag :: DataCon -&gt; Bool
</span><a href="#local-6989586621682931815"><span class="hs-identifier hs-var hs-var hs-var">correct_tag</span></a></span></span><span> </span><span id="local-6989586621682931816"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682931816"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; ConTagZ
</span><a href="GHC.Core.DataCon.html#dataConTagZ"><span class="hs-identifier hs-var">dataConTagZ</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682931816"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; ConTagZ -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931814"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-2011"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682931817"><span class="annot"><a href="#local-6989586621682931817"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682931818"><span class="annot"><a href="#local-6989586621682931818"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; RuleM [DataCon]
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DataCon] -&gt; RuleM [DataCon]) -&gt; [DataCon] -&gt; RuleM [DataCon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DataCon -&gt; Bool) -&gt; [DataCon] -&gt; [DataCon]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; Bool
</span><a href="#local-6989586621682931815"><span class="hs-identifier hs-var">correct_tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyCon -&gt; Maybe [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons_maybe"><span class="hs-identifier hs-var">tyConDataCons_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682931812"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [DataCon] -&gt; [DataCon] -&gt; [DataCon]
forall a. Maybe a -&gt; a -&gt; a
</span><a href="GHC.Data.Maybe.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2012"></span><span>      </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">null</span></span><span> </span><span class="annot"><a href="#local-6989586621682931818"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2013"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#mkTyApps"><span class="hs-identifier hs-type">mkTyApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#dataConWorkId"><span class="hs-identifier hs-type">dataConWorkId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931817"><span class="hs-identifier hs-type">dc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682931813"><span class="hs-identifier hs-type">tc_args</span></a></span><span>
</span><span id="line-2014"></span><span>
</span><span id="line-2015"></span><span>    </span><span class="hs-comment">-- See Note [tagToEnum#]</span><span>
</span><span id="line-2016"></span><span>    </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; SDoc -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; String -&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Trace.html#warnPprTrace"><span class="hs-identifier hs-var">warnPprTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tagToEnum# on non-enumeration type&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682931809"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; RuleM CoreExpr)
-&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2017"></span><span>         </span><span class="annot"><span class="annottext">CoreExpr -&gt; RuleM CoreExpr
forall a. a -&gt; RuleM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; RuleM CoreExpr) -&gt; CoreExpr -&gt; RuleM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkImpossibleExpr"><span class="hs-identifier hs-var">mkImpossibleExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682931809"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tagToEnum# on non-enumeration type&quot;</span></span><span>
</span><span id="line-2018"></span><span>
</span><span id="line-2019"></span><span class="hs-comment">------------------------------</span><span>
</span><span id="line-2020"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#dataToTagRule"><span class="hs-identifier hs-type">dataToTagRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2021"></span><span class="hs-comment">-- Used for both dataToTagSmall# and dataToTagLarge#.</span><span>
</span><span id="line-2022"></span><span class="hs-comment">-- See Note [DataToTag overview] in GHC.Tc.Instance.Class,</span><span>
</span><span id="line-2023"></span><span class="hs-comment">-- particularly wrinkle DTW5.</span><span>
</span><span id="line-2024"></span><span id="dataToTagRule"><span class="annot"><span class="annottext">dataToTagRule :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#dataToTagRule"><span class="hs-identifier hs-var hs-var">dataToTagRule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="#local-6989586621682931824"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a. RuleM a -&gt; RuleM a -&gt; RuleM a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">`mplus`</span></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="#local-6989586621682931825"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2025"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2026"></span><span>    </span><span class="hs-comment">-- dataToTag (tagToEnum x)   ==&gt;   x</span><span>
</span><span id="line-2027"></span><span>    </span><span id="local-6989586621682931824"><span class="annot"><span class="annottext">a :: RuleM CoreExpr
</span><a href="#local-6989586621682931824"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2028"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931836"><span class="annot"><a href="#local-6989586621682931836"><span class="hs-identifier hs-var">_lev</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931837"><span class="annot"><a href="#local-6989586621682931837"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682931838"><span class="annot"><a href="#local-6989586621682931838"><span class="hs-identifier hs-var">tag_to_enum</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931839"><span class="annot"><a href="#local-6989586621682931839"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682931840"><span class="annot"><a href="#local-6989586621682931840"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2029"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931838"><span class="hs-identifier hs-type">tag_to_enum</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-type">`hasKey`</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#tagToEnumKey"><span class="hs-identifier hs-type">tagToEnumKey</span></a></span><span>
</span><span id="line-2030"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682931837"><span class="hs-identifier hs-type">ty1</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-type">`eqType`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931839"><span class="hs-identifier hs-type">ty2</span></a></span><span>
</span><span id="line-2031"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621682931840"><span class="hs-identifier hs-type">tag</span></a></span><span>
</span><span id="line-2032"></span><span>
</span><span id="line-2033"></span><span>    </span><span class="hs-comment">-- dataToTag (K e1 e2)  ==&gt;   tag-of K</span><span>
</span><span id="line-2034"></span><span>    </span><span class="hs-comment">-- This also works (via exprIsConApp_maybe) for</span><span>
</span><span id="line-2035"></span><span>    </span><span class="hs-comment">--   dataToTag x</span><span>
</span><span id="line-2036"></span><span>    </span><span class="hs-comment">-- where x's unfolding is a constructor application</span><span>
</span><span id="line-2037"></span><span>    </span><span id="local-6989586621682931825"><span class="annot"><span class="annottext">b :: RuleM CoreExpr
</span><a href="#local-6989586621682931825"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2038"></span><span>      </span><span id="local-6989586621682931854"><span class="annot"><a href="#local-6989586621682931854"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2039"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682931855"><span class="annot"><a href="#local-6989586621682931855"><span class="hs-identifier hs-var">_lev</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931856"><span class="annot"><a href="#local-6989586621682931856"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931857"><span class="annot"><a href="#local-6989586621682931857"><span class="hs-identifier hs-var">val_arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2040"></span><span>      </span><span id="local-6989586621682931858"><span class="annot"><a href="#local-6989586621682931858"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getInScopeEnv"><span class="hs-identifier hs-type">getInScopeEnv</span></a></span><span>
</span><span id="line-2041"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682931859"><span class="annot"><a href="#local-6989586621682931859"><span class="hs-identifier hs-var">floats</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931860"><span class="annot"><a href="#local-6989586621682931860"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.SimpleOpt.html#exprIsConApp_maybe"><span class="hs-identifier hs-type">exprIsConApp_maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931858"><span class="hs-identifier hs-type">in_scope</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931857"><span class="hs-identifier hs-type">val_arg</span></a></span><span>
</span><span id="line-2042"></span><span>      </span><span class="annot"><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-type">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.TyCon.html#isNewTyCon"><span class="hs-identifier hs-type">isNewTyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#dataConTyCon"><span class="hs-identifier hs-type">dataConTyCon</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931860"><span class="hs-identifier hs-type">dc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2043"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#wrapFloats"><span class="hs-identifier hs-type">wrapFloats</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931859"><span class="hs-identifier hs-type">floats</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkIntVal"><span class="hs-identifier hs-type">mkIntVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931854"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#dataConTagZ"><span class="hs-identifier hs-type">dataConTagZ</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931860"><span class="hs-identifier hs-type">dc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2044"></span><span>
</span><span id="line-2045"></span><span>
</span><span id="line-2046"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
             unsafeEqualityProof
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-2051"></span><span>
</span><span id="line-2052"></span><span class="hs-comment">-- unsafeEqualityProof k t t  ==&gt;  UnsafeRefl (Refl t)</span><span>
</span><span id="line-2053"></span><span class="hs-comment">-- That is, if the two types are equal, it's not unsafe!</span><span>
</span><span id="line-2054"></span><span>
</span><span id="line-2055"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#unsafeEqualityProofRule"><span class="hs-identifier hs-type">unsafeEqualityProofRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2056"></span><span id="unsafeEqualityProofRule"><span class="annot"><span class="annottext">unsafeEqualityProofRule :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unsafeEqualityProofRule"><span class="hs-identifier hs-var hs-var">unsafeEqualityProofRule</span></a></span></span><span>
</span><span id="line-2057"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931863"><span class="annot"><a href="#local-6989586621682931863"><span class="hs-identifier hs-var">rep</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931864"><span class="annot"><a href="#local-6989586621682931864"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931865"><span class="annot"><a href="#local-6989586621682931865"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2058"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931864"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="annot"><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-type">`eqType`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931865"><span class="hs-identifier hs-type">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2059"></span><span>       </span><span class="hs-special">;</span><span> </span><span id="local-6989586621682931866"><span class="annot"><a href="#local-6989586621682931866"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getFunction"><span class="hs-identifier hs-type">getFunction</span></a></span><span>
</span><span id="line-2060"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931867"><span class="annot"><a href="#local-6989586621682931867"><span class="hs-identifier hs-var">ue</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Type.html#splitForAllTyCoVars"><span class="hs-identifier hs-type">splitForAllTyCoVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#idType"><span class="hs-identifier hs-type">idType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931866"><span class="hs-identifier hs-type">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2061"></span><span>             </span><span id="local-6989586621682931870"><span class="annot"><a href="#local-6989586621682931870"><span class="hs-identifier hs-var hs-var">tc</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; TyCon
Type -&gt; TyCon
</span><a href="GHC.Core.Type.html#tyConAppTyCon"><span class="hs-identifier hs-var">tyConAppTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682931867"><span class="hs-identifier hs-var">ue</span></a></span><span>  </span><span class="hs-comment">-- tycon:    UnsafeEquality</span><span>
</span><span id="line-2062"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621682931872"><span class="annot"><a href="#local-6989586621682931872"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-type">tyConDataCons</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931870"><span class="hs-identifier hs-type">tc</span></a></span><span>  </span><span class="hs-comment">-- data con: UnsafeRefl</span><span>
</span><span id="line-2063"></span><span>             </span><span class="hs-comment">-- UnsafeRefl :: forall (r :: RuntimeRep) (a :: TYPE r).</span><span>
</span><span id="line-2064"></span><span>             </span><span class="hs-comment">--               UnsafeEquality r a a</span><span>
</span><span id="line-2065"></span><span>       </span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#mkTyApps"><span class="hs-identifier hs-type">mkTyApps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.DataCon.html#dataConWrapId"><span class="hs-identifier hs-type">dataConWrapId</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931872"><span class="hs-identifier hs-type">dc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682931863"><span class="hs-identifier hs-type">rep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682931864"><span class="hs-identifier hs-type">t1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2066"></span><span>
</span><span id="line-2067"></span><span>
</span><span id="line-2068"></span><span class="annot"><span class="hs-comment">{- *********************************************************************
*                                                                      *
             Rules for spark#
*                                                                      *
********************************************************************* -}</span></span><span>
</span><span id="line-2073"></span><span>
</span><span id="line-2074"></span><span class="hs-comment">-- spark# :: forall a s . a -&gt; State# s -&gt; (# State# s, a #)</span><span>
</span><span id="line-2075"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#sparkRule"><span class="hs-identifier hs-type">sparkRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2076"></span><span id="sparkRule"><span class="annot"><span class="annottext">sparkRule :: RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#sparkRule"><span class="hs-identifier hs-var hs-var">sparkRule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- reduce on HNF</span><span>
</span><span id="line-2077"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931873"><span class="annot"><a href="#local-6989586621682931873"><span class="hs-identifier hs-var">_ty_a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682931874"><span class="annot"><a href="#local-6989586621682931874"><span class="hs-identifier hs-var">_ty_s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931875"><span class="annot"><a href="#local-6989586621682931875"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682931876"><span class="annot"><a href="#local-6989586621682931876"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2078"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Utils.html#exprIsHNF"><span class="hs-identifier hs-type">exprIsHNF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931875"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-2079"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-type">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682931876"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682931875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2080"></span><span>    </span><span class="hs-comment">-- XXX perhaps we shouldn't do this, because a spark eliminated by</span><span>
</span><span id="line-2081"></span><span>    </span><span class="hs-comment">-- this rule won't be counted as a dud at runtime?</span><span>
</span><span id="line-2082"></span><span>
</span><span id="line-2083"></span><span class="hs-comment">{-
************************************************************************
*                                                                      *
\subsection{Built in rules}
*                                                                      *
************************************************************************

Note [Scoping for Builtin rules]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When compiling a (base-package) module that defines one of the
functions mentioned in the RHS of a built-in rule, there's a danger
that we'll see

        f = ...(eq String x)....

        ....and lower down...

        eqString = ...

Then a rewrite would give

        f = ...(eqString x)...
        ....and lower down...
        eqString = ...

and lo, eqString is not in scope.  This only really matters when we
get to code generation.  But the occurrence analyser does a GlomBinds
step when necessary, that does a new SCC analysis on the whole set of
bindings (see occurAnalysePgm), which sorts out the dependency, so all
is fine.
-}</span><span>
</span><span id="line-2114"></span><span>
</span><span id="line-2115"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#builtinRules"><span class="hs-identifier hs-type">builtinRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2116"></span><span class="hs-comment">-- Rules for non-primops that can't be expressed using a RULE pragma</span><span>
</span><span id="line-2117"></span><span id="builtinRules"><span class="annot"><span class="annottext">builtinRules :: [CoreRule]
</span><a href="GHC.Core.Opt.ConstantFold.html#builtinRules"><span class="hs-identifier hs-var hs-var">builtinRules</span></a></span></span><span>
</span><span id="line-2118"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CStringFoldrLit&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-2119"></span><span>                   </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unpackCStringFoldrName"><span class="hs-identifier hs-var">unpackCStringFoldrName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2120"></span><span>                   </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit_C"><span class="hs-identifier hs-var">match_cstring_foldr_lit_C</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-2121"></span><span>     </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CStringFoldrLitUtf8&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-2122"></span><span>                   </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unpackCStringFoldrUtf8Name"><span class="hs-identifier hs-var">unpackCStringFoldrUtf8Name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2123"></span><span>                   </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">4</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit_utf8"><span class="hs-identifier hs-var">match_cstring_foldr_lit_utf8</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-2124"></span><span>     </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CStringAppendLit&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-2125"></span><span>                   </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unpackCStringAppendName"><span class="hs-identifier hs-var">unpackCStringAppendName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2126"></span><span>                   </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit_C"><span class="hs-identifier hs-var">match_cstring_append_lit_C</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-2127"></span><span>     </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CStringAppendLitUtf8&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-2128"></span><span>                   </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unpackCStringAppendUtf8Name"><span class="hs-identifier hs-var">unpackCStringAppendUtf8Name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2129"></span><span>                   </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit_utf8"><span class="hs-identifier hs-var">match_cstring_append_lit_utf8</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-2130"></span><span>     </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EqString&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#eqStringName"><span class="hs-identifier hs-var">eqStringName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2131"></span><span>                   </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_eq_string"><span class="hs-identifier hs-var">match_eq_string</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-2132"></span><span>     </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CStringLength&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#cstringLengthName"><span class="hs-identifier hs-var">cstringLengthName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2133"></span><span>                   </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_length"><span class="hs-identifier hs-var">match_cstring_length</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-2134"></span><span>     </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Inline&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#inlineIdName"><span class="hs-identifier hs-var">inlineIdName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2135"></span><span>                   </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#match_inline"><span class="hs-identifier hs-var">match_inline</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><span id="line-2136"></span><span>
</span><span id="line-2137"></span><span>     </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkBasicRule"><span class="hs-identifier hs-var">mkBasicRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#unsafeEqualityProofName"><span class="hs-identifier hs-var">unsafeEqualityProofName</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#unsafeEqualityProofRule"><span class="hs-identifier hs-var">unsafeEqualityProofRule</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-2138"></span><span>
</span><span id="line-2139"></span><span>     </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkBasicRule"><span class="hs-identifier hs-var">mkBasicRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#divIntName"><span class="hs-identifier hs-var">divIntName</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[RuleM CoreExpr] -&gt; RuleM CoreExpr
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span>
</span><span id="line-2140"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span class="hs-special">)</span><span>
</span><span id="line-2141"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-2142"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2143"></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682931895"><span class="annot"><a href="#local-6989586621682931895"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-type">LitNumInt</span></a></span><span> </span><span id="local-6989586621682931896"><span class="annot"><a href="#local-6989586621682931896"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2144"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682931897"><span class="annot"><a href="#local-6989586621682931897"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#exactLog2"><span class="hs-identifier hs-type">exactLog2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931896"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-2145"></span><span>          </span><span id="local-6989586621682931899"><span class="annot"><a href="#local-6989586621682931899"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2146"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-type">primOpId</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#IntSraOp"><span class="hs-identifier hs-type">IntSraOp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931895"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkIntVal"><span class="hs-identifier hs-type">mkIntVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931899"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931897"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-2147"></span><span>        </span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-2148"></span><span>
</span><span id="line-2149"></span><span>     </span><span class="annot"><span class="annottext">Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="GHC.Core.Opt.ConstantFold.html#mkBasicRule"><span class="hs-identifier hs-var">mkBasicRule</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#modIntName"><span class="hs-identifier hs-var">modIntName</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[RuleM CoreExpr] -&gt; RuleM CoreExpr
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span>
</span><span id="line-2150"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; RuleM ()
</span><a href="GHC.Core.Opt.ConstantFold.html#nonZeroLit"><span class="hs-identifier hs-var">nonZeroLit</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">RuleM () -&gt; RuleM CoreExpr -&gt; RuleM CoreExpr
forall a b. RuleM a -&gt; RuleM b -&gt; RuleM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr)
-&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#binaryLit"><span class="hs-identifier hs-var">binaryLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
forall a b.
(Integral a, Integral b) =&gt;
(a -&gt; b -&gt; Integer)
-&gt; RuleOpts -&gt; Literal -&gt; Literal -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#intOp2"><span class="hs-identifier hs-var">intOp2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span class="hs-special">)</span><span>
</span><span id="line-2151"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#leftZero"><span class="hs-identifier hs-var">leftZero</span></a></span><span>
</span><span id="line-2152"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2153"></span><span>          </span><span class="hs-special">[</span><span id="local-6989586621682931902"><span class="annot"><a href="#local-6989586621682931902"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-type">LitNumInt</span></a></span><span> </span><span id="local-6989586621682931903"><span class="annot"><a href="#local-6989586621682931903"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2154"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html#exactLog2"><span class="hs-identifier hs-type">exactLog2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931903"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-2155"></span><span>          </span><span id="local-6989586621682931904"><span class="annot"><a href="#local-6989586621682931904"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2156"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-type">primOpId</span></a></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-type">IntAndOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2157"></span><span>            </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931902"><span class="hs-identifier hs-type">arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkIntVal"><span class="hs-identifier hs-type">mkIntVal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931904"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931903"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-2158"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2159"></span><span>     </span><span class="hs-special">]</span><span>
</span><span id="line-2160"></span><span> </span><span class="annot"><span class="annottext">[CoreRule] -&gt; [CoreRule] -&gt; [CoreRule]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[CoreRule]
</span><a href="GHC.Core.Opt.ConstantFold.html#builtinBignumRules"><span class="hs-identifier hs-var">builtinBignumRules</span></a></span><span>
</span><span id="line-2161"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#builtinRules"><span class="hs-pragma hs-type">builtinRules</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2162"></span><span class="hs-comment">-- there is no benefit to inlining these yet, despite this, GHC produces</span><span>
</span><span id="line-2163"></span><span class="hs-comment">-- unfoldings for this regardless since the floated list entries look small.</span><span>
</span><span id="line-2164"></span><span>
</span><span id="line-2165"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#builtinBignumRules"><span class="hs-identifier hs-type">builtinBignumRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2166"></span><span id="builtinBignumRules"><span class="annot"><span class="annottext">builtinBignumRules :: [CoreRule]
</span><a href="GHC.Core.Opt.ConstantFold.html#builtinBignumRules"><span class="hs-identifier hs-var hs-var">builtinBignumRules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2167"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- conversions</span><span>
</span><span id="line-2168"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931906"><span class="hs-identifier hs-var">lit_to_integer</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Word# -&gt; Integer&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerFromWordName"><span class="hs-identifier hs-var">integerFromWordName</span></a></span><span>
</span><span id="line-2169"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931906"><span class="hs-identifier hs-var">lit_to_integer</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Int64# -&gt; Integer&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerFromInt64Name"><span class="hs-identifier hs-var">integerFromInt64Name</span></a></span><span>
</span><span id="line-2170"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931906"><span class="hs-identifier hs-var">lit_to_integer</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Word64# -&gt; Integer&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerFromWord64Name"><span class="hs-identifier hs-var">integerFromWord64Name</span></a></span><span>
</span><span id="line-2171"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931906"><span class="hs-identifier hs-var">lit_to_integer</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Natural -&gt; Integer&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerFromNaturalName"><span class="hs-identifier hs-var">integerFromNaturalName</span></a></span><span>
</span><span id="line-2172"></span><span>
</span><span id="line-2173"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931911"><span class="hs-identifier hs-var">integer_to_lit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Word# (wrap)&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToWordName"><span class="hs-identifier hs-var">integerToWordName</span></a></span><span>   </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
forall b. Platform -&gt; Integer -&gt; Expr b
</span><a href="GHC.Core.html#mkWordLitWrap"><span class="hs-identifier hs-var">mkWordLitWrap</span></a></span><span>
</span><span id="line-2174"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931911"><span class="hs-identifier hs-var">integer_to_lit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Int# (wrap)&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToIntName"><span class="hs-identifier hs-var">integerToIntName</span></a></span><span>    </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
forall b. Platform -&gt; Integer -&gt; Expr b
</span><a href="GHC.Core.html#mkIntLitWrap"><span class="hs-identifier hs-var">mkIntLitWrap</span></a></span><span>
</span><span id="line-2175"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931911"><span class="hs-identifier hs-var">integer_to_lit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Word64# (wrap)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToWord64Name"><span class="hs-identifier hs-var">integerToWord64Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; CoreExpr
forall b. Word64 -&gt; Expr b
</span><a href="GHC.Core.html#mkWord64LitWord64"><span class="hs-identifier hs-var">mkWord64LitWord64</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64 -&gt; CoreExpr) -&gt; (Integer -&gt; Word64) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word64
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span class="hs-special">)</span><span>
</span><span id="line-2176"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931911"><span class="hs-identifier hs-var">integer_to_lit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Int64# (wrap)&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToInt64Name"><span class="hs-identifier hs-var">integerToInt64Name</span></a></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; CoreExpr
forall b. Int64 -&gt; Expr b
</span><a href="GHC.Core.html#mkInt64LitInt64"><span class="hs-identifier hs-var">mkInt64LitInt64</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; CoreExpr) -&gt; (Integer -&gt; Int64) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int64
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span class="hs-special">)</span><span>
</span><span id="line-2177"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931911"><span class="hs-identifier hs-var">integer_to_lit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Float#&quot;</span></span><span>         </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToFloatName"><span class="hs-identifier hs-var">integerToFloatName</span></a></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Float -&gt; CoreExpr
forall b. Float -&gt; Expr b
</span><a href="GHC.Core.html#mkFloatLitFloat"><span class="hs-identifier hs-var">mkFloatLitFloat</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; CoreExpr) -&gt; (Integer -&gt; Float) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span class="hs-special">)</span><span>
</span><span id="line-2178"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931911"><span class="hs-identifier hs-var">integer_to_lit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Double#&quot;</span></span><span>        </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToDoubleName"><span class="hs-identifier hs-var">integerToDoubleName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; CoreExpr
forall b. Double -&gt; Expr b
</span><a href="GHC.Core.html#mkDoubleLitDouble"><span class="hs-identifier hs-var">mkDoubleLitDouble</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; CoreExpr) -&gt; (Integer -&gt; Double) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span class="hs-special">)</span><span>
</span><span id="line-2179"></span><span>
</span><span id="line-2180"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; Bool -&gt; Bool -&gt; CoreRule
</span><a href="#local-6989586621682931920"><span class="hs-identifier hs-var">integer_to_natural</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Natural (clamp)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToNaturalClampName"><span class="hs-identifier hs-var">integerToNaturalClampName</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-2181"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; Bool -&gt; Bool -&gt; CoreRule
</span><a href="#local-6989586621682931920"><span class="hs-identifier hs-var">integer_to_natural</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Natural (wrap)&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToNaturalName"><span class="hs-identifier hs-var">integerToNaturalName</span></a></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2182"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; Bool -&gt; Bool -&gt; CoreRule
</span><a href="#local-6989586621682931920"><span class="hs-identifier hs-var">integer_to_natural</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer -&gt; Natural (throw)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerToNaturalThrowName"><span class="hs-identifier hs-var">integerToNaturalThrowName</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-2183"></span><span>
</span><span id="line-2184"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931924"><span class="hs-identifier hs-var">natural_to_word</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Natural -&gt; Word# (wrap)&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalToWordName"><span class="hs-identifier hs-var">naturalToWordName</span></a></span><span>
</span><span id="line-2185"></span><span>
</span><span id="line-2186"></span><span>    </span><span class="hs-comment">-- comparisons (return an unlifted Int#)</span><span>
</span><span id="line-2187"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Bool) -&gt; CoreRule
</span><a href="#local-6989586621682931926"><span class="hs-identifier hs-var">bignum_bin_pred</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bigNatEq#&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#bignatEqName"><span class="hs-identifier hs-var">bignatEqName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span>
</span><span id="line-2188"></span><span>
</span><span id="line-2189"></span><span>    </span><span class="hs-comment">-- comparisons (return an Ordering)</span><span>
</span><span id="line-2190"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931928"><span class="hs-identifier hs-var">bignum_compare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bignatCompare&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#bignatCompareName"><span class="hs-identifier hs-var">bignatCompareName</span></a></span><span>
</span><span id="line-2191"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931928"><span class="hs-identifier hs-var">bignum_compare</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bignatCompareWord#&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#bignatCompareWordName"><span class="hs-identifier hs-var">bignatCompareWordName</span></a></span><span>
</span><span id="line-2192"></span><span>
</span><span id="line-2193"></span><span>    </span><span class="hs-comment">-- binary operations</span><span>
</span><span id="line-2194"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var">integer_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerAdd&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerAddName"><span class="hs-identifier hs-var">integerAddName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-2195"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var">integer_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerSub&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerSubName"><span class="hs-identifier hs-var">integerSubName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span>
</span><span id="line-2196"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var">integer_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerMul&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerMulName"><span class="hs-identifier hs-var">integerMulName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span>
</span><span id="line-2197"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var">integer_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerGcd&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerGcdName"><span class="hs-identifier hs-var">integerGcdName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">gcd</span></span><span>
</span><span id="line-2198"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var">integer_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerLcm&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerLcmName"><span class="hs-identifier hs-var">integerLcmName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">lcm</span></span><span>
</span><span id="line-2199"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var">integer_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerAnd&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerAndName"><span class="hs-identifier hs-var">integerAndName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span>
</span><span id="line-2200"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var">integer_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerOr&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerOrName"><span class="hs-identifier hs-var">integerOrName</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span>
</span><span id="line-2201"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var">integer_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerXor&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerXorName"><span class="hs-identifier hs-var">integerXorName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span>
</span><span id="line-2202"></span><span>
</span><span id="line-2203"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931942"><span class="hs-identifier hs-var">natural_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalAdd&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalAddName"><span class="hs-identifier hs-var">naturalAddName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-2204"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931942"><span class="hs-identifier hs-var">natural_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalMul&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalMulName"><span class="hs-identifier hs-var">naturalMulName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span>
</span><span id="line-2205"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931942"><span class="hs-identifier hs-var">natural_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalGcd&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalGcdName"><span class="hs-identifier hs-var">naturalGcdName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">gcd</span></span><span>
</span><span id="line-2206"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931942"><span class="hs-identifier hs-var">natural_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalLcm&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalLcmName"><span class="hs-identifier hs-var">naturalLcmName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">lcm</span></span><span>
</span><span id="line-2207"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931942"><span class="hs-identifier hs-var">natural_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalAnd&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalAndName"><span class="hs-identifier hs-var">naturalAndName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.&amp;.)</span></span><span>
</span><span id="line-2208"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931942"><span class="hs-identifier hs-var">natural_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalOr&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalOrName"><span class="hs-identifier hs-var">naturalOrName</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(.|.)</span></span><span>
</span><span id="line-2209"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931942"><span class="hs-identifier hs-var">natural_binop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalXor&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalXorName"><span class="hs-identifier hs-var">naturalXorName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span>
</span><span id="line-2210"></span><span>
</span><span id="line-2211"></span><span>    </span><span class="hs-comment">-- Natural subtraction: it's a binop but it can fail because of underflow so</span><span>
</span><span id="line-2212"></span><span>    </span><span class="hs-comment">-- we have several primitives to handle here.</span><span>
</span><span id="line-2213"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931950"><span class="hs-identifier hs-var">natural_sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalSubUnsafe&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalSubUnsafeName"><span class="hs-identifier hs-var">naturalSubUnsafeName</span></a></span><span>
</span><span id="line-2214"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931950"><span class="hs-identifier hs-var">natural_sub</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalSubThrow&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalSubThrowName"><span class="hs-identifier hs-var">naturalSubThrowName</span></a></span><span>
</span><span id="line-2215"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalSub&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalSubName"><span class="hs-identifier hs-var">naturalSubName</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2216"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621682931955"><span class="annot"><a href="#local-6989586621682931955"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682931956"><span class="annot"><a href="#local-6989586621682931956"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2217"></span><span>        </span><span id="local-6989586621682931957"><span class="annot"><a href="#local-6989586621682931957"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-type">isNaturalLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931955"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2218"></span><span>        </span><span id="local-6989586621682931958"><span class="annot"><a href="#local-6989586621682931958"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-type">isNaturalLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931956"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2219"></span><span>        </span><span class="hs-comment">-- return an unboxed sum: (# (# #) | Natural #)</span><span>
</span><span id="line-2220"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682931964"><span class="annot"><a href="#local-6989586621682931964"><span class="hs-identifier hs-var hs-var">ret</span></a></span></span><span> </span><span id="local-6989586621682931965"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931965"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621682931966"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931966"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; f CoreExpr
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; f CoreExpr) -&gt; CoreExpr -&gt; f CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; ConTagZ -&gt; [Type] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkCoreUnboxedSum"><span class="hs-identifier hs-var">mkCoreUnboxedSum</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682931965"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#unboxedUnitTy"><span class="hs-identifier hs-var">unboxedUnitTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Type
</span><a href="GHC.Builtin.Types.html#naturalTy"><span class="hs-identifier hs-var">naturalTy</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682931966"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-2221"></span><span>        </span><span id="local-6989586621682931970"><span class="annot"><a href="#local-6989586621682931970"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2222"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682931957"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;</span></span><span> </span><span class="annot"><a href="#local-6989586621682931958"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-2223"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="#local-6989586621682931964"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="GHC.Types.Id.Make.html#unboxedUnitExpr"><span class="hs-identifier hs-type">unboxedUnitExpr</span></a></span><span>
</span><span id="line-2224"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="#local-6989586621682931964"><span class="hs-identifier hs-type">ret</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-type">mkNaturalExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682931970"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682931957"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682931958"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2225"></span><span>
</span><span id="line-2226"></span><span>    </span><span class="hs-comment">-- unary operations</span><span>
</span><span id="line-2227"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; (Integer -&gt; Integer)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; (Integer -&gt; t)
-&gt; CoreRule
</span><a href="#local-6989586621682931972"><span class="hs-identifier hs-var">bignum_unop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerNegate&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerNegateName"><span class="hs-identifier hs-var">integerNegateName</span></a></span><span>     </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span>
</span><span id="line-2228"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; (Integer -&gt; Integer)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; (Integer -&gt; t)
-&gt; CoreRule
</span><a href="#local-6989586621682931972"><span class="hs-identifier hs-var">bignum_unop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerAbs&quot;</span></span><span>        </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerAbsName"><span class="hs-identifier hs-var">integerAbsName</span></a></span><span>        </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span>
</span><span id="line-2229"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; (Integer -&gt; Integer)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; (Integer -&gt; t)
-&gt; CoreRule
</span><a href="#local-6989586621682931972"><span class="hs-identifier hs-var">bignum_unop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerComplement&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerComplementName"><span class="hs-identifier hs-var">integerComplementName</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span>
</span><span id="line-2230"></span><span>
</span><span id="line-2231"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; Literal) -&gt; CoreRule
forall {t}.
Num t =&gt;
String -&gt; Name -&gt; (Platform -&gt; t -&gt; Literal) -&gt; CoreRule
</span><a href="#local-6989586621682931978"><span class="hs-identifier hs-var">bignum_popcount</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerPopCount&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerPopCountName"><span class="hs-identifier hs-var">integerPopCountName</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitIntWrap"><span class="hs-identifier hs-var">mkLitIntWrap</span></a></span><span>
</span><span id="line-2232"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; Literal) -&gt; CoreRule
forall {t}.
Num t =&gt;
String -&gt; Name -&gt; (Platform -&gt; t -&gt; Literal) -&gt; CoreRule
</span><a href="#local-6989586621682931978"><span class="hs-identifier hs-var">bignum_popcount</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalPopCount&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalPopCountName"><span class="hs-identifier hs-var">naturalPopCountName</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitWordWrap"><span class="hs-identifier hs-var">mkLitWordWrap</span></a></span><span>
</span><span id="line-2233"></span><span>
</span><span id="line-2234"></span><span>    </span><span class="hs-comment">-- Bits.bit</span><span>
</span><span id="line-2235"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
forall {a}.
(Num a, Bits a) =&gt;
String -&gt; Name -&gt; (Platform -&gt; a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931981"><span class="hs-identifier hs-var">bignum_bit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerBit&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerBitName"><span class="hs-identifier hs-var">integerBitName</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2236"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
forall {a}.
(Num a, Bits a) =&gt;
String -&gt; Name -&gt; (Platform -&gt; a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931981"><span class="hs-identifier hs-var">bignum_bit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalBit&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalBitName"><span class="hs-identifier hs-var">naturalBitName</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-var">mkNaturalExpr</span></a></span><span>
</span><span id="line-2237"></span><span>
</span><span id="line-2238"></span><span>    </span><span class="hs-comment">-- Bits.testBit</span><span>
</span><span id="line-2239"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931984"><span class="hs-identifier hs-var">bignum_testbit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerTestBit&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerTestBitName"><span class="hs-identifier hs-var">integerTestBitName</span></a></span><span>
</span><span id="line-2240"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931984"><span class="hs-identifier hs-var">bignum_testbit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalTestBit&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalTestBitName"><span class="hs-identifier hs-var">naturalTestBitName</span></a></span><span>
</span><span id="line-2241"></span><span>
</span><span id="line-2242"></span><span>    </span><span class="hs-comment">-- Bits.shift</span><span>
</span><span id="line-2243"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t} {t}.
Num t =&gt;
String
-&gt; Name
-&gt; (Integer -&gt; t -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931987"><span class="hs-identifier hs-var">bignum_shift</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerShiftL&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerShiftLName"><span class="hs-identifier hs-var">integerShiftLName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2244"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t} {t}.
Num t =&gt;
String
-&gt; Name
-&gt; (Integer -&gt; t -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931987"><span class="hs-identifier hs-var">bignum_shift</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerShiftR&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerShiftRName"><span class="hs-identifier hs-var">integerShiftRName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-identifier hs-var">shiftR</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2245"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t} {t}.
Num t =&gt;
String
-&gt; Name
-&gt; (Integer -&gt; t -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931987"><span class="hs-identifier hs-var">bignum_shift</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalShiftL&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalShiftLName"><span class="hs-identifier hs-var">naturalShiftLName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-var">mkNaturalExpr</span></a></span><span>
</span><span id="line-2246"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; ConTagZ -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t} {t}.
Num t =&gt;
String
-&gt; Name
-&gt; (Integer -&gt; t -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931987"><span class="hs-identifier hs-var">bignum_shift</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalShiftR&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalShiftRName"><span class="hs-identifier hs-var">naturalShiftRName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ -&gt; Integer
forall a. Bits a =&gt; a -&gt; ConTagZ -&gt; a
</span><a href="GHC.Prelude.Basic.html#shiftR"><span class="hs-identifier hs-var">shiftR</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-var">mkNaturalExpr</span></a></span><span>
</span><span id="line-2247"></span><span>
</span><span id="line-2248"></span><span>    </span><span class="hs-comment">-- division</span><span>
</span><span id="line-2249"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931992"><span class="hs-identifier hs-var">divop_one</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerQuot&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerQuotName"><span class="hs-identifier hs-var">integerQuotName</span></a></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span>    </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2250"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931992"><span class="hs-identifier hs-var">divop_one</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerRem&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerRemName"><span class="hs-identifier hs-var">integerRemName</span></a></span><span>     </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span>     </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2251"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931992"><span class="hs-identifier hs-var">divop_one</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerDiv&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerDivName"><span class="hs-identifier hs-var">integerDivName</span></a></span><span>     </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">div</span></span><span>     </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2252"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931992"><span class="hs-identifier hs-var">divop_one</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerMod&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerModName"><span class="hs-identifier hs-var">integerModName</span></a></span><span>     </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span>     </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2253"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; (Integer, Integer))
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; (t, t))
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931997"><span class="hs-identifier hs-var">divop_both</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerDivMod&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerDivModName"><span class="hs-identifier hs-var">integerDivModName</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; (Integer, Integer)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-identifier hs-var">divMod</span></span><span>  </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2254"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; (Integer, Integer))
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; (t, t))
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931997"><span class="hs-identifier hs-var">divop_both</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerQuotRem&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerQuotRemName"><span class="hs-identifier hs-var">integerQuotRemName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; (Integer, Integer)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-identifier hs-var">quotRem</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-var">mkIntegerExpr</span></a></span><span>
</span><span id="line-2255"></span><span>
</span><span id="line-2256"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931992"><span class="hs-identifier hs-var">divop_one</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalQuot&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalQuotName"><span class="hs-identifier hs-var">naturalQuotName</span></a></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">quot</span></span><span>    </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-var">mkNaturalExpr</span></a></span><span>
</span><span id="line-2257"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; Integer)
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931992"><span class="hs-identifier hs-var">divop_one</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalRem&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalRemName"><span class="hs-identifier hs-var">naturalRemName</span></a></span><span>     </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">rem</span></span><span>     </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-var">mkNaturalExpr</span></a></span><span>
</span><span id="line-2258"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; (Integer, Integer))
-&gt; (Platform -&gt; Integer -&gt; CoreExpr)
-&gt; CoreRule
forall {t}.
String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; (t, t))
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931997"><span class="hs-identifier hs-var">divop_both</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;naturalQuotRem&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#naturalQuotRemName"><span class="hs-identifier hs-var">naturalQuotRemName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; (Integer, Integer)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-identifier hs-var">quotRem</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-var">mkNaturalExpr</span></a></span><span>
</span><span id="line-2259"></span><span>
</span><span id="line-2260"></span><span>    </span><span class="hs-comment">-- conversions from Rational for Float/Double literals</span><span>
</span><span id="line-2261"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Float -&gt; CoreExpr) -&gt; CoreRule
forall a.
RealFloat a =&gt;
String -&gt; Name -&gt; (a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682932005"><span class="hs-identifier hs-var">rational_to</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rationalToFloat&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#rationalToFloatName"><span class="hs-identifier hs-var">rationalToFloatName</span></a></span><span>  </span><span class="annot"><span class="annottext">Float -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkFloatExpr"><span class="hs-identifier hs-var">mkFloatExpr</span></a></span><span>
</span><span id="line-2262"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Double -&gt; CoreExpr) -&gt; CoreRule
forall a.
RealFloat a =&gt;
String -&gt; Name -&gt; (a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682932005"><span class="hs-identifier hs-var">rational_to</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rationalToDouble&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#rationalToDoubleName"><span class="hs-identifier hs-var">rationalToDoubleName</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; CoreExpr
</span><a href="GHC.Core.Make.html#mkDoubleExpr"><span class="hs-identifier hs-var">mkDoubleExpr</span></a></span><span>
</span><span id="line-2263"></span><span>
</span><span id="line-2264"></span><span>    </span><span class="hs-comment">-- conversions from Integer for Float/Double literals</span><span>
</span><span id="line-2265"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Float -&gt; CoreExpr) -&gt; CoreRule
forall a.
RealFloat a =&gt;
String -&gt; Name -&gt; (a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682932010"><span class="hs-identifier hs-var">integer_encode_float</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerEncodeFloat&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerEncodeFloatName"><span class="hs-identifier hs-var">integerEncodeFloatName</span></a></span><span>  </span><span class="annot"><span class="annottext">Float -&gt; CoreExpr
forall b. Float -&gt; Expr b
</span><a href="GHC.Core.html#mkFloatLitFloat"><span class="hs-identifier hs-var">mkFloatLitFloat</span></a></span><span>
</span><span id="line-2266"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; (Double -&gt; CoreExpr) -&gt; CoreRule
forall a.
RealFloat a =&gt;
String -&gt; Name -&gt; (a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682932010"><span class="hs-identifier hs-var">integer_encode_float</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;integerEncodeDouble&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="GHC.Builtin.Names.html#integerEncodeDoubleName"><span class="hs-identifier hs-var">integerEncodeDoubleName</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; CoreExpr
forall b. Double -&gt; Expr b
</span><a href="GHC.Core.html#mkDoubleLitDouble"><span class="hs-identifier hs-var">mkDoubleLitDouble</span></a></span><span>
</span><span id="line-2267"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-2268"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2269"></span><span>    </span><span id="local-6989586621682931953"><span class="annot"><span class="annottext">mkRule :: String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var hs-var">mkRule</span></a></span></span><span> </span><span id="local-6989586621682932016"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932016"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932017"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932017"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932018"><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682932018"><span class="hs-identifier hs-var">nargs</span></a></span></span><span> </span><span id="local-6989586621682932019"><span class="annot"><span class="annottext">RuleM CoreExpr
</span><a href="#local-6989586621682932019"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.html#BuiltinRule"><span class="hs-identifier hs-type">BuiltinRule</span></a></span><span>
</span><span id="line-2270"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ru_name :: RuleName
</span><a href="GHC.Core.html#ru_name"><span class="hs-identifier hs-var">ru_name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; RuleName
</span><a href="GHC.Data.FastString.html#fsLit"><span class="hs-identifier hs-var">fsLit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932016"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-2271"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_fn :: Name
</span><a href="GHC.Core.html#ru_fn"><span class="hs-identifier hs-var">ru_fn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932017"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-2272"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_nargs :: ConTagZ
</span><a href="GHC.Core.html#ru_nargs"><span class="hs-identifier hs-var">ru_nargs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682932018"><span class="hs-identifier hs-var">nargs</span></a></span><span>
</span><span id="line-2273"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ru_try :: RuleFun
</span><a href="GHC.Core.html#ru_try"><span class="hs-identifier hs-var">ru_try</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleM CoreExpr -&gt; RuleFun
forall r.
RuleM r -&gt; RuleOpts -&gt; InScopeEnv -&gt; Id -&gt; [CoreExpr] -&gt; Maybe r
</span><a href="GHC.Core.Opt.ConstantFold.html#runRuleM"><span class="hs-identifier hs-var">runRuleM</span></a></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; RuleFun) -&gt; RuleM CoreExpr -&gt; RuleFun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2274"></span><span>          </span><span id="local-6989586621682932020"><span class="annot"><a href="#local-6989586621682932020"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-2275"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#roBignumRules"><span class="hs-identifier hs-var">roBignumRules</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932020"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2276"></span><span>          </span><span class="annot"><a href="#local-6989586621682932019"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-2277"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-2278"></span><span>
</span><span id="line-2279"></span><span>    </span><span id="local-6989586621682931911"><span class="annot"><span class="annottext">integer_to_lit :: String -&gt; Name -&gt; (Platform -&gt; Integer -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931911"><span class="hs-identifier hs-var hs-var">integer_to_lit</span></a></span></span><span> </span><span id="local-6989586621682932027"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932027"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932028"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932028"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932029"><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932029"><span class="hs-identifier hs-var">convert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932027"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932028"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2280"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932030"><span class="annot"><a href="#local-6989586621682932030"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2281"></span><span>      </span><span id="local-6989586621682932031"><span class="annot"><a href="#local-6989586621682932031"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2282"></span><span>      </span><span class="hs-comment">-- we only match on Big Integer literals. Small literals</span><span>
</span><span id="line-2283"></span><span>      </span><span class="hs-comment">-- are matched by the &quot;Int# -&gt; Integer -&gt; *&quot; rules</span><span>
</span><span id="line-2284"></span><span>      </span><span id="local-6989586621682932032"><span class="annot"><a href="#local-6989586621682932032"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBigIntegerLiteral"><span class="hs-identifier hs-type">isBigIntegerLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932030"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2285"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932029"><span class="hs-identifier hs-type">convert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932031"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932032"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2286"></span><span>
</span><span id="line-2287"></span><span>    </span><span id="local-6989586621682931924"><span class="annot"><span class="annottext">natural_to_word :: String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931924"><span class="hs-identifier hs-var hs-var">natural_to_word</span></a></span></span><span> </span><span id="local-6989586621682932038"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932038"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932039"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932039"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932038"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932039"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2288"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932040"><span class="annot"><a href="#local-6989586621682932040"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2289"></span><span>      </span><span id="local-6989586621682932041"><span class="annot"><a href="#local-6989586621682932041"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-type">isNaturalLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932040"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2290"></span><span>      </span><span id="local-6989586621682932042"><span class="annot"><a href="#local-6989586621682932042"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2291"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#mkLitWordWrap"><span class="hs-identifier hs-type">mkLitWordWrap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932042"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932041"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2292"></span><span>
</span><span id="line-2293"></span><span>    </span><span id="local-6989586621682931920"><span class="annot"><span class="annottext">integer_to_natural :: String -&gt; Name -&gt; Bool -&gt; Bool -&gt; CoreRule
</span><a href="#local-6989586621682931920"><span class="hs-identifier hs-var hs-var">integer_to_natural</span></a></span></span><span> </span><span id="local-6989586621682932054"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932054"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932055"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932055"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932056"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682932056"><span class="hs-identifier hs-var">thrw</span></a></span></span><span> </span><span id="local-6989586621682932057"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682932057"><span class="hs-identifier hs-var">clamp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932054"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932055"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2294"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932058"><span class="annot"><a href="#local-6989586621682932058"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2295"></span><span>      </span><span id="local-6989586621682932059"><span class="annot"><a href="#local-6989586621682932059"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-type">isIntegerLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932058"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2296"></span><span>      </span><span id="local-6989586621682932060"><span class="annot"><a href="#local-6989586621682932060"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2297"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682932059"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-type">mkNaturalExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932060"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932059"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-2298"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682932056"><span class="hs-identifier hs-type">thrw</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mzero</span></span><span>
</span><span id="line-2299"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621682932057"><span class="hs-identifier hs-type">clamp</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-type">mkNaturalExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932060"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>       </span><span class="hs-comment">-- clamp to 0</span><span>
</span><span id="line-2300"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-type">mkNaturalExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932060"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">abs</span></span><span> </span><span class="annot"><a href="#local-6989586621682932059"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- negate/wrap</span><span>
</span><span id="line-2301"></span><span>
</span><span id="line-2302"></span><span>    </span><span id="local-6989586621682931906"><span class="annot"><span class="annottext">lit_to_integer :: String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931906"><span class="hs-identifier hs-var hs-var">lit_to_integer</span></a></span></span><span> </span><span id="local-6989586621682932066"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932066"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932067"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932067"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932066"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932067"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2303"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932068"><span class="annot"><a href="#local-6989586621682932068"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2304"></span><span>      </span><span id="local-6989586621682932069"><span class="annot"><a href="#local-6989586621682932069"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2305"></span><span>      </span><span id="local-6989586621682932070"><span class="annot"><a href="#local-6989586621682932070"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932068"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2306"></span><span>      </span><span class="hs-comment">-- convert any numeric literal into an Integer literal</span><span>
</span><span id="line-2307"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-type">mkIntegerExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932069"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932070"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2308"></span><span>
</span><span id="line-2309"></span><span>    </span><span id="local-6989586621682931931"><span class="annot"><span class="annottext">integer_binop :: String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931931"><span class="hs-identifier hs-var hs-var">integer_binop</span></a></span></span><span> </span><span id="local-6989586621682932077"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932077"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932078"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932078"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932079"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621682932079"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932077"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932078"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2310"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932080"><span class="annot"><a href="#local-6989586621682932080"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932081"><span class="annot"><a href="#local-6989586621682932081"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2311"></span><span>      </span><span id="local-6989586621682932082"><span class="annot"><a href="#local-6989586621682932082"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-type">isIntegerLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932080"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2312"></span><span>      </span><span id="local-6989586621682932083"><span class="annot"><a href="#local-6989586621682932083"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-type">isIntegerLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932081"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2313"></span><span>      </span><span id="local-6989586621682932084"><span class="annot"><a href="#local-6989586621682932084"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2314"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkIntegerExpr"><span class="hs-identifier hs-type">mkIntegerExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932084"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932082"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932079"><span class="hs-operator hs-type">`op`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932083"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2315"></span><span>
</span><span id="line-2316"></span><span>    </span><span id="local-6989586621682931942"><span class="annot"><span class="annottext">natural_binop :: String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; CoreRule
</span><a href="#local-6989586621682931942"><span class="hs-identifier hs-var hs-var">natural_binop</span></a></span></span><span> </span><span id="local-6989586621682932091"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932091"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932092"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932092"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932093"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
</span><a href="#local-6989586621682932093"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932091"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932092"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2317"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932094"><span class="annot"><a href="#local-6989586621682932094"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932095"><span class="annot"><a href="#local-6989586621682932095"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2318"></span><span>      </span><span id="local-6989586621682932096"><span class="annot"><a href="#local-6989586621682932096"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-type">isNaturalLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932094"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2319"></span><span>      </span><span id="local-6989586621682932097"><span class="annot"><a href="#local-6989586621682932097"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-type">isNaturalLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932095"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2320"></span><span>      </span><span id="local-6989586621682932098"><span class="annot"><a href="#local-6989586621682932098"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2321"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-type">mkNaturalExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932098"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932096"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932093"><span class="hs-operator hs-type">`op`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932097"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2322"></span><span>
</span><span id="line-2323"></span><span>    </span><span id="local-6989586621682931950"><span class="annot"><span class="annottext">natural_sub :: String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931950"><span class="hs-identifier hs-var hs-var">natural_sub</span></a></span></span><span> </span><span id="local-6989586621682932109"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932109"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932110"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932110"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932109"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932110"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2324"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932111"><span class="annot"><a href="#local-6989586621682932111"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932112"><span class="annot"><a href="#local-6989586621682932112"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2325"></span><span>      </span><span id="local-6989586621682932113"><span class="annot"><a href="#local-6989586621682932113"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-type">isNaturalLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932111"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2326"></span><span>      </span><span id="local-6989586621682932114"><span class="annot"><a href="#local-6989586621682932114"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNaturalLiteral"><span class="hs-identifier hs-type">isNaturalLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932112"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2327"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932113"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621682932114"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2328"></span><span>      </span><span id="local-6989586621682932115"><span class="annot"><a href="#local-6989586621682932115"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2329"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Make.html#mkNaturalExpr"><span class="hs-identifier hs-type">mkNaturalExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932115"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932113"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><a href="#local-6989586621682932114"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2330"></span><span>
</span><span id="line-2331"></span><span>    </span><span id="local-6989586621682931926"><span class="annot"><span class="annottext">bignum_bin_pred :: String -&gt; Name -&gt; (Integer -&gt; Integer -&gt; Bool) -&gt; CoreRule
</span><a href="#local-6989586621682931926"><span class="hs-identifier hs-var hs-var">bignum_bin_pred</span></a></span></span><span> </span><span id="local-6989586621682932122"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932122"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932123"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932123"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932124"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
</span><a href="#local-6989586621682932124"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932122"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932123"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2332"></span><span>      </span><span id="local-6989586621682932125"><span class="annot"><a href="#local-6989586621682932125"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2333"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932126"><span class="annot"><a href="#local-6989586621682932126"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932127"><span class="annot"><a href="#local-6989586621682932127"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2334"></span><span>      </span><span id="local-6989586621682932128"><span class="annot"><a href="#local-6989586621682932128"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932126"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2335"></span><span>      </span><span id="local-6989586621682932129"><span class="annot"><a href="#local-6989586621682932129"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932127"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2336"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621682932128"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932124"><span class="hs-operator hs-type">`op`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932129"><span class="hs-identifier hs-type">y</span></a></span><span>
</span><span id="line-2337"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-type">trueValInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932125"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-2338"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-type">falseValInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932125"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-2339"></span><span>
</span><span id="line-2340"></span><span>    </span><span id="local-6989586621682931928"><span class="annot"><span class="annottext">bignum_compare :: String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931928"><span class="hs-identifier hs-var hs-var">bignum_compare</span></a></span></span><span> </span><span id="local-6989586621682932136"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932136"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932137"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932137"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932136"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932137"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2341"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932138"><span class="annot"><a href="#local-6989586621682932138"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932139"><span class="annot"><a href="#local-6989586621682932139"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2342"></span><span>      </span><span id="local-6989586621682932140"><span class="annot"><a href="#local-6989586621682932140"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932138"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2343"></span><span>      </span><span id="local-6989586621682932141"><span class="annot"><a href="#local-6989586621682932141"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932139"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2344"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621682932140"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">`compare`</span></span><span> </span><span class="annot"><a href="#local-6989586621682932141"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2345"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#ltVal"><span class="hs-identifier hs-var">ltVal</span></a></span><span>
</span><span id="line-2346"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#eqVal"><span class="hs-identifier hs-var">eqVal</span></a></span><span>
</span><span id="line-2347"></span><span>              </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#gtVal"><span class="hs-identifier hs-var">gtVal</span></a></span><span>
</span><span id="line-2348"></span><span>
</span><span id="line-2349"></span><span>    </span><span id="local-6989586621682931972"><span class="annot"><span class="annottext">bignum_unop :: String
-&gt; Name
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; (Integer -&gt; t)
-&gt; CoreRule
</span><a href="#local-6989586621682931972"><span class="hs-identifier hs-var hs-var">bignum_unop</span></a></span></span><span> </span><span id="local-6989586621682932148"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932148"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932149"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932149"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932150"><span class="annot"><span class="annottext">Platform -&gt; t -&gt; CoreExpr
</span><a href="#local-6989586621682932150"><span class="hs-identifier hs-var">mk_lit</span></a></span></span><span> </span><span id="local-6989586621682932151"><span class="annot"><span class="annottext">Integer -&gt; t
</span><a href="#local-6989586621682932151"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932148"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932149"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2350"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932152"><span class="annot"><a href="#local-6989586621682932152"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2351"></span><span>      </span><span id="local-6989586621682932153"><span class="annot"><a href="#local-6989586621682932153"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932152"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2352"></span><span>      </span><span id="local-6989586621682932154"><span class="annot"><a href="#local-6989586621682932154"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2353"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682932150"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932154"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932151"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932153"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2354"></span><span>
</span><span id="line-2355"></span><span>    </span><span id="local-6989586621682931978"><span class="annot"><span class="annottext">bignum_popcount :: String -&gt; Name -&gt; (Platform -&gt; t -&gt; Literal) -&gt; CoreRule
</span><a href="#local-6989586621682931978"><span class="hs-identifier hs-var hs-var">bignum_popcount</span></a></span></span><span> </span><span id="local-6989586621682932169"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932169"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932170"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932170"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932171"><span class="annot"><span class="annottext">Platform -&gt; t -&gt; Literal
</span><a href="#local-6989586621682932171"><span class="hs-identifier hs-var">mk_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932169"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932170"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2356"></span><span>      </span><span id="local-6989586621682932172"><span class="annot"><a href="#local-6989586621682932172"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM Platform
</span><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-var">getPlatform</span></a></span><span>
</span><span id="line-2357"></span><span>      </span><span class="hs-comment">-- We use a host Int to compute the popCount. If we compile on a 32-bit</span><span>
</span><span id="line-2358"></span><span>      </span><span class="hs-comment">-- host for a 64-bit target, the result may be different than if computed</span><span>
</span><span id="line-2359"></span><span>      </span><span class="hs-comment">-- by the target. So we disable this rule if sizes don't match.</span><span>
</span><span id="line-2360"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#platformWordSizeInBits"><span class="hs-identifier hs-type">platformWordSizeInBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932172"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">finiteBitSize</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2361"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932174"><span class="annot"><a href="#local-6989586621682932174"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2362"></span><span>      </span><span id="local-6989586621682932175"><span class="annot"><a href="#local-6989586621682932175"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932174"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2363"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932171"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932172"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">popCount</span></span><span> </span><span class="annot"><a href="#local-6989586621682932175"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2364"></span><span>
</span><span id="line-2365"></span><span>    </span><span id="local-6989586621682931981"><span class="annot"><span class="annottext">bignum_bit :: String -&gt; Name -&gt; (Platform -&gt; a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682931981"><span class="hs-identifier hs-var hs-var">bignum_bit</span></a></span></span><span> </span><span id="local-6989586621682932197"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932197"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932198"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932198"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932199"><span class="annot"><span class="annottext">Platform -&gt; a -&gt; CoreExpr
</span><a href="#local-6989586621682932199"><span class="hs-identifier hs-var">mk_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932197"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932198"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2366"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932200"><span class="annot"><a href="#local-6989586621682932200"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2367"></span><span>      </span><span id="local-6989586621682932201"><span class="annot"><a href="#local-6989586621682932201"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2368"></span><span>      </span><span id="local-6989586621682932202"><span class="annot"><a href="#local-6989586621682932202"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNumberLiteral"><span class="hs-identifier hs-type">isNumberLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932200"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2369"></span><span>      </span><span class="hs-comment">-- Make sure n is positive and small enough to yield a decently</span><span>
</span><span id="line-2370"></span><span>      </span><span class="hs-comment">-- small number. Attempting to construct the Integer for</span><span>
</span><span id="line-2371"></span><span>      </span><span class="hs-comment">--    (integerBit 9223372036854775807#)</span><span>
</span><span id="line-2372"></span><span>      </span><span class="hs-comment">-- would be a bad idea (#14959)</span><span>
</span><span id="line-2373"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932202"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682932202"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Platform.html#platformWordSizeInBits"><span class="hs-identifier hs-type">platformWordSizeInBits</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932201"><span class="hs-identifier hs-type">platform</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2374"></span><span>      </span><span class="hs-comment">-- it's safe to convert a target Int value into a host Int value</span><span>
</span><span id="line-2375"></span><span>      </span><span class="hs-comment">-- to perform the &quot;bit&quot; operation because n is very small (&lt;= 64).</span><span>
</span><span id="line-2376"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682932199"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932201"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Prelude.Basic.html#bit"><span class="hs-identifier hs-type">bit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682932202"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2377"></span><span>
</span><span id="line-2378"></span><span>    </span><span id="local-6989586621682931984"><span class="annot"><span class="annottext">bignum_testbit :: String -&gt; Name -&gt; CoreRule
</span><a href="#local-6989586621682931984"><span class="hs-identifier hs-var hs-var">bignum_testbit</span></a></span></span><span> </span><span id="local-6989586621682932221"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932221"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932222"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932222"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932221"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932222"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2379"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932223"><span class="annot"><a href="#local-6989586621682932223"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932224"><span class="annot"><a href="#local-6989586621682932224"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2380"></span><span>      </span><span id="local-6989586621682932225"><span class="annot"><a href="#local-6989586621682932225"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2381"></span><span>      </span><span id="local-6989586621682932226"><span class="annot"><a href="#local-6989586621682932226"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932223"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2382"></span><span>      </span><span id="local-6989586621682932227"><span class="annot"><a href="#local-6989586621682932227"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNumberLiteral"><span class="hs-identifier hs-type">isNumberLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932224"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2383"></span><span>      </span><span class="hs-comment">-- ensure that we can store 'n' in a host Int</span><span>
</span><span id="line-2384"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932227"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621682932227"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">maxBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2385"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="hs-identifier hs-type">testBit</span></span><span> </span><span class="annot"><a href="#local-6989586621682932226"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682932227"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2386"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#trueValInt"><span class="hs-identifier hs-type">trueValInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932225"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-2387"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#falseValInt"><span class="hs-identifier hs-type">falseValInt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932225"><span class="hs-identifier hs-type">platform</span></a></span><span>
</span><span id="line-2388"></span><span>
</span><span id="line-2389"></span><span>    </span><span id="local-6989586621682931987"><span class="annot"><span class="annottext">bignum_shift :: String
-&gt; Name
-&gt; (Integer -&gt; t -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931987"><span class="hs-identifier hs-var hs-var">bignum_shift</span></a></span></span><span> </span><span id="local-6989586621682932243"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932243"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932244"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932244"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932245"><span class="annot"><span class="annottext">Integer -&gt; t -&gt; t
</span><a href="#local-6989586621682932245"><span class="hs-identifier hs-var">shift_op</span></a></span></span><span> </span><span id="local-6989586621682932246"><span class="annot"><span class="annottext">Platform -&gt; t -&gt; CoreExpr
</span><a href="#local-6989586621682932246"><span class="hs-identifier hs-var">mk_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932243"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932244"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2390"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932247"><span class="annot"><a href="#local-6989586621682932247"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932248"><span class="annot"><a href="#local-6989586621682932248"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2391"></span><span>      </span><span id="local-6989586621682932249"><span class="annot"><a href="#local-6989586621682932249"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932247"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2392"></span><span>      </span><span id="local-6989586621682932250"><span class="annot"><a href="#local-6989586621682932250"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNumberLiteral"><span class="hs-identifier hs-type">isNumberLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932248"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2393"></span><span>      </span><span class="hs-comment">-- See Note [Guarding against silly shifts]</span><span>
</span><span id="line-2394"></span><span>      </span><span class="hs-comment">-- Restrict constant-folding of shifts on Integers, somewhat arbitrary.</span><span>
</span><span id="line-2395"></span><span>      </span><span class="hs-comment">-- We can get huge shifts in inaccessible code (#15673)</span><span>
</span><span id="line-2396"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932250"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-2397"></span><span>      </span><span id="local-6989586621682932251"><span class="annot"><a href="#local-6989586621682932251"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2398"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682932246"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932251"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932249"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932245"><span class="hs-operator hs-type">`shift_op`</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621682932250"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2399"></span><span>
</span><span id="line-2400"></span><span>    </span><span id="local-6989586621682931992"><span class="annot"><span class="annottext">divop_one :: String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; t)
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931992"><span class="hs-identifier hs-var hs-var">divop_one</span></a></span></span><span> </span><span id="local-6989586621682932262"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932262"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932263"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932263"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932264"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; t
</span><a href="#local-6989586621682932264"><span class="hs-identifier hs-var">divop</span></a></span></span><span> </span><span id="local-6989586621682932265"><span class="annot"><span class="annottext">Platform -&gt; t -&gt; CoreExpr
</span><a href="#local-6989586621682932265"><span class="hs-identifier hs-var">mk_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932262"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932263"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2401"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932266"><span class="annot"><a href="#local-6989586621682932266"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932267"><span class="annot"><a href="#local-6989586621682932267"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2402"></span><span>      </span><span id="local-6989586621682932268"><span class="annot"><a href="#local-6989586621682932268"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932266"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2403"></span><span>      </span><span id="local-6989586621682932269"><span class="annot"><a href="#local-6989586621682932269"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932267"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2404"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932269"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-2405"></span><span>      </span><span id="local-6989586621682932270"><span class="annot"><a href="#local-6989586621682932270"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2406"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682932265"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932270"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932268"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932264"><span class="hs-operator hs-type">`divop`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932269"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2407"></span><span>
</span><span id="line-2408"></span><span>    </span><span id="local-6989586621682931997"><span class="annot"><span class="annottext">divop_both :: String
-&gt; Name
-&gt; (Integer -&gt; Integer -&gt; (t, t))
-&gt; (Platform -&gt; t -&gt; CoreExpr)
-&gt; CoreRule
</span><a href="#local-6989586621682931997"><span class="hs-identifier hs-var hs-var">divop_both</span></a></span></span><span> </span><span id="local-6989586621682932281"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932281"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932282"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932282"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932283"><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; (t, t)
</span><a href="#local-6989586621682932283"><span class="hs-identifier hs-var">divop</span></a></span></span><span> </span><span id="local-6989586621682932284"><span class="annot"><span class="annottext">Platform -&gt; t -&gt; CoreExpr
</span><a href="#local-6989586621682932284"><span class="hs-identifier hs-var">mk_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932281"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932282"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2409"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932285"><span class="annot"><a href="#local-6989586621682932285"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932286"><span class="annot"><a href="#local-6989586621682932286"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2410"></span><span>      </span><span id="local-6989586621682932287"><span class="annot"><a href="#local-6989586621682932287"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932285"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2411"></span><span>      </span><span id="local-6989586621682932288"><span class="annot"><a href="#local-6989586621682932288"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isBignumLiteral"><span class="hs-identifier hs-type">isBignumLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932286"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2412"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932288"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-2413"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932289"><span class="annot"><a href="#local-6989586621682932289"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932290"><span class="annot"><a href="#local-6989586621682932290"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621682932287"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932283"><span class="hs-operator hs-type">`divop`</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932288"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-2414"></span><span>      </span><span id="local-6989586621682932291"><span class="annot"><a href="#local-6989586621682932291"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2415"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.Make.html#mkCoreUnboxedTuple"><span class="hs-identifier hs-type">mkCoreUnboxedTuple</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682932284"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932291"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932289"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682932284"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932291"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932290"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2416"></span><span>
</span><span id="line-2417"></span><span>    </span><span id="local-6989586621682932292"><span class="annot"><a href="#local-6989586621682932010"><span class="hs-identifier hs-type">integer_encode_float</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621682932292"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932292"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span></span><span>
</span><span id="line-2418"></span><span>    </span><span id="local-6989586621682932010"><span class="annot"><span class="annottext">integer_encode_float :: forall a.
RealFloat a =&gt;
String -&gt; Name -&gt; (a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682932010"><span class="hs-identifier hs-var hs-var">integer_encode_float</span></a></span></span><span> </span><span id="local-6989586621682932307"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932307"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932308"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932308"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932309"><span class="annot"><span class="annottext">a -&gt; CoreExpr
</span><a href="#local-6989586621682932309"><span class="hs-identifier hs-var">mk_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932307"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932308"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2419"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932310"><span class="annot"><a href="#local-6989586621682932310"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932311"><span class="annot"><a href="#local-6989586621682932311"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2420"></span><span>      </span><span id="local-6989586621682932312"><span class="annot"><a href="#local-6989586621682932312"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-type">isIntegerLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932310"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2421"></span><span>      </span><span id="local-6989586621682932313"><span class="annot"><a href="#local-6989586621682932313"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isNumberLiteral"><span class="hs-identifier hs-type">isNumberLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932311"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2422"></span><span>      </span><span class="hs-comment">-- check that y (a target Int) is in the host Int range</span><span>
</span><span id="line-2423"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932313"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">maxBound</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2424"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932309"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">encodeFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621682932312"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromInteger</span></span><span> </span><span class="annot"><a href="#local-6989586621682932313"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2425"></span><span>
</span><span id="line-2426"></span><span>    </span><span id="local-6989586621682929215"><span class="annot"><a href="#local-6989586621682932005"><span class="hs-identifier hs-type">rational_to</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFloat</span></span><span> </span><span class="annot"><a href="#local-6989586621682929215"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682929215"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreRule"><span class="hs-identifier hs-type">CoreRule</span></a></span></span><span>
</span><span id="line-2427"></span><span>    </span><span id="local-6989586621682932005"><span class="annot"><span class="annottext">rational_to :: forall a.
RealFloat a =&gt;
String -&gt; Name -&gt; (a -&gt; CoreExpr) -&gt; CoreRule
</span><a href="#local-6989586621682932005"><span class="hs-identifier hs-var hs-var">rational_to</span></a></span></span><span> </span><span id="local-6989586621682932331"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932331"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621682932332"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932332"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621682932333"><span class="annot"><span class="annottext">a -&gt; CoreExpr
</span><a href="#local-6989586621682932333"><span class="hs-identifier hs-var">mk_lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; ConTagZ -&gt; RuleM CoreExpr -&gt; CoreRule
</span><a href="#local-6989586621682931953"><span class="hs-identifier hs-var">mkRule</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682932331"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621682932332"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(RuleM CoreExpr -&gt; CoreRule) -&gt; RuleM CoreExpr -&gt; CoreRule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2428"></span><span>      </span><span class="hs-comment">-- This turns `rationalToFloat n d` where `n` and `d` are literals into</span><span>
</span><span id="line-2429"></span><span>      </span><span class="hs-comment">-- a literal Float (and similarly for Double).</span><span>
</span><span id="line-2430"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621682932334"><span class="annot"><a href="#local-6989586621682932334"><span class="hs-identifier hs-var">a0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932335"><span class="annot"><a href="#local-6989586621682932335"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-2431"></span><span>      </span><span id="local-6989586621682932336"><span class="annot"><a href="#local-6989586621682932336"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-type">isIntegerLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932334"><span class="hs-identifier hs-type">a0</span></a></span><span>
</span><span id="line-2432"></span><span>      </span><span id="local-6989586621682932337"><span class="annot"><a href="#local-6989586621682932337"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#isIntegerLiteral"><span class="hs-identifier hs-type">isIntegerLiteral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932335"><span class="hs-identifier hs-type">a1</span></a></span><span>
</span><span id="line-2433"></span><span>      </span><span class="hs-comment">-- it's important to not match d == 0, because that may represent a</span><span>
</span><span id="line-2434"></span><span>      </span><span class="hs-comment">-- literal &quot;0/0&quot; or similar, and we can't produce a literal value for</span><span>
</span><span id="line-2435"></span><span>      </span><span class="hs-comment">-- NaN or +-Inf</span><span>
</span><span id="line-2436"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932337"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-2437"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621682932333"><span class="hs-identifier hs-type">mk_lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fromRational</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682932336"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="#local-6989586621682932337"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2438"></span><span>
</span><span id="line-2439"></span><span>
</span><span id="line-2440"></span><span class="hs-comment">---------------------------------------------------</span><span>
</span><span id="line-2441"></span><span class="hs-comment">-- The rules are:</span><span>
</span><span id="line-2442"></span><span class="hs-comment">--      unpackAppendCString*# &quot;foo&quot;# (unpackCString*# &quot;baz&quot;#)</span><span>
</span><span id="line-2443"></span><span class="hs-comment">--      =  unpackCString*# &quot;foobaz&quot;#</span><span>
</span><span id="line-2444"></span><span class="hs-comment">--</span><span>
</span><span id="line-2445"></span><span class="hs-comment">--      unpackAppendCString*# &quot;foo&quot;# (unpackAppendCString*# &quot;baz&quot;# e)</span><span>
</span><span id="line-2446"></span><span class="hs-comment">--      =  unpackAppendCString*# &quot;foobaz&quot;# e</span><span>
</span><span id="line-2447"></span><span class="hs-comment">--</span><span>
</span><span id="line-2448"></span><span>
</span><span id="line-2449"></span><span class="hs-comment">-- CString version</span><span>
</span><span id="line-2450"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit_C"><span class="hs-identifier hs-type">match_cstring_append_lit_C</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-2451"></span><span id="match_cstring_append_lit_C"><span class="annot"><span class="annottext">match_cstring_append_lit_C :: RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit_C"><span class="hs-identifier hs-var hs-var">match_cstring_append_lit_C</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit"><span class="hs-identifier hs-var">match_cstring_append_lit</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unpackCStringAppendIdKey"><span class="hs-identifier hs-var">unpackCStringAppendIdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unpackCStringIdKey"><span class="hs-identifier hs-var">unpackCStringIdKey</span></a></span><span>
</span><span id="line-2452"></span><span>
</span><span id="line-2453"></span><span class="hs-comment">-- CStringUTF8 version</span><span>
</span><span id="line-2454"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit_utf8"><span class="hs-identifier hs-type">match_cstring_append_lit_utf8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-2455"></span><span id="match_cstring_append_lit_utf8"><span class="annot"><span class="annottext">match_cstring_append_lit_utf8 :: RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit_utf8"><span class="hs-identifier hs-var hs-var">match_cstring_append_lit_utf8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit"><span class="hs-identifier hs-var">match_cstring_append_lit</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unpackCStringAppendUtf8IdKey"><span class="hs-identifier hs-var">unpackCStringAppendUtf8IdKey</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unpackCStringUtf8IdKey"><span class="hs-identifier hs-var">unpackCStringUtf8IdKey</span></a></span><span>
</span><span id="line-2456"></span><span>
</span><span id="line-2457"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit"><span class="hs-pragma hs-type">match_cstring_append_lit</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2458"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit"><span class="hs-identifier hs-type">match_cstring_append_lit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-2459"></span><span id="match_cstring_append_lit"><span class="annot"><span class="annottext">match_cstring_append_lit :: Unique -&gt; Unique -&gt; RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit"><span class="hs-identifier hs-var hs-var">match_cstring_append_lit</span></a></span></span><span> </span><span id="local-6989586621682932344"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932344"><span class="hs-identifier hs-var">append_key</span></a></span></span><span> </span><span id="local-6989586621682932345"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932345"><span class="hs-identifier hs-var">unpack_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682932346"><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932346"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682932347"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932347"><span class="hs-identifier hs-var">lit1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932348"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932348"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2460"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932350"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932350"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932346"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932347"><span class="hs-identifier hs-var">lit1</span></a></span><span>
</span><span id="line-2461"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932351"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932351"><span class="hs-identifier hs-var">strTicks</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932352"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932352"><span class="hs-identifier hs-var">unpk</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932353"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932353"><span class="hs-identifier hs-var">lit2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicks"><span class="hs-identifier hs-var">stripStrTopTicks</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932346"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932348"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-2462"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932352"><span class="hs-identifier hs-var">unpk</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932345"><span class="hs-identifier hs-var">unpack_key</span></a></span><span>
</span><span id="line-2463"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932355"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932355"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932346"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932353"><span class="hs-identifier hs-var">lit2</span></a></span><span>
</span><span id="line-2464"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CoreTickish] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkTicks"><span class="hs-identifier hs-var">mkTicks</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932351"><span class="hs-identifier hs-var">strTicks</span></a></span><span>
</span><span id="line-2465"></span><span>         </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932352"><span class="hs-identifier hs-var">unpk</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932350"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#append"><span class="hs-operator hs-var">`BS.append`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932355"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2466"></span><span>
</span><span id="line-2467"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932357"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932357"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932346"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932347"><span class="hs-identifier hs-var">lit1</span></a></span><span>
</span><span id="line-2468"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932358"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932358"><span class="hs-identifier hs-var">strTicks</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932359"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932359"><span class="hs-identifier hs-var">appnd</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932360"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932360"><span class="hs-identifier hs-var">lit2</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932361"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932361"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicks"><span class="hs-identifier hs-var">stripStrTopTicks</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932346"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932348"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-2469"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932359"><span class="hs-identifier hs-var">appnd</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932344"><span class="hs-identifier hs-var">append_key</span></a></span><span>
</span><span id="line-2470"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932362"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932362"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932346"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932360"><span class="hs-identifier hs-var">lit2</span></a></span><span>
</span><span id="line-2471"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CoreTickish] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkTicks"><span class="hs-identifier hs-var">mkTicks</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932358"><span class="hs-identifier hs-var">strTicks</span></a></span><span>
</span><span id="line-2472"></span><span>         </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932359"><span class="hs-identifier hs-var">appnd</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932357"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#append"><span class="hs-operator hs-var">`BS.append`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932362"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932361"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2473"></span><span>
</span><span id="line-2474"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_append_lit"><span class="hs-identifier hs-var">match_cstring_append_lit</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2475"></span><span>
</span><span id="line-2476"></span><span class="hs-comment">---------------------------------------------------</span><span>
</span><span id="line-2477"></span><span class="hs-comment">-- The rule is this:</span><span>
</span><span id="line-2478"></span><span class="hs-comment">--      unpackFoldrCString*# &quot;foo&quot;# c (unpackFoldrCString*# &quot;baz&quot;# c n)</span><span>
</span><span id="line-2479"></span><span class="hs-comment">--      =  unpackFoldrCString*# &quot;foobaz&quot;# c n</span><span>
</span><span id="line-2480"></span><span class="hs-comment">--</span><span>
</span><span id="line-2481"></span><span class="hs-comment">-- See also Note [String literals in GHC] in CString.hs</span><span>
</span><span id="line-2482"></span><span>
</span><span id="line-2483"></span><span class="hs-comment">-- CString version</span><span>
</span><span id="line-2484"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit_C"><span class="hs-identifier hs-type">match_cstring_foldr_lit_C</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-2485"></span><span id="match_cstring_foldr_lit_C"><span class="annot"><span class="annottext">match_cstring_foldr_lit_C :: RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit_C"><span class="hs-identifier hs-var hs-var">match_cstring_foldr_lit_C</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit"><span class="hs-identifier hs-var">match_cstring_foldr_lit</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unpackCStringFoldrIdKey"><span class="hs-identifier hs-var">unpackCStringFoldrIdKey</span></a></span><span>
</span><span id="line-2486"></span><span>
</span><span id="line-2487"></span><span class="hs-comment">-- CStringUTF8 version</span><span>
</span><span id="line-2488"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit_utf8"><span class="hs-identifier hs-type">match_cstring_foldr_lit_utf8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-2489"></span><span id="match_cstring_foldr_lit_utf8"><span class="annot"><span class="annottext">match_cstring_foldr_lit_utf8 :: RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit_utf8"><span class="hs-identifier hs-var hs-var">match_cstring_foldr_lit_utf8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique -&gt; RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit"><span class="hs-identifier hs-var">match_cstring_foldr_lit</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unpackCStringFoldrUtf8IdKey"><span class="hs-identifier hs-var">unpackCStringFoldrUtf8IdKey</span></a></span><span>
</span><span id="line-2490"></span><span>
</span><span id="line-2491"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit"><span class="hs-pragma hs-type">match_cstring_foldr_lit</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-2492"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit"><span class="hs-identifier hs-type">match_cstring_foldr_lit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-2493"></span><span id="match_cstring_foldr_lit"><span class="annot"><span class="annottext">match_cstring_foldr_lit :: Unique -&gt; RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit"><span class="hs-identifier hs-var hs-var">match_cstring_foldr_lit</span></a></span></span><span> </span><span id="local-6989586621682932366"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932366"><span class="hs-identifier hs-var">foldVariant</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682932367"><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932367"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-2494"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682932368"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932368"><span class="hs-identifier hs-var">ty1</span></a></span></span><span>
</span><span id="line-2495"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932369"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932369"><span class="hs-identifier hs-var">lit1</span></a></span></span><span>
</span><span id="line-2496"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932370"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932370"><span class="hs-identifier hs-var">c1</span></a></span></span><span>
</span><span id="line-2497"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932371"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932371"><span class="hs-identifier hs-var">e2</span></a></span></span><span>
</span><span id="line-2498"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-2499"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932372"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932372"><span class="hs-identifier hs-var">strTicks</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932373"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932373"><span class="hs-identifier hs-var">unpk</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682932374"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932374"><span class="hs-identifier hs-var">ty2</span></a></span></span><span>
</span><span id="line-2500"></span><span>                        </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932375"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932375"><span class="hs-identifier hs-var">lit2</span></a></span></span><span>
</span><span id="line-2501"></span><span>                        </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932376"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932376"><span class="hs-identifier hs-var">c2</span></a></span></span><span>
</span><span id="line-2502"></span><span>                        </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932377"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932377"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicks"><span class="hs-identifier hs-var">stripStrTopTicks</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932367"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932371"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-2503"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932373"><span class="hs-identifier hs-var">unpk</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; Unique -&gt; Bool
forall a. Uniquable a =&gt; a -&gt; Unique -&gt; Bool
</span><a href="GHC.Types.Unique.html#hasKey"><span class="hs-operator hs-var">`hasKey`</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932366"><span class="hs-identifier hs-var">foldVariant</span></a></span><span>
</span><span id="line-2504"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932378"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932378"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932367"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932369"><span class="hs-identifier hs-var">lit1</span></a></span><span>
</span><span id="line-2505"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932379"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932379"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932367"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932375"><span class="hs-identifier hs-var">lit2</span></a></span><span>
</span><span id="line-2506"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
</span><a href="GHC.Core.Map.Expr.html#eqCoreExpr"><span class="hs-identifier hs-var">eqCoreExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932370"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932376"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-2507"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932380"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932380"><span class="hs-identifier hs-var">c1Ticks</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932381"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932381"><span class="hs-identifier hs-var">c1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicks"><span class="hs-identifier hs-var">stripStrTopTicks</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932367"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932370"><span class="hs-identifier hs-var">c1</span></a></span><span>
</span><span id="line-2508"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932382"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932382"><span class="hs-identifier hs-var">c2Ticks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreTickish]
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicksT"><span class="hs-identifier hs-var">stripStrTopTicksT</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932376"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-2509"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe CoreExpr -&gt; Maybe CoreExpr
forall a. HasCallStack =&gt; Bool -&gt; a -&gt; a
</span><a href="GHC.Utils.Panic.Plain.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932368"><span class="hs-identifier hs-var">ty1</span></a></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Type -&gt; Type -&gt; Bool
Type -&gt; Type -&gt; Bool
</span><a href="GHC.Core.TyCo.Compare.html#eqType"><span class="hs-operator hs-var">`eqType`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932374"><span class="hs-identifier hs-var">ty2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe CoreExpr -&gt; Maybe CoreExpr)
-&gt; Maybe CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-2510"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CoreTickish] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkTicks"><span class="hs-identifier hs-var">mkTicks</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932372"><span class="hs-identifier hs-var">strTicks</span></a></span><span>
</span><span id="line-2511"></span><span>         </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932373"><span class="hs-identifier hs-var">unpk</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; CoreExpr
forall b. Type -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932368"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-2512"></span><span>                    </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Literal
</span><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932378"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#append"><span class="hs-operator hs-var">`BS.append`</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932379"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2513"></span><span>                    </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreTickish] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkTicks"><span class="hs-identifier hs-var">mkTicks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932380"><span class="hs-identifier hs-var">c1Ticks</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreTickish] -&gt; [CoreTickish] -&gt; [CoreTickish]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932382"><span class="hs-identifier hs-var">c2Ticks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932381"><span class="hs-identifier hs-var">c1'</span></a></span><span>
</span><span id="line-2514"></span><span>                    </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932377"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-2515"></span><span>
</span><span id="line-2516"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_foldr_lit"><span class="hs-identifier hs-var">match_cstring_foldr_lit</span></a></span><span> </span><span class="annot"><span class="annottext">Unique
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2517"></span><span>
</span><span id="line-2518"></span><span>
</span><span id="line-2519"></span><span class="hs-comment">-- N.B. Ensure that we strip off any ticks (e.g. source notes) from the</span><span>
</span><span id="line-2520"></span><span class="hs-comment">-- argument, lest this may fail to fire when building with -g3. See #16740.</span><span>
</span><span id="line-2521"></span><span class="hs-comment">--</span><span>
</span><span id="line-2522"></span><span class="hs-comment">-- Also, look into variable's unfolding just in case the expression we look for</span><span>
</span><span id="line-2523"></span><span class="hs-comment">-- is in a top-level thunk.</span><span>
</span><span id="line-2524"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicks"><span class="hs-identifier hs-type">stripStrTopTicks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#InScopeEnv"><span class="hs-identifier hs-type">InScopeEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Tickish.html#CoreTickish"><span class="hs-identifier hs-type">CoreTickish</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2525"></span><span id="stripStrTopTicks"><span class="annot"><span class="annottext">stripStrTopTicks :: InScopeEnv -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicks"><span class="hs-identifier hs-var hs-var">stripStrTopTicks</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#ISE"><span class="hs-identifier hs-type">ISE</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682932385"><span class="annot"><span class="annottext">IdUnfoldingFun
</span><a href="#local-6989586621682932385"><span class="hs-identifier hs-var">id_unf</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682932386"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932386"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932386"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2526"></span><span>  </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932387"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932387"><span class="hs-identifier hs-var">v</span></a></span></span><span>
</span><span id="line-2527"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932388"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932388"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unfolding -&gt; Maybe CoreExpr
</span><a href="GHC.Core.html#expandUnfolding_maybe"><span class="hs-identifier hs-var">expandUnfolding_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdUnfoldingFun
</span><a href="#local-6989586621682932385"><span class="hs-identifier hs-var">id_unf</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932387"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2528"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CoreTickish -&gt; Bool) -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
forall b.
(CoreTickish -&gt; Bool) -&gt; Expr b -&gt; ([CoreTickish], Expr b)
</span><a href="GHC.Core.Utils.html#stripTicksTop"><span class="hs-identifier hs-var">stripTicksTop</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish -&gt; Bool
forall (pass :: TickishPass). GenTickish pass -&gt; Bool
</span><a href="GHC.Types.Tickish.html#tickishFloatable"><span class="hs-identifier hs-var">tickishFloatable</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932388"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-2529"></span><span>  </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CoreTickish -&gt; Bool) -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
forall b.
(CoreTickish -&gt; Bool) -&gt; Expr b -&gt; ([CoreTickish], Expr b)
</span><a href="GHC.Core.Utils.html#stripTicksTop"><span class="hs-identifier hs-var">stripTicksTop</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish -&gt; Bool
forall (pass :: TickishPass). GenTickish pass -&gt; Bool
</span><a href="GHC.Types.Tickish.html#tickishFloatable"><span class="hs-identifier hs-var">tickishFloatable</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932386"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2530"></span><span>
</span><span id="line-2531"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicksT"><span class="hs-identifier hs-type">stripStrTopTicksT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Types.Tickish.html#CoreTickish"><span class="hs-identifier hs-type">CoreTickish</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2532"></span><span id="stripStrTopTicksT"><span class="annot"><span class="annottext">stripStrTopTicksT :: CoreExpr -&gt; [CoreTickish]
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicksT"><span class="hs-identifier hs-var hs-var">stripStrTopTicksT</span></a></span></span><span> </span><span id="local-6989586621682932391"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932391"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreTickish -&gt; Bool) -&gt; CoreExpr -&gt; [CoreTickish]
forall b. (CoreTickish -&gt; Bool) -&gt; Expr b -&gt; [CoreTickish]
</span><a href="GHC.Core.Utils.html#stripTicksTopT"><span class="hs-identifier hs-var">stripTicksTopT</span></a></span><span> </span><span class="annot"><span class="annottext">CoreTickish -&gt; Bool
forall (pass :: TickishPass). GenTickish pass -&gt; Bool
</span><a href="GHC.Types.Tickish.html#tickishFloatable"><span class="hs-identifier hs-var">tickishFloatable</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932391"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2533"></span><span>
</span><span id="line-2534"></span><span class="hs-comment">---------------------------------------------------</span><span>
</span><span id="line-2535"></span><span class="hs-comment">-- The rule is this:</span><span>
</span><span id="line-2536"></span><span class="hs-comment">--      eqString (unpackCString# (Lit s1)) (unpackCString# (Lit s2)) = s1==s2</span><span>
</span><span id="line-2537"></span><span class="hs-comment">-- Also  matches unpackCStringUtf8#</span><span>
</span><span id="line-2538"></span><span>
</span><span id="line-2539"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_eq_string"><span class="hs-identifier hs-type">match_eq_string</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-2540"></span><span id="match_eq_string"><span class="annot"><span class="annottext">match_eq_string :: RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_eq_string"><span class="hs-identifier hs-var hs-var">match_eq_string</span></a></span></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682932392"><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932392"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682932393"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932393"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932394"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932394"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2541"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932395"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932395"><span class="hs-identifier hs-var">ticks1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932396"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932396"><span class="hs-identifier hs-var">unpk1</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932397"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932397"><span class="hs-identifier hs-var">lit1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicks"><span class="hs-identifier hs-var">stripStrTopTicks</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932392"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932393"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-2542"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932398"><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932398"><span class="hs-identifier hs-var">ticks2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932399"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932399"><span class="hs-identifier hs-var">unpk2</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932400"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932400"><span class="hs-identifier hs-var">lit2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; ([CoreTickish], CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#stripStrTopTicks"><span class="hs-identifier hs-var">stripStrTopTicks</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932392"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932394"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-2543"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932401"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932401"><span class="hs-identifier hs-var">unpk_key1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Unique
forall a. Uniquable a =&gt; a -&gt; Unique
</span><a href="GHC.Types.Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932396"><span class="hs-identifier hs-var">unpk1</span></a></span><span>
</span><span id="line-2544"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932403"><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932403"><span class="hs-identifier hs-var">unpk_key2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Unique
forall a. Uniquable a =&gt; a -&gt; Unique
</span><a href="GHC.Types.Unique.html#getUnique"><span class="hs-identifier hs-var">getUnique</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932399"><span class="hs-identifier hs-var">unpk2</span></a></span><span>
</span><span id="line-2545"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932401"><span class="hs-identifier hs-var">unpk_key1</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; Unique -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932403"><span class="hs-identifier hs-var">unpk_key2</span></a></span><span>
</span><span id="line-2546"></span><span>  </span><span class="hs-comment">-- For now we insist the literals have to agree in their encoding</span><span>
</span><span id="line-2547"></span><span>  </span><span class="hs-comment">-- to keep the rule simple. But we could check if the decoded strings</span><span>
</span><span id="line-2548"></span><span>  </span><span class="hs-comment">-- compare equal in here as well.</span><span>
</span><span id="line-2549"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="#local-6989586621682932401"><span class="hs-identifier hs-var">unpk_key1</span></a></span><span> </span><span class="annot"><span class="annottext">Unique -&gt; [Unique] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unpackCStringUtf8IdKey"><span class="hs-identifier hs-var">unpackCStringUtf8IdKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique
</span><a href="GHC.Builtin.Names.html#unpackCStringIdKey"><span class="hs-identifier hs-var">unpackCStringIdKey</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2550"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932405"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932405"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932392"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932397"><span class="hs-identifier hs-var">lit1</span></a></span><span>
</span><span id="line-2551"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932406"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932406"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932392"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932400"><span class="hs-identifier hs-var">lit2</span></a></span><span>
</span><span id="line-2552"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe CoreExpr) -&gt; CoreExpr -&gt; Maybe CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CoreTickish] -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Utils.html#mkTicks"><span class="hs-identifier hs-var">mkTicks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932395"><span class="hs-identifier hs-var">ticks1</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreTickish] -&gt; [CoreTickish] -&gt; [CoreTickish]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[CoreTickish]
</span><a href="#local-6989586621682932398"><span class="hs-identifier hs-var">ticks2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2553"></span><span>         </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr) -&gt; CoreExpr -&gt; CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932405"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932406"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#trueValBool"><span class="hs-identifier hs-var">trueValBool</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#falseValBool"><span class="hs-identifier hs-var">falseValBool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2554"></span><span>
</span><span id="line-2555"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_eq_string"><span class="hs-identifier hs-var">match_eq_string</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2556"></span><span>
</span><span id="line-2557"></span><span class="hs-comment">-----------------------------------------------------------------------</span><span>
</span><span id="line-2558"></span><span class="hs-comment">-- Illustration of this rule:</span><span>
</span><span id="line-2559"></span><span class="hs-comment">--</span><span>
</span><span id="line-2560"></span><span class="hs-comment">-- cstringLength# &quot;foobar&quot;# --&gt; 6</span><span>
</span><span id="line-2561"></span><span class="hs-comment">-- cstringLength# &quot;fizz\NULzz&quot;# --&gt; 4</span><span>
</span><span id="line-2562"></span><span class="hs-comment">--</span><span>
</span><span id="line-2563"></span><span class="hs-comment">-- Nota bene: Addr# literals are suffixed by a NUL byte when they are</span><span>
</span><span id="line-2564"></span><span class="hs-comment">-- compiled to read-only data sections. That's why cstringLength# is</span><span>
</span><span id="line-2565"></span><span class="hs-comment">-- well defined on Addr# literals that do not explicitly have an embedded</span><span>
</span><span id="line-2566"></span><span class="hs-comment">-- NUL byte.</span><span>
</span><span id="line-2567"></span><span class="hs-comment">--</span><span>
</span><span id="line-2568"></span><span class="hs-comment">-- See GHC issue #5218, MR 2165, and bytestring PR 191. This is particularly</span><span>
</span><span id="line-2569"></span><span class="hs-comment">-- helpful when using OverloadedStrings to create a ByteString since the</span><span>
</span><span id="line-2570"></span><span class="hs-comment">-- function computing the length of such ByteStrings can often be constant</span><span>
</span><span id="line-2571"></span><span class="hs-comment">-- folded.</span><span>
</span><span id="line-2572"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_length"><span class="hs-identifier hs-type">match_cstring_length</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#RuleFun"><span class="hs-identifier hs-type">RuleFun</span></a></span><span>
</span><span id="line-2573"></span><span id="match_cstring_length"><span class="annot"><span class="annottext">match_cstring_length :: RuleFun
</span><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_length"><span class="hs-identifier hs-var hs-var">match_cstring_length</span></a></span></span><span> </span><span id="local-6989586621682932407"><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682932407"><span class="hs-identifier hs-var">rule_env</span></a></span></span><span> </span><span id="local-6989586621682932408"><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932408"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621682932409"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932409"><span class="hs-identifier hs-var">lit1</span></a></span></span><span class="hs-special">]</span><span>
</span><span id="line-2574"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621682932410"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932410"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">InScopeEnv -&gt; CoreExpr -&gt; Maybe Literal
</span><a href="GHC.Core.SimpleOpt.html#exprIsLiteral_maybe"><span class="hs-identifier hs-var">exprIsLiteral_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><a href="#local-6989586621682932408"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932409"><span class="hs-identifier hs-var">lit1</span></a></span><span>
</span><span id="line-2575"></span><span>    </span><span class="hs-comment">-- If elemIndex returns Just, it has the index of the first embedded NUL</span><span>
</span><span id="line-2576"></span><span>    </span><span class="hs-comment">-- in the string. If no NUL bytes are present (the common case) then use</span><span>
</span><span id="line-2577"></span><span>    </span><span class="hs-comment">-- full length of the byte string.</span><span>
</span><span id="line-2578"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682932411"><span class="annot"><span class="annottext">len :: ConTagZ
</span><a href="#local-6989586621682932411"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; Maybe ConTagZ -&gt; ConTagZ
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ConTagZ
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#length"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932410"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; ByteString -&gt; Maybe ConTagZ
</span><a href="../../bytestring-0.12.2.0-7dd0/src/Data.ByteString.html#elemIndex"><span class="hs-identifier hs-var">BS.elemIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682932410"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2579"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleOpts -&gt; Platform
</span><a href="GHC.Core.Rules.Config.html#roPlatform"><span class="hs-identifier hs-var">roPlatform</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><a href="#local-6989586621682932407"><span class="hs-identifier hs-var">rule_env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConTagZ -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682932411"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2580"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_cstring_length"><span class="hs-identifier hs-var">match_cstring_length</span></a></span><span> </span><span class="annot"><span class="annottext">RuleOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InScopeEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Id
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2581"></span><span>
</span><span id="line-2582"></span><span class="hs-comment">{- Note [inlineId magic]
~~~~~~~~~~~~~~~~~~~~~~~~
The call 'inline f' arranges that 'f' is inlined, regardless of
its size. More precisely, the call 'inline f' rewrites to the
right-hand side of 'f's definition. This allows the programmer to
control inlining from a particular call site rather than the
definition site of the function.

The moving parts are simple:

* A very simple definition in the library base:GHC.Magic
     {-# NOINLINE[0] inline #-}
     inline :: a -&gt; a
     inline x = x
  So in phase 0, 'inline' will be inlined, so its use imposes
  no overhead.

* A rewrite rule, in GHC.Core.Opt.ConstantFold, which makes
  (inline f) inline, implemented by match_inline.
  The rule for the 'inline' function is this:
     inline f_ty (f a b c) = &lt;f's unfolding&gt; a b c
  (if f has an unfolding, EVEN if it's a loop breaker)

  Additionally the rule looks through ticks/casts as well (#24808):
      inline f_ty (f a b c |&gt; co) = &lt;f's unfolding&gt; a b c |&gt; co
      inline f_ty &lt;tick&gt; ( f a b c ) = &lt;tick&gt; &lt;f's unfolding&gt; a b c

  It's important to allow the argument to 'inline' to have args itself
  (a) because its more forgiving to allow the programmer to write
      either  inline f a b c
      or      inline (f a b c)
  (b) because a polymorphic f wll get a type argument that the
      programmer can't avoid, so the call may look like
        inline (map @Int @Bool) g xs

  Also, don't forget about 'inline's type argument!
-}</span><span>
</span><span id="line-2619"></span><span>
</span><span id="line-2620"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_inline"><span class="hs-identifier hs-type">match_inline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2621"></span><span id="match_inline"><span class="annot"><span class="annottext">match_inline :: [CoreExpr] -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#match_inline"><span class="hs-identifier hs-var hs-var">match_inline</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621682932414"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932414"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682932415"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932414"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2622"></span><span>  </span><span class="hs-comment">-- Maybe Monad ahead:</span><span>
</span><span id="line-2623"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2624"></span><span>    </span><span id="local-6989586621682932415"><span class="annot"><span class="annottext">go :: CoreExpr -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682932415"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932423"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932423"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- Ignore the IdUnfoldingFun here!</span><span>
</span><span id="line-2625"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unfolding -&gt; Maybe CoreExpr
</span><a href="GHC.Core.html#maybeUnfoldingTemplate"><span class="hs-identifier hs-var">maybeUnfoldingTemplate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IdUnfoldingFun
</span><a href="GHC.Types.Id.html#realIdUnfolding"><span class="hs-identifier hs-var">realIdUnfolding</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932423"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2626"></span><span>    </span><span class="annot"><a href="#local-6989586621682932415"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span id="local-6989586621682932426"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932426"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682932427"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932427"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682932428"><span class="annot"><a href="#local-6989586621682932428"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682932415"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932426"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932428"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932427"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2627"></span><span>    </span><span class="hs-comment">-- inline (f |&gt; co)</span><span>
</span><span id="line-2628"></span><span>    </span><span class="annot"><a href="#local-6989586621682932415"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Cast"><span class="hs-identifier hs-type">Cast</span></a></span><span> </span><span id="local-6989586621682932430"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932430"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621682932431"><span class="annot"><span class="annottext">CoercionR
</span><a href="#local-6989586621682932431"><span class="hs-identifier hs-var">co</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682932432"><span class="annot"><a href="#local-6989586621682932432"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682932415"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932430"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Cast"><span class="hs-identifier hs-type">Cast</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932432"><span class="hs-identifier hs-type">app</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932431"><span class="hs-identifier hs-type">co</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2629"></span><span>    </span><span class="hs-comment">-- inline (&lt;tick&gt; f)</span><span>
</span><span id="line-2630"></span><span>    </span><span class="annot"><a href="#local-6989586621682932415"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Tick"><span class="hs-identifier hs-type">Tick</span></a></span><span> </span><span id="local-6989586621682932434"><span class="annot"><span class="annottext">CoreTickish
</span><a href="#local-6989586621682932434"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621682932435"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932435"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682932436"><span class="annot"><a href="#local-6989586621682932436"><span class="hs-identifier hs-var">app</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
</span><a href="#local-6989586621682932415"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932435"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Tick"><span class="hs-identifier hs-type">Tick</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932434"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932436"><span class="hs-identifier hs-type">app</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2631"></span><span>    </span><span class="annot"><a href="#local-6989586621682932415"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2632"></span><span>
</span><span id="line-2633"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#match_inline"><span class="hs-identifier hs-var">match_inline</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2634"></span><span>
</span><span id="line-2635"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-2636"></span><span class="hs-comment">-- Note [Constant folding through nested expressions]</span><span>
</span><span id="line-2637"></span><span class="hs-comment">-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><span>
</span><span id="line-2638"></span><span class="hs-comment">--</span><span>
</span><span id="line-2639"></span><span class="hs-comment">-- We use rewrites rules to perform constant folding. It means that we don't</span><span>
</span><span id="line-2640"></span><span class="hs-comment">-- have a global view of the expression we are trying to optimise. As a</span><span>
</span><span id="line-2641"></span><span class="hs-comment">-- consequence we only perform local (small-step) transformations that either:</span><span>
</span><span id="line-2642"></span><span class="hs-comment">--    1) reduce the number of operations</span><span>
</span><span id="line-2643"></span><span class="hs-comment">--    2) rearrange the expression to increase the odds that other rules will</span><span>
</span><span id="line-2644"></span><span class="hs-comment">--    match</span><span>
</span><span id="line-2645"></span><span class="hs-comment">--</span><span>
</span><span id="line-2646"></span><span class="hs-comment">-- We don't try to handle more complex expression optimisation cases that would</span><span>
</span><span id="line-2647"></span><span class="hs-comment">-- require a global view. For example, rewriting expressions to increase</span><span>
</span><span id="line-2648"></span><span class="hs-comment">-- sharing (e.g., Horner's method); optimisations that require local</span><span>
</span><span id="line-2649"></span><span class="hs-comment">-- transformations increasing the number of operations; rearrangements to</span><span>
</span><span id="line-2650"></span><span class="hs-comment">-- cancel/factorize terms (e.g., (a+b-a-b) isn't rearranged to reduce to 0).</span><span>
</span><span id="line-2651"></span><span class="hs-comment">--</span><span>
</span><span id="line-2652"></span><span class="hs-comment">-- We already have rules to perform constant folding on expressions with the</span><span>
</span><span id="line-2653"></span><span class="hs-comment">-- following shape (where a and/or b are literals):</span><span>
</span><span id="line-2654"></span><span class="hs-comment">--</span><span>
</span><span id="line-2655"></span><span class="hs-comment">--          D)    op</span><span>
</span><span id="line-2656"></span><span class="hs-comment">--                /\</span><span>
</span><span id="line-2657"></span><span class="hs-comment">--               /  \</span><span>
</span><span id="line-2658"></span><span class="hs-comment">--              /    \</span><span>
</span><span id="line-2659"></span><span class="hs-comment">--             a      b</span><span>
</span><span id="line-2660"></span><span class="hs-comment">--</span><span>
</span><span id="line-2661"></span><span class="hs-comment">-- To support nested expressions, we match three other shapes of expression</span><span>
</span><span id="line-2662"></span><span class="hs-comment">-- trees:</span><span>
</span><span id="line-2663"></span><span class="hs-comment">--</span><span>
</span><span id="line-2664"></span><span class="hs-comment">-- A)   op1          B)       op1       C)       op1</span><span>
</span><span id="line-2665"></span><span class="hs-comment">--      /\                    /\                 /\</span><span>
</span><span id="line-2666"></span><span class="hs-comment">--     /  \                  /  \               /  \</span><span>
</span><span id="line-2667"></span><span class="hs-comment">--    /    \                /    \             /    \</span><span>
</span><span id="line-2668"></span><span class="hs-comment">--   a     op2            op2     c          op2    op3</span><span>
</span><span id="line-2669"></span><span class="hs-comment">--          /\            /\                 /\      /\</span><span>
</span><span id="line-2670"></span><span class="hs-comment">--         /  \          /  \               /  \    /  \</span><span>
</span><span id="line-2671"></span><span class="hs-comment">--        b    c        a    b             a    b  c    d</span><span>
</span><span id="line-2672"></span><span class="hs-comment">--</span><span>
</span><span id="line-2673"></span><span class="hs-comment">--</span><span>
</span><span id="line-2674"></span><span class="hs-comment">-- R1) +/- simplification:</span><span>
</span><span id="line-2675"></span><span class="hs-comment">--    ops = + or -, two literals (not siblings)</span><span>
</span><span id="line-2676"></span><span class="hs-comment">--</span><span>
</span><span id="line-2677"></span><span class="hs-comment">--    Examples:</span><span>
</span><span id="line-2678"></span><span class="hs-comment">--       A: 5 + (10-x)  ==&gt; 15-x</span><span>
</span><span id="line-2679"></span><span class="hs-comment">--       B: (10+x) + 5  ==&gt; 15+x</span><span>
</span><span id="line-2680"></span><span class="hs-comment">--       C: (5+a)-(5-b) ==&gt; 0+(a+b)</span><span>
</span><span id="line-2681"></span><span class="hs-comment">--</span><span>
</span><span id="line-2682"></span><span class="hs-comment">-- R2) *, `and`, `or`  simplification</span><span>
</span><span id="line-2683"></span><span class="hs-comment">--    ops = *, `and`, `or` two literals (not siblings)</span><span>
</span><span id="line-2684"></span><span class="hs-comment">--</span><span>
</span><span id="line-2685"></span><span class="hs-comment">--    Examples:</span><span>
</span><span id="line-2686"></span><span class="hs-comment">--       A: 5 * (10*x)  ==&gt; 50*x</span><span>
</span><span id="line-2687"></span><span class="hs-comment">--       B: (10*x) * 5  ==&gt; 50*x</span><span>
</span><span id="line-2688"></span><span class="hs-comment">--       C: (5*a)*(5*b) ==&gt; 25*(a*b)</span><span>
</span><span id="line-2689"></span><span class="hs-comment">--</span><span>
</span><span id="line-2690"></span><span class="hs-comment">-- R3) * distribution over +/-</span><span>
</span><span id="line-2691"></span><span class="hs-comment">--    op1 = *, op2 = + or -, two literals (not siblings)</span><span>
</span><span id="line-2692"></span><span class="hs-comment">--</span><span>
</span><span id="line-2693"></span><span class="hs-comment">--    This transformation doesn't reduce the number of operations but switches</span><span>
</span><span id="line-2694"></span><span class="hs-comment">--    the outer and the inner operations so that the outer is (+) or (-) instead</span><span>
</span><span id="line-2695"></span><span class="hs-comment">--    of (*). It increases the odds that other rules will match after this one.</span><span>
</span><span id="line-2696"></span><span class="hs-comment">--</span><span>
</span><span id="line-2697"></span><span class="hs-comment">--    Examples:</span><span>
</span><span id="line-2698"></span><span class="hs-comment">--       A: 5 * (10-x)  ==&gt; 50 - (5*x)</span><span>
</span><span id="line-2699"></span><span class="hs-comment">--       B: (10+x) * 5  ==&gt; 50 + (5*x)</span><span>
</span><span id="line-2700"></span><span class="hs-comment">--       C: Not supported as it would increase the number of operations:</span><span>
</span><span id="line-2701"></span><span class="hs-comment">--          (5+a)*(5-b) ==&gt; 25 - 5*b + 5*a - a*b</span><span>
</span><span id="line-2702"></span><span class="hs-comment">--</span><span>
</span><span id="line-2703"></span><span class="hs-comment">-- R4) Simple factorization</span><span>
</span><span id="line-2704"></span><span class="hs-comment">--</span><span>
</span><span id="line-2705"></span><span class="hs-comment">--    op1 = + or -, op2/op3 = *,</span><span>
</span><span id="line-2706"></span><span class="hs-comment">--    one literal for each innermost * operation (except in the D case),</span><span>
</span><span id="line-2707"></span><span class="hs-comment">--    the two other terms are equals</span><span>
</span><span id="line-2708"></span><span class="hs-comment">--</span><span>
</span><span id="line-2709"></span><span class="hs-comment">--    Examples:</span><span>
</span><span id="line-2710"></span><span class="hs-comment">--       A: x - (10*x)  ==&gt; (-9)*x</span><span>
</span><span id="line-2711"></span><span class="hs-comment">--       B: (10*x) + x  ==&gt; 11*x</span><span>
</span><span id="line-2712"></span><span class="hs-comment">--       C: (5*x)-(x*3) ==&gt; 2*x</span><span>
</span><span id="line-2713"></span><span class="hs-comment">--       D: x+x         ==&gt; 2*x</span><span>
</span><span id="line-2714"></span><span class="hs-comment">--</span><span>
</span><span id="line-2715"></span><span class="hs-comment">-- R5) +/- propagation</span><span>
</span><span id="line-2716"></span><span class="hs-comment">--</span><span>
</span><span id="line-2717"></span><span class="hs-comment">--    ops = + or -, one literal</span><span>
</span><span id="line-2718"></span><span class="hs-comment">--</span><span>
</span><span id="line-2719"></span><span class="hs-comment">--    This transformation doesn't reduce the number of operations but propagates</span><span>
</span><span id="line-2720"></span><span class="hs-comment">--    the constant to the outer level. It increases the odds that other rules</span><span>
</span><span id="line-2721"></span><span class="hs-comment">--    will match after this one.</span><span>
</span><span id="line-2722"></span><span class="hs-comment">--</span><span>
</span><span id="line-2723"></span><span class="hs-comment">--    Examples:</span><span>
</span><span id="line-2724"></span><span class="hs-comment">--       A: x - (10-y)  ==&gt; (x+y) - 10</span><span>
</span><span id="line-2725"></span><span class="hs-comment">--       B: (10+x) - y  ==&gt; 10 + (x-y)</span><span>
</span><span id="line-2726"></span><span class="hs-comment">--       C: N/A (caught by the A and B cases)</span><span>
</span><span id="line-2727"></span><span class="hs-comment">--</span><span>
</span><span id="line-2728"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-2729"></span><span>
</span><span id="line-2730"></span><span class="hs-comment">-- Rules to perform constant folding into nested expressions</span><span>
</span><span id="line-2731"></span><span class="hs-comment">--</span><span>
</span><span id="line-2732"></span><span class="hs-comment">--See Note [Constant folding through nested expressions]</span><span>
</span><span id="line-2733"></span><span>
</span><span id="line-2734"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-type">addFoldingRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2735"></span><span id="addFoldingRules"><span class="annot"><span class="annottext">addFoldingRules :: PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules"><span class="hs-identifier hs-var hs-var">addFoldingRules</span></a></span></span><span> </span><span id="local-6989586621682932437"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932437"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682932438"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932438"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2736"></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; RuleM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932437"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932438"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2737"></span><span>   </span><span id="local-6989586621682932440"><span class="annot"><a href="#local-6989586621682932440"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-2738"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#roNumConstantFolding"><span class="hs-identifier hs-var">roNumConstantFolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932440"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2739"></span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682932442"><span class="annot"><a href="#local-6989586621682932442"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932443"><span class="annot"><a href="#local-6989586621682932443"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2740"></span><span>   </span><span id="local-6989586621682932444"><span class="annot"><a href="#local-6989586621682932444"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2741"></span><span>   </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span>
</span><span id="line-2742"></span><span>      </span><span class="hs-comment">-- commutativity for + is handled here</span><span>
</span><span id="line-2743"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules%27"><span class="hs-identifier hs-type">addFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932444"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932442"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932443"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932438"><span class="hs-identifier hs-type">num_ops</span></a></span><span>
</span><span id="line-2744"></span><span>       </span><span class="annot"><span class="hs-operator hs-type">&lt;|&gt;</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules%27"><span class="hs-identifier hs-type">addFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932444"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932443"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932442"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932438"><span class="hs-identifier hs-type">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2745"></span><span>
</span><span id="line-2746"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-type">subFoldingRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2747"></span><span id="subFoldingRules"><span class="annot"><span class="annottext">subFoldingRules :: PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules"><span class="hs-identifier hs-var hs-var">subFoldingRules</span></a></span></span><span> </span><span id="local-6989586621682932446"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932446"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682932447"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932447"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2748"></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; RuleM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932446"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932447"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2749"></span><span>   </span><span id="local-6989586621682932449"><span class="annot"><a href="#local-6989586621682932449"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-2750"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#roNumConstantFolding"><span class="hs-identifier hs-var">roNumConstantFolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932449"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2751"></span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682932450"><span class="annot"><a href="#local-6989586621682932450"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932451"><span class="annot"><a href="#local-6989586621682932451"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2752"></span><span>   </span><span id="local-6989586621682932452"><span class="annot"><a href="#local-6989586621682932452"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2753"></span><span>   </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules%27"><span class="hs-identifier hs-type">subFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932452"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932450"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932451"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932447"><span class="hs-identifier hs-type">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2754"></span><span>
</span><span id="line-2755"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-type">mulFoldingRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2756"></span><span id="mulFoldingRules"><span class="annot"><span class="annottext">mulFoldingRules :: PrimOp -&gt; NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules"><span class="hs-identifier hs-var hs-var">mulFoldingRules</span></a></span></span><span> </span><span id="local-6989586621682932454"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932454"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682932455"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932455"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2757"></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; RuleM ()
forall (m :: * -&gt; *). (HasCallStack, Applicative m) =&gt; Bool -&gt; m ()
</span><a href="GHC.Utils.Panic.Plain.html#massert"><span class="hs-identifier hs-var">massert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932454"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932455"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2758"></span><span>   </span><span id="local-6989586621682932457"><span class="annot"><a href="#local-6989586621682932457"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-2759"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#roNumConstantFolding"><span class="hs-identifier hs-var">roNumConstantFolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932457"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2760"></span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682932458"><span class="annot"><a href="#local-6989586621682932458"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932459"><span class="annot"><a href="#local-6989586621682932459"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2761"></span><span>   </span><span id="local-6989586621682932460"><span class="annot"><a href="#local-6989586621682932460"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2762"></span><span>   </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span>
</span><span id="line-2763"></span><span>      </span><span class="hs-comment">-- commutativity for * is handled here</span><span>
</span><span id="line-2764"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules%27"><span class="hs-identifier hs-type">mulFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932460"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932458"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932459"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932455"><span class="hs-identifier hs-type">num_ops</span></a></span><span>
</span><span id="line-2765"></span><span>       </span><span class="annot"><span class="hs-operator hs-type">&lt;|&gt;</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules%27"><span class="hs-identifier hs-type">mulFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932460"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932459"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932458"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932455"><span class="hs-identifier hs-type">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2766"></span><span>
</span><span id="line-2767"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules"><span class="hs-identifier hs-type">andFoldingRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2768"></span><span id="andFoldingRules"><span class="annot"><span class="annottext">andFoldingRules :: NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules"><span class="hs-identifier hs-var hs-var">andFoldingRules</span></a></span></span><span> </span><span id="local-6989586621682932462"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932462"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2769"></span><span>   </span><span id="local-6989586621682932463"><span class="annot"><a href="#local-6989586621682932463"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-2770"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#roNumConstantFolding"><span class="hs-identifier hs-var">roNumConstantFolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932463"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2771"></span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682932464"><span class="annot"><a href="#local-6989586621682932464"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932465"><span class="annot"><a href="#local-6989586621682932465"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2772"></span><span>   </span><span id="local-6989586621682932466"><span class="annot"><a href="#local-6989586621682932466"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2773"></span><span>   </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span>
</span><span id="line-2774"></span><span>      </span><span class="hs-comment">-- commutativity for `and` is handled here</span><span>
</span><span id="line-2775"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules%27"><span class="hs-identifier hs-type">andFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932466"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932464"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932465"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932462"><span class="hs-identifier hs-type">num_ops</span></a></span><span>
</span><span id="line-2776"></span><span>       </span><span class="annot"><span class="hs-operator hs-type">&lt;|&gt;</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules%27"><span class="hs-identifier hs-type">andFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932466"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932465"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932464"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932462"><span class="hs-identifier hs-type">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2777"></span><span>
</span><span id="line-2778"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules"><span class="hs-identifier hs-type">orFoldingRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2779"></span><span id="orFoldingRules"><span class="annot"><span class="annottext">orFoldingRules :: NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules"><span class="hs-identifier hs-var hs-var">orFoldingRules</span></a></span></span><span> </span><span id="local-6989586621682932468"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932468"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2780"></span><span>   </span><span id="local-6989586621682932469"><span class="annot"><a href="#local-6989586621682932469"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-2781"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#roNumConstantFolding"><span class="hs-identifier hs-var">roNumConstantFolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932469"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2782"></span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682932470"><span class="annot"><a href="#local-6989586621682932470"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932471"><span class="annot"><a href="#local-6989586621682932471"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2783"></span><span>   </span><span id="local-6989586621682932472"><span class="annot"><a href="#local-6989586621682932472"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2784"></span><span>   </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span>
</span><span id="line-2785"></span><span>      </span><span class="hs-comment">-- commutativity for `or` is handled here</span><span>
</span><span id="line-2786"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules%27"><span class="hs-identifier hs-type">orFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932472"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932470"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932471"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932468"><span class="hs-identifier hs-type">num_ops</span></a></span><span>
</span><span id="line-2787"></span><span>       </span><span class="annot"><span class="hs-operator hs-type">&lt;|&gt;</span></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules%27"><span class="hs-identifier hs-type">orFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932472"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932471"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932470"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932468"><span class="hs-identifier hs-type">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2788"></span><span>
</span><span id="line-2789"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-type">quotFoldingRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#RuleM"><span class="hs-identifier hs-type">RuleM</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2790"></span><span id="quotFoldingRules"><span class="annot"><span class="annottext">quotFoldingRules :: NumOps -&gt; RuleM CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules"><span class="hs-identifier hs-var hs-var">quotFoldingRules</span></a></span></span><span> </span><span id="local-6989586621682932474"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932474"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2791"></span><span>   </span><span id="local-6989586621682932475"><span class="annot"><a href="#local-6989586621682932475"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RuleM RuleOpts
</span><a href="GHC.Core.Opt.ConstantFold.html#getRuleOpts"><span class="hs-identifier hs-var">getRuleOpts</span></a></span><span>
</span><span id="line-2792"></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Rules.Config.html#roNumConstantFolding"><span class="hs-identifier hs-var">roNumConstantFolding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932475"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2793"></span><span>   </span><span class="hs-special">[</span><span id="local-6989586621682932476"><span class="annot"><a href="#local-6989586621682932476"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932477"><span class="annot"><a href="#local-6989586621682932477"><span class="hs-identifier hs-var">arg2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getArgs"><span class="hs-identifier hs-type">getArgs</span></a></span><span>
</span><span id="line-2794"></span><span>   </span><span id="local-6989586621682932478"><span class="annot"><a href="#local-6989586621682932478"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#getPlatform"><span class="hs-identifier hs-type">getPlatform</span></a></span><span>
</span><span id="line-2795"></span><span>   </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#liftMaybe"><span class="hs-identifier hs-type">liftMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules%27"><span class="hs-identifier hs-type">quotFoldingRules'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932478"><span class="hs-identifier hs-type">platform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932476"><span class="hs-identifier hs-type">arg1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932477"><span class="hs-identifier hs-type">arg2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932474"><span class="hs-identifier hs-type">num_ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2796"></span><span>
</span><span id="line-2797"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules%27"><span class="hs-identifier hs-type">addFoldingRules'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2798"></span><span id="addFoldingRules%27"><span class="annot"><span class="annottext">addFoldingRules' :: Platform -&gt; CoreExpr -&gt; CoreExpr -&gt; NumOps -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#addFoldingRules%27"><span class="hs-identifier hs-var hs-var">addFoldingRules'</span></a></span></span><span> </span><span id="local-6989586621682932480"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932480"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932481"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932481"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span id="local-6989586621682932482"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932482"><span class="hs-identifier hs-var">arg2</span></a></span></span><span> </span><span id="local-6989586621682932483"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932481"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932482"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2799"></span><span>
</span><span id="line-2800"></span><span>      </span><span class="hs-comment">-- x + (-y) ==&gt; x-y</span><span>
</span><span id="line-2801"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682932484"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932484"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#is_neg"><span class="hs-identifier hs-var">is_neg</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932486"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932486"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2802"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932484"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932487"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932486"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2803"></span><span>
</span><span id="line-2804"></span><span>      </span><span class="hs-comment">-- R1) +/- simplification</span><span>
</span><span id="line-2805"></span><span>
</span><span id="line-2806"></span><span>      </span><span class="hs-comment">-- l1 + (l2 + x) ==&gt; (l1+l2) + x</span><span>
</span><span id="line-2807"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932489"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932489"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932491"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932491"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932492"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932492"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2808"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932489"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932491"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932492"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2809"></span><span>
</span><span id="line-2810"></span><span>      </span><span class="hs-comment">-- l1 + (l2 - x) ==&gt; (l1+l2) - x</span><span>
</span><span id="line-2811"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932495"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932495"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932497"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932497"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932498"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932498"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2812"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932495"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932497"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932487"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932498"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2813"></span><span>
</span><span id="line-2814"></span><span>      </span><span class="hs-comment">-- l1 + (x - l2) ==&gt; (l1-l2) + x</span><span>
</span><span id="line-2815"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932499"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932499"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932500"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932500"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932501"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932501"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2816"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932499"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932501"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932500"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2817"></span><span>
</span><span id="line-2818"></span><span>      </span><span class="hs-comment">-- (l1 + x) + (l2 + y) ==&gt; (l1+l2) + (x+y)</span><span>
</span><span id="line-2819"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932502"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932502"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932503"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932503"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932504"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932504"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932505"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932505"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2820"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932502"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932504"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932503"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932505"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2821"></span><span>
</span><span id="line-2822"></span><span>      </span><span class="hs-comment">-- (l1 + x) + (l2 - y) ==&gt; (l1+l2) + (x-y)</span><span>
</span><span id="line-2823"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932506"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932506"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932507"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932507"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932508"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932508"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932509"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932509"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2824"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932506"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932508"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932507"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932487"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932509"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2825"></span><span>
</span><span id="line-2826"></span><span>      </span><span class="hs-comment">-- (l1 + x) + (y - l2) ==&gt; (l1-l2) + (x+y)</span><span>
</span><span id="line-2827"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932510"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932510"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932511"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932511"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932512"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932512"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932513"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932513"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2828"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932510"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932513"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932511"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932512"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2829"></span><span>
</span><span id="line-2830"></span><span>      </span><span class="hs-comment">-- (l1 - x) + (l2 - y) ==&gt; (l1+l2) - (x+y)</span><span>
</span><span id="line-2831"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932514"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932514"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932515"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932515"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932516"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932516"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932517"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932517"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2832"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932514"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932516"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932487"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932515"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932517"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2833"></span><span>
</span><span id="line-2834"></span><span>      </span><span class="hs-comment">-- (l1 - x) + (y - l2) ==&gt; (l1-l2) + (y-x)</span><span>
</span><span id="line-2835"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932518"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932518"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932519"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932519"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932520"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932520"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932521"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932521"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2836"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932518"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932521"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932520"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932487"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932519"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2837"></span><span>
</span><span id="line-2838"></span><span>      </span><span class="hs-comment">-- (x - l1) + (y - l2) ==&gt; (0-l1-l2) + (x+y)</span><span>
</span><span id="line-2839"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932522"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932522"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932523"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932523"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932524"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932524"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932525"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932525"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2840"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932523"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932525"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932522"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932524"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2841"></span><span>
</span><span id="line-2842"></span><span>      </span><span class="hs-comment">-- R4) Simple factorization</span><span>
</span><span id="line-2843"></span><span>
</span><span id="line-2844"></span><span>      </span><span class="hs-comment">-- x + x ==&gt; 2 * x</span><span>
</span><span id="line-2845"></span><span>      </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932526"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932526"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; CoreExpr -&gt; Maybe Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#is_expr_mul"><span class="hs-identifier hs-var">is_expr_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932481"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932482"><span class="hs-identifier hs-var">arg2</span></a></span><span>
</span><span id="line-2846"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932526"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932528"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932481"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2847"></span><span>
</span><span id="line-2848"></span><span>      </span><span class="hs-comment">-- (l1 * x) + x ==&gt; (l1+1) * x</span><span>
</span><span id="line-2849"></span><span>      </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932529"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932529"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; CoreExpr -&gt; Maybe Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#is_expr_mul"><span class="hs-identifier hs-var">is_expr_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932482"><span class="hs-identifier hs-var">arg2</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932481"><span class="hs-identifier hs-var">arg1</span></a></span><span>
</span><span id="line-2850"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932529"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932528"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932482"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2851"></span><span>
</span><span id="line-2852"></span><span>      </span><span class="hs-comment">-- (l1 * x) + (l2 * x) ==&gt; (l1+l2) * x</span><span>
</span><span id="line-2853"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_mul"><span class="hs-identifier hs-var">is_lit_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932531"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932531"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932532"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932532"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; CoreExpr -&gt; Maybe Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#is_expr_mul"><span class="hs-identifier hs-var">is_expr_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932532"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932533"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932533"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2854"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932531"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932533"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932528"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932532"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2855"></span><span>
</span><span id="line-2856"></span><span>      </span><span class="hs-comment">-- R5) +/- propagation: these transformations push literals outwards</span><span>
</span><span id="line-2857"></span><span>      </span><span class="hs-comment">-- with the hope that other rules can then be applied.</span><span>
</span><span id="line-2858"></span><span>
</span><span id="line-2859"></span><span>      </span><span class="hs-comment">-- In the following rules, x can't be a literal otherwise another</span><span>
</span><span id="line-2860"></span><span>      </span><span class="hs-comment">-- rule would have combined it with the other literal in arg2. So we</span><span>
</span><span id="line-2861"></span><span>      </span><span class="hs-comment">-- don't have to check this to avoid loops here.</span><span>
</span><span id="line-2862"></span><span>
</span><span id="line-2863"></span><span>      </span><span class="hs-comment">-- x + (l1 + y) ==&gt; l1 + (x + y)</span><span>
</span><span id="line-2864"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932534"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932534"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932535"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932535"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2865"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932534"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932481"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932535"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2866"></span><span>
</span><span id="line-2867"></span><span>      </span><span class="hs-comment">-- x + (l1 - y) ==&gt; l1 + (x - y)</span><span>
</span><span id="line-2868"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932536"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932536"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932537"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932537"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2869"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932536"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932481"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932487"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932537"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2870"></span><span>
</span><span id="line-2871"></span><span>      </span><span class="hs-comment">-- x + (y - l1) ==&gt; (x + y) - l1</span><span>
</span><span id="line-2872"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932538"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932538"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932539"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932539"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2873"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932481"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932538"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932487"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932539"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2874"></span><span>
</span><span id="line-2875"></span><span>      </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2876"></span><span>
</span><span id="line-2877"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-2878"></span><span>      </span><span id="local-6989586621682932493"><span class="annot"><span class="annottext">mkL :: Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932493"><span class="hs-identifier hs-var hs-var">mkL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr)
-&gt; (Integer -&gt; Literal) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; NumOps -&gt; Integer -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteral"><span class="hs-identifier hs-var">mkNumLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932480"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span>
</span><span id="line-2879"></span><span>      </span><span id="local-6989586621682932494"><span class="annot"><span class="annottext">add :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932494"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621682932541"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932541"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932542"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932542"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932541"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932542"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2880"></span><span>      </span><span id="local-6989586621682932487"><span class="annot"><span class="annottext">sub :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932487"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621682932544"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932544"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932545"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932545"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932544"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932545"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2881"></span><span>      </span><span id="local-6989586621682932528"><span class="annot"><span class="annottext">mul :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932528"><span class="hs-identifier hs-var hs-var">mul</span></a></span></span><span> </span><span id="local-6989586621682932546"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932546"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932547"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932547"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932546"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932483"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932547"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-2882"></span><span>
</span><span id="line-2883"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules%27"><span class="hs-identifier hs-type">subFoldingRules'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-2884"></span><span id="subFoldingRules%27"><span class="annot"><span class="annottext">subFoldingRules' :: Platform -&gt; CoreExpr -&gt; CoreExpr -&gt; NumOps -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#subFoldingRules%27"><span class="hs-identifier hs-var hs-var">subFoldingRules'</span></a></span></span><span> </span><span id="local-6989586621682932548"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932548"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932549"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932549"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span id="local-6989586621682932550"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932550"><span class="hs-identifier hs-var">arg2</span></a></span></span><span> </span><span id="local-6989586621682932551"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932549"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932550"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2885"></span><span>      </span><span class="hs-comment">-- x - (-y) ==&gt; x+y</span><span>
</span><span id="line-2886"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682932552"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932552"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#is_neg"><span class="hs-identifier hs-var">is_neg</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932553"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932553"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2887"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932552"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932553"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2888"></span><span>
</span><span id="line-2889"></span><span>      </span><span class="hs-comment">-- R1) +/- simplification</span><span>
</span><span id="line-2890"></span><span>
</span><span id="line-2891"></span><span>      </span><span class="hs-comment">-- l1 - (l2 + x) ==&gt; (l1-l2) - x</span><span>
</span><span id="line-2892"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932555"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932555"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932556"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932556"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932557"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932557"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2893"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932555"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932556"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932557"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2894"></span><span>
</span><span id="line-2895"></span><span>      </span><span class="hs-comment">-- l1 - (l2 - x) ==&gt; (l1-l2) + x</span><span>
</span><span id="line-2896"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932560"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932560"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932561"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932561"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932562"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932562"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2897"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932560"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932561"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932562"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2898"></span><span>
</span><span id="line-2899"></span><span>      </span><span class="hs-comment">-- l1 - (x - l2) ==&gt; (l1+l2) - x</span><span>
</span><span id="line-2900"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932563"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932563"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932564"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932564"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932565"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932565"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2901"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932563"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932565"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932564"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2902"></span><span>
</span><span id="line-2903"></span><span>      </span><span class="hs-comment">-- (l1 + x) - l2 ==&gt; (l1-l2) + x</span><span>
</span><span id="line-2904"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932566"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932566"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932567"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932567"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932568"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932568"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2905"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932566"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932568"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932567"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2906"></span><span>
</span><span id="line-2907"></span><span>      </span><span class="hs-comment">-- (l1 - x) - l2 ==&gt; (l1-l2) - x</span><span>
</span><span id="line-2908"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932569"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932569"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932570"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932570"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932571"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932571"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2909"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932569"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932571"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932570"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2910"></span><span>
</span><span id="line-2911"></span><span>      </span><span class="hs-comment">-- (x - l1) - l2 ==&gt; x - (l1+l2)</span><span>
</span><span id="line-2912"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932572"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932572"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932573"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932573"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932574"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932574"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2913"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932572"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932573"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932574"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2914"></span><span>
</span><span id="line-2915"></span><span>
</span><span id="line-2916"></span><span>      </span><span class="hs-comment">-- (l1 + x) - (l2 + y) ==&gt; (l1-l2) + (x-y)</span><span>
</span><span id="line-2917"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932575"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932575"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932576"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932576"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932577"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932577"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932578"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932578"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2918"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932575"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932577"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932576"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932578"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2919"></span><span>
</span><span id="line-2920"></span><span>      </span><span class="hs-comment">-- (l1 + x) - (l2 - y) ==&gt; (l1-l2) + (x+y)</span><span>
</span><span id="line-2921"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932579"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932579"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932580"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932580"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932581"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932581"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932582"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932582"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2922"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932579"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932581"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932580"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932582"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2923"></span><span>
</span><span id="line-2924"></span><span>      </span><span class="hs-comment">-- (l1 + x) - (y - l2) ==&gt; (l1+l2) + (x-y)</span><span>
</span><span id="line-2925"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932583"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932583"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932584"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932584"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932585"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932585"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932586"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932586"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2926"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932583"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932586"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932584"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932585"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2927"></span><span>
</span><span id="line-2928"></span><span>      </span><span class="hs-comment">-- (l1 - x) - (l2 + y) ==&gt; (l1-l2) - (x+y)</span><span>
</span><span id="line-2929"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932587"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932587"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932588"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932588"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932589"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932589"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932590"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932590"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2930"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932587"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932589"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932588"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932590"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2931"></span><span>
</span><span id="line-2932"></span><span>      </span><span class="hs-comment">-- (x - l1) - (l2 + y) ==&gt; (0-l1-l2) + (x-y)</span><span>
</span><span id="line-2933"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932591"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932591"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932592"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932592"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932593"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932593"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932594"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932594"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2934"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932592"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932593"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932591"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932594"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2935"></span><span>
</span><span id="line-2936"></span><span>      </span><span class="hs-comment">-- (l1 - x) - (l2 - y) ==&gt; (l1-l2) + (y-x)</span><span>
</span><span id="line-2937"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932595"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932595"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932596"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932596"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932597"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932597"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932598"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932598"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2938"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932595"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932597"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932598"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932596"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2939"></span><span>
</span><span id="line-2940"></span><span>      </span><span class="hs-comment">-- (l1 - x) - (y - l2) ==&gt; (l1+l2) - (x+y)</span><span>
</span><span id="line-2941"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932599"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932599"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932600"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932600"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932601"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932601"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932602"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932602"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2942"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932599"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932602"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932600"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932601"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2943"></span><span>
</span><span id="line-2944"></span><span>      </span><span class="hs-comment">-- (x - l1) - (l2 - y) ==&gt; (0-l1-l2) + (x+y)</span><span>
</span><span id="line-2945"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932603"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932603"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932604"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932604"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932605"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932605"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932606"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932606"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2946"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932604"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932605"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932603"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932606"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2947"></span><span>
</span><span id="line-2948"></span><span>      </span><span class="hs-comment">-- (x - l1) - (y - l2) ==&gt; (l2-l1) + (x-y)</span><span>
</span><span id="line-2949"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932607"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932607"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932608"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932608"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932609"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932609"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932610"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932610"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2950"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932610"><span class="hs-identifier hs-var">l2</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932608"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932607"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932609"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2951"></span><span>
</span><span id="line-2952"></span><span>       </span><span class="hs-comment">-- R4) Simple factorization</span><span>
</span><span id="line-2953"></span><span>
</span><span id="line-2954"></span><span>      </span><span class="hs-comment">-- x - (l1 * x) ==&gt; (1-l1) * x</span><span>
</span><span id="line-2955"></span><span>      </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932611"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932611"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; CoreExpr -&gt; Maybe Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#is_expr_mul"><span class="hs-identifier hs-var">is_expr_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932549"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932550"><span class="hs-identifier hs-var">arg2</span></a></span><span>
</span><span id="line-2956"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932611"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932612"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932549"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2957"></span><span>
</span><span id="line-2958"></span><span>      </span><span class="hs-comment">-- (l1 * x) - x ==&gt; (l1-1) * x</span><span>
</span><span id="line-2959"></span><span>      </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932613"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932613"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; CoreExpr -&gt; Maybe Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#is_expr_mul"><span class="hs-identifier hs-var">is_expr_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932550"><span class="hs-identifier hs-var">arg2</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932549"><span class="hs-identifier hs-var">arg1</span></a></span><span>
</span><span id="line-2960"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932613"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932612"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932550"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2961"></span><span>
</span><span id="line-2962"></span><span>      </span><span class="hs-comment">-- (l1 * x) - (l2 * x) ==&gt; (l1-l2) * x</span><span>
</span><span id="line-2963"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_mul"><span class="hs-identifier hs-var">is_lit_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932614"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932614"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932615"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932615"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; CoreExpr -&gt; Maybe Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#is_expr_mul"><span class="hs-identifier hs-var">is_expr_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932616"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932616"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-2964"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932614"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932616"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932612"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932615"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2965"></span><span>
</span><span id="line-2966"></span><span>      </span><span class="hs-comment">-- R5) +/- propagation: these transformations push literals outwards</span><span>
</span><span id="line-2967"></span><span>      </span><span class="hs-comment">-- with the hope that other rules can then be applied.</span><span>
</span><span id="line-2968"></span><span>
</span><span id="line-2969"></span><span>      </span><span class="hs-comment">-- In the following rules, x can't be a literal otherwise another</span><span>
</span><span id="line-2970"></span><span>      </span><span class="hs-comment">-- rule would have combined it with the other literal in arg2. So we</span><span>
</span><span id="line-2971"></span><span>      </span><span class="hs-comment">-- don't have to check this to avoid loops here.</span><span>
</span><span id="line-2972"></span><span>
</span><span id="line-2973"></span><span>      </span><span class="hs-comment">-- x - (l1 + y) ==&gt; (x - y) - l1</span><span>
</span><span id="line-2974"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932617"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932617"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932618"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932618"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2975"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932549"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932618"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932617"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2976"></span><span>
</span><span id="line-2977"></span><span>      </span><span class="hs-comment">-- (l1 + x) - y ==&gt; l1 + (x - y)</span><span>
</span><span id="line-2978"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932619"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932619"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932620"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932620"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-2979"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932619"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932620"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932550"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2980"></span><span>
</span><span id="line-2981"></span><span>      </span><span class="hs-comment">-- x - (l1 - y) ==&gt; (x + y) - l1</span><span>
</span><span id="line-2982"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932621"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932621"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932622"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932622"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2983"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932549"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932622"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932621"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2984"></span><span>
</span><span id="line-2985"></span><span>      </span><span class="hs-comment">-- x - (y - l1) ==&gt; l1 + (x - y)</span><span>
</span><span id="line-2986"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932623"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932623"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932624"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932624"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2987"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932624"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932549"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932623"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2988"></span><span>
</span><span id="line-2989"></span><span>      </span><span class="hs-comment">-- (l1 - x) - y ==&gt; l1 - (x + y)</span><span>
</span><span id="line-2990"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932625"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932625"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932626"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932626"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-2991"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932625"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932626"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932550"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2992"></span><span>
</span><span id="line-2993"></span><span>      </span><span class="hs-comment">-- (x - l1) - y ==&gt; (x - y) - l1</span><span>
</span><span id="line-2994"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932627"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932627"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932628"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932628"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-2995"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932627"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932550"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932628"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2996"></span><span>
</span><span id="line-2997"></span><span>      </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-2998"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-2999"></span><span>      </span><span id="local-6989586621682932558"><span class="annot"><span class="annottext">mkL :: Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932558"><span class="hs-identifier hs-var hs-var">mkL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr)
-&gt; (Integer -&gt; Literal) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; NumOps -&gt; Integer -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteral"><span class="hs-identifier hs-var">mkNumLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932548"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span>
</span><span id="line-3000"></span><span>      </span><span id="local-6989586621682932554"><span class="annot"><span class="annottext">add :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932554"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621682932629"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932629"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932630"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932630"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932629"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932630"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3001"></span><span>      </span><span id="local-6989586621682932559"><span class="annot"><span class="annottext">sub :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932559"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621682932631"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932631"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932632"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932632"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932631"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932632"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3002"></span><span>      </span><span id="local-6989586621682932612"><span class="annot"><span class="annottext">mul :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932612"><span class="hs-identifier hs-var hs-var">mul</span></a></span></span><span> </span><span id="local-6989586621682932633"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932633"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932634"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932634"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932551"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932634"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3003"></span><span>
</span><span id="line-3004"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules%27"><span class="hs-identifier hs-type">mulFoldingRules'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-3005"></span><span id="mulFoldingRules%27"><span class="annot"><span class="annottext">mulFoldingRules' :: Platform -&gt; CoreExpr -&gt; CoreExpr -&gt; NumOps -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#mulFoldingRules%27"><span class="hs-identifier hs-var hs-var">mulFoldingRules'</span></a></span></span><span> </span><span id="local-6989586621682932635"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932635"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932636"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932636"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span id="local-6989586621682932637"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932637"><span class="hs-identifier hs-var">arg2</span></a></span></span><span> </span><span id="local-6989586621682932638"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932636"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932637"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3006"></span><span>   </span><span class="hs-comment">-- (-x) * (-y) ==&gt; x*y</span><span>
</span><span id="line-3007"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#is_neg"><span class="hs-identifier hs-var">is_neg</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932639"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932639"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#is_neg"><span class="hs-identifier hs-var">is_neg</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932640"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932640"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3008"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932639"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932640"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3009"></span><span>
</span><span id="line-3010"></span><span>   </span><span class="hs-comment">-- l1 * (-x) ==&gt; (-l1) * x</span><span>
</span><span id="line-3011"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932642"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932642"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#is_neg"><span class="hs-identifier hs-var">is_neg</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932643"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932643"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3012"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932644"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932642"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932643"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3013"></span><span>
</span><span id="line-3014"></span><span>   </span><span class="hs-comment">-- l1 * (l2 * x) ==&gt; (l1*l2) * x</span><span>
</span><span id="line-3015"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932645"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932645"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_mul"><span class="hs-identifier hs-var">is_lit_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932646"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932646"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932647"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932647"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3016"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932644"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932645"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932646"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932647"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3017"></span><span>
</span><span id="line-3018"></span><span>   </span><span class="hs-comment">-- l1 * (l2 + x) ==&gt; (l1*l2) + (l1 * x)</span><span>
</span><span id="line-3019"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932648"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932648"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var">is_lit_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932649"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932649"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932650"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932650"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3020"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932644"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932648"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932649"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932651"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932636"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932650"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3021"></span><span>
</span><span id="line-3022"></span><span>   </span><span class="hs-comment">-- l1 * (l2 - x) ==&gt; (l1*l2) - (l1 * x)</span><span>
</span><span id="line-3023"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932652"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932652"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932653"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932653"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932654"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932654"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3024"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932644"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932652"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932653"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932655"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932636"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932654"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3025"></span><span>
</span><span id="line-3026"></span><span>   </span><span class="hs-comment">-- l1 * (x - l2) ==&gt; (l1 * x) - (l1*l2)</span><span>
</span><span id="line-3027"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932656"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932656"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var">is_sub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932657"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932657"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932658"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932658"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3028"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932636"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932657"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932655"><span class="hs-operator hs-var">`sub`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932644"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932656"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932658"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3029"></span><span>
</span><span id="line-3030"></span><span>   </span><span class="hs-comment">-- (l1 * x) * (l2 * y) ==&gt; (l1*l2) * (x * y)</span><span>
</span><span id="line-3031"></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_mul"><span class="hs-identifier hs-var">is_lit_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932659"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932659"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932660"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932660"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_mul"><span class="hs-identifier hs-var">is_lit_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932661"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932661"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932662"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932662"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3032"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932644"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932659"><span class="hs-identifier hs-var">l1</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932661"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932660"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-operator hs-var">`mul`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932662"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3033"></span><span>
</span><span id="line-3034"></span><span>   </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3035"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-3036"></span><span>      </span><span id="local-6989586621682932644"><span class="annot"><span class="annottext">mkL :: Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932644"><span class="hs-identifier hs-var hs-var">mkL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr)
-&gt; (Integer -&gt; Literal) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; NumOps -&gt; Integer -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteral"><span class="hs-identifier hs-var">mkNumLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932635"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span>
</span><span id="line-3037"></span><span>      </span><span id="local-6989586621682932651"><span class="annot"><span class="annottext">add :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932651"><span class="hs-identifier hs-var hs-var">add</span></a></span></span><span> </span><span id="local-6989586621682932663"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932663"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932664"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932664"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932663"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932664"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3038"></span><span>      </span><span id="local-6989586621682932655"><span class="annot"><span class="annottext">sub :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932655"><span class="hs-identifier hs-var hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621682932665"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932665"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932666"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932666"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932665"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932666"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3039"></span><span>      </span><span id="local-6989586621682932641"><span class="annot"><span class="annottext">mul :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932641"><span class="hs-identifier hs-var hs-var">mul</span></a></span></span><span> </span><span id="local-6989586621682932667"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932667"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932668"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932668"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932667"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932638"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932668"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3040"></span><span>
</span><span id="line-3041"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules%27"><span class="hs-identifier hs-type">andFoldingRules'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-3042"></span><span id="andFoldingRules%27"><span class="annot"><span class="annottext">andFoldingRules' :: Platform -&gt; CoreExpr -&gt; CoreExpr -&gt; NumOps -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#andFoldingRules%27"><span class="hs-identifier hs-var hs-var">andFoldingRules'</span></a></span></span><span> </span><span id="local-6989586621682932669"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932669"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932670"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932670"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span id="local-6989586621682932671"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932671"><span class="hs-identifier hs-var">arg2</span></a></span></span><span> </span><span id="local-6989586621682932672"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932672"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932670"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932671"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3043"></span><span>    </span><span class="hs-comment">-- R2) * `or` `and` simplifications</span><span>
</span><span id="line-3044"></span><span>    </span><span class="hs-comment">-- l1 and (l2 and x) ==&gt; (l1 and l2) and x</span><span>
</span><span id="line-3045"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932673"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932673"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_and"><span class="hs-identifier hs-var">is_lit_and</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932672"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932675"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932675"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932676"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932676"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3046"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932677"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932673"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932675"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932678"><span class="hs-operator hs-var">`and`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932676"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3047"></span><span>
</span><span id="line-3048"></span><span>    </span><span class="hs-comment">-- l1 and (l2 or x) ==&gt; (l1 and l2) or (l1 and x)</span><span>
</span><span id="line-3049"></span><span>    </span><span class="hs-comment">-- does not decrease operations</span><span>
</span><span id="line-3050"></span><span>
</span><span id="line-3051"></span><span>    </span><span class="hs-comment">-- (l1 and x) and (l2 and y) ==&gt; (l1 and l2) and (x and y)</span><span>
</span><span id="line-3052"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_and"><span class="hs-identifier hs-var">is_lit_and</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932672"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932679"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932679"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932680"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932680"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_and"><span class="hs-identifier hs-var">is_lit_and</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932672"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932681"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932681"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932682"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932682"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3053"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932677"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932679"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932681"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932678"><span class="hs-operator hs-var">`and`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932680"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932678"><span class="hs-operator hs-var">`and`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932682"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3054"></span><span>
</span><span id="line-3055"></span><span>    </span><span class="hs-comment">-- (l1 and x) and (l2 or y) ==&gt; (l1 and l2 and x) or (l1 and x and y)</span><span>
</span><span id="line-3056"></span><span>    </span><span class="hs-comment">-- (l1 or x) and (l2 or y) ==&gt; (l1 and l2) or (x and l2) or (l1 and y) or (x and y)</span><span>
</span><span id="line-3057"></span><span>    </span><span class="hs-comment">-- increase operation numbers</span><span>
</span><span id="line-3058"></span><span>
</span><span id="line-3059"></span><span>    </span><span class="hs-comment">-- x and (y or ... or x or ... or z) ==&gt; x</span><span>
</span><span id="line-3060"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682932683"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932683"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#is_or_list"><span class="hs-identifier hs-var">is_or_list</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932672"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932685"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682932685"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3061"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bool) -&gt; [CoreExpr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
forall b. Expr b -&gt; Expr b -&gt; Bool
</span><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-identifier hs-var">cheapEqExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932683"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682932685"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-3062"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932683"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3063"></span><span>
</span><span id="line-3064"></span><span>    </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3065"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-3066"></span><span>      </span><span id="local-6989586621682932677"><span class="annot"><span class="annottext">mkL :: Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932677"><span class="hs-identifier hs-var hs-var">mkL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr)
-&gt; (Integer -&gt; Literal) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; NumOps -&gt; Integer -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteral"><span class="hs-identifier hs-var">mkNumLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932669"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932672"><span class="hs-identifier hs-var">num_ops</span></a></span><span>
</span><span id="line-3067"></span><span>      </span><span id="local-6989586621682932678"><span class="annot"><span class="annottext">and :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932678"><span class="hs-identifier hs-var hs-var">and</span></a></span></span><span> </span><span id="local-6989586621682932687"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932687"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932688"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932688"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932687"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PrimOp -&gt; PrimOp
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932672"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932688"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3068"></span><span>
</span><span id="line-3069"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules%27"><span class="hs-identifier hs-type">orFoldingRules'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-3070"></span><span id="orFoldingRules%27"><span class="annot"><span class="annottext">orFoldingRules' :: Platform -&gt; CoreExpr -&gt; CoreExpr -&gt; NumOps -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#orFoldingRules%27"><span class="hs-identifier hs-var hs-var">orFoldingRules'</span></a></span></span><span> </span><span id="local-6989586621682932690"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932690"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932691"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932691"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span id="local-6989586621682932692"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932692"><span class="hs-identifier hs-var">arg2</span></a></span></span><span> </span><span id="local-6989586621682932693"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932693"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932691"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932692"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3071"></span><span>    </span><span class="hs-comment">-- R2) *  `or` `and` simplifications</span><span>
</span><span id="line-3072"></span><span>    </span><span class="hs-comment">-- l1 or (l2 or x) ==&gt; (l1 or l2) or x</span><span>
</span><span id="line-3073"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932694"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932694"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_or"><span class="hs-identifier hs-var">is_lit_or</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932693"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932696"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932696"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932697"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932697"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3074"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932698"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932694"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932696"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932699"><span class="hs-operator hs-var">`or`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932697"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3075"></span><span>
</span><span id="line-3076"></span><span>    </span><span class="hs-comment">-- l1 or (l2 and x) ==&gt; (l1 or l2) and (l1 and x)</span><span>
</span><span id="line-3077"></span><span>    </span><span class="hs-comment">-- does not decrease operations</span><span>
</span><span id="line-3078"></span><span>
</span><span id="line-3079"></span><span>    </span><span class="hs-comment">-- (l1 or x) or (l2 or y) ==&gt; (l1 or l2) or (x or y)</span><span>
</span><span id="line-3080"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_or"><span class="hs-identifier hs-var">is_lit_or</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932693"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932700"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932700"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932701"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932701"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_or"><span class="hs-identifier hs-var">is_lit_or</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932693"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932702"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932702"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932703"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932703"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3081"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932698"><span class="hs-identifier hs-var">mkL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932700"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932702"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932699"><span class="hs-operator hs-var">`or`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932701"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932699"><span class="hs-operator hs-var">`or`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932703"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3082"></span><span>
</span><span id="line-3083"></span><span>    </span><span class="hs-comment">-- (l1 and x) or (l2 or y) ==&gt; (l1 and l2 and x) or (l1 and x and y)</span><span>
</span><span id="line-3084"></span><span>    </span><span class="hs-comment">-- (l1 and x) or (l2 and y) ==&gt; (l1 and l2) or (x and l2) or (l1 and y) or (x and y)</span><span>
</span><span id="line-3085"></span><span>    </span><span class="hs-comment">-- increase operation numbers</span><span>
</span><span id="line-3086"></span><span>
</span><span id="line-3087"></span><span>    </span><span class="hs-comment">-- x or (y and ... and x and ... and z) ==&gt; x</span><span>
</span><span id="line-3088"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621682932704"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932704"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#is_and_list"><span class="hs-identifier hs-var">is_and_list</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932693"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932706"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682932706"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3089"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Bool) -&gt; [CoreExpr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
forall b. Expr b -&gt; Expr b -&gt; Bool
</span><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-identifier hs-var">cheapEqExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932704"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682932706"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-3090"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932704"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3091"></span><span>
</span><span id="line-3092"></span><span>    </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3093"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-3094"></span><span>      </span><span id="local-6989586621682932698"><span class="annot"><span class="annottext">mkL :: Integer -&gt; CoreExpr
</span><a href="#local-6989586621682932698"><span class="hs-identifier hs-var hs-var">mkL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; CoreExpr)
-&gt; (Integer -&gt; Literal) -&gt; Integer -&gt; CoreExpr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; NumOps -&gt; Integer -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteral"><span class="hs-identifier hs-var">mkNumLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932690"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932693"><span class="hs-identifier hs-var">num_ops</span></a></span><span>
</span><span id="line-3095"></span><span>      </span><span id="local-6989586621682932699"><span class="annot"><span class="annottext">or :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932699"><span class="hs-identifier hs-var hs-var">or</span></a></span></span><span> </span><span id="local-6989586621682932707"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932707"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932708"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932708"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932707"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PrimOp -&gt; PrimOp
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932693"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932708"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3096"></span><span>
</span><span id="line-3097"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules%27"><span class="hs-identifier hs-type">quotFoldingRules'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-3098"></span><span id="quotFoldingRules%27"><span class="annot"><span class="annottext">quotFoldingRules' :: Platform -&gt; CoreExpr -&gt; CoreExpr -&gt; NumOps -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#quotFoldingRules%27"><span class="hs-identifier hs-var hs-var">quotFoldingRules'</span></a></span></span><span> </span><span id="local-6989586621682932710"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932710"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932711"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932711"><span class="hs-identifier hs-var">arg1</span></a></span></span><span> </span><span id="local-6989586621682932712"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932712"><span class="hs-identifier hs-var">arg2</span></a></span></span><span> </span><span id="local-6989586621682932713"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932713"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932711"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932712"><span class="hs-identifier hs-var">arg2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3099"></span><span>
</span><span id="line-3100"></span><span>  </span><span class="hs-comment">-- (x / l1) / l2</span><span>
</span><span id="line-3101"></span><span>  </span><span class="hs-comment">-- l1 and l2 /= 0</span><span>
</span><span id="line-3102"></span><span>  </span><span class="hs-comment">-- l1*l2 doesn't overflow</span><span>
</span><span id="line-3103"></span><span>  </span><span class="hs-comment">-- ==&gt; x / (l1 * l2)</span><span>
</span><span id="line-3104"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_div"><span class="hs-identifier hs-var">is_div</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932713"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932715"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932715"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932716"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932716"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932717"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932717"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3105"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932716"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3106"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932717"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3107"></span><span>    </span><span class="hs-comment">-- check that the result of the multiplication is in range</span><span>
</span><span id="line-3108"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932718"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932718"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; NumOps -&gt; Integer -&gt; Maybe Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteralMaybe"><span class="hs-identifier hs-var">mkNumLiteralMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932710"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932713"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932716"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932717"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3109"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932720"><span class="hs-identifier hs-var">div</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932715"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932718"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3110"></span><span>      </span><span class="hs-comment">-- NB: we could directly return 0 or (-1) in case of overflow,</span><span>
</span><span id="line-3111"></span><span>      </span><span class="hs-comment">-- but we would need to know</span><span>
</span><span id="line-3112"></span><span>      </span><span class="hs-comment">--  (1) if we're dealing with a quot or a div operation</span><span>
</span><span id="line-3113"></span><span>      </span><span class="hs-comment">--  (2) if it's an underflow or an overflow.</span><span>
</span><span id="line-3114"></span><span>      </span><span class="hs-comment">-- Left as future work for now.</span><span>
</span><span id="line-3115"></span><span>
</span><span id="line-3116"></span><span>  </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3117"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3118"></span><span>    </span><span id="local-6989586621682932720"><span class="annot"><span class="annottext">div :: CoreExpr -&gt; CoreExpr -&gt; CoreExpr
</span><a href="#local-6989586621682932720"><span class="hs-identifier hs-var hs-var">div</span></a></span></span><span> </span><span id="local-6989586621682932721"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932721"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932722"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932722"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932721"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PrimOp -&gt; PrimOp
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932713"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932722"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-3119"></span><span>
</span><span id="line-3120"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-type">is_binop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3121"></span><span id="is_binop"><span class="annot"><span class="annottext">is_binop :: PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var hs-var">is_binop</span></a></span></span><span> </span><span id="local-6989586621682932725"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932725"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682932726"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932726"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932726"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3122"></span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-type">BinOpApp</span></a></span><span> </span><span id="local-6989586621682932727"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932727"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932728"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932728"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span id="local-6989586621682932729"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932729"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932725"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932728"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, CoreExpr) -&gt; Maybe (CoreExpr, CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932727"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932729"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3123"></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span>                            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreExpr, CoreExpr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3124"></span><span>
</span><span id="line-3125"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_op"><span class="hs-identifier hs-type">is_op</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3126"></span><span id="is_op"><span class="annot"><span class="annottext">is_op :: PrimOp -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#is_op"><span class="hs-identifier hs-var hs-var">is_op</span></a></span></span><span> </span><span id="local-6989586621682932731"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932731"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682932732"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932732"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932732"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3127"></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#OpVal"><span class="hs-identifier hs-type">OpVal</span></a></span><span> </span><span id="local-6989586621682932734"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932734"><span class="hs-identifier hs-var">op'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682932735"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932735"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932731"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932734"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe CoreExpr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932735"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3128"></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe CoreExpr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3129"></span><span>
</span><span id="line-3130"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_add"><span class="hs-identifier hs-type">is_add</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-type">is_sub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_mul"><span class="hs-identifier hs-type">is_mul</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_and"><span class="hs-identifier hs-type">is_and</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_or"><span class="hs-identifier hs-type">is_or</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_div"><span class="hs-identifier hs-type">is_div</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3131"></span><span id="is_add"><span class="annot"><span class="annottext">is_add :: NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_add"><span class="hs-identifier hs-var hs-var">is_add</span></a></span></span><span> </span><span id="local-6989586621682932741"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932741"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932742"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932742"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var">is_binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932741"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932742"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3132"></span><span id="is_sub"><span class="annot"><span class="annottext">is_sub :: NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_sub"><span class="hs-identifier hs-var hs-var">is_sub</span></a></span></span><span> </span><span id="local-6989586621682932743"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932743"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932744"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932744"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var">is_binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932743"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932744"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3133"></span><span id="is_mul"><span class="annot"><span class="annottext">is_mul :: NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_mul"><span class="hs-identifier hs-var hs-var">is_mul</span></a></span></span><span> </span><span id="local-6989586621682932745"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932745"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932746"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932746"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var">is_binop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932745"><span class="hs-identifier hs-var">num_ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932746"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3134"></span><span id="is_and"><span class="annot"><span class="annottext">is_and :: NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_and"><span class="hs-identifier hs-var hs-var">is_and</span></a></span></span><span> </span><span id="local-6989586621682932747"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932747"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932748"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932748"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932747"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
-&gt; (PrimOp -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; Maybe (CoreExpr, CoreExpr)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932749"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932749"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var">is_binop</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932749"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932748"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3135"></span><span id="is_or"><span class="annot"><span class="annottext">is_or :: NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_or"><span class="hs-identifier hs-var hs-var">is_or</span></a></span></span><span>  </span><span id="local-6989586621682932750"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932750"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932751"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932751"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>  </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932750"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
-&gt; (PrimOp -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; Maybe (CoreExpr, CoreExpr)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932752"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932752"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var">is_binop</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932752"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932751"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3136"></span><span id="is_div"><span class="annot"><span class="annottext">is_div :: NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_div"><span class="hs-identifier hs-var hs-var">is_div</span></a></span></span><span> </span><span id="local-6989586621682932753"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932753"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932754"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932754"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932753"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
-&gt; (PrimOp -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; Maybe (CoreExpr, CoreExpr)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932755"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932755"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_binop"><span class="hs-identifier hs-var">is_binop</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932755"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932754"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3137"></span><span>
</span><span id="line-3138"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_neg"><span class="hs-identifier hs-type">is_neg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3139"></span><span id="is_neg"><span class="annot"><span class="annottext">is_neg :: NumOps -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#is_neg"><span class="hs-identifier hs-var hs-var">is_neg</span></a></span></span><span> </span><span id="local-6989586621682932756"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932756"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932757"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932757"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932756"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp -&gt; (PrimOp -&gt; Maybe CoreExpr) -&gt; Maybe CoreExpr
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932759"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932759"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; CoreExpr -&gt; Maybe CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#is_op"><span class="hs-identifier hs-var">is_op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932759"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932757"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3140"></span><span>
</span><span id="line-3141"></span><span class="hs-comment">-- Return a list of operands for a given operation.</span><span>
</span><span id="line-3142"></span><span class="hs-comment">-- E.e. is_and_list (a and ... and z) =&gt; [a,...,z] for any nesting of the and</span><span>
</span><span id="line-3143"></span><span class="hs-comment">-- operation</span><span>
</span><span id="line-3144"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_list"><span class="hs-identifier hs-type">is_list</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">,</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3145"></span><span id="is_list"><span class="annot"><span class="annottext">is_list :: (CoreExpr -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; CoreExpr -&gt; Maybe [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#is_list"><span class="hs-identifier hs-var hs-var">is_list</span></a></span></span><span> </span><span id="local-6989586621682932761"><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="#local-6989586621682932761"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682932762"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932762"><span class="hs-identifier hs-var">e_org</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="#local-6989586621682932761"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932762"><span class="hs-identifier hs-var">e_org</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- do we have the operator at all?</span><span>
</span><span id="line-3146"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932763"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932763"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932764"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932764"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; Maybe [CoreExpr]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[CoreExpr] -&gt; [CoreExpr]
</span><a href="#local-6989586621682932765"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932763"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932764"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3147"></span><span>  </span><span class="annot"><span class="annottext">Maybe (CoreExpr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe [CoreExpr]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3148"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3149"></span><span>    </span><span id="local-6989586621682932765"><span class="annot"><span class="annottext">go :: [CoreExpr] -&gt; [CoreExpr]
</span><a href="#local-6989586621682932765"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3150"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-3151"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621682932766"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932766"><span class="hs-identifier hs-var">e</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621682932767"><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682932767"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="#local-6989586621682932761"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932766"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3152"></span><span>        </span><span class="hs-comment">-- we can't split any more: add to the result list</span><span>
</span><span id="line-3153"></span><span>        </span><span class="annot"><span class="annottext">Maybe (CoreExpr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932766"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; [CoreExpr]
</span><a href="#local-6989586621682932765"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682932767"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-3154"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932768"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932768"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932769"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932769"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[CoreExpr] -&gt; [CoreExpr]
</span><a href="#local-6989586621682932765"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932768"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932769"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">CoreExpr -&gt; [CoreExpr] -&gt; [CoreExpr]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[CoreExpr]
</span><a href="#local-6989586621682932767"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3155"></span><span>
</span><span id="line-3156"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_and_list"><span class="hs-identifier hs-type">is_and_list</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_or_list"><span class="hs-identifier hs-type">is_or_list</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#CoreArg"><span class="hs-identifier hs-type">CoreArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-3157"></span><span id="is_and_list"><span class="annot"><span class="annottext">is_and_list :: NumOps -&gt; CoreExpr -&gt; Maybe [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#is_and_list"><span class="hs-identifier hs-var hs-var">is_and_list</span></a></span></span><span> </span><span id="local-6989586621682932770"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932770"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; CoreExpr -&gt; Maybe [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#is_list"><span class="hs-identifier hs-var">is_list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_and"><span class="hs-identifier hs-var">is_and</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932770"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3158"></span><span id="is_or_list"><span class="annot"><span class="annottext">is_or_list :: NumOps -&gt; CoreExpr -&gt; Maybe [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#is_or_list"><span class="hs-identifier hs-var hs-var">is_or_list</span></a></span></span><span>  </span><span id="local-6989586621682932771"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932771"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; CoreExpr -&gt; Maybe [CoreExpr]
</span><a href="GHC.Core.Opt.ConstantFold.html#is_list"><span class="hs-identifier hs-var">is_list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_or"><span class="hs-identifier hs-var">is_or</span></a></span><span>  </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932771"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3159"></span><span>
</span><span id="line-3160"></span><span class="hs-comment">-- match operation with a literal (handles commutativity)</span><span>
</span><span id="line-3161"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-type">is_lit_add</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_lit_mul"><span class="hs-identifier hs-type">is_lit_mul</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_lit_and"><span class="hs-identifier hs-type">is_lit_and</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_lit_or"><span class="hs-identifier hs-type">is_lit_or</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3162"></span><span id="is_lit_add"><span class="annot"><span class="annottext">is_lit_add :: NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_add"><span class="hs-identifier hs-var hs-var">is_lit_add</span></a></span></span><span> </span><span id="local-6989586621682932772"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932772"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932773"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932773"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit%27"><span class="hs-identifier hs-var">is_lit'</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_add"><span class="hs-identifier hs-var">is_add</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932772"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932773"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3163"></span><span id="is_lit_mul"><span class="annot"><span class="annottext">is_lit_mul :: NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_mul"><span class="hs-identifier hs-var hs-var">is_lit_mul</span></a></span></span><span> </span><span id="local-6989586621682932775"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932775"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932776"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932776"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit%27"><span class="hs-identifier hs-var">is_lit'</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_mul"><span class="hs-identifier hs-var">is_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932775"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932776"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3164"></span><span id="is_lit_and"><span class="annot"><span class="annottext">is_lit_and :: NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_and"><span class="hs-identifier hs-var hs-var">is_lit_and</span></a></span></span><span> </span><span id="local-6989586621682932777"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932777"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932778"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932778"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit%27"><span class="hs-identifier hs-var">is_lit'</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_and"><span class="hs-identifier hs-var">is_and</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932777"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932778"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3165"></span><span id="is_lit_or"><span class="annot"><span class="annottext">is_lit_or :: NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_or"><span class="hs-identifier hs-var hs-var">is_lit_or</span></a></span></span><span>  </span><span id="local-6989586621682932779"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932779"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932780"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932780"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit%27"><span class="hs-identifier hs-var">is_lit'</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_or"><span class="hs-identifier hs-var">is_or</span></a></span><span>  </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932779"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932780"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3166"></span><span>
</span><span id="line-3167"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_lit%27"><span class="hs-identifier hs-type">is_lit'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3168"></span><span id="is_lit%27"><span class="annot"><span class="annottext">is_lit' :: (NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr))
-&gt; NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit%27"><span class="hs-identifier hs-var hs-var">is_lit'</span></a></span></span><span> </span><span id="local-6989586621682932781"><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="#local-6989586621682932781"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682932782"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932782"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932783"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932783"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (CoreExpr, CoreExpr)
</span><a href="#local-6989586621682932781"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932782"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932783"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3169"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932784"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932784"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932785"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932785"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer, CoreExpr) -&gt; Maybe (Integer, CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932784"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932785"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3170"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932786"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932786"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621682932787"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932787"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer, CoreExpr) -&gt; Maybe (Integer, CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932787"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932786"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3171"></span><span>  </span><span class="annot"><span class="annottext">Maybe (CoreExpr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, CoreExpr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3172"></span><span>
</span><span id="line-3173"></span><span class="hs-comment">-- match given &quot;x&quot;: return 1</span><span>
</span><span id="line-3174"></span><span class="hs-comment">-- match &quot;lit * x&quot;: return lit value (handles commutativity)</span><span>
</span><span id="line-3175"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_expr_mul"><span class="hs-identifier hs-type">is_expr_mul</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-3176"></span><span id="is_expr_mul"><span class="annot"><span class="annottext">is_expr_mul :: NumOps -&gt; CoreExpr -&gt; CoreExpr -&gt; Maybe Integer
</span><a href="GHC.Core.Opt.ConstantFold.html#is_expr_mul"><span class="hs-identifier hs-var hs-var">is_expr_mul</span></a></span></span><span> </span><span id="local-6989586621682932788"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932788"><span class="hs-identifier hs-var">num_ops</span></a></span></span><span> </span><span id="local-6989586621682932789"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932789"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932790"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932790"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span>
</span><span id="line-3177"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932789"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
forall b. Expr b -&gt; Expr b -&gt; Bool
</span><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-operator hs-var">`cheapEqExpr`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932790"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3178"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-3179"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932791"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932791"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932792"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932792"><span class="hs-identifier hs-var">x'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NumOps -&gt; CoreExpr -&gt; Maybe (Integer, CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_lit_mul"><span class="hs-identifier hs-var">is_lit_mul</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932788"><span class="hs-identifier hs-var">num_ops</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932790"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-3180"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932789"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; Bool
forall b. Expr b -&gt; Expr b -&gt; Bool
</span><a href="GHC.Core.Utils.html#cheapEqExpr"><span class="hs-operator hs-var">`cheapEqExpr`</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932792"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-3181"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932791"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-3182"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3183"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3184"></span><span>
</span><span id="line-3185"></span><span>
</span><span id="line-3186"></span><span class="annot"><span class="hs-comment">-- | Match the application of a binary primop</span></span><span>
</span><span id="line-3187"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-type">BinOpApp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>
</span><span id="line-3188"></span><span class="hs-keyword">pattern</span><span> </span><span id="BinOpApp"><span id="%24mBinOpApp"><span id="%24bBinOpApp"><span class="annot"><span class="annottext">$mBinOpApp :: forall {r}.
CoreExpr
-&gt; (CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bBinOpApp :: CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var hs-var hs-var">BinOpApp</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621682932795"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932796"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682932797"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#OpVal"><span class="hs-identifier hs-type">OpVal</span></a></span><span> </span><span id="local-6989586621682932796"><span class="annot"><a href="#local-6989586621682932796"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932795"><span class="annot"><a href="#local-6989586621682932795"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932797"><span class="annot"><a href="#local-6989586621682932797"><span class="hs-identifier hs-var">y</span></a></span></span><span>
</span><span id="line-3189"></span><span>
</span><span id="line-3190"></span><span class="annot"><span class="hs-comment">-- | Match a primop</span></span><span>
</span><span id="line-3191"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#OpVal"><span class="hs-identifier hs-type">OpVal</span></a></span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span>
</span><span id="line-3192"></span><span class="hs-keyword">pattern</span><span> </span><span id="OpVal"><span id="%24mOpVal"><span id="%24bOpVal"><span class="annot"><span class="annottext">$mOpVal :: forall {r}. CoreExpr -&gt; (PrimOp -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bOpVal :: PrimOp -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#OpVal"><span class="hs-identifier hs-var hs-var hs-var">OpVal</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621682932800"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Id.html#isPrimOpId_maybe"><span class="hs-identifier hs-type">isPrimOpId_maybe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932800"><span class="annot"><a href="#local-6989586621682932800"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3193"></span><span>   </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#OpVal"><span class="hs-identifier hs-var">OpVal</span></a></span><span> </span><span id="local-6989586621682932801"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932801"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp -&gt; Id
</span><a href="GHC.Builtin.PrimOps.Ids.html#primOpId"><span class="hs-identifier hs-var">primOpId</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932801"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3194"></span><span>
</span><span id="line-3195"></span><span class="annot"><span class="hs-comment">-- | Match a literal</span></span><span>
</span><span id="line-3196"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#CoreBndr"><span class="hs-identifier hs-type">CoreBndr</span></a></span><span>
</span><span id="line-3197"></span><span class="hs-keyword">pattern</span><span> </span><span id="L"><span id="%24mL"><span class="annot"><span class="annottext">$mL :: forall {r}. CoreExpr -&gt; (Integer -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
</span><a href="GHC.Core.Opt.ConstantFold.html#L"><span class="hs-identifier hs-var hs-var">L</span></a></span></span></span><span> </span><span class="annot"><a href="#local-6989586621682932803"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682932803"><span class="annot"><a href="#local-6989586621682932803"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3198"></span><span>
</span><span id="line-3199"></span><span class="annot"><span class="hs-comment">-- | Explicit &quot;type-class&quot;-like dictionary for numeric primops</span></span><span>
</span><span id="line-3200"></span><span class="hs-keyword">data</span><span> </span><span id="NumOps"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-var">NumOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NumOps"><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-var">NumOps</span></a></span></span><span>
</span><span id="line-3201"></span><span>   </span><span class="hs-special">{</span><span> </span><span id="numAdd"><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var hs-var">numAdd</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Add two numbers</span></span><span>
</span><span id="line-3202"></span><span>   </span><span class="hs-special">,</span><span> </span><span id="numSub"><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var hs-var">numSub</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Sub two numbers</span></span><span>
</span><span id="line-3203"></span><span>   </span><span class="hs-special">,</span><span> </span><span id="numMul"><span class="annot"><span class="annottext">NumOps -&gt; PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var hs-var">numMul</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ Multiply two numbers</span></span><span>
</span><span id="line-3204"></span><span>   </span><span class="hs-special">,</span><span> </span><span id="numDiv"><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var hs-var">numDiv</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Divide two numbers</span></span><span>
</span><span id="line-3205"></span><span>   </span><span class="hs-special">,</span><span> </span><span id="numAnd"><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var hs-var">numAnd</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ And two numbers</span></span><span>
</span><span id="line-3206"></span><span>   </span><span class="hs-special">,</span><span> </span><span id="numOr"><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var hs-var">numOr</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Or two numbers</span></span><span>
</span><span id="line-3207"></span><span>   </span><span class="hs-special">,</span><span> </span><span id="numNeg"><span class="annot"><span class="annottext">NumOps -&gt; Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var hs-var">numNeg</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Negate a number</span></span><span>
</span><span id="line-3208"></span><span>   </span><span class="hs-special">,</span><span> </span><span id="numLitType"><span class="annot"><span class="annottext">NumOps -&gt; LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var hs-var">numLitType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumType"><span class="hs-identifier hs-type">LitNumType</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Literal type</span></span><span>
</span><span id="line-3209"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3210"></span><span>
</span><span id="line-3211"></span><span class="annot"><span class="hs-comment">-- | Create a numeric literal</span></span><span>
</span><span id="line-3212"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteral"><span class="hs-identifier hs-type">mkNumLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-3213"></span><span id="mkNumLiteral"><span class="annot"><span class="annottext">mkNumLiteral :: Platform -&gt; NumOps -&gt; Integer -&gt; Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteral"><span class="hs-identifier hs-var hs-var">mkNumLiteral</span></a></span></span><span> </span><span id="local-6989586621682932806"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932806"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932807"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932807"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621682932808"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932808"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; LitNumType -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitNumberWrap"><span class="hs-identifier hs-var">mkLitNumberWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932806"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932807"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932808"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-3214"></span><span>
</span><span id="line-3215"></span><span class="annot"><span class="hs-comment">-- | Create a numeric literal if it is in range</span></span><span>
</span><span id="line-3216"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteralMaybe"><span class="hs-identifier hs-type">mkNumLiteralMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span>
</span><span id="line-3217"></span><span id="mkNumLiteralMaybe"><span class="annot"><span class="annottext">mkNumLiteralMaybe :: Platform -&gt; NumOps -&gt; Integer -&gt; Maybe Literal
</span><a href="GHC.Core.Opt.ConstantFold.html#mkNumLiteralMaybe"><span class="hs-identifier hs-var hs-var">mkNumLiteralMaybe</span></a></span></span><span> </span><span id="local-6989586621682932809"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932809"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932810"><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932810"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621682932811"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932811"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; LitNumType -&gt; Integer -&gt; Maybe Literal
</span><a href="GHC.Types.Literal.html#mkLitNumberMaybe"><span class="hs-identifier hs-var">mkLitNumberMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932809"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NumOps -&gt; LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="annot"><span class="annottext">NumOps
</span><a href="#local-6989586621682932810"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932811"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-3218"></span><span>
</span><span id="line-3219"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int8Ops"><span class="hs-identifier hs-type">int8Ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3220"></span><span id="int8Ops"><span class="annot"><span class="annottext">int8Ops :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int8Ops"><span class="hs-identifier hs-var hs-var">int8Ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3221"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8AddOp"><span class="hs-identifier hs-var">Int8AddOp</span></a></span><span>
</span><span id="line-3222"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8SubOp"><span class="hs-identifier hs-var">Int8SubOp</span></a></span><span>
</span><span id="line-3223"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8MulOp"><span class="hs-identifier hs-var">Int8MulOp</span></a></span><span>
</span><span id="line-3224"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8QuotOp"><span class="hs-identifier hs-var">Int8QuotOp</span></a></span><span>
</span><span id="line-3225"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3226"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3227"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8NegOp"><span class="hs-identifier hs-var">Int8NegOp</span></a></span><span>
</span><span id="line-3228"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt8"><span class="hs-identifier hs-var">LitNumInt8</span></a></span><span>
</span><span id="line-3229"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3230"></span><span>
</span><span id="line-3231"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word8Ops"><span class="hs-identifier hs-type">word8Ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3232"></span><span id="word8Ops"><span class="annot"><span class="annottext">word8Ops :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word8Ops"><span class="hs-identifier hs-var hs-var">word8Ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3233"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8AddOp"><span class="hs-identifier hs-var">Word8AddOp</span></a></span><span>
</span><span id="line-3234"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8SubOp"><span class="hs-identifier hs-var">Word8SubOp</span></a></span><span>
</span><span id="line-3235"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8MulOp"><span class="hs-identifier hs-var">Word8MulOp</span></a></span><span>
</span><span id="line-3236"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8QuotOp"><span class="hs-identifier hs-var">Word8QuotOp</span></a></span><span>
</span><span id="line-3237"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8AndOp"><span class="hs-identifier hs-var">Word8AndOp</span></a></span><span>
</span><span id="line-3238"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8OrOp"><span class="hs-identifier hs-var">Word8OrOp</span></a></span><span>
</span><span id="line-3239"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3240"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord8"><span class="hs-identifier hs-var">LitNumWord8</span></a></span><span>
</span><span id="line-3241"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3242"></span><span>
</span><span id="line-3243"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int16Ops"><span class="hs-identifier hs-type">int16Ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3244"></span><span id="int16Ops"><span class="annot"><span class="annottext">int16Ops :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int16Ops"><span class="hs-identifier hs-var hs-var">int16Ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3245"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16AddOp"><span class="hs-identifier hs-var">Int16AddOp</span></a></span><span>
</span><span id="line-3246"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16SubOp"><span class="hs-identifier hs-var">Int16SubOp</span></a></span><span>
</span><span id="line-3247"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16MulOp"><span class="hs-identifier hs-var">Int16MulOp</span></a></span><span>
</span><span id="line-3248"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16QuotOp"><span class="hs-identifier hs-var">Int16QuotOp</span></a></span><span>
</span><span id="line-3249"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3250"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3251"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16NegOp"><span class="hs-identifier hs-var">Int16NegOp</span></a></span><span>
</span><span id="line-3252"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt16"><span class="hs-identifier hs-var">LitNumInt16</span></a></span><span>
</span><span id="line-3253"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3254"></span><span>
</span><span id="line-3255"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word16Ops"><span class="hs-identifier hs-type">word16Ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3256"></span><span id="word16Ops"><span class="annot"><span class="annottext">word16Ops :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word16Ops"><span class="hs-identifier hs-var hs-var">word16Ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3257"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16AddOp"><span class="hs-identifier hs-var">Word16AddOp</span></a></span><span>
</span><span id="line-3258"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16SubOp"><span class="hs-identifier hs-var">Word16SubOp</span></a></span><span>
</span><span id="line-3259"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16MulOp"><span class="hs-identifier hs-var">Word16MulOp</span></a></span><span>
</span><span id="line-3260"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16QuotOp"><span class="hs-identifier hs-var">Word16QuotOp</span></a></span><span>
</span><span id="line-3261"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16AndOp"><span class="hs-identifier hs-var">Word16AndOp</span></a></span><span>
</span><span id="line-3262"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16OrOp"><span class="hs-identifier hs-var">Word16OrOp</span></a></span><span>
</span><span id="line-3263"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3264"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord16"><span class="hs-identifier hs-var">LitNumWord16</span></a></span><span>
</span><span id="line-3265"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3266"></span><span>
</span><span id="line-3267"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int32Ops"><span class="hs-identifier hs-type">int32Ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3268"></span><span id="int32Ops"><span class="annot"><span class="annottext">int32Ops :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int32Ops"><span class="hs-identifier hs-var hs-var">int32Ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3269"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32AddOp"><span class="hs-identifier hs-var">Int32AddOp</span></a></span><span>
</span><span id="line-3270"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32SubOp"><span class="hs-identifier hs-var">Int32SubOp</span></a></span><span>
</span><span id="line-3271"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32MulOp"><span class="hs-identifier hs-var">Int32MulOp</span></a></span><span>
</span><span id="line-3272"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32QuotOp"><span class="hs-identifier hs-var">Int32QuotOp</span></a></span><span>
</span><span id="line-3273"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3274"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3275"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32NegOp"><span class="hs-identifier hs-var">Int32NegOp</span></a></span><span>
</span><span id="line-3276"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt32"><span class="hs-identifier hs-var">LitNumInt32</span></a></span><span>
</span><span id="line-3277"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3278"></span><span>
</span><span id="line-3279"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word32Ops"><span class="hs-identifier hs-type">word32Ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3280"></span><span id="word32Ops"><span class="annot"><span class="annottext">word32Ops :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word32Ops"><span class="hs-identifier hs-var hs-var">word32Ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3281"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32AddOp"><span class="hs-identifier hs-var">Word32AddOp</span></a></span><span>
</span><span id="line-3282"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32SubOp"><span class="hs-identifier hs-var">Word32SubOp</span></a></span><span>
</span><span id="line-3283"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32MulOp"><span class="hs-identifier hs-var">Word32MulOp</span></a></span><span>
</span><span id="line-3284"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32QuotOp"><span class="hs-identifier hs-var">Word32QuotOp</span></a></span><span>
</span><span id="line-3285"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32AndOp"><span class="hs-identifier hs-var">Word32AndOp</span></a></span><span>
</span><span id="line-3286"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32OrOp"><span class="hs-identifier hs-var">Word32OrOp</span></a></span><span>
</span><span id="line-3287"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3288"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord32"><span class="hs-identifier hs-var">LitNumWord32</span></a></span><span>
</span><span id="line-3289"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3290"></span><span>
</span><span id="line-3291"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#int64Ops"><span class="hs-identifier hs-type">int64Ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3292"></span><span id="int64Ops"><span class="annot"><span class="annottext">int64Ops :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#int64Ops"><span class="hs-identifier hs-var hs-var">int64Ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3293"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64AddOp"><span class="hs-identifier hs-var">Int64AddOp</span></a></span><span>
</span><span id="line-3294"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64SubOp"><span class="hs-identifier hs-var">Int64SubOp</span></a></span><span>
</span><span id="line-3295"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64MulOp"><span class="hs-identifier hs-var">Int64MulOp</span></a></span><span>
</span><span id="line-3296"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64QuotOp"><span class="hs-identifier hs-var">Int64QuotOp</span></a></span><span>
</span><span id="line-3297"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3298"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3299"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int64NegOp"><span class="hs-identifier hs-var">Int64NegOp</span></a></span><span>
</span><span id="line-3300"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt64"><span class="hs-identifier hs-var">LitNumInt64</span></a></span><span>
</span><span id="line-3301"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3302"></span><span>
</span><span id="line-3303"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#word64Ops"><span class="hs-identifier hs-type">word64Ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3304"></span><span id="word64Ops"><span class="annot"><span class="annottext">word64Ops :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#word64Ops"><span class="hs-identifier hs-var hs-var">word64Ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3305"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64AddOp"><span class="hs-identifier hs-var">Word64AddOp</span></a></span><span>
</span><span id="line-3306"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64SubOp"><span class="hs-identifier hs-var">Word64SubOp</span></a></span><span>
</span><span id="line-3307"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64MulOp"><span class="hs-identifier hs-var">Word64MulOp</span></a></span><span>
</span><span id="line-3308"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64QuotOp"><span class="hs-identifier hs-var">Word64QuotOp</span></a></span><span>
</span><span id="line-3309"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64AndOp"><span class="hs-identifier hs-var">Word64AndOp</span></a></span><span>
</span><span id="line-3310"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word64OrOp"><span class="hs-identifier hs-var">Word64OrOp</span></a></span><span>
</span><span id="line-3311"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3312"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord64"><span class="hs-identifier hs-var">LitNumWord64</span></a></span><span>
</span><span id="line-3313"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3314"></span><span>
</span><span id="line-3315"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#intOps"><span class="hs-identifier hs-type">intOps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3316"></span><span id="intOps"><span class="annot"><span class="annottext">intOps :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#intOps"><span class="hs-identifier hs-var hs-var">intOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3317"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAddOp"><span class="hs-identifier hs-var">IntAddOp</span></a></span><span>
</span><span id="line-3318"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSubOp"><span class="hs-identifier hs-var">IntSubOp</span></a></span><span>
</span><span id="line-3319"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntMulOp"><span class="hs-identifier hs-var">IntMulOp</span></a></span><span>
</span><span id="line-3320"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntQuotOp"><span class="hs-identifier hs-var">IntQuotOp</span></a></span><span>
</span><span id="line-3321"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAndOp"><span class="hs-identifier hs-var">IntAndOp</span></a></span><span>
</span><span id="line-3322"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntOrOp"><span class="hs-identifier hs-var">IntOrOp</span></a></span><span>
</span><span id="line-3323"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntNegOp"><span class="hs-identifier hs-var">IntNegOp</span></a></span><span>
</span><span id="line-3324"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span>
</span><span id="line-3325"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3326"></span><span>
</span><span id="line-3327"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#wordOps"><span class="hs-identifier hs-type">wordOps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3328"></span><span id="wordOps"><span class="annot"><span class="annottext">wordOps :: NumOps
</span><a href="GHC.Core.Opt.ConstantFold.html#wordOps"><span class="hs-identifier hs-var hs-var">wordOps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#NumOps"><span class="hs-identifier hs-type">NumOps</span></a></span><span>
</span><span id="line-3329"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">numAdd :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAdd"><span class="hs-identifier hs-var">numAdd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAddOp"><span class="hs-identifier hs-var">WordAddOp</span></a></span><span>
</span><span id="line-3330"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numSub :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numSub"><span class="hs-identifier hs-var">numSub</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordSubOp"><span class="hs-identifier hs-var">WordSubOp</span></a></span><span>
</span><span id="line-3331"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numMul :: PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numMul"><span class="hs-identifier hs-var">numMul</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordMulOp"><span class="hs-identifier hs-var">WordMulOp</span></a></span><span>
</span><span id="line-3332"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numDiv :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numDiv"><span class="hs-identifier hs-var">numDiv</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordQuotOp"><span class="hs-identifier hs-var">WordQuotOp</span></a></span><span>
</span><span id="line-3333"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numAnd :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numAnd"><span class="hs-identifier hs-var">numAnd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAndOp"><span class="hs-identifier hs-var">WordAndOp</span></a></span><span>
</span><span id="line-3334"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numOr :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numOr"><span class="hs-identifier hs-var">numOr</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe PrimOp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordOrOp"><span class="hs-identifier hs-var">WordOrOp</span></a></span><span>
</span><span id="line-3335"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numNeg :: Maybe PrimOp
</span><a href="GHC.Core.Opt.ConstantFold.html#numNeg"><span class="hs-identifier hs-var">numNeg</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PrimOp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3336"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numLitType :: LitNumType
</span><a href="GHC.Core.Opt.ConstantFold.html#numLitType"><span class="hs-identifier hs-var">numLitType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumWord"><span class="hs-identifier hs-var">LitNumWord</span></a></span><span>
</span><span id="line-3337"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-3338"></span><span>
</span><span id="line-3339"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-3340"></span><span class="hs-comment">-- Constant folding through case-expressions</span><span>
</span><span id="line-3341"></span><span class="hs-comment">--</span><span>
</span><span id="line-3342"></span><span class="hs-comment">-- cf Scrutinee Constant Folding in simplCore/GHC.Core.Opt.Simplify.Utils</span><span>
</span><span id="line-3343"></span><span class="hs-comment">--------------------------------------------------------</span><span>
</span><span id="line-3344"></span><span>
</span><span id="line-3345"></span><span class="hs-comment">-- | Match the scrutinee of a case and potentially return a new scrutinee and a</span><span>
</span><span id="line-3346"></span><span class="hs-comment">-- function to apply to each literal alternative.</span><span>
</span><span id="line-3347"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules"><span class="hs-identifier hs-type">caseRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span>
</span><span id="line-3348"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>                       </span><span class="hs-comment">-- Scrutinee</span><span>
</span><span id="line-3349"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span>               </span><span class="hs-comment">-- New scrutinee</span><span>
</span><span id="line-3350"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span> </span><span class="hs-comment">-- How to fix up the alt pattern</span><span>
</span><span id="line-3351"></span><span>                                            </span><span class="hs-comment">--   Nothing &lt;=&gt; Unreachable</span><span>
</span><span id="line-3352"></span><span>                                            </span><span class="hs-comment">-- See Note [Unreachable caseRules alternatives]</span><span>
</span><span id="line-3353"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#CoreExpr"><span class="hs-identifier hs-type">CoreExpr</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- How to reconstruct the original scrutinee</span><span>
</span><span id="line-3354"></span><span>                                            </span><span class="hs-comment">-- from the new case-binder</span><span>
</span><span id="line-3355"></span><span class="hs-comment">-- e.g  case e of b {</span><span>
</span><span id="line-3356"></span><span class="hs-comment">--         ...;</span><span>
</span><span id="line-3357"></span><span class="hs-comment">--         con bs -&gt; rhs;</span><span>
</span><span id="line-3358"></span><span class="hs-comment">--         ... }</span><span>
</span><span id="line-3359"></span><span class="hs-comment">--  ==&gt;</span><span>
</span><span id="line-3360"></span><span class="hs-comment">--      case e' of b' {</span><span>
</span><span id="line-3361"></span><span class="hs-comment">--         ...;</span><span>
</span><span id="line-3362"></span><span class="hs-comment">--         fixup_altcon[con] bs -&gt; let b = mk_orig[b] in rhs;</span><span>
</span><span id="line-3363"></span><span class="hs-comment">--         ... }</span><span>
</span><span id="line-3364"></span><span>
</span><span id="line-3365"></span><span id="caseRules"><span class="annot"><span class="annottext">caseRules :: Platform
-&gt; CoreExpr
-&gt; Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
</span><a href="GHC.Core.Opt.ConstantFold.html#caseRules"><span class="hs-identifier hs-var hs-var">caseRules</span></a></span></span><span> </span><span id="local-6989586621682932813"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932813"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932814"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932814"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682932815"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932815"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682932816"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932816"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- v `op` x#</span><span>
</span><span id="line-3366"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932817"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932817"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe PrimOp
</span><a href="GHC.Types.Id.html#isPrimOpId_maybe"><span class="hs-identifier hs-var">isPrimOpId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932814"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-3367"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682932818"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932818"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932816"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3368"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932819"><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="#local-6989586621682932819"><span class="hs-identifier hs-var">adjust_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Integer -&gt; Maybe (Integer -&gt; Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#adjustDyadicRight"><span class="hs-identifier hs-var">adjustDyadicRight</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932817"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932818"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-3369"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
-&gt; Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932815"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; (Integer -&gt; Integer) -&gt; AltCon -&gt; Maybe AltCon
</span><a href="GHC.Core.Opt.ConstantFold.html#tx_lit_con"><span class="hs-identifier hs-var">tx_lit_con</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932813"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="#local-6989586621682932819"><span class="hs-identifier hs-var">adjust_lit</span></a></span><span>
</span><span id="line-3370"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932822"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932822"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932814"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932822"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932816"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3371"></span><span>
</span><span id="line-3372"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules"><span class="hs-identifier hs-var">caseRules</span></a></span><span> </span><span id="local-6989586621682932823"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932823"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932824"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932824"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-type">Lit</span></a></span><span> </span><span id="local-6989586621682932825"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932825"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621682932826"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932826"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- x# `op` v</span><span>
</span><span id="line-3373"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932827"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932827"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe PrimOp
</span><a href="GHC.Types.Id.html#isPrimOpId_maybe"><span class="hs-identifier hs-var">isPrimOpId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932824"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-3374"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682932828"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932828"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932825"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-3375"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932829"><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="#local-6989586621682932829"><span class="hs-identifier hs-var">adjust_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; PrimOp -&gt; Maybe (Integer -&gt; Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#adjustDyadicLeft"><span class="hs-identifier hs-var">adjustDyadicLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932828"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932827"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-3376"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
-&gt; Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932826"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; (Integer -&gt; Integer) -&gt; AltCon -&gt; Maybe AltCon
</span><a href="GHC.Core.Opt.ConstantFold.html#tx_lit_con"><span class="hs-identifier hs-var">tx_lit_con</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932823"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="#local-6989586621682932829"><span class="hs-identifier hs-var">adjust_lit</span></a></span><span>
</span><span id="line-3377"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932831"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932831"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932824"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; CoreExpr
forall b. Literal -&gt; Expr b
</span><a href="GHC.Core.html#Lit"><span class="hs-identifier hs-var">Lit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932825"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932831"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3378"></span><span>
</span><span id="line-3379"></span><span>
</span><span id="line-3380"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules"><span class="hs-identifier hs-var">caseRules</span></a></span><span> </span><span id="local-6989586621682932832"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932832"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932833"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932833"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682932834"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932834"><span class="hs-identifier hs-var">v</span></a></span></span><span>              </span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- op v</span><span>
</span><span id="line-3381"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932835"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932835"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe PrimOp
</span><a href="GHC.Types.Id.html#isPrimOpId_maybe"><span class="hs-identifier hs-var">isPrimOpId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932833"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-3382"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932836"><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="#local-6989586621682932836"><span class="hs-identifier hs-var">adjust_lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe (Integer -&gt; Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#adjustUnary"><span class="hs-identifier hs-var">adjustUnary</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932835"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-3383"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
-&gt; Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932834"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; (Integer -&gt; Integer) -&gt; AltCon -&gt; Maybe AltCon
</span><a href="GHC.Core.Opt.ConstantFold.html#tx_lit_con"><span class="hs-identifier hs-var">tx_lit_con</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932832"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="#local-6989586621682932836"><span class="hs-identifier hs-var">adjust_lit</span></a></span><span>
</span><span id="line-3384"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932838"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932838"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932833"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932838"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3385"></span><span>
</span><span id="line-3386"></span><span class="hs-comment">-- See Note [caseRules for tagToEnum]</span><span>
</span><span id="line-3387"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules"><span class="hs-identifier hs-var">caseRules</span></a></span><span> </span><span id="local-6989586621682932839"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932839"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-identifier hs-type">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932840"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932840"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682932841"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932841"><span class="hs-identifier hs-var">type_arg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682932842"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932842"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-3388"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#TagToEnumOp"><span class="hs-identifier hs-var">TagToEnumOp</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe PrimOp
</span><a href="GHC.Types.Id.html#isPrimOpId_maybe"><span class="hs-identifier hs-var">isPrimOpId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932840"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-3389"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
-&gt; Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932842"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; AltCon -&gt; Maybe AltCon
</span><a href="GHC.Core.Opt.ConstantFold.html#tx_con_tte"><span class="hs-identifier hs-var">tx_con_tte</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932839"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-3390"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932844"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932844"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-identifier hs-var">App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932840"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932841"><span class="hs-identifier hs-var">type_arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932844"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3391"></span><span>
</span><span id="line-3392"></span><span class="hs-comment">-- See Note [caseRules for dataToTag]</span><span>
</span><span id="line-3393"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules"><span class="hs-identifier hs-var">caseRules</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621682932845"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932845"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682932846"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932846"><span class="hs-identifier hs-var">lev</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span class="annot"><a href="GHC.Core.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span id="local-6989586621682932847"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932847"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><a href="GHC.Core.html#App"><span class="hs-operator hs-type">`App`</span></a></span><span> </span><span id="local-6989586621682932848"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932848"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- dataToTag x</span><span>
</span><span id="line-3394"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621682932849"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932849"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe PrimOp
</span><a href="GHC.Types.Id.html#isPrimOpId_maybe"><span class="hs-identifier hs-var">isPrimOpId_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932845"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-3395"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932849"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DataToTagSmallOp"><span class="hs-identifier hs-var">DataToTagSmallOp</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932849"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; PrimOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#DataToTagLargeOp"><span class="hs-identifier hs-var">DataToTagLargeOp</span></a></span><span>
</span><span id="line-3396"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HasDebugCallStack =&gt; Type -&gt; Maybe (TyCon, [Type])
Type -&gt; Maybe (TyCon, [Type])
</span><a href="GHC.Core.Type.html#splitTyConApp_maybe"><span class="hs-identifier hs-var">splitTyConApp_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932847"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3397"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932850"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682932850"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; Bool
</span><a href="GHC.Core.TyCon.html#isValidDTT2TyCon"><span class="hs-identifier hs-var">isValidDTT2TyCon</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682932850"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-3398"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
-&gt; Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932848"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; AltCon -&gt; Maybe AltCon
</span><a href="GHC.Core.Opt.ConstantFold.html#tx_con_dtt"><span class="hs-identifier hs-var">tx_con_dtt</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682932850"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-3399"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682932852"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932852"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932845"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; CoreExpr
forall b. Type -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932846"><span class="hs-identifier hs-var">lev</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; CoreExpr
forall b. Type -&gt; Expr b
</span><a href="GHC.Core.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621682932847"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><a href="GHC.Core.html#App"><span class="hs-operator hs-var">`App`</span></a></span><span> </span><span class="annot"><span class="annottext">Id -&gt; CoreExpr
forall b. Id -&gt; Expr b
</span><a href="GHC.Core.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932852"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3400"></span><span>      </span><span class="annot"><span class="annottext">Maybe (TyCon, [Type])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SDoc
-&gt; Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
-&gt; Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
forall a. HasCallStack =&gt; SDoc -&gt; a -&gt; a
</span><a href="GHC.Utils.Trace.html#pprTraceUserWarning"><span class="hs-identifier hs-var">pprTraceUserWarning</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621682932854"><span class="hs-identifier hs-var">warnMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3401"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-3402"></span><span>    </span><span id="local-6989586621682932854"><span class="annot"><span class="annottext">warnMsg :: SDoc
</span><a href="#local-6989586621682932854"><span class="hs-identifier hs-var hs-var">warnMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><a href="GHC.Utils.Outputable.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="annot"><span class="annottext">([SDoc] -&gt; SDoc) -&gt; [SDoc] -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; SDoc) -&gt; [String] -&gt; [SDoc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><a href="GHC.Utils.Outputable.html#text"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-3403"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Found dataToTag primop applied to a non-ADT type. This could&quot;</span></span><span>
</span><span id="line-3404"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;be a future bug in GHC, or it may be caused by an unsupported&quot;</span></span><span>
</span><span id="line-3405"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;use of the ghc-internal primops dataToTagSmall# and dataToTagLarge#.&quot;</span></span><span>
</span><span id="line-3406"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;In either case, the GHC developers would like to know about it!&quot;</span></span><span>
</span><span id="line-3407"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Please report this as a GHC bug:  http://www.haskell.org/ghc/reportabug&quot;</span></span><span>
</span><span id="line-3408"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-3409"></span><span>
</span><span id="line-3410"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules"><span class="hs-identifier hs-var">caseRules</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreExpr, AltCon -&gt; Maybe AltCon, Id -&gt; CoreExpr)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3411"></span><span>
</span><span id="line-3412"></span><span>
</span><span id="line-3413"></span><span class="hs-comment">-- | Case rules</span><span>
</span><span id="line-3414"></span><span class="hs-comment">--</span><span>
</span><span id="line-3415"></span><span class="hs-comment">-- It's important that occurrence info are present, hence the use of In* types.</span><span>
</span><span id="line-3416"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#caseRules2"><span class="hs-identifier hs-type">caseRules2</span></a></span><span>
</span><span id="line-3417"></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.html#InExpr"><span class="hs-identifier hs-type">InExpr</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Scutinee</span></span><span>
</span><span id="line-3418"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#InId"><span class="hs-identifier hs-type">InId</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Case-binder</span></span><span>
</span><span id="line-3419"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#InAlt"><span class="hs-identifier hs-type">InAlt</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Alternatives in standard (increasing) order</span></span><span>
</span><span id="line-3420"></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#InExpr"><span class="hs-identifier hs-type">InExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Types.Var.html#InId"><span class="hs-identifier hs-type">InId</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#InAlt"><span class="hs-identifier hs-type">InAlt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3421"></span><span id="caseRules2"><span class="annot"><span class="annottext">caseRules2 :: CoreExpr -&gt; Id -&gt; [CoreAlt] -&gt; Maybe (CoreExpr, Id, [CoreAlt])
</span><a href="GHC.Core.Opt.ConstantFold.html#caseRules2"><span class="hs-identifier hs-var hs-var">caseRules2</span></a></span></span><span> </span><span id="local-6989586621682932865"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932865"><span class="hs-identifier hs-var">scrut</span></a></span></span><span> </span><span id="local-6989586621682932866"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932866"><span class="hs-identifier hs-var">bndr</span></a></span></span><span> </span><span id="local-6989586621682932867"><span class="annot"><span class="annottext">[CoreAlt]
</span><a href="#local-6989586621682932867"><span class="hs-identifier hs-var">alts</span></a></span></span><span>
</span><span id="line-3422"></span><span>
</span><span id="line-3423"></span><span>  </span><span class="hs-comment">-- case quotRem# x y of</span><span>
</span><span id="line-3424"></span><span>  </span><span class="hs-comment">--    (# q, _ #) -&gt; body</span><span>
</span><span id="line-3425"></span><span>  </span><span class="hs-comment">-- ====&gt;</span><span>
</span><span id="line-3426"></span><span>  </span><span class="hs-comment">--  case quot# x y of</span><span>
</span><span id="line-3427"></span><span>  </span><span class="hs-comment">--    q -&gt; body</span><span>
</span><span id="line-3428"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-3429"></span><span>  </span><span class="hs-comment">-- case quotRem# x y of</span><span>
</span><span id="line-3430"></span><span>  </span><span class="hs-comment">--    (# _, r #) -&gt; body</span><span>
</span><span id="line-3431"></span><span>  </span><span class="hs-comment">-- ====&gt;</span><span>
</span><span id="line-3432"></span><span>  </span><span class="hs-comment">--  case rem# x y of</span><span>
</span><span id="line-3433"></span><span>  </span><span class="hs-comment">--    r -&gt; body</span><span>
</span><span id="line-3434"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-type">BinOpApp</span></a></span><span> </span><span id="local-6989586621682932868"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932868"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682932869"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932869"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682932870"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932870"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932865"><span class="hs-identifier hs-var">scrut</span></a></span><span>
</span><span id="line-3435"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682932871"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932871"><span class="hs-identifier hs-var">quot</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932872"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932872"><span class="hs-identifier hs-var">rem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrimOp -&gt; Maybe (PrimOp, PrimOp)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_any_quot_rem"><span class="hs-identifier hs-var">is_any_quot_rem</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932869"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-3436"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-type">DataAlt</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621682932875"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932875"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682932876"><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932876"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621682932877"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932877"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[CoreAlt]
</span><a href="#local-6989586621682932867"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-3437"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Id.html#isDeadBinder"><span class="hs-identifier hs-var">isDeadBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932866"><span class="hs-identifier hs-var">bndr</span></a></span><span>
</span><span id="line-3438"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932879"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682932879"><span class="hs-identifier hs-var">dead_q</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Id.html#isDeadBinder"><span class="hs-identifier hs-var">isDeadBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932875"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-3439"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621682932880"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682932880"><span class="hs-identifier hs-var">dead_r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Bool
</span><a href="GHC.Types.Id.html#isDeadBinder"><span class="hs-identifier hs-var">isDeadBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932876"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-3440"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682932879"><span class="hs-identifier hs-var">dead_q</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682932880"><span class="hs-identifier hs-var">dead_r</span></a></span><span>
</span><span id="line-3441"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span>
</span><span id="line-3442"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682932879"><span class="hs-identifier hs-var">dead_q</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, Id, [CoreAlt]) -&gt; Maybe (CoreExpr, Id, [CoreAlt])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((CoreExpr, Id, [CoreAlt]) -&gt; Maybe (CoreExpr, Id, [CoreAlt]))
-&gt; (CoreExpr, Id, [CoreAlt]) -&gt; Maybe (CoreExpr, Id, [CoreAlt])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932868"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932872"><span class="hs-identifier hs-var">rem</span></a></span><span>  </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932870"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932876"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932877"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3443"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682932880"><span class="hs-identifier hs-var">dead_r</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(CoreExpr, Id, [CoreAlt]) -&gt; Maybe (CoreExpr, Id, [CoreAlt])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((CoreExpr, Id, [CoreAlt]) -&gt; Maybe (CoreExpr, Id, [CoreAlt]))
-&gt; (CoreExpr, Id, [CoreAlt]) -&gt; Maybe (CoreExpr, Id, [CoreAlt])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; PrimOp -&gt; CoreExpr -&gt; CoreExpr
</span><a href="GHC.Core.Opt.ConstantFold.html#BinOpApp"><span class="hs-identifier hs-var">BinOpApp</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932868"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932871"><span class="hs-identifier hs-var">quot</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932870"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Id
</span><a href="#local-6989586621682932875"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">AltCon -&gt; [Id] -&gt; CoreExpr -&gt; CoreAlt
forall b. AltCon -&gt; [b] -&gt; Expr b -&gt; Alt b
</span><a href="GHC.Core.html#Alt"><span class="hs-identifier hs-var">Alt</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621682932877"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-3444"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreExpr, Id, [CoreAlt])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3445"></span><span>
</span><span id="line-3446"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3447"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreExpr, Id, [CoreAlt])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3448"></span><span>
</span><span id="line-3449"></span><span>
</span><span id="line-3450"></span><span class="annot"><span class="hs-comment">-- | If the given primop is a quotRem, return the corresponding (quot,rem).</span></span><span>
</span><span id="line-3451"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#is_any_quot_rem"><span class="hs-identifier hs-type">is_any_quot_rem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3452"></span><span id="is_any_quot_rem"><span class="annot"><span class="annottext">is_any_quot_rem :: PrimOp -&gt; Maybe (PrimOp, PrimOp)
</span><a href="GHC.Core.Opt.ConstantFold.html#is_any_quot_rem"><span class="hs-identifier hs-var hs-var">is_any_quot_rem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-3453"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntQuotRemOp"><span class="hs-identifier hs-var">IntQuotRemOp</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrimOp, PrimOp) -&gt; Maybe (PrimOp, PrimOp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntQuotOp"><span class="hs-identifier hs-var">IntQuotOp</span></a></span><span> </span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntRemOp"><span class="hs-identifier hs-var">IntRemOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3454"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8QuotRemOp"><span class="hs-identifier hs-var">Int8QuotRemOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrimOp, PrimOp) -&gt; Maybe (PrimOp, PrimOp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8QuotOp"><span class="hs-identifier hs-var">Int8QuotOp</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int8RemOp"><span class="hs-identifier hs-var">Int8RemOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3455"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16QuotRemOp"><span class="hs-identifier hs-var">Int16QuotRemOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrimOp, PrimOp) -&gt; Maybe (PrimOp, PrimOp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16QuotOp"><span class="hs-identifier hs-var">Int16QuotOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int16RemOp"><span class="hs-identifier hs-var">Int16RemOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3456"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32QuotRemOp"><span class="hs-identifier hs-var">Int32QuotRemOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrimOp, PrimOp) -&gt; Maybe (PrimOp, PrimOp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32QuotOp"><span class="hs-identifier hs-var">Int32QuotOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Int32RemOp"><span class="hs-identifier hs-var">Int32RemOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3457"></span><span>  </span><span class="hs-comment">-- Int64QuotRemOp doesn't exist (yet)</span><span>
</span><span id="line-3458"></span><span>
</span><span id="line-3459"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordQuotRemOp"><span class="hs-identifier hs-var">WordQuotRemOp</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrimOp, PrimOp) -&gt; Maybe (PrimOp, PrimOp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordQuotOp"><span class="hs-identifier hs-var">WordQuotOp</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordRemOp"><span class="hs-identifier hs-var">WordRemOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3460"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8QuotRemOp"><span class="hs-identifier hs-var">Word8QuotRemOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrimOp, PrimOp) -&gt; Maybe (PrimOp, PrimOp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8QuotOp"><span class="hs-identifier hs-var">Word8QuotOp</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word8RemOp"><span class="hs-identifier hs-var">Word8RemOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3461"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16QuotRemOp"><span class="hs-identifier hs-var">Word16QuotRemOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrimOp, PrimOp) -&gt; Maybe (PrimOp, PrimOp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16QuotOp"><span class="hs-identifier hs-var">Word16QuotOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word16RemOp"><span class="hs-identifier hs-var">Word16RemOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3462"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32QuotRemOp"><span class="hs-identifier hs-var">Word32QuotRemOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(PrimOp, PrimOp) -&gt; Maybe (PrimOp, PrimOp)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32QuotOp"><span class="hs-identifier hs-var">Word32QuotOp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#Word32RemOp"><span class="hs-identifier hs-var">Word32RemOp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3463"></span><span>  </span><span class="hs-comment">-- Word64QuotRemOp doesn't exist (yet)</span><span>
</span><span id="line-3464"></span><span>
</span><span id="line-3465"></span><span>  </span><span class="annot"><span class="annottext">PrimOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (PrimOp, PrimOp)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3466"></span><span>
</span><span id="line-3467"></span><span>
</span><span id="line-3468"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_lit_con"><span class="hs-identifier hs-type">tx_lit_con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span>
</span><span id="line-3469"></span><span id="tx_lit_con"><span class="annot"><span class="annottext">tx_lit_con :: Platform -&gt; (Integer -&gt; Integer) -&gt; AltCon -&gt; Maybe AltCon
</span><a href="GHC.Core.Opt.ConstantFold.html#tx_lit_con"><span class="hs-identifier hs-var hs-var">tx_lit_con</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><span class="hs-identifier">_</span></span><span>      </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; Maybe AltCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span>
</span><span id="line-3470"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_lit_con"><span class="hs-identifier hs-var">tx_lit_con</span></a></span><span> </span><span id="local-6989586621682932889"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932889"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span id="local-6989586621682932890"><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="#local-6989586621682932890"><span class="hs-identifier hs-var">adjust</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-type">LitAlt</span></a></span><span> </span><span id="local-6989586621682932891"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932891"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; Maybe AltCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(AltCon -&gt; Maybe AltCon) -&gt; AltCon -&gt; Maybe AltCon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; AltCon
</span><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; (Integer -&gt; Integer) -&gt; Literal -&gt; Literal
</span><a href="GHC.Types.Literal.html#mapLitValue"><span class="hs-identifier hs-var">mapLitValue</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932889"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><a href="#local-6989586621682932890"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621682932891"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3471"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_lit_con"><span class="hs-identifier hs-var">tx_lit_con</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">Integer -&gt; Integer
</span><span class="hs-identifier">_</span></span><span>      </span><span id="local-6989586621682932893"><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682932893"><span class="hs-identifier hs-var">alt</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Maybe AltCon
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;caseRules&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AltCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682932893"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3472"></span><span>   </span><span class="hs-comment">-- NB: mapLitValue uses mkLitIntWrap etc, to ensure that the</span><span>
</span><span id="line-3473"></span><span>   </span><span class="hs-comment">-- literal alternatives remain in Word/Int target ranges</span><span>
</span><span id="line-3474"></span><span>   </span><span class="hs-comment">-- (See Note [Word/Int underflow/overflow] in GHC.Types.Literal and #13172).</span><span>
</span><span id="line-3475"></span><span>
</span><span id="line-3476"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#adjustDyadicRight"><span class="hs-identifier hs-type">adjustDyadicRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-3477"></span><span class="hs-comment">-- Given (x `op` lit) return a function 'f' s.t.  f (x `op` lit) = x</span><span>
</span><span id="line-3478"></span><span id="adjustDyadicRight"><span class="annot"><span class="annottext">adjustDyadicRight :: PrimOp -&gt; Integer -&gt; Maybe (Integer -&gt; Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#adjustDyadicRight"><span class="hs-identifier hs-var hs-var">adjustDyadicRight</span></a></span></span><span> </span><span id="local-6989586621682932894"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932894"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621682932895"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932895"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-3479"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932894"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3480"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAddOp"><span class="hs-identifier hs-var">WordAddOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932896"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932896"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932896"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932895"><span class="hs-identifier hs-var">lit</span></a></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-3481"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAddOp"><span class="hs-identifier hs-var">IntAddOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932897"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932897"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932897"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932895"><span class="hs-identifier hs-var">lit</span></a></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-3482"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordSubOp"><span class="hs-identifier hs-var">WordSubOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932898"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932898"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932898"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932895"><span class="hs-identifier hs-var">lit</span></a></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-3483"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSubOp"><span class="hs-identifier hs-var">IntSubOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932899"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932899"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932899"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932895"><span class="hs-identifier hs-var">lit</span></a></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-3484"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordXorOp"><span class="hs-identifier hs-var">WordXorOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932900"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932900"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932900"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932895"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3485"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntXorOp"><span class="hs-identifier hs-var">IntXorOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932901"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932901"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932901"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932895"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3486"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; Integer)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3487"></span><span>
</span><span id="line-3488"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#adjustDyadicLeft"><span class="hs-identifier hs-type">adjustDyadicLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-3489"></span><span class="hs-comment">-- Given (lit `op` x) return a function 'f' s.t.  f (lit `op` x) = x</span><span>
</span><span id="line-3490"></span><span id="adjustDyadicLeft"><span class="annot"><span class="annottext">adjustDyadicLeft :: Integer -&gt; PrimOp -&gt; Maybe (Integer -&gt; Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#adjustDyadicLeft"><span class="hs-identifier hs-var hs-var">adjustDyadicLeft</span></a></span></span><span> </span><span id="local-6989586621682932902"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932902"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621682932903"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932903"><span class="hs-identifier hs-var">op</span></a></span></span><span>
</span><span id="line-3491"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932903"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3492"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordAddOp"><span class="hs-identifier hs-var">WordAddOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932904"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932904"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932904"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932902"><span class="hs-identifier hs-var">lit</span></a></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-3493"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntAddOp"><span class="hs-identifier hs-var">IntAddOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932905"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932905"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932905"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932902"><span class="hs-identifier hs-var">lit</span></a></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-3494"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordSubOp"><span class="hs-identifier hs-var">WordSubOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932906"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932906"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932902"><span class="hs-identifier hs-var">lit</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932906"><span class="hs-identifier hs-var">y</span></a></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-3495"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntSubOp"><span class="hs-identifier hs-var">IntSubOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932907"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932907"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932902"><span class="hs-identifier hs-var">lit</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932907"><span class="hs-identifier hs-var">y</span></a></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-3496"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordXorOp"><span class="hs-identifier hs-var">WordXorOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932908"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932908"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932908"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932902"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3497"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntXorOp"><span class="hs-identifier hs-var">IntXorOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932909"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932909"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932909"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`xor`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932902"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3498"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; Integer)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3499"></span><span>
</span><span id="line-3500"></span><span>
</span><span id="line-3501"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#adjustUnary"><span class="hs-identifier hs-type">adjustUnary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Builtin.PrimOps.html#PrimOp"><span class="hs-identifier hs-type">PrimOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-3502"></span><span class="hs-comment">-- Given (op x) return a function 'f' s.t.  f (op x) = x</span><span>
</span><span id="line-3503"></span><span id="adjustUnary"><span class="annot"><span class="annottext">adjustUnary :: PrimOp -&gt; Maybe (Integer -&gt; Integer)
</span><a href="GHC.Core.Opt.ConstantFold.html#adjustUnary"><span class="hs-identifier hs-var hs-var">adjustUnary</span></a></span></span><span> </span><span id="local-6989586621682932910"><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932910"><span class="hs-identifier hs-var">op</span></a></span></span><span>
</span><span id="line-3504"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimOp
</span><a href="#local-6989586621682932910"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-3505"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#WordNotOp"><span class="hs-identifier hs-var">WordNotOp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932911"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932911"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932911"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3506"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntNotOp"><span class="hs-identifier hs-var">IntNotOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932912"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932912"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932912"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3507"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><a href="GHC.Builtin.PrimOps.html#IntNegOp"><span class="hs-identifier hs-var">IntNegOp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer) -&gt; Maybe (Integer -&gt; Integer)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682932913"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932913"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932913"><span class="hs-identifier hs-var">y</span></a></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-3508"></span><span>         </span><span class="annot"><span class="annottext">PrimOp
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; Integer)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3509"></span><span>
</span><span id="line-3510"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_con_tte"><span class="hs-identifier hs-type">tx_con_tte</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Platform.html#Platform"><span class="hs-identifier hs-type">Platform</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span>
</span><span id="line-3511"></span><span id="tx_con_tte"><span class="annot"><span class="annottext">tx_con_tte :: Platform -&gt; AltCon -&gt; Maybe AltCon
</span><a href="GHC.Core.Opt.ConstantFold.html#tx_con_tte"><span class="hs-identifier hs-var hs-var">tx_con_tte</span></a></span></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; Maybe AltCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span>
</span><span id="line-3512"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_con_tte"><span class="hs-identifier hs-var">tx_con_tte</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><span class="hs-identifier">_</span></span><span>        </span><span id="local-6989586621682932914"><span class="annot"><span class="annottext">alt :: AltCon
</span><a href="#local-6989586621682932914"><span class="hs-identifier hs-var">alt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-type">LitAlt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Maybe AltCon
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;caseRules&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AltCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682932914"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3513"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_con_tte"><span class="hs-identifier hs-var">tx_con_tte</span></a></span><span> </span><span id="local-6989586621682932915"><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932915"><span class="hs-identifier hs-var">platform</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-type">DataAlt</span></a></span><span> </span><span id="local-6989586621682932916"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682932916"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- See Note [caseRules for tagToEnum]</span><span>
</span><span id="line-3514"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; Maybe AltCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(AltCon -&gt; Maybe AltCon) -&gt; AltCon -&gt; Maybe AltCon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; AltCon
</span><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-var">LitAlt</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; AltCon) -&gt; Literal -&gt; AltCon
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Integer -&gt; Literal
</span><a href="GHC.Types.Literal.html#mkLitInt"><span class="hs-identifier hs-var">mkLitInt</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621682932915"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="annot"><span class="annottext">(ConTagZ -&gt; Integer) -&gt; ConTagZ -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DataCon -&gt; ConTagZ
</span><a href="GHC.Core.DataCon.html#dataConTagZ"><span class="hs-identifier hs-var">dataConTagZ</span></a></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621682932916"><span class="hs-identifier hs-var">dc</span></a></span><span>
</span><span id="line-3515"></span><span>
</span><span id="line-3516"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_con_dtt"><span class="hs-identifier hs-type">tx_con_dtt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Core.TyCon.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="GHC.Core.html#AltCon"><span class="hs-identifier hs-type">AltCon</span></a></span><span>
</span><span id="line-3517"></span><span id="tx_con_dtt"><span class="annot"><span class="annottext">tx_con_dtt :: TyCon -&gt; AltCon -&gt; Maybe AltCon
</span><a href="GHC.Core.Opt.ConstantFold.html#tx_con_dtt"><span class="hs-identifier hs-var hs-var">tx_con_dtt</span></a></span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; Maybe AltCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="GHC.Core.html#DEFAULT"><span class="hs-identifier hs-var">DEFAULT</span></a></span><span>
</span><span id="line-3518"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_con_dtt"><span class="hs-identifier hs-var">tx_con_dtt</span></a></span><span> </span><span id="local-6989586621682932917"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682932917"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Core.html#LitAlt"><span class="hs-identifier hs-type">LitAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GHC.Types.Literal.html#LitNumber"><span class="hs-identifier hs-type">LitNumber</span></a></span><span> </span><span class="annot"><span class="annottext">LitNumType
</span><a href="GHC.Types.Literal.html#LitNumInt"><span class="hs-identifier hs-var">LitNumInt</span></a></span><span> </span><span id="local-6989586621682932918"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932918"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-3519"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682932919"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; ConTagZ -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><span class="hs-number">0</span></span><span>
</span><span id="line-3520"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682932919"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">ConTagZ -&gt; ConTagZ -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682932920"><span class="hs-identifier hs-var">n_data_cons</span></a></span><span>
</span><span id="line-3521"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AltCon -&gt; Maybe AltCon
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; AltCon
</span><a href="GHC.Core.html#DataAlt"><span class="hs-identifier hs-var">DataAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DataCon]
</span><a href="#local-6989586621682932921"><span class="hs-identifier hs-var">data_cons</span></a></span><span> </span><span class="annot"><span class="annottext">[DataCon] -&gt; ConTagZ -&gt; DataCon
forall a. HasCallStack =&gt; [a] -&gt; ConTagZ -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">ConTagZ
</span><a href="#local-6989586621682932919"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- tag is zero-indexed, as is (!!)</span><span>
</span><span id="line-3522"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-3523"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe AltCon
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-3524"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-3525"></span><span>     </span><span id="local-6989586621682932919"><span class="annot"><span class="annottext">tag :: ConTagZ
</span><a href="#local-6989586621682932919"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ConTagZ
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621682932918"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Types.Basic.html#ConTagZ"><span class="hs-identifier hs-type">ConTagZ</span></a></span><span>
</span><span id="line-3526"></span><span>     </span><span id="local-6989586621682932920"><span class="annot"><span class="annottext">n_data_cons :: ConTagZ
</span><a href="#local-6989586621682932920"><span class="hs-identifier hs-var hs-var">n_data_cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; ConTagZ
</span><a href="GHC.Core.TyCon.html#tyConFamilySize"><span class="hs-identifier hs-var">tyConFamilySize</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682932917"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-3527"></span><span>     </span><span id="local-6989586621682932921"><span class="annot"><span class="annottext">data_cons :: [DataCon]
</span><a href="#local-6989586621682932921"><span class="hs-identifier hs-var hs-var">data_cons</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; [DataCon]
</span><a href="GHC.Core.TyCon.html#tyConDataCons"><span class="hs-identifier hs-var">tyConDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621682932917"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-3528"></span><span>
</span><span id="line-3529"></span><span class="annot"><a href="GHC.Core.Opt.ConstantFold.html#tx_con_dtt"><span class="hs-identifier hs-var">tx_con_dtt</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682932923"><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682932923"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc -&gt; Maybe AltCon
forall a. HasCallStack =&gt; String -&gt; SDoc -&gt; a
</span><a href="GHC.Utils.Panic.html#pprPanic"><span class="hs-identifier hs-var">pprPanic</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;caseRules/dataToTag: bad alt&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AltCon -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><a href="GHC.Utils.Outputable.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">AltCon
</span><a href="#local-6989586621682932923"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-3530"></span><span>
</span><span id="line-3531"></span><span>
</span><span id="line-3532"></span><span class="hs-comment">{- Note [caseRules for tagToEnum]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We want to transform
   case tagToEnum# x of
     False -&gt; e1
     True  -&gt; e2
into
   case x of
     0# -&gt; e1
     1# -&gt; e2

See #8317.   This rule eliminates a lot of boilerplate. For
  if (x&gt;y) then e2 else e1
we generate
  case tagToEnum# (x &gt;# y) of
    False -&gt; e1
    True  -&gt; e2
and it is nice to then get rid of the tagToEnum#.

Beware (#14768): avoid the temptation to map constructor 0 to
DEFAULT, in the hope of getting this
  case (x &gt;# y) of
    DEFAULT -&gt; e1
    1#      -&gt; e2
That fails utterly in the case of
   data Colour = Red | Green | Blue
   case tagToEnum x of
      DEFAULT -&gt; e1
      Red     -&gt; e2

We don't want to get this!
   case x of
      DEFAULT -&gt; e1
      DEFAULT -&gt; e2

Instead, when possible, we turn one branch into DEFAULT in
GHC.Core.Opt.Simplify.Utils.mkCase2; see Note [Literal cases]
in that module.

Note [caseRules for dataToTag]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
See also Note [DataToTag overview] in GHC.Tc.Instance.Class.

We want to transform
  case dataToTagSmall# x of
    DEFAULT -&gt; e1
    1# -&gt; e2
into
  case x of
    DEFAULT -&gt; e1
    (:) _ _ -&gt; e2

(Note the need for some wildcard binders in the 'cons' case.)

This transformation often enables further optimisation via
case-flattening and case-of-known-constructor and can be very
important for code using derived Eq instances.

We can apply this transformation only when we can easily get the
constructors from the type at which dataToTagSmall# is used.  And we
cannot apply this transformation at &quot;type data&quot;-related types without
breaking invariant I1 from Note [Type data declarations] in
GHC.Rename.Module.  That leaves exactly the types satisfying condition
DTT2 from Note [DataToTag overview] in GHC.Tc.Instance.Class.

All of the above applies identically for `dataToTagLarge#`.  And
thanks to wrinkle DTW5, there is no need to worry about large-tag
arguments for `dataToTagSmall#`; those cause undefined behavior anyway.


Note [Unreachable caseRules alternatives]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Take care if we see something like
  case dataToTag x of
    DEFAULT -&gt; e1
    -1# -&gt; e2
    100 -&gt; e3
because there isn't a data constructor with tag -1 or 100. In this case the
out-of-range alternative is dead code -- we know the range of tags for x.

Hence caseRules returns (AltCon -&gt; Maybe AltCon), with Nothing indicating
an alternative that is unreachable.

You may wonder how this can happen: check out #15436.
-}</span><span>
</span><span id="line-3617"></span></pre></body></html>